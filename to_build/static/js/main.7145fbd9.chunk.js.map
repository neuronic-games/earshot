{"version":3,"sources":["models/url/index.ts","models/url/parameters.ts","models/utils/utils.ts","models/utils/matrix.ts","models/utils/coordinates.ts","models/utils/promise/index.ts","models/utils/color.ts","models/locales/index.ts","models/locales/en.ts","models/locales/ja.ts","models/Participant.ts","stores/participants/localPlugins/DevicePreference.ts","components/Constants.ts","stores/MapObject.ts","stores/utils.ts","stores/participants/ParticipantBase.ts","stores/participants/LocalParticipant.ts","stores/participants/PlaybackParticipant.ts","stores/participants/RemoteParticipant.ts","stores/participants/Participants.ts","stores/Chat.ts","models/conference/DataMessageType.ts","models/ISharedContent.ts","models/api/CORS.ts","models/api/GoogleDrive.ts","models/api/Gyazo.ts","stores/sharedContents/SharedContentCreator.ts","models/utils/getMimeType.ts","models/conference/RtcConnection.ts","models/utils/date.ts","models/conference/Recorder.ts","stores/RoomInfo.ts","models/conference/Notification.ts","models/conference/DataSync.ts","models/audio/AudioMeter.ts","models/conference/DataConnection.ts","models/conference/PriorityCalculator.ts","models/conference/MediaMessages.ts","models/conference/Conference.ts","stores/sharedContents/SharedContents.ts","stores/Map.ts","stores/ErrorInfo.ts","images/whoo-screen_chat.png","images/people_login.png","images/go.png","images/logo.png","components/error/AfkDialog.tsx","components/utils/roomNameGenerator.tsx","components/error/ErrorDialog.tsx","components/error/TheEntrance.tsx","components/footer/adminConfig/RemoteTrackLimitControl.tsx","components/footer/adminConfig/AdminConfigForm.tsx","components/footer/BroadcastControl.tsx","components/utils/MoreButton.tsx","images/earshot_icon_submenu.png","components/utils/FabEx.tsx","images/whoo-screen_btn-more.png","images/earshot_icon_btn-kick.png","components/utils/formatter.tsx","models/conference/faceCamera.ts","components/utils/DialogIconItem.tsx","components/footer/share/CameraSelector.tsx","components/footer/share/GoogleDrive.tsx","components/footer/share/Input.tsx","components/footer/share/ImageInput.tsx","components/footer/share/SettingInput.tsx","components/footer/share/SettingImageInput.tsx","components/footer/share/ShareMenu.tsx","components/footer/share/TextInput.tsx","components/footer/share/ShareDialog.tsx","components/footer/SettingsControl.tsx","components/footer/BroadcastVideoControl.tsx","components/footer/StereoSwitchControl.tsx","components/footer/Footer.tsx","images/earshot_icon_btn-share.png","components/utils/styles.ts","components/avatar/ImageAvatar.tsx","components/utils/index.ts","components/utils/Text.tsx","components/leftBar/Chat.tsx","components/Settings.ts","components/map/Share/GDrive.tsx","components/map/Share/PDF.tsx","components/map/Share/PlaybackScreenContent.tsx","components/map/Share/ScreenContent.tsx","components/map/Share/Text.tsx","models/audio/NodeGroup.ts","stores/AudioParameters/StereoParameters.ts","components/map/Share/YouTube.tsx","components/map/Share/Content.tsx","components/map/Share/SharedContentForm.tsx","images/whoo-screen_btn-add-63.png","components/map/Participant/SignalQuality.tsx","components/map/Participant/LocalParticipantForm.tsx","components/avatar/StreamAvatar.tsx","components/avatar/ComposedAvatar.tsx","components/avatar/ConnectedAvatar.tsx","components/avatar/VRMAvatar.tsx","images/whoo-emoticons_voice.png","images/whoo-screen_sym-smile.png","images/whoo-screen_sym-clap.png","images/whoo-screen_sym-hand.png","images/earshot_icon_avatar_glow.png","components/map/Participant/Participant.tsx","images/whoo-screen_sym-slow.png","images/whoo-screen_pointer.png","components/map/Participant/LocalParticipant.tsx","components/utils/DragHandler.ts","images/earshot_icon_edit_avatar.png","components/map/Participant/RemoteParticipantForm.tsx","images/earshot_icon_btn-chat.png","components/map/Participant/RemoteParticipant.tsx","images/earshot_icon_mic.png","images/earshot_icon_btn-earshot-2.png","images/earshot_icon_btn-extract.png","components/map/Base/Base.tsx","images/whoo-screen_btn-earshot.png","components/map/Share/RndContent.tsx","images/whoo-screen_btn-front.png","images/whoo-screen_btn-back.png","images/whoo-screen_btn-delete.png","components/map/Share/SharedContent.tsx","components/leftBar/ContentList.tsx","components/leftBar/StatusDialog.tsx","components/leftBar/ParticipantList.tsx","images/earshot_icon_quality_3.png","images/earshot_icon_quality_2.png","images/earshot_icon_quality_1.png","components/leftBar/LeftBar.tsx","components/App.tsx","components/map/MainScreen.tsx","components/map/Participant/MouseCursor.tsx","components/map/Participant/PlaybackParticipant.tsx","components/map/Participant/ParticipantLayer.tsx","components/map/Share/PastedContent.tsx","components/map/Share/ShareLayer.tsx","components/map/Background/Background.tsx","components/map/map.tsx","images/earshot_icon_tab.png","images/whoo-screen_btn-smile.png","images/whoo-screen_btn-clap.png","images/whoo-screen_btn-hand.png","components/footer/Emoticons.tsx","components/footer/ZoneAvatar.tsx","images/earshot_icon_tab_content.png","images/earshot_icon_btn-note.png","stores/AudioParameters/index.ts","models/audio/ConnectedGroup.ts","models/audio/StereoManager.ts","models/audio/index.ts","models/audio/ConnectedManager.ts","models/conference/mediapipeCamera.ts","models/conference/chooseDevice.ts","index.tsx"],"names":["urlParameters","url","urlObj","URL","decodeURI","res","reduce","pre","prop","searchParams","get","room","pathname","substr","replace","decodeGetParams","window","location","href","assert","input","Error","test","navigator","userAgent","vendor","diffMap","a","b","diff","Map","elem","delete","isSmartphone","match","isPortrait","parent","screen","width","height","isSelfUrl","host","extractScaleX","matrix","Math","abs","sign","sqrt","pow","c","extractScaleY","d","extractRotation","atan2","transfromAt","center","tranform","baseMatrix","tm","DOMMatrix","translate","itm","translateSelf","p","multiplySelf","transformPoint2D","point","e","f","rotateVector2D","addV2","subV2","mulV","s","v","map","mulV2","normV","sum","forEach","degree2Radian","degree","PI","radian2Degree","radian","getRelativePose","base","relative","orientation","sin","cos","translatedPosition","position","rotatedPosition","convertToAudioCoordinate","pose","rotateVector2DByDegree","vector","rad","crossProduct","vec1","vec2","vectorLength","vec","val","getRect","size","lt","vr","vb","xs","ys","sort","isCircleInRect","radius","rect","round","n","pose2Str","mouse2Str","mouse","show","str2Pose","str","poseArray","split","Number","str2Mouse","mouseArray","resolveAtEnd","func","Promise","resolve","reject","err","getRandomColorRGB","i","length","charCodeAt","num","floor","findTextColorRGB","rgb","isDarkColor","findReverseColorRGB","rgb2Color","g","toString","slice","getRandomColor","r","textColor","rgb2Colors","rgba","alpha","t","key","options","i18n","useTranslation","useTrans","resources","en","translation","enAbout","enTopPageUrl","enMoreInfo","YourName","Venue","EnterTheVenue","Contents","shareImport","shareImportTip","shareDownload","shareDownloadTip","shareIframe","shareIframeTip","shareText","sharePaste","sharePasteTip","shareImage","shareZoneImage","shareImageTip","shareGDrive","shareGDriveTip","shareWhiteboard","shareWhiteboardTip","shareEditEnd","shareCamera","shareScreenBackground","stopScreenBackground","shareScreenContent","shareScreenContentTip","stopScreen","frameRateSetting","fps","shareMouse","shareMouseTip","stopMouse","recorderMenuTitle","recorderStart","recorderStop","playerStop","playerPlayfile","ttCreateAndshare","ttMicMute","ttPlayAndRec","headphoneL1Chrome","headphoneL1","headphoneL2","etConnection","emConnection","etMicPermission","emMicPermission","etNoMic","emNoMic","emClose","emNeverShow","etNoChannel","emNoChannel","etDataConnection","etRtcConnection","emDataConnection","emRtcConnection","ctTitle","ctUnTitle","etRetry","emRetry","imageDropzoneText","lsTitle","lsName","lsColor","lsColorAvatar","lsColorText","lsAutoColor","lsImage","lsEmail","lsImageFile","btSave","btCancel","lsNotifyCall","lsNotifyTouch","lsNotifyNear","lsNotifyYarn","rsCall","lsNotification","rsConnectYarnPhone","rsCutYarnPhone","rsChatTo","ctPin","ctUnpin","ctEdit","ctEndEdit","ctUploadZone","ctEditIframe","ctEndEditIframe","ctEditText","ctEndEditText","ctEditWhiteboard","ctEndEditWhiteboard","ctEditGDrive","ctEndEditGDrive","ctEndEditYoutube","ctEditYoutube","ctMoveTop","ctMoveBottom","ctWallpaper","ctUnWallpaper","ctCopyToClipboard","ctMaximize","ctUnMaximize","ctDelete","ctClose","ctName","ctFocus","ctFrameVisible","ctFrameInvisible","ctOpenAudioZone","ctClosedAudioZone","ctNotAudioZone","ctOpaque","ctTransparent","ctGenerateAvatar","deleteMsg","upload","Save","Clear","Cancel","broadcastMyVoice","showTrackedFace","trackWholeBody","soundLocalizationBasedOn","stereoNote","stereoNoteDesc","stereoConfirmed","stereoCancel","slAvatar","slUser","usage","cmJoined","cmLeft","cmNameChanged","cmCallBy","cmCallTo","cmToAll","cmToName","cmSend","cmPrivateFrom","cmPrivateTo","noCalled","noTouched","noNear","noYarn","afkTitle","afkMessage","gdFailed","videoLimit","audioLimit","connectionStatus","deleteImageMsg","deleteZoneMsg","deleteTextMsg","deleteYes","ctKick","deleteNo","copyClipboard","deleteAlert","ctProximity","ctUnProximity","ctStopWatchOn","ctStopWatchOff","ctScaleRotate","ctUnScaleRotate","settingPreference","meetingSpace","meetingDesc","broadcastMyVideo","broadcastMySpeakVideo","stereoswitch","ja","createAndShareTitle","i18nSupportedLngs","Object","keys","i18nOptions","supportedLngs","fallbackLng","interpolation","escapeValue","PARTICIPANT_SIZE","defaultInformation","name","email","avatarSrc","color","randomAvatar","faceTrack","notifyCall","notifyTouch","notifyNear","notifyYarn","defaultRemoteInformation","defaultPhysics","located","onStage","awayFromKeyboard","defaultViewpoint","DevicePreference","makeObservable","this","observable","MAP_SIZE","MAP_CENTER","defaultValue","MapObject","_","cloneDeep","obj","undefined","deep","shallowObservable","TracksStore","ref","audio","ms","MediaStream","addTrack","avatar","track","mute","avatarOk","muted","computed","action","TrackStates","ParticipantBase","shallow","bound","isLocal","information","audioLevel","muteAudio","muteVideo","reverseRGB","physics","assign","LocalParticipant","devicePreference","informationToSend","loadInformationFromStorage","useStereoAudio","headphone","muteMic","cameraOn","emoticon","pingIcon","pingX","pingY","remoteID","remoteX","remoteY","loadMediaSettingsFromStorage","loadPhysicsFromStorage","autorun","gravatar","vrm","src","includes","trim","hash","md5","toLowerCase","img","Image","resolutionFunc","rejectionFunc","onload","onerror","checkImageUrl","then","catch","tpv","thirdPersonView","micMuted","speakerMuted","muteSpeaker","info","isLocalStorage","storage","sessionStorage","localStorage","setItem","JSON","stringify","getItem","infoInStr","parse","pos","toWindow","viewpoint","screenSize","muteStatus","stream","device","soundLocalizationBase","uploadPreference","uploaderPreference","rv","settingStrInLocal","settingStrInSession","settingLocal","settingSession","setting","config","remoteVideoLimit","remoteAudioLimit","PlaybackParticipant","id","informationReceived","lastDistance","called","RemoteParticipant","participants","local_","box","remote","local","participantId","newParticipant","set","join","clear","setLocalId","localId","playback","peer","participant","getOrCreateRemote","kind","tracks","Set","ChatMessage","text","pid","avatarUrl","colors","timestamp","type","chat","messages","splice","msg","push","limitMessages","oldName","find","cm","getColor","Date","now","old","new","addMessage","from","to","StoredMessageType","PARTICIPANT_AFK","PARTICIPANT_TRACKSTATES","PARTICIPANT_VIEWPOINT","PARTICIPANT_INFO","PARTICIPANT_VRMRIG","InstantMessageType","PARTICIPANT_TRACKLIMITS","YARN_PHONE","CHAT_MESSAGE","CALL_REMOTE","MUTE_VIDEO","MUTE_AUDIO","AUDIO_LEVEL","RELOAD_BROWSER","KICK","ObjectArrayMessageType","values","CONTENT_UPDATE_REQUEST","CONTENT_INFO_UPDATE","ObjectArrayMessageTypes","StringArrayMessageType","CONTENT_REMOVE_REQUEST","PARTICIPANT_OUT","MOUSE_OUT","CONTENT_OUT","StringArrayMessageTypes","ClientToServerOnlyMessageType","CONTENT_UPDATE_REQUEST_BY_ID","REQUEST_ALL","REQUEST_RANGE","REQUEST_PARTICIPANT_STATES","MessageType","PARTICIPANT_POSE","PARTICIPANT_MOUSE","PARTICIPANT_ON_STAGE","PARTICIPANT_LEFT","ROOM_PROP","REQUEST_TO","FRAGMENT_HEAD","FRAGMENT_CONTENT","contentsToSend","them","zIndex","zones","receiveToContents","overlapZones","surroundingZones","TIME_RESOLUTION_IN_MS","TEN_YEAR","doseContentEditingUseKeyinput","isContentEditable","isContentWallpaper","zorder","CONTENT_OUT_OF_RANGE_VALUE","compTextMessage","t1","t2","time","CORS_PROXY_URL","corsProxyUrl","getProxiedUrl","head","substring","GoogleDrive","clientId","clientSecret","appId","apiToken","scopes","loadState","gapi","load","onAuthApiLoad","bind","client","onDriveLoad","console","log","auth","authorize","error","k","file","login","drive","files","list","q","result","dirId","fileMetadata","create","resource","directoryResponse","body","metadata","mimeType","parents","form","FormData","append","Blob","fetch","method","headers","Headers","getToken","access_token","json","fileUploadResponse","permissions","fileId","role","uploadToGyazo","imageData","formData","response","responseJson","GoogleAuth","defaultContent","mapObjectDefaultValue","ownerName","ownerURL","originalSize","pinned","shareType","showTitle","contentDesc","showStopWatch","stopWatchToggle","stopWatchReset","scaleRotateToggle","baseImage","baseIcon","baseColor","SharedContentImp","noFrame","opacity","createContent","content","makeItPdf","pasted","urlStr","mouseOnMap","createContentOfIframe","xCord","yCord","hostname","paramStrs","search","params","param","fileIdStart","indexOf","xhttp","XMLHttpRequest","timeout","open","onreadystatechange","readyState","LOADING","getResponseHeader","abort","send","getMimeType","finally","contentLog","createContentOfText","message","texts","scroll","slen","ceil","max","STRING_SCALE_H","createContentOfImage","imageFile","offset","uploadType","_type","desc","uploadFileToGoogleDrive","createContentOfImageUrl","promise","getImageSize","String","updateSigninStatus","isSignedIn","createContentOfPdf","init","apiKey","scope","discoveryDocs","auth2","getAuthInstance","listen","reason","createContentOfVideo","settings","getSettings","createContentFromText","ext","execCopy","temp","document","createElement","value","selectionStart","selectionEnd","style","left","appendChild","focus","execCommand","blur","removeChild","getGDriveUrl","editing","comp","isGDrivePreviewEditUrl","app","getParamsFromUrl","start","paramStr","moveContentToTop","top","sharedContents","sorted","findIndex","order","moveContentToBottom","bottom","rtcLog","RtcConnection","peer_","connected","mainServer","handlers","promises","messageNumber","emitter","EventEmitter","onConnect","onCreateTransport","onRtpCapabilities","onConnectTransport","onProduceTransport","onCloseProducer","onConsumeTransport","onResumeConsumer","onRemoteUpdate","onRemoteLeft","mediasoup","warn","WebSocket","OPEN","onOpenEvent","sendWithPromise","onMessageEvent","ev","data","onCloseEvent","emit","setTimeout","setEventHandler","onErrorEvent","close","addEventListener","sn","arg","setMessageSerialNumber","setMessagePromise","m","routerRtpCapabilities","rtpCapabilities","resolveMessage","getMessageArg","rejectMessage","roomMsg","loadDevice","dir","transportObject","transport","iceServers","option","iceTransportPolicy","createSendTransport","createRecvTransport","appData","stat","tStat","defaultTransportStat","observer","addListener","interval","clearInterval","stopTransportStatUpdate","outStreamsPrev","inStreamsPrev","setInterval","curStat","getStats","stats","streamStats","Array","streams","filter","prev","dt","codecId","bytesPerSec","bytesSent","codec","targetBitrate","fractionLost","roundTripTime","bytesReceived","jitter","setAverageOf","tkey","delta","receivedBytePerSec","sentBytePerSec","ckey","selectedCandidatePairId","pair","lc","localCandidateId","turn","rc","remoteCandidateId","remoteServer","address","port","protocol","quality","min","getRemote","startUpdateTransportStat","dtlsParameters","producer","consumerOptions","consumer","producerId","rtpParameters","reply","event","listener","removeListener","removeAllListeners","args","remotes","cs","ss","count","pad2","dateTimeString","pad4","getFullYear","getMonth","getDay","getHours","getMinutes","recorderDb","Dexie","version","stores","records","recMessages","recMedias","blobs","dbRecords","dbMediaRecs","dbMessageRecs","dbBlobs","MediaRec","opt","media","cid","startTime","endTime","onData","MediaRecorder","onDataAvailable","onStop","state","stop","requestData","blob","Message","Recorder","medias","intervalTimer","stoppedMedias","disposers","MessageTypesToRecord","lastMessageValues","converting","recording","dbRec","conference","duration","title","add","observeAndRecordMedia","contents","all","unshift","saveDiffToDB","stopMediaRecordings","makeRecord","dbr","has","resolveAll","saveMediaRecordings","inDb","dbMedia","blobsToAdd","addCount","dbBlob","blobId","put","toArray","dbMsgs","dbLen","messagesToAdd","dbMsgToAdd","maxEndTime","recorder","where","nRecord","dbMedias","useDbData","record","pop","makeBlob","saveRecord","jsonPart","header","headerLen","Uint32Array","remains","vid","avatarStream","aid","audioStream","rtcContents","getAllRtcContentIds","rcid","contentTracks","MediaPlay","Player","pids","cids","archive","arrayBuffer","buffer","Int32Array","ab","playing","timeDiff","step","shift","player","playMessage","playMedia","stopMedia","cleanup","removePlayback","videoBlob","getOrCreatePlayback","audioBlob","createObjectURL","updatePlayback","notHandled","trackStates","vrmRigs","onContentUpdateRequest","onContentRemoveRequest","cur","findPlayback","defaultBackgroundFill","defaultBackgroundColor","roomProps","backgroundFill","backgroundColor","roomDetails","image","getNotificationPermission","Notification","permission","requestPermission","notification","syncLog","DataSync","connection","bSendRandP","sendPoseMessage","sendMouseMessage","sendInformation","sendOnStage","sendTrackStates","sendViewpointNow","sendMyContents","sendAfkChanged","poseStr","sendMessage","mouseStr","limits","flushSendMessages","updatedContents","contentsDataToSend","removedIds","sendContentUpdateRequest","roomContents","roomInfo","onUpdateProp","rig","ids","participantLeft","leave","ts","caller","calledBy","icon","afk","errorInfo","setType","found","kickTimes","kt","reload","newContent","updateByRemoteRequest","testBot","participantJoined","participantNameChanged","states","distance","l","connectedPids","yarnPhones","bmRelayServer","roomContentsInfo","cds","removeByRemoteRequest","callTo","sendParticipantInfo","sendAudioLevel","sendVrmRig","yarnPhoneUpdated","msgs","recordMessage","onRoomProp","sendAllAboutMe","onAfkChanged","onParticipantLeft","onCallRemote","onChatMessage","onContentInfoUpdate","onParticipantInfo","onParticipantMouse","onParticipantPose","onParticipantOnStage","onParticipantTrackState","onParticipantViewpoint","onParticipantAudioLevel","onParticipantTrackLimits","onParticipantVrmRig","onYarnPhone","onReloadBrower","onMuteVideo","onMuteAudio","onKicked","onParticipantOut","onMouseOut","onContentOut","checkInfo","pushOrUpdateMessageViaRelay","AudioMeter","context","analyser","source","BUFFERLEN","disconnect","AudioContext","createAnalyser","createMediaStreamSource","connect","fftSize","resume","Float32Array","getFloatTimeDomainData","dataLog","dataRequestInterval","stringArrayMessageTypesForClient","DataConnection","relaySocket","room_","lastRequestTime","lastReceivedTime","messagesToSendToRelay","relayRttLast","relayRttAverage","sync_","audioMeter_","stopStep","receivedMessages","onOpen","sync","onMessage","onClose","setHandler","onError","observeStart","observeEnd","setAudioLevel","audioMeter","getAudioLevel","deadline","period","onBmMessage","REQUEST_WAIT_TIMEOUT","area","visibleArea","audibleArea","updateAudioLevel","sendRandP","dest","idx","oldV","ne","waitAndSend","priorityLog","debug","getIdFromProducer","extractRemoteObjectInfo","inLocalsZone","priority","extractLocalObjectInfo","videoAudioTrackInfoDiff","videos","audios","trackInfoMerege","va","PriorityCalculator","conf","updateAll","updateSet","limitUpdated","priorityMaps","lastContentVideos","lastParticipantVideos","lastAudios","_enabled","UPDATE_INTERVAL","intervalId","remoteDisposers","intervalHandle","rtcConnection","enable","update","disable","setLimits","tracksToConsume","localChangeDisposer","disposer","haveUpdates","calcPriority","producersForMainScreen","remotePeers","producers","objInfo","calcPriorityValue","prioritizedTrackInfoLists","priorityMap","removeLocalTrackByRole","sz","others","index","onRemoveObject","rp","isContentRtc","isEqualMSRP","getStatFromRemotePeer","rtcConnection_","remotePeers_","localProducers","sendTransport_","priorityCalculator","dataConnection_","localMicTrack","localCameraTrack","oldTracks","added","removed","addConsumer","removeConsumer","dataConnection","isConnected","KICK_WAIT_MIN","createTransport","on","callback","errback","connectTransport","produceTransport","paused","consumers","resumeConsumer","sendTransport","maxBitRate","removeByLocal","replaceTrack","getSendTransport","produce","encodings","maxBitrate","removeTrack","closeProducer","counter","getConsumer","getReceiveTransport","consumeTransport","consumeParams","consume","connectionState","removeLocalTrack","setSource","addOrReplaceLocalTrack","doSetLocalCameraTrack","msremotes","msr","addeds","removeds","msrp","current","addedProducers","onProducerRemoved","onProducerAdded","newRemote","msp","remoteIds","ps","onAddProducer","removes","onRemoveProducer","addRemoteTrack","removeRemoteTrack","TITLE_HEIGHT","zorderComp","contentIdCounter","beforeChangeEditing","wallpapers","screenFps","zone","closeds","closedZones","closedZone","pat","mainScreenOwner","mainScreenStream","getTracks","getOrCreateContentTracks","getVideoTracks","getAudioTracks","shareContent","addLocalContent","getUniqueId","playbackContents","newAll","newSorted","reverse","nWallpapers","assignId","updateByLocal","toRemove","disposeContent","sendContentRemoveRequest","onUpdateScreenContent","participantsStore","setEditing","peerAndTracks","closeTrack","SCALE_LIMIT","HALF","keyInputUsers","loadMatrixFromStorage","committedMatrix","updateViewpoint","scale","updateViewpointCenter","fromWindow","saveMatrixToStorage","matrixBeforeZoom","inverse","im","newMat","preMultiplySelf","setMatrix","setCommittedMatrix","matrixOrg","contentSize","scales","newScale","oldScale","offsetFromElement","rb","ar","DOMMatrixReadOnly","videoInputs","audioInputs","audioOutputs","canvas","oscillator","types","diffSet","supressedTypes","next","mediaDevices","enumerateDevices","devices","skipEntrance","when","checkConnection","startTestBot","isRtcConnected","isDataConnected","checkMic","getLocalMicTrack","ctxA","createOscillator","destination","createMediaStreamDestination","ctx","getContext","random","frequency","setValueAtTime","currentTime","nearestVideo","nearestAudio","fillStyle","beginPath","ellipse","fill","chars","randChar","move","win","requestIdleCallback","moveTask","videoTrack","captureStream","audioTrack","setLocalCameraTrack","setLocalMicTrack","AfkDialog","useEffect","evKey","code","preventDefault","stopPropagation","DialogContent","fontSize","Button","variant","textTransform","autoFocus","onKeyDown","onClick","displayName","CATEGORIES","generateRoomWithoutSeparator","arr","roomName","template","defaultRoom","dialogs","props","ErrorDialogFrame","Dialog","maxWidth","fullWidth","fullScreen","DialogTitle","disableTypography","children","ErrorDialog","Box","mt","mb","ml","loginClick","userType","getUserType","TheEntrance","useState","setName","savedRoom","active","setActive","mapData","roomURL","concatURL","setRoom","nameArr","setNameArr","passedPlaceholder","placeholder","setPlaceholder","placeholderIndex","setPlaceholderIndex","uName","onErrorClose","ctrlKey","removeEventListener","intr","clearTimeout","inner","cTimer","scaleVal","changeMatrix","scaleSelf","_timerUserPlace","placeUserAtBlank","save","saveInformationToStorage","history","replaceState","endScreen","randX","randY","entries","setMouse","focusOn","tfIStyle","padding","tfLStyle","marginLeft","tfLNStyle","overflowY","overflowX","transition","textAlign","right","display","language","changeLanguage","transform","userSelect","draggable","bgCircle","alt","peopleLogin","InputLabel","Input","disableUnderline","inputProps","onChange","target","btnGo","logo_es","MAX","MySlider","Grid","container","spacing","Slider","valueLabelDisplay","setValue","valueLabelFormat","RemoteTrackLimitControl","useObserver","videoSlider","audioSlider","FormControlLabel","control","label","passMatched","disabled","sendTrackLimits","AdminConfigForm","React","clearName","setClearName","showFillPicker","setShowFillPicker","showColorPicker","setShowColorPicker","fillButton","useRef","colorButton","textForFill","textForColor","btnColor","TextField","marginTop","password","currentTarget","onKeyPress","pass","newPassword","setRoomProp","removeAllContents","Popover","anchorEl","anchorOrigin","vertical","horizontal","disableAlpha","useStyles","makeStyles","root","formControlLabel","BroadcastControl","classes","audioBroadcastSwitch","Checkbox","htmlColor","checkedIcon","className","checked","setPhysics","Container","Typography","moreButtonControl","setShowMore","member","onMouseOver","nativeEvent","sourceCapabilities","firesTouchEvents","MoreButton","Zoom","in","IconButton","onClickMore","buttonRef","theme","marginRight","marginBottom","pointerEvents","FabMain","tDelay","isOpen","divRef","Fab","onMouseDown","onDown","onTouchStart","onContextMenu","onFocus","transitionDelay","iconColor","FabWithTooltip","Tooltip","placement","arrow","paddingTop","acceleratorText2El","videoEl","imageEl","canvasBufEl","DialogIconItem","plain","secondEl","tip","dense","textEl","item","ListItem","button","alignItems","ListItemAvatar","verticalAlign","enterDelay","lms","imageLoaded","drawFace","canvasEl","face","strokeStyle","lineWidth","lineCap","fillRect","crossOrigin","remove","drawImage","nameArray","initial","getTextColorRGB","font","textBaseline","fillText","landmarks","positions","paths","eyes","drawStrokes","ctx2","path","moveTo","x","y","lineTo","closePath","stroke","lastPos","lastWidth","lastNose","filteredPos","filteredWidth","filteredNose","loaded","stopFaceTrack","srcObject","nodding","createLocalCamera","did","videoInputDevice","getUserMedia","video","deviceId","rtc","loadTinyFaceDetectorModel","loadFaceLandmarkTinyModel","autoplay","ops","TinyFaceDetectorOptions","inputSize","scoreThreshold","detectSingleFace","withFaceLandmarks","videoWidth","videoHeight","currentPos","detection","relativeBox","currentWidth","currentNose","diffWorldPos","diffWidth","diffAvatarPos","diffNose","newNodding","moveAvatar","CameraSelectorMember","CameraSelector","setStep","videoMenuItems","cameras","selected","keyStr","fromCharCode","MenuItem","makeMenuItem","closeVideoMenu","msTrack","keyNum","GoogleDriveImport","onSelectedFile","gapiPickerReady","createTheme","palette","primary","main","secondary","mainContainer","menuContainer","galleryMain","minWidth","minHeight","border","gallery","gridTemplateColumns","gap","alignContent","deavticeButtons","fontWeight","borderBottom","cursor","avticeButtons","selectedImage","getSelectedImage","onFinishInput","inputField","pageIndex","setPageIndex","setData","folders","images","tempArr","dataFolderWise","j","_ITEMS","imgArr","_itemIndex","ActiveThis","encodeURIComponent","objectFit","EnableThis","_pageIndex","items","List","preview","dZoneStyle","dZoneTextStyle","ImageInput","setFiles","setUploadType","field","acceptedFiles","dropzoneText","dropzoneClass","dropzoneParagraphClass","previewGridProps","direction","previewChipProps","FormControl","component","FormLabel","RadioGroup","flexDirection","Radio","imageContent","SettingInput","dropZoneTitle","SettingImageInput","setDesc","setReset","uploadedPath","descText","initialFiles","clearOnUnmount","filesLimit","multiline","rowsMax","InputProps","InputLabelProps","overflow","ShareMenu","showMouse","infos","createText","tc","cordX","cordY","origin","createScreen","getDisplayMedia","frameRate","ideal","startCapture","clipboard","readText","rand","crypto","getRandomValues","randStr","createWhiteboard","getLocalRtcContentIds","row","setScreenFps","Divider","TextInput","textLabel","remainProps","isDialogOpen","ShareDialog","assignType","pasteEnabled","menu","iframe","zoneimage","roomImage","none","camera","page","getPage","onExited","onPointerMove","clientX","clientY","PaperProps","SettingsControl","fileInput","setShow","openDownload","contentAll","contentsToSave","ResetFlag","status","Reset","download","click","revokeObjectURL","downloadItems","importItems","itemsRecv","ResetRoomElements","isArray","RoomElements","clientHeight","openImport","accept","BroadcastVideoControl","videoBroadcastSwitch","saveMediaSettingsToStorage","videoBroadcastSpeakSwitch","StereoSwitchControl","stereo","headsetBroadcastSwitch","buttonStyle","margin","borderRadius","menuActive","menuTop","menuActiveTop","topMenu","topMenuActive","more","moreActive","outline","topContainer","wrapper","wrapperInner","Member","timeoutOut","touched","downTime","upTime","buttonClickStatus","Footer","showPop","setShowPop","showAdmin","setShowAdmin","openSettiong","setOpenSettiong","openAdmin","closeAdmin","containerRef","adminButton","deviceInfos","setDeviceInfos","micMenuEl","setMicMenuEl","speakerMenuEl","setSpeakerMenuEl","videoMenuEl","setVideoMenuEl","settingsMenuEl","setSettingsMenuEl","mouseOnBottom","audioInputDevice","audioOutputDevice","metaKey","altKey","settingsMenuItems","getMenuItems","closeMenu","bottomItem","closeMicMenu","closeSpeakerMenu","updateDevices","muteA","muteS","muteV","fabSize","iconSize","Collapse","float","ExitAppIcon","writeText","MoreIcon","Menu","keepMounted","Boolean","megaphoneIcon","getSeconds","anchorReference","styleCommon","back","previous","activeSlide","slide","styleForSplit","resizerVertical","background","boxSizing","backgroundClip","borderLeft","borderRight","resizerHorizontal","borderTop","styleForList","justifyContent","justifyItems","userDrag","whiteSpace","outer","line","avatarCommon","addBoarder","borderStyle","borderWidth","borderColor","imageAvatar","textAvatar","RawImageAvatar","isImage","Avatar","ImageAvatar","useMemo","formatTimestamp","stamp","textDate","year","month","date","getDate","makeLink","regResult","disp","rel","textToLinkedText","textToShow","urlReg","urlRegExp","RegExp","exec","before","colorMapBlack","private","colorMapWhite","ChatLine","lineHeight","colorMap","backColor","localUser","wordWrap","sendChatMessage","sendTo","ChatInBar","setText","resize","noValidate","autoComplete","nameTo","onBlur","keyCode","useTransparent","iframeEdit","iframeVScrool","divScroll","divClip","divError","updateUrl","getStringFromParams","updateAndSend","GDrive","scrolling","onscroll","setApiKey","fields","getInformationOfGDriveContent","isNaN","scrollTop","doSendScroll","sendScroll","throttle","endScroll","debounce","vscroll","isGDrivePreviewScrollable","onWheel","GlobalWorkerOptions","workerSrc","newProps","mainUrl","pages","renderTask","textDiv","annotationDiv","prevSize","pageNum","viewport1","getViewport","updateOnly","viewport","cancel","render","canvasContext","getTextContent","textContent","childNodes","renderTextLayer","textDivs","transformOrigin","numPages","pageText","getDocument","cMapUrl","cMapPacked","doc","isFinite","stopper","onMouseUp","onPointerDown","onPointerUp","PDF","refCanvas","refTextDiv","refAnnotationDiv","updateProps","onDoubleClick","CANVAS_SCALE","onPointerEnter","showTop","onPointerLeave","PlaybackScreenContent","ScreenContent","setMuted","simulcastRatios","timer","onmute","onunmute","newSize","sx","sy","TextMember","isStatic","abortScroll","onUpdateTexts","div","newTexts","scrollLeft","newUrl","sendText","messagesToSend","TextEdit","sendTextLaterRef","leading","sendTextLater","css","visibility","letterSpacing","TextDiv","overflowWrap","cssEdit","Fragment","suppressContentEditableWarning","textEditing","Node","selection","getSelection","rangeCount","getRangeAt","removeAllRanges","range","createRange","selectNode","addRange","cssText","textEdit","Text","setBeforeChangeEditing","indices","newMessage","focusToEdit","last","handleScroll","onScroll","setAudioOutputDevice","audioEx","setSinkId","BROADCAST_DISTANCE","NodeGroup","playMode","audibility","sourceNode","audioElement","gainNode","pannerNode","audioDeviceId","_defaultPannerRefDistance","createGainNode","createPannerNode","updateAudibility","pause","createAudioElement","play","updateVolume","updateSourceStream","setPlayMode","dist","mul","refDistance","positionX","orientationX","positionY","positionZ","orientationY","orientationZ","setPosition","setOrientation","volume","rolloffFactor","broadcast","defaultPannerRefDistance","gain","createGain","createPanner","Audio","NodeGroupForPlayback","audioElementForBlob","playSourceBlob","createMediaElementSource","playAgain","group","playAgain2","stereoParameters","refDistanceNormal","setBroadcast","bcast","PLAYTIME_TOLERANCE","getCurrentTimestamp","YTMember","goal","skipOnPlaying","pauseIntervalTimer","lastCurrentTimePaused","playTimeout","pauseTimeout","prevRelPos","volumeUI","volumeDist","prevVolumeDist","volumeIntervalTimer","paramStr2map","paramArray","paramArray2map","clearAllTimer","ytSeekAndPlay","seekTo","getPlaybackRate","getState","getPlaylist","getPlaylistIndex","getCurrentTime","seekTarget","onTime","getDuration","playVideoAt","seek","TIMETOSEEK","ytSeekAndPause","pauseCheck","indexStr","ytUpdateState","newState","sep","paramMap2Str","ytPauseInterval","calcVolume","setVolume","checkPositionsForVolume","curVolume","getVolume","updateUIVolume","relPos","YouTube","oldParams","map1","map2","testVal","shallowEqualsForMap","setPlaybackRate","newPlaying","moveToPlay","newPaused","moveToPause","selfPlayed","YouTubePlayer","unMute","indexUpdated","started","loadList","listType","destroy","contentTypeIcons","icons","youtube","gdrive","GoogleDriveIcon","whiteboard","whiteboard24Regular","pdf","filePdfBox","playbackScreen","playbackCamera","editButtonTip","RawContent","Content","Row","left1","left2","right2","right1","cellstyle","centerCellstyle","TableRow","TableCell","align","SharedContentFormMember","SharedContentForm","closeForm","popoverProps","autoHideTitle","extractPopoverProps","tms","paramUrl","copyContentToClipboard","clipboardCopy","Table","TableBody","biImage","Switch","imageLine","flag","makeContentWallpaper","imageOutlineBadged","biImageNoFrame","hiMeeting","roomClosed","roomOpen","biDashCircleDotted","biPlusCircleFill","restore","ConnectionStat","toFixed","ConnectionQualityDialog","SignalQualityIcon","qualityIcon","SignalQualityButton","setOpen","tfDivStyle","iStyle","LocalParticipantForm","setFile","showTextColorPicker","setShowTextColorPicker","closeConfig","clearAvatarSrc","uploadAvatarSrc","textColorButton","sendTransportStat","getColorRGB","textRgb","onSubmit","clipPath","videoLargerWidth","mirror","videoLargerHeight","StreamAvatar","videoRef","videoLargerWidthClass","videoLargerHeightClass","onloadedmetadata","setStream","defaultProps","ComposedAvatar","ConnectedAvatar","showVideo","MemoedAvatar","PromiseGLTFLoader","onProgress","GLTFLoader","VRMAvatar","memberRef","clock","THREE","renderer","antialias","scene","mem","setSize","setPixelRatio","devicePixelRatio","light","normalize","loader","dispo","promiseLoad","gltf","VRMUtils","removeUnnecessaryJoints","VRM","vrmGot","rotation","render3d","ori","rigs","rigRotation","Euler","riggedFace","rot","z","Blendshape","blendShapeProxy","PresetName","VRMSchema","BlendShapePresetName","eyeL","clamp","eye","eyeR","BlinkL","BlinkR","I","lerp","mouth","shape","getValue","A","E","O","U","lookTarget","oldLookTarget","pupil","copy","lookAt","applyer","rigFace","Hips","Spine","RightUpperArm","RightLowerArm","LeftUpperArm","LeftLowerArm","LeftUpperLeg","LeftLowerLeg","RightUpperLeg","RightLowerLeg","leftHand","LeftHand","LeftWrist","LeftRingProximal","LeftRingIntermediate","LeftRingDistal","LeftIndexProximal","LeftIndexIntermediate","LeftIndexDistal","LeftMiddleProximal","LeftMiddleIntermediate","LeftMiddleDistal","LeftThumbProximal","LeftThumbIntermediate","LeftThumbDistal","LeftLittleProximal","LeftLittleIntermediate","LeftLittleDistal","rightHand","RightHand","RightWrist","RightRingProximal","RightRingIntermediate","RightRingDistal","RightIndexProximal","RightIndexIntermediate","RightIndexDistal","RightMiddleProximal","RightMiddleIntermediate","RightMiddleDistal","RightThumbProximal","RightThumbIntermediate","RightThumbDistal","RightLittleProximal","RightLittleIntermediate","RightLittleDistal","vrmSetPose","getDelta","Kalidokit","dampener","lerpAmount","Part","humanoid","getBoneNode","HumanoidBoneName","euler","quaternion","setFromEuler","slerp","SVG_RATIO","animCount","pointerRotate","pointer","avatarGlow","avatarGlowEffect","signalIcon","iconProximity","iconEmoticon","iconEmoticonNone","conIcon","pingLocIcon","RawParticipant","participantProps","mousePosition","inZone","_icons","_connQuality","zoneId","localZoneId","proxCords","remoteDist","localPos","_pingIcon","_pingX","_pingY","togglePingSound","setTogglePingSound","pingXY","setPingXY","anim","setAnim","xPos","yPos","xClick","xAvatar","decodeAudioData","audioBuffer","createBufferSource","panNode","createStereoPanner","pan","playToggleIcon","_timer","outerRadius","AUDIOLEVELSCALE","svgCenter","shadow","xmlns","audioMeterSteps","cy","cx","strokeDasharray","strokeDashoffset","iconMeter","outerUnder","useVrm","zoneGlowIcon","symSmileIcon","symHandIcon","symClapIcon","isPlayback","Participant","hideMenuContainer","showMenuContainer","dashedCircle","moreIcon","avatarTool","moreInfo","galleryList","LocalMember","prebThirdPersonView","mouseDown","dragging","downXpos","downYpos","upXpos","upYpos","contentX","contentY","zoomX","zoomY","moveX","moveY","clickStatus","userAngle","clickEnter","hidePinIcon","cursorX","cursorY","onLocalUser","getOnLocalUser","isConteMenuOpen","selectedGroup","selectedSkin","selectedHairColor","selectedHair","selectedHairBack","selectedOutfits","selectedSpecs","isAvatarToolOpen","getAvatarToolStatus","onDrag","xy","norm","localDelta","rotateFromWindow","smoothedDelta","savePhysicsToStorage","moveParticipant","drag","handle","onTimer","memo","timerFunc","timerAgain","timerId","onTouchMove","passive","bindObject","buttons","el","clsToFind","attributes","cls","getNamedItem","parentNode","checkClass","setPointerCapture","pointerId","onPointerOut","releasePointerCapture","onTouchEnd","deltaT","DragHandler","ratio","posOnScreen","mapMove","trans","changed","transMap","rotateToWindow","scrollAgain","scrollMap","setShowConfig","preventScroll","styleProps","showConfig","moreControl","showMenu","setShowMenu","showTool","setShowTool","activeOutfit","setActiveOutfit","activeSpecs","setActiveSpecs","activeSkin","setActiveSkin","activeHair","setActiveHair","activeGroup","setActiveGroup","activeFrontHair","setActiveFrontHair","activeBackHair","setActiveBackHair","refAvatar","openConfig","openAvatarTool","randSkinIndex","randomAvatarDetails","randHairColorIndex","randGroupIndex","imgArrHairs","imgArrOutFit","randomOutfitIndex","imgArrSpecs","randomSpecsIndex","frontHairs","frontHairIndex","backHairs","backHairIndex","hairType","randomHairIndex","findBack","getNewUserAvatarData","filterHairsWithSelectedSwatch","hairImgArray","findFront","old_index","new_index","ElementShift","_ITEMS_SKIN","_ITEMS_GROUP","_ITEMS_HAIR","onCloseDialog","onApplyChanges","html2canvas","allowTaint","toDataURL","_path","generateRandomNumber","useGesture","onDragStart","mouseX","mouseY","downTimer","diffX","diffY","down","onDragEnd","tagName","onMove","touches","changedTouch","changedTouches","elementFromPoint","nodeName","eventOptions","boxShadow","BackdropProps","invisible","imgHairArr","randFrontHairIndex","imgOutfitArr","randOutfitIndex","imgSpecsArr","randSpecsIndex","onGenerateRandomAvatar","MemoedLocalParticipant","RemoteParticipantForm","kick","setKick","setClear","call","remoteContents","callIcon","yarnPhoneIcon","buttonStyleActive","chatIcon","focusIcon","kickIcon","RemoteMember","onRemoteUser","getOnRemote","showMore","showForm","setShowForm","itemLocked","getContentLocked","_onContent","isOnContentStatus","_dialogStatus","getContentDialogStatus","ChatIcon","KickIcon","limitScale","currentScale","targetScale","uploadZone","PingLocation","PingLocationHide","BaseMember","touchStart","touchEnd","canvasMoved","isCanvasMoved","dblTouchTapCount","Base","mapRot","newMatrix","rotateMap","avatarRot","rotateSelf","givenTarget","hindleClickStatus","isEdit","checkContentsInEdit","ExitAllFromEditMode","setPingLocation","moveTimer","_onRemoteUser","_contentDialogStatus","_focusLocalUser","_avatarToolStatus","getContentDeleteDialogStatus","showUploadOption","setShowUploadOption","_menuStatus","getContextMenuStatus","centerOnMap","radius1","radius2","cosAngle","angle","acos","contentContextMenu","isUserContentOpen","detail","onPinch","da","md","ma","onPinchEnd","dblClick","onResizeOuter","topWindowHandler","visualViewport","deltaY","offsetLeft","offsetParent","setScreenSize","clientWidth","setLeft","onResize","evt","UploadShare","RndContentMember","dragCanceled","_borderTimer","_down","_item","downPos","downXPos","movePos","moveXPos","onContent","onContext","isMoved","OnTimerClick","intervalStep","_zIndex","_clickX","_clickY","_checkForRotation","_onContentForEdit","contextMenuStatus","isLocaked","_contentDialogOpen","_contentDeleteDialogOpen","_isOnContent","RndContent","setPose","resizeBase","setResizeBase","resizeBasePos","setResizeBasePos","setShowTitle","preciseOrientation","setPreciseOrientation","setDragging","rnd","titleDisplay","showBorder","setShowBorder","showDelete","setShowDelete","showOnRotation","setShowOnRotation","mDeleteTimer","showHandler","setTime","_msgTitle","setPoseAndSizeToRnd","resizable","titleHeight","updatePosition","updateSize","onLeaveIcon","showHideTimer","updateHandler","_bTimer","showHideBorder","_mTimer","isEqual","useLayoutEffect","isFixed","stopTimeValue","handlerForTitle","newOri","shiftKey","lv","cv","dragHandler","Element","PointerEvent","mMenuTimer","ROTATION_STEP","CENTER_IN_RATIO","RotateContent","yCheck","xCheck","onMouseMove","touch","canvasStat","resetCounter","_delay","handlerForContent","_title","contentRef","formRef","gestureForContent","gestureForTitle","theContent","rndContainer","nameContainerHolder","nameContainer","stopWatchTitleHolder","stopWatchTitle","dashedInEdit","dashed","crossIcon","titlePosition","titleContainer","onMouseLeave","DialogActions","rndCls","enableResizing","resizeDisable","resizeEnable","disableDragging","onResizeStart","cd","posChange","deltaPos","onResizeStop","resizeHandleStyles","topLeft","cursorStyles","topRight","bottomLeft","bottomRight","dragHandleClassName","titleContainer_dialog","moveTopButton_dialog","moveBottomButton_dialog","prox_dialog","proximityOffIcon","titleButton_dialog","close_dialog","uploadZone_dialog","stopWatch_dialog","scaleRotate_dialog","dashedCircle_dialog","buttonStyleDisabled","mat","hideAll","heihgt","zoomValue","zoomRatio","tPos","lPos","note","pin","onShare","pin_dialog","prox","titleButton","stopWatch","uploadImage","moveTopButton","moveBottomButton","copyClipButton","edit","sharedContentHandler","updateLocalOnly","SharedContent","locatedContentOnly","ContentLine","contentProps","targetContent","userName","userAvatar","colorsIcon","contentInfo","typeIcon","requestContent","ContentList","localeCompare","contentLength","elements","ap","StatusDialog","senderStat","receiverStats","servers","len","lastIndexOf","serverAddr","sameAddr","tStatSum","poperProps","Popper","disablePortal","Paper","server","ParticipantLine","getColorOfParticipant","propsForForm","classesIcons","zoneName","_iconsRemote","_iconsLocal","localZone","RawParticipantList","showStat","setShowStat","statusProps","lineProps","pa","pb","sensitivity","remoteElements","localElement","ParticipantList","defaultTextLineHeight","textLineStyle","LeftBar","doSetScale","cContent","setScale","_menuSelected","_menuType","_menuSelectedPos","_menuPos","defaultSize","resizerClassName","paneStyle","allowTransparency","frameBorder","videoContainer","MainScreen","debugVideos","refs","showAllTracks","createRef","debugVideo","MouseCursor","viewBox","points","strokeWidth","Line","end","x1","y1","x2","y2","ParticipantLayer","store","rs","lines","rid","playbackElements","remoteMouseCursors","localMouseCursor","PastedContent","setContent","dataTransfer","reasons","getAsFile","creator","getAsString","createContentsFromDataTransfer","clipboardData","dropEffect","pastedContent","setPasted","nc","slContainer","ShareLayer","transparent","filtered","logo","Background","emoticonActive","Emoticons","toggleSmile","setToggleSmile","toggleClap","setToggleClap","toggleHand","setToggleHand","checkMouseOnBottom","setShowFooter","toggleSmileButton","smileIcon","toggleClapButton","clapIcon","toggleHandButton","handIcon","tapBroadcast","textShadow","tapBroadcastText","hidetapBroadcast","fab","fabActive","vidicon","vidiconActive","ZoneAvatar","videoButtonStatus","userIndex","streamUser","setStreamUser","onlyInA","comparer","onlyInB","concat","otherArray","other","localStream","startStream","rgbR","avLocalStream","avStream","toggleStream","setToggleStream","toggleUI","setToggleUI","liveTimer","setLiveTimer","dispText","nTime","App","mapStore","sharedContentsStore","chatStore","refDiv","able","setAble","showIntro","setShowIntro","menuType","setMenuType","showHelp","setShowHelp","activeTabIndex","setActiveTabIndex","refEntity_0","refEntity_1","refEntity_2","refEntity_3","refEntity_4","refEntity_5","refEntity_6","refEntity_7","refEntity_8","roomImgPath","roomImgDesc","activeBgColor","AllMenusTypes","press","loginStatus","_roomName","enterUserType","uiData","setUIData","sliderData","sliderDots","genImage","onGenImageForNewUser","introTimer","currentSlide","setCurrentSlide","slidesLength","trackPos","_index","_menu","CheckAndSetPosition","CheckAndActivateMenu","moveIndex","setTrack","_url","ResetAppsPanel","externalWindow","closed","capture","lineno","colno","clicks","onTabMenuClick","getTime","tabType","tabIndex","tabURL","doubleClick","pane2Style","minSize","defaultPosition","tabBGTopBGMob","tabChatActive","tabBGTopBGWeb","bounds","stereoParametersStore","audioLog","getRelativePoseFromObject","localPose","remotePose","fromLT","ConnectedGroup","obsLocal","clone","relativePose","remoteInLocalsZone","inOtherClosedZone","updatePose","contentInLocalsZone","getContentTrack","updateStream","updatePannerConfig","updateBroadcast","ConnectedGroupForPlayback","playBlob","StereoManager","audioContext","audioDestination","nodes","audioOutputMuted","node","accepts","suspend","setAudioOutput","enabled","manager","connectedGroups","remotesMemo","playbacksMemo","contentsMemo","playbackContentsMemo","onRemotesChange","newRemotes","removeRemote","addRemote","onPlaybacksChange","newPlaybacks","addPlayback","onPlaybackContentsChange","newPlaybackContents","addPlaybackContent","onScreenContentsChange","audioRemoteContents","getRemoteRtcContentIds","removeContent","addContent","pp","dispose","removeSpeaker","pc","addSpeaker","switchPlayMode","holistic","Holistic","locateFile","setOptions","modelComplexity","smoothLandmarks","minDetectionConfidence","minTrackingConfidence","refineFaceLandmarks","faceMesh","FaceMesh","maxNumFaces","refineLandmarks","runMeidaPipe","stopMpTrack","isMicMuted","audioManager","isCameraMuted","onStart","renderDOM","ReactDOM","getElementById","faceOnly","rtcVideo","videoConstraints","onResults","results","facelm","multiFaceLandmarks","solve","runtime","faceLandmarks","poselm","poseLandmarks","poselm3d","za","rightHandlm","rightHandLandmarks","leftHandlm","leftHandLandmarks","imageSize","enableLegs","detector","startMpTrack","getLocalCameraTrack","configure","enforceActions","use","initReactI18next","i18nLanguageDetector","startPromise","startConference","logStr","stopImmediatePropagation","returnValue","connectionStart","enter"],"mappings":"6TAEO,IAAMA,ECUN,SAAyBC,GAC9B,IAAMC,EAAS,IAAIC,IAAIC,UAAUH,IAG3BI,EAFQ,CAAC,OAAQ,OAAQ,YAAa,UAAW,WAAY,UAAW,UAAW,gBAE/DC,QACxB,SAACC,EAAKC,GAGJ,OAFAD,EAAIC,GAAQN,EAAOO,aAAaC,IAAIF,GAE7BD,IAET,IAKF,OAFAF,EAAIM,KAAOT,EAAOU,SAASC,OAAO,GAAGC,QAAQ,QAAS,MAAQT,EAAIM,KAAON,EAAIM,KAAO,IAE7EN,EDzBoBU,CAAgBC,OAAOC,SAASC,M,QEFtD,SAASC,EAAOC,GACrB,IAAKA,EACH,MAAM,IAAIC,MAAM,sBAWM,SAASC,KAAKC,UAAUC,WAC1B,SAASF,KAAKC,UAAUC,YAAc,aAAaF,KAAKC,UAAUE,QAkBnF,SAASC,EAAmBC,EAAcC,GAC/C,IAD6D,EACvDC,EAAO,IAAIC,IAAWH,GADiC,cAE1CC,GAF0C,IAE7D,2BAAsB,CAAC,IAAZG,EAAW,QACpBF,EAAKG,OAAOD,EAAK,KAH0C,8BAM7D,OAAOF,EAmCF,SAASI,IACd,QAAIV,UAAUC,UAAUU,MAAM,0BAOzB,SAASC,IACd,OAAInB,OAAOoB,OAAOC,OAAOC,MAAQtB,OAAOoB,OAAOC,OAAOE,OAOjD,SAASC,EAAUvC,GACxB,OAAQA,EAAIwC,OAASzB,OAAOC,SAASwB,MAAQxC,EAAIW,WAAaI,OAAOC,SAASL,S,YCtFzE,SAAS8B,EAAcC,GAC5B,OAAOC,KAAKC,IAAID,KAAKE,KAAKH,EAAOhB,GAAKiB,KAAKG,KAAKH,KAAKI,IAAIL,EAAOhB,EAAG,GAAKiB,KAAKI,IAAIL,EAAOM,EAAG,KAGtF,SAASC,EAAcP,GAC5B,OAAOC,KAAKC,IAAID,KAAKE,KAAKH,EAAOQ,GAAKP,KAAKG,KAAKH,KAAKI,IAAIL,EAAOf,EAAG,GAAKgB,KAAKI,IAAIL,EAAOQ,EAAG,KAUtF,SAASC,EAAgBT,GAC9B,OAAOC,KAAKS,OAAOV,EAAOM,EAAGN,EAAOhB,GAG/B,SAAS2B,EAAYC,EAAyBC,EAA6BC,GAA+B,IAAD,EACxGC,GAAM,IAAIC,WAAaC,WAAWL,EAAO,IAAKA,EAAO,IACrDM,GAAO,MAAIF,WAAaG,cAAlB,oBAAmCP,IAG/C,MAF2B,CAACM,EAAKL,EAAUE,EAAID,GAzBjCnD,QAAO,SAACyD,EAAcd,GAAf,OAAqBc,EAAEC,aAAaf,KAAI,IAAIU,WA8B5D,SAASM,EACdtB,EAAuCuB,GACvC,MAAO,CACLvB,EAAOhB,EAAIuC,EAAM,GAAKvB,EAAOM,EAAIiB,EAAM,GAAKvB,EAAOwB,EACnDxB,EAAOf,EAAIsC,EAAM,GAAKvB,EAAOQ,EAAIe,EAAM,GAAKvB,EAAOyB,GAIhD,SAASC,EACd1B,EAAuCuB,GACvC,MAAO,CACLvB,EAAOhB,EAAIuC,EAAM,GAAKvB,EAAOM,EAAIiB,EAAM,GACvCvB,EAAOf,EAAIsC,EAAM,GAAKvB,EAAOQ,EAAIe,EAAM,IC3BpC,SAASI,EAAM3C,EAAYC,GAChC,MAAO,CAACD,EAAE,GAAKC,EAAE,GAAID,EAAE,GAAKC,EAAE,IAEzB,SAAS2C,EAAM5C,EAAYC,GAChC,MAAO,CAACD,EAAE,GAAKC,EAAE,GAAID,EAAE,GAAKC,EAAE,IAEzB,SAAS4C,EAA2CC,EAAMC,GAC/D,OAAOA,EAAEC,KAAI,SAAAR,GAAC,OAAIM,EAAEN,KAEf,SAASS,EAAMjD,EAAU+C,GAC9B,MAAO,CAAC/C,EAAI+C,EAAE,GAAI/C,EAAI+C,EAAE,IAKnB,SAASG,EAAMH,GACpB,IAAII,EAAM,EAGV,OAFAJ,EAAEK,SAAQ,SAAAZ,GAAC,OAAIW,GAAOX,EAAIA,KAEnBvB,KAAKG,KAAK+B,GAGZ,SAASE,EAAcC,GAC5B,OAAOA,EAASrC,KAAKsC,GAAK,IAGrB,SAASC,EAAcC,GAC5B,OAAgB,IAATA,EAAexC,KAAKsC,GAItB,SAASG,EACdC,EACAC,GAEA,IAAMH,EAASJ,EAAcM,EAAKE,aAC5Bf,EAAI7B,KAAK6C,IAAIL,GACbnC,EAAIL,KAAK8C,IAAIN,GAEbO,EAAqB,CAACJ,EAASK,SAAS,GAAKN,EAAKM,SAAS,GAAIL,EAASK,SAAS,GAAKN,EAAKM,SAAS,IAEpGC,EAAoC,CACxCF,EAAmB,GAAKlB,EAAIkB,EAAmB,GAAK1C,EACpD0C,EAAmB,GAAK1C,EAAI0C,EAAmB,GAAKlB,GAGhDe,EAAcD,EAASC,YAAcF,EAAKE,YAEhD,MAAO,CACLI,SAAUC,EACVL,YAAaA,EAAc,EAAIA,EAAc,IAAMA,GAIhD,SAASM,EAAyBC,GACvC,IAAMX,EAASJ,EAAce,EAAKP,aAElC,MAAO,CACLI,SAAU,CAACG,EAAKH,SAAS,GAAI,GAAIG,EAAKH,SAAS,IAC/CJ,YAAa,CAAC5C,KAAK6C,IAAIL,GAAS,EAAGxC,KAAK8C,IAAIN,KAIzC,SAASY,EACdf,EAAgBgB,GAChB,IAAMC,EAAMjB,GAAUrC,KAAKsC,GAAK,KAC1BjC,EAAIL,KAAK8C,IAAIQ,GACbzB,EAAI7B,KAAK6C,IAAIS,GAEnB,MAAO,CACLjD,EAAIgD,EAAO,GAAKxB,EAAIwB,EAAO,GAC3BxB,EAAIwB,EAAO,GAAKhD,EAAIgD,EAAO,IAKxB,SAASE,EAAaC,EAAwBC,GACnD,OAAOD,EAAK,GAAKC,EAAK,GAAKD,EAAK,GAAKC,EAAK,GAGrC,SAASC,EAAaC,GAC3B,OAAO3D,KAAKG,KAAKwD,EAAIjG,QAAO,SAACC,EAAKiG,GAAN,OAAcjG,EAAMiG,EAAMA,IAAK,IAgBtD,SAASC,EAAQV,EAAiBW,GACvC,GAAyB,IAArBX,EAAKP,YACP,MAAO,CAACO,EAAKH,SAAS,GAAIG,EAAKH,SAAS,GAAKc,EAAK,GAAIX,EAAKH,SAAS,GAAKc,EAAK,GAAIX,EAAKH,SAAS,IAElG,IAAMe,EAAKX,EAAuBD,EAAKP,YAAaO,EAAKH,UACnDgB,EAAKZ,EAAuBD,EAAKP,YAAa,CAACkB,EAAK,GAAI,IACxDG,EAAKb,EAAuBD,EAAKP,YAAa,CAAC,EAAGkB,EAAK,KACvDI,EAAK,CAACH,EAAG,GAAIA,EAAG,GAAGC,EAAG,GAAID,EAAG,GAAGE,EAAG,GAAIF,EAAG,GAAGC,EAAG,GAAGC,EAAG,IACtDE,EAAK,CAACJ,EAAG,GAAIA,EAAG,GAAGC,EAAG,GAAID,EAAG,GAAGE,EAAG,GAAIF,EAAG,GAAGC,EAAG,GAAGC,EAAG,IAI5D,OAHAC,EAAGE,MAAK,SAACrF,EAAEC,GAAH,OAASD,EAAEC,KACnBmF,EAAGC,MAAK,SAACrF,EAAEC,GAAH,OAASD,EAAEC,KAEZ,CAACmF,EAAG,GAAID,EAAG,GAAIC,EAAG,GAAID,EAAG,IAqB3B,SAASG,EAAe/C,EAAyBgD,EAAeC,GACrE,OAAOA,EAAK,IAAMjD,EAAM,GAAGgD,GAAUhD,EAAM,GAAGgD,GAAUC,EAAK,IACxDA,EAAK,IAAMjD,EAAM,GAAGgD,GAAUhD,EAAM,GAAGgD,GAAUC,EAAK,GAa7D,SAASC,EAAMC,GACb,OAAOzE,KAAKwE,MAAQ,IAAFC,GAAS,IAEtB,SAASC,EAASvB,GACvB,MAAM,GAAN,OAAUqB,EAAMrB,EAAKH,SAAS,IAA9B,YAAqCwB,EAAMrB,EAAKH,SAAS,IAAzD,YAAgEwB,EAAMrB,EAAKP,cAEtE,SAAS+B,EAAUC,GACxB,MAAM,GAAN,OAAUA,EAAM5B,SAAS,GAAzB,YAA+B4B,EAAM5B,SAAS,GAA9C,YAAoD4B,EAAMC,KAAK,IAAI,IAE9D,SAASC,EAASC,GACvB,IAAMC,EAAYD,EAAIE,MAAM,KAI5B,MAHuB,CAACjC,SAAS,CAACkC,OAAOF,EAAU,IAAKE,OAAOF,EAAU,KACvEpC,YAAYsC,OAAOF,EAAU,KAI1B,SAASG,EAAUJ,GACxB,IAAMK,EAAaL,EAAIE,MAAM,KAG7B,MAFoB,CAACjC,SAAS,CAACkC,OAAOE,EAAW,IAAIF,OAAOE,EAAW,KAAMP,OAAMO,EAAW,ICnLzF,SAASC,EAAaC,GAC3B,OAAO,kBAAM,IAAIC,SAAQ,SAACC,EAAqBC,GAC7C,IACEH,IACAE,IACA,MAAOE,GAEP,MADAD,EAAOC,GACDA,OCPL,SAASC,EAAkB7D,GAEhC,IADA,IAAII,EAAM,EACD0D,EAAI,EAAGA,IAAM9D,EAAE+D,OAAQD,GAAK,EACnC1D,EAAMJ,EAAEgE,WAAWF,GAAW,GAAN1D,EAE1B,IAAM6D,EAAM7D,EAAM,KAKlB,MAAO,CAAK,IAJFlC,KAAKgG,MAAMD,EAAM,KAAS,IAIhB,IAHV/F,KAAKgG,MAAMD,EAAM,IAAQ,IAGP,IAFlB/F,KAAKgG,MAAMD,GAAO,KAKvB,SAASE,EAAiBC,GAG/B,OAFkBC,EAAYD,GAAO,CAAC,IAAK,IAAK,KAAQ,CAAC,EAAE,EAAE,KAIxD,SAASC,EAAYD,GAC1B,OAAOA,EAAI,GAAKA,EAAI,GAAc,GAATA,EAAI,GAAW,IAGnC,SAASE,EAAoBF,GAClC,MAAO,CAAC,IAAIA,EAAI,GAAI,IAAIA,EAAI,GAAI,IAAIA,EAAI,IAGnC,SAASG,EAAUH,GACxB,MAAkB,CAAClG,KAAKgG,MAAME,EAAI,IAAKlG,KAAKgG,MAAME,EAAI,IAAKlG,KAAKgG,MAAME,EAAI,KAAhEI,EAAV,KAAatH,EAAb,KAGA,MAFW,WAAO,WADlB,KACwBuH,SAAS,KAAMC,OAAO,IAAnC,OAAwC,WAAIF,EAAEC,SAAS,KAAMC,OAAO,IAApE,OAAyE,WAAIxH,EAAEuH,SAAS,KAAMC,OAAO,IAc3G,SAASC,EAAe3E,GAE7B,OAXK,SAAoBoE,GACzB,IAAOQ,EAAYR,EAAI,GAAK,GAAlBI,EAAsBJ,EAAI,GAAK,GAA5BlH,EAAgCkH,EAAI,GAAK,GAChDS,EAAYR,EAAYD,GAAO,OAAS,OAI9C,MAAO,CAHI,WAAOQ,EAAEH,SAAS,KAAlB,OAAwBD,EAAEC,SAAS,KAAnC,OAAyCvH,EAAEuH,SAAS,KAGhDI,EAFG,YAAQ,GAAKD,GAAGH,SAAS,KAAzB,QAAgC,GAAKD,GAAGC,SAAS,KAAjD,QAAwD,GAAKvH,GAAGuH,SAAS,MAOpFK,CADKjB,EAAkB7D,IAIzB,SAAS+E,EAAKX,EAAcY,GACjC,MAAM,QAAN,OAAeZ,EAAI,GAAnB,YAAyBA,EAAI,GAA7B,YAAmCA,EAAI,GAAvC,YAA6CY,EAA7C,K,8ECzCK,SAASC,GAAEC,EAAcC,GAC9B,OAAOC,IAAKH,EAAEC,EAAKC,GAOd,SAASE,KAGd,OAFYC,cAKd,IAAMC,GAAY,CAChBC,GAAI,CAACC,YCtBoB,CACzBC,QAAS,sTAITC,aAAc,6CACdC,WAAY,gBACZC,SAAU,UACVC,MAAO,gBACPC,cAAe,kBACfC,SAAU,WACV,mBAAoB,mBACpB,aAAa,aACb,eAAe,4CACf,cAAc,cACd,mBAAmB,mBACnB,+BAA+B,+BAC/B,gBAAgB,gBAChBC,YAAa,WACbC,eAAgB,0DAChBC,cAAe,sBACfC,iBAAkB,4EAClBC,YAAa,UACbC,eAAgB,2FAChBC,UAAW,6BACXC,WAAY,4BACZC,cAAe,8FACfC,WAAY,8BACZC,eAAgB,aAChBC,cAAe,sFACfC,YAAa,iCACbC,eAAgB,8CAChBC,gBAAiB,cACjBC,mBAAoB,sCACpBC,aAAc,eACdC,YAAa,UACbC,sBAAsB,4BACtBC,qBAAqB,0BACrBC,mBAAmB,UACnBC,sBAAsB,2EACtBC,WAAW,uCACXC,iBAAkB,cAClBC,IAAK,MACLC,WAAW,gBACXC,cAAc,iGACdC,UAAW,6BACXC,kBAAmB,uBACnBC,cAAe,mBACfC,aAAc,kBACdC,WAAY,iBACZC,eAAgB,iBAEhBC,iBAAkB,oBAClBC,UAAW,YACXC,aAAc,uBACdC,kBAAmB,6CACnBC,YAAa,mBACbC,YAAa,mBACbC,aAAc,gBACdC,aAAc,8GACdC,gBAAiB,kCACjBC,gBAAiB,sGACjBC,QAAS,gBACTC,QAAS,sEACTC,QAAS,QACTC,YAAa,kCACbC,YAAa,kBACbC,YAAa,gHAEbC,iBAAkB,yBAClBC,gBAAiB,0BACjBC,iBAAkB,+EAClBC,gBAAiB,+EAEjBC,QAAS,aACTC,UAAW,aAEXC,QAAS,gBACTC,QAAS,uFACTC,kBAAkB,qCAClBC,QAAQ,kCACRC,OAAQ,OACRC,QAAS,QACTC,cAAc,SACdC,YAAY,OACZC,YAAY,OACZC,QAAS,eACTC,QAAS,sCACTC,YAAa,gCACbC,OAAQ,iBACRC,SAAU,gBACVC,aAAc,SACdC,cAAe,UACfC,aAAc,aACdC,aAAc,aACdC,OAAQ,OACRC,eAAgB,eAChBC,mBAAoB,qBACpBC,eAAgB,wBAChBC,SAAU,6BACVC,MAAO,yBACPC,QAAS,2BACTC,OAAQ,+BACRC,UAAW,0BACXC,aAAc,mBACdC,aAAc,wBACdC,gBAAiB,uBACjBC,WAAY,wBACZC,cAAe,yBACfC,iBAAkB,wBAClBC,oBAAqB,4BACrBC,aAAc,+BACdC,gBAAiB,4BACjBC,iBAAkB,gBAClBC,cAAe,UACfC,UAAW,kBACXC,aAAc,qBACdC,YAAa,sBACbC,cAAe,6BACfC,kBAAmB,oBACnBC,WAAY,yCACZC,aAAc,kCACdC,SAAU,SACVC,QAAS,QACTC,OAAQ,SACRC,QAAS,wBACTC,eAAgB,eAChBC,iBAAkB,kBAClBC,gBAAiB,gBACjBC,kBAAmB,mBACnBC,eAAgB,gBAChBC,SAAU,SACVC,cAAe,cACfC,iBAAkB,mBAClBC,UAAW,SACXC,OAAQ,SACRC,KAAM,OACNC,MAAO,QACPC,OAAQ,SACRC,iBAAkB,qBAClBC,gBAAiB,kCACjBC,eAAgB,mBAChBC,yBAA0B,8BAC1BC,WAAY,mCACZC,eAAgB,kIAChBC,gBAAiB,2CACjBC,aAAc,wBACdC,SAAU,8BACVC,OAAQ,sBACRC,MAAO,aACPC,SAAU,mBACVC,OAAQ,iBACRC,cAAe,uCACfC,SAAU,uBACVC,SAAU,uBACVC,QAAS,SACTC,SAAU,cACVC,OAAQ,oBACRC,cAAe,wBACfC,YAAa,sBACbC,SAAU,uBACVC,UAAW,wBACXC,OAAQ,2BACRC,OAAQ,2BACRC,SAAU,uCACVC,WAAY,wCACZC,SAAU,mIACVC,WAAY,uCACZC,WAAY,uCACZC,iBAAkB,oBAClBC,eAAgB,gBAChBC,cAAe,oBACfC,cAAe,eACfC,UAAW,SACXC,OAAQ,yBACRC,SAAU,eACVC,cAAe,sCACfC,YAAa,QACbC,YAAa,mBACbC,cAAe,oBACfC,cAAe,uBACfC,eAAgB,sBAChBC,cAAe,0BACfC,gBAAiB,2BACjBC,kBAAmB,kBACnBC,aAAc,iBACdC,YAAa,sBACbC,iBAAkB,qBAClBC,sBAAuB,eACvBC,aAAc,+BDtKdC,GAAI,CAAChL,YEvBoB,CACzBC,QAAS,4oBAGTC,aAAc,2FACdC,WAAY,eACZC,SAAU,+DACVC,MAAO,qBACPC,cAAe,eACfC,SAAU,eACV0K,oBAAqB,oBACrB,mBAAoB,6CACpB,aAAa,6CACb,eAAe,6CACf,cAAc,6CACd,mBAAmB,6CACnB,+BAA+B,6CAC/B,gBAAgB,6CAChBzK,YAAa,0EACbC,eAAgB,uLAChBC,cAAe,0EACfC,iBAAkB,qNAClBC,YAAa,6BACbC,eAAgB,4JAChBC,UAAW,6EACXC,WAAY,gCACZC,cAAe,yNACfC,WAAY,oBACZC,eAAgB,iEAChBC,cAAe,uRACfC,YAAa,iCACbC,eAAgB,8CAChBC,gBAAiB,kDACjBC,mBAAoB,qGACpBiG,UAAW,iCACXD,iBAAkB,iCAClB7B,aAAc,qBACdlE,aAAc,2BACdC,YAAa,4CACbC,sBAAsB,kDACtBC,qBAAqB,oEACrBC,mBAAmB,gCACnBC,sBAAsB,oKACtBC,WAAW,kGACXG,WAAW,kDACXC,cAAc,mSACdE,kBAAmB,qCACnBC,cAAe,+BACfC,aAAc,+BACdC,WAAY,+BACZC,eAAgB,iDAEhBC,iBAAkB,sCAClBE,aAAc,sCACdR,UAAW,gFACXJ,iBAAkB,6CAClBC,IAAK,MACLU,UAAW,wDACXE,kBAAmB,4HACnBC,YAAa,kEACbC,YAAa,4DACbC,aAAc,qEACdC,aAAc,kXACdC,gBAAiB,6CACjBC,gBAAiB,kWACjBC,QAAS,yDACTC,QAAS,6OACTC,QAAS,qBACTC,YAAa,uFACbG,iBAAkB,uFAClBC,gBAAiB,mGACjBC,iBAAkB,iOAClBC,gBAAiB,iOAGjBG,QAAS,+GACTC,QAAS,iNACTC,kBAAkB,+JAClBC,QAAQ,+DACRE,QAAQ,SACRC,cAAc,iCACdC,YAAY,qBACZC,YAAY,eACZJ,OAAQ,qBACRK,QAAS,6CACTC,QAAS,wFACTC,YAAa,iIACbC,OAAQ,6CACRC,SAAU,mCACVM,eAAgB,iCAChBL,aAAc,eACdC,cAAe,eACfC,aAAc,eACdC,aAAc,qBACdC,OAAQ,2BACRE,mBAAoB,6CACpBC,eAAgB,uCAChBC,SAAU,uEACVC,MAAO,gEACPC,QAAS,sEACTI,aAAc,wEACdC,gBAAiB,wEACjBC,WAAY,8EACZC,cAAe,wEACfC,iBAAkB,8EAClBC,oBAAqB,8EACrBC,aAAc,4GACdC,gBAAiB,kEACjBC,iBAAkB,6CAClBC,cAAe,iCACfC,UAAW,uCACXC,aAAc,uCACdC,YAAa,iCACbC,cAAe,6CACfC,kBAAmB,qEACnBC,WAAY,2EACZC,aAAc,yDACdI,QAAS,iCACTH,SAAU,2BACVC,QAAS,qBACTC,OAAQ,2BACRE,eAAgB,uCAChBC,iBAAkB,uCAClBC,gBAAiB,2BACjBC,kBAAmB,iCACnBC,eAAgB,iCAChBC,SAAU,qBACVC,cAAe,eACfG,OAAQ,uCACRC,KAAM,eACNC,MAAO,qBACPC,OAAQ,iCACRC,iBAAkB,mDAClBC,gBAAiB,yDACjBC,eAAgB,6CAChBC,yBAA0B,+DAC1BC,WAAY,+GACZC,eAAgB,uRAChBC,gBAAiB,qHACjBC,aAAc,iFACdC,SAAU,6CACVC,OAAQ,iEACRC,MAAO,qBACPC,SAAU,mCACVC,OAAQ,mCACRC,cAAe,oEACfC,SAAU,6EACVC,SAAU,6EACVC,QAAS,qBACTC,SAAU,iBACVC,OAAQ,4BACRC,cAAe,yCACfC,YAAa,yCACbC,SAAU,qDACVC,UAAW,qDACXC,OAAQ,2DACRC,OAAQ,mFACRC,SAAU,iDACVC,WAAY,mGACZC,SAAU,qXACVC,WAAY,qEACZC,WAAY,qEACZC,iBAAkB,2BAClBC,eAAgB,sEAChBC,cAAe,sEACfC,cAAe,sEACfC,UAAW,2BACXE,SAAU,2BACVC,cAAgB,2BAChBC,YAAa,2BACbC,YAAa,gEACbC,cAAe,sEACfG,cAAe,sEACfC,gBAAiB,sEACjBH,cAAe,sEACfC,eAAgB,sEAChBP,OAAQ,iCACRU,kBAAmB,0EACnBC,aAAc,0EACdC,YAAa,0EACbC,iBAAkB,mDAClBC,sBAAuB,mDACvBC,aAAc,mDACdlH,QAAS,gEACTC,UAAW,yEF/JAoH,GAAoBC,OAAOC,KAAKtL,IAChCuL,GAAc,CACzBvL,aACAwL,cAAcJ,GACdK,YAAaL,GAAkB,GAC/BM,cAAe,CAACC,aAAa,IGxBxB,IAAMC,GAAmB,GA6DnBC,GAAsC,CACjDC,KAAM,GACNC,MAAO,GACPC,UAAW,GACXC,MAAO,GACP3M,UAAW,GACX4M,aAAc,GACdC,WAAW,EACXC,YAAY,EACZC,aAAa,EACbC,YAAY,EACZC,YAAY,GAEDC,GAA6C,CACxDV,KAAM,GACNE,UAAW,GACXC,MAAO,GACP3M,UAAW,GACX4M,aAAc,IA0BHO,GAA0B,CACrCC,SAAS,EACTC,SAAS,EACTC,kBAAkB,GAOPC,GAA8B,CACzCvU,OAAQ,EACRgB,OAAQ,CAAC,EAAE,I,uFCzHAwT,IAAb,gBACE,aAAe,4JACbC,aAAeC,SAFnB,gDAKGC,MALH,sHAMGA,MANH,uHAOGA,MAPH,0ECFaC,GAAW,IACXC,GAA8B,CAAC,EAAG,G,oBCMxC,I,qQAAMC,GAA2B,CACtCtR,KAAM,CACJH,SAAU,CAACwR,GAAW,GAAIA,GAAW,IACrC5R,YAAa,IAIJ8R,IAAb,cAGE,aAAe,qDACbL,KAAKlR,KAAOwR,KAAEC,UAAUH,GAAatR,MACrCiR,aAAeC,MALnB,kDAQE,SAAiBQ,IACD,IAAIH,GACZvR,KCtBH,SAA6C0R,GAClD,OAAOP,aAAWO,OAAKC,EAAW,CAACC,MAAM,IDqB1BC,CAAkBL,KAAEC,UAAUC,EAAI1R,WAVnD,yCACGmR,MADH,kEEHaW,IAAb,GAIGX,KAAWY,IAJd,GAKGZ,KAAWY,IALd,cACE,aAAc,8HACZd,aAAeC,MAFnB,6CAOE,WACE,GAAIA,KAAKc,MAAM,CACb,IAAMC,EAAK,IAAIC,YAEf,OADIhB,KAAKc,OAAOC,EAAGE,SAASjB,KAAKc,OAC1BC,KAXb,wBAeE,WACE,GAAIf,KAAKkB,OAAO,CACd,IAAMH,EAAK,IAAIC,YAEf,OADIhB,KAAKkB,QAAQH,EAAGE,SAASjB,KAAKkB,QAC3BH,KAnBb,2BAuBE,SAAsBI,EAAyBC,GACzCD,IAAUnB,KAAKkB,SACjBlB,KAAKqB,UAAYD,OAzBvB,4QAMGnB,MANH,yEAMyBD,KAAKkB,SAAUlB,KAAKkB,OAAOI,SANpD,wCAOGC,MAPH,mHAeGA,MAfH,qHAuBGC,MAvBH,gFA8BaC,IAAb,gBAaE,aAAc,mYACZ1B,aAAeC,SAdnB,wCACGC,MADH,yEACyB,KADzB,4CAEGA,MAFH,yEAE6B,KAF7B,yCAGGA,MAHH,yEAG0B,KAH1B,wCAIGA,MAJH,wEAIyB,MAJzB,wCAKGA,MALH,yEAKyB,KALzB,qCAMGA,MANH,yEAMsB,KANtB,qCAOGA,MAPH,yEAOsB,KAPtB,wCAUGA,MAVH,wEAUyB,MAVzB,uCAWGA,MAXH,yEAWwB,KAXxB,uCAYGA,MAZH,yEAYwB,KAZxB,IAkBayB,IAAb,GAGGzB,KAAW0B,QAHd,GAIG1B,KAAW0B,QAJd,GAKG1B,KAAW0B,QALd,GAMG1B,KAAW0B,QANd,GAsBG1B,KAAWY,IAtBd,GAqEGW,KAAOI,MArEV,uDAwBE,aAA4B,IAAD,EAAfC,EAAe,mFACzB,eADyB,ukBAGvB,EAAKC,YADHD,EACiBhD,GAEAW,GAErBO,aAAe,iBAPU,EAxB7B,iDAWE,SAAsBrV,GAAYsV,KAAK+B,WAAarX,IAXtD,qBAcE,WACE,OAAQsV,KAAKgC,YAfjB,qBAkBE,WACE,OAAQhC,KAAKiC,YAnBjB,sBAkCE,WACE,IAAIhD,EAAQe,KAAK8B,YAAY7C,MACxBA,EAAMzN,SAEPyN,EADEe,KAAK8B,YAAYhD,KAAKtN,OAChBF,EAAkB0O,KAAK8B,YAAYhD,MAEnC,CAAC,IAAM,IAAM,MAGzB,IAAIxM,EAAY0N,KAAK8B,YAAYxP,UAC5BA,EAAUd,SACbc,EAAYV,EAAiBqN,IAE/B,IAAMiD,EAAanQ,EAAoBkN,GAGvC,MAFe,CAACjN,EAAUiN,GAAQjN,EAAUM,GAAYN,EAAUkQ,MAhDtE,yBAqDE,WACE,OAAOlC,KAAK8B,YAAY7C,MAAMzN,OAASwO,KAAK8B,YAAY7C,MAAQ3N,EAAkB0O,KAAK8B,YAAYhD,QAtDvG,6BAwDE,WACE,IAAIxM,EAAY0N,KAAK8B,YAAYxP,UACjC,IAAKA,EAAUd,OAAQ,CACrB,IAAIyN,EAAQe,KAAK8B,YAAY7C,MACxBA,EAAMzN,SACTyN,EAAQ3N,EAAkB0O,KAAK8B,YAAYhD,OAE7CxM,EAAYV,EAAiBqN,GAG/B,OAAO3M,IAlEX,wBAqEE,SACW6P,GACT9D,OAAO+D,OAAOpC,KAAKmC,QAASA,OAvEhC,GAAqC9B,IAArC,kCACGJ,MADH,wEACmB,MADnB,sCAEGA,MAFH,yEAEuB,KAFvB,oHAGgCR,MAHhC,sHAIkCI,MAJlC,iHAKoC,CAAClR,SAAS,CAAC,EAAG,GAAI6B,MAAK,MAL3D,sJAOGyP,MAPH,yEAO0B,KAP1B,2CAQGA,MARH,yEAQ4B,KAR5B,yCASGA,MATH,yEAS0B,KAT1B,0CAUGA,MAVH,yEAU2B,KAV3B,0CAWGuB,MAXH,qHAYGvB,MAZH,yEAY0B,KAZ1B,sCAcGsB,MAdH,8GAkBGA,MAlBH,+GAqBGtB,MArBH,+S,aC1BaoC,IAAb,GAEGpC,KAAW0B,QAFd,GAkBG1B,KAAWY,IAlBd,GA2BGZ,KAAWY,IA3Bd,GA2GGW,KAAOI,MA3GV,GA8IGJ,KAAOI,MA9IV,GAgLGJ,KAAOI,MAhLV,uDA6CE,aAAe,IAAD,8BACZ,eAAM,IA7CRU,iBAAmB,IAAIxC,GA4CT,k6BAnBdgC,YAAc,EAAKA,YAmBL,sDAEZ,EAAKS,uBAAoB9B,EACzBV,aAAe,iBACf,EAAKyC,6BACDzZ,EAAc+V,OAAQ,EAAKgD,YAAYhD,KAAO/V,EAAc+V,MAChE,EAAK2D,eAA6C,OAA5B1Z,EAAc2Z,UAEpC,EAAKV,UAAsC,OAA1BjZ,EAAc4Z,QAE/B,EAAKV,UAAuC,OAA3BlZ,EAAc6Z,SAE/B,EAAKC,SAAW,GAChB,EAAKC,UAAW,EAChB,EAAKC,MAAQ,EACb,EAAKC,MAAQ,EAEb,EAAKC,SAAW,GAChB,EAAKC,QAAU,EACf,EAAKC,QAAU,EAEf,EAAKC,+BACL,EAAKC,yBACLC,cAAQ,WACN,IAAMC,EAAW,mCACXC,EAAM,mDACRC,EAAM,EAAK3B,YAAY9C,UAC3B,KAAMyE,GAAOA,EAAIC,SAASH,EAAU,IAAME,EAAIC,SAASF,EAAK,KAAO,EAAK1B,YAAY/C,MAAM,CACxF,IAAMA,EAAQ,EAAK+C,YAAY/C,MAAM4E,OACrC,GAAI5E,EAAM2E,SAASF,IAA4B,SAApBzE,EAAM5M,OAAO,GACtCsR,EAAM1E,MACH,CACH,IAAM6E,EAAOC,KAAI,EAAK/B,YAAY/C,MAAM4E,OAAOG,eAC/CL,EAAG,UAAMF,GAAN,OAAiBK,EAAjB,WAGHH,IACkB,SAAhBA,EAAItR,OAAO,GACb,EAAK2P,YAAY9C,UAAYyE,EdvBhC,SAAuBza,GAC5B,IAAM+a,EAAM,IAAIC,MAOhB,OANAD,EAAIN,IAAMza,EACM,IAAIkI,SAAgB,SAAC+S,EAAgBC,GACnDH,EAAII,OAAS,WAAQF,EAAejb,IACpC+a,EAAIK,QAAU,WAAQF,EAAc,QcoB9BG,CAAcZ,GAAKa,MAAK,SAACb,GACvB,EAAK3B,YAAY9C,UAAYyE,KAC5Bc,OAAM,WACP,EAAKzC,YAAY9C,UAAY,UA3CzB,EA7ChB,sDA4BE,SAA2BwF,GAAgBxE,KAAKyE,gBAAkBD,IA5BpE,uBA6BE,WACE,MAAO,CACLE,SAAU1E,KAAKgC,UACf2C,aAAc3E,KAAK4E,YACnBlC,UAAW1C,KAAKyC,eAChBI,SAAU7C,KAAK6C,SACfC,SAAU9C,KAAK8C,SACfC,MAAO/C,KAAK+C,MACZC,MAAOhD,KAAKgD,MACZC,SAAUjD,KAAKiD,SACfC,QAASlD,KAAKkD,QACdC,QAASnD,KAAKmD,WAxCpB,6BAgGE,WACE,MAAyBnD,KAAK8B,YAAb+C,GAAjB,EAAO9F,MAAP,oBACAiB,KAAKuC,kBAAoBsC,IAlG7B,sCAqGE,SAAyBC,GACvB,IAAIC,EAAUC,eACVF,IAAkBC,EAAUE,cAEhCF,EAAQG,QAAQ,8BAA+BC,KAAKC,UAAUpF,KAAK8B,gBAzGvE,wCA2GE,WAEE,IAAIiD,EAAUE,aACVD,eAAeK,QAAQ,iCACzBN,EAAUC,gBAGZ,IAAMM,EAAYP,EAAQM,QAAQ,+BAC9BC,GACFjH,OAAO+D,OAAOpC,KAAK8B,YAAaqD,KAAKI,MAAMD,MApHjD,mCAwHE,SAA8B5X,GAC5B,IAAM8X,EAAM9X,EAAI+X,SAASzF,KAAKlR,KAAKH,UACnCqR,KAAK0F,UAAUpZ,OAASgB,EAAMK,EAAM,GAAKD,EAAIiY,YAAaH,KA1H9D,wCA8HE,WACE,IAAMI,EAA2B,CAC/BC,OAAO,CACL5D,UAAWjC,KAAKiC,UAChBD,UAAWhC,KAAKgC,UAChB4C,YAAa5E,KAAK4E,aAEpBkB,OAAO9F,KAAKsC,iBACZI,UAAW1C,KAAKyC,eAChBsD,sBAAuB/F,KAAK+F,sBAC5BC,iBAAkBhG,KAAKiG,oBAGzBhB,aAAaC,QAAQ,gCAAiCC,KAAKC,UAAUQ,IACrEZ,eAAeE,QAAQ,gCAAiCC,KAAKC,UAAUQ,MA5I3E,0CA8IE,SAC6BM,GAC3B,IAAMC,EAAoBlB,aAAaI,QAAQ,iCACzCe,EAAsBpB,eAAeK,QAAQ,iCAC/CgB,OAAwC5F,EACxC6F,OAA0C7F,EAC1C0F,IAAqBE,EAAelB,KAAKI,MAAMY,IAC/CC,IAAuBE,EAAiBnB,KAAKI,MAAMa,IACvD,IAAMG,EAAUF,EACZE,IACFA,EAAQV,OAAO5D,WAAY,EACvBqE,IAAiBC,EAAQV,OAAO5D,UAAYqE,EAAeT,OAAO5D,WAClEiE,EACF7H,OAAO+D,OAAO8D,EAAIK,IAElBlI,OAAO+D,OAAOpC,KAAMuG,EAAQV,QAC5BxH,OAAO+D,OAAOpC,KAAKsC,iBAAkBiE,EAAQT,QAC7C9F,KAAKyC,eAAiB8D,EAAQ7D,UAC9B1C,KAAK+F,sBAAwBQ,EAAQR,0BAhK7C,kCAsKE,SAAqBjB,GACnB,IAAIC,EAAUC,eACVF,IAAkBC,EAAUE,cAEhC,IAAM9C,EAAuB,CAC3BrT,KAAMkR,KAAKlR,KACXqT,QAASnC,KAAKmC,SAEhB4C,EAAQG,QAAQ,0BAA2BC,KAAKC,UAAUjD,MA9K9D,oCAgLE,WAEE,IAAI4C,EAAUE,aACVD,eAAeK,QAAQ,6BACzBN,EAAUC,gBAGZ,IAAMtU,EAAMqU,EAAQM,QAAQ,2BAC5B,GAAI3U,EAAK,CACP,IAAMyR,EAAUgD,KAAKI,MAAM7U,GAC3B2N,OAAO+D,OAAOpC,KAAKmC,QAASA,EAAQA,SACpC9D,OAAO+D,OAAOpC,KAAKlR,KAAMqT,EAAQrT,WA3LvC,GAAsC4S,IAAtC,mHAE+B,IAAId,MAFnC,8CAGGX,MAHH,yEAG+B,KAH/B,wCAKGA,MALH,wEAKyB,MALzB,wCAMGA,MANH,yEAMyB,KANzB,qCAOGA,MAPH,yEAOsB,KAPtB,qCAQGA,MARH,yEAQsB,KARtB,wCAUGA,MAVH,wEAUyB,MAVzB,uCAWGA,MAXH,yEAWwB,KAXxB,uCAYGA,MAZH,yEAYwB,KAZxB,kDAcGA,MAdH,yEAcmC,KAdnC,+CAeGA,MAfH,yEAegCuG,OAAO/B,mBAfvC,qDAgBGxE,MAhBH,yEAgBsCuG,OAAOT,sBAAwBS,OAAOT,sBAAwB,UAhBpG,kDAiBG9F,MAjBH,yEAiBsDuG,OAAOP,mBAAqBO,OAAOP,mBAAqB,WAjB9G,8JAmBGhG,MAnBH,yEAmBiCuG,OAAOC,mBAA+B,KAnBvE,gDAoBGxG,MApBH,yEAoBiCuG,OAAOE,mBAA+B,KApBvE,gDAqBGzG,MArBH,sHAsBGA,MAtBH,uHAuBGA,MAvBH,wOA4BGuB,MA5BH,yHA6BGD,MA7BH,sHAgGGC,MAhGH,oRAwHGA,MAxHH,4XC1BamF,IAAb,GAMG1G,KAAWY,IANd,uDAUE,WAAY+F,GAAY,IAAD,8BACrB,gBAVF9E,YAAgC,EAAKA,YASd,EARvB+E,qBAAsB,EAQC,yRADvBC,aAAe,EAGb/G,aAAe,iBACf,EAAK6G,GAAKA,EAHW,EAVzB,wCAeE,WACE5G,KAAK+G,QAAS,MAhBlB,GAAyCrF,IAAzC,2CAGGzB,MAHH,yEAG4B,IAAIwB,MAHhC,sCAIGxB,MAJH,yEAIuB,KAJvB,4CAKGA,MALH,yEAK6B,KAL7B,6JAOGA,MAPH,uGAQGA,MARH,+FAeGuB,MAfH,uECAawF,IAAb,GAGG/G,KAAW0B,QAHd,GAOG1B,KAAWY,IAPd,uDASE,WAAY+F,GAAY,IAAD,8BACrB,gBATF9E,YAAgC,EAAKA,YAQd,EAPvB+E,qBAAsB,EAOC,wOADvBC,aAAe,EAGb/G,aAAe,iBACf,EAAK6G,GAAKA,EAHW,EATzB,wCAcE,WACE5G,KAAK+G,QAAS,MAflB,GAAuCrF,IAAvC,mHAG+B,IAAId,MAHnC,2CAIGX,MAJH,yEAI4B,IAAIwB,MAJhC,sCAKGxB,MALH,yEAKuB,KALvB,4CAMGA,MANH,yEAM6B,KAN7B,qJAcGuB,MAdH,uECgHMyF,GAAe,IAhHrB,GAKGhH,KAAW0B,QALd,GAOG1B,KAAW0B,QAPd,cACE,aAAe,4DAKfuF,OAASjH,KAAWkH,IAAI,IAAI9E,IALd,yHACZtC,aAAeC,MAFnB,uCAYE,WACE,OAAOA,KAAKoH,OAAO3X,OAbvB,iBAgBE,WACE,OAAOuQ,KAAKkH,OAAOzd,QAjBvB,mBAoBE,WACE,OAAOuW,KAAKqH,MAAMT,KArBtB,wBAwBE,SACWA,GACT5G,KAAKqH,MAAMT,GAAKA,IA1BpB,kBA6BE,SACKU,GAEH,IAAMC,EAAiB,IAAIP,GAAkBM,GAG7C,OAFAC,EAAepF,QAAQzC,SAAU,EACjCM,KAAKoH,OAAOI,IAAIF,EAAeC,GACxBA,IAnCX,+BAsCE,SACkBD,GAChB,IAAIjV,EAAI2N,KAAKoH,OAAO3d,IAAI6d,GAIxB,OAHKjV,IACHA,EAAI2N,KAAKyH,KAAKH,IAETjV,IA5CX,uBA8CE,SAAUiV,GACR,OAAOtH,KAAKoH,OAAO3d,IAAI6d,KA/C3B,mBAkDE,SACMA,GACJtH,KAAKoH,OAAOrc,OAAOuc,KApDvB,sBAuDE,WACEtH,KAAKoH,OAAOM,QACZ1H,KAAK2H,WAAW,MAzDpB,kBA4DE,SAAKL,GACH,OAAIA,IAAkBtH,KAAK4H,QAElB5H,KAAKqH,MAGFrH,KAAKoH,OAAO3d,IAAI6d,KAlEhC,iCAuEE,SAAoBV,GAClB,IAAIV,EAAKlG,KAAK6H,SAASpe,IAAImd,GAM3B,OALKV,IACHA,EAAK,IAAIS,GAAoBC,GAC7B5G,KAAK6H,SAASL,IAAIZ,EAAIV,IAGjBA,IA9EX,4BAgFE,SAAeU,GACb,OAAO5G,KAAK6H,SAAS9c,OAAO6b,KAjFhC,4BAoFE,SAAekB,EAAc3G,GAC3B,IAAM4G,EAAcd,GAAae,kBAAkBF,GAChC,UAAf3G,EAAM8G,KACRF,EAAYG,OAAOpH,MAAQK,EAE3B4G,EAAYG,OAAOhH,OAASC,IAzFlC,+BA4FE,SAAkB2G,EAAcG,GAC9B,IAAMb,EAASpH,KAAKoH,OAAO3d,IAAIqe,GAC/B,QAAKV,IACQ,UAATa,EACFb,EAAOc,OAAOpH,WAAQL,EAEtB2G,EAAOc,OAAOhH,YAAST,GAElB,KApGX,qBAuGE,SAAQ6G,GACN,OAAOA,IAAkBtH,KAAK4H,UAxGlC,yBA2GE,WACE,MAAO,CAAC5H,KAAKqH,MAAMvY,KAAKH,SAAS,GAAIqR,KAAKqH,MAAMvY,KAAKH,SAAS,GAAIiQ,SA5GtE,wHAKwC,IAAI/T,OAL5C,qHAO0C,IAAIA,OAP9C,0CASGoV,MATH,yEASoC,IAAIkI,OATxC,gDAUGlI,MAVH,yEAUiC,KAVjC,kCAYGsB,MAZH,sGAgBGA,MAhBH,wGAoBGA,MApBH,6GAwBGC,MAxBH,0GA6BGA,MA7BH,iHAsCGA,MAtCH,kHAkDGA,MAlDH,yGAuDGA,MAvDH,2EAkHAtV,EAAE+a,aAAeA,GACFA,I,SAAAA,MC9GFmB,GAAb,aAQE,WAAYC,EAAaC,EAAaxJ,EAAayJ,EACjDC,EAAiBC,EAAmBC,GAAuB,yBAR7DA,KAAuB,OAQqC,KAP5DL,UAO4D,OAN5DC,SAM4D,OAL5DxJ,UAK4D,OAJ5DyJ,eAI4D,OAH5DE,eAG4D,OAF5DD,YAE4D,EAC1DxI,KAAKqI,KAAOA,EACZrI,KAAKsI,IAAMA,EACXtI,KAAKlB,KAAOA,EACZkB,KAAKuI,UAAYA,EACjBvI,KAAKwI,OAASA,EACdxI,KAAKyI,UAAYA,EACjBzI,KAAK0I,KAAOA,KA4DVC,GAAO,IAxDb,cAIE,aAAe,4FACb5I,aAAeC,MALnB,iDAOE,WAEM2I,GAAKC,SAASpX,OADG,KACqBmX,GAAKC,SAASC,OAAO,EAAGF,GAAKC,SAASpX,OAD3D,OARzB,wBAWE,SAAmBsX,GACjB9I,KAAK4I,SAASG,KAAKD,GACnB9I,KAAKgJ,kBAbT,oCAeE,SAAuBV,EAAYW,GACjC,IAAMlB,EAAcd,GAAaiC,KAAKZ,GACtC,GAAIP,EAAY,CACd,IAAMoB,EAAK,IAAIf,GAAY,GAAIL,EAAYnB,GAAImB,EAAYjG,YAAYhD,KACrEiJ,EAAYjG,YAAY9C,UAAW+I,EAAYqB,WAAYC,KAAKC,MAAO,OACzEH,EAAGd,KAAO3V,GAAE,gBAAiB,CAAC6W,IAAKN,EAASO,IAAKL,EAAGrK,OACpDkB,KAAKyJ,WAAWN,MArBtB,+BAwBE,SAAkBb,GAChB,IAAMP,EAAcd,GAAaiC,KAAKZ,GACtC,GAAIP,EAAY,CACd,IAAMoB,EAAK,IAAIf,GAAY,GAAIL,EAAYnB,GAAImB,EAAYjG,YAAYhD,KACrEiJ,EAAYjG,YAAY9C,UAAW+I,EAAYqB,WAAYC,KAAKC,MAAO,OACzEH,EAAGd,KAAO3V,GAAE,WAAY,CAACoM,KAAKqK,EAAGrK,OACjCkB,KAAKyJ,WAAWN,MA9BtB,6BAiCE,SAAgBb,GACd,IAAMP,EAAcd,GAAaiC,KAAKZ,GACtC,GAAIP,EAAY,CACd,IAAMoB,EAAK,IAAIf,GAAY,GAAIL,EAAYnB,GAAImB,EAAYjG,YAAYhD,KACrEiJ,EAAYjG,YAAY9C,UAAW+I,EAAYqB,WAAYC,KAAKC,MAAO,OACzEH,EAAGd,KAAO3V,GAAE,SAAU,CAACoM,KAAKqK,EAAGrK,OAC/BkB,KAAKyJ,WAAWN,MAvCtB,sBA0CE,SAASO,GACP,IAAMP,EAAK,IAAIf,GAAY,GAAIsB,EAAK9C,GAAI8C,EAAK5H,YAAYhD,KACzD4K,EAAK5H,YAAY9C,UAAW0K,EAAKN,WAAYC,KAAKC,MAAO,UACzDH,EAAGd,KAAO3V,GAAE,WAAY,CAACoM,KAAKqK,EAAGrK,OACjCkB,KAAKyJ,WAAWN,KA9CpB,oBAgDE,SAAOQ,GACL,IAAMR,EAAK,IAAIf,GAAY,GAAIuB,EAAG/C,GAAI+C,EAAG7H,YAAYhD,KACrD6K,EAAG7H,YAAY9C,UAAW2K,EAAGP,WAAYC,KAAKC,MAAO,UACrDH,EAAGd,KAAO3V,GAAE,WAAY,CAACoM,KAAKqK,EAAGrK,OACjCkB,KAAKyJ,WAAWN,OApDpB,6CACGlJ,MADH,wEACuC,MADvC,sCAEGA,MAFH,wEAEuB,MAFvB,0CAOGuB,MAPH,mHAWGA,MAXH,6EAyDemH,M,SC3EFiB,GAAiB,6BAbQ,CACpCC,gBAAiB,QACjBC,wBAAyB,YACzBC,sBAAuB,gBAUK,IAE5BC,iBAAkB,SAClBC,mBAAoB,UAKTC,GAAqB,CAChCC,wBAAyB,iBACzBC,WAAY,aACZC,aAAc,SACdC,YAAa,cACbC,WAAY,eACZC,WAAY,eACZC,YAAa,gBACbC,eAAgB,WAChBC,KAAM,UAOKC,IAJsB,IAAIzC,IAAI9J,OAAOwM,OAAOX,KAInB,CACpCY,uBAAwB,WACxBC,oBAAqB,kBAEVC,GAA0B,IAAI7C,IAAI9J,OAAOwM,OAAOD,KAEhDK,GAAyB,CACpCC,uBAAwB,WACxBC,gBAAiB,QACjBC,UAAW,QACXC,YAAa,SAEFC,GAA0B,IAAInD,IAAI9J,OAAOwM,OAAOI,KAEhDM,GAAgC,CAC3CC,6BAA8B,iBAC9BC,YAAa,UACbC,cAAe,YACfC,2BAA4B,eAGjBC,GAAW,8FACnBhB,IACAK,IACAf,IACAN,IAvD0B,CAC7BiC,iBAAkB,KAClBC,kBAAmB,KACnBC,qBAAsB,cAsDnBR,IANmB,IAStBS,iBAAkB,qBAClBC,UAAY,YACZC,WAAY,SAGZC,cAAe,YACfC,iBAAkB,cCAb,SAASC,GAAeC,GAAyB,IAAD,gBAChCA,GADgC,IACrD,IAAI,EAAJ,qBAA0B,CAAC,IACnBtgB,EADkB,eAEjBA,EAAE6b,gBACF7b,EAAEugB,cACFvgB,EAAEwgB,OAL0C,8BAOrD,OAAOF,EAEF,SAASG,GAAkBH,GAA+B,IAAD,gBACzCA,GADyC,IAC9D,IAAI,EAAJ,qBAA0B,CAAC,IACnBtgB,EADkB,QAExBA,EAAE0gB,aAAe,GACjB1gB,EAAE2gB,iBAAmB,IAJuC,8BAM9D,OAAOL,EAgBF,IAAMM,GAAwB,IACxBC,GAAW,QAGjB,SAASC,GAA8B9gB,GAC5C,MAAkB,SAAXA,EAAE0c,MAA8B,QAAX1c,EAAE0c,KAOzB,SAASqE,GAAkB/gB,GAChC,OAAOA,IAAiB,SAAXA,EAAE0c,MAA8B,WAAX1c,EAAE0c,MAAgC,QAAX1c,EAAE0c,MAC9C,eAAX1c,EAAE0c,MAAoC,WAAX1c,EAAE0c,MAAgC,YAAX1c,EAAE0c,MASjD,SAASsE,GAAmBhhB,GACjC,OAAOA,GAAKA,EAAEihB,QAAUJ,GAEnB,IAAMK,GAA6B,QA0BnC,SAASC,GAAgBC,EAAiBC,GAC/C,OAAOD,EAAGE,KAAOD,EAAGC,K,cC5JTC,GAAiB/G,OAAOgH,cAAgB,kCAE9C,SAASC,GAAczkB,GAC5B,IACIkd,EAAKld,EAQT,MATc,CAAC,UAAW,YAEpB8E,SAAQ,SAAC4f,GACT1kB,EAAI2kB,UAAU,EAAGD,EAAKlc,UAAYkc,IACpCxH,EAAKld,EAAI2kB,UAAUD,EAAKlc,YAG5B0U,EAAE,UAAMqH,IAAN,OAAuBrH,G,iCCTrB0H,G,WASJ,aAI8G,IAH5GC,EAG2G,uDAHlG,2EACTC,EAE2G,uDAF9F,GACbC,EAC2G,uDADrG,gBACNC,EAA2G,uDAAlG,0CAA2CC,EAAuD,uDAAhD,CAAC,8CAA+C,yBAZrGJ,cAYqG,OAXrGC,kBAWqG,OAVrGC,WAUqG,OATrGC,cASqG,OARrGC,YAQqG,OANrGC,UAAY,EAOlBlO,KAAK6N,SAAWA,EAChB7N,KAAK8N,aAAeA,EACpB9N,KAAK+N,MAAQA,EACb/N,KAAKgO,SAASA,EACdhO,KAAKiO,OAASA,EAKdE,KAAKC,KAAK,OAAQ,CAAC,SAAYpO,KAAKqO,cAAcC,KAAKtO,Q,iDAQzD,WACEA,KAAKkO,YACLC,KAAKI,OAAOH,KAAK,QAAS,KAAKpO,KAAKwO,YAAYF,KAAKtO,S,yBAEvD,WACEA,KAAKkO,c,4DAGP,4GACoB,IAAIhd,SAAQ,SAACC,EAASC,GACtCqd,QAAQC,IAAIP,KAAKQ,MACjBR,KAAKQ,KAAKC,UACR,CACE,UAAa,EAAKf,SAClB,MAAS,EAAKI,OACd,WAAa,IAEf,SAAC5b,GAAD,OAAKA,EAAEwc,MAAMV,KAAKQ,KAAKC,UACrB,CACE,UAAa,EAAKf,SAClB,MAAS,EAAKI,OACd,WAAa,IAEf,SAACa,GAAD,OAAKA,EAAED,MAAMzd,EAAO0d,GAAG3d,EAAQ2d,MAAI3d,EAAQkB,SAfnD,OACQjJ,EADR,OAiBEqlB,QAAQC,IAAItlB,GAjBd,2C,oIAuBA,WAAqC2lB,GAArC,sGACQ/O,KAAKgP,QADb,uBAIiCb,KAAKI,OAAOU,MAAMC,MAAMC,KAAK,CAC1DC,EAAE,qGALN,mBAIiBF,EAJjB,EAISG,OAAQH,MAIXI,EAAM,GARZ,OASMJ,QATN,IASMA,KAAO1d,OATb,wBAUQ+d,EAAe,CACjB,KAAS,qBACT,SAAa,sCAZnB,UAcoCpB,KAAKI,OAAOU,MAAMC,MAAMM,OAAO,CAC7DC,SAAUF,IAfhB,QAcUG,EAdV,OAiBIJ,EAAOnK,KAAKI,MAAMmK,EAAkBC,MAAM/I,GAjB9C,wBAoBI0I,EAAQJ,EAAM,GAAGtI,IAAM,GApB3B,eAyBQgJ,EAAW,CACb9Q,KAAMiQ,EAAKjQ,KACX+Q,SAAUd,EAAKrG,KACfoH,QAAS,CAACR,KAERS,EAAO,IAAIC,UACZC,OAAO,WAAY,IAAIC,KAAK,CAAC/K,KAAKC,UAAUwK,IAAY,CAAClH,KAAM,sBACpEqH,EAAKE,OAAO,OAAQlB,GAhCtB,UAiCmCoB,MAAM,wEAAyE,CAC9GC,OAAQ,OACRC,QAAS,IAAIC,QAAQ,CAAC,cAAiB,UAAYnC,KAAKQ,KAAK4B,WAAWC,eACxEb,KAAMI,IACLzL,MAAK,SAAClb,GACP,OAAOA,EAAIqnB,UAtCf,eAiCQC,EAjCR,iBAyCQvC,KAAKI,OAAOU,MAAM0B,YAAYnB,OAAO,CACzCoB,OAAQF,EAAmB9J,GAC3B6I,SAAU,CACRoB,KAAM,SACNnI,KAAM,YA7CZ,sFAuDuDgI,EAAmB9J,KAvD1E,iD,8DA6Da,OAAIgH,GC1HZ,SAASkD,GAAcC,GAsB5B,OArBgB,IAAI7f,SAAgB,SAAC+S,EAAgBC,GACnD,IAAM8M,EAAW,IAAIhB,SACrBgB,EAASf,OAAO,eAAgB,oEAChCe,EAASf,OAAO,YAAac,GAC7BZ,MAAM,sCAAuC,CAACC,OAAQ,OAAQT,KAAMqB,IACnE1M,MAAK,SAAA2M,GAAQ,OAAIA,EAASR,UAC1BnM,MAAK,SAAC4M,GAGLjN,EAAeiN,EAAaloB,QAE7Bub,OAAM,SAACsK,GACa,+BAAf,UAAGA,GACL3K,EAAc,SAEduK,QAAQI,MAAMA,GACd3K,EAAc,WCNf,IAmSHiN,GAnSSC,GAAiC/S,OAAO+D,OAAO,GAAIiP,GAAuB,CACrFvS,KAAM,GACNwS,UAAW,GACXC,SAAU,GACVtS,MAAO,GACP3M,UAAW,GACXoW,KAAM,GACN1f,IAAK,GACLyG,KAAM,CAAC,EAAG,GACV+hB,aAAc,CAAC,EAAG,GAClB5K,GAAI,GACJqG,OAAQ,EACRwE,QAAQ,EACR/E,aAAa,GACbC,iBAAiB,GAGjB+E,UAAW,GACXC,WAAW,EACXC,YAAa,GACbC,eAAe,EACfC,iBAAiB,EACjBC,gBAAgB,EAChBC,mBAAmB,EACnBC,UAAW,GACXC,SAAU,GACVC,UAAW,KAGPC,G,aA4BJ,aAAe,yBA3BftT,UA2Bc,OA1BdwS,eA0Bc,OAzBdC,cAyBc,OAxBdtS,WAwBc,OAvBd3M,eAuBc,OAtBdoW,UAsBc,OArBd1f,SAqBc,OApBd4d,QAoBc,OAnBdqG,YAmBc,OAlBdwE,YAkBc,OAjBd3iB,UAiBc,OAhBdW,UAgBc,OAfdid,kBAec,OAddC,sBAcc,OAbd6E,kBAac,OAZda,aAYc,OAXdC,aAWc,OAVdZ,eAUc,OATdC,eASc,OARdC,iBAQc,OAPdC,mBAOc,OANdC,qBAMc,OALdC,oBAKc,OAJdC,uBAIc,OAHdC,eAGc,OAFdC,cAEc,OADdC,eACc,EACZ9T,OAAO+D,OAAOpC,KAAMM,KAAEC,UAAU6Q,QAI7B,SAASmB,KACd,IAAMC,EAAU,IAAIJ,GAOpB,OANAI,EAAQlB,UAAYrK,GAAaI,MAAMvF,YAAYhD,KACnD0T,EAAQvT,MAAQgI,GAAaI,MAAMvF,YAAY7C,MAC/CuT,EAAQlgB,UAAY2U,GAAaI,MAAMvF,YAAYxP,UACnDkgB,EAAQjB,SAAWtK,GAAaI,MAAMvF,YAAY9C,UAClDwT,EAAQvF,OAAS5D,KAAKC,MAEfkJ,EAGT,SAASC,GAAUC,EAAuBC,EAAgBjlB,GACxDglB,EAAOhK,KAAO,MACdgK,EAAO1pB,IAAM2pB,EACbD,EAAO5jB,KAAKH,SAAS,GAAKjB,EAAIklB,WAAW,GACzCF,EAAO5jB,KAAKH,SAAS,GAAKjB,EAAIklB,WAAW,GACzCF,EAAOjjB,KAAK,GAAK,IACjBijB,EAAOjjB,KAAK,GAAsB,WAAjBijB,EAAOjjB,KAAK,GAGxB,SAASojB,GAAsBF,EAAgBjlB,EAAcolB,EAAcC,EAAcrJ,GAC9F,OAAO,IAAIxY,SAAwB,SAACC,EAASC,GAC3C,IAAMshB,EAASH,KACTvpB,EAAM,IAAIE,IAAIypB,GACpB,GAAqB,aAAjB3pB,EAAIgqB,UAA4C,gBAAjBhqB,EAAIgqB,UAA+C,oBAAjBhqB,EAAIgqB,SAAgC,CACvG,IAAMC,EAAYjqB,EAAIkqB,OAAO/gB,MAAM,GAAGvB,MAAM,KACtCuiB,EAAS,IAAItoB,IAAoBooB,EAAUvlB,KAAI,SAAAgD,GAAG,OAAIA,EAAIE,MAAM,SACjD,aAAjB5H,EAAIgqB,UACNG,EAAO3L,IAAI,IAAKxe,EAAIW,SAASwI,MAAM,IAErCugB,EAAO1pB,IAAM,GAN0F,oBAOnFmqB,GAPmF,IAOvG,2BAA4B,CAAC,IAAlBC,EAAiB,QACP,KAAfV,EAAO1pB,IACT0pB,EAAO1pB,IAAP,UAAgBoqB,EAAM,GAAtB,YAA4BA,EAAM,IAElCV,EAAO1pB,IAAP,UAAgB0pB,EAAO1pB,IAAvB,YAA8BoqB,EAAM,GAApC,YAA0CA,EAAM,KAXmD,8BAcvGV,EAAOhK,KAAO,UACF,gBAATgB,GACDgJ,EAAO5jB,KAAKH,SAAS,GAAKkC,OAAOiiB,GACjCJ,EAAO5jB,KAAKH,SAAS,GAAKkC,OAAOkiB,KAEjCL,EAAO5jB,KAAKH,SAAS,GAAKjB,EAAIklB,WAAW,GACzCF,EAAO5jB,KAAKH,SAAS,GAAKjB,EAAIklB,WAAW,IAE3CF,EAAOjjB,KAAK,GAAK,IACjBijB,EAAOjjB,KAAK,GAAK,SACb,GAAqB,qBAAjBzG,EAAIgqB,UAAoD,oBAAjBhqB,EAAIgqB,SAAgC,CACnFN,EAAOhK,KAAO,SACd,IAAM2K,EAAcrqB,EAAIW,SAASwI,MAAMnJ,EAAIW,SAAS2pB,QAAQ,OAAS,GAC/D1C,EAASyC,EAAYlhB,MAAM,EAAGkhB,EAAYC,QAAQ,MACxDZ,EAAO1pB,IAAP,aAAmB4nB,GACnB8B,EAAO5jB,KAAKH,SAAS,GAAKjB,EAAIklB,WAAW,GACzCF,EAAO5jB,KAAKH,SAAS,GAAKjB,EAAIklB,WAAW,GACzCF,EAAOjjB,KAAK,GAAK,IACjBijB,EAAOjjB,KAAK,GAAK,QACQ,kBAAjBzG,EAAIgqB,UACZN,EAAOhK,KAAO,aACdgK,EAAO1pB,IAAM2pB,EACbD,EAAO5jB,KAAKH,SAAS,GAAKjB,EAAIklB,WAAW,GACzCF,EAAO5jB,KAAKH,SAAS,GAAKjB,EAAIklB,WAAW,GACzCF,EAAOjjB,KAAK,GAAK,IACjBijB,EAAOjjB,KAAK,GAAK,KACyC,SAAlDzG,EAAIW,SAASgkB,UAAU3kB,EAAIW,SAAS6H,OAAO,IACD,SAAlDxI,EAAIW,SAASgkB,UAAU3kB,EAAIW,SAAS6H,OAAO,GAC3CihB,GAAUC,EAAQC,EAAQjlB,GC/IzB,SAAqB1E,GAC1B,OAAO,IAAIkI,SAAQ,SAACC,EAASC,GAC3B,IAAMmiB,EAAQ,IAAIC,eAClBD,EAAME,QAAU,IAChBF,EAAMG,KAAK,MAAO1qB,GAClBuqB,EAAMI,mBAAqB,WACzB,GAAI3T,KAAK4T,aAAe5T,KAAK6T,QAAS,CACpC,IAAMnL,EAAO1I,KAAK8T,kBAAkB,gBACpC9T,KAAK+T,QACL5iB,EAAQuX,KAGZ6K,EAAMS,UDsIJC,CAAYxG,GAAckF,IAASrO,MAAK,SAACoE,GAC5B,oBAAPA,IACF+J,GAAUC,EAAQC,EAAQjlB,GAC1ByD,EAAQuhB,OAETwB,SAAQ,WACJxB,EAAOhK,OACVgK,EAAOhK,KAAO,SACdgK,EAAO1pB,IAAM2pB,EACbD,EAAO5jB,KAAKH,SAAS,GAAKjB,EAAIklB,WAAW,GACzCF,EAAO5jB,KAAKH,SAAS,GAAKjB,EAAIklB,WAAW,GACzCF,EAAOjjB,KAAK,GAAK,IACjBijB,EAAOjjB,KAAK,GAAK,IACjB0B,EAAQuhB,OAIVA,EAAOhK,OACTvX,EAAQuhB,GACRyB,GAAW,GAAD,OAAIzB,EAAOhK,KAAX,0BAAiCgK,EAAO1pB,UAIjD,SAASorB,GAAoBC,EAAiB3mB,EAAcolB,EAAcC,EAAcrJ,GAC7F,IAAMgJ,EAASH,KACfG,EAAOhK,KAAO,OACd,IAQM4L,EAAsB,CAAC1L,SAAS,CARlB,CAClByL,UACA/L,IAAKrB,GAAaW,QAClB9I,KAAMmI,GAAaI,MAAMvF,YAAYhD,KACrCG,MAAOgI,GAAaI,MAAMvF,YAAY7C,MACtC3M,UAAW2U,GAAaI,MAAMvF,YAAYxP,UAC1Cgb,KAAMjE,KAAKC,QAEwCiL,OAAO,CAAC,EAAG,IAChE7B,EAAO1pB,IAAMmc,KAAKC,UAAUkP,GAChB,gBAAT5K,GACDgJ,EAAO5jB,KAAKH,SAAS,GAAKkC,OAAOiiB,GACjCJ,EAAO5jB,KAAKH,SAAS,GAAKkC,OAAOkiB,KAEjCL,EAAO5jB,KAAKH,SAAS,GAAKjB,EAAIklB,WAAW,GACzCF,EAAO5jB,KAAKH,SAAS,GAAKjB,EAAIklB,WAAW,IAE3C,IAAM4B,EAAO7oB,KAAK8oB,KAAK9oB,KAAKG,KAAKuoB,EAAQ7iB,SAMzC,OAHAkhB,EAAOjjB,KAAK,GAAK9D,KAAK+oB,IAFC,GAEGF,EAAuB,KACjD9B,EAAOjjB,KAAK,GAAK9D,KAAK+oB,IAFC,GAEGF,EAAuBA,EAF1B,GAEkDG,IAElEjC,EAoCF,SAASkC,GAAqBC,EAAiBnnB,EAAconB,EAA0BC,EAAiCC,EAAalC,EAAeC,EAAerJ,EAAcuL,GAsBtL,OApBgB,IAAI/jB,SAA0B,SAAC+S,EAAgBC,GACxD6Q,GAA6B,UAAfA,EAajBnH,GAAYsH,wBAAwBL,GAAWvQ,MAAK,SAACtb,GACnDmsB,GAAwBnsB,EAAK0E,EAAKonB,EAAQE,EAAOlC,EAAOC,EAAOrJ,EAAMuL,GAAM3Q,KAAKL,GAAgBM,MAAML,MAbxG4M,GAAc+D,GAAWvQ,MAAK,SAACtb,GAC7BmsB,GAAwBnsB,EAAK0E,EAAKonB,EAAQE,EAAOlC,EAAOC,EAAOrJ,EAAMuL,GAAM3Q,KAAKL,MAC/EM,OAAM,SAACsK,GACM,SAAVA,EACFjB,GAAYsH,wBAAwBL,GAAWvQ,MAAK,SAACtb,GACnDmsB,GAAwBnsB,EAAK0E,EAAKonB,EAAQE,EAAOlC,EAAOC,EAAOrJ,EAAMuL,GAAM3Q,KAAKL,MAC/EM,MAAML,GAETA,EAAc2K,SAajB,SAASsG,GAAwBnsB,EAAa0E,EACnDonB,EAA0BE,EAAalC,EAAeC,EAAerJ,EAAcuL,GAEnF,IAAMG,EAAU,IAAIlkB,SAA0B,SAAC+S,EAAgBC,IDtO1D,SAAsBlb,GAW3B,OAVgB,IAAIkI,SAA0B,SAAC+S,EAAgBC,GAC7D,IAAMH,EAAM,IAAIC,MAChBD,EAAIN,IAAMza,EACV+a,EAAII,OAAS,WACX,IAAM1U,EAAwB,CAACsU,EAAI1Y,MAAO0Y,EAAIzY,QAC9C2Y,EAAexU,IAEjBsU,EAAIK,QAAU,WAAQF,EAAc,CAAC,EAAG,SC+NxCmR,CAAarsB,GAAKsb,MAAK,SAAC7U,GAEtB,IAAMijB,EAASH,KACfG,EAAOhK,KAAO,MAED,UAAVsM,EACDtC,EAAOhB,UAAY,MACD,cAAVsD,EACRtC,EAAOhB,UAAY,UACD,cAAVsD,IACRtC,EAAOhB,UAAY,WAGrBgB,EAAOd,YAAc0D,OAAM,OAACL,QAAD,IAACA,OAAD,EAACA,EAAM/iB,YAClCwgB,EAAOL,SAAU,EAGjBK,EAAOV,mBAAoB,EAE3BU,EAAO1pB,IAAMA,EAIb0pB,EAAOjjB,KAAO,CAACA,EAAK,GAAIA,EAAK,IAC7BijB,EAAOlB,aAAe,CAAC/hB,EAAK,GAAIA,EAAK,IAErC,IADA,IACS8B,EAAI,EAAGA,EAAImhB,EAAO5jB,KAAKH,SAAS6C,OAAQD,GAAK,EAChDujB,EACU,gBAATpL,GACDgJ,EAAO5jB,KAAKH,SAAS,GAAKkC,OAAOiiB,GACjCJ,EAAO5jB,KAAKH,SAAS,GAAKkC,OAAOkiB,IAEjCL,EAAO5jB,KAAKH,SAAS4C,GAAK7D,EAAIklB,WAAWrhB,GAAKujB,EAAOvjB,GAGvDmhB,EAAO5jB,KAAKH,SAAS4C,GAAK7D,EAAIklB,WAAWrhB,GAV9B,GAU4CmhB,EAAOjjB,KAAK8B,GAGvE0S,EAAeyO,SAInB,OAAO0C,EAMT,SAASG,GAAmBC,IAQrB,SAASC,GAAmB1G,EAAYrhB,EAAconB,GA4B3D,OA3BArG,QAAQI,MAAM,8BACE,IAAI3d,SAA0B,SAAC+S,EAAgBC,GAC7D,GAAIiK,KAAM,CAGRA,KAAKI,OAAOmH,KACV,CACEC,OAJY,0CAKZ9H,SAJc,2EAKd+H,MAAO,gDACPC,cAAe,CAAC,gEAElBvR,MACA,WACEmK,QAAQC,IAAI,0BACZyC,GAAahD,KAAK2H,MAAMC,kBAExBtH,QAAQC,IAAI,oCACZyC,GAAWqE,WAAWQ,OAAOT,OAE/B,SAACU,GACCxH,QAAQC,IAAI,2BAA4BuH,UAU3C,SAASC,GAAqBhO,EAA4Bxa,EAAcgb,EAAkBoK,EAAcC,EAAcrJ,GAC3H,IAAMgJ,EAASH,KACfG,EAAOhK,KAAOA,EACdgK,EAAO1pB,IAAM,GACD,gBAAT0gB,GACDgJ,EAAO5jB,KAAKH,SAAS,GAAKkC,OAAOiiB,GACjCJ,EAAO5jB,KAAKH,SAAS,GAAKkC,OAAOkiB,KAEjCL,EAAO5jB,KAAKH,SAAS,GAAKjB,EAAIklB,WAAW,GACzCF,EAAO5jB,KAAKH,SAAS,GAAKjB,EAAIklB,WAAW,IAE3C,IAAMzR,EAAQ+G,EAAOgB,MAAK,SAAA/H,GAAK,MAAmB,UAAfA,EAAM8G,QACnCkO,EAAQ,OAAGhV,QAAH,IAAGA,OAAH,EAAGA,EAAOiV,cAQxB,OANE1D,EAAOlB,aADL2E,EACoB,CAACA,EAAS9qB,OAAS,EAAG8qB,EAAS7qB,QAAU,GAEzC,CAAC,EAAG,GAE5BonB,EAAOjjB,KAAO,EAAEijB,EAAOlB,aAAa,IAAM,KAAO,GAAIkB,EAAOlB,aAAa,IAAM,KAAO,GAE/EkB,EAGF,SAAS2D,GAAsB3lB,EAAahD,EAAaolB,EAAcC,EAAcrJ,GAC1F,OAAO,IAAIxY,SAAwB,SAACC,EAASC,GAC3C,IAAIohB,OAAU/R,EACd,GAA+B,IAA3B/P,EAAI4iB,QAAQ,YAAgD,IAA5B5iB,EAAI4iB,QAAQ,YAAmB,CACjE,IAAMtqB,EAAM,IAAIE,IAAIwH,GACd4lB,EAAM5lB,EAAIyB,OAAO,GACnB5G,EAAUvC,KAEZwpB,EAAU4B,GAAoB1jB,EAAKhD,EAAKolB,EAAOC,EAAOrJ,IAC9C5K,KAAO,wBACf3N,EAAQqhB,IACQ,SAAR8D,GAA0B,SAARA,GAA0B,SAARA,GAA0B,SAARA,GACtD,SAARA,GAA0B,SAARA,GAA0B,SAARA,GAA0B,SAARA,GAC9C,SAARA,GAA0B,SAARA,EAClBnB,GAAwBzkB,EAAKhD,GAAK4W,MAAK,SAACkO,GACtCA,EAAQ1T,KAAO9V,EAAIW,SACnBwH,EAAQqhB,MACPjO,MAAMnT,GAETyhB,GAAsBniB,EAAKhD,EAAKolB,EAAOC,EAAOrJ,GAAMpF,MAAK,SAACkO,GACnC,WAAjBA,EAAQ9J,QAEV8J,EAAU4B,GAAoB1jB,EAAKhD,EAAKolB,EAAOC,EAAOrJ,IAC9C5K,KAAR,UAAkB9V,EAAIwC,MAAtB,OAA6BxC,EAAIW,UAAjC,OAA4CX,EAAIkqB,SAE7B,YAAjBV,EAAQ9J,KACV8J,EAAQ1T,KAAR,UAAkB9V,EAAIkqB,OAAOvF,UAAU,IAEvC6E,EAAQ1T,KAAR,UAAkB9V,EAAIwC,MAAtB,OAA6BxC,EAAIW,UAAjC,OAA4CX,EAAIkqB,QAElD/hB,EAAQqhB,MACPjO,MAAMnT,QAGXohB,EAAU4B,GAAoB1jB,EAAKhD,EAAKolB,EAAOC,EAAOrJ,IAC9C5K,KAAOpO,EAAIid,UAAU,EAAG,IAChCxc,EAAQqhB,MA0Ed,SAAS+D,GAAS7lB,GAChB,IAAM8lB,EAAOC,SAASC,cAAc,YACpCF,EAAKG,MAAQjmB,EACb8lB,EAAKI,eAAiB,EACtBJ,EAAKK,aAAeL,EAAKG,MAAMnlB,OAC/B,IAAMhE,EAAIgpB,EAAKM,MACftpB,EAAEmB,SAAW,QACbnB,EAAEupB,KAAO,QAETN,SAAS9G,KAAKqH,YAAYR,GAC1BA,EAAKS,QACL,IAAM5H,EAASoH,SAASS,YAAY,QAIpC,OAHAV,EAAKW,OACLV,SAAS9G,KAAKyH,YAAYZ,GAEnBnH,EAgDF,SAASgI,GAAaC,EAAkBnE,GAC7C,IAAMvC,EAASuC,EAAO1pB,IAAI,MACtBomB,EAAWsD,EAAO1pB,IAAI,YAC1BomB,EAAWA,GAAsB,GACjC,IAAM0H,EAAO,+BAETvuB,EAAG,0CAAsC4nB,EAAtC,YACP,GAAI0G,GAhBC,SAAgCzH,GACrC,QAAKA,IAEe,sEAAbA,GACS,4CAAbA,GACa,yCAAbA,GACa,6CAAbA,GAUY2H,CAAuB3H,GACpC,GAAIA,EAASjmB,OAAO,EAAG2tB,EAAK/lB,UAAY+lB,EAAK,CAC3C,IAAIE,EAAM5H,EAASjmB,OAAO2tB,EAAK/lB,QACnB,WAARimB,IACU,gBAARA,IAAwBA,EAAM,gBAClCzuB,EAAG,kCAA8ByuB,EAA9B,cAAuC7G,EAAvC,eAEA,GAAiB,sEAAbf,EAAkF,CAE3F7mB,EAAG,kCADS,eACT,cAAuC4nB,EAAvC,SAIP,OAAO5nB,EAOF,SAAS0uB,GAAiB1uB,GAC/B,IAAM2uB,EAAQ3uB,EAAIsqB,QAAQ,KACpBsE,EAAWD,GAAS,EAAI3uB,EAAIY,OAAO+tB,GAAS3uB,EAGlD,OAFe,IAAI6B,IAAI+sB,EAAShnB,MAAM,KAAKlD,KAAI,SAAAgD,GAAG,OAAIA,EAAIE,MAAM,SAyC3D,SAASinB,GAAiB7rB,GAC/B,GAAIghB,GAAmBhhB,GAAG,CACxB,IAAI8rB,EAAMC,GAAeC,OAAOC,WAAU,SAAAjsB,GAAC,OAAIA,EAAEihB,OAASJ,MAG1D,GAFIiL,EAAM,IAAIA,EAAMC,GAAeC,OAAOxmB,SAC1CsmB,GAAO,IACI,EAAE,CACX,IAAMI,EAAQH,GAAeC,OAAOF,GAAK7K,OAAS,EAClDjhB,EAAEihB,OAASiL,GAASrL,GAAWqL,EAAQrL,SAGzC7gB,EAAEihB,OAASthB,KAAKgG,MAAM0X,KAAKC,MAAQsD,IAIhC,SAASuL,GAAoBnsB,GAClC,GAAIghB,GAAmBhhB,GAAG,CACxB,IAAMosB,EAASL,GAAeC,OAAO,GACjCI,IAAWpsB,IACbA,EAAEihB,OAASmL,EAAOnL,OAAS,OAE1B,CACH,IAAMmL,EAASL,GAAeC,OAAO9O,MAAK,SAAAld,GAAC,OAAIA,EAAEihB,OAASJ,MACrDuL,EAGHpsB,EAAEihB,OAASmL,EAAOnL,OAAS,EAF3B4K,GAAiB7rB,I,sEEhnBVqsB,GAAqC,SAAC3tB,KAItC4tB,GAAb,WAUE,aAAqB,yBATbC,MAAM,GASM,KARZC,WAAY,EAQA,KANZC,gBAMY,OALZ3S,YAKY,OAJZ4S,SAAW,IAAI7tB,IAIH,KAHZ8tB,SAAW,IAAI9tB,IAGH,KAFZ+tB,cAAgB,EAEJ,KAoTZC,QAAU,IAAIC,gBAnTpB9Y,KAAK0Y,SAASlR,IAAI,UAAWxH,KAAK+Y,WAClC/Y,KAAK0Y,SAASlR,IAAI,kBAAmBxH,KAAKgZ,mBAC1ChZ,KAAK0Y,SAASlR,IAAI,kBAAmBxH,KAAKiZ,mBAC1CjZ,KAAK0Y,SAASlR,IAAI,mBAAoBxH,KAAKkZ,oBAC3ClZ,KAAK0Y,SAASlR,IAAI,mBAAoBxH,KAAKmZ,oBAC3CnZ,KAAK0Y,SAASlR,IAAI,gBAAiBxH,KAAKoZ,iBACxCpZ,KAAK0Y,SAASlR,IAAI,mBAAoBxH,KAAKqZ,oBAC3CrZ,KAAK0Y,SAASlR,IAAI,iBAAkBxH,KAAKsZ,kBACzCtZ,KAAK0Y,SAASlR,IAAI,eAAgBxH,KAAKuZ,gBACvCvZ,KAAK0Y,SAASlR,IAAI,aAAcxH,KAAKwZ,cACrC,IACExZ,KAAK8F,OAAS,IAAI2T,UACnB,MAAO5K,GACa,qBAAfA,EAAM/P,MACR2P,QAAQiL,KAAK,0BAzBrB,sCAGE,WAAY,OAAO1Z,KAAKuY,QAH1B,yBA6BE,WAAqB,IAAD,EAClB,OAAOvY,KAAKwY,YAAa,UAAAxY,KAAKyY,kBAAL,eAAiB7E,cAAe+F,UAAUC,OA9BvE,qBAkCE,SAAelwB,EAAcoe,GAAc,IAAD,OA4CxC,OA3CAuQ,GAAO,mBAAD,OAAoB3uB,EAApB,aAA6Boe,EAA7B,MACU,IAAI5W,SAAgB,SAACC,EAASC,GAC5C,EAAKqnB,WAAa,IAAIkB,UAAUnT,OAAOiS,YACvC,IAAMoB,EAAc,WAClB,IAAM/Q,EAAoB,CACxBJ,KAAK,UACLZ,QAEF,EAAKgS,gBAAgBhR,EAAK3X,EAASC,EAAQ1H,IAEvCqwB,EAAiB,SAACC,GACtB,IAAMlR,EAAM3D,KAAKI,MAAMyU,EAAGC,MACpBhpB,EAAO,EAAKynB,SAASjvB,IAAIqf,EAAIJ,MAC/BzX,EACFA,EAAKqd,KAAK,EAAVrd,CAAgB6X,GAEhB2F,QAAQI,MAAR,4BAAmC/F,EAAIJ,KAAvC,aAAwDI,IAGtDoR,EAAe,WACnB7B,GAAO,4BACP,EAAKG,WAAY,EACjB,EAAK2B,KAAK,cAEVC,YAAW,WACT,EAAK3B,WAAa,IAAIkB,UAAUnT,OAAOiS,YACvC4B,MACC,MAECC,EAAe,WAAO,IAAD,EACzB7L,QAAQI,MAAR,iCAAwCrI,OAAOiS,aAC/C,YAAKA,kBAAL,SAAiB8B,MAAM,IAAM,WAC7BL,KAGIG,EAAkB,WAAO,IAAD,QAC5B,YAAK5B,kBAAL,SAAiB+B,iBAAiB,QAASF,GAC3C,YAAK7B,kBAAL,SAAiB+B,iBAAiB,UAAWT,GAC7C,YAAKtB,kBAAL,SAAiB+B,iBAAiB,OAAQX,GAC1C,YAAKpB,kBAAL,SAAiB+B,iBAAiB,QAASN,IAE7CG,SA5EN,wBAgFE,WAAoB,IAAD,EACjB,UAAAra,KAAKyY,kBAAL,SAAiB8B,QACjBva,KAAKuY,MAAQ,KAlFjB,oCAqFE,SAA+BzP,GAC7B9I,KAAK4Y,gBACL9P,EAAI2R,GAAKza,KAAK4Y,gBAvFlB,+BAyFE,SAA0B9P,EAAe3X,EAAuBC,EAA2BspB,GACzF1a,KAAK2a,uBAAuB7R,GAC5B9I,KAAK2Y,SAASnR,IAAIsB,EAAI2R,GAAK,CAACtpB,UAASC,SAAQspB,UA3FjD,2BA6FE,SAAsB5R,GACR,IAAD,EAAX,GAAIA,EAAI2R,GACN,iBAAOza,KAAK2Y,SAASlvB,IAAIqf,EAAI2R,WAA7B,aAAO,EAA2BC,MA/FxC,6BAkGE,SAAwB5R,EAAe3X,EAAuBC,EAA2BspB,GAClF1a,KAAKyY,YAKRzY,KAAK4a,kBAAkB9R,EAAK3X,EAASC,EAAQspB,GAC7C1a,KAAKyY,WAAWzE,KAAK7O,KAAKC,UAAU0D,KALhC1X,GACFA,EAAO,mBArGf,4BA4GE,SAAuBypB,EAAcnwB,GACnC,IACO,EADD+vB,EAAKI,EAAEJ,GACTA,IACF,UAAAza,KAAK2Y,SAASlvB,IAAIgxB,UAAlB,SAAuBtpB,QAAQzG,GAC/BsV,KAAK2Y,SAAS5tB,OAAO0vB,MAhH3B,2BAmHE,SAAsBI,EAAcnwB,GAClC,IAAM+vB,EAAKI,EAAEJ,GACb,GAAIA,EAAG,CAAC,IAAD,EACCrpB,EAAM,UAAG4O,KAAK2Y,SAASlvB,IAAIgxB,UAArB,aAAG,EAAuBrpB,OAClCA,GAAQA,EAAO1G,GACnBsV,KAAK2Y,SAAS5tB,OAAO0vB,MAxH3B,wBA6HE,SAAmB3S,GAAc,IAAD,OAQ9B,OAPgB,IAAI5W,SAAc,SAACC,EAASC,GAC1C,IAAM0X,EAAoB,CACxBJ,KAAK,kBACLZ,QAEF,EAAKgS,gBAAgBhR,EAAK3X,EAASC,QAnIzC,+BAuIE,SAA0B/C,GAAiB,IAAD,SAClCya,EAAMza,EACZ,UAAA2R,KAAK8F,cAAL,SAAasI,KAAK,CAAC0M,sBAAuBhS,EAAIiS,kBAAkBzW,MAAK,WACnE,EAAK0W,eAAe3sB,QA1I1B,uBA8IE,SAAkBA,GAAiB,IAAD,OAChCgqB,GAAO,cAAD,OAAelT,KAAKC,UAAU/W,KACpC,IAAMya,EAAMza,EACZ2R,KAAKuY,MAAQzP,EAAIhB,KACjB,IAAMpe,EAAOsW,KAAKib,cAAcnS,GAChC,IAAI9I,KAAKyY,WAeP,MADAzY,KAAKkb,cAAcpS,GACb,IAAI1e,MAAM,uCAdhB,IAAM+wB,EAAwB,CAC5BzS,KAAM,OACNZ,KAAKgB,EAAIhB,KACTpe,QAEF2uB,GAAO,aAAD,OAAclT,KAAKC,UAAU+V,KACnCnb,KAAKyY,WAAWzE,KAAK7O,KAAKC,UAAU+V,IACpCnb,KAAKob,WAAWtS,EAAIhB,MAAMxD,MAAK,WAC7B,EAAK0W,eAAelS,EAAKA,EAAIhB,MAC7B,EAAK0Q,WAAY,EACjB,EAAKK,QAAQsB,KAAK,gBA9J1B,6BAsKE,SAAuBkB,EAA2BjU,GAAiB,IAAD,OAahE,MAZY,YAARiU,GAAsBjU,GACxBqH,QAAQI,MAAR,gDAEc,IAAI3d,SAAmC,SAACC,EAASC,GAC/D,IAAM0X,EAA+B,CACnCJ,KAAK,kBACLZ,KAAK,EAAKA,KACVV,SACAiU,OAEF,EAAKvB,gBAAgBhR,EAAK3X,EAASC,EAAQgW,QAjLjD,+BAqLE,SAA0B/Y,GACxB,IASIitB,EACmB,EAElB,EAZCxS,EAAMza,EACOktB,GAAoCzS,EAAhDJ,KAAgDI,EAA1ChB,KAA0CgB,EAApCyS,WAAWC,EAAyB1S,EAAzB0S,WAAerI,EAA7C,aAAuDrK,EAAvD,IACM2S,EAAwC,2BAC5C7U,GAAG2U,GACApI,GAFyC,IAG5CqI,aACAE,mBAAoB,QAIN,SAAZ5S,EAAIuS,IACNC,EAAe,UAAGtb,KAAK8F,cAAR,aAAG,EAAa6V,oBAAoBF,GAEnDH,EAAe,UAAGtb,KAAK8F,cAAR,aAAG,EAAa8V,oBAAoBH,GAErD,GAAIH,EAAgB,CAClB,IAAMlU,EAASpH,KAAKib,cAAcnS,IAmOjC,SAAkCyS,EAAsCF,EAA2BjU,GAExG,IAAKmU,EAAUM,QAAQC,KAAK,CAC1B,IAAMC,EAAmB,6BAAOC,IAAP,IAA6BX,QACtDE,EAAUM,QAAQC,KAAO7b,aAAW8b,GACpCR,EAAUU,SAASC,YAAY,SAAS,YATrC,SAAiCX,GAClCA,EAAUM,QAAQM,UAAUpyB,OAAOqyB,cAAcb,EAAUM,QAAQM,iBAChEZ,EAAUM,QAAQM,SAQrBE,CAAwBd,MAK5B,IAAIe,EAAiB,IAAIzxB,IACrB0xB,EAAgB,IAAI1xB,IACxB0wB,EAAUM,QAAQM,SAAWpyB,OAAOyyB,aAAY,WAC9C,IAAMC,EAAUlB,EAAUM,QAAQC,KACzB,OAATP,QAAS,IAATA,KAAWmB,WAAWpY,MAAK,SAACqY,GAC1B,IAQIC,EAREte,EAAOue,MAAMnT,KAAKiT,EAAMre,QAS9B,GAAY,SAAR+c,EAAe,CACjB,IAEMyB,EAFYxe,EAAKye,QAAO,SAAAjO,GAAC,OAAIA,EAAEpL,SAAS,8BAAgCoL,EAAEpL,SAAS,gCACtFhW,KAAI,SAAAohB,GAAC,OAAIA,EAAEnB,UAAU,iBAAiBnc,WACf9D,KAAI,SAAAkZ,GAAE,MAAK,CACnCA,KACAS,MAAOsV,EAAMlzB,IAAN,wBAA2Bmd,IAClCQ,OAAQuV,EAAMlzB,IAAN,6BAAgCmd,QAE1CgW,EAAcE,EAAQpvB,KAAI,SAAAmY,GAAW,IAAD,QAC5BmX,EAAOV,EAAe7yB,IAAIoc,EAAOe,IACjCqW,EAAS,OAAJD,QAAI,IAAJA,GAAA,UAAAA,EAAM3V,aAAN,SAAaoB,WAAa5C,EAAOwB,MAAMoB,UAAYuU,EAAK3V,MAAMoB,WAAW,IAAO,EAgB3F,OAdI5C,EAAOwB,MAAM6V,SACfP,EAAMlzB,IAAIoc,EAAOwB,MAAM6V,SAEH,CACpB7B,MACAzU,GAAIf,EAAOe,GACXuW,YAAcF,GAAMpX,EAAOwB,MAAM+V,WAAnB,OAAgCJ,QAAhC,IAAgCA,GAAhC,UAAgCA,EAAM3V,aAAtC,OAAgC,EAAa+V,WACxDvX,EAAOwB,MAAM+V,UAAUJ,EAAK3V,MAAM+V,WAAWH,EAAK,EACrDI,MAAOxX,EAAOwB,MAAM6V,QAAWP,EAAMlzB,IAAIoc,EAAOwB,MAAM6V,SAA2BrN,cAAWpP,EAC5F6c,cAAezX,EAAOwB,MAAMiW,cAE5BC,aAAY,UAAE1X,EAAOuB,cAAT,aAAE,EAAemW,aAC7BC,cAAa,UAAE3X,EAAOuB,cAAT,aAAE,EAAeoW,kBAIlClB,EAAiB,IAAIzxB,IAAIiyB,EAAQpvB,KAAI,SAACF,GAAD,MAAO,CAACA,EAAEoZ,GAAIpZ,WAChD,CACH,IAEMsvB,EAFYxe,EAAKye,QAAO,SAAAjO,GAAC,OAAIA,EAAEpL,SAAS,6BAA+BoL,EAAEpL,SAAS,+BACrFhW,KAAI,SAAAohB,GAAC,OAAIA,EAAEnB,UAAU,gBAAgBnc,WACd9D,KAAI,SAAAkZ,GAAE,MAAK,CACnCA,KACAS,MAAOsV,EAAMlzB,IAAN,uBAA0Bmd,IACjCQ,OAAQuV,EAAMlzB,IAAN,8BAAiCmd,QAG3CgW,EAAcE,EAAQpvB,KAAI,SAAAmY,GAAW,IAAD,QAC5BmX,EAAOT,EAAc9yB,IAAIoc,EAAOe,IAChCqW,EAAS,OAAJD,QAAI,IAAJA,GAAA,UAAAA,EAAM3V,aAAN,SAAaoB,WAAa5C,EAAOwB,MAAMoB,UAAYuU,EAAK3V,MAAMoB,WAAW,IAAO,EAe3F,OAbI5C,EAAOwB,MAAM6V,SACfP,EAAMlzB,IAAIoc,EAAOwB,MAAM6V,SAEH,CACpB7B,MACAzU,GAAIf,EAAOe,GACXuW,YAAcF,GAAMpX,EAAOwB,MAAMoW,eAAnB,OAAoCT,QAApC,IAAoCA,GAApC,UAAoCA,EAAM3V,aAA1C,OAAoC,EAAaoW,eAC5D5X,EAAOwB,MAAMoW,cAAeT,EAAK3V,MAAMoW,eAAeR,EAAK,EAC9DI,MAAOxX,EAAOwB,MAAM6V,QAAWP,EAAMlzB,IAAIoc,EAAOwB,MAAM6V,SAA2BrN,cAAWpP,EAC5Fid,OAAQ7X,EAAOwB,MAAMqW,OACrBH,aAAY,UAAE1X,EAAOuB,cAAT,aAAE,EAAemW,aAC7BC,cAAa,UAAE3X,EAAOuB,cAAT,aAAE,EAAeoW,kBAIlCjB,EAAgB,IAAI1xB,IAAIiyB,EAAQpvB,KAAI,SAACF,GAAD,MAAO,CAACA,EAAEoZ,GAAIpZ,OAGpDivB,EAAQc,kBAAe9c,EACvBgc,EAAQe,mBAAgB/c,EACxBgc,EAAQiB,YAASjd,EACjBkd,GAAa,eAAgBlB,EAASG,GACtCe,GAAa,gBAAiBlB,EAASG,GACvCe,GAAa,SAAUlB,EAASG,GAEhC,IAAMgB,EAAOtf,EAAK4K,MAAK,SAAA4F,GAAC,MAA8C,iBAA1CA,EAAEnB,UAAU,EAAG,eAAenc,WAC1D,GAAIosB,EAAK,CACP,IAAM7B,EAAQY,EAAMlzB,IAAIm0B,GAClBC,GAAS9B,EAAMtT,UAAYgU,EAAQhU,WAAW,IACpDgU,EAAQhU,UAAYsT,EAAMtT,UACtBsT,EAAM0B,gBACRhB,EAAQqB,mBAAqBnyB,KAAKgG,OAAOoqB,EAAM0B,cAAgBhB,EAAQgB,eAAiBI,GACxFpB,EAAQgB,cAAgB1B,EAAM0B,eAE5B1B,EAAMqB,YACRX,EAAQsB,eAAiBpyB,KAAKgG,OAAOoqB,EAAMqB,UAAYX,EAAQW,WAAaS,GAC5EpB,EAAQW,UAAYrB,EAAMqB,WAE5B,IAAMY,EAAOjC,EAAMkC,wBACnB,GAAID,EAAK,CACP,IAAME,EAAOvB,EAAMlzB,IAAIu0B,GACjBG,EAAKxB,EAAMlzB,IAAIy0B,EAAKE,kBAG1B3B,EAAQ4B,KAAOF,EAAGn1B,IAClB,IAAMs1B,EAAK3B,EAAMlzB,IAAIy0B,EAAKK,mBAC1B9B,EAAQ+B,aAAR,UAA0BF,EAAGG,QAA7B,YAAwCH,EAAGI,KAA3C,YAAmDJ,EAAGK,WAG1D,IAAIC,OAAQne,EACZ,QAA2BA,IAAvBgc,EAAQc,mBAAoD9c,IAAxBgc,EAAQe,oBAAgD/c,IAAnBgc,EAAQiB,OAAqB,CACxG,IAAMH,EAAed,EAAQc,aAAed,EAAQc,aAAe,EAC7DC,EAAgBf,EAAQe,cAAgBf,EAAQe,cAAgB,EAChEE,GAAWF,GAAiBf,EAAQiB,OAAUjB,EAAQiB,OAAS,EACrEkB,EAAU,IAA+D,KAAxDrB,EAAa,MAAQ5xB,KAAKI,IAAIwxB,GAAe,IAAM,GACjD,IAAhBC,EAA+B,IAATE,EACzBkB,EAAUjzB,KAAK+oB,IAAI/oB,KAAKkzB,IAAID,EAAS,KAAM,GAE7CnC,EAAQmC,QAAUA,EAClBnC,EAAQK,QAAUF,EAElB,IAAM7U,EAAoB,SAANsT,EAAepU,GAAaI,MAAQJ,GAAa6X,UAAU1X,GAC3EW,IACFA,EAAY6W,QAAUnC,EAAQmC,YAE/Bra,UACF,KAvWCwa,CAAyBzD,EAAiBxS,EAAIuS,IAAKjU,GACnDpH,KAAKgb,eAAelS,EAAKwS,GAE3Btb,KAAKkb,cAAcpS,KA1MvB,8BA6ME,SAAwByS,EAAsCyD,EAAgD5X,GAAgB,IAAD,OAW3H,OAVgB,IAAIlW,SAAgB,SAACC,EAASC,GAC5C,IAAM0X,EAAgC,CACpCJ,KAAK,mBACLZ,KAAK,EAAKA,KACVV,SACA4X,iBACAzD,UAAWA,EAAU3U,IAEvB,EAAKkT,gBAAgBhR,EAAK3X,EAASC,QAtNzC,gCA0NE,SAA2B/C,GACzB,IAAMya,EAAMza,EACRya,EAAI+F,MACN7O,KAAKkb,cAAcpS,EAAKA,EAAI+F,OAE5B7O,KAAKgb,eAAelS,EAAK,MA/N/B,8BAoOE,SAAwBqK,GAEQ,IAAD,OAS7B,OARgB,IAAIjiB,SAAgB,SAACC,EAASC,GAC5C,IAAM0X,EAA6B,cACjCJ,KAAK,mBACLZ,KAAK,EAAKA,MACPqL,GAEL,EAAK2G,gBAAgBhR,EAAK3X,EAASC,QA7OzC,gCAiPE,SAA2B/C,GACzB,IAAMya,EAAMza,EACRya,EAAI+F,MACN7O,KAAKkb,cAAcpS,EAAKA,EAAI+F,OAE5B7O,KAAKgb,eAAelS,EAAKA,EAAImW,YAtPnC,2BA0PE,SAAqBA,GAAkB,IAAD,OASpC,OARgB,IAAI/tB,SAAgB,SAACC,EAASC,GAC5C,IAAM0X,EAA6B,CACjCJ,KAAK,gBACLZ,KAAK,EAAKA,KACVmX,YAEF,EAAKnF,gBAAgBhR,EAAK3X,EAASC,QAjQzC,6BAqQE,SAAwB/C,GACtB,IAAMya,EAAMza,EACRya,EAAI+F,MACN7O,KAAKkb,cAAcpS,EAAKA,EAAI+F,OAE5B7O,KAAKgb,eAAelS,KA1Q1B,8BA6QE,SAAwByS,EAAmB0D,GAAyB,IAAD,OAYjE,OAXgB,IAAI/tB,SAAyC,SAACC,EAASC,GACrE,IAAM0X,EAAgC,CACpCJ,KAAK,mBACLZ,KAAK,EAAKA,KACVV,OAAQ6X,EAASnX,KAAKA,KACtBiT,gBAAiB,EAAKjV,OAAQiV,gBAC9BQ,YACA0D,SAASA,EAASrY,IAEpB,EAAKkT,gBAAgBhR,EAAK3X,EAASC,QAvRzC,gCA2RE,SAA2B/C,GACzB,IAAMya,EAAMza,EACZ,GAAIya,EAAI+F,MACN7O,KAAKkb,cAAcpS,EAAKA,EAAI+F,WACzB,CACH,IAAMqQ,EAAmD,CACvDtY,GAAIkC,EAAIqW,SACRC,WAAYtW,EAAImW,SAChBhX,KAAMa,EAAIb,KACVoX,cAAevW,EAAIuW,eAErBrf,KAAKgb,eAAelS,EAAKoW,MAtS/B,4BAySE,SAAsBC,EAAkB/X,GAAgB,IAAD,OAUrD,OATgB,IAAIlW,SAAc,SAACC,EAASC,GAC1C,IAAM0X,EAA8B,CAClCJ,KAAK,iBACLZ,KAAK,EAAKA,KACVV,OAAQA,EACR+X,YAEF,EAAKrF,gBAAgBhR,EAAK3X,EAASC,QAjTzC,8BAqTE,SAAyB/C,GACvB,IAAMixB,EAAQjxB,EACXixB,EAAMzQ,MACP7O,KAAKkb,cAAcoE,EAAOA,EAAMzQ,OAEhC7O,KAAKgb,eAAesE,KA1T1B,yBA+TE,SAAmBC,EAA0BC,GAC3Cxf,KAAK6Y,QAAQqD,YAAYqD,EAAOC,KAhUpC,4BAkUE,SAAsBD,EAA0BC,GAC9Cxf,KAAK6Y,QAAQ4G,eAAeF,EAAOC,KAnUvC,+BAqUE,WACExf,KAAK6Y,QAAQ6G,uBAtUjB,kBAwUE,SAAaH,GAA0C,IAAD,uBAAZI,EAAY,iCAAZA,EAAY,kBACpD3f,KAAK6Y,QAAQsB,KAAKoF,EAAOI,KAzU7B,4BA4UE,SAAuBtxB,GACrB,IAAMya,EAAMza,EACZ2R,KAAKma,KAAK,eAAgBrR,EAAI8W,WA9UlC,0BAgVE,SAAqBvxB,GACnB,IAAMya,EAAMza,EACZ2R,KAAKma,KAAK,aAAcrR,EAAI8W,aAlVhC,KAwYa5D,GAAmC,CAC9CvT,UAAU,EACV2U,UAAU,EACVK,cAAc,EACdX,QAAQ,GACRzB,IAAK,QAoKP,SAASsC,GAAkBp0B,EAAckzB,EAAWE,GAClD,IAAMkD,EAAKpD,EACLqD,EAAKnD,EACPoD,EAAQ,EACZF,EAAGt2B,QAAQkX,EAJkD,oBAK9Cqf,GAL8C,IAK7D,IAAI,EAAJ,qBAAkB,CAAC,IAATtyB,EAAQ,QACZA,EAAEjE,KACJs2B,EAAGt2B,GAAQiE,EAAEjE,IAASs2B,EAAGt2B,GAAQs2B,EAAGt2B,GAAQ,GAC5Cw2B,MARyD,8BAWzDF,EAAGt2B,KACLs2B,EAAGt2B,IAASw2B,GC9kBhB,SAASC,GAAK5vB,GACZ,OAAQ,IAAMA,GAAG+B,OAAO,GAMnB,SAAS8tB,GAAe7vB,QACrBqQ,IAAJrQ,IACFA,EAAIiZ,KAAKC,OAEX,IAAMpd,EAAI,IAAImd,KAAKjZ,GACnB,MAAO,UATT,SAAcA,GACZ,OAAQ,MAAQA,GAAG+B,OAAO,GAQhB+tB,CAAKh0B,EAAEi0B,eAAV,YAA4BH,GAAK9zB,EAAEk0B,WAAW,GAA9C,YAAoDJ,GAAK9zB,EAAEm0B,UAA3D,eACDL,GAAK9zB,EAAEo0B,YADN,YACqBN,GAAK9zB,EAAEq0B,eCGrC,IAAMC,GAAa,I,OAAIC,GAAM,cAC7BD,GAAWE,QAAQ,GAAGC,OAAO,CAC3BC,QAAS,oCACTC,YAAa,OACbC,UAAW,KACXC,MAAO,SAOF,I,wBAAMC,GAAaR,GAAmBI,QAChCK,GAAeT,GAAmBM,UAClCI,GAAiBV,GAAmBK,YACpCM,GAAWX,GAAmBO,MA6BrCK,G,WAaJ,WAAYvb,EAAqBgL,EAAgB5I,EAAgBrB,EAAWya,GAAmC,yBAZvGC,WAYsG,OAT9G1a,QAS8G,OAR9G0B,SAQ8G,OAP9GiZ,SAO8G,OAN9G1Q,UAM8G,OAL9G5I,UAK8G,OAJ9GuZ,UAAY,EAIkG,KAH9GC,QAAU,EAGoG,KAF9GV,MAAgB,GAE8F,KAD9GW,OAAiC,aAE/B1hB,KAAK4G,GAAKA,EACV5G,KAAK6Q,KAAOA,EACZ7Q,KAAKsI,IAAL,OAAW+Y,QAAX,IAAWA,OAAX,EAAWA,EAAK/Y,IAChBtI,KAAKuhB,IAAL,OAAWF,QAAX,IAAWA,OAAX,EAAWA,EAAKE,IAChBvhB,KAAKiI,KAAOA,EACZjI,KAAKshB,MAAQ,IAAIK,cAAc9b,GAC/B7F,KAAKshB,MAAM9G,iBAAiB,gBAAiBxa,KAAK4hB,gBAAgBtT,KAAKtO,OACvEA,KAAKshB,MAAM9G,iBAAiB,OAAQxa,KAAK6hB,OAAOvT,KAAKtO,O,wCAnBvD,WAAc,OAAOA,KAAKshB,MAAMzb,S,iBAChC,WAAa,OAAO7F,KAAKshB,MAAMQ,Q,mBAoB/B,WAC2B,aAArB9hB,KAAKshB,MAAMQ,OACb9hB,KAAKshB,MAAM3J,QACX3X,KAAKwhB,UAAYnY,KAAKC,OAEtBmF,QAAQI,MAAM,yCAAkC7O,KAAKuhB,IAAvC,gBAAkDvhB,KAAKsI,KAAvD,yBACQtI,KAAKshB,MAAMQ,MADnB,KAC6B9hB,Q,kBAG/C,WAC2B,aAArBA,KAAKshB,MAAMQ,OACb9hB,KAAKshB,MAAMS,S,yBAGf,WAC2B,aAArB/hB,KAAKshB,MAAMQ,OACb9hB,KAAKshB,MAAMU,gB,oBAGf,WACEhiB,KAAKyhB,QAAUpY,KAAKC,Q,6BAEtB,SAAwB0Q,GACtB,IAAMiI,EAAOjI,EAAGC,KAChBja,KAAK+gB,MAAMhY,KAAKkZ,GAGhBjiB,KAAK0hB,OAAO1hB,U,KAaVkiB,G,aAGJ,WAAYpZ,EAAgBwE,GAAc,yBAF1CxE,SAEyC,OADzCwE,UACyC,EACvCtN,KAAK8I,IAAMA,EACX9I,KAAKsN,KAAOA,GAAcjE,KAAKC,SActB6Y,IAAb,cAgBE,aAAc,yBAfdC,OAAS,IAAIv3B,IAeA,KAdb+d,SAAsB,GAcT,2CAZb4Y,UAAY,EAYC,KAXbC,QAAU,EAWG,KATLY,cAAc,EAST,KARLC,cAA4B,GAQvB,KAPLC,UAAgC,GAO3B,KANLC,qBAAuB,IAAIra,IAAY,CAC7CyD,GAAY5B,iBAAkB4B,GAAYC,iBAAkBD,GAAYE,kBACxEF,GAAY/B,gBAAiB+B,GAAY9B,wBAAyB8B,GAAY7B,sBAC9E6B,GAAYG,qBAAsBH,GAAYd,uBAAwBc,GAAYV,yBAGvE,KAFLuX,kBAAmB,IAAI53B,IAElB,KAwJL63B,YAAa,EAvJnB3iB,aAAeC,MAjBnB,yCAmBE,WACEA,KAAKoiB,OAAO1a,QACZ1H,KAAK4I,SAAW,GAChB5I,KAAKsiB,cAAgB,GACrBtiB,KAAKwhB,UAAY,EACjBxhB,KAAKyhB,QAAU,EACfzhB,KAAKyiB,kBAAkB/a,UAzB3B,mBA4BE,SAAaiZ,GAAgB,IAAD,OAC1B3gB,KAAK0H,QAEL1H,KAAK2iB,WAAY,EACjB3iB,KAAKwhB,UAAYnY,KAAKC,MACtB,IAAMsZ,EAAkB,CACtBl5B,KAAMm5B,GAAWn5B,KACjB4jB,KAAMtN,KAAKwhB,UACXsB,SAAU,EACVC,MAAO,GACPd,UAAMxhB,GAERugB,GAAUgC,IAAIJ,GAEd5iB,KAAKuiB,UAAUxZ,KAAKzF,cAAQ,WAC1B,EAAK2f,4BAIP,IAAMpD,EAAKxT,GAAesU,EAAOuC,SAASC,KAC1CnjB,KAAK4I,SAASG,KAAK,CAACD,IAAI,CAACpW,EAAEkZ,GAAYd,uBAAwBrd,EAAE0X,KAAKC,UAAUya,IAAMvS,KAAMjE,KAAKC,QAEjG,IAAMrC,EAAiC4V,MAAMnT,KAAKiX,EAAO1Z,aAAaG,OAAOyD,UAC7E5D,EAAamc,QAAQzC,EAAO1Z,aAAaI,OACzC,IAAI,IAAJ,MAAeJ,EAAf,eAA4B,CAAxB,IAAMna,EAAC,KACTkT,KAAK4I,SAASG,KACZ,CAACD,IAAI,CAACpW,EAAEkZ,GAAY5B,iBAAkBld,EAAEA,EAAE8Z,GAAInZ,EAAE0X,KAAKC,UAAUtY,EAAEgV,cAAewL,KAAMjE,KAAKC,QAC7FtJ,KAAK4I,SAASG,KACZ,CAACD,IAAI,CAACpW,EAAEkZ,GAAYC,iBAAkB/e,EAAGA,EAAE8Z,GAAInZ,EAAE0X,KAAKC,UAAU/U,EAASvD,EAAEgC,QAASwe,KAAMjE,KAAKC,QACjGtJ,KAAK4I,SAASG,KACZ,CAACD,IAAI,CAACpW,EAAEkZ,GAAYE,kBAAmBhf,EAAGA,EAAE8Z,GAAInZ,EAAE0X,KAAKC,UAAU9U,EAAUxD,EAAEyD,SAAU+c,KAAMjE,KAAKC,QAElGtJ,KAAKqiB,eAAet4B,OAAOqyB,cAAcpc,KAAKqiB,eAClDriB,KAAKqiB,cAAgBt4B,OAAOyyB,aAAY,WACtC,EAAK6G,iBACJ,OA/DP,kBAmEE,WAAc,IAAD,OACPrjB,KAAKqiB,gBACPt4B,OAAOqyB,cAAcpc,KAAKqiB,eAC1BriB,KAAKqiB,cAAgB,GAHZ,oBAKIriB,KAAKuiB,WALT,IAKX,IAAI,EAAJ,qBAA8B,EAAEr2B,EAAF,YALnB,8BAoBX,OAdA8T,KAAKuiB,UAAY,GACD,IAAIrxB,SAAkB,SAACC,EAASC,GAC9C,EAAKkyB,sBAAsBhf,MAAK,SAAC8d,GAC/B,EAAKX,QAAUpY,KAAKC,MACpB,EAAKia,WAAWnB,GAAQ9d,MAAK,SAACkf,GAC5BrC,GAAQzZ,QAAQpD,MAAK,WACnB2c,GAAYvZ,QAAQpD,MAAK,WACvB4c,GAAcxZ,QAAQpD,MAAK,kBAAInT,EAAQqyB,eAG1Cjf,MAAMnT,WAnFjB,2BA0FE,SAAqB0X,GACf9I,KAAK2iB,WAAa3iB,KAAKwiB,qBAAqBiB,IAAI3a,EAAIpW,KAClDoW,EAAIpW,IAAMkZ,GAAYE,mBAAqBhD,EAAIpW,IAAMkZ,GAAYC,iBAC/D7L,KAAKyiB,kBAAkBh5B,IAAIqf,EAAIpW,KAAOoW,EAAIrb,IAC5CuS,KAAKyiB,kBAAkBjb,IAAIsB,EAAIpW,EAAGoW,EAAIrb,GACtCuS,KAAK4I,SAASG,KAAK,IAAImZ,GAAQpZ,KAGjC9I,KAAK4I,SAASG,KAAK,IAAImZ,GAAQpZ,OAlGvC,0BAyGE,WAAuB,IAAD,OA4DpB,OA3DgB,IAAI5X,SAAc,SAACC,GACjC,IAAMixB,EAASvF,MAAMnT,KAAK,EAAK0Y,OAAOvX,UAClCkV,EAAQqC,EAAO5wB,OAAS,EACtBkyB,EAAa,WAEH,MADd3D,GAGE5uB,KAGJ,EAAKwyB,sBAAsBrf,MAAK,WAAK,IAAD,gBACd8d,GADc,yBACvBd,EADuB,QAEhCL,GAAYx3B,IAAI63B,EAAM1a,IAAItC,MAAK,SAACsf,GAC9B,IAAMC,EAAqBD,GAA4B,CACrDhd,GAAI0a,EAAM1a,GACV4a,UAAWF,EAAME,UACjBC,QAASH,EAAMG,QACfnZ,IAAKgZ,EAAMhZ,IACXiZ,IAAKD,EAAMC,IACX1Q,KAAMyQ,EAAMzQ,KACZ5I,KAAMqZ,EAAMrZ,KACZ8Y,MAAO,IAET8C,EAAQrC,UAAYF,EAAME,UAC1BqC,EAAQpC,QAAUH,EAAMG,QACxB,IAbqC,EAa/BqC,EAAaxC,EAAMP,MAAM5uB,MAAM0xB,EAAQ9C,MAAMvvB,QAC/CuyB,EAAW,EAdsB,cAenBD,GAfmB,IAerC,IAAI,EAAJ,qBAA6B,CAAC,IACtBE,EAAgB,CAAE/B,KADG,SAG3Bd,GAAQ6B,IAAIgB,GAAQ1f,MAAK,SAAC2f,GACxBJ,EAAQ9C,MAAMhY,KAAKkb,KACnBF,IACiBD,EAAWtyB,QAC1ByvB,GAAYiD,IAAIL,EAASA,EAAQjd,IAAItC,MAAK,WACxCof,WAvB6B,mCADzC,2BAA4B,IADM,kCAiCpCxC,GAAciD,UAAU7f,MAAK,SAAC8f,GAC5B,IAAMC,EAAQD,EAAO/6B,QAAO,SAACyD,EAAEd,GAAH,OAASc,EAAId,EAAEwF,SAAQ,GACnD,GAAI,EAAKoX,SAASpX,OAAS6yB,EAAM,CAC/B,IAAMC,EAAgB,EAAK1b,SAASzW,MAAMkyB,GACpCE,EAA2B,CAC/B3b,SAAS0b,EACT9yB,OAAO8yB,EAAc9yB,QAEvB0vB,GAAc8B,IAAIuB,GAAYjgB,MAAK,WACjCof,YAGFA,YAjKV,kCAyKE,WAA8B,IAAD,OACvBc,EAAa,EAkEjB,OAjEgB,IAAItzB,SAAkB,SAACC,EAASC,GAC1CqzB,GAAS9B,WAAa,EAAKD,WAActxB,KAC7C,EAAKsxB,YAAa,EAClB1B,GAAU0D,MAAM,CAAC3B,MAAM,KAAKhD,OAAM,SAAA4E,GAChB,IAAZA,EAEJzD,GAAciD,SAAQ,SAACC,GACrBnD,GAAYkD,SAAQ,SAACS,GACnB,IAAMxC,EAAyB,GAC3BgC,EAAO5yB,QAAUozB,EAASpzB,OAAQ,WACpC,EAAKoX,SAAW,GAChB,IAFmC,EAE/BmX,EAAQ,EACN2D,EAAa,WAEH,MADd3D,GAEEmB,GAAcxZ,QAAQpD,MAAK,WACzB2c,GAAYvZ,QAAQpD,MAAK,WACvB6c,GAAQzZ,QAAQpD,MAAK,WACnB,EAAKmd,QAAU+C,EACf,EAAKjB,WAAWnB,GAAQ,GAAM9d,MAAK,SAACse,GAClC,EAAKF,YAAa,EAClBvxB,EAAQyxB,MACPre,MAAMnT,aAbgB,cAmBlBgzB,GAnBkB,IAmBnC,IAAI,EAAJ,qBAAwB,CAAC,IAAD,IAAdtb,EAAc,sBACPA,EAAIF,UADG,IACtB,IAAI,EAAJ,qBAA4B,CAAC,IAAnBiS,EAAkB,QAC1B2J,EAAa74B,KAAK+oB,IAAImG,EAAEvN,KAAMkX,IAFV,+BAItB,IAAK5b,UAASG,KAAd,oBAAsBD,EAAIF,YAvBO,kDAyBpBgc,GAzBoB,yBAyBzB/J,EAzByB,QA0BjC2J,EAAa74B,KAAK+oB,IAAImG,EAAE4G,QAAS5G,EAAE2G,UAAWgD,GAC9C,IAAMzD,EAAiBlE,MAAMhC,EAAEkG,MAAMvvB,QACrCuuB,GAASgB,EAAMvvB,OACf,IAAM8vB,EAAqB,CACzB1a,GAAGiU,EAAEjU,GACL0B,IAAIuS,EAAEvS,IACNiZ,IAAI1G,EAAE0G,IACN1Q,KAAKgK,EAAEhK,KACP5I,KAAK4S,EAAE5S,KACPuZ,UAAU3G,EAAE2G,UACZC,QAAQ5G,EAAE4G,QACVV,SAEFqB,EAAOrZ,KAAKuY,GACZzG,EAAEkG,MAAMjzB,SAAQ,SAACnD,EAAG4G,GAClB4vB,GAAQ13B,IAAIkB,GAAG2Z,MAAK,SAAC3Z,GACnBo2B,EAAMxvB,GAAK5G,EAAEs3B,KACbyB,WAlBN,IAAI,EAAJ,qBAAyB,IAzBU,8BA+CnCA,IA/CoC,GAiDpCtyB,UAtDcA,aA/K5B,iCA+OE,WAA8B,IAAD,OAC3B4O,KAAK2iB,WAAY,EACjB,IAAI5C,EAAQ,EAyBZ,OAxBgB,IAAI7uB,SAAoB,SAACC,EAASC,GAChD,IAAMsyB,EAAa,aACjB3D,IACcqC,EAAO5wB,QACnBL,EAAQixB,IAGNA,EAAS,EAAKE,cAEpB,GADAF,EAAOrZ,KAAP,MAAAqZ,EAAM,YAAS,EAAKA,OAAOvX,WACvBuX,EAAO5wB,OAAO,CAAC,IAAD,gBACG4wB,GADH,IAChB,IAAI,EAAJ,qBAA2B,CAAC,IAAlBd,EAAiB,QACL,aAAhBA,EAAMQ,MACR4B,KAGApC,EAAMI,OAAS,WAAQgC,KACvBpC,EAAMS,SAPM,oCAWhB5wB,EAAQixB,QAtQhB,wBA6QE,SAAmBA,EAAwByC,GAAqB,IAAD,OAwC7D,OAvCgB,IAAI3zB,SAAkB,SAACC,EAASC,GAC9C4vB,GAAU0D,MAAM,CAAC3B,MAAM,KAAKoB,UAAU7f,MAAK,SAACsc,GAC1C,GAAIA,EAAQpvB,OAAO,CACjB,IAAMszB,EAASlE,EAAQmE,MACnBF,IAAW,EAAKrD,UAAYsD,EAAOxX,MACvC,IAHiB,EAGX5jB,EAAOm7B,EAAYC,EAAOp7B,KAAOm5B,GAAWn5B,KAC5Cu4B,EAAO,EAAK+C,SAAS5C,GACrB6C,EAAsB,CAC1Bre,GAAIke,EAAOle,GACXld,OACA4jB,KAAM,EAAKkU,UACXsB,SAAU,EAAKrB,QAAU,EAAKD,UAC9BuB,MAAM,OAAD,OAASr5B,EAAT,YAAiBu2B,GAAe,EAAKuB,YAC1CS,QAGElC,EAAQa,EAAQpvB,OAAS,EACvBkyB,EAAa,WAEH,MADd3D,GAEE5uB,EAAQ8zB,IAlBK,cAsBFrE,GAtBE,IAsBjB,IAAI,EAAJ,qBAAwB,CAAC,IAAfvuB,EAAc,QACtB2uB,GAAUj2B,OAAOsH,EAAEuU,IAAItC,KAAKof,IAvBb,8BAyBjB1C,GAAUkD,IAAIe,EAAYA,EAAWre,IAAItC,MAAK,WAC5Cof,OACCnf,OAAM,WACPnT,EAAO,4CAEN,CACH,IAAM0X,EAAM,4DACZ2F,QAAQI,MAAM/F,GACd1X,EAAO0X,YAjTjB,sBAuTE,SAAiBsZ,GACf,IAAMrB,EAAe,GACf1Q,EAAuB,GACvB6U,EAAoB,CAAC1D,UAAUxhB,KAAKwhB,UAAWC,QAASzhB,KAAKyhB,QAAS7Y,SAAS5I,KAAK4I,UACpFqZ,EAAO,IAAI/R,KAAK,CAAC/K,KAAKC,UAAU8f,IAAY,CAACxc,KAAK,qBAClDyc,EAAoB,CAACtU,KAAK,UAAWphB,KAAKwyB,EAAKxyB,KAAMwY,KAAK,QAChE8Y,EAAMhY,KAAKkZ,GACX5R,EAAQtH,KAAKoc,GAPyB,oBAQvB/C,GARuB,IAQtC,IAAI,EAAJ,qBAAsB,CAAC,IAAbvH,EAAY,QACpB,GAAIA,EAAEkG,MAAMvvB,OAAO,CACjB,IAAMywB,EAAO,IAAI/R,KAAK2K,EAAEkG,OAClBoE,EAAoB,CACxB7c,IAAIuS,EAAEvS,IAAKiZ,IAAK1G,EAAE0G,IAAK1Q,KAAKgK,EAAEhK,KAAMphB,KAAKwyB,EAAKxyB,KAAMwY,KAAK4S,EAAE5S,KAC3DqF,KAAMuN,EAAE2G,UAAWsB,SAAUjI,EAAE4G,QAAU5G,EAAE2G,WACzCS,EAAKxyB,OACPsxB,EAAMhY,KAAKkZ,GACX5R,EAAQtH,KAAKoc,MAhBmB,8BAqBtCpE,EAAMqC,QAAQ,IAAIlT,KAAK,CAAC/K,KAAKC,UAAUiL,IAAW,CAAC3H,KAAK,sBACxD,IAAM0c,EAAY,IAAIC,YAAY,GAGlC,OAFAD,EAAU,GAAKrE,EAAM,GAAGtxB,KACxBsxB,EAAMqC,QAAQ,IAAIlT,KAAK,CAACkV,KACjB,IAAIlV,KAAK6Q,EAAO,CAACrY,KAAK,+BAhVjC,iCAkVE,WAA8B,IAAD,OACvBqX,EAAQ,EA0BZ,OAzBgB,IAAI7uB,SAAoB,SAACC,EAASC,GAChD,SAASsyB,MACP3D,IACcqC,EAAO5wB,QACnBL,EAAQixB,GAGZ,IAAMA,EAASvF,MAAMnT,KAAK,EAAK0Y,OAAOvX,UACtC,GAAIuX,EAAO5wB,OAAO,CAAC,IAAD,gBACG4wB,GADH,yBACNd,EADM,QAEM,aAAhBA,EAAMQ,MACR4B,KAEApC,EAAMI,OAAS,WACbJ,EAAMI,OAAS,aACfJ,EAAMG,QAAUpY,KAAKC,MACrBoa,KAEFpC,EAAMU,gBATV,IAAI,EAAJ,qBAA4B,IADZ,oCAchB7wB,EAAQixB,QA1WhB,mCAgXE,WACE,IAAMkD,EAAU,IAAInd,IAAInI,KAAKoiB,OAAO9jB,QAE9B6kB,EAA6CtG,MAAMnT,KAAKzC,GAAaG,OAAOyD,UAClFsY,EAAIpa,KAAK9B,GAAaI,OACtB,IAAI,IAAJ,MAAe8b,EAAf,eAAmB,CAAf,IAAMr2B,EAAC,KACHy4B,EAAG,aAASz4B,EAAE8Z,IAEpB,GADA0e,EAAQv6B,OAAOw6B,GACXz4B,EAAEob,OAAOsd,cACX,IAAKxlB,KAAKoiB,OAAOqB,IAAI8B,GAAK,CACxB,IAAMjE,EAAQ,IAAIF,GAASt0B,EAAEob,OAAOsd,aAAc,SAAU,QAASD,EAAK,CAACjd,IAAIxb,EAAE8Z,KACjF5G,KAAKoiB,OAAO5a,IAAI+d,EAAKjE,GACrBA,EAAM3J,aAEL,CACH,IAAM2J,EAAQthB,KAAKoiB,OAAO34B,IAAI87B,GAC1BjE,IACFA,EAAMS,OACN/hB,KAAKsiB,cAAcvZ,KAAKuY,GACxBthB,KAAKoiB,OAAOr3B,OAAOw6B,IAGvB,IAAME,EAAG,aAAS34B,EAAE8Z,IACpB,GAAI9Z,EAAEob,OAAOwd,aACX,IAAK1lB,KAAKoiB,OAAOqB,IAAIgC,GAAK,CACxB,IAAMnE,EAAQ,IAAIF,GAASt0B,EAAEob,OAAOwd,YAAa,SAAU,QAASD,EAAK,CAACnd,IAAIxb,EAAE8Z,KAChF5G,KAAKoiB,OAAO5a,IAAIie,EAAKnE,GACrBA,EAAM3J,aAEL,CACH,IAAM2J,EAAQthB,KAAKoiB,OAAO34B,IAAIg8B,GAC1BnE,IACFA,EAAMS,OACN/hB,KAAKsiB,cAAcvZ,KAAKuY,GACxBthB,KAAKoiB,OAAOr3B,OAAO06B,KAKzB,IAvC6B,EAuCvBE,EAAczC,GAAS0C,sBAvCA,cAwCVD,GAxCU,IAwC7B,2BAA+B,CAAC,IAArBE,EAAoB,QACvB75B,EAAIk3B,GAASha,KAAK2c,GACxB,GAAI75B,IAAiB,WAAXA,EAAE0c,MAAgC,WAAX1c,EAAE0c,MAAmB,CACpD,IADoD,EAC9CR,EAASgb,GAAS4C,cAAcr8B,IAAIo8B,GAAO3d,OADG,cAEjCA,GAFiC,IAEpD,IAAI,EAAJ,qBAA0B,CAAC,IAAjB/G,EAAgB,QACpByF,OAAE,EAON,GALEA,EADiB,UAAfzF,EAAM8G,KACN,aAASjc,EAAE4a,IAEX,aAAS5a,EAAE4a,IAEf0e,EAAQv6B,OAAO6b,IACV5G,KAAKoiB,OAAOqB,IAAI7c,GAAI,CACvB,IAAMf,EAAS,IAAI7E,YAAY,CAACG,IAC1BmgB,EAAQ,IAAIF,GAASvb,EAAQ7Z,EAAE0c,KAAMvH,EAAM8G,KAAmBrB,EAAI,CAAC2a,IAAIv1B,EAAE4a,KAC/E5G,KAAKoiB,OAAO5a,IAAIZ,EAAI0a,GACpBA,EAAM3J,QACNlJ,QAAQC,IAAR,kBAAuB9H,EAAvB,aAA8BzB,KAAKC,UAAUkc,OAfG,iCA1C3B,kDA+DbgE,GA/Da,IA+D7B,IAAI,EAAJ,qBAAwB,CAAC,IAAf1e,EAAc,QAChB0a,EAAQthB,KAAKoiB,OAAO34B,IAAImd,GAC1B0a,IACFA,EAAMS,OACN/hB,KAAKsiB,cAAcvZ,KAAKuY,GACxBthB,KAAKoiB,OAAOr3B,OAAO6b,KApEM,mCAhXjC,8CAGG3G,MAHH,yEAG0B,KAH1B,IA0bM8lB,G,aAQJ,WAAY9D,EAAYkD,GAAmB,yBAP3ClD,UAO0C,OAN1C3U,UAM0C,OAL1CwV,cAK0C,OAJ1CvB,SAI0C,OAH1CjZ,SAG0C,OAF1CuI,UAE0C,OAD1C5I,UAC0C,EACxCjI,KAAKiiB,KAAOA,EACZjiB,KAAKsN,KAAO6X,EAAO7X,KACnBtN,KAAK8iB,SAAWqC,EAAOrC,SACvB9iB,KAAKuhB,IAAM4D,EAAO5D,IAClBvhB,KAAKsI,IAAM6c,EAAO7c,IAClBtI,KAAK6Q,KAAOsU,EAAOtU,KACC,UAAhBsU,EAAOld,MAAoC,UAAhBkd,EAAOld,KACpCjI,KAAKiI,KAAOkd,EAAOld,KAEnBjI,KAAKiI,KAAO,aAKZ+d,I,cAMJ,aAAc,yBALdpd,SAAsB,GAKT,KAJbwZ,OAAsB,GAIT,KAHbZ,UAAY,EAGC,KAFbC,QAAU,EAEG,yCAwFLwE,KAAO,IAAI9d,IAxFN,KAyFL+d,KAAO,IAAI/d,IAxFjBpI,aAAeC,M,yCAGjB,WACEA,KAAK4I,SAAW,GAChB5I,KAAKoiB,OAAS,GACdpiB,KAAKwhB,UAAY,EACjBxhB,KAAKyhB,QAAU,I,kBAEjB,SAAK0E,GAAe,IAAD,OA0CjB,OAzCAnmB,KAAK0H,QACW,IAAIxW,SAAgB,SAACC,GACnC,IAAIwmB,EAAQ,EACZwO,EAAQh0B,MAAMwlB,EAAOA,EAAM,GAAGyO,cAAc9hB,MAAK,SAAA+hB,GAC/C1O,GAAS,EACT,IACMyN,EADO,IAAIkB,WAAWD,GACL,GACnBtG,EAAQ,EACZoG,EAAQh0B,MAAMwlB,EAAOA,EAAMyN,GAAW/c,OAAO/D,MAAK,SAAA+D,GAChDsP,GAASyN,EACT,IAFwD,EAElD/U,EAAUlL,KAAKI,MAAM8C,GAF6B,cAIpCgI,GAJoC,yBAI9C8U,EAJ8C,QAKlC,YAAhBA,EAAOtU,KAETsV,EAAQh0B,MAAMwlB,EAAOA,EAAMwN,EAAO11B,MAAM4Y,OAAO/D,MAAK,SAAA+D,GAClD,IAAM6c,EAAW/f,KAAKI,MAAM8C,GAC5B,EAAKO,SAAWsc,EAAStc,SACzB,EAAK4Y,UAAY0D,EAAS1D,UAC1B,EAAKC,QAAUyD,EAASzD,UACxB1B,IACc1P,EAAQ7e,QAASL,EAAQ,MAIzCg1B,EAAQh0B,MAAMwlB,EAAOA,EAAMwN,EAAO11B,MAAM22B,cAAc9hB,MAAK,SAAAiiB,GACzD,IAAMtE,EAAO,IAAI/R,KAAK,CAACqW,IACvB,EAAKnE,OAAOrZ,KAAK,IAAIgd,GAAU9D,EAAMkD,MACrCpF,IACc1P,EAAQ7e,QAASL,EAAQ,MAG3CwmB,GAASwN,EAAO11B,MApBlB,IAAI,EAAJ,qBAA6B,IAJ2B,8BA0BpD02B,EAAQ12B,OAASkoB,GACnBlJ,QAAQI,MAAR,uBAA8BsX,EAAQ12B,KAAtC,wCAA0EkoB,EAA1E,iB,kBAQV,WAAO,IAAD,OACJ3X,KAAKwmB,SAAU,EACf,IAAM5d,EAAWiU,MAAMnT,KAAK1J,KAAK4I,UAC3BwZ,EAASvF,MAAMnT,KAAK1J,KAAKoiB,QAC/BxZ,EAAS7Y,MAAK,SAACrF,EAAEC,GAAH,OAASD,EAAE4iB,KAAO3iB,EAAE2iB,QAClC8U,EAAOryB,MAAK,SAACrF,EAAEC,GAAH,OAASD,EAAE4iB,KAAO3iB,EAAE2iB,QAChC,IAAIA,EAAOtN,KAAKwhB,UACViF,EAAWpd,KAAKC,MAAQtJ,KAAKwhB,WACtB,SAAPkF,IAEJ,IADApZ,EAAOjE,KAAKC,MAAQmd,EACb7d,EAASpX,QAAUoX,EAAS,GAAG0E,KAAOA,GAAK,CAChD,IAAM+G,EAAUzL,EAAS+d,QACzBC,GAAOC,YAAYxS,EAAQvL,KAE7B,IANiB,iBAOf,IAAMwY,EAAQc,EAAOuE,QACrBC,GAAOE,UAAUxF,GACbA,EAAMwB,UACR1I,YAAW,WACT,EAAK2M,UAAUzF,KACdA,EAAMwB,WANNV,EAAO5wB,QAAU4wB,EAAO,GAAG9U,KAAOA,GAAM,IAS3CA,EAAOsZ,GAAOnF,QAChBrH,YAAW,WAAOsM,MAAS,IAE3B,EAAKM,UAGTN,K,kBAEF,WACEE,GAAOnF,QAAU,I,qBAInB,WACEzhB,KAAKwmB,SAAU,EACfxmB,KAAKimB,KAAKn4B,SAAQ,SAAAwa,GAChBrB,GAAaggB,eAAe3e,MAE9BtI,KAAKkmB,KAAKp4B,SAAQ,SAAAyzB,GAChB2B,GAAS+D,eAAe1F,Q,uBAI5B,SAAkBD,GAChB,GAAIA,EAAMhZ,KAAsB,WAAfgZ,EAAMzQ,KAAkB,CACvC,IAAMvI,EAAG,YAAQgZ,EAAMhZ,KACjBxb,EAAIma,GAAaY,SAASpe,IAAI6e,GAChCxb,IACFA,EAAEo6B,eAAYzmB,M,uBAIpB,SAAkB6gB,GAEhB,GAAIA,EAAMhZ,IAAI,CACZ,IAAMA,EAAG,YAAQgZ,EAAMhZ,KACvBtI,KAAKimB,KAAKjD,IAAI1a,GACd,IAAM9H,EAAMyG,GAAakgB,oBAAoB7e,GAC1B,UAAfgZ,EAAMrZ,KACRzH,EAAI4mB,UAAY9F,EAAMW,KACC,UAAfX,EAAMrZ,KACdzH,EAAI0mB,UAAY5F,EAAMW,KAEtBxT,QAAQI,MAAR,6BAAoCyS,EAAMrZ,YAExC,GAAIqZ,EAAMC,IAAI,CAClB,IAAMA,EAAG,YAAQD,EAAMC,KACvBvhB,KAAKkmB,KAAKlD,IAAIzB,GACd,IAAM/gB,EAAM0iB,GAASiE,oBAAoB5F,GACtB,UAAfD,EAAMrZ,KACRzH,EAAI4mB,UAAY9F,EAAMW,KACC,UAAfX,EAAMrZ,MACdzH,EAAI0mB,UAAY5F,EAAMW,KACtBzhB,EAAIxX,IAAME,IAAIm+B,gBAAgB/F,EAAMW,OAEpCxT,QAAQI,MAAR,6BAAoCyS,EAAMrZ,OAE5Cib,GAASoE,eAAe9mB,M,yBAG5B,SAAoBsI,GAElB,IAAMR,EAAMQ,EAAIhc,EAAJ,YAAagc,EAAIhc,GAAM,GAC/Bwb,GAAMtI,KAAKimB,KAAKjD,IAAI1a,GACxB,IAAMxb,EAAIwb,EAAMrB,GAAakgB,oBAAoB7e,QAAO7H,EACpD8mB,GAAa,EACX95B,EAAI0X,KAAKI,MAAMuD,EAAIrb,GACzB,GAAIX,EAEF,OADAy6B,GAAa,EACNze,EAAIpW,GACT,KAAKkZ,GAAY5B,iBAAkBld,EAAEgV,YAAcrU,EAAwB,MAC3E,KAAKme,GAAYC,iBAAkB/e,EAAEgC,KAAO2B,EAAShD,GAAc,MACnE,KAAKme,GAAYE,kBAAmBhf,EAAEyD,MAAQO,EAAUrD,GAAc,MACtE,KAAKme,GAAY/B,gBAAiB/c,EAAEqV,QAAQvC,iBAAmBnS,EAAc,MAC7E,KAAKme,GAAY9B,wBAAyBzL,OAAO+D,OAAOtV,EAAE06B,YAAa/5B,GAAmB,MAC1F,KAAKme,GAAY7B,sBAAuB1L,OAAO+D,OAAOtV,EAAE4Y,UAAWjY,GAAiB,MACpF,KAAKme,GAAYG,qBAAsBjf,EAAEqV,QAAQxC,QAAUlS,EAAc,MACzE,KAAKme,GAAY3B,mBAAoBnd,EAAE26B,QAAUh6B,EAAc,MAC/D,QAAS85B,GAAa,EAG1B,GAAIA,EAEF,OADAA,GAAa,EACNze,EAAIpW,GACT,KAAKkZ,GAAYd,uBAAwB9K,KAAK0nB,uBAAuB5e,GAAM,MAC3E,KAAK8C,GAAYV,uBAAwBlL,KAAK2nB,uBAAuB7e,GAAM,MAC3E,QAASye,GAAa,EAGtBA,GACF9Y,QAAQiL,KAAR,mCAAiD5Q,K,oCAGrD,SAA+BA,GAC7B,IAD4C,EACtC+W,EAAK1a,KAAKI,MAAMuD,EAAIrb,GADkB,cAE7BoyB,GAF6B,IAE5C,IAAI,EAAJ,qBAAkB,CAAC,IAAT7zB,EAAQ,QAEhBA,EAAE4a,GAAF,YAAY5a,EAAE4a,IACd,IAAMghB,EAAM1E,GAAS2E,aAAa77B,EAAE4a,IAChCghB,IACF57B,EAAEo7B,UAAYQ,EAAIR,UAClBp7B,EAAEk7B,UAAYU,EAAIV,UAClBl7B,EAAEhD,IAAM4+B,EAAI5+B,KAEC,WAAXgD,EAAE0c,MAAgC,WAAX1c,EAAE0c,OAC3B1c,EAAE0c,KAAkB,WAAX1c,EAAE0c,KAAoB,iBAAmB,kBAEpDwa,GAASoE,eAAet7B,GACxBgU,KAAKkmB,KAAKlD,IAAIh3B,EAAE4a,KAf0B,iC,oCAkB9C,SAA+BkC,GAC7B,IAD4C,EACtCod,EAAO/gB,KAAKI,MAAMuD,EAAIrb,GADgB,cAE3By4B,GAF2B,IAE5C,IAAI,EAAJ,qBAAsB,CAAC,IAAb3E,EAAY,QACpB2B,GAAS+D,eAAT,YAA6B1F,KAHa,mC,4CA7L7CthB,M,yEAAqB,K,IAqMXwkB,GAAW,IAAItC,GACfyE,GAAS,IAAIZ,GAC1B95B,EAAEu4B,SAAWA,GACbv4B,EAAE06B,OAASA,GC1yBJ,IAiCQ,OAjCf,cAeE,aAAe,yBAZfkB,sBAAwB,CAAC,IAAM,IAAM,KAYvB,KAXdC,uBAAyB,CAAC,IAAM,IAAM,KAWxB,0RACZhoB,aAAeC,MAhBnB,gDAkBE,SAAqBrN,EAAYpD,GAO/B,YANYkR,IAARlR,EACFyQ,KAAKgoB,UAAUj9B,OAAO4H,GAEtBqN,KAAKgoB,UAAUxgB,IAAI7U,EAAKpD,GAGnBoD,GACL,IAAK,iBAAkBqN,KAAKioB,eAAiB14B,EAAM4V,KAAKI,MAAMhW,GAAOyQ,KAAK8nB,sBAAuB,MACjG,IAAK,kBAAmB9nB,KAAKkoB,gBAAkB34B,EAAM4V,KAAKI,MAAMhW,GAAOyQ,KAAK+nB,uBAAwB,MACpG,IAAK,cAAe/nB,KAAKmoB,YAAc54B,EAAM4V,KAAKI,MAAMhW,GAAOyQ,KAAKmoB,iBA5B1E,8CAMGloB,MANH,yEAM0B,IAAIpV,OAN9B,wCAOGoV,MAPH,wEAOuB,MAPvB,2CAQGA,MARH,wEAQ0B,MAR1B,2CASGA,MATH,yEAS0B,KAT1B,8CAUGA,MAVH,yEAU+BD,KAAK8nB,yBAVpC,+CAWG7nB,MAXH,yEAWgCD,KAAK+nB,0BAXrC,2CAaG9nB,MAbH,yEAa0BkF,KAAKC,UAAU,CAACtG,KAAK,GAAGspB,MAAM,GAAGnT,KAAK,QAbhE,yCAkBGzT,MAlBH,+ECHO,SAAS6mB,KACkB,YAA5BC,aAAaC,YAAwD,WAA5BD,aAAaC,YACxDD,aAAaE,oBAGV,SAASC,GAAa1F,EAAenwB,GACV,YAA5B01B,aAAaC,YAEf,IAAID,aAAavF,EAAOnwB,GCe5B,IACM81B,GAAmC,aAE5BC,GAAb,WAIE,WAAY38B,GAAmB,yBAH/B48B,gBAG8B,OAF9BrG,UAAiC,GAG/BviB,KAAK4oB,WAAa58B,EALtB,kDAQE,SAAe68B,GACbH,GAAQ,0BACR1oB,KAAK8oB,gBAAgBD,GACrB7oB,KAAK+oB,mBACL9hB,GAAaI,MAAM2hB,kBACnBhpB,KAAKipB,cACLjpB,KAAKkpB,kBACLlpB,KAAKmpB,mBACLnpB,KAAKopB,iBACLppB,KAAKqpB,mBAjBT,6BAoBE,SAAgBR,GACd,IAAMS,EAAUj5B,EAAS4W,GAAaI,MAAMvY,MAC5CkR,KAAK4oB,WAAWW,YAAY3d,GAAYC,iBAAkByd,OAAS7oB,EAAWooB,KAtBlF,8BAwBE,WACE,IAAMW,EAAWl5B,EAAU2W,GAAaI,MAAM9W,OAC9CyP,KAAK4oB,WAAWW,YAAY3d,GAAYE,kBAAmB0d,KA1B/D,iCA6BE,WACE,GAAKviB,GAAaI,MAAM9E,kBAAxB,CACAvC,KAAK4oB,WAAWW,YAAY3d,GAAY5B,iBAAxC,gBAA8D/C,GAAaI,MAAM9E,oBAEjF,IADA,IAAIzD,EAAOmI,GAAaI,MAAMvF,YAAYhD,KAChB,MAApBA,EAAK3M,MAAM,EAAE,IAAa2M,EAAOA,EAAK3M,MAAM,MAjCtD,4BAmCE,WACE6N,KAAK4oB,WAAWW,YAAY3d,GAAYnB,YAAaxD,GAAaI,MAAMtF,cApC5E,yBAsCE,WACE/B,KAAK4oB,WAAWW,YAAY3d,GAAYG,qBAAsB9E,GAAaI,MAAMlF,QAAQxC,WAvC7F,6BAyCE,WACEK,KAAK4oB,WAAWW,YAAY3d,GAAY9B,wBAAxC,gBACM7C,GAAaI,MAAMmgB,gBA3C7B,8BA6CE,WACExnB,KAAK4oB,WAAWW,YAAY3d,GAAY7B,sBAAxC,gBACQ9C,GAAaI,MAAM3B,cA/C/B,4BAiDE,WACE1F,KAAK4oB,WAAWW,YAAY3d,GAAY/B,gBAAiB5C,GAAaI,MAAMlF,QAAQvC,oBAlDxF,6BAsDE,SAAgB+J,EAAW8f,GACzBzpB,KAAK4oB,WAAWW,YAAY3d,GAAYzB,wBAAyBsf,GAC/D,CAACxiB,GAAaI,MAAMZ,iBAAkBQ,GAAaI,MAAMX,kBAAoBiD,QAAUlJ,KAxD7F,wBA2DE,WACET,KAAK4oB,WAAWW,YAAY3d,GAAY3B,mBAAoBhD,GAAaI,MAAMogB,SAC/EznB,KAAK4oB,WAAWc,sBA7DpB,sCAgEE,SAAyBphB,EAAaqhB,GACpC,IAAMC,EAAqBvd,GAAesd,GAC1C3pB,KAAK4oB,WAAWW,YAAY3d,GAAYd,uBAAwB8e,EAAoBthB,KAlExF,sCAqEE,SAAyBA,EAAauhB,GACpC7pB,KAAK4oB,WAAWW,YAAY3d,GAAYV,uBAAwB2e,EAAYvhB,KAtEhF,4BAyEE,WACItI,KAAK8pB,yBAAyB,GAAIjN,MAAMnT,KAAKwZ,GAAS6G,aAAalf,aA1EzE,wBA8EE,SAAmBlY,EAAagkB,GAC9BqT,GAASC,aAAat3B,EAAKgkB,KA/E/B,sCAiFE,SAAiC8S,GAC/BxiB,GAAaI,MAAMZ,iBAAmBgjB,EAAO,GAC7CxiB,GAAaI,MAAMX,iBAAmB+iB,EAAO,KAnFjD,iCAqFE,SAA4B7iB,EAAqBsjB,GAC/C,GAAItjB,EAAG,CACL,IAAMQ,EAASH,GAAa6X,UAAUlY,GAClCQ,IAAQA,EAAOqgB,QAAUyC,MAxFnC,+BA2FE,SAA0BC,GAAe,IAAD,gBACtBA,GADsB,IACtC,IAAI,EAAJ,qBAAoB,CAAC,IAAXvjB,EAAU,QAClB+B,GAAKyhB,gBAAgBxjB,GACrBK,GAAaojB,MAAMzjB,IAHiB,iCA3F1C,2BAiGE,SAAsB0B,EAAuBQ,GAC3C5e,EAAOoe,GAEP,IAAMoB,EAAOzC,GAAaiC,KAAKZ,GAC3BoB,GACFf,GAAKc,WAAW,IAAIrB,GAAYU,EAAIA,IAAKY,EAAK9C,GAAI8C,EAAK5H,YAAYhD,KACjE4K,EAAK5H,YAAY9C,UAAW0K,EAAKN,WAAYN,EAAIwhB,GAAIxhB,EAAIa,GAAK,UAAU,WAvGhF,0BA0GE,SAAqBD,GACnBxf,EAAOwf,GACP,IAAM6gB,EAAStjB,GAAaiC,KAAKQ,GAC7B6gB,IACF5hB,GAAK6hB,SAASD,GACVtjB,GAAaI,MAAMvF,YAAY1C,YACjCqpB,GAAa/1B,GAAE,WAAY,CAACoM,KAAI,OAAEyrB,QAAF,IAAEA,OAAF,EAAEA,EAAQzoB,YAAYhD,OAAQ,CAAC2rB,KAAM,qBAhH7E,0BAoHE,SAAqB/gB,EAAuBghB,GAC1CxgC,EAAOwf,GACP,IAAMtC,EAASH,GAAaiC,KAAKQ,GAC7BtC,IAASA,EAAOjF,QAAQvC,iBAAmB8qB,KAvHnD,sBAyHE,SAAgBpiB,EAAsB2N,GAAe,IAAD,SAClD/rB,EAAOoe,GACPqiB,GAAUC,QAAQ,SAAlB,UAA4B3jB,GAAaG,OAAO3d,IAAI6e,UAApD,aAA4B,EAA8BxG,YAAYhD,KAAMmX,GAC5E,IAAMvlB,EAAM3G,OAAOkb,aAAaI,QAAQ,aACpCwlB,OAA2BpqB,EAC3BqqB,EAAuB,GACvB9qB,KAAK4oB,WAAWl/B,OACdgH,IAEFm6B,GADAC,EAAY3lB,KAAKI,MAAM7U,IACLwY,MAAK,SAAA6hB,GAAE,OAAIA,EAAGrhC,OAAS,EAAKk/B,WAAWl/B,SAEtDmhC,IACHA,EAAQ,CAACnhC,KAAKsW,KAAK4oB,WAAWl/B,KAAM4jB,KAAK,GACzCwd,EAAU/hB,KAAK8hB,IAEjBA,EAAMvd,KAAOjE,KAAKC,MAClBvf,OAAOkb,aAAaC,QAAQ,YAAaC,KAAKC,UAAU0lB,KAE1D1Q,YAAW,WACTrwB,OAAOC,SAASghC,WACf,OA7IP,8BA+IE,SAAyB/E,GACvBA,EAAKn4B,SAAQ,SAAAwa,GACX,IAAMP,EAAcd,GAAaiC,KAAKZ,GAClCP,IACFA,EAAY5F,QAAQzC,SAAU,QAnJtC,wBAuJE,SAAmBumB,GACjBA,EAAKn4B,SAAQ,SAAAwa,GACX,IAAMP,EAAcd,GAAaiC,KAAKZ,GAClCP,IACFA,EAAYxX,MAAM5B,SAAW,CAACue,GAA4BA,UA3JlE,0BA+JE,SAAqBgZ,GACnBA,EAAKp4B,SAAQ,SAAAyzB,GACX,IAAM/O,EAAU0Q,GAASha,KAAKqY,GAC9B,GAAI/O,EAAQ,CACV,IAAMyY,EAAa5sB,OAAO+D,OAAO,GAAIoQ,GACrCyY,EAAWn8B,KAAO,CAACH,SAAU,CAACue,GAA4BA,IACxD3e,YAAaikB,EAAQ1jB,KAAKP,aAC5B20B,GAASgI,sBAAsB,CAACD,UAtKxC,+BA4KE,SAA0BvhB,EAAuB7E,GAE/C,GADA3a,EAAOwf,GACuB,OAA1B3gB,EAAcoiC,SACdzhB,IAASzC,GAAaW,QAAQ,CAChC,IAAMR,EAASH,GAAae,kBAAkB0B,GAC9C,IAAKtC,EAAQ,OACb,IAAMtI,EAAOsI,EAAOtF,YAAYhD,KAChCT,OAAO+D,OAAOgF,EAAOtF,YAAa+C,GAC9B/F,IAASsI,EAAOtF,YAAYhD,OAC1BA,IAASU,GAAyBV,KACpC6J,GAAKyiB,kBAAkB1hB,GAEvBf,GAAK0iB,uBAAuB3hB,EAAM5K,IAGtCsI,EAAOP,qBAAsB,EAC7B6hB,GAAQ,WAAD,OAAYhf,EAAZ,kBA5Lb,qCA+LE,SAAgCA,EAAuB4hB,GAErD,GADAphC,EAAOwf,GACuB,OAA1B3gB,EAAcoiC,SAEdzhB,IAASzC,GAAaW,QAAQ,CAChC,IAAMR,EAASH,GAAa6X,UAAUpV,GACtC,IAAKtC,EAAQ,OACb/I,OAAO+D,OAAOgF,EAAOogB,YAAa8D,MAtMxC,+BAyME,SAA0B5hB,EAAuB4f,GAE/C,GADAp/B,EAAOwf,GACHA,IAASzC,GAAaW,QAAQ,CAChC,IAAMR,EAASH,GAAa6X,UAAUpV,GACtC,IAAKtC,EAAQ,OACb,IAAMtY,EAAO2B,EAAS64B,GAChBjiB,EAAQJ,GAAaI,MAI3B,GAHAD,EAAOtY,KAAKP,YAAcO,EAAKP,YAC/B6Y,EAAOtY,KAAKH,SAAWG,EAAKH,SAC5ByY,EAAOjF,QAAQzC,SAAU,EACrB2H,EAAMvF,YAAYxC,YAAc+H,EAAMvF,YAAYzC,YAAY,CAChE,IAAMksB,EAAW39B,EAAMN,EAAM8Z,EAAOtY,KAAKH,SAAU0Y,EAAMvY,KAAKH,WAG1DyY,EAAON,aADGlI,IACsB2sB,GADtB3sB,IAETyI,EAAMvF,YAAYzC,YACrBopB,GAAa/1B,GAAE,YAAY,CAACoM,KAAMsI,EAAOtF,YAAYhD,OAAQ,CAAC2rB,KAAM,kBAC5DrjB,EAAON,aALJlI,KAK2B2sB,EAL3B3sB,KAK8CyI,EAAMvF,YAAYxC,YAC3EmpB,GAAa/1B,GAAE,SAAU,CAACoM,KAAMsI,EAAOtF,YAAYhD,OAAQ,CAAC2rB,KAAM,kBAEpErjB,EAAON,aAAeykB,MA7N9B,qCAiOE,SAAgC7hB,EAAuB8hB,GACrD,GAAI9hB,GAAQA,IAASzC,GAAaW,QAAQ,CACxC,IAAMR,EAASH,GAAa6X,UAAUpV,GAClCtC,IAAQA,EAAOrF,WAAaypB,MApOtC,gCAuOE,SAA2B9hB,EAAuB8f,GAChDt/B,EAAOwf,GACP,IAAMnZ,EAAQO,EAAU04B,GACxB,GAA8B,OAA1BzgC,EAAcoiC,SACdzhB,IAASzC,GAAaW,QAAQ,CAChC,IAAMR,EAASH,GAAa6X,UAAUpV,GAClCtC,GAAQ/I,OAAO+D,OAAOgF,EAAO7W,MAAOA,MA7O9C,kCAgPE,SAA6BmZ,EAAuB/J,GAElD,GADAzV,EAAOwf,GACHA,IAASzC,GAAaW,QAAQ,CAChC,IAAMR,EAASH,GAAa6X,UAAUpV,GAClCtC,IAAQA,EAAOjF,QAAQxC,QAAUA,MApP3C,oCAuPE,SAA+B+J,EAAuBhE,GAEpD,GADAxb,EAAOwf,GACuB,OAA1B3gB,EAAcoiC,SAEdzhB,IAASzC,GAAaW,QAAQ,CAChC,IAAMR,EAASH,GAAa6X,UAAUpV,GAClCtC,GAAQ/I,OAAO+D,OAAOgF,EAAO1B,UAAWA,MA7PlD,yBAgQE,SAAoBgE,EAAuB+hB,GAIzC,GAHAvhC,EAAOwf,GAEQ+hB,EAAcviB,MAAK,SAAAtC,GAAE,OAAIA,IAAOK,GAAaW,YAE1D,IAAKX,GAAaykB,WAAWjI,IAAI/Z,KAC/BzC,GAAaykB,WAAW1I,IAAItZ,GACxBzC,GAAaI,MAAMvF,YAAYvC,YAAW,CAC5C,IAAM6H,EAASH,GAAaiC,KAAKQ,GAC7BtC,GACFqhB,GAAa/1B,GAAE,SAAU,CAACoM,KAAMsI,EAAOtF,YAAYhD,OAAQ,CAAC2rB,KAAM,wBAKxExjB,GAAaykB,WAAW3gC,OAAO2e,KA/QrC,yBAkRE,SAAoBiN,GAClB,IAAMpQ,EAAU,GAChBU,GAAaI,MAAMjE,6BAA6BmD,GAChDU,GAAaI,MAAMpF,UAAY0U,GAASpQ,EAAQV,OAAO5D,YArR3D,yBAuRE,SAAoB0U,GAClB,IAAMpQ,EAAU,GAChBU,GAAaI,MAAMjE,6BAA6BmD,GAChDU,GAAaI,MAAMrF,UAAY2U,GAASpQ,EAAQV,OAAO7D,YA1R3D,4BA4RE,WACEjY,OAAOC,SAASghC,WA7RpB,iCAgSE,SAA4BnL,GAC1B31B,EAAOsc,OAAOmlB,eACd9L,EAAG/xB,SAAQ,SAAA9B,GAAC,OAAIk3B,GAAS0I,iBAAiBpkB,IAAIxb,EAAE4a,GAAI5a,QAlSxD,oCAoSE,SAA+B6/B,GAE7B,IAAMhM,EAAKpT,GAAkBof,GAC7B3I,GAASgI,sBAAsBrL,KAvSnC,oCAySE,SAA+BqG,GAC7BhD,GAAS4I,sBAAsB5F,KA1SnC,0BA6SE,WAAe,IAAD,OACZlmB,KAAKuiB,UAAUxZ,KAAKzF,cAAQ,WAC1B2D,GAAaG,OAAOtZ,SAAQ,SAACsZ,GACvBA,EAAOL,SACTK,EAAOL,QAAS,EAChB,EAAK6hB,WAAWW,YAAY3d,GAAYtB,YAAa,GAAIlD,EAAOR,IAChE+B,GAAKojB,OAAO3kB,WAIlBpH,KAAKuiB,UAAUxZ,KAAKzF,aAAQtD,KAAKqpB,eAAe/a,KAAKtO,QACrDA,KAAKuiB,UAAUxZ,KAAKzF,aAAQtD,KAAKgsB,oBAAoB1d,KAAKtO,QAC1DA,KAAKuiB,UAAUxZ,KAAKzF,aAAQtD,KAAKisB,eAAe3d,KAAKtO,QACrDA,KAAKuiB,UAAUxZ,KAAKzF,aAAQtD,KAAKkpB,gBAAgB5a,KAAKtO,QACtDA,KAAKuiB,UAAUxZ,KAAKzF,aAAQtD,KAAK8oB,gBAAgBxa,KAAKtO,MAAM,KAC5DA,KAAKuiB,UAAUxZ,KAAKzF,aAAQtD,KAAK+oB,iBAAiBza,KAAKtO,QACvDA,KAAKuiB,UAAUxZ,KAAKzF,aAAQtD,KAAKmpB,iBAAiB7a,KAAKtO,QACvDA,KAAKuiB,UAAUxZ,KAAKzF,aAAQtD,KAAKipB,YAAY3a,KAAKtO,QAClDA,KAAKuiB,UAAUxZ,KAAKzF,aAAQtD,KAAKksB,WAAW5d,KAAKtO,QAQjDA,KAAKuiB,UAAUxZ,KAAKzF,cAAQ,WALtB2D,GAAaklB,mBACfllB,GAAaklB,kBAAmB,EAChC,EAAKvD,WAAWW,YAAY3d,GAAYxB,WAAYyS,MAAMnT,KAAKzC,GAAaykB,oBApUpF,wBAyUE,WACE1rB,KAAKuiB,UAAUz0B,SAAQ,SAAA5B,GAAC,OAAIA,SA1UhC,yBA+UE,SAAYkgC,GACV1D,GAAQ,kBAAD,OAAmB0D,EAAK1+B,KAAI,SAAAmtB,GAAC,OAAIA,EAAEnoB,KAAGrJ,QAAO,SAACyD,EAAGd,GAAJ,gBAAWc,EAAX,YAAgBd,KAAI,IAAjE,MADqB,oBAGXogC,GAHW,IAG5B,IAAI,EAAJ,qBAAsB,CAAC,IAAbtjB,EAAY,QAEpB,OADA2b,GAAS4H,cAAcvjB,GAChBA,EAAIpW,GACT,KAAKkZ,GAAYK,UAAWjM,KAAKssB,WAAL,MAAAtsB,KAAA,YAAoBmF,KAAKI,MAAMuD,EAAIrb,KAA0B,MACzF,KAAKme,GAAYM,WAAYlM,KAAKusB,gBAAe,GAAQ,MACzD,KAAK3gB,GAAY/B,gBAAiB7J,KAAKwsB,aAAa1jB,EAAIhc,EAAGqY,KAAKI,MAAMuD,EAAIrb,IAAK,MAC/E,KAAKme,GAAYI,iBAAkBhM,KAAKysB,kBAAkBtnB,KAAKI,MAAMuD,EAAIrb,IAAK,MAC9E,KAAKme,GAAYtB,YAAatK,KAAK0sB,aAAa5jB,EAAIhc,GAAI,MACxD,KAAK8e,GAAYvB,aAAcrK,KAAK2sB,cAAc7jB,EAAIhc,EAAGqY,KAAKI,MAAMuD,EAAIrb,IAAK,MAC7E,KAAKme,GAAYV,uBAAwBlL,KAAK2nB,uBAAuBxiB,KAAKI,MAAMuD,EAAIrb,IAAK,MACzF,KAAKme,GAAYd,uBAAwB9K,KAAK0nB,uBAAuBviB,KAAKI,MAAMuD,EAAIrb,IAAK,MACzF,KAAKme,GAAYb,oBAAqB/K,KAAK4sB,oBAAoBznB,KAAKI,MAAMuD,EAAIrb,IAAK,MACnF,KAAKme,GAAY5B,iBAAkBhK,KAAK6sB,kBAAkB/jB,EAAIhc,EAAGqY,KAAKI,MAAMuD,EAAIrb,IAAK,MACrF,KAAKme,GAAYE,kBAAmB9L,KAAK8sB,mBAAmBhkB,EAAIhc,EAAGqY,KAAKI,MAAMuD,EAAIrb,IAAK,MACvF,KAAKme,GAAYC,iBAAkB7L,KAAK+sB,kBAAkBjkB,EAAIhc,EAAGqY,KAAKI,MAAMuD,EAAIrb,IAAK,MACrF,KAAKme,GAAYG,qBAAsB/L,KAAKgtB,qBAAqBlkB,EAAIhc,EAAGqY,KAAKI,MAAMuD,EAAIrb,IAAK,MAC5F,KAAKme,GAAY9B,wBAAyB9J,KAAKitB,wBAAwBnkB,EAAIhc,EAAGqY,KAAKI,MAAMuD,EAAIrb,IAAK,MAClG,KAAKme,GAAY7B,sBAAuB/J,KAAKktB,uBAAuBpkB,EAAIhc,EAAGqY,KAAKI,MAAMuD,EAAIrb,IAAK,MAC/F,KAAKme,GAAYnB,YAAazK,KAAKmtB,wBAAwBrkB,EAAIhc,EAAGqY,KAAKI,MAAMuD,EAAIrb,IAAK,MACtF,KAAKme,GAAYzB,wBAAyBnK,KAAKotB,yBAAyBjoB,KAAKI,MAAMuD,EAAIrb,IAAK,MAC5F,KAAKme,GAAY3B,mBAAoBjK,KAAKqtB,oBAAoBvkB,EAAIhc,EAAGqY,KAAKI,MAAMuD,EAAIrb,IAAK,MACzF,KAAKme,GAAYxB,WAAYpK,KAAKstB,YAAYxkB,EAAIhc,EAAGqY,KAAKI,MAAMuD,EAAIrb,IAAK,MACzE,KAAKme,GAAYlB,eAAgB1K,KAAKutB,iBAAkB,MACxD,KAAK3hB,GAAYrB,WAAYvK,KAAKwtB,YAAYroB,KAAKI,MAAMuD,EAAIrb,IAAK,MAClE,KAAKme,GAAYpB,WAAYxK,KAAKytB,YAAYtoB,KAAKI,MAAMuD,EAAIrb,IAAK,MAClE,KAAKme,GAAYjB,KAAM3K,KAAK0tB,SAAS5kB,EAAIhc,EAAGqY,KAAKI,MAAMuD,EAAIrb,IAAK,MAChE,KAAKme,GAAYT,gBAAiBnL,KAAK2tB,iBAAiBxoB,KAAKI,MAAMuD,EAAIrb,IAAK,MAC5E,KAAKme,GAAYR,UAAWpL,KAAK4tB,WAAWzoB,KAAKI,MAAMuD,EAAIrb,IAAK,MAChE,KAAKme,GAAYP,YAAarL,KAAK6tB,aAAa1oB,KAAKI,MAAMuD,EAAIrb,IAAK,MACpE,QACEghB,QAAQC,IAAR,iCAAsC5F,EAAIpW,EAA1C,iBAAoDoW,EAAIhc,MAjClC,8BAqC5BkT,KAAK8tB,cApXT,uBAsXE,WACE,IACM3D,EADUtN,MAAMnT,KAAKzC,GAAaG,OAAOyD,UAC3BkS,QAAO,SAAA3V,GAAM,OAAKA,EAAOP,uBAAqBnZ,KAAI,SAAA0Z,GAAM,OAAIA,EAAOR,MACnFujB,EAAI34B,SACNk3B,GAAQ,kBAAD,OAAmByB,IAC1BnqB,KAAK4oB,WAAWmF,4BAA4BniB,GAAYM,WAAYie,QA3X1E,KCxBa6D,GAAb,iDACEC,aADF,OAEEC,cAFF,OAGEC,YAHF,OAIUC,UAAY,GAJtB,6CAKE,SAAUjtB,GAAiB,IAAD,MAExB,UAAAnB,KAAKmuB,cAAL,SAAaE,aACb,UAAAruB,KAAKkuB,gBAAL,SAAeG,aACf,UAAAruB,KAAKiuB,eAAL,SAAc1T,QACdva,KAAKmuB,YAAS1tB,EACdT,KAAKkuB,cAAWztB,EAChBT,KAAKiuB,aAAUxtB,EAEXU,IACFnB,KAAKiuB,QAAU,IAAIK,aACnBtuB,KAAKkuB,SAAWluB,KAAKiuB,QAAQM,iBAC7BvuB,KAAKmuB,OAASnuB,KAAKiuB,QAAQO,wBAAwB,IAAIxtB,YAAY,CAACG,EAAMA,SACtEnB,KAAKkuB,UAAYluB,KAAKmuB,SACxBnuB,KAAKmuB,OAAOM,QAAQzuB,KAAKkuB,UAGzBluB,KAAKkuB,SAASQ,QAAU1uB,KAAKouB,cAtBrC,2BA0BE,WAAgB,IAAD,EACb,IAAKpuB,KAAKiuB,QAAS,OAAO,EACC,cAAvBjuB,KAAKiuB,QAAQnM,OACf9hB,KAAKiuB,QAAQU,SAEf,IAAMtI,EAAS,IAAIuI,aAAa5uB,KAAKouB,WAIrC,OAHA,UAAApuB,KAAKkuB,gBAAL,SAAeW,uBAAuBxI,GACvBA,EAAOh9B,QAAO,SAAC2zB,EAAM4K,GAAP,OAAa5K,EAAKrxB,KAAKC,IAAIg8B,KAAM,GAAK5nB,KAAKouB,cAjC5E,KCYaU,GAAqC,SAACpkC,KAExCqkC,GAA6B,IAMlCC,GAAmC,IAAI7mB,IAAImD,IACjD0jB,GAAiChM,IAAIzX,GAA8BC,8BACnEwjB,GAAiChM,IAAIzX,GAA8BI,4BAG5D,I,SAAMsjB,GAAb,iDACEC,iBAAkCzuB,EADpC,KAEU8X,MAAM,GAFhB,KAIU4W,MAAM,GAJhB,KAMUC,gBAAkB/lB,KAAKC,MANjC,KAOU+lB,iBAAmBhmB,KAAKC,MAPlC,KAQUgmB,sBAAqC,GAR/C,KASUC,aAAe,GATzB,KAUUC,gBAAkB,GAV5B,KAYUC,MAAQ,IAAI9G,GAAS3oB,MAZ/B,KAcU0vB,YAAc,IAAI1B,GAd5B,KA4GU2B,UAAW,EA5GrB,KAqJEC,iBAAgC,GArJlC,sCAGE,WAAmB,OAAO5vB,KAAKuY,QAHjC,gBAKE,WAAmB,OAAOvY,KAAKmvB,QALjC,gBAaE,WAAoB,OAAOnvB,KAAKyvB,QAblC,sBAeE,WAAyB,OAAOzvB,KAAK0vB,cAfvC,yBAiBE,WAAqB,IAAD,EAClB,OAAO,UAAA1vB,KAAKkvB,mBAAL,eAAkBtb,cAAe+F,UAAUC,OAlBtD,yBAoBE,SAAmB9a,EAAa6X,GAE9B3W,KAAK+tB,4BAA4BniB,GAAYK,UAAW,CAACnN,EAAM6X,IAC/DqT,GAASC,aAAanrB,EAAM6X,KAvBhC,qBA0BE,SAAejtB,EAAcoe,GAAc,IAAD,OAyDxC,OAxDA9H,KAAKmvB,MAAQzlC,EACbsW,KAAKuY,MAAQzQ,EACbgnB,GAAQ,WAAD,OAAYplC,EAAZ,aAAqBoe,EAArB,MAES,IAAI5W,SAAc,SAACC,EAASC,GAC1C,GAAKoV,OAAOmlB,cACZ,GAAI,EAAKuD,YAAc/9B,QAAvB,CACA,IAAM0+B,EAAS,WACbf,GAAQ,0BACR,EAAKQ,sBAAwB,GAC7B,EAAKQ,KAAKvD,gBAAe,GACzB,EAAKwB,4BAA4BniB,GAAYH,YAAa,IAC1D,EAAKie,qBAEDqG,EAAY,SAAC/V,GAEjB,GAAuB,kBAAZA,EAAGC,KAAmB,CAC/B,EAAKoV,iBAAmBhmB,KAAKC,MAC7B,EAAKimB,aAAe,EAAKF,iBAAmB,EAAKD,gBAEjD,IAGgB,EAHVhD,EAAOjnB,KAAKI,MAAMyU,EAAGC,MAG3B,GAAImS,EAAK56B,QACP,IAAKo+B,kBAAiB7mB,KAAtB,oBAA8BqjB,IAG5BA,EAAK56B,SACP,EAAKg+B,gBAFO,GAEmB,EAAKD,aAAe,GAAY,EAAKC,mBAIpEQ,EAAU,WACd5V,YAAW,WACT,EAAK8U,YAAc,IAAIvV,UAAUnT,OAAOmlB,eACxCsE,MACC,MAECC,EAAU,WAAO,IAAD,EACpBzhB,QAAQI,MAAR,iCAAwCrI,OAAOmlB,gBAC/C,YAAKuD,mBAAL,SAAkB3U,MAAM,IAAM,WAC9ByV,KAEIC,EAAa,WAAO,IAAD,QACvB,YAAKf,mBAAL,SAAkB1U,iBAAiB,QAAS0V,GAC5C,YAAKhB,mBAAL,SAAkB1U,iBAAiB,UAAWuV,GAC9C,YAAKb,mBAAL,SAAkB1U,iBAAiB,OAAQqV,GAC3C,YAAKX,mBAAL,SAAkB1U,iBAAiB,QAASwV,IAE9C,EAAKd,YAAc,IAAIvV,UAAUnT,OAAOmlB,eACxCsE,IAEA,EAAKvJ,OACL,EAAKoJ,KAAKK,eACV,EAAKL,KAAKvD,gBAAe,QAjDGn7B,SAhClC,wBAqFE,WAAoB,IAAD,EACboV,OAAOmlB,eAAiB3rB,KAAK8H,OAC/B9H,KAAK8vB,KAAKM,aACVpwB,KAAK+tB,4BAA4BniB,GAAYI,iBAAkB,CAAChM,KAAK8H,OACrE9H,KAAK0pB,qBAGP1pB,KAAK2vB,UAAW,EAChB3vB,KAAKmvB,MAAQ,GACbnvB,KAAKuY,MAAQ,GACb,UAAAvY,KAAKkvB,mBAAL,SAAkB3U,QAClBva,KAAKkvB,iBAAczuB,IAhGvB,8BAmGE,WACMwG,GAAaI,MAAMmgB,YAAY9iB,SACjCuC,GAAaI,MAAMgpB,cAAc,GAEjCppB,GAAaI,MAAMgpB,cAAcrwB,KAAKswB,WAAWC,mBAvGvD,kBA6GE,WAAe,IAAD,SAEZ,IAAI,UAAAvwB,KAAKkvB,mBAAL,eAAkBtb,cAAe+F,UAAUC,KAAK,CAGlD,IAFA,IACM4W,EAAWnnB,KAAKC,MADAmnB,GAEhBpnB,KAAKC,MAAQknB,GAAYxwB,KAAK4vB,iBAAiBp+B,QAAO,CAC1D,IAAMsX,EAAM9I,KAAK4vB,iBAAiBjJ,QAC9B7d,GACF9I,KAAK8vB,KAAKY,YAAY,CAAC5nB,IAOzB,IAAM6nB,GAJR5B,GAAsBpjC,KAAKkzB,IAEzBlzB,KAAK+oB,IAAK1U,KAAKwvB,gBAAgB,GAAK,GAAK,GAAI,MAEM,IAC/ClmB,EAAMD,KAAKC,MACjB,GAAIA,EAAMknB,GAAYxwB,KAAKkvB,cAAgBlvB,KAAK4vB,iBAAiBp+B,QAC5D8X,EAAMtJ,KAAKovB,gBAAkBL,KAC5B/uB,KAAKqvB,kBAAoBrvB,KAAKovB,iBAC7B9lB,EAAMtJ,KAAKovB,gBAAkBuB,GAAsB,CACtD3wB,KAAKovB,gBAAkB9lB,EACvB,IAAMsnB,EAAOnM,GAAS9B,UAAY,EAAC,IAAaziB,IAAYA,KAAY,KACpExS,GAAImjC,cACR7wB,KAAK+tB,4BAA4BniB,GAAYF,cAAe,CAACklB,EAAM3pB,GAAa6pB,gBAChF9wB,KAAK+wB,mBACL/wB,KAAK0pB,qBAIN1pB,KAAK2vB,SAGR3vB,KAAK2vB,UAAW,EAFhBvV,YAAW,WAAK,EAAKsM,SA9BR,MA9GnB,yBAkJE,SAAYhe,EAAaiO,EAAWhN,EAAaqnB,GAC7ChxB,KAAK+tB,4BAA4BrlB,EAAMiO,EAAOhN,EAAIqnB,KAnJxD,yCAuJE,SAA4BtoB,EAAaiO,EAAWsa,EAAcD,GAEhE,GADA9mC,EAAOsc,OAAOmlB,eACT3rB,KAAKkvB,aAAelvB,KAAKkvB,YAAYtb,aAAe+F,UAAUC,KACnE,GAAK5Z,KAAKtW,MAASsW,KAAK8H,KAAxB,CAOA,IAAMgB,EAAgB,CAACpW,EAAEgW,EAAMjb,EAAE,IAC7BujC,IACFloB,EAAIzW,EAAI2N,KAAKtW,KACbof,EAAIhc,EAAIkT,KAAK8H,MAEXmpB,IACFnoB,EAAI5c,EAAI+kC,GAEV,IAAMC,EAAMlxB,KAAKsvB,sBAAsBrX,WAAU,SAAA4C,GAAC,OAChDA,EAAEnoB,IAAMoW,EAAIpW,GAAKmoB,EAAExoB,IAAMyW,EAAIzW,GAAKwoB,EAAE/tB,IAAMgc,EAAIhc,GAAK+tB,EAAE3uB,IAAM4c,EAAI5c,KACjE,GAAIglC,GAAO,EACT,GAAIlC,GAAiCvL,IAAI3a,EAAIpW,GAAG,CAC9C,IAD8C,EACxCy+B,EAAOhsB,KAAKI,MAAMvF,KAAKsvB,sBAAsB4B,GAAKzjC,GADV,cAE9BkpB,GAF8B,yBAEpCya,EAFoC,QAGxCD,EAAKlZ,WAAU,SAAA/qB,GAAC,OAAIA,IAAMkkC,KAAM,GAAID,EAAKpoB,KAAKqoB,IADpD,IAAI,EAAJ,qBAAmC,IAFW,8BAK9CpxB,KAAKsvB,sBAAsB4B,GAAKzjC,EAAI0X,KAAKC,UAAU+rB,QAC/C,GAAInmB,GAAwByY,IAAI3a,EAAIpW,GAAG,CAC3C,IAD2C,EACrCy+B,EAAOhsB,KAAKI,MAAMvF,KAAKsvB,sBAAsB4B,GAAKzjC,GADb,cAE3BkpB,GAF2B,yBAEjCya,EAFiC,QAGnCvG,EAAQsG,EAAKlZ,WAAU,SAAA/qB,GAAC,OAAIA,EAAE0Z,KAAOwqB,EAAGxqB,MAC1CikB,GAAS,EACXsG,EAAKtG,GAASuG,EAEdD,EAAKpoB,KAAKqoB,IALd,IAAI,EAAJ,qBAAwC,IAFG,8BAU3CpxB,KAAKsvB,sBAAsB4B,GAAKzjC,EAAI0X,KAAKC,UAAU+rB,QAGnDroB,EAAIrb,EAAI0X,KAAKC,UAAUuR,GACvB3W,KAAKsvB,sBAAsB4B,GAAOpoB,OAGpCA,EAAIrb,EAAI0X,KAAKC,UAAUuR,GACvB3W,KAAKsvB,sBAAsBvmB,KAAKD,GAI9B2b,GAAS9B,YACX7Z,EAAIhc,EAAIkT,KAAK8H,KACb2c,GAAS4H,cAAcvjB,SA/CvB2F,QAAQiL,KAAR,4CAAkD1Z,KAAKtW,KAAvD,eAAkEsW,KAAK8H,KAAvE,QA3JN,+BA6ME,WAA4B,IAAD,EAOpB,EAPoB,OACiB,IAAtC9H,KAAKsvB,sBAAsB99B,UAE3B,UAAAwO,KAAKkvB,mBAAL,eAAkBtb,cAAe+F,UAAUC,MAC7C5Z,KAAKkvB,YAAYlb,KAAK7O,KAAKC,UAAUpF,KAAKsvB,wBAE1CtvB,KAAKsvB,sBAAwB,IAG7B,UAAAtvB,KAAKkvB,mBAAL,SAAkB1U,iBAAiB,QAAQ,YACrB,SAAd6W,IAAmB,IAAD,EAGjB,GAFF,YAAKnC,mBAAL,eAAkBtb,cAAe+F,UAAUC,KAC5CQ,WAAWiX,EAAa,MAExB,YAAKnC,mBAAL,SAAkBlb,KAAK7O,KAAKC,UAAU,EAAKkqB,wBAC3C,EAAKA,sBAAwB,IAGjC+B,WA/NR,KCjBaC,GAA4B7iB,QAAQC,IACND,QAAQ8iB,MAEnD,SAASC,GAAkB1kC,GACzB,MAAe,WAAXA,EAAE+jB,KAA0B/jB,EAAEgb,KAAKA,KAChChb,EAAE+jB,KAGX,SAAS4gB,GAAwBxS,GAC/B,GAAsB,WAAlBA,EAASpO,KAAkB,CAC7B,IAAM9I,EAAcd,GAAa6X,UAAUG,EAASnX,KAAKA,MACzD,OAAOC,EAAc,CACnBnB,GAAIqY,EAASnX,KAAKA,KAClBmX,WACAtf,QAA4B,UAAlBsf,EAAShX,OAChBF,EAAY5F,QAAQxC,SAAWsH,GAAaykB,WAAWjI,IAAI1b,EAAYnB,KAAOmB,EAAY2pB,cAC7F5iC,KAAK,gBACAiZ,EAAYjZ,MAEjBW,KAAM,CAAC,EAAG,GACVqlB,OAAQ,EACR6c,SAAW,EACXrwB,MAAyB,UAAlB2d,EAAShX,KAAmBF,EAAY/F,UAAY+F,EAAY9F,gBACrExB,EACA,GAAqB,eAAlBwe,EAASpO,KAChB,MAAO,CACLjK,GAAIqY,EAASpO,KACboO,WACAtf,SAAU,EACV7Q,KAAM,CAACH,SAAS,CAAC,EAAG,GAAIJ,YAAa,GACrCkB,KAAM,CAAC,EAAG,GACVqlB,QAAQ,IACR6c,SAAW,EACXrwB,OAAO,GAGT,IAAMkR,EAAU0Q,GAASha,KAAK+V,EAASpO,MACvC,OAAO2B,EAAU,CACf5L,GAAGqY,EAASpO,KACZoO,WACAtf,SAAU,EACV7Q,KAAK,gBACA0jB,EAAQ1jB,MAEbW,KAAM+iB,EAAQ/iB,KACdqlB,OAAwB,UAAhBmK,EAAShX,MAAiB,IAAyB,EAC3D0pB,SAAW,EACXrwB,OAAO,QACLb,EAIR,SAASmxB,GAAuB7pB,GAC9B,MAAO,CACLnB,GAAImB,EAAYnB,GAChB9X,KAAK,gBACAiZ,EAAYjZ,MAEjB6Q,SAAS,GAQN,SAASkyB,GAAwBnnC,EAAuBC,GAC7D,MAAO,CACLmnC,OAAQpnC,EAAEonC,OAAO/U,QAAO,SAAAryB,GAAC,OAAKC,EAAEmnC,OAAO5oB,MAAK,SAAAve,GAAC,OAAID,EAAEkc,KAAOjc,EAAEic,SAC5DmrB,OAAQrnC,EAAEqnC,OAAOhV,QAAO,SAAAryB,GAAC,OAAKC,EAAEonC,OAAO7oB,MAAK,SAAAve,GAAC,OAAID,EAAEkc,KAAOjc,EAAEic,UAGzD,SAASorB,GAAgBC,GAC9B,MAAM,GAAN,mBAAWA,EAAGF,QAAd,YAAyBE,EAAGH,SAGvB,IAAMI,IAAb,GAiBGjyB,KAAWY,IAjBd,cAuBE,WAAYsxB,GAAkB,IAAD,gCArBrB9qB,WAqBqB,OAlBrB+qB,WAAY,EAkBS,KAjBZC,UAAY,IAAIlqB,IAiBJ,KAhBrBshB,OAAS,EAAE,GAAI,GAgBM,KAfrB6I,cAAe,EAeM,KAZZC,aAAe,CAAC,IAAI1nC,IAAiC,IAAIA,KAY7C,KAX7B2nC,kBAA8B,GAWD,KAV7BC,sBAAkC,GAUL,KAT7BC,WAAuB,GASM,iDAJrBnQ,UAAiC,GAIZ,KAHrBoQ,UAAW,EAGU,KADrB9P,gBACqB,OA2CrB+P,gBAAkB,IA3CG,KA4CrBC,WAAoB,EA5CC,KAuJrBC,gBAAkB,IAAIjoC,IArJ5BmV,KAAK6iB,WAAasP,EAClB,IAAIY,OAAqCtyB,EACzCT,KAAK6iB,WAAWmQ,cAAc9W,YAAY,WAAW,WACnD,EAAK+W,SACLF,EAAiBhpC,OAAOyyB,aACtB,WAAO,EAAK0W,WANY,QAU5BlzB,KAAK6iB,WAAWmQ,cAAc9W,YAAY,cAAc,WACtD,EAAKiX,eACkB1yB,IAAnBsyB,GACF3W,cAAc2W,MAGlBzvB,cAAQ,WACN,IAAM+D,EAAQJ,GAAaI,MAC3B,EAAK+rB,UAAU,CAAC/rB,EAAMZ,iBAAkBY,EAAMX,sBAGhD1G,KAAKqH,MAAQuqB,GAAuB3qB,GAAaI,OACjDtH,aAAeC,MA9CnB,yCAiDE,WACEA,KAAKmzB,UACLnzB,KAAKoyB,WAAY,EACjBpyB,KAAKqyB,UAAU3qB,QACf1H,KAAKuyB,aAAazkC,SAAQ,SAAA+sB,GAAC,OAAIA,EAAEnT,WACjC1H,KAAKqzB,gBAAkB,CAACvB,OAAO,GAAGC,OAAO,IACzC/xB,KAAKwyB,kBAAoB,GACzBxyB,KAAKyyB,sBAAwB,GAC7BzyB,KAAK0yB,WAAa,KAzDtB,uBA4DE,SAAiBjJ,GACfzpB,KAAKypB,OAAO,GAAKA,EAAO,GACxBzpB,KAAKypB,OAAO,GAAKA,EAAO,GACxBzpB,KAAKsyB,cAAe,IA/DxB,oBAqEE,WAAiB,IAAD,OAERgB,EAAsBhwB,cAAQ,WAClC,IAAM+D,EAAQJ,GAAaI,MAC3B,EAAKA,MAAQuqB,GAAuBvqB,GACpC,EAAK+qB,WAAY,KAEnBpyB,KAAKuiB,UAAY,CAAC+Q,GAClBtzB,KAAK6yB,WAAa9oC,OAAOyyB,aAAY,WAAK,EAAK0W,WAAWlzB,KAAK4yB,iBAC/D5yB,KAAKoyB,WAAY,EACjBpyB,KAAK2yB,UAAW,IA/EpB,qBAmFE,WACE5oC,OAAOqyB,cAAcpc,KAAK6yB,YAC1B7yB,KAAK6yB,WAAa,EAClB7yB,KAAKuiB,UAAUz0B,SAAQ,SAAAylC,GAAQ,OAAIA,OAEnCvzB,KAAK2yB,UAAW,IAxFpB,oBA4FE,WACO3yB,KAAKwzB,cAEVxzB,KAAKyzB,eAELzzB,KAAKoyB,WAAY,EACjBpyB,KAAKqyB,UAAU3qB,QACf1H,KAAKsyB,cAAe,KAnGxB,0BAsGE,WAAwB,IAAD,OAEfoB,EAA2C,GACjD1zB,KAAK6iB,WAAW8Q,YAAY7lC,SAAQ,SAAAga,GAAS,IAAD,gBACpBA,EAAK8rB,WADe,IAC1C,IAAI,EAAJ,qBAAqC,CAAC,IAA5B3U,EAA2B,QAC7BrY,EAAK4qB,GAAkBvS,GAC7B,GAAI,EAAKmT,WAAa,EAAKC,UAAU5O,IAAI7c,GACvC,GAAsB,eAAlBqY,EAASpO,KAEX6iB,EAAuB3qB,KAAKkW,OACzB,CACH,IAAM4U,EAAUpC,GAAwBxS,GACpC4U,IACFA,EAAQlC,SAAW,EAAKmC,kBAAkB,EAAKzsB,MAAOwsB,GACtD,EAAKtB,aAA+B,UAAlBtT,EAAShX,KAAmB,EAAI,GAAGT,IAAIZ,EAAIitB,MAX3B,kCAwB5C,IALA,IAAME,EAA4B/zB,KAAKuyB,aAAa7kC,KAAI,SAAAsmC,GAAW,OACjEnX,MAAMnT,KAAKsqB,EAAYnpB,UAAU9a,MAAK,SAACrF,EAAGC,GAAJ,OAAUD,EAAEinC,SAAWhnC,EAAEgnC,eAIjE,MAAsB+B,EAAtB,eAA6C,CAAzC,IAAMzU,EAAQ,KACVpa,EAAO4sB,GAAwBxS,GACjCpa,IACFkvB,EAA4C,UAAlB9U,EAAShX,KAAmB,EAAI,GAAGmb,QAAQve,GACrE7E,KAAK6iB,WAAWoR,uBAAuB,eAK3C,IAAMnC,EAASiC,EAA0B,GAAGhX,QAAO,SAAAlY,GAAI,OAAKA,EAAKvD,SAC7DwwB,EAAOtgC,OAASwO,KAAKypB,OAAO,KAAIqI,EAAOtgC,OAASwO,KAAKypB,OAAO,IAChE,IAAMsI,EAASgC,EAA0B,GAAGhX,QAAO,SAAAlY,GAAI,OAAKA,EAAKvD,SAC7DwwB,EAAOtgC,OAASwO,KAAKypB,OAAO,KAAIqI,EAAOtgC,OAASwO,KAAKypB,OAAO,IAGhEzpB,KAAKqzB,gBAAkB,CAACvB,SAAQC,YAhJpC,+BAyJE,SAA0B1qB,EAAwBD,GAChD,GAAIA,EAAOzH,QAAW,OAAO,EAC7B,IAAMke,EAAQzW,EAAO3X,KAAK/B,KAAI,SAACwmC,EAAIhD,GACjC,IAAItmC,EAAcwc,EAAOtY,KAAKH,SAASuiC,GAAO7pB,EAAMvY,KAAKH,SAASuiC,GAMlE,OALItmC,EAAO,IACTA,GAAQspC,GACG,IAAKtpC,EAAO,GAGlBA,KAIT,OAFiBe,KAAKG,KAAK+xB,EAAM,GAAKA,EAAM,GAAKA,EAAM,GAAKA,EAAM,IAAMzW,EAAO0N,SApKnF,uBAyKE,WACE,OAAO9U,KAAKoyB,WAAqC,IAAxBpyB,KAAKqyB,UAAU5iC,MAAcuQ,KAAKsyB,eA1K/D,8BA+KE,SAAwBrT,GACtB,IAAMkV,EAASlV,EAASnX,KAAK8rB,UAAU7W,QAAO,SAAAjwB,GAAC,OAAIA,EAAE+jB,OAASoO,EAASpO,QACjEjK,EAAK4qB,GAAkBvS,GACvBmV,EAA0B,UAAlBnV,EAAShX,KAAmB,EAAI,EAC9CjI,KAAKuyB,aAAa6B,GAAOrpC,OAAO6b,GAEV,IAAlButB,EAAO3iC,OACE,eAAPoV,GACF5G,KAAKq0B,eAAeztB,GAGtB5G,KAAKqyB,UAAUrP,IAAIpc,KA1LzB,4BA6LE,SAAuBA,GACrB,IAAM2sB,EAAWvzB,KAAK8yB,gBAAgBrpC,IAAImd,GAC1C,QAAiBnG,IAAb8yB,EACF,MAAM,IAAInpC,MAAJ,0DAA6Dwc,IAErE2sB,IACAvzB,KAAK8yB,gBAAgB/nC,OAAO6b,GAC5B5G,KAAKqyB,UAAUrP,IAAIpc,GACnB0qB,GAAY,kBAAmB1qB,EAAI5G,KAAKuyB,aAAa,MArMzD,2BAuME,SAAqBtT,GAA0B,IAAD,OACtCrY,EAAK4qB,GAAkBvS,GACzBjf,KAAK8yB,gBAAgBrP,IAAI7c,GAC3B5G,KAAKqyB,UAAUrP,IAAIpc,GAEG,WAAlBqY,EAASpO,KACX7Q,KAAK8yB,gBAAgBtrB,IAAIZ,EAAItD,cAAQ,WACnC,IAAMgxB,EAAKrtB,GAAaG,OAAO3d,IAAImd,GACnC,GAAI0tB,EAAG,CAEaA,EAAGnyB,QAAQxC,SAAWsH,GAAaykB,WAAWjI,IAAI6Q,EAAG1tB,IAEzD0tB,EAAGxlC,KAAKH,SACtB,EAAK0jC,UAAUrP,IAAIpc,QAGG,eAAlBqY,EAASpO,KACjB7Q,KAAKqyB,UAAUrP,IAAIpc,GAEnB5G,KAAK8yB,gBAAgBtrB,IAAIZ,EAAItD,cAAQ,WACnC,IAAMtX,EAAIk3B,GAAS6G,aAAatgC,IAAImd,GACpC,Gd3KH,SAAsB5a,GAC3B,OAAOA,IAAiB,WAAXA,EAAE0c,MAAgC,WAAX1c,EAAE0c,Mc0K1B6rB,CAAavoC,GAEDA,EAAG8C,KAAKH,SAExB,EAAK0jC,UAAUrP,IAAIpc,WAhO7B,gIAiBwD,CAACkrB,OAAO,GAAIC,OAAO,OAjB3E,IClEO,SAASyC,GAAY9pC,EAAoBC,GAC9C,OAAOD,EAAEud,OAAStd,EAAEsd,MAAQvd,EAAEmmB,OAASlmB,EAAEkmB,KCPpC,IAcDme,GAAmC,IAAI7mB,IAAImD,IAa1C,SAASmpB,GAAsBpiC,GAAgB,IAAD,EACnD,cAAOA,QAAP,IAAOA,GAAP,UAAOA,EAAGkpB,iBAAV,aAAO,EAAcM,QAAQC,KAb/BkT,GAAiChM,IAAIzX,GAA8BC,8BACnEwjB,GAAiChM,IAAIzX,GAA8BI,4BA2B5D,I,qEA8aMkX,GAAa,IA9a1B,WAgBE,aAAc,IAAD,gCAfLsM,MAAM,GAeD,KAXLuF,eAAiB,IAAIpc,GAWhB,KATLqc,aAAe,IAAI9pC,IASd,KAPL+pC,eAA6C,GAOxC,KANLC,oBAMK,OALNC,wBAKM,OAHLC,gBAAkB,IAAI9F,GAGjB,KAuQL+F,mBAvQK,OAwQLC,sBAxQK,EACXj1B,KAAKgzB,cAAc9W,YAAY,eAAgBlc,KAAKuZ,eAAejL,KAAKtO,OACxEA,KAAKgzB,cAAc9W,YAAY,aAAclc,KAAKwZ,aAAalL,KAAKtO,OACpEA,KAAK80B,mBAAqB,IAAI5C,GAAmBlyB,MACjD,IAAIk1B,EAAiC,CAACpD,OAAO,GAAIC,OAAO,IACxDzuB,cAAQ,WACN,IADU,EACJ6xB,EAAQnD,GAAgBH,GAAwB,EAAKiD,mBAAmBzB,gBAAiB6B,IACzFE,EAAUpD,GAAgBH,GAAwBqD,EAAW,EAAKJ,mBAAmBzB,kBAFjF,cAGQ8B,GAHR,IAGV,IAAI,EAAJ,qBAAwB,CAAC,IAAftwB,EAAc,QAAMA,EAAKoa,SAASE,UAAU,EAAKkW,YAAYxwB,EAAKoa,WAHlE,kDAIQmW,GAJR,IAIV,IAAI,EAAJ,qBAA0B,CAAC,IAAjBvwB,EAAgB,QAAE,EAAKywB,eAAezwB,EAAKoa,WAJ3C,8BAKViW,EAAY,EAAKJ,mBAAmBzB,mBA1B1C,sCAEE,WAAmB,OAAOrzB,KAAKmvB,QAFjC,yBAME,WAA4B,OAAOnvB,KAAK00B,iBAN1C,uBAQE,WAAyB,OAAO10B,KAAK20B,eARvC,0BAcE,WAA6B,OAAO30B,KAAK+0B,kBAd3C,6BA6BE,WACE,OAAO/0B,KAAKu1B,eAAeC,gBA9B/B,4BAgCE,WACE,OAAOx1B,KAAKgzB,cAAcwC,gBAjC9B,mBAoCE,SAAa9rC,GAAc,IAAD,OAClB0rB,EAAU,IAAIlkB,SAAc,SAACC,EAASC,GAE1C,IAAMV,EAAM3G,OAAOkb,aAAaI,QAAQ,aACxC,GAAI3U,EAAI,CACN,IACMm6B,EADY1lB,KAAKI,MAAM7U,GACLwY,MAAK,SAAA6hB,GAAE,OAAIA,EAAGrhC,OAAS,EAAKA,QACpD,GAAImhC,EAAM,CAGR,GAFaxhB,KAAKC,MAAQuhB,EAAMvd,KAErBmoB,IAGT,OAFA1rC,OAAOC,SAASghC,cAChB55B,EAAO,WAOb,IAAM0W,EAAOb,GAAaI,MAAMvF,YAAYhD,KAAK6O,UAAU,EAAG,GAC9D,EAAKqlB,cAAcvE,QAAQ/kC,EAAMoe,GAAMxD,MAAK,SAACwD,GAK3C,IAAK,IAAMve,KAFX0d,GAAaU,WAAWG,GAELb,GAAaI,MAAM/E,sBACc7B,IAA9CwG,GAAaI,MAAM/E,iBAAiB/Y,KACtC0d,GAAaI,MAAM/E,iBAAiB/Y,GAAQ,IAIhD,EAAKgsC,eAAe9G,QAAQ/kC,EAAMoe,GAAMxD,MAAK,WAC3C,EAAKixB,eAAezF,KAAKvD,gBAAe,GACxCp7B,OACCoT,MAAMnT,MACRmT,MAAMnT,MAMX,OAFAlF,EAAE22B,WAAa7iB,KAERoV,IA7EX,mBAgFE,WACEpV,KAAKu1B,eAAelH,aACpBruB,KAAKgzB,cAAc3E,aACnBruB,KAAKmvB,MAAQ,KAnFjB,6BAuFE,SAAwB9T,EAA2BjU,GAAqB,IAAD,OAkDrE,MAjDY,YAARiU,GAAsBjU,GACxBqH,QAAQI,MAAR,sEAEc,IAAI3d,SAAmC,SAACC,EAASC,GAC/D,EAAK4hC,cAAc0C,gBAAgBra,EAAnC,OAAwCjU,QAAxC,IAAwCA,OAAxC,EAAwCA,EAAQU,MAAMxD,MAAK,SAAAiX,GACzDA,EAAUoa,GAAG,WAAW,WAAqBC,EAAUC,GAAa,IAAzC7W,EAAwC,EAAxCA,eAEzB,EAAKgU,cAAc8C,iBAAiBva,EAAWyD,EAA/C,OAA+D5X,QAA/D,IAA+DA,OAA/D,EAA+DA,EAAQU,MAAMxD,MAAK,WAChFsxB,OACCrxB,OAAM,SAACsK,GACRJ,QAAQI,MAAR,wCAA+CA,IAE/Czd,UAGQ,SAARiqB,GACFE,EAAUoa,GAAG,WAAW,WAAmCC,EAAUC,GAAa,IAAvD5tB,EAAsD,EAAtDA,KAAMoX,EAAgD,EAAhDA,cAAexD,EAAiC,EAAjCA,QAExC1a,EAAS0a,EAAyB1a,MACxC,EAAK6xB,cAAc+C,iBAAiB,CAClCxa,UAAUA,EAAU3U,GAAIqB,OAAM4I,KAAK1P,EAAM0P,KAAMwO,gBAAe2W,QAAO,EAAOna,YAC3EvX,MAAK,SAACsC,GACPgvB,EAAS,CAAChvB,UACTrC,OAAM,SAACsK,GACRJ,QAAQI,MAAM,wCAAyCA,GACvDgnB,EAAQhnB,GACRzd,UAINmqB,EAAUoa,GAAG,yBAAyB,SAAC7T,GAErC,GAAU,YAANzG,GAA6B,cAAVyG,EAAsB,CAC3C53B,EAAOkd,GACP,IAF2C,EAErC6uB,EAAYpZ,MAAMnT,KAAKtC,EAAOwsB,UAAU/oB,UAAUnd,KAAI,SAAAZ,GAAC,OAAIA,EAAEqyB,YAAUpC,QAAO,SAAA/wB,GAAC,OAAIA,KAF9C,cAGrBiqC,GAHqB,IAG3C,IAAI,EAAJ,qBAAgC,CAAC,IAAvB9W,EAAsB,QAC9B,EAAK6T,cAAckD,eAAe/W,EAAUvY,GAAIQ,EAAOU,MAEvDqX,EAAUwP,UAN+B,mCAc/Cx9B,EAAQoqB,MACPhX,MAAMnT,QAvIf,8BA4IE,WAA2B,IAAD,OAWxB,OAVgB,IAAIF,SAAmC,SAACC,EAASC,GAC3D,EAAK+kC,cACPhlC,EAAQ,EAAKglC,eAEb,EAAKT,gBAAgB,QAAQpxB,MAAK,SAAAiX,GAChC,EAAKsZ,eAAiBtZ,EACtBpqB,EAAQoqB,MACPhX,MAAMnT,QApJjB,iCAyJE,SAA4B0W,GAAkB,IAAD,OAW3C,OAVgB,IAAI5W,SAAmC,SAACC,EAASC,GAC3D0W,EAAKyT,UACPpqB,EAAQ2W,EAAKyT,WAEb,EAAKma,gBAAgB,UAAW5tB,GAAMxD,MAAK,SAAAiX,GACzCzT,EAAKyT,UAAYA,EACjBpqB,EAAQoqB,MACPhX,MAAMnT,QAjKjB,yBAsKE,WACE,OAAO4O,KAAK60B,iBAvKhB,6BAyKE,WAA+B,IAAD,EAC5B,iBAAO70B,KAAK60B,sBAAZ,aAAO,EAAqBhZ,QAAQC,OA1KxC,oCA6KE,SAA8B3a,EAAei1B,GAAoB,IAAD,OAyC9D,OAxCgB,IAAIllC,SAAkC,SAACC,EAASC,GAE3C,WAAf+P,EAAM0P,KACiB,UAArB1P,EAAMA,MAAM8G,KACdhB,GAAaI,MAAMa,OAAOpH,MAAQK,EAAMA,MAExC8F,GAAaI,MAAMa,OAAOhH,OAASC,EAAMA,OAG3C+hB,GAASjiB,SAASE,EAAM2G,KAAM3G,EAAM0P,KAAM1P,EAAMA,OACvB,UAArBA,EAAMA,MAAM8G,MACd9G,EAAMA,MAAMqZ,iBAAiB,SAAS,WACpC0I,GAASmT,cAAcl1B,EAAM0P,UAKnC,IAAMoO,EAAW,EAAK2V,eAAe1rB,MAAK,SAAApc,GACxC,IAAMyc,EAAOzc,EAAE+uB,QAAyB1a,MACxC,OAAOoI,EAAIsH,OAAS1P,EAAM0P,MAAQtH,EAAIpI,MAAM8G,OAAS9G,EAAMA,MAAM8G,QAE/DgX,EACFA,EAASqX,aAAan1B,GAAOmD,MAAK,WAC/B2a,EAASpD,QAAyB1a,MAAQA,EAC3ChQ,EAAQ8tB,MACP1a,MAAMnT,GAET,EAAKmlC,mBAAmBjyB,MAAK,SAACiX,GAE5BA,EAAUib,QAAQ,CAChBr1B,MAAMA,EAAMA,MACZs1B,UAAUL,EAAa,CAAC,CAACM,WAAWN,SAAe31B,EACnDob,QAAQ,CAAC1a,WACRmD,MAAM,SAAA2a,GACP,EAAK2V,eAAe7rB,KAAKkW,GACzB9tB,EAAQ8tB,cAjNpB,8BAwNE,SAAwB9d,GACtBjX,EAAOiX,EAAM2G,OAAS9H,KAAKgzB,cAAclrB,MACzC9H,KAAKi0B,uBAAuB9yB,EAAM0P,KAAM1P,EAAMA,MAAM8G,QA1NxD,oCA4NE,SAA8B4I,EAAY5I,GAAiC,IAAD,OAC3D,WAAT4I,GACW,UAAT5I,GAAqBA,IAAMhB,GAAaI,MAAMa,OAAOpH,WAAQL,GACpD,UAATwH,GAAqBA,IAAMhB,GAAaI,MAAMa,OAAOhH,YAAST,IAElEyiB,GAASyT,YAAY32B,KAAKgzB,cAAclrB,KAAM+I,EAAM5I,GAEtDjI,KAAK40B,eAAe9mC,SAAQ,SAACmxB,GAC3B,IAAM9d,EAAS8d,EAASpD,QAAyB1a,MAC7CA,EAAM0P,OAASA,GAAU5I,GAAQA,IAAS9G,EAAMA,MAAM8G,OACxDgX,EAAS1E,QACT,EAAKyY,cAAc4D,cAAc3X,EAASrY,IAC1C,EAAKguB,eAAiB,EAAKA,eAAe7X,QAAO,SAAAjwB,GAAC,OAAIA,IAAMmyB,WAxOpE,wBA4OE,SAAkBnX,EAAa+I,EAAc5I,GAAkC,IAAD,OAgB5E,OAfgB,IAAI/W,SAAc,SAACC,EAASC,GAC1C,IAAMgW,EAAS,EAAKusB,YAAYlqC,IAAIqe,GACpC,GAAKV,EAAL,CACA,IAAIyvB,EAAU,EACdzvB,EAAOwsB,UAAU9lC,SAAQ,SAAAhB,GACnBA,EAAE+jB,OAASA,GAAU5I,GAAQnb,EAAEmb,OAASA,IAC1C4uB,IACA,EAAKC,YAAYhqC,GAAGwX,MAAK,SAAC6a,GACxBA,EAAS5E,QAEO,MADhBsc,GACmB1lC,gBARXC,SA/OpB,yBA+PE,SAAoB6tB,GAA0B,IAAD,OAoB3C,OAnBgB,IAAI/tB,SAAkC,SAACC,EAASC,GAC1D6tB,EAASE,SACXhuB,EAAQ8tB,EAASE,UAEjB,EAAK4X,oBAAoB9X,EAASnX,MAAMxD,MAAK,SAAAiX,GAC3C,EAAKyX,cAAcgE,iBAAiBzb,EAAU3U,GAAIqY,GAAU3a,MAAK,SAAA2yB,GAC/D1b,EAAU2b,QAAQD,GAAe3yB,MAAK,SAAA6a,GACpCF,EAASE,SAAWA,EACc,cAA9B5D,EAAU4b,iBACZ,EAAKnE,cAAckD,eAAe/W,EAASvY,GAAIqY,EAASnX,KAAKA,MAAMxD,MAAK,eAI1EnT,EAAQguB,MACP5a,MAAMnT,MACRmT,MAAMnT,MACRmT,MAAMnT,QAhRjB,8BAyRE,SAAwB+P,GAAiB,IAAD,OAgBtC,OAfgB,IAAIjQ,SAAc,SAACC,EAASC,GACtC+P,IAAU,EAAK6zB,eAEf,EAAKA,eACP,EAAKoC,iBAAiB,EAAKpC,eAG7B,EAAKA,cAAgB7zB,EACrB,EAAKo0B,eAAejF,WAAW+G,UAAU,EAAKrC,eAC1C7zB,EACF,EAAKm2B,uBAAuBn2B,EAAO,OAASmD,MAAK,WAAKnT,OAAYoT,MAAMnT,GAExED,KAXiCA,SA3RzC,mCA6SE,SAA8BgQ,GAAiB,IAAD,OAS5C,OARgB,IAAIjQ,SAAuC,SAACC,EAASC,GACnE,EAAK6jC,iBAAmB9zB,EACpB,EAAK8zB,iBACP,EAAKqC,uBAAuB,EAAKrC,iBAAkB,QAAU3wB,KAAKnT,GAASoT,MAAMnT,GAEjFD,SAnTR,iCAwTE,SAA2BgQ,GAA2B,IAAD,OAsBnD,OArBgB,IAAIjQ,SAAsB,SAACC,EAASC,GAC9C+P,EACEA,IAAU,EAAK8zB,iBACjB9jC,KAGI,EAAK8jC,kBACP,EAAKmC,iBAAiB,EAAKnC,kBAE7B,EAAKsC,sBAAsBp2B,GAAOmD,MAAK,WAAKnT,QAG1C,EAAK8jC,kBACP,EAAKmC,iBAAiB,EAAKnC,kBAC3B,EAAKsC,sBAAsBp2B,GAAOmD,MAAK,WAAKnT,QAE5CA,SAzUV,8BAgVE,WACE,OAAO6O,KAAKg1B,gBAjVhB,iCAmVE,WACE,OAAOh1B,KAAKi1B,mBApVhB,4BAwVE,SAAuBva,GAAuB,IAAD,SACrC8c,EAAY9c,EAAI,GADqB,cAEzB8c,GAFyB,yBAEhCC,EAFgC,QAGzC,GAAIA,EAAI3vB,OAAS,EAAKkrB,cAAclrB,KAAM,iBAC1C,IAAMV,EAAS,EAAKusB,YAAYlqC,IAAIguC,EAAI3vB,MACxC,GAAIV,EAAO,CACT,IADS,EACHswB,EAA4B,GAC5BC,EAAWvwB,EAAOwsB,UAAU7W,QAAO,SAAAjwB,GAAC,OAAK2qC,EAAI7D,UAAU1qB,MAAK,SAAA2R,GAAC,OAAI2Z,GAAY1nC,EAAG+tB,SAF7E,cAGS4c,EAAI7D,WAHb,yBAGCgE,EAHD,QAIDC,EAAUzwB,EAAOwsB,UAAU1qB,MAAK,SAAApc,GAAC,OAAI0nC,GAAY1nC,EAAG8qC,MACtDC,EAEEA,EAAQjxB,KAAOgxB,EAAKhxB,KACtB8wB,EAAO3uB,KAAK6uB,GACZD,EAAS5uB,KAAK8uB,IAGhBH,EAAO3uB,KAAK6uB,IAThB,IAAI,EAAJ,qBAAiC,IAHxB,8BAeT,IAAME,EAAiBJ,EAAOhqC,KAAI,SAAAynC,GAAK,oCAASA,GAAT,IAAgBrtB,KAAKV,OACxDuwB,EAASnmC,QAAQ,EAAKumC,kBAAkBJ,EAAUvwB,GAClD0wB,EAAetmC,QAAQ,EAAKwmC,gBAAgBF,EAAgB1wB,OAC7D,CACH,IAAM6wB,EAAuB,CAC3BnwB,KAAM2vB,EAAI3vB,KACV8rB,UAAU,IAENA,EAAY6D,EAAI7D,UAAUlmC,KAAI,SAAAwqC,GAAG,oCAASA,GAAT,IAAcpwB,KAAKmwB,OAC1D,EAAKtE,YAAYnsB,IAAIiwB,EAAI3vB,KAAMmwB,GAC/B,EAAKD,gBAAgBpE,EAAWqE,KA5BpC,2BAA4B,IAFe,iCAxV/C,0BA0XE,SAAqBtY,GACnB,IADoC,EAC9BwY,EAAYxY,EAAK,GADa,cAEpBwY,GAFoB,IAEpC,IAAI,EAAJ,qBAA0B,CAAC,IAAjBvxB,EAAgB,QACxB,GAAIA,IAAO5G,KAAKgzB,cAAclrB,KAAK,CACjC,IAAMV,EAASpH,KAAK2zB,YAAYlqC,IAAImd,GAChCQ,GACFpH,KAAK+3B,kBAAkB3wB,EAAOwsB,UAAWxsB,GAE3CpH,KAAK2zB,YAAY5oC,OAAO6b,GACxBK,GAAaojB,MAAMzjB,KATa,iCA1XxC,6BAuYE,SAAwBgtB,EAA6BxsB,GAAoB,IAAD,EAChEgxB,EAAE,YAAOxE,IACf,EAAAxsB,EAAOwsB,WAAU7qB,KAAjB,oBAAyBqvB,IAF6C,oBAGhDA,GAHgD,IAGtE,IAAI,EAAJ,qBAAyB,CAAC,IAAhBnZ,EAAe,QACvBjf,KAAK80B,mBAAmBuD,cAAcpZ,IAJ8B,iCAvY1E,+BA8YE,SAA0B2U,EAA6BxsB,GACrD,IAAMkxB,EAAO,YAAO1E,GACpBxsB,EAAOwsB,UAAYxsB,EAAOwsB,UAAU7W,QAAO,SAAAjwB,GAAC,OAAIwrC,EAAQpvB,MAAK,SAAA7W,GAAC,OAAKmiC,GAAY1nC,EAAGuF,SAFV,oBAGlDuhC,GAHkD,IAGxE,IAAI,EAAJ,qBAAgC,CAAC,IAAvB3U,EAAsB,QAC9Bjf,KAAKs1B,eAAerW,GACpBjf,KAAK80B,mBAAmByD,iBAAiBtZ,IAL6B,iCA9Y5E,yBAsZE,SAAoBA,GAClBjf,KAAK82B,YAAY7X,GAAU3a,MAAK,SAAC6a,GACT,WAAlBF,EAASpO,KACX5J,GAAauxB,eAAevZ,EAASnX,KAAKA,KAAMqX,EAAShe,OAEzD+hB,GAASjiB,SAASge,EAASnX,KAAKA,KAAMmX,EAASpO,KAAMsO,EAAShe,UAE/DoD,OAAM,SAACrX,GACRuhB,QAAQI,MAAR,wCAA+C3hB,SA9ZrD,4BAiaE,SAAuB+xB,GACjBA,EAASE,WACXF,EAASE,SAAS5E,QAClB0E,EAASE,cAAW1e,EACE,WAAlBwe,EAASpO,KACX5J,GAAawxB,kBAAkBxZ,EAASnX,KAAKA,KAAMmX,EAAShX,MAE5Dib,GAASyT,YAAY1X,EAASnX,KAAKA,KAAMmX,EAASpO,KAAMoO,EAAShX,WAxazE,MC1CakM,GAAwC,SAACzpB,KAGzCguC,GAAe,GAE5B,SAASC,GAAWjuC,EAAkBC,GACpC,OAAOD,EAAEuiB,OAAStiB,EAAEsiB,OAQf,IA6UDiW,GAAW,IA7UjB,GA6CGjjB,KAAW0B,QA7Cd,GA+CG1B,KAAW0B,QA/Cd,GAgDG1B,KAAW0B,QAhDd,GAkDG1B,KAAW0B,QAlDd,GAoDG1B,KAAW0B,QApDd,GAsDG1B,KAAW0B,QAtDd,GAyDG1B,KAAWY,IAzDd,GA2DGZ,KAAWS,KA3Dd,GAkJGT,KAAWY,IAlJd,uDAEE,aAAe,IAAD,uBACZ,gBAFM+3B,iBAAmB,EACb,EA+BNC,yBAA0Dp4B,EA/BpD,uIA4CduX,OAA2B,GA5Cb,6bA6Md8gB,WAAa,GA7MC,8CAEZ/4B,aAAe,iBACf,IAAM7K,EAAM+P,aAAaI,QAAQ,aAHrB,OAIRnQ,IAAM,EAAK6jC,UAAY5zB,KAAKI,MAAMrQ,IACtCoO,cAAQ,WACN2B,aAAaC,QAAQ,YAAaC,KAAKC,UAAU,EAAK2zB,eAExDz1B,cAAQ,WACN,IAAMkC,EAAMyB,GAAaI,MAAMvY,KAAKH,SACpCsY,GAAaI,MAAM2xB,KAAO,EAAKxsB,MAAMtD,MAAK,SAAAld,GAAC,OAAIgE,EAAewV,EAAK,GAAsBhW,EAAQxD,EAAE8C,KAAM9C,EAAEyD,aAG7G6T,cAAQ,WACN,IAAM21B,EAAU,EAAKC,YAAYxrC,KAAI,SAAA1B,GAAC,MAAK,CAACwmB,QAAQxmB,EAAGkE,KAAKV,EAAQxD,EAAE8C,KAAM9C,EAAEyD,UAC9EwX,GAAaG,OAAOtZ,SAAQ,SAAAuE,GAC1B,IAAKA,EAAE2P,WAAa3P,EAAE8P,QAAQzC,QAAQ,CACpC,IAAMmrB,EAAQoO,EAAQ/vB,MAAK,SAAAld,GAAC,OAAIgE,EAAeqC,EAAEvD,KAAKH,SAAU,GAAsB3C,EAAEkE,SACxFmC,EAAE8mC,WAAF,OAAetO,QAAf,IAAeA,OAAf,EAAeA,EAAOrY,aAEtBngB,EAAE8mC,gBAAa14B,QApBT,EAFhB,8CA2BE,SAAmBmG,GACbA,IAAO5G,KAAKsX,SAAWtX,KAAK64B,qBAC9B74B,KAAK64B,oBAAoB74B,KAAKsX,QAAS1Q,GAEzC5G,KAAKsX,QAAU1Q,IA/BnB,oCAkCE,SAA8BgvB,EAA4ChvB,GACnEA,GAAMA,IAAO5G,KAAKsX,UACrBtX,KAAK64B,oBAAsBjD,KApCjC,8BA4DE,SAAwBrU,GAAa,OAAOvhB,KAAK8lB,cAAcr8B,IAAI83B,KA5DrE,6BA6DE,SAAuBA,EAAYtZ,GAAgB,IAAD,EAC1CC,EAAM,UAAGlI,KAAK8lB,cAAcr8B,IAAI83B,UAA1B,aAAG,EAA6BrZ,OAC5C,cAAOA,QAAP,IAAOA,OAAP,EAAOA,EAAQgB,MAAK,SAAAxW,GAAC,OAAIA,EAAEuV,OAASA,OA/DxC,sCAiEE,SAAgCH,EAAcyZ,GACxCvhB,KAAK8lB,cAAcrC,IAAIlC,IACzBvhB,KAAK8lB,cAActe,IAAI+Z,EAAK,CAACzZ,OAAMI,OAAO,KAE5C,IAAMkxB,EAAMp5B,KAAK8lB,cAAcr8B,IAAI83B,GAKnC,OAJIzZ,IACF5d,GAAQkvC,EAAItxB,MAAQsxB,EAAItxB,OAASA,GACjCsxB,EAAItxB,KAAOA,GAENsxB,IA1EX,sBA6EE,SAAgBtxB,EAAc+I,EAAa1P,GACzC,GAAa,eAAT0P,EAAsB,CACxB,IAKK,EALC9P,EAAK,IAAIC,YAEf,GADAD,EAAGE,SAASE,GACRnB,KAAKq5B,kBAAoBvxB,EAC3B9H,KAAKq5B,gBAAkBvxB,EACvB9H,KAAKs5B,iBAAmBv4B,OAExB,UAAAf,KAAKs5B,wBAAL,SAAuBC,YAAYzrC,SAAQ,SAAAqT,GACzCJ,EAAGE,SAASE,MAEdnB,KAAKs5B,iBAAmBv4B,MAEvB,CACYf,KAAKw5B,yBAAyB1xB,EAAM+I,GAAM3I,OAClDa,KAAK5H,MA5FlB,yBA+FE,SAAmB2G,EAAc+I,EAAa5I,GAC5C,GAAa,eAAT4I,GACF,GAAI7Q,KAAKq5B,kBAAoBvxB,EAAK,CAChC,IAEuB,EAEhB,EAJD/G,EAAK,IAAIC,YACf,GAAIiH,EACF,GAAa,UAATA,EACF,UAAAjI,KAAKs5B,wBAAL,SAAuBG,iBAAiB3rC,QAAQiT,EAAGE,eAEnD,UAAAjB,KAAKs5B,wBAAL,SAAuBI,iBAAiB5rC,QAAQiT,EAAGE,UAGnDF,EAAGw4B,YAAY/nC,OACjBwO,KAAKs5B,iBAAmBv4B,EAExBf,KAAKs5B,sBAAmB74B,EAE1BT,KAAKq5B,qBAAkB54B,OAEtB,CAAC,IAAD,EACGyH,EAAM,UAAGlI,KAAK8lB,cAAcr8B,IAAIonB,UAA1B,aAAG,EAA8B3I,OAC7C,GAAIA,EACF,GAAID,EAAK,CACP,IAAM1W,EAAI2W,EAAO+P,WAAU,SAAAvlB,GAAC,OAAEA,EAAEuV,OAASA,KACrC1W,GAAG,IACL2W,EAAO3W,GAAGwwB,OACV7Z,EAAOW,OAAOtX,EAAG,SAGnB2W,EAAOpa,SAAQ,SAAAqT,GACbA,EAAM4gB,UAER7Z,EAAO1W,OAAS,OAGlBid,QAAQI,MAAR,kDAAyDgC,EAAzD,mBAjIR,iCAqIE,WACE,OAAOgM,MAAMnT,KAAK1J,KAAK8lB,cAAcxnB,UAtIzC,mCAwIE,WAA+B,IAAD,OAC5B,OAAOue,MAAMnT,KAAK1J,KAAK8lB,cAAcxnB,QAClCye,QAAO,SAAAwE,GAAG,OAAE,EAAKuE,cAAcr8B,IAAI83B,GAAMzZ,OAAS+a,GAAWmQ,cAAclrB,UA1IlF,oCA4IE,WAAgC,IAAD,OAC7B,OAAO+U,MAAMnT,KAAK1J,KAAK8lB,cAAcxnB,QAClCye,QAAO,SAAAwE,GAAG,OAAE,EAAKuE,cAAcr8B,IAAI83B,GAAMzZ,OAAS+a,GAAWmQ,cAAclrB,UA9IlF,uBAmJE,SAAkB9b,GAChByiB,QAAQC,IAAI,aAAc1iB,GAC1BgU,KAAK0S,OAAS1mB,IArJlB,yBAuJE,WACEgU,KAAK25B,aAAa35B,KAAK0S,QACvB1S,KAAK0S,OAASH,OAzJlB,0BA4JE,SAAqBC,GACnBqF,GAAiBrF,GACjBxS,KAAK45B,gBAAgBpnB,KA9JzB,sBAgKE,SAAgBxmB,GACTA,EAAE4a,KACL5a,EAAE4a,GAAK5G,KAAK65B,iBAlKlB,4BAsKE,SAAuBrnB,GACrBA,EAAQ3K,UAAW,EACnB7H,KAAK85B,iBAAiBtyB,IAAIgL,EAAQ5L,GAAI4L,GACtCxS,KAAKoyB,cAzKT,4BA2KE,SAAuB7Q,GACrBvhB,KAAK85B,iBAAiB/uC,OAAOw2B,GAC7BvhB,KAAKoyB,cA7KT,0BA+KE,SAAa7Q,GACX,OAAOvhB,KAAK85B,iBAAiBrwC,IAAI83B,KAhLrC,iCAkLE,SAAoBA,GAClB,IAAIrb,EAAKlG,KAAK6nB,aAAatG,GAM3B,OALKrb,KACHA,EAAK5F,KAAEC,UAAU6Q,KACdxK,GAAK2a,EACRvhB,KAAK85B,iBAAiBtyB,IAAI+Z,EAAKrb,IAE1BA,IAzLX,kBA2LE,SAAYqb,GACV,OAAOvhB,KAAK+pB,aAAatgC,IAAI83B,KA5LjC,uBA+LE,WACE,IAAMwY,EAA0B,GAChC17B,OAAO+D,OAAO23B,EAAQld,MAAMnT,KAAK1J,KAAK+pB,aAAalf,WACnDkvB,EAAOhxB,KAAP,MAAAgxB,EAAM,YAASld,MAAMnT,KAAK1J,KAAK85B,iBAAiBjvB,YAEhD,IAAMmvB,EAAYnd,MAAMnT,KAAKqwB,GAAQhqC,KAAK4oC,IAC1CqB,EAAUlsC,SAAQ,SAAC9B,EAAGklC,GAASllC,EAAEugB,OAAS2kB,EAAI,KAG9ClxB,KAAKmjB,IAAM4W,EACX/5B,KAAKgY,OAASgiB,EACdh6B,KAAKwM,MAAQxM,KAAKgY,OAAO+E,QAAO,SAAA/wB,GAAC,YAAeyU,IAAXzU,EAAEgtC,QAAoBiB,UAC3Dj6B,KAAKk5B,YAAcl5B,KAAKwM,MAAMuQ,QAAO,SAAA/wB,GAAC,MAAe,UAAXA,EAAEgtC,UA3MhD,0BAgNE,WACE,IAAIkB,EAAcl6B,KAAKgY,OAAOC,WAAU,SAACjsB,GAAD,OAAQghB,GAAmBhhB,MAGnE,OAFIkuC,EAAc,IAAKA,EAAcl6B,KAAKgY,OAAOxmB,QAE1CwO,KAAKgY,OAAO7lB,MAAM,EAAG+nC,KApNhC,6BAwNE,SAAgBluC,GACdgU,KAAKm6B,SAASnuC,GACdgU,KAAKo6B,cAAcpuC,KA1NvB,6BA+NE,SAAgBi/B,GACdjrB,KAAK+pB,aAAaviB,IAAIyjB,EAAWrkB,GAAIqkB,GACrCjrB,KAAKoyB,cAjOT,2BAoOE,SAAcnH,GACZjrB,KAAK+pB,aAAaviB,IAAIyjB,EAAWrkB,GAAIqkB,GACrCpI,GAAW0S,eAAezF,KAAKhG,yBAAyB,GAAI,CAACmB,IAC7DjrB,KAAKoyB,YACLpyB,KAAK4rB,iBAAiBpkB,IAAIyjB,EAAWrkB,GAAIqkB,KAxO7C,2BA4OE,SAAc1J,GACZ,GAAY,eAARA,EACEvhB,KAAKq5B,kBAAoBxW,GAAWmQ,cAAclrB,MACpD+a,GAAWoR,uBAAuB,kBAEjC,CACH,IAAMoG,EAAWr6B,KAAK+pB,aAAatgC,IAAI83B,GACnC8Y,IACFr6B,KAAKs6B,eAAeD,GACpBr6B,KAAK+pB,aAAah/B,OAAOw2B,IAE3BsB,GAAW0S,eAAezF,KAAKyK,yBAAyB,GAAI,CAAChZ,IAC7DvhB,KAAK4rB,iBAAiB7gC,OAAOw2B,GAE/BvhB,KAAKoyB,cA1PT,4BA6PE,SAAelM,GACbrD,GAAW0S,eAAexH,4BAA4BniB,GAAYJ,6BAA8B0a,KA9PpG,mCAiQE,SAAsBrG,GAAuB,IAAD,gBAC1BA,GAD0B,IAC1C,2BAAoB,CAAC,IAAV7zB,EAAS,QAClBgU,KAAK+pB,aAAaviB,IAAIxb,EAAE4a,GAAI5a,GACZ,WAAXA,EAAE0c,MAAgC,WAAX1c,EAAE0c,MAC5B1I,KAAKw6B,sBAAsBxuC,IAJW,8BAO1CgU,KAAKoyB,cAxQT,mCA2QE,SAAsBlM,GAAiB,IAAD,gBAClBA,GADkB,IACpC,2BAAwB,CAAC,IAAd3E,EAAa,QAChB8Y,EAAWr6B,KAAK+pB,aAAatgC,IAAI83B,GACnC8Y,GACFr6B,KAAKs6B,eAAeD,GACpBr6B,KAAK+pB,aAAah/B,OAAOw2B,IAErB2B,GAAS5L,UAAYiK,IACvB2B,GAAS5L,QAAU,IAGvB4L,GAAS0I,iBAAiB7gC,OAAOw2B,IAXC,8BAapCvhB,KAAKoyB,cAxRT,6BA0RE,WACEpyB,KAAK+pB,aAAariB,QAClB1H,KAAK4rB,iBAAiBlkB,UA5R1B,+BA+RE,WACE,IAAMwe,EAAOrJ,MAAMnT,KAAK1J,KAAK4rB,iBAAiBttB,QAC9CukB,GAAW0S,eAAezF,KAAKyK,yBAAyB,GAAIrU,GAC5DlmB,KAAK+pB,aAAariB,QAClB1H,KAAK4rB,iBAAiBlkB,QACtB1H,KAAKoyB,cApST,yBAwSE,WAEE,IADA,IAAM9pB,EAAMmyB,GAAkB7yB,UACpB,CACR5H,KAAK44B,kBAAoB,EACzB,IAAMhyB,EAAE,UAAM0B,EAAN,YAAatI,KAAK44B,kBAC1B,IAAK54B,KAAK+pB,aAAatG,IAAI7c,KAAQ6zB,GAAkBrzB,OAAOqc,IAAI7c,GAAO,OAAOA,EAIhF,MAAO,KAjTX,4BAoTE,SAAuB5a,GAIrB,GAHIA,EAAE4a,KAAO5G,KAAKsX,SAChBtX,KAAK06B,WAAW,IAEH,WAAX1uC,EAAE0c,MAAgC,WAAX1c,EAAE0c,KAAmB,CAC9C,IAAMiyB,EAAgB36B,KAAK8lB,cAAcr8B,IAAIuC,EAAE4a,IAC/C,OAAI+zB,QAAJ,IAAIA,KAAe7yB,OACb6yB,EAAc7yB,OAASb,GAAaW,QACtCib,GAAWoR,uBAAuBjoC,EAAE4a,IAEpCic,GAAW+X,WAAWD,EAAc7yB,KAAM9b,EAAE4a,IAE9C5G,KAAK8lB,cAAc/6B,OAAOiB,EAAE4a,QAhUpC,mCAqUE,SAA8B5a,MArUhC,0BA0UE,SAAqBkJ,GAAc8K,KAAK+4B,UAAY7jC,MA1UtD,GAAoC4jB,iBAApC,uCA2BGtX,MA3BH,qHA2CGvB,MA3CH,yEA2C6B,KA3C7B,uCA4CGA,MA5CH,wEA4CwB,MA5CxB,+GA6C8C,MA7C9C,iHA+CgD,MA/ChD,uHAgDsD,MAhDtD,yHAkDqC,IAAIpV,OAlDzC,6HAoDyC,IAAIA,OApD7C,6HAsDyC,IAAIA,OAtD7C,iKA0DGoV,MA1DH,wLA2DmC,IAAIpV,OA3DvC,mHAkJ0C0nB,QAlJ1C,sCAmJG/Q,MAnJH,gHAuJGA,MAvJH,mHA4JGA,MA5JH,sHAsKGA,MAtKH,wHA2KGA,MA3KH,sHAyUGvB,MAzUH,yEAyU0B,KAzU1B,yCA0UGuB,MA1UH,+EA+UAtV,EAAEg3B,SAAWA,GACEA,I,wBAAAA,MCpWF2X,GACD,GADCA,GAED,EAGNC,GAAO,GAsJPptC,GAAM,IArJZ,cACE,aAAe,sSAsHNqtC,cAAgB,IAAI5yB,IArH3BpI,aAAeC,MACfA,KAAKg7B,wBAHT,wCAUE,WACE,MAAO,GAAGh7B,KAAK+W,KAAO/W,KAAK2F,WAAW,GAAKm1B,KAAS96B,KAAK2F,WAAW,GAAKm1B,MAX7E,6BAaE,WACE,MAAO,EAAG96B,KAAK2F,WAAW,GAAKm1B,IAAS96B,KAAK2F,WAAW,GAAKm1B,MAdjE,oBAgBE,WACE,OAAO5sC,EAAc/B,EAAgB6T,KAAKi7B,oBAjB9C,uBAsBE,SAAkBpgB,GAChB7a,KAAKtU,OAASmvB,EACd7a,KAAKk7B,gBAAgBrgB,KAxBzB,6BA0BE,SAAwBA,GACtB,IAAMsgB,EAAQ1vC,EAAcovB,GACtBxvB,EAAQ2U,KAAK2F,WAAW,GAAKw1B,EACnCl0B,GAAaI,MAAM3B,UAAUpa,OAASD,EACtC4b,GAAaI,MAAM+zB,sBAAsBp7B,QA9B7C,gCAgCE,SAA2B6a,GACzB,IAAMtqB,EAAQyP,KAAKyF,SAASzF,KAAK4S,YACjC5S,KAAKi7B,gBAAkBpgB,EACvB7a,KAAK4S,WAAa5S,KAAKq7B,WAAW9qC,GAClCyP,KAAKs7B,qBAAoB,GACzBt7B,KAAKu7B,sBAAmB96B,EACxBT,KAAKk7B,gBAAgBrgB,KAtCzB,2BAwCE,SAAsBrtB,GACpBwS,KAAK2F,WAAW,GAAKnY,EAAE,GACvBwS,KAAK2F,WAAW,GAAKnY,EAAE,GACvBwS,KAAKk7B,gBAAgBl7B,KAAKi7B,mBA3C9B,qBA6CE,SAAgBzP,GACdxrB,KAAK+W,KAAOyU,IA9ChB,sBAgDE,SAAiB3Q,GACf7a,KAAKzP,MAAQlD,EAAMwtB,EAAG7a,KAAK8U,QAC3B9U,KAAK4S,WAAa5lB,EAAiBgT,KAAKtU,OAAO8vC,UAAWx7B,KAAKzP,SAlDnE,qBAoDE,SAAgBiQ,GACd,IAAMi7B,EAAKz7B,KAAKtU,OAAO8vC,UACjB5wC,EAAO0C,EAAMkT,EAAI1R,KAAKH,SAAU,CAAC8sC,EAAGvuC,EAAGuuC,EAAGtuC,IAE1CuuC,GADM,IAAIhvC,WAAYC,WAAW/B,EAAK,IAAKA,EAAK,IACnC+wC,gBAAgB37B,KAAKtU,QACxCsU,KAAK47B,UAAUF,GACf17B,KAAK67B,mBAAmBH,KA1D5B,oBA4DE,SAAelpB,GACb,IAAMspB,EAAY97B,KAAKtU,OACjBqwC,EAAclf,MAAMnT,KAAK8I,EAAQ/iB,MACvCssC,EAAY,IAAMrD,GAClB,IAAMsD,EAAS,CAACtuC,GAAIiY,WAAW,GAAKo2B,EAAY,GAAIruC,GAAIiY,WAAW,GAAKo2B,EAAY,IAC9EE,EAAWtwC,KAAK+oB,IAAI/oB,KAAKkzB,IAAImd,EAAO,GAAIA,EAAO,GAAInB,IAAuBA,IAC1EqB,EAAWzwC,EAAcqwC,GAEzBL,EAAKK,EAAUN,UACf5wC,EAAO0C,EAAMklB,EAAQ1jB,KAAKH,SAAU,CAAC8sC,EAAGvuC,EAAGuuC,EAAGtuC,IAE9C4pB,EAAOglB,EAAY,GAAK,EACxBjkB,EAAO9X,KAAK2F,WAAW,GAAKs2B,EAAY,EAAIvD,GAI5CgD,GAHM,IAAIhvC,WAAYC,WAAW/B,EAAK,GAAKmsB,GAAOnsB,EAAK,GAAKktB,GAG/C6jB,gBAAgBG,GAAWH,iBAAgB,IAAIjvC,WAAYyuC,MAAMc,EAASC,IAC7FztB,QAAQC,IAAR,mBAAwButB,EAAxB,eAAuCC,EAAvC,2BAAkEzwC,EAAciwC,KAChF17B,KAAK47B,UAAUF,GACf17B,KAAK67B,mBAAmBH,GACxB17B,KAAKu7B,iBAAmBO,EACxBrtB,QAAQC,IAAR,0BAA+B1O,KAAKu7B,qBAjFxC,yBAmFE,WACMv7B,KAAKu7B,mBACPv7B,KAAK47B,UAAU57B,KAAKu7B,kBACpBv7B,KAAK67B,mBAAmB77B,KAAKu7B,qBAtFnC,kBAyFE,WACE,YAAiC96B,IAA1BT,KAAKu7B,mBA1FhB,uBA4FE,WACE,OAAOvuC,EAAiBgT,KAAKtU,OAAO8vC,UAAW,CAAC,EAAE,MA7FtD,sBAgGE,SAASh2B,GACP,OAAOlY,EAAMN,EAAiBgT,KAAKtU,OAAQ8Z,GAAMxF,KAAK8U,UAjG1D,wBAmGE,SAAWtP,GACT,OAAOxY,EAAiBgT,KAAKtU,OAAO8vC,UAAWnuC,EAAMmY,EAAKxF,KAAK8U,WApGnE,uBAsGE,SAAUtP,GACR,OAAOlY,EAAMN,EAAiBgT,KAAKtU,OAAQ8Z,GAAMxF,KAAKm8B,qBAvG1D,8BAyGE,SAAiB32B,GACf,OAAOpY,EAAe4S,KAAKtU,OAAO8vC,UAAWh2B,KA1GjD,4BA4GE,SAAeA,GACb,OAAOpY,EAAe4S,KAAKtU,OAAQ8Z,KA7GvC,yBA+GE,WACE,IAAM9V,EAAKsQ,KAAKq7B,WAAW,CAAC,EAAE,IACxBe,EAAKp8B,KAAKq7B,WAAWr7B,KAAK2F,YAIhC,MAAO,CAACjW,EAAG,GAHIkP,GAGSw9B,EAAG,GAHZx9B,GAGyBw9B,EAAG,GAH5Bx9B,GAGyClP,EAAG,GAH5CkP,MAlHnB,iCAyHE,SAAoBkG,GAClB,IAAIC,EAAUC,eACVF,IAAkBC,EAAUE,cAChC,IAAMo3B,EAAK,CAACr8B,KAAKtU,OAAOhB,EAAGsV,KAAKtU,OAAOf,EAAGqV,KAAKtU,OAAOM,EAAGgU,KAAKtU,OAAOQ,EAAG8T,KAAKtU,OAAOwB,EAAG8S,KAAKtU,OAAOyB,GACnG4X,EAAQG,QAAQ,YAAaC,KAAKC,UAAUi3B,MA7HhD,mCA+HE,WACE,IAAIt3B,EAAUE,aACVD,eAAeK,QAAQ,eACzBN,EAAUC,gBAEZ,IAAMtU,EAAMqU,EAAQM,QAAQ,aAC5B,GAAI3U,EAAK,CACP,IAAM2rC,EAAKl3B,KAAKI,MAAM7U,GAChBgrC,EAAS,IAAIhvC,UACnBgvC,EAAOhxC,EAAI2xC,EAAG,GACdX,EAAO/wC,EAAI0xC,EAAG,GACdX,EAAO1vC,EAAIqwC,EAAG,GACdX,EAAOxvC,EAAImwC,EAAG,GACdX,EAAOxuC,EAAImvC,EAAG,GACdX,EAAOvuC,EAAIkvC,EAAG,GACdr8B,KAAK47B,UAAUF,GACf17B,KAAK67B,mBAAmBH,QA/I9B,2CAMGz7B,MANH,yEAM0C,IAAIq8B,qBAN9C,+CAOGr8B,MAPH,yEAOmD,IAAIq8B,qBAPvD,gDAQGr8B,MARH,wGASGA,MATH,wEAS6C,CAAC,EAAG,MATjD,mCAUGsB,MAVH,mHAaGA,MAbH,qHAgBGA,MAhBH,2GAmBGtB,MAnBH,yEAmBqB,KAnBrB,qCAoBGA,MApBH,wEAoBwC,CAAC,EAAG,MApB5C,0CAqBGA,MArBH,wEAqB6C,CAAC,EAAG,MArBjD,sCAsBGuB,MAtBH,uHAgCGA,MAhCH,2HAwCGA,MAxCH,gHA6CGA,MA7CH,2GAgDGA,MAhDH,2GAoDGA,MApDH,yGA4DGA,MA5DH,6GAmFGA,MAnFH,6GAyFGD,MAzFH,6GA4FGA,MA5FH,4HA+HGC,MA/HH,wFAuJAtV,EAAEwB,IAAMA,GACOA,I,YAAAA,MCoFTi9B,GAAY,IA/OlB,cAuDE,aAAe,IAAD,8IAlDd1U,OAAU,GAkDI,KAjDdnX,KAAQ,GAiDM,KAoBNy9B,YAAgC,GApB1B,KAqBNC,YAAgC,GArB1B,KAsBNC,aAAiC,GAtB3B,KAkGdC,YAAsCj8B,EAlGxB,KAmGdk8B,gBAAuCl8B,EAlGrCV,aAAeC,MACkB,OAA7BjX,EAAa,SACfiX,KAAK0H,QAEPpE,cAAQ,WACF,EAAK9S,OACP9C,GAAIqtC,cAAc/X,IAAI,eAEtBt1B,GAAIqtC,cAAchwC,OAAO,kBAG7BuY,cAAQ,WACF2D,GAAaI,MAAMlF,QAAQvC,kBAC7B,EAAKgrB,QAAQ,UArErB,uCACE,WAAwB,OAAQ5qB,KAAK0I,OADvC,qBAOE,SAAgBA,EAAiB5J,EAAcmX,GAC7CjW,KAAK0I,KAAOA,EACZ1I,KAAK48B,MAAM5Z,IAAIta,GACf1I,KAAKiW,OAASA,EACdjW,KAAKlB,KAAOA,IAXhB,iBAaE,WACE,OAAOkB,KAAK0I,MACV,IAAK,aAAc,OAAOhW,GAAE,gBAC5B,IAAK,QAAS,OAAOA,GAAE,WACvB,IAAK,QAAS,OAAOA,GAAE,WACvB,IAAK,gBAAiB,OAAOA,GAAE,mBAC/B,IAAK,gBAAiB,OAAOA,GAAE,mBAC/B,IAAK,iBAAkB,OAAOA,GAAE,oBAChC,IAAK,WAAY,MAAO,GACxB,IAAK,MAAO,OAAOA,GAAE,YACrB,IAAK,SAAU,MAAM,aAAN,OAAoBsN,KAAKlB,KAAzB,aAAkCkB,KAAKiW,QAGxD,OAAOjW,KAAK0I,OA1BhB,mBA4BE,WACE,OAAO1I,KAAK0I,MACV,IAAK,aAAc,OAAOhW,GAAE,gBAC5B,IAAK,QAAS,OAAOA,GAAE,WACvB,IAAK,QAAS,OAAOA,GAAE,WACvB,IAAK,gBAAiB,OAAOA,GAAE,mBAC/B,IAAK,gBAAiB,OAAOA,GAAE,mBAC/B,IAAK,iBAAkB,OAAOA,GAAE,oBAChC,IAAK,WAEL,IAAK,SAAU,MAAO,GADtB,IAAK,MAAO,OAAOA,GAAE,cAIvB,MAAM,0BAAN,OAAiCsN,KAAK0I,QAzC1C,kBA4CE,WACE,GAAkB,KAAd1I,KAAK0I,KAAY,CACnB,IAAMk0B,EvChBL,SAAoBlyC,EAAUC,GACnC,IAD6C,EACvCC,EAAO,IAAIud,IAAOzd,GADqB,cAE1BC,GAF0B,IAE7C,2BAAsB,CAAC,IAAZG,EAAW,QACpBF,EAAKG,OAAOD,IAH+B,8BAM7C,OAAOF,EuCUWiyC,CAAQ78B,KAAK48B,MAAO58B,KAAK88B,gBACnCF,EAAMntC,OACRuQ,KAAK0I,KAAOk0B,EAAM/xB,SAASkyB,OAAOpmB,OAItC,MAAmB,KAAZ3W,KAAK0I,OAAc1I,KAAK88B,eAAerZ,IAAIzjB,KAAK0I,QApD3D,8BA8EE,WAA4B,IAAD,OACzBpe,UAAU0yC,aAAaC,mBAAmB34B,MAAK,SAAC44B,GAC9C,EAAKX,YAAc,GACnB,EAAKC,YAAc,GACnB,EAAKC,aAAe,GACpBS,EAAQpvC,SAAQ,SAACgY,GACK,eAAhBA,EAAOmC,MAAyB,EAAKs0B,YAAYxzB,KAAKjD,GACtC,eAAhBA,EAAOmC,MAAyB,EAAKu0B,YAAYzzB,KAAKjD,GACtC,gBAAhBA,EAAOmC,MAA0B,EAAKw0B,aAAa1zB,KAAKjD,SAE7DvB,OAAM,WAAQkK,QAAQI,MAAM,iCAxFnC,6BA2FE,WAA2B,IAAD,OAIW,OAA/B9lB,EAAco0C,eAChBn9B,KAAK0H,QACLT,GAAaI,MAAM2hB,mBAErBhpB,KAAKi9B,mBACyB,OAA1Bl0C,EAAcoiC,QAChBiS,cAAK,iBAAoB,KAAd,EAAK10B,QAAa,WAC3B0R,WAAW,EAAKijB,gBAAgB/uB,KAAK,GAAO,QAG9C8L,WAAWpa,KAAKs9B,aAAahvB,KAAKtO,MAAO,OAzG/C,mBA4GE,SAAc0I,GACM,QAAd1I,KAAK0I,OACPzB,GAAaI,MAAMlF,QAAQvC,kBAAmB,GAE5C8I,GACF1I,KAAK48B,MAAM7xC,OAAO2d,GACd1I,KAAK0I,OAASA,IAAQ1I,KAAK0I,KAAO,MAEtC1I,KAAK48B,MAAMl1B,QACX1H,KAAK0I,KAAO,MArHlB,6BAwHE,WACOma,GAAW0a,iBAGL1a,GAAW2a,mBAIpBx9B,KAAK0H,MAAM,iBACX1H,KAAK0H,MAAM,kBACX1H,KAAKy9B,aALLz9B,KAAK4qB,QAAQ,kBACbxQ,WAAWpa,KAAKq9B,gBAAgB/uB,KAAKtO,MAAO,OAJ5CA,KAAK4qB,QAAQ,iBACbxQ,WAAWpa,KAAKq9B,gBAAgB/uB,KAAKtO,MAAO,QA3HlD,sBAqIE,YACMiH,GAAaW,SAAYX,GAAaI,MAAMrF,WAAc6gB,GAAW6a,oBAWnEz2B,GAAaI,MAAMrF,WACrBoY,WAAWpa,KAAKy9B,SAASnvB,KAAKtO,MAAS,KAEzCA,KAAK0H,MAAM,SACX1H,KAAK0H,MAAM,mBAdP1H,KAAKw8B,YAAYhrC,OACnBwO,KAAK4qB,QAAQ,kBAIb5qB,KAAK0H,MAAM,iBACX1H,KAAK4qB,QAAQ,UAEfxQ,WAAWpa,KAAKy9B,SAASnvB,KAAKtO,MAAS,QA/I7C,0BA2JE,WAAiB,IAAD,OACdiH,GAAaI,MAAMrF,WAAY,EAC/BiF,GAAaI,MAAMpF,WAAY,EAC/B,IAAI40B,EAAU,EAER8G,EAAO,IAAIrP,aACjBtuB,KAAK28B,WAAagB,EAAKC,mBACvB59B,KAAK28B,WAAWj0B,KAAO,WACvB,IAAMm1B,EAAcF,EAAKG,+BACzB99B,KAAK28B,WAAWlO,QAAQoP,GACxB79B,KAAK28B,WAAWhlB,QAEhB3X,KAAK08B,OAASjmB,SAASC,cAAc,UACrC,IAAMrrB,EAAQ,IACRC,EAAS,IACf0U,KAAK08B,OAAO5lB,MAAMzrB,MAAlB,UAA6BA,EAA7B,MACA2U,KAAK08B,OAAO5lB,MAAMxrB,OAAlB,UAA8BA,EAA9B,MACA,IAAMyyC,EAAM/9B,KAAK08B,OAAOsB,WAAW,MAC7B1xC,EAAS,CAACX,KAAKsyC,SAAW/9B,GAAW,GAAIvU,KAAKsyC,SAAW,IAAO/9B,IAqBtEsc,aApBa,WAAO,IAAD,UACjB,GAAKuhB,GAAQJ,EAAb,CAEA,YAAKhB,kBAAL,SAAiBuB,UAAUC,eAAe,IAAMtH,EAAU,IAAK8G,EAAKS,aAEpE,IAAM51B,EAAS,CAAC,QAAS,QACnB61B,EAAY,UAAGxb,GAAWiS,mBAAmBzB,gBAAgBvB,OAAO,UAAxD,aAAG,EAAyD7S,SACxEqf,EAAY,UAAGzb,GAAWiS,mBAAmBzB,gBAAgBtB,OAAO,UAAxD,aAAG,EAAyD9S,SAC1Eof,GAAY,UAAIA,EAAalf,gBAAjB,OAAI,EAAuBhe,MAAMG,QAASkH,EAAO,GAAK,UAClE81B,GAAY,UAAIA,EAAanf,gBAAjB,OAAI,EAAuBhe,MAAMG,QAASkH,EAAO,GAAK,OACtEu1B,EAAIQ,UAAY/1B,EAAO,GACvBu1B,EAAIS,YACJT,EAAIU,QAAQpzC,MAAcC,KAAeD,GAAaC,GAAcurC,EAAU,GAAI,EAAa,EAAVlrC,KAAKsC,IAC1F8vC,EAAIW,OACJX,EAAIQ,UAAY/1B,EAAO,GACvBu1B,EAAIS,YACJT,EAAIU,QAAQpzC,MAAcC,KAAeD,GAAaC,IAAeurC,EAAU,GAAI,EAAa,EAAVlrC,KAAKsC,IAC3F8vC,EAAIW,OACJ7H,GAAW,KAEK,IAClB,IAAM8H,EAAQ,kEACRC,EAAW,kBAAOD,EAAM/0C,OAAO+B,KAAKgG,MAAMhG,KAAKsyC,SAAWU,EAAMntC,QAAS,IAC/EyV,GAAaI,MAAMvF,YAAcjD,GACjCoI,GAAaI,MAAMvF,YAAYhD,KAA/B,kBAAiD8/B,KAAjD,OAA8DA,KAA9D,OAA2EA,KAC3E33B,GAAaI,MAAM2hB,kBACnB/hB,GAAaI,MAAMvY,KAAKH,SAAWrC,EAEnC,IAAMuyC,EAAO,WACX53B,GAAaI,MAAMvY,KAAKH,SAAWtB,EAAMf,EAAQqB,EAAM,IAAK,CAAChC,KAAK8C,IAAIooC,EAAU,IAAKlrC,KAAK6C,IAAIqoC,EAAU,QAepGiI,EAAM/0C,OACZ,GAAI+0C,EAAIC,oBAAqB,EACV,SAAXC,IACJ5kB,YAAW,WACTykB,IACAC,EAAIC,oBAAoBC,KACf,IAEbA,QAEAxiB,YAAYqiB,EAAM,KAGpB,IACMI,EADej/B,KAAK08B,OAAewC,cAAc,IACxBzF,iBAAiB,GAC1C0F,EAAatB,EAAYh4B,OAAO6zB,iBAAiB,GACvD7W,GAAWuc,oBAAoB,CAACj+B,MAAM89B,EAAYn3B,KAAKb,GAAaI,MAAMT,GAAIiK,KAAK,WACnFgS,GAAWwc,iBAAiB,CAACl+B,MAAMg+B,EAAYr3B,KAAKb,GAAaI,MAAMT,GAAIiK,KAAK,eA3OpF,uCACGtP,MADH,wGAEGtB,MAFH,wEAE+B,cAF/B,qCAGGA,MAHH,yEAGsC,IAAIkI,OAH1C,8CAIGlI,MAJH,yEAI8C,IAAIkI,OAJlD,oCAOG3G,MAPH,wGAaGD,MAbH,wGA4BGA,MA5BH,kHA2FGC,MA3FH,gHA4GGA,MA5GH,gHAwHGA,MAxHH,mHAqIGA,MArIH,2EAiPAtV,EAAE2iB,MAAQ8b,GACKA,U,sCC9PA,OAA0B,6CCA1B,OAA0B,yCCA1B,4nECAA,oyG,mGCSF2U,GAA0B,WACrCC,sBAAU,WACR7xC,GAAIqtC,cAAc/X,IAAI,gBAExB,IAAMgN,EAAU,SAAChW,GACftsB,GAAIqtC,cAAchwC,OAAO,aACzB,IAAMy0C,EAAQxlB,EACVwlB,EAAMC,OAERD,EAAME,iBACNF,EAAMG,mBAERhV,GAAUjjB,SAGZ,OAAO,eAAC,GAAD,CAAkBsoB,QAASA,EAA3B,SACL,eAAC4P,GAAA,EAAD,CAAe9oB,MAAO,CAAC+oB,SAAU70C,IAAiB,MAAQ,OAA1D,SACE,eAAC80C,GAAA,EAAD,CAAQ7gC,MAAM,UAAU8gC,QAAQ,YAAYjpB,MAAO,CAACkpB,cAAc,QAASC,WAAW,EACpFC,UAAWlQ,EAASmQ,QAASnQ,EAD/B,SAEGt9B,GAAE,qBAKX4sC,GAAUc,YAAc,YCvBxB,IAg/BMC,GAAa,CAtMC,CAChB,OAAQ,SAAU,WAAY,WAAY,SAAU,WACpD,aAAc,aAAc,cAAe,WAAY,OAAQ,SAC/D,SAAU,QAAS,aAAc,WAAY,WAC7C,iBAAkB,QAAS,UAAW,WAAY,UAClD,YAAa,aAAc,SAAU,OACrC,eAAgB,QAAS,QAAS,QAAS,QAC3C,QAAS,cAAe,UAAW,SAAU,UAAW,YACxD,UAAW,UAAW,QAAS,UAAW,WAAY,SACtD,YAAa,UAAW,WAAY,YAAa,aACjD,cAAe,YAAa,gBAAiB,aAC7C,WAAY,UAAW,SAAU,YAAa,aAC9C,cAAe,aAAc,QAAS,YAAa,YACnD,YAAa,UAAW,QAAS,QAAS,UAAW,OAAQ,MAC7D,WAAY,OAAQ,QAAS,QAAS,YAAa,UACnD,aAAc,OAAQ,OAAQ,SAAU,MAAO,aAAc,SAC7D,UAAW,QAAS,QAAS,SAAU,OAAQ,OAAQ,QACvD,SAAU,SAAU,QAAS,QAAS,QAAS,SAAU,YACzD,QAAS,SAAU,QAAS,OAAQ,OAAQ,UAC5C,UAAW,aAAc,UAAW,WAAY,SAAU,WAC1D,UAAW,UAAW,cAAe,iBAAkB,WACvD,QAAS,WAAY,WAAY,QAAS,UAAW,QAAS,QAC9D,WAAY,UAAW,YAAa,QAAS,QAAS,SACtD,WAAY,QAAS,SAAU,UAAW,YAAa,OACvD,aAAc,WAAY,WAAY,YAAa,cACnD,QAAS,aAAc,SAAU,YAAa,aAC9C,cAAe,aAAc,YAAa,cAAe,WACzD,UAAW,cAAe,gBAAiB,aAAc,YACzD,WAAY,YAAa,WAAY,YAAa,gBAClD,YAAa,YAAa,cAAe,eAAgB,eACzD,aAAc,WAAY,iBAAkB,eAAgB,UAC5D,aAAc,WAAY,gBAAiB,aAAc,eACzD,YAAa,aAAc,OAAQ,cAAe,OAAQ,YAC1D,UAAW,gBAAiB,SAAU,YAAa,UACnD,QAAS,WAAY,WAAY,WACjC,UAAW,UAAW,QAAS,QAAS,OAAQ,WAAY,UAC5D,QAAS,UAAW,SAAU,OAAQ,UAAW,QAAS,QAC1D,WAAY,YAAa,OAAQ,OAAQ,OAAQ,SACjD,WAAY,YAAa,OAAQ,YAAa,WAAY,aAC1D,WAAY,YAAa,YAAa,aAAc,QACpD,YAAa,YAAa,aAAc,YAAa,YACrD,cAAe,WAAY,aAAc,YAAa,YACtD,UAAW,aAAc,SAAU,QAAS,WAAY,eACxD,gBAAiB,aAAc,YAAa,UAAW,WACvD,cAAe,aAAc,UAAW,SAAU,WAClD,WAAY,WAAY,SAAU,aAAc,WAAY,WAC5D,UAAW,UAAW,MAAO,OAAQ,MAAO,OAAQ,OACpD,UAAW,QAAS,QAAS,OAAQ,UAAW,OAAQ,aACxD,WAAY,YAAa,WAAY,cAAe,YACpD,YAAa,YAAa,UAAW,YAAa,WAClD,aAAc,aAAc,UAAW,aAAc,WACrD,cAAe,eAAgB,YAAa,YAAa,QACzD,cAAe,UAAW,UAAW,WAAY,YACjD,WAAY,eAAgB,eAAgB,SAAU,gBACtD,QAAS,aAAc,YAAa,UAAW,UAAW,SAC1D,OAAQ,WAAY,UAAW,OAAQ,eAAgB,QACvD,YAAa,cAAe,SAAU,YAAa,UACnD,WAAY,YAAa,YAAa,SAAU,WAAY,YAC5D,cAAe,eAAgB,SAAU,WAAY,YACrD,YAAa,WAAY,QAAS,gBAAiB,UACnD,WAAY,SAAU,OAAQ,OAAQ,QAAS,WAAY,SAC3D,SAAU,QAAS,YAAa,MAAO,cAAe,cACtD,OAAQ,MAAO,QAAS,aAAc,YAAa,UAAW,SAC9D,WAAY,MAAO,SAAU,QAAS,YAAa,OACnD,OAAQ,MAAO,QAAS,OAAQ,SAAU,WAAY,SACtD,UAAW,OAAQ,YAAa,OAAQ,UAAW,SAAU,SAC7D,cAAe,YAAa,UAAW,UAAW,OAAQ,WAC1D,QAAS,WAAY,aAAc,cAAe,QAAS,SAC3D,aAAc,cAAe,OAAQ,WAAY,MAAO,aACxD,cAAe,QAAS,UAAW,UAAW,SAC9C,UAAW,UAAW,WAAY,UAAW,SAAU,UACvD,QAAS,OAAQ,SAAU,WAAY,OAAQ,SAAU,OACzD,WAAY,QAAS,UAAW,WAAY,QAAS,QAAS,QAC9D,OAAQ,QAAS,SAAU,QAAS,QAAS,OAAQ,UAAW,QAChE,UAAW,QAAS,UAAW,SAAU,OAAQ,cACjD,YAAa,WAAY,aAAc,SAAU,OAAQ,OACzD,WAAY,SAAU,UAAW,WAAY,MAAO,OACpD,QAAS,eAAgB,SAAU,WAAY,SAAU,OACzD,QAAS,YAAa,cAAe,MAAO,UAAW,YACvD,YAAa,UAAW,WAAY,SAAU,YAAa,YAC3D,aAAc,YAAa,aAAc,aAAc,gBACvD,WAAY,WAAY,YAAa,aAAc,cACnD,aAAc,WAAY,aAAc,SAAU,aAClD,aAAc,WAAY,cAAe,WAAY,WACrD,UAAW,UAAW,QAAS,WAAY,aAAc,SACzD,UAAW,gBAAiB,eAAgB,eAAgB,SAC5D,WAAY,aAAc,eAAgB,cAAe,WACzD,UAAW,YAAa,cAAe,aAAc,cACrD,UAAW,WAAY,eAAgB,WAAY,gBACnD,WAAY,aAAc,YAAa,WAAY,SACnD,aAAc,WAAY,QAAS,WAAY,SAAU,OAAQ,OACjE,MAAO,OAAQ,QAAS,aAAc,OAAQ,QAAS,SACvD,SAAU,OAAQ,UAAW,OAAQ,QAAS,YAC9C,cAAe,aAAc,UAAW,SACxC,QAAS,SAAU,UAAW,WAAY,QAAS,SAAU,UAC7D,SAAU,SAAU,WAAY,SAAU,OAAQ,SAAU,SAC5D,QAAS,UAAW,UAAW,SAAU,OAAQ,eACjD,WAAY,WAAY,QAAS,OAAQ,OAAQ,SAAU,MAC3D,QAAS,QAAS,SAAU,MAAO,QAAS,UAAW,WACvD,cAAe,OAAQ,aAAc,QAAS,YAC9C,WAAY,SAAU,UAAW,UAAW,OAAQ,UACpD,WAAY,WAAY,eAAgB,SAAU,UAClD,aAAc,aAAc,UAAW,WAAY,SACnD,YAAa,SAAU,OAAQ,SAAU,OACzC,UAAW,UAAW,SAAU,YAAa,aAC7C,UAAW,QAAS,SAAU,WAAY,SAAU,SAAU,UAC9D,QAAS,QAAS,SAAU,WAAY,YAAa,UACrD,SAAU,aAAc,YAAa,SACrC,WAAY,aAAc,SAAU,UAAW,QAAS,OACxD,SAAU,OAAQ,YAAa,WAAY,eAAgB,UAC3D,MAAO,UAAW,MAAO,OAAQ,OAAQ,QAAS,QAAS,YAC3D,SAAU,QAAS,WAAY,UAAW,YAAa,QACvD,UAAW,WAAY,YAAa,UAAW,aAAc,MAC7D,YAAa,WAAY,KAAM,MAAO,eAAgB,UACtD,SAAU,OAAQ,OAAQ,cAAe,UAAW,WACpD,UAAW,aAAc,SAAU,WAAY,UAC/C,iBAAkB,YAAa,WAAY,QAAS,UAAW,QAC/D,UAAW,cAAe,UAAW,WAAY,eAAgB,MACjE,UAAW,OAAQ,WAAY,WAAY,gBAAiB,WAC5D,UAAW,aAAc,aAAc,UAAW,OAAQ,UAC1D,WAAY,WAAY,UAAW,YAAa,aAChD,WAAY,gBAAiB,WAAY,OAAQ,QAAS,UAC1D,WAAY,UAAW,OAAQ,UAAW,YAAa,SACvD,YAAa,OAAQ,MAAO,UAAW,WAAY,WACnD,UAAW,YAAa,WAAY,YAAa,WAAY,UAC7D,cAAe,cAAe,UAAW,WACzC,UAAW,eAAgB,cAAe,SAAU,WACpD,UAAW,QAAS,YAAa,QAAS,UAAW,WACrD,cAAe,aAAc,eAAgB,aAAc,WAC3D,cAAe,YAAa,YAAa,aAAc,SACvD,cAAe,aAAc,QAAS,aAAc,cACpD,gBAAiB,SAAU,OAAQ,SAAU,YAAa,QAC1D,QAAS,UAAW,SAAU,QAAS,OACvC,WAAY,MAAO,QAAS,OAAQ,YAAa,OAAQ,aACzD,SAAU,MAAO,WAAY,UAAW,aAAc,UACtD,WAAY,UAAW,WAAY,WAAY,WAAY,WAC3D,YAAa,YAAa,aAAc,SAAU,WAClD,WAAY,iBAAkB,WAAY,cAAe,aACzD,cAAe,UAAW,UAAW,gBAAiB,OACtD,aAAc,QAAS,QAAS,QAAS,SAAU,WAAY,QAC/D,QAAS,UAAW,QAAS,SAAU,OAAQ,QAAS,SAAU,MAClE,OAAQ,OAAQ,YAAa,QAAS,YACtC,YAAa,aAAc,YAAa,SAAU,UAAW,SAC7D,YAAa,SAAU,WAAY,YAAa,WAAY,SAC5D,UAAW,SAAU,UAAW,SAAU,QAC1C,QAAS,QAAS,UAAW,WAAY,QAAS,YAAa,OAC/D,MAAO,cAAe,SAAU,QAAS,SAAU,UACnD,SAAU,UAAW,SAAU,WAAY,MAAO,UAAW,SAC7D,OAAQ,QAAS,QAAS,SAAU,WAAY,SAAU,YAC1D,OAAQ,QAAS,OAAQ,QAAS,OAAQ,gBAC1C,QAAS,QAAS,QAAS,UAAW,aACtC,cAAe,WAAY,cAAe,QAAS,YACnD,SAAU,WAAY,SAAU,SAAU,WAAY,WACtD,QAAS,QAAS,cAAe,SAAU,QAAS,SAAU,QAC9D,QAAS,WAAY,kBAAmB,UAAW,YACnD,SAAU,WAAY,SAAU,aAAc,WAC9C,UAAW,aAAc,cAAe,SAAU,WAClD,aAAc,aAAc,SAAU,aAAc,WAAY,QAChE,SAAU,WAAY,aAAc,UAAW,OAAQ,WACvD,YAAa,aAAc,cAAe,aAAc,cACxD,QAAS,WAAY,cAAe,aAAc,WAClD,WAAY,OAAQ,YAAa,gBACjC,YAAa,SAAU,WAAY,WAAY,WAAY,aAC3D,cAAe,QAAS,OAAQ,UAAW,WAC3C,mBAAoB,aAAc,WAAY,OAAQ,QACtD,SAAU,OAAQ,QAAS,MAAO,QAAS,QAAS,QAAS,MAC7D,cAAe,cAAe,aAAc,SAC5C,WAAY,OAAQ,OAAQ,UAAW,WACvC,SAAU,eAAgB,gBAAiB,cAC3C,aAAc,aAAc,aAAc,SAAU,cACpD,SAAU,SAAU,YAAa,UAAW,WAC5C,cAAe,aAAc,gBAAiB,UAAW,WACzD,QAAS,QAAS,WAAY,QAAS,SAAU,OAAQ,SACzD,UAAW,QAAS,QAAS,QAAS,WAAY,WAAY,SAC9D,UAAW,OAAQ,SAAU,WAAY,OAAQ,SAAU,UAC3D,UAAW,UAAW,SAAU,QAAS,QACzC,YAAa,aAAc,OAAQ,QAAS,OAAQ,UAAW,SAC/D,QAAS,UAAW,OAAQ,OAAQ,UAAW,MAAO,QAAS,QAC/D,OAAQ,aAAc,OAAQ,UAAW,OAAQ,YAAa,SAC9D,UAAW,YAAa,UAAW,QAAS,QAAS,QACrD,aAAc,SAAU,UAAW,QAAS,UA5Q/B,CACb,QAAS,QAAS,SAAU,WAAY,aAAc,eACtD,cAAe,aAAc,aAAc,SAAU,WACrD,eAAgB,aAAc,WAAY,QAAS,aACnD,QAAS,MAAO,QAAS,QAAS,MAAO,YAAa,aACtD,SAAU,QAAS,QAAS,UAAW,OAAQ,aAAc,SAC7D,YAAa,UAAW,WAAY,YAAa,MAAO,SACxD,WAAY,QAAS,cAAe,aAAc,gBAClD,gBAAiB,WAAY,SAAU,eAAgB,KAAM,QAC7D,gBAAiB,gBAAiB,OAAQ,OAAQ,YAAa,QAC/D,SAAU,YAAa,cAAe,SAAU,SAAU,QAC1D,UAAW,OAAQ,SAAU,UAAW,SAAU,UAAW,UAC7D,UAAW,WAAY,UAAW,UAAW,KAAM,SACnD,YAAa,WAAY,aAAc,YAAa,UAAW,UAC/D,WAAY,QAAS,UAAW,WAAY,aAC5C,eAAgB,eAAgB,eAAgB,aAChD,cAAe,YAAa,UAAW,aAAc,YACrD,YAAa,YAAa,QAAS,cAAe,SAClD,aAAc,eAAgB,aAAc,cAC5C,cAAe,WAAY,aAAc,SAAU,OACnD,aAAc,WAAY,YAAa,eAAgB,OACvD,UAAW,QAAS,SAAU,OAAQ,cAAe,cACrD,SAAU,OAAQ,YAAa,cAAe,SAAU,WACxD,UAAW,aAAc,cAAe,aAAc,OAAQ,SAC9D,aAAc,OAAQ,aAAc,UAAW,cAC/C,cAAe,aAAc,cAAe,QAAS,YACrD,SAAU,MAAO,OAAQ,cAAe,WAAY,UAAW,SAC/D,SAAU,QAAS,UAAW,SAAU,UAAW,WAAY,QAC/D,cAAe,UAAW,UAAW,OAAQ,SAAU,aACvD,gBAAiB,WAAY,QAAS,gBAAiB,UACvD,cAAe,YAAa,SAAU,YAAa,aACnD,YAAa,UAAW,SAAU,WAAY,OAAQ,UACtD,UAAW,OAAQ,SAAU,UAAW,UAAW,QAAS,OAC5D,aAAc,OAAQ,SAAU,OAAQ,YAAa,SAAU,MAC/D,UAAW,SAAU,eAAgB,cAAe,YACpD,cAAe,aAAc,KAAM,eAAgB,aACnD,SAAU,gBAAiB,UAAW,aAAc,YACpD,SAAU,YAAa,UAAW,YAAa,aAC/C,YAAa,WAAY,OAAQ,SAAU,UAAW,OAAQ,OAC9D,SAAU,QAAS,SAAU,QAAS,OAAQ,OAAQ,UACtD,WAAY,YAAa,SAAU,OAAQ,OAAQ,WAAY,MAC/D,OAAQ,SAAU,WAAY,MAAO,UAAW,gBAChD,SAAU,QAAS,YAAa,SAAU,UAC1C,WAAY,YAAa,OAAQ,WAAY,OAAQ,SAAU,OAC/D,eAAgB,SAAU,YAAa,OAAQ,SAAU,SACzD,cAAe,UAAW,YAAa,QAAS,eAAgB,QAChE,OAAQ,SAAU,cAAe,MAAO,WAAY,QAAS,MAC7D,MAAO,UAAW,MAAO,WAAY,UACrC,cAAe,cAAe,cAAe,YAC7C,eAAgB,MAAO,QAAS,KAAM,KAAM,OAAQ,SAAU,OAC9D,SAAU,WAAY,aAAc,YAAa,MAAO,WACxD,UAAW,OAAQ,UAAW,SAAU,YAAa,WACrD,YAAa,YAAa,eAAgB,SAAU,OAAQ,YAC5D,YAAa,UAAW,cAAe,aAAc,YACrD,WAAY,SAAU,WAAY,cAAe,YACjD,gBAAiB,YAAa,aAAc,SAAU,aACtD,YAAa,WAAY,WAAY,WAAY,SAAU,UAC3D,UAAW,QAAS,WAAY,UAAW,SAAU,SACrD,UAAW,SAAU,aAAc,WAAY,aAC/C,aAAc,YAAa,aAAc,aAAc,eACvD,aAAc,eAAgB,cAAe,QAAS,UACtD,QAAS,SAAU,aAAc,QAAS,OAAQ,aAClD,aAAc,SAAU,WAAY,YAAa,SAAU,YAC3D,YAAa,WAAY,UAAW,UAAW,UAAW,WAC1D,gBAAiB,WAAY,YAAa,SAAU,iBACpD,QAAS,WAAY,WAAY,SAAU,QAAS,WAAY,KAChE,SAAU,SAAU,WAAY,UAAW,WAAY,YACvD,WAAY,YAAa,OAAQ,QAAS,eAAgB,WAC1D,UAAW,QAAS,WAAY,YAAa,WAAY,WACzD,aAAc,eAAgB,gBAAiB,eAC/C,WAAY,eAAgB,aAAc,OAAQ,SAClD,cAAe,WAAY,WAAY,aAAc,OAAQ,OAC7D,QAAS,aAAc,UAAW,YAAa,OAAQ,aACvD,SAAU,eAAgB,UAAW,aAAc,OAAQ,UAC3D,QAAS,WAAY,WAAY,UAAW,MAAO,UAAW,QAC9D,QAAS,YAAa,aAAc,QAAS,cAC7C,cAAe,WAAY,gBAAiB,KAAM,WAAY,UAC9D,UAAW,UAAW,cAAe,OAAQ,SAC7C,MAAO,SAAU,UAAW,SAAU,UAAW,OAAQ,OACzD,WAAY,aAAc,OAAQ,QAAS,UAAW,SAAU,MAChE,WAAY,SAAU,SAAU,SAAU,cAAe,YACzD,QAAS,QAAS,QAAS,SAAU,YAAa,OAnyBjC,CACjB,YAAa,WAAY,aAAc,YACvC,YAAa,UAAW,cAAe,WAAY,YACnD,iBAAkB,kBAAmB,cAAe,mBACpD,cAAe,WAAY,gBAAiB,aAAc,cAC1D,UAAW,eAAgB,QAAS,eAAgB,QAAS,UAC7D,cAAe,YAAa,aAAc,SAAU,YAAa,OACjE,cAAe,aAAc,YAAa,YAAa,cACvD,kBAAmB,iBAAkB,aAAc,cACnD,YAAa,MAAO,SAAU,WAAY,aAAc,aACxD,iBAAkB,eAAgB,SAAU,YAAa,UACzD,aAAc,aAAc,aAAc,WAAY,UACtD,SAAU,OAAQ,cAAe,aAAc,eAAgB,QAC/D,SAAU,SAAU,SAAU,SAAU,aACxC,cAAe,YAAa,SAAU,cAAe,aACrD,eAAgB,YAAa,WAAY,cAAe,YACxD,aAAc,aAAc,UAAW,YAAa,WACpD,WAAY,YAAa,UAAW,SAAU,SAAU,SACxD,UAAW,aAAc,SAAU,gBAAiB,gBACpD,UAAW,YAAa,aAAc,YAAa,YACnD,UAAW,cAAe,YAAa,SAAU,aACjD,eAAgB,eAAgB,gBAAiB,aACjD,YAAa,OAAQ,SAAU,aAAc,gBAC7C,WAAY,QAAS,SAAU,YAAa,SAC5C,eAAgB,SAAU,UAAW,WAAY,SAAU,WAC3D,UAAW,OAAQ,WAAY,QAAS,UAAW,cACnD,WAAY,aAAc,aAAc,cACxC,SAAU,cAAe,cAAe,aAAc,eACtD,cAAe,aAAc,UAAW,WAAY,cACpD,cAAe,UAAW,WAAY,cACtC,aAAc,YAAa,YAAa,cAAe,aACvD,WAAY,YAAa,SAAU,UAAW,QAAS,cACvD,UAAW,aAAc,QAAS,UAAW,iBAC7C,WAAY,SAAU,cAAe,SAAU,YAC/C,cAAe,WAAY,QAAS,UAAW,YAAa,SAC5D,OAAQ,QAAS,WAAY,UAAW,WAAY,UAAW,QAC/D,UAAW,QAAS,QAAS,UAAW,OAAQ,WAAY,UAC5D,WAAY,OAAQ,YAAa,YAAa,QAC9C,cAAe,UAAW,SAAU,YAAa,QAAS,OAC1D,YAAa,eAAgB,UAAW,OAAQ,UAAW,QAC3D,QAAS,QAAS,SAAU,QAAS,WAAY,WAAY,OAC7D,QAAS,QAAS,OAAQ,aAAc,WAAY,aACpD,SAAU,UAAW,QAAS,QAAS,UAAW,aAAc,QAChE,gBAAiB,WAAY,QAAS,OAAQ,UAAW,SACzD,WAAY,OAAQ,QAAS,QAAS,OAAQ,cAC9C,YAAa,QAAS,YAAa,SAAU,WAAY,UACzD,QAAS,OAAQ,SAAU,SAAU,WAAY,SACjD,SAAU,SAAU,YAAa,SAAU,QAAS,SAAU,QAC9D,QAAS,SAAU,QAAS,QAC5B,QAAS,QAAS,WAAY,QAAS,QAAS,SAAU,QAC1D,UAAW,SAAU,UAAW,aAAc,QAC9C,OAAQ,QAAS,SAAU,WAAY,SACvC,WAAY,SAAU,aAAc,aAAc,SAClD,gBAAiB,aAAc,UAAW,SAC1C,WAAY,SAAU,SAAU,UAAW,aAAc,eACzD,aAAc,WAAY,UAAW,UAAW,QAChD,UAAW,UAAW,UAAW,OAAQ,YAAa,QACtD,UAAW,UAAW,UAAW,gBAAiB,UAAW,QAC7D,QAAS,SAAU,aAAc,cAAe,UAAW,UAC3D,WAAY,SAAU,SAAU,QAAS,QAAS,eAClD,QAAS,QAAS,UAAW,YAAa,WAAY,QAAS,SAC/D,SAAU,aAAc,UAAW,OAAQ,SAC3C,eAAgB,aAAc,cAAe,WAAY,OACzD,WAAY,WAAY,UAAW,QAAS,UAAW,QACvD,UAAW,UAAW,YAAa,UAAW,OAAQ,WACtD,QAAS,SAAU,UAAW,UAAW,QACzC,aAAc,UAAW,aAAc,OAAQ,SAAU,SACzD,WAAY,QAAS,MAAO,WAAY,eAAgB,cACxD,QAAS,aAAc,UAAW,QAAS,YAAa,aACxD,cAAe,eAAgB,SAAU,WAAY,SACrD,aAAc,WAAY,YAAa,gBAAiB,UACxD,UAAW,WAAY,QAAS,WAAY,kBAC5C,aAAc,UAAW,YAAa,SAAU,WAAY,SAC5D,SAAU,QAAS,SAAU,SAAU,SAAU,SAAU,UAC3D,QAAS,YAAa,cAAe,SAAU,WAAY,SAC3D,aAAc,QAAS,aAAc,UAAW,SAAU,SAC1D,WAAY,aAAc,UAAW,UAAW,WAChD,eAAgB,gBAAiB,SAAU,WAAY,eACvD,YAAa,gBAAiB,SAAU,YAAa,UACrD,UAAW,WAAY,kBAAmB,aAAc,UACxD,SAAU,SAAU,UAAW,SAAU,WAAY,SACrD,UAAW,QAAS,SAAU,SAAU,WAAY,UACpD,YAAa,SAAU,SAAU,QAAS,QAAS,WACnD,UAAW,aAAc,QAAS,SAAU,QAAS,YACrD,QAAS,UAAW,eAAgB,QAAS,QAAS,iBACtD,YAAa,aAAc,cAAe,aAAc,WACxD,aAAc,WAAY,UAAW,aAAc,UAAW,UAC9D,eAAgB,WAAY,WAAY,SAAU,aAClD,WAAY,eAAgB,eAAgB,WAAY,YACxD,cAAe,gBAAiB,cAAe,cAC/C,aAAc,cAAe,iBAAkB,cAC/C,YAAa,aAAc,cAAe,cAC1C,gBAAiB,cAAe,eAAgB,cAChD,aAAc,cAAe,YAAa,eAAgB,cAC1D,gBAAiB,aAAc,YAAa,eAAgB,YAC5D,cAAe,YAAa,iBAAkB,cAAe,WAC7D,WAAY,WAAY,cAAe,cAAe,YACtD,aAAc,WAAY,cAAe,cAAe,cACxD,iBAAkB,gBAAiB,YAAa,iBAChD,aAAc,gBAAiB,cAAe,cAC9C,kBAAmB,YAAa,WAAY,eAC5C,gBAAiB,gBAAiB,iBAAkB,gBACpD,eAAgB,iBAAkB,gBAAiB,cACnD,gBAAiB,cAAe,gBAAiB,YACjD,eAAgB,WAAY,aAAc,YAAa,aACvD,cAAe,WAAY,WAAY,WAAY,aACnD,cAAe,YAAa,iBAAkB,aAAc,YAC5D,gBAAiB,eAAgB,WAAY,gBAC7C,eAAgB,cAAe,gBAAiB,cAChD,cAAe,UAAW,WAAY,QAAS,gBAC/C,eAAgB,SAAU,UAAW,OAAQ,aAAc,QAC3D,UAAW,eAAgB,cAAe,eAC1C,kBAAmB,iBAAkB,YAAa,cAClD,QAAS,WAAY,WAAY,UAAW,cAAe,WAC3D,eAAgB,cAAe,eAAgB,WAAY,WAC3D,YAAa,eAAgB,SAAU,UAAW,QAAS,WAC3D,UAAW,aAAc,SAAU,UAAW,YAAa,SAC3D,OAAQ,SAAU,SAAU,UAAW,SAAU,YACjD,eAAgB,WAAY,YAAa,gBAAiB,UAC1D,QAAS,QAAS,SAAU,WAC5B,aAAc,UAAW,YAAa,QAAS,UAAW,SAC1D,SAAU,UAAW,WAAY,OAAQ,QAAS,WAClD,YAAa,OAAQ,QAAS,cAAe,aAAc,WAC3D,YAAa,WAAY,YAAa,YAAa,UACnD,OAAQ,WAAY,SAAU,OAAQ,UAAW,UAAW,OAC5D,UAAW,SAAU,WAAY,UAAW,aAAc,QAC1D,YAAa,QAAS,YAAa,QAAS,OAC5C,YAAa,UAAW,QAAS,UAAW,SAAU,QACtD,SAAU,UAAW,YAAa,kBAAmB,YACrD,QAAS,eAAgB,WAAY,cAAe,YACpD,cAAe,QAAS,WAAY,UAAW,UAAW,WAC1D,YAAa,eAAgB,WAAY,cAAe,UACxD,SAAU,YAAa,cAAe,WAAY,aAClD,UAAW,cAAe,SAAU,iBAAkB,UACtD,YAAa,WAAY,cAAe,aAAc,cACtD,cAAe,WAAY,cAAe,SAAU,WACpD,WAAY,eAAgB,UAAW,YAAa,UACpD,UAAW,QAAS,WAAY,eAAgB,eAChD,UAAW,aAAc,aAAc,aAAc,iBACrD,eAAgB,UAAW,SAAU,YAAa,WAClD,YAAa,WAAY,UAAW,YAAa,eACjD,QAAS,cAAe,eAAgB,YAAa,WACrD,aAAc,UAAW,YAAa,aAAc,cACpD,YAAa,QAAS,eAAgB,gBAAiB,gBACvD,kBAAmB,cAAe,cAClC,YAAa,aAAc,cAAe,cAC1C,QAAS,cAAe,SACxB,QAAS,WAAY,aAAc,YAAa,WAAY,YAC5D,WAAY,cAAe,YAAa,eAAgB,aACxD,gBAAiB,YAAa,cAAe,QAAS,UACtD,YAAa,WAAY,UAAW,YAAa,gBACjD,iBAAkB,YAAa,OAAQ,UAAW,UAClD,aAAc,YAAa,SAAU,QAAS,QAAS,OAAQ,SAC/D,YAAa,YAAa,SAAU,SAAU,SAAU,WACxD,SAAU,UAAW,SAAU,UAAW,SAAU,WAAY,QAChE,WAAY,QAAS,OAAQ,YAAa,QAAS,SACnD,OAAQ,WAAY,WAAY,OAAQ,cAAe,SACvD,QAAS,QAAS,SAAU,YAAa,YAAa,aACtD,QAAS,WAAY,UAAW,aAAc,YAC9C,kBAAmB,UAAW,eAAgB,UAAW,OAAQ,OACjE,SAAU,YAAa,gBAAiB,cAAe,WACvD,YAAa,SAAU,SAAU,iBAAkB,YACnD,aAAc,cAAe,YAAa,WAAY,WACtD,UAAW,YAAa,YAAa,cAAe,aACpD,iBAAkB,aAAc,UAAW,eAAgB,OAC3D,UAAW,WAAY,eAAgB,cAAe,eACtD,YAAa,UAAW,YAAa,cAAe,iBACpD,cAAe,cAAe,WAAY,YAAa,gBACvD,UAAW,YAAa,eAAgB,YAAa,WACrD,aAAc,SAAU,YAAa,YAAa,cAAe,OACjE,SAAU,UAAW,SAAU,WAAY,iBAAkB,UAC7D,YAAa,SAAU,QAAS,cAAe,WAAY,SAC3D,WAAY,QAAS,aAAc,eAAgB,WAAY,QAC/D,cAAe,aAAc,WAAY,YAAa,cACtD,aAAc,UAAW,aAAc,YACvC,cAAe,WAAY,SAAU,aAAc,QACnD,aAAc,eAAgB,cAAe,eAAgB,WAC7D,cAAe,cAAe,aAAc,UAAW,eACvD,gBAAiB,eAAgB,aAAc,aAAc,UAC7D,YAAa,cAAe,aAAc,UAAW,WACrD,SAAU,WAAY,OAAQ,UAAW,QACzC,aAAc,WAAY,YAAa,UAAW,QAAS,YAC3D,WAAY,aAAc,SAAU,QAAS,QAAS,WACtD,OAAQ,YAAa,QAAS,UAAW,WAAY,QACrD,WAAY,QAAS,OAAQ,SAAU,aAAc,UAAW,QAChE,WAAY,QAAS,WAAY,aAAc,YAAa,QAC5D,WAAY,QAAS,OAAQ,OAAQ,YAAa,SAClD,YAAa,SAAU,SAAU,WAAY,SAAU,YACvD,SAAU,UAAW,QAAS,aAAc,QAAS,UACrD,SAAU,WAAY,WAAY,QAAS,UAAW,WACtD,eAAgB,QAAS,YAAa,QAAS,SAC/C,OAAQ,WAAY,YAAa,OAAQ,QAAS,WAAY,QAC9D,SAAU,UAAW,QAAS,WAAY,QAAS,SAAU,UAC7D,gBAAiB,QAAS,UAAW,SAAU,SAAU,SACzD,UAAW,QAAS,SAAU,OAAQ,UAAW,OAAQ,QACzD,QAAS,aAAc,QAAS,QAAS,WAAY,YACrD,SAAU,YAAa,aAAc,UAAW,QAAS,aACzD,UAAW,QAAS,WAAY,WAAY,SAAU,UACtD,cAAe,WAAY,YAAa,YAAa,SACrD,aAAc,aAAc,SAAU,WAAY,cAClD,UAAW,UAAW,UAAW,cAAe,QAAS,SACzD,SAAU,eAAgB,QAAS,YAAa,WAChD,eAAgB,QAAS,WAAY,OAAQ,aAAc,OAC3D,UAAW,QAAS,YAAa,UAAW,YAAa,QACzD,UAAW,OAAQ,UAAW,UAAW,QAAS,QAClD,aAAc,QAAS,QAAS,UAAW,cAAe,QAC1D,SAAU,SAAU,YAAa,cAAe,WAChD,SAAU,SAAU,QAAS,OAAQ,UAAW,UAAW,WAC3D,iBAAkB,SAAU,UAAW,SAAU,QAAS,OAC1D,OAAQ,OAAQ,QAAS,WAAY,aAAc,QACnD,cAAe,cAAe,YAAa,SAAU,SACrD,YAAa,SAAU,eAAgB,eAAgB,eACvD,SAAU,WAAY,SAAU,UAAW,SAAU,YACrD,cAAe,SAAU,QAAS,QAAS,SAAU,QAAS,QAC9D,YAAa,UAAW,SAAU,UAAW,aAAc,SAC3D,aAAc,UAAW,SAAU,YAAa,aAAc,SAC9D,SAAU,UAAW,OAAQ,OAAQ,OAAQ,WAC7C,SAAU,QAAS,QAAS,QAAS,SAAU,WAAY,UAC3D,YAAa,QAAS,cAAe,cAAe,WACpD,YAAa,YAAa,QAAS,WACnC,OAAQ,UAAW,YAAa,YAAa,eAAgB,QAC7D,cAAe,UAAW,WAAY,SAAU,WAAY,QAC5D,UAAW,QAAS,UAAW,cAAe,SAAU,QACxD,UAAW,QAAS,QAAS,YAAa,SAAU,cACpD,aAAc,QAAS,WAAY,QAAS,QAAS,OAAQ,QAC7D,aAAc,YAAa,OAAQ,UAAW,UAAW,QACzD,QAAS,WAAY,YAAa,QAAS,WAAY,YACvD,UAAW,QAAS,QAAS,WAAY,QAAS,UAAW,SAC7D,YAAa,QAAS,SAAU,QAChC,aAAc,SAAU,WAAY,aAAc,SAAU,UAC5D,UAAW,WAAY,QAAS,aAAc,UAAW,QACzD,YAAa,aAAc,OAAQ,QAAS,SAAU,QACtD,kBAAmB,aAAc,aAAc,MAC/C,aAAc,YAAa,gBAAiB,YAC5C,SAAU,eAAgB,eAAgB,UAC1C,kBAAmB,eAAgB,cAAe,UAClD,cAAe,gBAAiB,eAAgB,cAChD,aAAc,SAAU,aAAc,YAAa,aACnD,UAAW,YAAa,gBAAiB,cAAe,aACxD,UAAW,cAAe,cAAe,aAAc,eACvD,aAAc,aAAc,aAAc,cAC1C,QAAS,kBAAmB,cAAe,cAAe,cAC1D,aAAc,WAAY,aAAc,OACxC,cAAe,SAAU,YAAa,UAAW,aACjD,WAAY,UAAW,WAAY,cAAe,aAClD,eAAgB,gBAAiB,YAAa,YAAa,aAC3D,eAAgB,eAAgB,cAAe,cAAe,UAC9D,aAAc,UAAW,eAAgB,cAAe,gBACxD,gBAAiB,cAAe,aAAc,UAAW,eACzD,YAAa,aAAc,gBAAiB,YAC5C,kBAAmB,YAAa,gBAAiB,aACjD,gBAAiB,YAAa,aAAc,iBAC5C,gBAAiB,cAAe,YAAa,cAC7C,eAAgB,UAAW,QAAS,UAAW,aAAc,SAC7D,QAAS,MAAO,UAAW,QAAS,OAAQ,YAAa,SACzD,QAAS,OAAQ,cAAe,OAAQ,SAAU,QAClD,cAAe,cAAe,WAAY,WAAY,OACtD,aAAc,SAAU,SAAU,SAAU,QAAS,YACrD,QAAS,SAAU,gBAAiB,WAAY,iBAChD,YAAa,OAAQ,QAAS,UAAW,aACzC,QAAS,WAAY,QAAS,SAAU,WAAY,OAAQ,QAC5D,SAAU,SAAU,aAAc,SAAU,eAAgB,UAC5D,OAAQ,QAAS,UAAW,QAAS,QACrC,WAAY,YAAa,YAAa,QAAS,aAAc,QAC7D,YAAa,OAAQ,UAAW,SAAU,QAAS,UAAW,SAC9D,YAAa,WAAY,QAAS,OAAQ,WAAY,UACtD,SAAU,UAAW,UAAW,cAAe,QAAS,WACxD,UAAW,QAAS,QAAS,YAAa,WAC1C,SAAU,WAAY,QAAS,WAAY,UAAW,eACtD,eAAgB,OAAQ,WAAY,SAAU,UAAW,OACzD,UAAW,UAAW,SAAU,WAAY,cAAe,YAC3D,YAAa,WAAY,OAAQ,aAAc,YAAa,QAC5D,YAAa,SAAU,cAAe,QAAS,QAAS,cACxD,SAAU,UAAW,QAAS,QAAS,QAAS,OAAQ,UACxD,YAAa,WAAY,QAAS,aAAc,cAAe,SAC/D,UAAW,SAAU,QAAS,UAAW,QAAS,QAAS,UAC3D,SAAU,YAAa,QAAS,SAAU,QAAS,OAAQ,QAC3D,QAAS,QAAS,UAAW,SAAU,YAAa,QAAS,OAC7D,YAAa,OAAQ,UAAW,QAAS,WAAY,SACrD,cAAe,WAAY,YAAa,SAAU,cAClD,aAAc,QAAS,YAAa,cAAe,eACnD,aAAc,UAAW,QAAS,UAAW,QAC7C,cAAe,WAAY,WAAY,gBAAiB,UACxD,iBAAkB,cAAe,OAAQ,YACzC,UAAW,UAAW,UAAW,aAAc,eAC/C,UAAW,QAAS,YAAa,QAAS,SAC1C,UAAW,UAAW,YAAa,QAAS,cAAe,QAC3D,UAAW,WAAY,SAAU,OAAQ,QAAS,WAAY,QAC9D,YAAa,eAAgB,WAAY,QAAS,YAClD,aAAc,SAAU,QAAS,cAAe,YAChD,cAAe,WAAY,WAAY,UAAW,cAClD,UAAW,YAAa,WAAY,QAAS,WAC7C,UAAW,QAAS,YAAa,UAAW,UAAW,SACvD,WAAY,SAAU,SAAU,YAAa,gBAAiB,UAC9D,SAAU,OAAQ,UAAW,YAAa,SAAU,aACpD,QAAS,QAAS,QAClB,QAAS,WAAY,SAAU,QAAS,WAAY,UACpD,YAAa,aAAc,UAAW,WACtC,UAAW,WAAY,WAAY,WAAY,WAAY,QAC3D,WAAY,UAAW,aAAc,OAAQ,QAC7C,gBAAiB,UAAW,UAAW,UAAW,SAAU,WAC5D,UAAW,QAAS,aAAc,WAAY,SAAU,YACxD,QAAS,QAAS,aAAc,SAAU,WAAY,YACtD,UAAW,UAAW,cAAe,UACrC,cAAe,YAAa,SAAU,YAAa,SACnD,YAAa,QAAS,SAAU,OAAQ,OAAQ,UAChD,UAAW,QAAS,WAAY,YAAa,YAAa,QAC1D,QAAS,QAAS,aAAc,YAAa,UAC7C,UAAW,cAAe,cAAe,QAAS,UAAW,QAC7D,YAAa,WAAY,eAAgB,iBAAkB,aAC3D,SAAU,QAAS,OAAQ,WAAY,OAAQ,cAC/C,aAAc,SAAU,aAAc,SAAU,SAAU,cAC1D,WAAY,YAAa,QAAS,UAAW,QAAS,SAAU,QAChE,YAAa,QAAS,UAAW,UAAW,YAAa,SACzD,YAAa,UAAW,YAAa,SAAU,WAAY,aAC3D,OAAQ,YAAa,aAAc,aAAc,UACjD,cAAe,eAAgB,YAAa,aAAc,YAC1D,YAAa,cAAe,cAAe,SAAU,WAAY,OACjE,WAAY,YAAa,SAAU,WAAY,UAC/C,YAAa,YAAa,OAAQ,SAAU,WAAY,SACxD,aAAc,YAAa,WAAY,YAAa,gBACpD,YAAa,cAAe,YAAa,UAAW,UACpD,aAAc,SAAU,gBAAiB,aAAc,SACvD,eAAgB,YAAa,UAAW,YAAa,WACrD,UAAW,UAAW,UAAW,WAAY,WAAY,UACzD,WAAY,YAAa,WAAY,QAAS,SAAU,aACxD,UAAW,QAAS,WAAY,UAAW,QAAS,OAAQ,QAC5D,QAAS,WAAY,YAAa,SAAU,QAAS,UAAW,QAChE,SAAU,SAAU,OAAQ,QAAS,SAAU,UAAW,aAC1D,YAAa,aAAc,UAAW,WAAY,WAAY,QAC9D,cAAe,eAAgB,iBAAkB,UAAW,WAC5D,eAAgB,QAAS,WAAY,aAAc,SAAU,WAC7D,WAAY,YAAa,YAAa,UAAW,QAAS,UAC1D,UAAW,QAAS,WAAY,YAAa,WAAY,UACzD,UAAW,WAAY,SAAU,WAAY,OAAQ,SAAU,QAC/D,WAAY,QAAS,YAAa,UAAW,UAAW,OACxD,WAAY,SAAU,UAAW,UAAW,cAC5C,cAAe,eAAgB,UAAW,cAAe,UACzD,gBAAiB,aAAc,eAAgB,YAAa,UAC5D,OAAQ,SAAU,YAAa,eAAgB,eAAgB,SAC/D,gBAAiB,gBAAiB,cAAe,SAAU,UAC3D,aAAc,UAAW,SAAU,QAAS,WAAY,SACxD,OAAQ,QAAS,QAAS,SAAU,QAAS,OAAQ,WACrD,YAAa,QAAS,UAAW,UAAW,SAAU,OACtD,aAAc,SAAU,SAAU,UAAW,YAAa,QAC1D,SAAU,WAAY,SAAU,YAAa,UAAW,QACxD,QAAS,YAAa,UAAW,QAAS,QAAS,OAAQ,UAC3D,QAAS,WAAY,QAAS,SAAU,UAAW,QAAS,SAC5D,YAAa,WAAY,cAAe,WAAY,QACpD,aAAc,QAAS,QAAS,OAAQ,eAAgB,cACxD,aAAc,WAAY,YAAa,QAAS,YAChD,YAAa,cAAe,gBAAiB,UAAW,QACxD,WAAY,aAAc,OAAQ,SAAU,YAAa,UACzD,SAAU,YAAa,gBAAiB,UAAW,UACnD,aAAc,aAAc,YAAa,eAAgB,cACzD,cAAe,cAAe,aAAc,WAAY,WACxD,eAAgB,gBAAiB,YAAa,gBAC9C,WAAY,gBAAiB,eAAgB,aAAc,UAC3D,YAAa,cAAe,cAAe,QAAS,SAAU,SAC9D,UAAW,UAAW,aAAc,aAAc,aAClD,WAAY,YAAa,SAAU,aAAc,UACjD,YAAa,iBAAkB,aAAc,SAAU,gBACvD,SAAU,WAAY,aAAc,cAAe,WACnD,YAAa,cAAe,aAAc,YAAa,WACvD,cAAe,iBAAkB,WAAY,gBAC7C,cAAe,aAAc,WAAY,UAAW,aACpD,eAAgB,WAAY,aAAc,cAAe,WACzD,WAAY,aAAc,SAAU,cAAe,aACnD,cAAe,YAAa,eAAgB,eAC5C,cAAe,YAAa,eAAgB,cAAe,WAC3D,aAAc,WAAY,YAAa,YAAa,aACpD,eAAgB,gBAAiB,eAAgB,cACjD,UAAW,cAAe,OAAQ,QAAS,SAAU,QAAS,UAC9D,cAAe,QAAS,SAAU,YAAa,UAAW,WAC1D,WAAY,SAAU,UAAW,iBAAkB,YACnD,aAAc,WAAY,SAAU,UAAW,iBAC/C,YAAa,SAAU,SAAU,SAAU,aAAc,SACzD,QAAS,UAAW,SAAU,aAC9B,SAAU,QAAS,QAAS,QAAS,WAAY,QAAS,UAC1D,SAAU,WAAY,QAAS,QAAS,UAAW,SACnD,OAAQ,OAAQ,UAAW,YAAa,UAAW,WACnD,YAAa,eAAgB,SAAU,QAAS,aAAc,UAC9D,aAAc,SAAU,WAAY,YAAa,aACjD,aAAc,UAAW,aAAc,eACvC,kBAAmB,kBAAmB,aAAc,UACpD,aAAc,eAAgB,WAAY,aAC1C,WAAY,aAAc,cAAe,cAAe,UACxD,WAAY,UAAW,UAAW,UAClC,YAAa,gBAAiB,UAAW,cAAe,aACxD,kBAAmB,SAAU,aAAc,YAAa,gBACxD,YAAa,WAAY,aAAc,gBAAiB,UACxD,YAAa,aAAc,UAAW,UAAW,WACjD,YAAa,WAAY,UAAW,QAAS,UAAW,UACxD,eAAgB,UAAW,YAAa,aAAc,UACtD,kBAAmB,kBAAmB,gBAAiB,YACvD,cAAe,WAAY,eAAgB,UAAW,cACtD,aAAc,eAAgB,WAAY,aAAc,YACxD,WAAY,eAAgB,cAAe,cAAe,UAC1D,YAAa,WAAY,YAAa,mBAAoB,cAC1D,eAAgB,aAAc,eAAgB,QAAS,UACvD,UAAW,cAAe,WAAY,UAAW,cACjD,WAAY,WAAY,WAAY,UAAW,YAAa,WAC5D,cAAe,UAAW,YAAa,UAAW,QAAS,QAC3D,SAAU,SAAU,QAAS,QAAS,QAAS,QAAS,UACxD,SAAU,SAAU,QAAS,YAAa,SAAU,UAAW,QAC/D,OAAQ,QAAS,QAAS,WAAY,QAAS,QAAS,QACxD,QAAS,QAAS,YAAa,SAAU,SAAU,WAAY,OAC/D,UAAW,YAAa,UAAW,QAAS,QAAS,UACrD,UAAW,UAAW,WAAY,OAAQ,SAAU,aACpD,WAAY,WAAY,UAAW,QAAS,SAAU,QAAS,SAC/D,WAAY,QAAS,QAAS,UAAW,YAAa,QACtD,aAAc,aAAc,gBAAiB,YAAa,SAC1D,UAAW,OAAQ,SAAU,WAAY,SAAU,YACnD,SAAU,YAAa,UAAW,WAAY,eAAgB,UAC9D,WAAY,aAAc,SAAU,SAAU,YAAa,UAC3D,aAAc,UAAW,SAAU,UAAW,aAC9C,aAAc,QAAS,WAAY,OAAQ,UAAW,QACtD,UAAW,cAAe,UAAW,WAAY,UACjD,aAAc,QAAS,UAAW,WAAY,aAAc,SAC5D,WAAY,WAAY,aAAc,SAAU,gBAChD,YAAa,aAAc,cAAe,aAAc,YACxD,SAAU,WAAY,WAAY,WAAY,SAAU,OACxD,WAAY,cAAe,WAAY,SACvC,UAAW,SAAU,SAAU,SAAU,eAAgB,SACzD,QAAS,SAAU,SAAU,WAAY,UAAW,SACpD,YAAa,QAAS,SAAU,SAAU,QAAS,YACnD,SAAU,YAAa,QAAS,SAAU,YAAa,QACvD,YAAa,SAAU,UAAW,QAAS,WAAY,QAAS,QAChE,SAAU,UAAW,aAAc,gBAAiB,QAAS,WAC7D,QAAS,SAAU,eAAgB,cAAe,UAAW,WAC7D,UAAW,OAAQ,OAAQ,QAAS,aAAc,QAClD,WAAY,QAAS,UAAW,SAAU,QAAS,SAAU,OAC7D,SAAU,SAAU,SAAU,SAC9B,UAAW,SAAU,QAAS,cAAe,SAAU,SACvD,SAAU,WAAY,SAAU,QAAS,QAAS,UAClD,YAAa,QAAS,YAAa,QAAS,WAAY,aACxD,eAAgB,SAAU,QAAS,YAAa,QAAS,OACzD,QAAS,QAAS,SAAU,QAAS,UACrC,gBAAiB,SAAU,QAAS,QAAS,WAAY,cACzD,UAAW,iBAAkB,YAAa,aAAc,aACxD,UAAW,eAAgB,WAAY,SAAU,YAAa,SAC9D,YAAa,UAAW,SAAU,UAAW,QAAS,SAAU,QAChE,UAAW,SAAU,SAAU,YAAa,eAAgB,WAC5D,eAAgB,SAAU,SAAU,aAAc,QAAS,UAC3D,UAAW,UAAW,SAAU,UAAW,cAAe,WAC1D,SAAU,SAAU,SAAU,SAAU,SAAU,SAAU,UAC5D,YAAa,SAAU,QAAS,SAAU,aAAc,SACxD,WAAY,aAAc,UAAW,SAAU,QAAS,SACxD,SAAU,QAAS,QAAS,cAAe,SAAU,UACrD,SAAU,WAAY,SAAU,QAAS,WAAY,SACrD,UAAW,SAAU,UAAW,UAAW,YAAa,aACxD,UAAW,UAAW,YAAa,WAAY,YAAa,UAC5D,UAAW,SAAU,UAAW,aAAc,YAAa,WAC3D,UAAW,UAAW,SAAU,SAAU,WAAY,cACtD,cAAe,gBAAiB,YAAa,aAC7C,cAAe,gBAAiB,UAAW,YAAa,cACxD,aAAc,aAAc,SAAU,cACtC,SAAU,QAAS,YAAa,UAAW,UAAW,OAAQ,UAC9D,OAAQ,eAAgB,eAAgB,cAAe,cACvD,WAAY,aAAc,WAAY,WAAY,WAClD,YAAa,SAAU,UAAW,YAAa,gBAC/C,UAAW,YAAa,YAAa,WAAY,cACjD,aAAc,WAAY,SAAU,YAAa,QAAS,SAC1D,WAAY,SAAU,UAAW,aAAc,WAAY,YAC3D,YAAa,UAAW,UAAW,SAAU,UAAW,UACxD,UAAW,OAAQ,QAAS,UAAW,QAAS,QAAS,QACzD,QAAS,OAAQ,UAAW,QAAS,SAAU,QAAS,QACxD,YAAa,WAAY,YAAa,QAAS,QAAS,OACxD,aAAc,eAAgB,YAAa,QAAS,QACpD,aAAc,cAAe,eAAgB,UAAW,UACxD,aAAc,SAAU,WAAY,QAAS,UAAW,YACxD,QAAS,WAAY,cACrB,cAAe,WAAY,QAAS,YAAa,QACjD,WAAY,SAAU,WAAY,SAAU,SAAU,aACtD,WAAY,YAAa,aAAc,SAAU,UAAW,SAC5D,YAAa,SAAU,WAAY,UAAW,UAAW,aACzD,UAAW,SAAU,YAAa,UAAW,QAAS,OAAQ,UAC9D,QAAS,UAAW,OAAQ,OAAQ,UAAW,SAAU,WACzD,SAAU,OAAQ,UAAW,aAAc,QAAS,WACpD,YAAa,QAAS,UAAW,WAAY,SAAU,OAAQ,QAC/D,SAAU,OAAQ,YAAa,SAAU,UAAW,WACpD,WAAY,cAAe,QAAS,SAAU,SAAU,QAAS,OACjE,SAAU,SAAU,aAAc,SAAU,WAAY,aACxD,WAAY,YAAa,WAAY,SAAU,WAAY,YAC3D,SAAU,SAAU,eAAgB,cAAe,YACnD,kBAAmB,cAAe,WAAY,eAC9C,gBAAiB,iBAAkB,kBAAmB,aACtD,QAAS,UAAW,aAAc,UAAW,YAAa,WAC1D,aAAc,QAAS,SAAU,SAAU,SAAU,YACrD,WAAY,SAAU,QAAS,WAAY,QAAS,QAAS,WAC7D,SAAU,WAAY,WAAY,WAAY,SAAU,WACxD,SAAU,SAAU,WAAY,QAAS,WAAY,WACrD,QAAS,UAAW,WAAY,YAAa,QAAS,MACtD,SAAU,QAAS,QAAS,YAAa,gBAAiB,SAC1D,iBAAkB,iBAAkB,aAAc,gBAClD,WAAY,SAAU,UAAW,QAAS,YAAa,eACvD,UAAW,WAAY,SAAU,QAAS,OAAQ,YAClD,YAAa,UAAW,aAAc,UAAW,SAAU,OAC3D,YAAa,aAAc,YAAa,aAAc,WACtD,QAAS,WAAY,SAAU,WAAY,SAAU,WACrD,UAAW,WAAY,QAAS,YAAa,SAC7C,UAAW,aAAc,QAAS,YAAa,WAAY,aAC3D,YAAa,UAAW,UAAW,QAAS,UAAW,WACvD,SAAU,WAAY,SAAU,UAAW,aAAc,QACzD,UAAW,kBAAmB,QAAS,UAAW,QAAS,QAC3D,QAAS,QAAS,aAAc,WAAY,WAAY,WACxD,WAAY,WAAY,SAAU,WAAY,SAC9C,UAAW,SAAU,QAAS,OAAQ,aAAc,UACpD,WAAY,OAAQ,WAAY,WAAY,aAC5C,QAAS,WAAY,QAAS,UAAW,WAAY,WACrD,aAAc,QAAS,QAAS,QAAS,SAAU,WACnD,SAAU,SAAU,SAAU,YAAa,gBAC3C,QAAS,UAAW,QAAS,QAAS,QAAS,UAAW,OAC1D,UAAW,QAAS,UAAW,SAAU,cAAe,YACxD,OAAQ,UAAW,QAAS,QAAS,QAAS,UAAW,aACzD,WAAY,aAAc,QAAS,YAAa,SAAU,QAC1D,UAAW,SAAU,WAAY,SAAU,SAAU,SAAU,SAC/D,UAAW,WAAY,SAAU,QAAS,QAAS,UACnD,aAAc,SAAU,UAqgBrB,SAASC,KASZ,IA8BezhB,EAAYnK,EAWR6rB,EAzCfC,EAAW,GAQX,IAAK,IAAMC,KAAYJ,GAAY,CAQ/BG,IAyBWD,EAhCgBF,GAAWI,KAqB/B5hB,EAYM,EAZMnK,EAYH6rB,EAAI/uC,OAAS,EAX9B7F,KAAKgG,MAAMhG,KAAKsyC,UAAYvpB,EAAMmK,EAAM,IAAMA,IAZrD,OAAO2hB,EC59BX,IAAME,GAAc,CAClBh3C,KAAM42C,MAKKK,GAAU,IAAI91C,IAC3B81C,GAAQn5B,IAAI,YAAY,SAACo5B,GAAD,OAAoB,eAAC,GAAD,6BAAiBA,GAAWF,QACxEC,GAAQn5B,IAAI,OAAO,SAACo5B,GAAD,OAAoB,eAAC,GAAD,OAEhC,IAAMC,GAAwE,SAACD,GACpF,OAAO,gBAACE,GAAA,EAAD,6BAAYF,GAAZ,IAAmBltB,KAAMiX,GAAUn6B,OACxCw/B,QAAS4Q,EAAM5Q,QAAS+Q,SAAS,KAAKC,WAAW,EAAOC,YAAY,EAD/D,UAENtW,GAAU5H,MACT,eAACme,GAAA,EAAD,CAAat6B,GAAG,sBAAsBu6B,mBAAmB,EAAMrqB,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OAAzG,SAAkH2/B,GAAU5H,aAC1HtiB,EACHmgC,EAAMQ,cAIIC,GAAiC,SAACT,GAC7C,SAASrmB,IACgB,UAAnBoQ,GAAUjiB,MACZiiB,GAAUjjB,QAId,OAAO,eAAC,KAAD,UACL,WACE,OAAIijB,GAAUjiB,KACRi4B,GAAQld,IAAIkH,GAAUjiB,MACjBi4B,GAAQl3C,IAAIkhC,GAAUjiB,KAAtBi4B,CAA6BC,GAE7B,gBAAC,GAAD,CAAkB5Q,QAAS,WAAQzV,KAAnC,UACL,eAACqlB,GAAA,EAAD,CAAe9oB,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OAAzD,SAAkE2/B,GAAUtW,UACxD,UAAnBsW,GAAUjiB,KACT,gBAAC44B,GAAA,EAAD,CAAKC,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAvB,UACA,eAAC3B,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAM,UAAU6X,MAAO,CAACkpB,cAAc,OAAQH,SAAS70C,IAAiB,QAAU,OAC5Gm1C,QAAS,WAAQ5lB,KADnB,SAEG7nB,GAAE,aAHL,OAKA,eAACotC,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAM,YAAY6X,MAAO,CAACkpB,cAAc,OAAQH,SAAS70C,IAAiB,QAAU,OAC9Gm1C,QAAS,WACPxV,GAAUmS,eAAe9Z,IAAI2H,GAAUjiB,MACvC6R,KAHJ,SAKG7nB,GAAE,yBAGL+N,KAKD,mCAIb4gC,GAAYjB,YAAc,cCC1B,IACIsB,IAAqB,EAErBC,GAAkB,GAYf,SAASC,KACd,OAAOD,GAIF,IAAME,GAAiC,SAACjB,GAC7C,IAAO35B,EAAgB25B,EAAMjgB,OAAtB1Z,aACP,EAAwB66B,oBAAS76B,EAAaI,MAAMvF,YAAYhD,MAAhE,mBAAOA,EAAP,KAAaijC,EAAb,KACMC,EAAYh9B,eAAeK,QAAQ,QACzC,EAA4By8B,qBAAS,GAArC,mBAAOG,EAAP,KAAeC,EAAf,KAEMC,EAAUvB,EAAMjgB,OAAOjzB,IACzB00C,EAAU9sB,OAAOvsB,EAAcW,MAAMkH,MAAM,KAC3Cc,EAAOb,OAAM,OAACuxC,QAAD,IAACA,OAAD,EAACA,EAAS5wC,QAAU,EACjC6wC,EAAY,GAEbxxC,OAAM,OAACuxC,QAAD,IAACA,OAAD,EAACA,EAAS5wC,QAAU,IAC3B6wC,EAAY/sB,OAAOvsB,EAAcW,MAAMkH,MAAM,KAAK,IAGpD,MAAwBkxC,oBAAS/4C,EAAcW,KAAO04C,EAAQ1wC,GAAO,IAArE,mBAAOhI,EAAP,KAAa44C,EAAb,KAEA,EAA8BR,oBAAS,CAACxsB,OAAOjX,OAAOuiC,GAAOl3C,QAA7D,mBAAO64C,EAAP,KAAgBC,EAAhB,KACMC,EAAoBF,EAAQ,GAClC,EAAsCT,oBAASW,EAAkBtwC,MAAM,EAAG,IAA1E,mBAAOuwC,EAAP,KAAoBC,EAApB,KACA,EAAgDb,oBAAS,GAAzD,mBAAOc,EAAP,KAAyBC,EAAzB,KAcAtD,sBAAU,WAIR,IAAsB,IADFx1C,OAAOC,SAASC,KAAKqpB,QAAQ,OACxB,CACvB,IAAIwvB,EAAQ/4C,OAAOC,SAASC,KAAK2G,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGA,MAAM,KAAK,GAZ1EmxC,EAaqBe,IAXC,IADF/4C,OAAOC,SAASC,KAAKqpB,QAAQ,WAE/CyvB,IAYF,IAAM7C,EAAY,SAAZA,EAAahzC,GACdA,EAAE81C,SACQ,UAAV91C,EAAEyF,MACH5I,OAAOk5C,oBAAoB,UAAW/C,GACtC6C,MAIJ,GADAh5C,OAAOywB,iBAAiB,UAAW0lB,GACvB,KAATx2C,EAAH,CAGA,IAAMw5C,EAAO9oB,YAAW,WAGpB,GAFA+oB,aAAaD,GACbP,EAAeF,EAAkBtwC,MAAM,EAAGywC,IACtCA,EAAmB,EAAIH,EAAkBjxC,OAAQ,CACnD2xC,aAAaD,GACX,IAAME,EAAQhpB,YAAW,WACvB+oB,aAAaC,GACbP,EAAoB,GACrBL,EAAW,CAAClC,SACX,UAEFuC,EAAoBD,EAAmB,KAE5C,IACH,OAAO,WACL74C,OAAOk5C,oBAAoB,UAAW/C,GACtCiD,aAAaD,QAQjB,IAsDMH,EAAe,WACnBb,GAAU,GACV,IAAMmB,EAASjpB,YAAW,WAExB+oB,aAAaE,GAGb,IAAIC,EAAWt4C,IAAiB,CAAC,EAAE,EAAE,GAAK,CAAC,EAAE,EAAE,GACzCu4C,GAAgB,IAAI72C,WAAa82C,UAAUF,EAAS,GAAIA,EAAS,GAAIA,EAAS,IACpFnB,EAAQvG,UAAU2H,GAClBpB,EAAQtG,mBAAmB0H,GAC3B,IAAME,EAAkBrpB,YAAW,WACjC+oB,aAAaM,GACbC,MACC,MApES,SAACC,GAEXA,IACI18B,EAAaI,MAAMvF,YAAYhD,OAASA,GAAgD,cAAxCmI,EAAaI,MAAMvF,YAAYhD,MACjF6iC,GAAW,IACD7iC,EACVmI,EAAaI,MAAMvF,YAAYhD,KAAOA,EACtCmI,EAAaI,MAAMvF,YAAY5C,aAAe,GAC9C+H,EAAaI,MAAM2hB,kBACnB/hB,EAAaI,MAAMu8B,0BAAyB,IAE5CjC,GAAW,IAEA,KAATj4C,GACFX,EAAcW,KAAO64C,EAAQ,GAC1BP,IAAct4C,GACfsb,eAAeE,QAAQ,OAAQq9B,EAAQ,IAEzCD,EAAQC,EAAQ,MAEhBx5C,EAAcW,KAAOA,EAClBs4C,IAAct4C,GACfsb,eAAeE,QAAQ,OAAQxb,GAEjC44C,EAAQ54C,KAMF,KAATA,EACgB,KAAd24C,EACDt4C,OAAO85C,QAAQC,aAAa,GAAI,OAAS,UAAYp6C,GAErDK,OAAO85C,QAAQC,aAAa,GAAI,OAAS,IAAMzB,EAAY,UAAY34C,GAGxD,KAAd24C,EACDt4C,OAAO85C,QAAQC,aAAa,GAAI,OAAS,UAAYvB,EAAQ,IAE7Dx4C,OAAO85C,QAAQC,aAAa,GAAI,OAAS,IAAMzB,EAAY,UAAYE,EAAQ,IAMnF,IAAMwB,EAAY3pB,YAAW,WAC3B+oB,aAAaY,GACDr6C,EACZg4C,IAAa,EACb/W,GAAUjjB,UACV,IAkBAsoB,EAAQ,KACR,MAEJ,SAAS0T,IACP,IAAI7Y,GAAgB,EAChBmZ,EAAe,EACfC,EAAe,EACbrkB,EAAU/C,MAAMnT,KAAKzC,EAAaG,OAAO9I,QAAQye,QAAO,SAAApqB,GAAG,OAAIA,IAAQsU,EAAaW,WAC1F,GAAGgY,EAAQpuB,OAAS,EAAG,CAAC,IAAD,gBACHouB,EAAQskB,WADL,IACrB,2BAAqC,CAAC,IAAD,IAAzB3yC,EAAyB,0BAC/B2R,EAAUrS,OAAM,UAACoW,EAAaG,OAAO3d,IAAIm2B,EAAQruB,WAAjC,aAAC,EAAqCzC,KAAKH,SAAS,IACpEwU,EAAUtS,OAAM,UAACoW,EAAaG,OAAO3d,IAAIm2B,EAAQruB,WAAjC,aAAC,EAAqCzC,KAAKH,SAAS,IAGxE,GAFAq1C,EAAQnzC,OAAOlF,KAAKsyC,SAAWkE,EAAQx8B,WAAW,IAAM,GACxDs+B,EAAQpzC,OAAOlF,KAAKsyC,SAAWkE,EAAQx8B,WAAW,IAAM,GACrDq+B,GAAU9gC,EAAQ,IAAO8gC,GAAU9gC,EAAQ,IAAO+gC,GAAU9gC,EAAQ,IAAO8gC,GAAU9gC,EAAQ,GAE9F,YADAugC,IAGGxgC,IAAY,IAAMA,GAAU,IAAMC,IAAY,IAAMA,GAAW,KAChE0nB,GAAQ,IAXO,oCAiBrBsX,EAAQgC,SAAS,CAAChC,EAAQx8B,WAAW,GAAG,EAAGw8B,EAAQx8B,WAAW,GAAG,IACjEsB,EAAaI,MAAMvY,KAAKH,SAAW0P,OAAO+D,OAAO,GAAI+/B,EAAQvvB,YAG5DiY,GACDsX,EAAQgC,SAAS,CAACH,EAAOC,IACzBh9B,EAAaI,MAAMvY,KAAKH,SAAW0P,OAAO+D,OAAO,GAAI+/B,EAAQvvB,YAG7DuvB,EAAQiC,QAAQn9B,EAAaI,SAI7B86B,EAAQgC,SAAS,CAAChC,EAAQx8B,WAAW,GAAG,EAAGw8B,EAAQx8B,WAAW,GAAG,IACjEsB,EAAaI,MAAMvY,KAAKH,SAAW0P,OAAO+D,OAAO,GAAI+/B,EAAQvvB,aAKjE,MAAkB9f,KAAXJ,EAAP,EAAOA,EAAGG,EAAV,EAAUA,KACJwxC,EAAW,CAACxE,SAAU70C,IAAiB,QAAU,MACrDM,OAAQN,IAAiB,MAAQ,QAASiU,MAAO,QAASipB,gBAAiB,QAASoc,QAAS,MAAOj5C,MAAOL,IAAiB,SAAW,QACnIu5C,EAAW,CAAC1E,SAAU70C,IAAiB,QAAU,MAAMiU,MAAO,QAASqlC,QAAQ,kBAAmBE,WAAW,QAC7GC,EAAY,CAAC5E,SAAU70C,IAAiB,QAAU,MAAMiU,MAAO,QAASqlC,QAAQ,kBAAmBE,WAAW,WAEpH,OAAO,eAAC,GAAD,CAAkBxU,QAAS,WAAKrF,GAAUjjB,SAA1C,SACL,gBAACk4B,GAAA,EAAD,CAAeO,QAAS,kBAAM8B,EAAStX,GAAUjjB,QAAU,IAAIoP,MAAOmrB,EAAS,CAACyC,UAAW,SAAUC,UAAU,SAAUzc,gBAAiB,UAAW2X,SAAU70C,IAAiB,MAAQ,MAAO45C,WAAY,iBAAmB,CAACF,UAAW,SAAUC,UAAU,SAAUzc,gBAAiB,UAAW2X,SAAU70C,IAAiB,MAAQ,MAAO45C,WAAY,eAA1V,UACE,oBAAG9tB,MAAO,CAAC+tB,UAAU,QAAS5lC,MAAO,QAAS4gC,SAAU70C,IAAiB,QAAU,OAAnF,2BACA,eAAC80C,GAAA,EAAD,CAAQhpB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,GAAIgtB,MAAM,GAAIC,QAAQ,QAAS5E,QAAW,WACjF,IAAMjP,GAAO9yB,GAAkB6Z,WAAU,SAAAuT,GAAC,OAAIA,IAAM34B,EAAKmyC,YAAY,GAAK5mC,GAAkB5M,OAC5FqB,EAAKoyC,eAAe7mC,GAAkB8yB,KAFxC,SAIE,eAAC,KAAD,MAEF,uBAEA,sBAAKpa,MAAOmrB,EAAS,CAACtzC,SAAU,WAAYtD,MAAM,QAAS05C,QAAQ,QAAU,CAACp2C,SAAU,WAAYtD,MAAM,QAAS05C,QAAQ,WAC3H,sBAAKjuB,MAAOmrB,EAAS,CAACtzC,SAAU,WAAYmpB,IAAK,MAAmBzsB,MAAO,OAAQw5C,UAAU,SAAUvyB,QAAQ,IAAK4yB,UAAW,cAAeN,WAAY,gBAAiB7tB,KAAM/rB,IAAiB,SAAW,OAAS,CAAC2D,SAAU,WAAYmpB,IAAK,MAAOzsB,MAAO,OAAQw5C,UAAU,SAAU9tB,KAAM/rB,IAAiB,SAAW,OAA9T,SACE,sBAAK8rB,MAAO,CAACzrB,MAAM,OAAQ85C,WAAW,QAASC,WAAW,EAAO3hC,IAAK4hC,GACtEC,IAAI,OAGN,sBAAKxuB,MAAOmrB,EAAS,CAACtzC,SAAU,WAAYmpB,IAAK,QAASzsB,MAAO,OAAQw5C,UAAU,SAAUE,QAAQ,QAAU,CAACp2C,SAAU,WAAYmpB,IAAK,QAASzsB,MAAO,OAAQw5C,UAAU,UAA7K,SACE,sBAAK/tB,MAAO,CAACzrB,MAAM,OAAQ85C,WAAW,QAAS1hC,IAAK8hC,GAAaH,WAAW,EAAOE,IAAI,OAEzF,wBACA,eAAChE,GAAA,EAAD,CAAKC,GAAI,EAAT,SACA,uBAAKzqB,MAAOmrB,EAAS,CAACtzC,SAAU,WAAYmpB,IAAK,QAASzsB,MAAO,OAAQw5C,UAAU,SAAUE,QAAQ,QAAU,CAACp2C,SAAU,WAAYmpB,IAAK,QAASzsB,MAAO,OAAQw5C,UAAU,UAA7K,UACE,gBAACW,GAAA,EAAD,CAAY1uB,MAAO2tB,EAAnB,cAAgC/xC,EAAE,YAAlC,OACA,eAAC+yC,GAAA,EAAD,CAAO9uB,MAAO7X,EAAMmhC,WAAW,EAAMyF,kBAAkB,EAAMC,WAAY,CAAC7uB,MAAOutB,GAAWuB,SAAU,SAAArmB,GAAK,OAAKwiB,EAAQxiB,EAAMsmB,OAAOlvB,eAGvI,eAAC2qB,GAAA,EAAD,CAAKC,GAAI,EAAT,SACA,uBAAKzqB,MAAOmrB,EAAS,CAACtzC,SAAU,WAAYmpB,IAAK,QAASzsB,MAAO,OAAQw5C,UAAU,SAAUE,QAAQ,QAAU,CAACp2C,SAAU,WAAYmpB,IAAK,QAASzsB,MAAO,OAAQw5C,UAAU,UAA7K,UACE,gBAACW,GAAA,EAAD,CAAY1uB,MAAOytB,EAAnB,cAA+B7xC,EAAE,SAAjC,OACA,eAAC+yC,GAAA,EAAD,CAAO9uB,MAAOjtB,EAAMu2C,WAAW,EAAOyF,kBAAkB,EAAMhD,YAAaA,EAAaiD,WAAY,CAAC7uB,MAAOutB,GAAWuB,SAAU,SAAArmB,GAAK,OAAK+iB,EAAQ/iB,EAAMsmB,OAAOlvB,eAGlK,eAAC2qB,GAAA,EAAD,CAAKC,GAAI,EAAT,SACA,sBAAKzqB,MAAOmrB,EAAS,CAACtzC,SAAU,WAAYmpB,IAAK9sB,IAAiB,UAAY,QAASK,MAAO,OAAQw5C,UAAU,SAAUE,QAAQ,QAAU,CAACp2C,SAAU,WAAYmpB,IAAI9sB,IAAiB,UAAY,QAASK,MAAO,OAAQw5C,UAAU,UAAtO,SACE,sBAAK/tB,MAAO,CAACzrB,MAAM,MAAO85C,WAAW,QAAS1hC,IAAKqiC,GAAOV,WAAW,EAAOjF,QAAS,kBAAM4C,KAAgBuC,IAAI,SAGjH,eAAChE,GAAA,EAAD,CAAKC,GAAI,EAAT,SACA,sBAAKzqB,MAAOmrB,EAAS,CAACtzC,SAAU,WAAYmpB,IAAK9sB,IAAiB,QAAU,QAASK,MAAO,OAAQC,OAAQ,OAAQu5C,UAAU,SAAUE,QAAQ,SAAW,CAACp2C,SAAU,WAAYmpB,IAAK9sB,IAAiB,QAAU,QAASK,MAAO,OAAQw5C,UAAU,UAApP,SACE,sBAAK/tB,MAAO,CAACzrB,MAAML,IAAiB,QAAU,MAAOm6C,WAAW,QAAS1hC,IAAKsiC,GAASX,WAAW,EAAOE,IAAI,eAMrHzD,GAAYzB,YAAc,c,oQCxYpB4F,GAAM,GACNC,GAAoC,SAACrF,GACzC,OAAO,eAACsF,GAAA,EAAD,CAAMC,WAAW,EAAMC,QAAS,EAAhC,SAAmC,eAACC,GAAA,EAAD,CAAQ1vB,MAAOiqB,EAAMjqB,MAAOkI,IAAK,EAAGnK,IAAKsxB,GACnF7kC,OAAO,EAAOmlC,kBAAkB,OAAO,kBAAgB,oBAAoBxvB,MAAO,CAACzrB,MAAM,KACzFu6C,SAAU,SAAC5rB,EAAIzqB,GAAL,OAAaqxC,EAAM2F,SAASh3C,IAAgBi3C,iBAAkB,SAAA/4C,GAAC,OAAIA,IAAMu4C,GAAM,SAAMv4C,EAAEyE,iBAItFu0C,GAA4C,SAAC7F,GACxD,IAAM5W,EAAW4W,EAAM5W,SACjB3iB,EAAQu5B,EAAM35B,aAAaI,MAC3B1K,EAAa+pC,cAAY,kBAAMr/B,EAAMZ,oBACrC7J,EAAa8pC,cAAY,kBAAMr/B,EAAMX,oBACrCigC,EAAc,eAAC,GAAD,CAAUhwB,MAAOha,GAAc,EAAIA,EAAaqpC,GAClEO,SAAU,SAAC94C,GACT4Z,EAAMZ,iBAAmBhZ,IAAMu4C,IAAO,EAAIv4C,KAExCm5C,EAAc,eAAC,GAAD,CAAUjwB,MAAO/Z,GAAc,EAAIA,EAAaopC,GAClEO,SAAU,SAAC94C,GACT4Z,EAAMX,iBAAmBjZ,IAAMu4C,IAAO,EAAIv4C,KAG9C,OAAO,uCACP,eAACo5C,GAAA,EAAD,CACEC,QAASH,EACTI,MAAOr0C,GAAE,gBAEX,eAACm0C,GAAA,EAAD,CACEC,QAASF,EACTG,MAAOr0C,GAAE,gBACT,wBACF,eAACotC,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAO+qB,EAASgd,YAAc,UAAY,UAClElwB,MAAO,CAACkpB,cAAc,QAASiH,UAAWjd,EAASgd,YACnD7G,QAAY,WACNnW,EAASgd,aACXnkB,GAAW0S,eAAezF,KAAKoX,gBAAgB,GAAI,CAAC7/B,EAAMZ,iBAAkBY,EAAMX,oBAJ1F,6BAUF+/B,GAAwBrG,YAAc,0BC7B/B,IAAM+G,GAAkD,SAACvG,GAC9D,MAAkCwG,KAAMtF,SAAS,IAAjD,mBAAOuF,EAAP,KAAkBC,EAAlB,KACA,EAA4CF,KAAMtF,UAAS,GAA3D,mBAAOyF,EAAP,KAAuBC,EAAvB,KACA,EAA8CJ,KAAMtF,UAAS,GAA7D,mBAAO2F,EAAP,KAAwBC,EAAxB,KACMC,EAAaP,KAAMQ,OAA0B,MAC7CC,EAAcT,KAAMQ,OAA0B,MAC7C5d,EAAY4W,EAAMjgB,OAAlBqJ,SAEP,OAAO,eAAC,KAAD,UAAW,WAChB,IAAM8d,EAAch2C,EAAYk4B,EAAS/B,gBAAkB,QAAU,QAC/D8f,EAAej2C,EAAYk4B,EAAS9B,iBAAmB,QAAU,QACjE8f,EAAWhe,EAASgd,YAAc,UAAY,UAEpD,OAAQ,gBAAC1F,GAAA,EAAD,CAAKzmB,EAAG,EAAR,UACN,eAACymB,GAAA,EAAD,CAAKzmB,EAAG,EAAR,SACE,eAAC,GAAD,gBAAsD+lB,EAAMjgB,QAA/B,wBAE/B,gBAAC2gB,GAAA,EAAD,CAAKC,GAAI,EAAGC,GAAI,EAAhB,UACE,eAACyG,GAAA,EAAD,CAAWhI,WAAS,EAAC8G,MAAM,iBAAiBr+B,KAAK,WAAWoO,MAAO,CAACoxB,WAAW,IAC7EvxB,MAAK,OAAEqT,QAAF,IAAEA,OAAF,EAAEA,EAAUme,SAAUvC,SAAU,SAAC5rB,GAAOgQ,EAASme,SAASnuB,EAAGouB,cAAczxB,OAChF0xB,WAAY,SAACruB,GAAD,OA1BtB,SAAoBA,EAAwBgQ,GAC1C,GAAe,UAAXhQ,EAAGrnB,IAAiB,CACtB,IAAI21C,EAAOte,EAAShC,UAAUv+B,IAAI,YAClCugC,EAASgd,YAAchd,EAASme,YAAcG,GAAc,KAuBpCD,CAAWruB,EAAIgQ,MAHrC,SAKE,eAAC8V,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAM,UAAU6X,MAAO,CAACkpB,cAAc,QAASG,QAAS,WAClF,IAAImI,EAAOte,EAAShC,UAAUv+B,IAAI,YAC7B6+C,IAAOA,EAAO,IACnBte,EAASgd,aAAsB,OAARhd,QAAQ,IAARA,OAAA,EAAAA,EAAUme,YAAaG,GAHhD,qBALF,SAUGte,EAASgd,YAAc,KAAM,iBAEhC,gBAAC1F,GAAA,EAAD,CAAKC,GAAI,EAAGC,GAAI,EAAhB,UACE,eAACyG,GAAA,EAAD,CAAWlB,MAAM,yBAAyBr+B,KAAK,OAAOoO,MAAO,CAACoxB,WAAW,IACvEvxB,MAAK,OAAEqT,QAAF,IAAEA,OAAF,EAAEA,EAAUue,YAAa3C,SAAU,SAAC5rB,GAAMgQ,EAASue,YAAYvuB,EAAGouB,cAAczxB,SAFzF,SAIE,eAACmpB,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAO+oC,EAAUf,UAAWjd,EAASgd,YAAalwB,MAAO,CAACkpB,cAAc,QAClGG,QAAS,WACHnW,EAASgd,aACXnkB,GAAW0S,eAAeiT,YAAY,WAAYxe,EAASue,cAHjE,+BAJF,YAWA,gBAACjH,GAAA,EAAD,CAAKC,GAAI,EAAT,UACE,eAACzB,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAO+oC,EAAUlxB,MAAO,CAACkpB,cAAc,QACjEiH,UAAWjd,EAASgd,YAAa7G,QAAS,WACtCnW,EAASgd,aAAenkB,GAAW0S,eAAehM,YAAY3d,GAAYrB,YAAY,IAF5F,+BADF,QAKE,eAACu1B,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAO+oC,EAAUlxB,MAAO,CAACkpB,cAAc,QACjEiH,UAAWjd,EAASgd,YAAa7G,QAAS,WACtCnW,EAASgd,aAAenkB,GAAW0S,eAAehM,YAAY3d,GAAYrB,YAAY,IAF5F,+BALF,SASE,eAACu1B,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAO+oC,EAAUlxB,MAAO,CAACkpB,cAAc,QACjEiH,UAAWjd,EAASgd,YAAa7G,QAAS,WACtCnW,EAASgd,aAAenkB,GAAW0S,eAAehM,YAAY3d,GAAYpB,YAAY,IAF5F,6BATF,OAaE,eAACs1B,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAO+oC,EAAUlxB,MAAO,CAACkpB,cAAc,QACjEiH,UAAWjd,EAASgd,YAAa7G,QAAS,WACtCnW,EAASgd,aAAenkB,GAAW0S,eAAehM,YAAY3d,GAAYpB,YAAY,IAF5F,qCAKF,gBAAC82B,GAAA,EAAD,CAAKC,GAAI,EAAT,UACE,eAACzB,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAO+oC,EAAUlxB,MAAO,CAACkpB,cAAc,QACjEiH,UAAWjd,EAASgd,YAAa7G,QAAS,WACtCnW,EAASgd,aACX9jB,GAASulB,qBAHb,mCADF,SAOE,eAAC3I,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAO+oC,EAAUlxB,MAAO,CAACkpB,cAAc,QACjEiH,UAAWjd,EAASgd,YAAa7G,QAAS,WACxC,GAAInW,EAASgd,YAAY,CACvB,IAAM7c,EAAM,IAAIhiB,IAAI+a,GAAS0I,iBAAiBttB,QAC9C4kB,GAASC,IAAIr1B,SAAQ,SAAA9B,GAAC,OAAIm+B,EAAInH,IAAIh3B,EAAE4a,OACpCsc,GAASC,IAAIpG,QAAO,SAAA/wB,GAAC,OAAIA,EAAEslB,YAAc+1B,KAAWv5C,SAAQ,SAAA9B,GAAC,OAAIk3B,GAASmT,cAAcrqC,EAAE4a,SALhG,2CAPF,UAeE,eAACqhC,GAAA,EAAD,CAAWlB,MAAM,OAAOr+B,KAAK,OAAOoO,MAAO,CAACoxB,WAAW,IACnDvxB,MAAO0wB,EAAWzB,SAAU,SAAC5rB,GAAMstB,EAAattB,EAAGouB,cAAczxB,aAEvE,gBAAC2qB,GAAA,EAAD,CAAKC,GAAI,EAAT,UACE,eAACzB,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAO+oC,EAAUlxB,MAAO,CAACkpB,cAAc,QACjEiH,UAAWjd,EAASgd,YAAa7G,QAAS,WACtCnW,EAASgd,aACPnkB,GAAW2a,mBACb3a,GAAW0S,eAAexH,4BAA4BniB,GAAYlB,eAAgB,KAJxF,sBADF,SAUE,eAACo1B,GAAA,EAAD,CAAQC,QAAQ,YAAYkH,UAAWjd,EAASgd,YAC9ClwB,MAAOkT,EAASgd,YACd,CAAC9e,gBAAgBl2B,EAAUg4B,EAAS/B,gBAAiBhpB,MAAM6oC,EAAa9H,cAAc,QACpF,CAACA,cAAc,QACnBG,QAAS,WAASnW,EAASgd,aAAcQ,GAAkB,IAAU3mC,IAAK8mC,EAJ5E,wBAMA,eAACe,GAAA,EAAD,CAASh1B,KAAM6zB,EACbvX,QAAS,WACPwX,GAAkB,GAClB3kB,GAAW0S,eAAeiT,YAAY,iBAAkBrjC,KAAKC,UAAU4kB,EAAS/B,kBAElF0gB,SAAUhB,EAAW9P,QAAS+Q,aAAc,CAACC,SAAS,SAAUC,WAAW,SAL7E,SAME,eAAC,KAAD,CAAc7pC,MAAS,CAAC5M,EAAE23B,EAAS/B,eAAe,GAAIh2B,EAAE+3B,EAAS/B,eAAe,GAC9Et9B,EAAEq/B,EAAS/B,eAAe,IAAK8gB,cAAY,EAC3CnD,SAAU,SAAC3mC,EAAOsgB,GAChBA,EAAMmgB,iBACN1V,EAAS/B,eAAiB,CAAChpB,EAAMpN,IAAIQ,EAAG4M,EAAMpN,IAAII,EAAGgN,EAAMpN,IAAIlH,QA1BvE,OA+BE,eAACm1C,GAAA,EAAD,CAAQC,QAAQ,YAAYkH,UAAWjd,EAASgd,YAC9ClwB,MAAOkT,EAASgd,YACd,CAAC9e,gBAAgBl2B,EAAUg4B,EAAS9B,iBAAkBjpB,MAAM8oC,EAAc/H,cAAc,QACtF,CAACA,cAAc,QACnBG,QAAS,WAASnW,EAASgd,aAAcU,GAAmB,IAAU7mC,IAAKgnC,EAJ7E,2BAMA,eAACa,GAAA,EAAD,CAASh1B,KAAM+zB,EACbzX,QAAS,WACP0X,GAAmB,GACnB7kB,GAAW0S,eAAeiT,YAAY,kBAAmBrjC,KAAKC,UAAU4kB,EAAS9B,mBAEnFygB,SAAUd,EAAYhQ,QAAS+Q,aAAc,CAACC,SAAS,SAAUC,WAAW,SAL9E,SAME,eAAC,KAAD,CAAc7pC,MAAS,CAAC5M,EAAE23B,EAAS9B,gBAAgB,GAAIj2B,EAAE+3B,EAAS9B,gBAAgB,GAChFv9B,EAAEq/B,EAAS9B,gBAAgB,IAAK6gB,cAAY,EAC5CnD,SAAU,SAAC3mC,EAAOsgB,GAChBA,EAAMmgB,iBACN1V,EAAS9B,gBAAkB,CAACjpB,EAAMpN,IAAIQ,EAAG4M,EAAMpN,IAAII,EAAGgN,EAAMpN,IAAIlH,QA/CxE,OAmDE,eAACm1C,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAO+oC,EAAUlxB,MAAO,CAACkpB,cAAc,QACjEiH,UAAWjd,EAASgd,YAAa7G,QAAS,WACtCnW,EAASgd,cACXhd,EAAS/B,eAAiB+B,EAASlC,sBACnCkC,EAAS9B,gBAAkB8B,EAASjC,uBACpClF,GAAW0S,eAAeiT,YAAY,iBAAkBrjC,KAAKC,UAAU4kB,EAAS/B,iBAChFpF,GAAW0S,eAAeiT,YAAY,kBAAmBrjC,KAAKC,UAAU4kB,EAAS9B,oBANrF,uBAnDF,mB,uECxFA8gB,GAAYC,aAAW,CAC3BC,KAAM,CACJ5E,QAAS,GAEX6E,iBAAkB,CAChBtJ,SAAU70C,IAAiB,QAAU,SAI5Bo+C,GAAsC,SAACxI,GAClD,IAAMv5B,EAAQu5B,EAAMjgB,OAAO1Z,aAAaI,MAClCgiC,EAAUL,KACVM,EAAuB,eAAC,KAAD,UAAY,kBACvC,eAACC,GAAA,EAAD,CACE9e,KAAM,eAAC,KAAD,CAA2B+e,UAAU,gBAC3CC,YAAa,eAAC,KAAD,CAAc3yB,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OAAQw+C,UAAU,UACvFE,UAAWL,EAAQH,KACnBS,QAAStiC,EAAMlF,QAAQxC,QAASb,KAAK,YACrC8mC,SAAU,SAAArmB,GAAK,OAAIlY,EAAMuiC,WAAW,CAACjqC,QAAS4f,EAAMsmB,OAAO8D,gBAExDj3C,EAAKI,KAALJ,EAEP,OAAO,gBAACm3C,GAAA,EAAD,WACL,sBAAK/yB,MAAO,CAACzrB,MAAM,OAAQC,OAAO,QAAS48B,gBAAgB,UAAWsc,WAAW,WACjF,eAACqC,GAAA,EAAD,CAAkB/vB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAOf,KAAM,QAAS8oB,SAAS70C,IAAiB,MAAQ,OACzG87C,QAASwC,EACTvC,MAAO,eAAC+C,GAAA,EAAD,CAAYJ,UAAWL,EAAQF,iBAA/B,SAAkDz2C,EAAE,4BAIjE02C,GAAiBhJ,YAAc,mB,wBCjCxB,SAAS2J,GAAkBC,EAAoCC,GACpE,MAAO,CACLC,YADK,SACOlwB,GAAsB,IAAD,EAE3B,UAAGA,EAAGmwB,YAAoBC,0BAA1B,OAAE,EAA4CC,mBAC5CJ,EAAOx2B,UACT0vB,aAAa8G,EAAOx2B,SACpBw2B,EAAOx2B,aAAUhT,GAEnBupC,GAAY,KAGhBpc,WAXK,SAWM5T,GAELiwB,EAAOx2B,SACT0vB,aAAa8G,EAAOx2B,SAEtBw2B,EAAOx2B,QAAU2G,YAAW,WAC1B4vB,GAAY,GACZC,EAAOx2B,aAAUhT,IACS,OAmB3B,IAAM6pC,GAAwC,SAAC1J,GAKpD,OAAO,eAAC2J,GAAA,EAAD,CAAMC,GAAI5J,EAAMpwC,KAAMsmB,MAAO8pB,EAAM9pB,MAAnC,SACL,eAAC2zB,GAAA,EAAD,CAAYf,UAAW9I,EAAM8I,UAAWzqC,MAAO2hC,EAAM3hC,MAAOkhC,QAL1C,SAAC5gB,GACfqhB,EAAM8J,aAAe9J,EAAM8J,YAAYnrB,IAKzC9vB,KAAM,QAASoR,IAAK+/B,EAAM+J,UAD5B,SAIC,sBAAKlnC,IC5DK,ihED4DUpY,MAAOL,IAAiB,GAAK,GAAIM,OAAQN,IAAiB,GAAK,GAAIo6C,WAAW,EAAOE,IAAI,U,oBErD5G0D,GAAYC,cAAW,SAAC2B,GAC5B,MAAQ,CACNzE,UAAW,CACTpB,QAAQ,eACRP,WAAYoG,EAAMxE,QAAQ,GAC1ByE,YAAaD,EAAMxE,QAAQ,GAC3B8B,UAAW0C,EAAMxE,QAAQ,GACzB0E,aAAcF,EAAMxE,QAAQ,GAC5B2E,cAAe,YA+ERC,GAAgC,SAACpK,GAC5C,IAAMyI,EAAUL,KAChB,EAAgClH,qBAAkB,GAAlD,mBAAiBkI,GAAjB,WAEMC,EADYrC,kBAAyB,CAACn0B,aAAQhT,IAC3Bo3B,QAErBoT,EAAS,GASb,YAPmBxqC,IAAhBmgC,EAAMxM,QAAwC,IAAjBwM,EAAMsK,SACpCD,EAAWrK,EAAMxM,MAAM,EAAI,GAAO,GAAO,KAMpC,iDAAKsV,UAAWL,EAAQlD,WAAavF,EAAM8I,UAAN,WAAsB9I,EAAM8I,WAAc,IACpF5yB,MAAO8pB,EAAM9pB,MAAOjW,IAAK+/B,EAAMuK,QAC3BpB,GAAkBC,EAAaC,IAF9B,cAIL,eAACmB,GAAA,EAAD,CAAKt0B,MAAO,CAACxrB,OAAOs1C,EAAMnxC,KAAMpE,MAAMu1C,EAAMnxC,MAC1C0wC,QAAW,SAACnmB,GAAa4mB,EAAMT,SAAWS,EAAMT,QAAQnmB,IACxDqxB,YAAe,SAACrxB,GAAa4mB,EAAM0K,QAAU1K,EAAM0K,OAAOtxB,IAC1DuxB,aAAgB,SAACvxB,GAAa4mB,EAAM0K,QAAU1K,EAAM0K,OAAOtxB,IAC3DwxB,cAAe,SAACxxB,GACdA,EAAG0lB,iBACCkB,EAAM8J,aAAe9J,EAAM8J,YAAY1wB,IAE7C/a,MAAS2hC,EAAM3hC,MAAOwsC,QAAW,SAACv+C,GAAO,IAAD,EAAE,QAAC,EAAAA,EAAE24C,cAAH,SAA2B1uB,QARvE,SASGypB,EAAMQ,WAERR,EAAM8J,YAAc,eAAC,GAAD,CAAY5zB,MAAO9rB,IAAiB41C,EAAMsK,OAAS,CAACv8C,SAAS,WAAYmpB,KAAK,IAAkBf,MAAM,GAAmB8zB,aAAa,GAA0Bv4B,QAAS,GAAKsyB,WAAY,gBAAiB8G,gBAAiBT,GAAW,CAACt8C,SAAS,WAAYmpB,KAAK,GAAiBf,MAAM,GAAmB8zB,aAAa,GAA0Bv4B,QAAS,EAAGsyB,WAAY,gBAAiB8G,gBAAgB,MAAQ9K,EAAMsK,OAAS,CAACv8C,SAAS,WAAYmpB,KAAK,GAAiBf,MAAM,GAAmB8zB,aAAa,GAA0Bv4B,QAAQ,GAAKsyB,WAAY,gBAAiB8G,gBAAiBT,GAAU,CAACt8C,SAAS,WAAYmpB,KAAK,GAAiBf,MAAM,GAAmB8zB,aAAa,GAA0Bv4B,QAAQ,EAAGsyB,WAAY,gBAAiB8G,gBAAgB,MACvvBl7C,MAAM,EAAMyO,MAAO2hC,EAAM3hC,MAAOuqC,UAAW5I,EAAM4I,UAAWmC,UAAW/K,EAAM+K,UACnGjB,YAAe9J,EAAM8J,mBAChBjqC,OAIImrC,GAAuC,SAAChL,GACnD,OAAIA,EAAM7d,MACD,eAAC8oB,GAAA,EAAD,CAASC,UAAU,YAAYC,OAAO,EAC7ChpB,MAAO6d,EAAM7d,MADN,SAEP,uBAAMjM,MAAO,CAACk1B,WAAW,IAAzB,SACE,eAAC,GAAD,gBAAapL,QAIV,eAAC,GAAD,gBAAaA,K,oBC5IP,giCCAA,ovC,qBCGR,SAASqL,GAAmB5jC,GACjC,IAAMiM,EAAQjM,EAAKzX,MAAM,KAGzB,OAFA1G,EAAOoqB,EAAM9iB,QAAU,GAEhB,uCAAG8iB,EAAM,GAAIA,EAAM,GACxB,uCAAE,kCAASA,EAAM,GAAG1qB,OAAO,EAAG,KAAa0qB,EAAM,GAAG1qB,OAAO,WAAS6W,K,ICEpE0b,GACA+vB,GACAC,GACAC,G,oBCISC,GAAgD,SAACzL,GAC5D,IACEnW,EAOEmW,EAPFnW,KACApiB,EAMEu4B,EANFv4B,KACAikC,EAKE1L,EALF0L,MACAC,EAIE3L,EAJF2L,SACAC,EAGE5L,EAHF4L,IACAC,EAEE7L,EAFF6L,MACAtM,EACES,EADFT,QAEIuM,EAASrkC,EAAO4jC,GAAmB5jC,QAAQ5H,EAC3Co/B,EAAW70C,IAAiB,QAAU,MAEtC2hD,EAAO,gBAACC,GAAA,EAAD,CAAUC,QAAQ,EAAMJ,MAAOA,EAAOtM,QAASA,EAASrpB,MAAO,CAACg2B,WAAW,SAA3E,UACVriB,EAAO,eAACsiB,GAAA,EAAD,CAAgBj2B,MAAO,CAAC+oB,SAAUA,EAAUv0C,OAAOu0C,GAAnD,SAA+DpV,SACpEhqB,EACH,uBAAKqW,MAAO,CAAC+oB,SAAU70C,IAAiB,QAAU,QAASgiD,cAAe,UAA1E,UACGN,GAAkBJ,EAClBC,EAAW,uCAAE,wBAAMA,UAAe9rC,QAIvC,OAAO+rC,EAAM,eAACX,GAAA,EAAD,CAAS9oB,MAAOypB,EAAKV,UAAU,UAAUmB,WAAY,IAArD,SAA4DN,IAAkBA,G,UDzBzFO,GAAe,GAEfC,IAAc,EAClB,SAASC,GAAS/hD,EAAcC,EAC9B+hD,EAA6BC,GACxBjiD,IAAOA,EAAQ,KACfC,IAAQA,EAAS,KAEtB+hD,EAASv2B,MAAMzrB,MAAf,UAA0BA,EAA1B,MACAgiD,EAASv2B,MAAMxrB,OAAf,UAA2BA,EAA3B,MAEA+hD,EAAShiD,MAAQA,EACjBgiD,EAAS/hD,OAASA,EACb8gD,KACHA,GAAcriD,OAAO0sB,SAASC,cAAc,WAE9C01B,GAAY/gD,MAAQA,EACpB+gD,GAAY9gD,OAASA,EACrB,IAAMyyC,EAAMqO,GAAYpO,WAAW,MACnC,GAAKD,EAAL,CAkBA,GAjBAA,EAAIwP,YAActmC,GAAaI,MAAM+B,WAAW,GAChD20B,EAAIyP,UAAY,EAChBzP,EAAI0P,QAAU,QACd1P,EAAI2P,SAAS,EAAG,EAAGriD,EAAOC,GACtB2b,GAAaI,MAAMvF,YAAY9C,YAAcmtC,MAC/CA,GAAU,IAAInoC,OACNG,OAAS,WACfgpC,IAAc,GAEhBhB,GAAQwB,YAAc,YACtBxB,GAAQ1oC,IAAMwD,GAAaI,MAAMvF,YAAY9C,YAE1CiI,GAAaI,MAAMvF,YAAY9C,WAAamtC,KAC/CA,GAAQyB,SACRT,IAAc,EACdhB,QAAU1rC,GAER0sC,IAAehB,GACfpO,EAAI8P,UAAU1B,GAAS,EAAG,EAAGA,GAAQ9gD,MAAO8gD,GAAQ7gD,OAAQ,EAAE,EAAGD,EAAOC,OACvE,CACH,IAAMwiD,EAAY7mC,GAAaI,MAAMvF,YAAYhD,KAAKlO,MAAM,KACxDm9C,EAAU,GACdD,EAAUhgD,SAAQ,SAAAN,GAAC,OAAIugD,GAAWvgD,EAAIA,EAAEmgB,UAAU,EAAE,GAAK,MACzDogC,EAAUA,EAAQpgC,UAAU,EAAE,GAC9BowB,EAAIQ,UAAY/rC,EAAKyU,GAAaI,MAAM2mC,kBAAmB,IAC3DjQ,EAAIkQ,KAAJ,UAAc,GAAM3iD,EAApB,WACAyyC,EAAI8G,UAAY,SAChB9G,EAAImQ,aAAe,SACnBnQ,EAAIoQ,SAASJ,EAAS,GAAI1iD,EAAO,GAAIC,EAAQ,GAAID,GACjD0yC,EAAIQ,UAAYt3B,GAAaI,MAAM+B,WAAW,GAM5CkkC,IAAMJ,GAAMI,EAAKc,UAAUC,WAC/B,IAAMC,EAAQ,CAACpB,GAAI/6C,MAAM,EAAG,IAAK+6C,GAAI/6C,MAAM,GAAI,IAAK+6C,GAAI/6C,MAAM,GAAI,IAChE+6C,GAAI/6C,MAAM,GAAI,IAAK+6C,GAAI/6C,MAAM,GAAI,KAC7Bo8C,EAAO,CAACrB,GAAI/6C,MAAM,GAAI,IAAK+6C,GAAI/6C,MAAM,GAAI,KACzC5B,EAAQ,CAAwB28C,GAAI/6C,MAAM,GAAG,KAYnDq8C,EAAYzQ,EAAKuQ,GAAO,GACxBE,EAAYzQ,EAAKwQ,GAAM,GACvBC,EAAYzQ,EAAKxtC,GAAO,GAExB,IAAMk+C,EAAOpB,EAASrP,WAAW,MAC7B,OAAJyQ,QAAI,IAAJA,KAAMZ,UAAUzB,GAAa,EAAG,GAhBhC,SAASoC,EAAYzQ,EAA+BuQ,EAAkB/zB,GAAgB,IAAD,gBAChE+zB,GADgE,IACnF,2BAAyB,CAAC,IAAfI,EAAc,QACvB3Q,EAAIS,YADmB,oBAENkQ,GAFM,IAEvB,IAAI,EAAJ,qBAAsB,CAAC,IAAblpC,EAAY,QAChBA,IAAQkpC,EAAK,GAAI3Q,EAAI4Q,OAAOnpC,EAAIopC,EAAGppC,EAAIqpC,GACtC9Q,EAAI+Q,OAAOtpC,EAAIopC,EAAGppC,EAAIqpC,IAJN,8BAMnBt0B,GAAOwjB,EAAIgR,YACfhR,EAAIiR,UAR6E,gCAmBvF,IA6CI3B,GA7CA4B,GAAmB,GACnBC,IAAoB,EACpBC,GAAoB,GACpBC,GAAuB,GACvBC,IAAwB,EACxBC,GAAwB,GAyC5B,I,SAAIC,IAAS,EACN,SAASC,KACVrzB,KACFC,cAAcD,IACdA,QAAW1b,GAETyrC,KAASA,GAAQuD,UAAY,MACjCxoC,GAAaI,MAAM3B,UAAUgqC,aAAUjvC,EAElC,SAASkvC,GAAkBxwC,EAAoBywC,GA2DpD,OA1DgB,IAAI1+C,SAAiB,SAAC+S,EAAgBC,GAC/C0rC,IACHA,EAAM3oC,GAAaI,MAAM/E,iBAAiButC,kBAE5CvlD,UAAU0yC,aAAa8S,aACrB,CAACC,MAAM,cACLC,SAASJ,GACNppC,OAAOypC,IAAIF,SAEhBzrC,MAAK,SAACvD,GACN,GAAI5B,EAAU,CACP+sC,KAEHgE,aAA0B,kBAAkB5rC,MAAK,WAC/C6rC,aAA0B,kBAAkB7rC,MAAK,WAC/CirC,IAAS,SAGbrD,GAAUniD,OAAO0sB,SAASC,cAAc,UAChC05B,UAAW,GAEhB/C,KAAUA,GAAWtjD,OAAO0sB,SAASC,cAAc,WACxDw1B,GAAQuD,UAAY1uC,EAChBob,IAAWC,cAAcD,IAC7B,IAAMk0B,EAAM,IAAIC,KAAwB,CAACC,UAAW,IAAKC,eAAgB,KACzEr0B,GAAWK,aAAY,WACJ,OAAbL,KACAozB,GACFkB,aAAiBvE,GAAUmE,GAAKK,mBAAkB,GAAMpsC,MAAK,SAACgpC,GAG5D,OAFAF,GAASlB,GAASyE,WAAYzE,GAAS0E,YAAavD,GAAWC,GA/E7E,SAAoBA,GAClB,GAAIA,EAAK,CACP,IAAMuD,EAAa,CAACvD,EAAKwD,UAAUC,YAAYnC,EAAGtB,EAAKwD,UAAUC,YAAYlC,GACvEmC,EAAe1D,EAAKwD,UAAUC,YAAY1lD,MAE1C4lD,EAAc3jD,EADJ,CAACggD,EAAKc,UAAUC,UAAU,IAAIO,EAAGtB,EAAKc,UAAUC,UAAU,IAAIQ,GAC3C,CAACvB,EAAKwD,UAAU3pC,IAAI4P,KAAMu2B,EAAKwD,UAAU3pC,IAAI2Q,MAKhF,GAJAm5B,EAAY,GAAKA,EAAY,GAAK3D,EAAKwD,UAAU3pC,IAAI9b,MACrD4lD,EAAY,GAAKA,EAAY,GAAK3D,EAAKwD,UAAU3pC,IAAI7b,OAGjD8jD,GAAY59C,OAAO,CACrB,IAAMiB,EAAQ,GACd28C,GAAc/hD,EAAMM,EAAM8E,EAAOo+C,GAAaljD,EAAM,GAASshD,KAC7DI,GAAgB58C,EAAQu+C,EAAe,GAAY9B,GAEnDI,GAAejiD,EAAMM,EADH,GACoBsjD,GAActjD,EAAM,GAAawhD,UAEvEC,GAAcyB,EACdxB,GAAgB2B,EAChB1B,GAAe2B,EAEjB,GAAIhC,GAAQz9C,OAAO,CACjB,IAAM0/C,EAAe5jD,EAAM8hD,GAAaH,IAClCkC,EAAY9B,GAAgBH,GAC5BkC,EAAgBriD,EAAuBkY,GAAaI,MAAMvY,KAAKP,YAAa,CAAC2iD,EAAa,GAAIC,IACpGlqC,GAAaI,MAAMvY,KAAKH,SAAWtB,EAAM4Z,GAAaI,MAAMvY,KAAKH,SAAUhB,GAAO,IAAKyjD,IAEzF,GAAIjC,GAAS39C,OAAO,CAClB,IAAM6/C,EAAW/jD,EAAMgiD,GAAcH,IACrCloC,GAAaI,MAAMvY,KAAKP,cAAgB,IAAM8iD,EAAS,GACvD,IAAMC,EAAarqC,GAAaI,MAAM3B,UAAUgqC,QAAUzoC,GAAaI,MAAM3B,UAAUgqC,QAAU2B,EAAS,GAAKA,EAAS,GACxHpqC,GAAaI,MAAM3B,UAAUgqC,QAAU,IAAO4B,EAEhDrC,GAAUG,GACVF,GAAYG,GACZF,GAAWG,IA6CDiC,CAAWjE,GACJA,KACN/oC,OAAM,WACP6oC,GAASlB,GAASyE,WAAYzE,GAAS0E,YAAavD,OAGtDD,GAASlB,GAASyE,WAAYzE,GAAS0E,YAAavD,OAErD,IA5KM,IA6KT,IACMlsC,EAAgB,CACpBA,MAFkBksC,GAASnO,cA7KpB,IA+KYzF,iBAAiB,GACpC3xB,KAAMb,GAAaI,MAAMT,GACzBiK,KAAM,UAER5M,EAAe9C,OACZ,CACHquC,KACA,IAAMruC,EAAgB,CACpBA,MAAOJ,EAAG04B,iBAAiB,GAC3B3xB,KAAMb,GAAaI,MAAMT,GACzBiK,KAAM,UAER5M,EAAe9C,OAEhBoD,MAAML,MEnMN,IAAMstC,IAAb,GACGvxC,KAAW0B,QADd,gBAEE,aAAc,uDACZ5B,aAAeC,SAHnB,kHACkD,MADlD,IAaayxC,GAAgD,SAAC7Q,GAC5D,IAAO8Q,EAAW9Q,EAAX8Q,QACP,EAAsC9Q,EAAMjgB,OAArCuC,EAAP,EAAOA,SAAUx1B,EAAjB,EAAiBA,IAAKuZ,EAAtB,EAAsBA,aAChB0qC,EAAiBjL,cAAY,kBACjC9F,EAAMgR,QAAQ9f,OAAOpkC,KAAI,SAACmX,EAAMqsB,GAAP,OAC3B,SAAsBrsB,EAAuB0V,EAA4B5nB,GACvE,IAAIk/C,GAAW,EACfA,EAAWhtC,EAAKmrC,WAAa/oC,EAAaI,MAAM/E,iBAAiButC,iBACjE,IAAMiC,EAASx8B,OAAOy8B,aAAa,GAAKp/C,GAExC,OAAO,eAACq/C,GAAA,EAAD,CAA8B7R,QAAS,WAAQ5lB,EAAM1V,EAAKmrC,WAA1D,mBACE8B,EADF,eACkBD,EAAW,mBAAa,kBAD1C,OACkEhtC,EAAKkiC,QADxDliC,EAAKmrC,UANaiC,CAAaptC,EAAMqtC,EAAgBhhB,SAU7E,SAASghB,EAAetC,GACtB8B,EAAQ,QACJ9B,GACFD,IAAkB,EAAOC,GAAKtrC,MAAK,SAAC6tC,GAClC,IAAM3/B,EAAU0D,GAAqB,CAACi8B,EAAQhxC,OAAQzT,EAAK,SAAU2Q,OAAOuiC,GAAO9tB,MAAOzU,OAAOuiC,GAAO7tB,MAAO1U,OAAOuiC,GAAOl3B,MAC7HwZ,EAASiX,SAAS3nB,GAClB2/B,EAAQthC,KAAO2B,EAAQ5L,GACvBsc,EAASsW,yBAAyB3W,GAAWmQ,cAAclrB,KAAM0K,EAAQ5L,IACzEsc,EAASyW,aAAannB,GACtBqQ,GAAWyU,uBAAuB6a,MAsBxC,OAhBA5S,sBAAU,WACR,IAAM8I,EAAa,SAACn7C,GAClB,GAA+B,QAA3BA,EAAEuyC,KAAK9xB,UAAU,EAAG,GAAc,CAAC,IAAD,EAC9BykC,EAASllD,EAAEuyC,KAAKhuC,WAAW,GAAK,GACtCygD,EAAc,UAACtR,EAAMgR,QAAQ9f,OAAOsgB,UAAtB,aAAC,EAA8BpC,YAKjD,OAFAjmD,OAAOywB,iBAAiB,WAAY6tB,GAE7B,WACLt+C,OAAOk5C,oBAAoB,WAAYoF,MAGjC,IAGH,qCACJsJ,KAGLF,GAAerR,YAAc,iBC7DtB,IAAMiS,GAAsD,SAAC,GAAuB,EAArBC,eAgFpE,OARA/S,sBAAU,WACR,GAAGpxB,MAAQpkB,OAAOwoD,gBACFvtC,eAAeK,QAAQ,kBAMlC,qCAAG,gBAEZgtC,GAAkBjS,YAAc,oB,kCCnF1BwK,GAAQ4H,aAAY,CACxBC,QAAS,CACPC,QAAS,CAAEC,KAAM,WACjBC,UAAW,CAAED,KAAM,cAWjB3J,GAAYC,aAAW,CAC3B4J,cAAe,CACb9N,QAAS,OACTz5C,OAAQ,OACRD,MAAM,QAERynD,cAAe,CACbnkD,SAAS,WACTmpB,IAAI,OACJzsB,MAAM,QACNC,OAAO,SAETynD,YAAc,CACZ1nD,MAAM,OACNC,OAAO,OACP0nD,SAAU,QACVC,UAAU,QACVC,OAAO,uBACPn8B,KAAK,OAEPo8B,QAAS,CACPpO,QAAQ,OACRqO,oBAAqB,iBACrBC,IAAI,GACJ3O,UAAU,SACVC,UAAW,SACXr5C,OAAO,QACPgoD,aAAa,cAEfC,gBAAiB,CACf5kD,SAAS,WACT21C,QAAQ,OACRzE,SAAS70C,IAAiB,QAAU,MACpCwoD,WAAW,OACXC,aAAc,oBACdx0C,MAAM,UACNy0C,OAAQ,WAGVC,cAAe,CACbhlD,SAAS,WACT21C,QAAQ,OACRzE,SAAS70C,IAAiB,QAAU,MACpCwoD,WAAW,OACXC,aAAa,oBACbx0C,MAAM,UACNy0C,OAAQ,aAKRE,GAAuB,GACpB,SAASC,KACd,OAAOD,GAOF,SAASnO,GAAS7E,GACvB,IACE8Q,EAIE9Q,EAJF8Q,QACA/6B,EAGEiqB,EAHFjqB,MACAm9B,EAEElT,EAFFkT,cACAC,EACEnT,EADFmT,WA2BI1K,EAAUL,KAChB,EAAkClH,oBAAS,GAA3C,mBAAOkS,EAAP,KAAkBC,EAAlB,KAEA,EAA4BnS,qBAAU,GAAtC,mBAAOG,EAAP,KAAeC,EAAf,KAMA,EAAqBJ,oBAAS,IAA9B,mBAAO7nB,EAAP,KAAYi6B,EAAZ,KAQA3U,sBAAU,WANRpvB,MAAM,uCACH7L,MAAK,SAAC2M,GAAD,OAAcA,EAAS5I,UAC5B/D,MAAK,SAAC2M,GAAD,OAAcijC,EAAQjjC,QAM9B,IAUF,IALA,IAAMkjC,EAA0B,GAC1BC,EAAyB,GAC3BC,EAAmB,GACnBC,EAAiBr6B,EAAKrpB,MAAM,KAEvBW,EAAE,EAAGA,EAAE+iD,EAAe9iD,OAAO,EAAGD,KAEkB,IAAtD4iD,EAAQ7gC,QAAQghC,EAAe/iD,GAAGX,MAAM,KAAK,KAC9CujD,EAAQprC,KAAKurC,EAAe/iD,GAAGX,MAAM,KAAK,IAe9C,IAAK,IAAI2jD,EAAE,EAAGA,EAAIJ,EAAQ3iD,OAAQ+iD,IAAK,CACrC,IAAK,IAAIhjD,EAAE,EAAGA,EAAE+iD,EAAe9iD,OAAO,EAAGD,IACtC4iD,EAAQI,KAAOD,EAAe/iD,GAAGX,MAAM,KAAK,KAC7CyjD,GAAYC,EAAe/iD,GAAM,KAKrC6iD,EAAOrrC,KAAKsrC,GACZA,EAAU,GA+GV,IAAMG,EAAS,GACf,GAAGJ,EAAO5iD,OAAS,GAAKwiD,EAAY,EAElC,IADA,IAAIS,EAASL,EAAOJ,EAAU,GAAGpjD,MAAM,KADF,WAE5BW,GACPijD,EAAOzrC,KAAK,uBAAKo3B,QAAW,YA4ChC,SAAoBuU,GASlB,IAAID,EAASL,EAAOJ,EAAU,GAAGpjD,MAAM,KACvCgjD,GAAgBa,EAAOC,GACvBxS,EAAUwS,GAvD2BC,CAAWpjD,IAAlC,UAAuC,sBAAKkS,IAAKmxC,mBAAmBH,EAAOljD,IAAKulB,MAAO,CAACzrB,MAAM,QAAS4nD,UAAU,QAAS3nD,OAAO,QAASupD,UAAU,UAAWvQ,QAAQ,MAAO4O,OAAOjR,IAAW1wC,EAAI,oBAAsB,wBAAyB+zC,IAAI,KAAK,sBAAKxuB,MAAO,CAAC+tB,UAAU,SAAUl2C,SAAS,WAAY6kD,WAAW,OAAQtL,UAAU,QAAnF,SAA6FuM,EAAOljD,GAAGX,MAAM,KAAK,GAAGA,MAAM,KAAK,UADjYW,EAAW,EAAGA,EAAIkjD,EAAOjjD,OAAO,EAAGD,IAAM,EAAzCA,GAsCX,SAASujD,EAAWC,GAElBnB,GAAgB,GAChB1R,GAAW,GACX+R,EAAac,GAyBf,OACE,uBAAKrL,UAAWL,EAAQwJ,cAAxB,UACkB,cAAfjS,EAAMl4B,KACP,uBAAKghC,UAAWL,EAAQyJ,cAAxB,UACG,sBAAKpJ,UAAyB,IAAdsK,EAAkB3K,EAAQsK,cAAgBtK,EAAQkK,gBAAiBpT,QAAW,WAAO2U,EAAW,IAAhH,mBAKFX,EAAQzmD,KAAI,SAACsnD,EAAO5gB,GACnB,OACE,sBAAKsV,UAAWsK,IAAc5f,EAAM,EAAIiV,EAAQsK,cAAgBtK,EAAQkK,gBAAiBpT,QAAW,WAAO2U,EAAW1gB,EAAM,IAA5H,SAAkI4gB,UAM7H,GAEX,gBAACC,GAAA,EAAD,WAEe,IAAdjB,EACC,eAACpH,GAAA,EAAD,CAAU91B,MAAsB,cAAf8pB,EAAMl4B,KAAuB,CAACsqC,SAAS,QAAS1nD,OAAO,SAAW,CAAC0nD,SAAS,QAAS1nD,OAAO,SAA7G,SACGyoD,IAEDC,GAAa,GAAoB,cAAfpT,EAAMl4B,KAC1B,eAACkkC,GAAA,EAAD,CAAU91B,MAAO,CAACk8B,SAAS,SAA3B,SACE,sBAAKtJ,UAAWL,EAAQ0J,YAAxB,SACA,sBAAKrJ,UAAWL,EAAQ8J,QAAxB,SACGqB,QAkBY,GAEjB,eAAC5H,GAAA,EAAD,UACA,eAAC,KAAD,CAAkBhC,MAAOA,GAAzB,SACE,eAAC9K,GAAA,EAAD,CACEC,QAAQ,YACR9gC,MAAM,UACN6X,MAAO,CAAC+oB,SAAU70C,IAAiB,QAAU,OAC7Cm1C,QAAS,WAEL2T,EAAcn9B,GAIhB+6B,EAAQ,SAVZ,4BAwBRjM,GAAMrF,YAAc,Q,4CCxZd4I,GAAYC,aAAW,CAC3BiM,QAAS,CACP7pD,MAAO,OACPC,OAAQ,QAEV6pD,WAAa,CACXlC,UAAW,SAEbmC,eAAgB,CACdnC,UAAW,UAYFoC,GAAwC,SAACzU,GACpD,IACE8Q,EACE9Q,EADF8Q,QAGIrI,EAAUL,KAChB,EAA0BlH,oBAAiB,IAA3C,mBAAO5yB,EAAP,KAAcomC,EAAd,KACA,EAAoCxT,oBAA6B98B,eAAeK,QAAQ,0BAAkD,SAA1I,mBAAO0P,EAAP,KAAmBwgC,EAAnB,KAEO7iD,EAAKI,KAALJ,EACD8iD,EACJ,eAAC,KAAD,CAIEC,cAAe,CAAC,WAChBC,aAAchjD,EAAE,qBAChBijD,cAAiBtM,EAAQ8L,WACzBS,uBAA0BvM,EAAQ+L,eAClCxP,SAAU0P,EACVO,iBAAkB,CAAC1P,UAAW,CAAEC,QAAS,EAAG0P,UAAW,QACvDC,iBAAkB,CAAC1M,QAAS,CAAEH,KAAMG,EAAQ6L,YAkBhD3V,sBAAU,WACRv6B,eAAeE,QAAQ,wBAAyB6P,KAC/C,CAACA,IAGJ,IAAMrnB,EAAMkzC,EAAMjgB,OAAOjzB,IAEzB,OACE,uCACE,eAAC4zC,GAAA,EAAD,CAAKC,GAAI,EAAT,SACE,gBAACyU,GAAA,EAAD,CAAaC,UAAU,WAAvB,UACE,eAACC,GAAA,EAAD,CAAWD,UAAU,SAArB,gCACA,gBAACE,GAAA,EAAD,CAAYr/B,MAAO,CAACiuB,QAAQ,OAAQqR,cAAc,OAChD,aAAW,kBACXh2C,aAAa,QACbuW,MAAO5B,EACPjW,KAAK,kBACL8mC,SAAU,SAAC14C,GACTqoD,EAAcroD,EAAE24C,OAAOlvB,QAN3B,UAUE,eAACkwB,GAAA,EAAD,CAAkBlwB,MAAM,QAAQmwB,QAAS,eAACuP,GAAA,EAAD,IAAWtP,MAAM,UAC1D,eAACF,GAAA,EAAD,CACElwB,MAAM,QACNmwB,QAAS,eAACuP,GAAA,EAAD,IACTtP,MAAM,yBAMd,eAAC,GAAD,CACEpmB,OAAQigB,EAAMjgB,OACd+wB,QAASA,EACToC,cAAe,SAAC5kC,GAEY,KAAvB2kC,KACD3kC,EAAMphB,QAAN,yCAAc,WAAOihB,EAAMxd,GAAb,UAAA7G,EAAA,sDACW,IACC,GACxBkqB,GAAqB7F,EAAMrhB,EAAK,CAFT,GAGJ6D,GAFI,GAGJA,GAChBwjB,EAAY6rB,EAAMl4B,KAAMk4B,EAAM9tB,MAAO8tB,EAAM7tB,MAAO6tB,EAAMl3B,KAAM,IAC/DpF,MAAK,SAACgyC,GAAD,OACLv+B,GAAe4hB,aAAa2c,MARlB,2CAAd,0DAYAnhC,GAAwB0+B,KAAoBnmD,EAAK,CAAC,EAAG,GAAIkzC,EAAMl4B,KAAMk4B,EAAM9tB,MAAO8tB,EAAM7tB,MAAO6tB,EAAMl3B,KAAM,IAAIpF,MAC7G,SAAAgyC,GAAY,OAAIv+B,GAAe4hB,aAAa2c,MDlDxD1C,GAAgB,KCsDVj9B,MAAOzH,EACP6kC,WAAYyB,EACZ9sC,KAAMk4B,EAAMl4B,WC/HdkiC,GAAQ4H,aAAY,CACxBC,QAAS,CACPC,QAAS,CAAEC,KAAM,WACjBC,UAAW,CAAED,KAAM,cAUhB,SAAS4D,GAAgB3V,GAC9B,IACE8Q,EAIE9Q,EAJF8Q,QACA/6B,EAGEiqB,EAHFjqB,MACAm9B,EAEElT,EAFFkT,cACAC,EACEnT,EADFmT,WAGF,OACE,gBAACkB,GAAA,EAAD,WACE,eAACrI,GAAA,EAAD,UACGmH,IAEH,eAACnH,GAAA,EAAD,UACA,eAAC,KAAD,CAAkBhC,MAAOA,GAAzB,SACE,eAAC9K,GAAA,EAAD,CACAhpB,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OACxC+0C,QAAQ,YACR9gC,MAAM,UACNkhC,QAAS,WACP2T,EAAcn9B,GACd+6B,EAAQ,SANZ,yBAgBR6E,GAAanW,YAAc,e,yBCtCrB4I,GAAYC,aAAW,CAC3BiM,QAAS,CACP7pD,MAAO,OACPC,OAAQ,OACRwsB,IAAK,SAEP0+B,cAAe,CACb3W,SAAS70C,IAAiB,MAAQ,SAYzByrD,GAAsD,SAAC7V,GAClE,IACE8Q,EACE9Q,EADF8Q,QAGIrI,EAAUL,KAChB,EAA0BlH,oBAAiB,IAA3C,mBAAO5yB,EAAP,KAAcomC,EAAd,KACA,EAAwBxT,oBAAiB,IAAzC,mBAAO7sB,EAAP,KAAayhC,EAAb,KACA,EAA0B5U,qBAAS,GAAnC,mBAAc6U,GAAd,WAEA,EAA0C7U,oBAA6B98B,eAAeK,QAAQ,0BAAkD,SAAzI0P,EAAP,oBAII6hC,EAAsB,GACtBC,EAAkB,GAEtB3zB,GAASC,IAAIpG,QAAO,SAAA4vB,GAAI,MAAqB,YAAjBA,EAAKj7B,aAAuBhkB,KAAI,SAAA8kB,GAAO,OACjEokC,EAAepkC,EAAQxpB,OAEzBk6B,GAASC,IAAIpG,QAAO,SAAA4vB,GAAI,MAAqB,YAAjBA,EAAKj7B,aAAuBhkB,KAAI,SAAA8kB,GAAO,OACjEqkC,EAAWrkC,EAAQZ,eAOrB,IAAOlf,EAAKI,KAALJ,EACD8iD,EACJ,eAAC,KAAD,CACEC,cAAe,CAAC,WAChBqB,aAAc,GAGdC,gBAAgB,EAChBrB,aAAchjD,EAAE,qBAChBkjD,uBAAwBvM,EAAQmN,cAChC5Q,SAAU0P,EACV0B,WAAc,EACdnB,iBAAkB,CAAC1P,UAAW,CAAEC,QAAS,EAAG0P,UAAW,QACvDC,iBAAkB,CAAC1M,QAAS,CAAEH,KAAMG,EAAQ6L,YAIhD3V,sBAAU,WACRv6B,eAAeE,QAAQ,wBAAyB6P,KAC/C,CAACA,IAEJ,IAAMrnB,EAAMkzC,EAAMjgB,OAAOjzB,IAYzB,OACE,iCACA,eAACu6C,GAAA,EAAD,CAAWlB,MAAOr0C,EAAE,eAAgBukD,WAAW,EAAMC,QAAS,EAAG92C,aAAcy2C,EAC/EM,WAAY,CAAErgC,MAAO,CAAE+oB,SAAS70C,IAAiB,QAAU,QAC3DosD,gBAAiB,CAAEtgC,MAAO,CAAE+oB,SAAS70C,IAAiB,QAAU,QAChE8rB,MAAO,CAACnoB,SAAS,WAAY61C,WAAW,GAAIn5C,MAAM,MAAO68C,UAAU,QAASsL,WAAW,QACvF5N,SAAU,SAAArmB,GACRm3B,EAAQn3B,EAAMsmB,OAAOlvB,OACrB4I,EAAMmgB,oBAER,uBAAK5oB,MAAwB,KAAjB8/B,EAAsB,CAACjoD,SAAS,WAAYrD,OAAO,OAAQwsB,IAAI,OAAQgtB,MAAM,OAAQuS,SAAS,SAAUtS,QAAQ,SAAW,CAACA,QAAQ,QAAhJ,UACE,sBAAKjuB,MAAO,CAACxrB,OAAO,OAAQqD,SAAS,YAAa8U,IAAKmzC,EAActR,IAAI,KACvE,eAAC,KAAD,CAAYxuB,MAAO,CAACnoB,SAAS,WAAYooB,KAAK/rB,IAAiB,OAAS,MAAOK,MAAML,IAAiB,KAAO,KAAMM,OAAON,IAAiB,KAAO,MAAOiU,MAAM,YAAYkhC,QArBjL,WAEEjd,GAASC,IAAIpG,QAAO,SAAA4vB,GAAI,MAAqB,YAAjBA,EAAKj7B,aAAuBhkB,KAAI,SAAA8kB,GAAO,OACjE0Q,GAASmT,cAAc7jB,EAAQ5L,OAEjC8vC,EAAQ,IACRC,GAAS,SAiBT,yBAGA,eAACJ,GAAD,CAAc51B,OAAQigB,EAAMjgB,OAC1B+wB,QAASA,EACToC,cAAe,SAAC5kC,GAEdA,EAAMphB,QAAN,yCAAc,WAAOihB,EAAMxd,GAAb,UAAA7G,EAAA,sDAGW,IACC,GAOxBkqB,GAAqB7F,EAAMrhB,EAAK,CART,GAQ2B6D,GAP3B,GAO+CA,GAAIwjB,EAAY6rB,EAAMl4B,KAAMk4B,EAAM9tB,MAAO8tB,EAAM7tB,MAAO6tB,EAAMl3B,KAAMuL,GAAM3Q,MAC5I,SAAAgyC,GAAY,OAAIv+B,GAAe4hB,aAAa2c,MAZlC,2CAAd,0DAeF3/B,MAAOzH,EACP6kC,WAAYyB,Q,yECpCX,IAAM8B,GAAsC,SAAC1W,GAClD,IAAOluC,EAAKI,KAALJ,EACP,EAAsCkuC,EAAMjgB,OAArCuC,EAAP,EAAOA,SAAUjc,EAAjB,EAAiBA,aAAcvZ,EAA/B,EAA+BA,IAGzB6pD,EAAY7Q,cAAY,kBAAMz/B,EAAaI,MAAM9W,MAAMC,QAW7D,SAASkhD,EAAQhrB,GACF,WAATA,GANJp8B,UAAU0yC,aAAaC,mBAAmB34B,MAAK,SAACkzC,GAC9C5W,EAAMgR,QAAQ9f,OAAS0lB,EAAMz6B,QAAO,SAAAlY,GAAI,MAAkB,eAAdA,EAAKoD,WAElD1D,OAAM,WAAQkK,QAAQiL,KAAK,+BAM5BknB,EAAM8Q,QAAQhrB,GAWhB,IAAM+wB,EAAa,WAEjB/F,EAAQ,QACR,IAAMgG,EAAKtjC,GAAoB,GAAI1mB,EAAK2Q,OAAOuiC,GAAO+W,MAAOt5C,OAAOuiC,GAAOgX,MAAOv5C,OAAOuiC,GAAOiX,QAChG30B,EAASyW,aAAa+d,GACtBx0B,EAASwX,WAAWgd,EAAG9wC,KAsBnBkxC,EAAe,YAlHvB,SAAsBlX,GACpB,IAAM1rC,EAAM0rC,EAAMjgB,OAAOuC,SAAS6V,UAClC,OAAO,IAAI7nC,SAAqB,SAACC,EAASC,GACxC9G,UAAU0yC,aAAa+a,gBAAgB,CACrCj3C,OAAM,EACNivC,MAAM,CACJiI,UAAU,CACRC,MAAO/iD,MAGVoP,KAAKnT,GAASoT,MAAMnT,OAyGvB8mD,CAAatX,GAAOt8B,MAAK,SAACvD,GACxB,GAAIA,EAAGw4B,YAAY/nC,OAAQ,CACzB,IAAMghB,EAAU0D,GAAqBnV,EAAGw4B,YAAa7rC,EAAK,SAAU2Q,OAAOuiC,GAAO+W,MAAOt5C,OAAOuiC,GAAOgX,MAAOv5C,OAAOuiC,GAAOiX,QAC5H30B,EAASiX,SAAS3nB,GAClB0Q,EAASsW,yBAAyB3W,GAAWmQ,cAAclrB,KAAM0K,EAAQ5L,IACzEsc,EAASyW,aAAannB,GACtBzR,EAAGw4B,YAAYzrC,SAAQ,SAACqT,GACtB,IAAMgxC,EAAkB,CACtBhxC,QACA2G,KAAM+a,GAAWmQ,cAAclrB,KAC/B+I,KAAM2B,EAAQ5L,IAEhBic,GAAWyU,uBAAuB6a,UAIxCT,EAAQ,SA6EV,OA3CAnS,sBAAU,WACR,IAAM8I,EAAa,SAACn7C,GACdQ,EAAIqtC,cAActX,IAAI,iBACT,SAAXv2B,EAAEuyC,MAEe,SAAXvyC,EAAEuyC,OAES,SAAXvyC,EAAEuyC,MA7EhBiS,EAAQ,QACRpnD,UAAU6tD,UAAUC,WAAW9zC,MAAK,SAAA5T,GAClC2lB,GAAsB3lB,EAAKhD,EAAK2Q,OAAOuiC,GAAO+W,MAAOt5C,OAAOuiC,GAAOgX,MAAOv5C,OAAOuiC,GAAOiX,QAAQvzC,MAAK,SAAAtY,GACnGk3B,EAASyW,aAAa3tC,UA4ED,SAAXkB,EAAEuyC,MACVvyC,EAAEwyC,iBACFgS,EAAQ,WACW,SAAXxkD,EAAEuyC,MACVvyC,EAAEwyC,iBACF+X,KACmB,SAAXvqD,EAAEuyC,MACVvyC,EAAEwyC,iBACFgS,EAAQ,UACW,SAAXxkD,EAAEuyC,MACVvyC,EAAEwyC,iBAlFe,WACvBgS,EAAQ,QACR,IAAI2G,EAAO,IAAIhzB,YAAY,GAC3BgzB,EAAOtuD,OAAOuuD,OAAOC,gBAAgBF,GACrC,IAAIG,EAAU,GACdH,EAAKvqD,SAAQ,SAAAyD,GAAC,OAAIinD,GAAWjnD,EAAEW,SAAS,OACxC2gB,GAAsB,6CAAD,OAC0BgQ,GAAWn5B,KADrC,YAC6C8uD,GAAW9qD,EAAK2Q,OAAOuiC,GAAO+W,MAAOt5C,OAAOuiC,GAAOgX,MAAOv5C,OAAOuiC,GAAOiX,QAAQvzC,MAAK,SAACtY,GACtJk3B,EAASyW,aAAa3tC,GACrBk3B,EAASwX,WAAW1uC,EAAE4a,OA0EnB6xC,IACmB,SAAXvrD,EAAEuyC,OAES,SAAXvyC,EAAEuyC,KACVqY,IACmB,SAAX5qD,EAAEuyC,MAxDhBx4B,EAAaI,MAAM9W,MAAMC,MAAQ+mD,EACjC7F,EAAQ,SAyDiB,SAAXxkD,EAAEuyC,KACViS,EAAQ,UACW,SAAXxkD,EAAEuyC,OAxDHvc,EAASw1B,wBACjB5qD,SAAQ,SAAAyzB,GAAG,OAAI2B,EAASmT,cAAc9U,MAC3CmwB,EAAQ,aA6DR,OAFA3nD,OAAOywB,iBAAiB,WAAY6tB,GAE7B,WACLt+C,OAAOk5C,oBAAoB,WAAYoF,MAGjC,IAIR,gBAAC4M,GAAA,EAAD,WAmGE,eAAC,GAAD,CACEzI,IAAO95C,EAAE,iBACQ2V,KAAM3V,EAAE,cAAe+3B,KAAM,eAAC,KAAD,CAAW3T,MAAO9rB,IAAiB,CAACK,MAAM,MAAOC,OAAO,OAAS,CAACD,MAAM,MAAOC,OAAO,SAAY60C,QAAS,kBAAMuR,EAAQ,WAAnK,cAMN,eAAC,GAAD,CACkBrpC,KAAM3V,EAAE,aAAc+3B,KAAM,eAAC,KAAD,CAAc3T,MAAO9rB,IAAiB,CAACK,MAAM,MAAOC,OAAO,OAAS,CAACD,MAAM,MAAOC,OAAO,SAAY60C,QAASsX,GAAtJ,aAEN,eAAC,GAAD,CACEjL,IAAO95C,EAAE,yBAET+3B,KAAM,eAAC,KAAD,CAAkB3T,MAAO9rB,IAAiB,CAACK,MAAM,MAAOC,OAAO,OAAS,CAACD,MAAM,MAAOC,OAAO,SACnG+c,KAAM3V,EAAE,sBACRytC,QAAS2X,EACTvL,SAAY,eAACyJ,GAAA,EAAD,CAAal/B,MAAO9rB,IAAiB,CAACk6C,UAAU,aAAcV,WAAW,OAAS,CAACU,UAAU,WAAYV,WAAW,OAAQyR,UAAU,WAAtI,SACV,eAAC,KAAD,UACE,kBAAK,gBAACE,GAAA,EAAD,CAAYwC,KAAG,EAAC,aAAW,aAAa75C,KAAK,MAAM6X,MAAOiqB,EAAMjgB,OAAOuC,SAAS6V,UACnF6M,SAAU,SAAC5rB,GAAO4mB,EAAMjgB,OAAOuC,SAAS01B,aAAa/nD,OAAOmpB,EAAG6rB,OAAOlvB,SACtEwpB,QAAS,SAACnmB,GACRA,EAAG2lB,kBACHvlB,WAAW09B,EAAc,MAJxB,UAOH,eAACjR,GAAA,EAAD,CAAkBlwB,MAAO,EAAGmwB,QAAS,eAACuP,GAAA,EAAD,IAAWtP,MAAM,MACtD,eAACF,GAAA,EAAD,CAAkBlwB,MAAO,EAAGmwB,QAAS,eAACuP,GAAA,EAAD,IAAWtP,MAAM,MACtD,eAACF,GAAA,EAAD,CAAkBlwB,MAAO,GAAImwB,QAAS,eAACuP,GAAA,EAAD,IAAWtP,MAAM,OACvD,eAACF,GAAA,EAAD,CAAkBlwB,MAAO,GAAImwB,QAAS,eAACuP,GAAA,EAAD,IAAWtP,MAAM,OACvD,eAACF,GAAA,EAAD,CAAkBlwB,MAAO,GAAImwB,QAAS,eAACuP,GAAA,EAAD,IACpCtP,MAAO,uDAAiCr0C,EAAE,qBAlB9C,sBAuBN,eAACmmD,GAAA,EAAD,IACA,eAAC,GAAD,CACErM,IAAO95C,EAAE,iBACY2V,KAAM3V,EAAE,kBAAmB+3B,KAAM,eAAC,KAAD,CAAY3T,MAAO9rB,IAAiB,CAACK,MAAM,MAAOC,OAAO,OAAS,CAACD,MAAM,MAAOC,OAAO,SAAY60C,QAAS,kBAAMuR,EAAQ,eAA5K,kBAEL,eAACmH,GAAA,EAAD,QAIPvB,GAAUlX,YAAc,Y,2CC5XX0Y,GAAsC,SAAClY,GAClD,IACEmY,EAIEnY,EAJFmY,UACA34C,EAGEwgC,EAHFxgC,aACAsI,EAEEk4B,EAFFl4B,KACGswC,EAJL,aAKIpY,EALJ,IAMO8Q,EAA0B9Q,EAA1B8Q,QAASoC,EAAiBlT,EAAjBkT,cAChB,EAA0BhS,yBAAkCrhC,IAAjBL,EAA6B,GAAKA,GAA7E,mBAAOuW,EAAP,KAAc4vB,EAAd,KACMiP,EACJ,eAACvN,GAAA,EAAD,CAAYlB,MAAOgS,EAAW9B,UAAWrW,EAAMqW,UAAWtgC,MAAOA,EAC7DivB,SAAU,SAAArmB,GAAK,OAAIgnB,EAAShnB,EAAMsmB,OAAOlvB,QACzCqqB,WAAW,EAAM2E,WAAY,CAAC1F,WAAU,GACxCoI,WAAY,SAACruB,GACN4mB,EAAMqW,WAAwB,UAAXj9B,EAAGrnB,MACzBmhD,EAAcn9B,GACd+6B,EAAQ,YAMlB,OACE,eAAC,GAAD,2BAAO/6B,MAAOA,EAAOo9B,WAAYyB,GAAWwD,GAA5C,IAAyDtwC,KAAMA,MAGnEowC,GAAU1Y,YAAc,YCZxB,IAAI8K,IAAiB,EACd,SAAS+N,KACd,OAAO/N,GAGF,IAAMgO,GAA0C,SAACtY,GACtD,IAMIuY,EANGzlC,EAA8CktB,EAA9CltB,KAAMsc,EAAwC4Q,EAAxC5Q,QAAS2nB,EAA+B/W,EAA/B+W,MAAOC,EAAwBhX,EAAxBgX,MAAOC,EAAiBjX,EAAjBiX,OAAQ7iC,EAAS4rB,EAAT5rB,MACrCtnB,EAAOkzC,EAAMjgB,OAAbjzB,IAEDkkD,EAAUhK,kBAAO,IAAI4J,IAKzB2H,EADW,cAAVnkC,EACY,YAEA,OAEf,MAAwB8sB,oBAAeqX,GAAvC,mBAAOzyB,EAAP,KAAagrB,EAAb,KA0DA35B,GAAeqhC,aAAwB,SAAT1yB,GAA4B,SAATA,EAEjDwkB,GAASx3B,EAET,IAAOhhB,EAAKI,KAALJ,EAmBDqwB,EAhBF,CAOFs2B,KAAM3mD,EAAE,oBACR2V,KAAM3V,EAAE,cACR4mD,OAAQ5mD,EAAE,gBACV01B,MAAO11B,EAAE,eACT6mD,UAAW7mD,EAAE,oBACb8mD,UAAW9mD,EAAE,iBACb+mD,KAAM,OACNC,OAAQhnD,EAAE,iCAEYg0B,GAClBizB,EAzEN,SAAiBjzB,EAAYgrB,GAC3B,OAAQhrB,GACN,IAAK,OACH,OAAO,eAAC,GAAD,6BAAeka,GAAf,IAAsB8Q,QAASA,EAASE,QAASA,EAAQ/Z,WAClE,IAAK,OACH,OAAO,eAAC,GAAD,CAAWlX,OAAQigB,EAAMjgB,OAC5B+wB,QAASA,EACToC,cAAe,SAACn9B,GACdoB,GAAe4hB,aAAavlB,GAAoBuC,EAAOjpB,EAAKiqD,EAAOC,EAAOC,KAG5EkB,UAAY,OACZ9B,WAAa,EACbvuC,KAAMge,IAEZ,IAAK,SACH,OAAO,eAAC,GAAD,CAAW/F,OAAQigB,EAAMjgB,OAC5B+wB,QAASA,EACToC,cAAe,SAACn9B,GACd9D,GAAsB8D,EAAOjpB,EAAKiqD,EAAOC,EAAOC,GAAQvzC,MAAK,SAACtY,GAC5D+rB,GAAe4hB,aAAa3tC,OAGhC+sD,UAAY,MACZ9B,WAAa,EACbvuC,KAAMge,IAEZ,IAAK,QAEL,IAAK,YACH,OAAO,eAAC,GAAD,CAAYgrB,QAASA,EAAS/wB,OAAQigB,EAAMjgB,OAAQjY,KAAMge,EAAM5T,MAAO6kC,EAAO5kC,MAAO6kC,EAAOluC,KAAMmuC,IAC3G,IAAK,YACH,OAAO,eAAC,GAAD,CAAmBnG,QAASA,EAAS/wB,OAAQigB,EAAMjgB,OAAQjY,KAAMge,EAAM5T,MAAO6kC,EAAO5kC,MAAO6kC,EAAOluC,KAAMmuC,IAClH,IAAK,SACH,OAAO,eAAC,GAAD,CAAgBnG,QAASA,EAAS/wB,OAAQigB,EAAMjgB,OAAQixB,QAASA,EAAQ/Z,QAAS/kB,MAAO6kC,EAAO5kC,MAAO6kC,EAAOluC,KAAMmuC,IAC7H,IAAK,SACH,OAAO,eAAC,GAAD,CACPl3B,OAAQigB,EAAMjgB,OACd+wB,QAASA,EAASY,eAAgB,SAAC37B,GACjC9D,GAAsB8D,EAAOjpB,EAAKiqD,EAAOC,EAAOC,GAAQvzC,MAAK,SAACtY,GAC5D+rB,GAAe4hB,aAAa3tC,SAGlC,QACE,MAAM,IAAI5B,MAAJ,wBAA2Bs8B,KA6BDkzB,CAAQlzB,GAhFvB,SAACA,GACT,SAATA,EACFsJ,IAEA0hB,EAAQhrB,MAuFZ,OAAQ,gBAACoa,GAAA,EAAD,CAAQptB,KAAMA,EAAMsc,QAASA,EAAS6pB,SAAU,kBAAMnI,EAAQyH,IAAapY,SAAS,KAAKC,WAAW,EACxG8Y,cAAiB,SAAC9/B,GAChBtsB,EAAIy2C,SAAS,CAACnqB,EAAG+/B,QAAS//B,EAAGggC,WAE/BC,WAAY,CACVnjC,MAAO,CACLouB,UAAWl6C,IAAiB,aAAe,aAN3C,UAUN,eAACk2C,GAAA,EAAD,CAAat6B,GAAG,sBAAsBu6B,mBAAmB,EAAMrqB,MAAO,CAAC+oB,SAAU70C,IAAiB,QAAU,SAA5G,SACG+3B,IACH,eAAC6c,GAAA,EAAD,UAAgB+Z,QAIpBT,GAAY9Y,YAAc,cCzHnB,IAAM8Z,GAAqC,SAACtZ,GAGjD,MAAiCA,EAAMjgB,OAAhCuC,EAAP,EAAOA,SAAUjc,EAAjB,EAAiBA,aACXkzC,EAAYvS,kBAAyB,MAG3C,EAAwB9F,qBAAkB,GAA1C,mBAAOtxC,EAAP,KAAa4pD,EAAb,KAQA,SAASC,IACP5rC,QAAQC,IAAI,iBAyEd,SAAuBwU,GAGrB,IADA,IAAIo3B,EhDjCD,SAAwBhuC,GAAyB,IAAD,gBAChCA,GADgC,IACrD,IAAI,EAAJ,qBAA0B,CAAC,IACnBtgB,EADkB,eAEjBA,EAAE6b,gBACF7b,EAAEugB,cACFvgB,EAAEwgB,aACFxgB,EAAE4a,IAN0C,8BAQrD,OAAO0F,EgDyBYiuC,CAAer3B,EAASC,KACjC5xB,EAAS,EAAGA,EAAI+oD,EAAW9oD,OAAQD,IACzC+oD,EAAW/oD,GAAG+f,UAAY,GAC1BgpC,EAAW/oD,GAAGggB,SAAW,GAK3B,IAAMiB,EAAUrN,KAAKC,UAAUk1C,GAG1BE,EAAY,CAACC,OAAQ,QACnBC,EAAQv1C,KAAKC,UAAUo1C,GAKxBv4B,EAAO,IAAI/R,KAAK,CAJA,4BAA8BwqC,EAAQ,sBAAwBloC,EAAU,MAItD,CAAC9J,KAAM,eACzChe,EAAI+rB,SAASC,cAAc,KAC3B1tB,EAAME,IAAIm+B,gBAAgBpF,GAChCv3B,EAAET,KAAOjB,EAET,IAAIw3C,EAAWx7B,eAAeK,QAAQ,QACtC3a,EAAEiwD,SAAWrlC,OAAOkrB,GAAY,QAChC/pB,SAAS9G,KAAKqH,YAAYtsB,GAC1BA,EAAEkwD,QACFxgC,YAAW,WACT3D,SAAS9G,KAAKyH,YAAY1sB,GAC1BX,OAAOb,IAAI2xD,gBAAgB7xD,KAClB,GAvGX8xD,CAAc53B,GAQhB,SAAS63B,EAAY/gC,EAAyCkJ,EAA0BpkB,EAAa9V,GAAa,IAAD,EACzGkmB,EAAK,UAAG8K,EAAGouB,qBAAN,aAAG,EAAkBl5B,MAC5BA,GAASA,EAAM1d,QACjB0d,EAAM,GAAG7G,OAAO/D,MAAK,SAAC+D,GACpB,IAAM2yC,EAAY71C,KAAKI,MAAM8C,QACS5H,IAAnCu6C,EAAU,GAAGC,mBAAgF,SAA7CD,EAAU,GAAGC,kBAAkB,GAAGR,QACnFv3B,EAASulB,oBAEPyS,mBAAQF,IACVA,EAAU,GAAGG,aAAartD,SAAQ,SAAC6+C,GACjCA,EAAKr7B,UAAYxS,EACjB6tC,EAAKp7B,SAAWvoB,EhDiCnByjB,GgDhCgCuuC,EAAU,GAAGG,cACpCrtD,SAAQ,SAAA0kB,GACZ,GAAqB,WAAjBA,EAAQ9J,MAAsC,WAAjB8J,EAAQ9J,KAAzC,CACA,IAAMuiB,EAAa1Y,KACnBlU,OAAO+D,OAAO6oB,EAAYzY,GAC1B0Q,EAAS0W,gBAAgB3O,aAmHrC,IAAOv4B,EAAKI,KAALJ,EAKP,OAAO,gBAACm3C,GAAA,EAAD,WACP,eAAC,GAAD,CACuB1J,QAAS,WA9I9Bia,GAAQ,IA8IoD/xC,KAAM3V,EAAE,iBAA9D,gBAEN,sBAAKokB,MAAO,CAACzrB,MAAM,OAAQC,OAAO,QAAS48B,gBAAgB,UAAWsc,WAAW,WAEjF,eAAC,GAAD,CACoBrE,QAAS,kBAAIka,KAAgBhyC,KAAM3V,EAAE,kBAArD,iBAEN,eAAC,GAAD,CACsBytC,QAAS,kBAlK/B,WAAuB,IAAD,IACpB1xB,QAAQC,IAAI,eAAZ,UAA4ByrC,EAAUtiB,eAAtC,aAA4B,EAAmBujB,cAC/C,UAAAjB,EAAUtiB,eAAV,SAAmB+iB,QAgKcS,IAAchzC,KAAM3V,EAAE,gBAAjD,eAEN,wBAAOgW,KAAK,OAAO4yC,OAAO,mBAAmBz6C,IAAKs5C,EAAWrjC,MAAO,CAACiuB,QAAQ,QAC3Ea,SACE,SAAC5rB,GACC+gC,EAAY/gC,EAAIkJ,EAAUjc,EAAaI,MAAMvF,YAAYhD,KAAMmI,EAAaI,MAAMvF,YAAY9C,cAKtG,sBAAK8X,MAAO,CAACzrB,MAAM,OAAQC,OAAO,QAAS48B,gBAAgB,UAAWsc,WAAW,WACjF,eAAC,GAAD,6BAAiB5D,GAAjB,IAAwBltB,KAAMljB,EAAMw/B,QAAS,kBAAMoqB,GAAQ,IAAQzC,MAAO,EAAGC,MAAO,EAAGC,OAAQ,GAAI7iC,MAAO,mBAG5GklC,GAAgB9Z,YAAc,kBC5M9B,IAAM4I,GAAYC,aAAW,CAC3BC,KAAM,CACJ5E,QAAS,GAEX6E,iBAAkB,CAChBtJ,SAAU70C,IAAiB,QAAU,SAI5BuwD,GAA2C,SAAC3a,GACvD,IAAMv5B,EAAQu5B,EAAMjgB,OAAO1Z,aAAaI,MAClCpF,EAAYykC,cAAY,kBAAMr/B,EAAMpF,aACpConC,EAAUL,KAEVwS,EAAuB,eAAC,KAAD,UAAY,kBACvC,eAACjS,GAAA,EAAD,CACE9e,KAAM,eAAC,KAAD,CAA2B+e,UAAU,gBAC3CC,YAAa,eAAC,KAAD,CAAc3yB,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OAASw+C,UAAU,UACxFE,UAAWL,EAAQH,KACnBS,SAAUtiC,EAAMpF,UAAWnD,KAAK,iBAChC8mC,SAAU,WACRv+B,EAAMpF,WAA0B,IAAdA,EAElBoF,EAAMo0C,mCAGNC,EAA4B,eAAC,KAAD,UAAY,kBAC5C,eAACnS,GAAA,EAAD,CACE9e,KAAM,eAAC,KAAD,CAA2B+e,UAAU,gBAC3CC,YAAa,eAAC,KAAD,CAAc3yB,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OAASw+C,UAAU,UACxFE,UAAWL,EAAQH,KACnBS,SAAS,EAAO7qC,KAAK,sBACrB8mC,SAAU,kBAMPlzC,EAAKI,KAALJ,EAEP,OAAO,gBAACm3C,GAAA,EAAD,WACL,sBAAK/yB,MAAO,CAACzrB,MAAM,OAAQC,OAAO,QAAS48B,gBAAgB,UAAWsc,WAAW,WACjF,eAACqC,GAAA,EAAD,CAAkB/vB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAOf,KAAM,SAC9D+vB,QAAS0U,EACTzU,MAAO,eAAC+C,GAAA,EAAD,CAAYJ,UAAWL,EAAQF,iBAA/B,SAAkDz2C,EAAE,wBAE7D,sBAAKokB,MAAO,CAACzrB,MAAM,OAAQC,OAAO,QAAS48B,gBAAgB,UAAWsc,WAAW,WACjF,eAACqC,GAAA,EAAD,CAAkB/vB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAOf,KAAM,SAC9D+vB,QAAS4U,EACT3U,MAAO,eAAC+C,GAAA,EAAD,CAAYJ,UAAWL,EAAQF,iBAA/B,SAAkDz2C,EAAE,iCAKjE6oD,GAAsBnb,YAAc,wBClDpC,IAAM4I,GAAYC,aAAW,CAC3BC,KAAM,CACJ5E,QAAS,GAEX6E,iBAAkB,CAChBtJ,SAAU70C,IAAiB,QAAU,SAI5B2wD,GAAyC,SAAC/a,GACrD,IAAMv5B,EAAQu5B,EAAMjgB,OAAO1Z,aAAaI,MAClCtB,EAAwB2gC,cAAY,kBAAMr/B,EAAMtB,yBAChD61C,EAASlV,cAAY,kBAAMr/B,EAAM5E,kBACjC4mC,EAAUL,KAUV6S,EAAyB,eAAC,KAAD,UAAY,kBACzC,eAACtS,GAAA,EAAD,CACE9e,KAAM,eAAC,KAAD,CAA2B+e,UAAU,gBAC3CC,YAAa,eAAC,KAAD,CAAc3yB,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OAASw+C,UAAU,UACxFE,UAAWL,EAAQH,KAAMS,QAAStiC,EAAM5E,eAAgBmjC,SAAU,WAClEv+B,EAAMtB,sBAAkD,WAA1BA,EAAqC,OAAS,SAV9EsB,EAAM5E,gBAAkBm5C,EACxBv0C,EAAMo0C,8BAWH38C,KAAK,kBAEHpM,EAAKI,KAALJ,EAEP,OAAO,gBAACm3C,GAAA,EAAD,WACL,sBAAK/yB,MAAO,CAACzrB,MAAM,OAAQC,OAAO,QAAS48B,gBAAgB,UAAWsc,WAAW,WACjF,eAACqC,GAAA,EAAD,CAAkB/vB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAOf,KAAM,QAAS8oB,SAAS,OAChFiH,QAAS+U,EACT9U,MAAO,eAAC+C,GAAA,EAAD,CAAYJ,UAAWL,EAAQF,iBAA/B,SAAkDz2C,EAAE,wBAIjEipD,GAAoBvb,YAAc,sBChBlC,IAAMwK,GAAQ4H,aAAY,CACxBC,QAAS,CACPC,QAAS,CAAEC,KAAM,WACjBC,UAAW,CAAED,KAAM,cAIjBmJ,GAAc,CAClB,IAAK,CACHC,OAAQ,MACRC,aAAc,MACd3wD,MAAOL,IAAiB,OAAS,OACjCM,OAAQN,IAAiB,OAAS,OAClC65C,UAAW,WAITmE,GAAYC,aAAW,CAU3BoQ,KAAK,CACH1qD,SAAU,WACVtD,MAAO,OACP0rB,KAAM,QACNzE,QAAS,EACTsyB,WAAY,iBAEdqX,WAAW,CACTttD,SAAU,WACVtD,MAAO,OACPinB,QAAS,EACTyE,KAAM,EACN6tB,WAAY,iBAGdsX,QAAQ,CACNvtD,SAAU,WACVtD,MAAO,OACP0rB,MAAO,IACPzE,QAAS,EACTwF,IAAK,EACL8sB,WAAY,iBAEduX,cAAc,CACZxtD,SAAU,WACVtD,MAAO,OACPinB,QAAS,EACTyE,KAAM,EACNe,IAAI,EACJ8sB,WAAY,iBAGdwX,QAAQ,CACNztD,SAAU,WACVtD,MAAO,OACPysB,KAAM,IACNxF,QAAS,EACTsyB,WAAY,iBAEdyX,cAAc,CACZ1tD,SAAU,WACVtD,MAAO,OACPinB,QAAS,EACTwF,IAAK,EACL8sB,WAAY,iBAGd0X,KAAK,cACHvX,QAAS,eACTz5C,OAAQ,GACRD,MAAO,GACPsD,SAAS,WACT+kD,OAAQ,UACRxrB,gBAAiB,UACjB4c,MAAO,EACP/tB,KAAM,EACNqB,OAAO,GACJ0jC,IAELS,WAAW,cACTxX,QAAS,eACTz5C,OAAQ,GACRqD,SAAS,WACT+kD,OAAQ,UACRxrB,gBAAiB,UACjB4c,MAAO,EACP/tB,KAAK,EACLqB,OAAO,GACJ0jC,IAEL3V,UAAU,CACRx3C,SAAU,WACVtD,MAAO,OACP+sB,OAAQ,EACRksB,QAAS,EACTvtB,KAAM,GACNylC,QAAS,OACTxJ,SAAW,IACXjI,cAAe,QAGjB0R,aAAa,CACX9tD,SAAU,WACVtD,MAAO,OACPysB,IAAK,GACLwsB,QAAS,EACTvtB,MAAO,GACPylC,QAAS,OACTxJ,SAAW,IACXjI,cAAe,QAGjB2R,QAAQ,CAACrxD,MAAM,QACfsxD,aAAa,CAACtxD,MAAM,OAAQ05C,QAAQ,OAAQ+H,WAAW,cAGnD8P,G,mDACJC,gBAAsCp8C,E,KACtCq8C,SAAU,E,KAGVC,SAAW,E,KACXC,OAAS,KAGPC,IAA4B,EAKzB,IAAMC,GAA6C,SAACtc,GACzD,MAA4BA,EAAMjgB,OAA3BjzB,EAAP,EAAOA,IAAKuZ,EAAZ,EAAYA,aAEZ,EAAwBmgC,KAAMtF,UAAkB,GAAhD,mBAAOtxC,EAAP,KAAa4pD,EAAb,KACA,EAA8BhT,KAAMtF,UAAkB,GAAtD,mBAAOqb,EAAP,KAAgBC,EAAhB,KAEA,EAAkChW,KAAMtF,UAAkB,GAA1D,mBAAOub,EAAP,KAAkBC,EAAlB,KAEA,EAAwClW,KAAMtF,UAAkB,GAAhE,mBAAOyb,EAAP,KAAqBC,EAArB,KAEA,SAASC,IACP/vD,EAAIqtC,cAAc/X,IAAI,aACtBs6B,GAAa,GAEf,SAASI,IACPhwD,EAAIqtC,cAAchwC,OAAO,aACzBuyD,GAAa,GAoBf,IACMrT,EADYrC,kBAAe,IAAIgV,IACZ/kB,QACnB8lB,EAAe/V,kBAAuB,MACtCgW,EAAchW,kBAAuB,MAG3C,EAAsCR,KAAMtF,SAA4B,IAAxE,mBAAO+b,EAAP,KAAoBC,EAApB,KACA,EAAkC1W,KAAMtF,SAAuB,MAA/D,mBAAOic,EAAP,KAAkBC,EAAlB,KACA,EAA0C5W,KAAMtF,SAAuB,MAAvE,mBAAOmc,EAAP,KAAsBC,EAAtB,KACA,EAAsC9W,KAAMtF,SAAuB,MAAnE,mBAAOqc,EAAP,KAAoBC,EAApB,KACA,EAA4ChX,KAAMtF,SAAuB,MAAzE,mBAAOuc,EAAP,KAAuBC,EAAvB,KAEO5rD,EAAKI,KAALJ,EACD22C,EAAUL,KAuBhB,IAAMuV,EAAgB7X,cAHtB,WACE,OAAOh5C,EAAIiY,WAAW,IAAMjY,EAAI6C,MAAM,GAAK7C,EAAIonB,OAAO,IAAM,MAkE9D,SAASm9B,EAAaptC,EAAuB0V,GAC3C,IAAIs3B,GAAW,EAYb,MAXgB,eAAdhtC,EAAKoD,KACP4pC,EAAWhtC,EAAKmrC,WAAa/oC,EAAaI,MAAM/E,iBAAiBk8C,iBAC3C,gBAAd35C,EAAKoD,KACb4pC,EAAWhtC,EAAKmrC,WAAa/oC,EAAaI,MAAM/E,iBAAiBm8C,kBAC3C,eAAd55C,EAAKoD,OACb4pC,EAAWhtC,EAAKmrC,WAAa/oC,EAAaI,MAAM/E,iBAAiButC,kBAM1D,uBAAK/4B,MAAO,CAACnoB,SAAS,WAAYo2C,QAAQ,OAAQ+H,WAAW,SAAUtI,WAAW,QAAlF,cAA6FqN,EAAW,eAAC,KAAD,CAAc/6B,MAAO,CAACxE,QAAQ,IAAK3jB,SAAS,WAAY61C,WAAW,QAAS3E,SAAS70C,IAAiB,MAAQ,WAAe,eAAC,KAAD,CAAc8rB,MAAO,CAACxE,QAAQ,IAAK3jB,SAAS,WAAY61C,WAAW,QAAS3E,SAAS70C,IAAiB,MAAQ,WAC1V,gBAACgnD,GAAA,EAAD,CAA8Bl7B,MAAO,CAAC+oB,SAAS70C,IAAiB,QAAU,MAAOw5C,WAAWx5C,IAAiB,QAAU,OACrHm1C,QAAS,WAAQ5lB,EAAM1V,EAAKmrC,WAD9B,cAEKnrC,EAAKkiC,QAFKliC,EAAKmrC,aA7ExBzQ,sBAAU,cAIA,CAACgf,EAAetU,EAAO6S,UAqBjCvd,sBAAU,WACR,IAAMW,EAAY,SAAChzC,GAEc,IAA3BQ,EAAIqtC,cAActrC,OACfvC,EAAE81C,UAAY91C,EAAEwxD,SAAYxxD,EAAEyxD,QA2BvC,OAFA50D,OAAOywB,iBAAiB,UAAW0lB,GAE5B,WACLn2C,OAAOk5C,oBAAoB,UAAW/C,MAGhC,IAwBV,IAAM0e,EAAkC,CAAC,gBAAC5M,GAAA,EAAD,CAAUl7B,MAAO,CAACiuB,QAAQ,OAAQqR,cAAc,SAAUvR,UAAU,SAAUL,WAAW,SAAzF,UAAyH,eAAC,GAAD,gBAAqB5D,IAAS,eAACiJ,GAAA,EAAD,UAAW,eAAC,GAAD,CACnLxhC,KAAM3V,EAAE,qBAAsBytC,QAASsd,GAA3D,yBAD+I,eAInJ,SAASoB,EAAa52C,GACpB,IACI62C,EACAC,EAFE74C,EAAK,GAGE,eAAT+B,GACF62C,EAAYE,GACZD,EAAa,eAAC/M,GAAA,EAAD,CAA+Bl7B,MAAO,CAAC+oB,SAAS70C,IAAiB,QAAU,OAA3E,SAAoF,eAAC,GAAD,gBAAsB41C,KAAxF,cACd,gBAAT34B,GACR62C,EAAYG,GACZF,EAAa,eAAC/M,GAAA,EAAD,CAA8Bl7B,MAAO,CAAC+oB,SAAS70C,IAAiB,QAAU,OAA1E,SAAmF,eAAC,GAAD,gBAAyB41C,KAA1F,cAE/Bke,EAAY5M,GAEZ6M,EAAa,eAAC/M,GAAA,EAAD,CAAoCl7B,MAAO,CAAC+oB,SAAS70C,IAAiB,QAAU,OAAhF,SAAyF,eAAC,GAAD,gBAA2B41C,KAAlG,mBAboC,oBAelDid,GAfkD,IAerE,2BAA+B,CAAC,IAArBh5C,EAAoB,QACzBA,EAAKoD,OAASA,GAChB/B,EAAG6C,KAAKkpC,EAAaptC,EAAMi6C,KAjBsC,8BAqBrE,OADIC,GAAY74C,EAAG6C,KAAKg2C,GACjB74C,EAET,SAAS84C,GAAapP,GAChBA,IACF3oC,EAAaI,MAAM/E,iBAAiBk8C,iBAAmB5O,EACvD3oC,EAAaI,MAAMo0C,8BAErBuC,EAAa,MAEf,SAASiB,GAAiBrP,GACpBA,IACF3oC,EAAaI,MAAM/E,iBAAiBm8C,kBAAoB7O,EACxD3oC,EAAaI,MAAMo0C,8BAErByC,EAAiB,MAEnB,SAAShM,GAAetC,GAClBA,IACF3oC,EAAaI,MAAM/E,iBAAiButC,iBAAmBD,EACvD3oC,EAAaI,MAAMo0C,8BAErB2C,EAAe,MAQjB,SAASc,GAAcllC,GACrB1vB,UAAU0yC,aAAaC,mBACtB34B,KAAKw5C,GACLv5C,OAAM,WAAQkK,QAAQC,IAAI,+BAI7B,IAAMtN,GAAOslC,cAAY,iBAAO,CAC9ByY,MAAOl4C,EAAaI,MAAMrF,UAC1Bo9C,MAAOn4C,EAAaI,MAAMzC,YAC1By6C,MAAOp4C,EAAaI,MAAMpF,UAC1BtC,QAASsH,EAAaI,MAAMlF,QAAQxC,YAEhC2/C,GAAU1e,EAAMt1C,OAChBi0D,GAAW3e,EAAMt1C,OAAwB,GAAfs1C,EAAMt1C,OAAe,GAErD,OAAO,iCACP,sBAAKo+C,UAAWL,EAAQoT,aAAxB,SACE,gBAAC+C,GAAA,EAAD,CAAUhV,IAAI,EAAMnB,QAASA,EAA7B,UACE,sBAAKK,UAAWl5C,EAAO64C,EAAQ8S,cAAgB9S,EAAQ6S,QAAvD,SACE,eAAC,GAAD,CAASzsD,KAAM6vD,GAASxoC,MAAO,CAACzrB,MAAO,MAAOo0D,MAAO,QACnDtf,QAAY,WAEVp2C,OAAO2pB,KAAK,IAAK,UAHrB,SAKI,sBAAKg2B,UAAWL,EAAQiT,KAAxB,SACE,sBAAK74C,IAAKi8C,GAAa5oC,MAAO,CAACzrB,MAAM,GAAIC,OAAO,GAAIqD,SAAS,WAAYmpB,IAAI9sB,IAAiB,OAAS,MAAO+rB,KAAK,OAAQmuB,UAAWl6C,IAAiB,WAAa,YAAas6C,IAAI,WAI3L,sBAAKoE,UAAWl5C,EAAO64C,EAAQgT,cAAgBhT,EAAQ+S,QAAvD,SACA,eAAC,GAAD,CAAS3sD,KAAM6vD,GAASxoC,MAAO,CAACzrB,MAAO,MAAOo0D,MAAO,SACnDtf,QAAY,WACV71C,UAAU6tD,UAAUwH,UAAU51D,OAAOC,SAASC,MA9LpDmzD,GADCD,IA6LC,SAKE,sBAAKzT,UAAWL,EAAQiT,KAAxB,SACE,sBAAK74C,IC9aF,qoCD8aqBqT,MAAO,CAACzrB,MAAM,GAAIC,OAAO,GAAIqD,SAAS,WAAYmpB,IAAI9sB,IAAiB,OAAS,OAAQ+rB,KAAK/rB,IAAiB,MAAQ,OAAQk6C,UAAWl6C,IAAiB,WAAa,YAAcs6C,IAAI,gBAQ3N,uBAAKzkC,IAAK88C,EAAcjU,UAAWL,EAAQlD,UAA3C,UACI,sBAAKrvB,MAAO,CAACnoB,SAAS,WAAYooB,KAAK,QAASe,IAAI,OAApD,SACE,eAAC,GAAD,CAASroB,KAAM6vD,GACbnf,QAAY,WArMhBia,GADC5pD,IAqMC,SAKU,sBAAKk5C,UAAWl5C,EAAO64C,EAAQkT,WAAalT,EAAQiT,KAApD,SACN,sBAAK74C,IAAKm8C,GAAU9oC,MAAO,CAACzrB,MAAM,GAAIC,OAAO,GAAIqD,SAAS,WAAYmpB,IAAI9sB,IAAiB,OAAS,MAAO+rB,KAAK,SAAUmuB,UAAWl6C,IAAiB,WAAa,YAAas6C,IAAI,WAS5L,eAACka,GAAA,EAAD,CAAUhV,IAAI,EAAsBnB,QAASA,EAA7C,SACA,uBAAKK,UAAWl5C,EAAO64C,EAAQ4S,WAAa5S,EAAQgQ,KAApD,UACE,gBAAC,KAAD,CAAkBzO,MAAOA,GAAzB,UAEA,eAAC,GAAD,CAAgBM,OAAQ16C,EAAM4jC,MAAO,EAAG3kC,KAAM6vD,GAASrgD,MAAOmC,GAAKg+C,MAAQ,UAAY,YACrF,aAAW,UAAUjf,QAAS,WAC5Bl5B,EAAaI,MAAMzC,aAAexD,GAAKg+C,MACnCn4C,EAAaI,MAAMzC,cACrBqC,EAAaI,MAAMrF,WAAY,GAEjCiF,EAAaI,MAAMo0C,8BAErB/Q,YAAgB,SAAC1wB,GACfklC,KACAhB,EAAiBlkC,EAAGouB,gBAVxB,SAaGhnC,GAAKg+C,MAAQ,eAAC,KAAD,CAAgBtoC,MAAO,CAACzrB,MAAMk0D,GAAUj0D,OAAOi0D,GAAUtgD,MAAM,WACzE,eAAC,KAAD,CAAe6X,MAAO,CAACzrB,MAAMk0D,GAAUj0D,OAAOi0D,GAAUtgD,MAAM,aAEnEg/C,EAAgB,eAAC4B,GAAA,EAAD,CAAMlX,SAAUsV,EAAe6B,aAAa,EAAMhpC,MAAO,CAACoxB,WAAW,IACpFx0B,KAAMqsC,QAAQ9B,GAAgBjuB,QAAS,WAAQivB,GAAiB,KADjD,SAEdJ,EAAa,sBACNp+C,EAEV,eAAC,GAAD,CAAgByqC,OAAQ16C,EAAM4jC,MAAO,EAAG3kC,KAAM6vD,GAASrgD,MAAOmC,GAAK+9C,MAAQ,UAAY,YAAc,aAAW,MAE9Ghf,QAAY,WACVl5B,EAAaI,MAAMrF,WAAaZ,GAAK+9C,MAChCl4C,EAAaI,MAAMrF,YACtBiF,EAAaI,MAAMzC,aAAc,GAEnCqC,EAAaI,MAAMo0C,8BAErB/Q,YAAgB,SAAC1wB,GACfklC,KACAlB,EAAahkC,EAAGouB,gBAXpB,SAcGhnC,GAAK+9C,MAAQ,eAAC,KAAD,CAAYroC,MAAO,CAACzrB,MAAMk0D,GAAUj0D,OAAOi0D,GAAUtgD,MAAM,WACvEmC,GAAKzB,QACH,eAAC,QAAD,CAAM8qB,KAAMu1B,KAAelpC,MAAO,CAACzrB,MAAMk0D,GAAUj0D,OAAOi0D,GAAUtgD,MAAM,SAAUA,MAAM,UACxF,eAAC,KAAD,CAAS6X,MAAO,CAACzrB,MAAMk0D,GAAUj0D,OAAOi0D,GAAUtgD,MAAM,aAE/D8+C,EAAY,eAAC8B,GAAA,EAAD,CAAMlX,SAAUoV,EAAW+B,aAAa,EAAMhpC,MAAO,CAACoxB,WAAW,IAC5Ex0B,KAAMqsC,QAAQhC,GAAY/tB,QAAS,WAAQgvB,GAAa,KAD7C,SAEVH,EAAa,qBACNp+C,EAEV,eAAC,GAAD,CAAgByqC,OAAQ16C,EAAM4jC,MAAO,EAAG3kC,KAAM6vD,GAASrgD,MAAOmC,GAAKi+C,MAAQ,UAAY,YAAa,aAAW,SAC7Glf,QAAY,WAEVtd,GAAW0S,eAAehM,YAAY3d,GAAYrB,YAAY,GAE9DtD,EAAaI,MAAMpF,WAAab,GAAKi+C,MACrCp4C,EAAaI,MAAMo0C,6BAEnBwB,IAAoB,GAEtBvS,YAAgB,SAAC1wB,GACfklC,KACAd,EAAepkC,EAAGouB,gBAZtB,SAeGhnC,GAAKi+C,MAAQ,eAAC,KAAD,CAAcvoC,MAAO,CAACzrB,MAAMk0D,GAAUj0D,OAAOi0D,GAAUtgD,MAAM,WACvE,eAAC,KAAD,CAAW6X,MAAO,CAACzrB,MAAMk0D,GAAUj0D,OAAOi0D,GAAUtgD,MAAM,aAE/Dk/C,EAAc,eAAC0B,GAAA,EAAD,CAAMlX,SAAUwV,EAAa2B,aAAa,EAAMhpC,MAAO,CAACoxB,WAAW,IAChFx0B,KAAMqsC,QAAQ5B,GAAcnuB,QAAS,WAAQkiB,GAAe,KAD/C,SAEZ2M,EAAa,qBACNp+C,EAKV,eAAC,GAAD,gBAAiBmgC,IAaf,eAAC,GAAD,CAAgBsK,OAAQ16C,EAAM4jC,MAAO,EAAG3kC,KAAM6vD,GAASrgD,MAAO,UAC5D,aAAW,WAAWkhC,QAAS,SAACnmB,GAC9BiwB,EAAO+S,QAAS,IAAI3zC,MAAO42C,aAKzBxC,KAgBJ/S,YAAgB,SAAC1wB,GACfskC,EAAkBtkC,EAAGouB,eACrBoV,GAAgB,IAzBpB,SA4BI,eAAC,KAAD,CAAc1mC,MAAO,CAACzrB,MAAMk0D,GAAUj0D,OAAOi0D,GAAUtgD,MAAM,aAEjE,eAAC4gD,GAAA,EAAD,CAAMlX,SAAU0V,EAAgByB,aAAa,EAAOhpC,MAAOymC,EAAe,CAACrV,WAAW,GAAInD,QAAQ,SAAW,CAACmD,WAAW,GAAInD,QAAQ,QACnIrxB,KAAMqsC,QAAQ1B,GAAiBle,QAAS,WAAQ/lB,YAAW,WAAKojC,GAAgB,KAAQ,MAAOxtB,QAAS,WAzL9GsuB,EAAkB,OAwLd,SAEGM,OAIJvB,EAAY,eAAC3U,GAAA,EAAD,CAASh1B,KAAM2pC,EAAWrtB,QAAS0tB,EAC9C/U,SAAUiV,EAAY/lB,QAAS+Q,aAAc,CAACC,SAAS,MAAOC,WAAW,QACzEoX,gBAAkB,WAFP,SAGX,eAAC,GAAD,CAAiB3lC,MAAOmjC,EAAY/8B,OAAQigB,EAAMjgB,gBACvClgB,cAMnBy8C,GAAO9c,YAAc,S,aE1kBf0b,GAAc,CAClB,IAAK,CACH78C,MAAM,aAER,UAAW,CACTA,MAAM,cAER,WAAY,CACVA,MAAM,eAIGkhD,GAAclX,aAAW,CACpCmX,KAAK,CACHzxD,SAAU,WACVtD,MAAO,OACPC,OAAQ,OACRwsB,IAAK,EACLf,KAAM,EACNmR,gBAAiB,WAEnBwW,KAAK,CACH/vC,SAAU,WACVtD,MAAO,OACPC,OAAQ,OACRwsB,IAAK,EACLf,KAAM,GAERspC,SAAQ,cACNh1D,MAAM,OACNC,OAAO,OACPqD,SAAS,WACTooB,KAAK,MACL9X,MAAM,YACNy0C,OAAO,WACJoI,IAGL/e,KAAI,cACF1xC,MAAM,OACNC,OAAO,OACPqD,SAAS,WACTm2C,MAAM,QACN7lC,MAAM,aACH68C,IAGLwE,YAAc,CACZhuC,QAAS,EACTsyB,WAAY,kBAGd2b,MAAO,CACLjuC,QAAS,EACTsyB,WAAY,mBAIH4b,GAAgBvX,aAAW,CAuBtCwX,gBAAiB,CACfC,WAAY,UACZn0C,OAAQ,EACRo0C,UAAW,aACXC,eAAgB,cAChBv1D,MAAO,GACP0wD,OAAQ,cACR8E,WAAY,kBACZC,YAAa,yBACbpN,OAAQ,cAEVqN,kBAAmB,CACjBL,WAAY,YACZn0C,OAAQ,EACRo0C,UAAW,aACXC,eAAgB,cAChBt1D,OAAQ,KACRD,MAAO,MACPm5C,WAAY,MACZuX,OAAQ,gBACRiF,UAAW,wBACXvN,aAAc,wBACdC,OAAQ,aACR7O,UAAW,YASFoc,GAAehY,aAAW,CACrC9C,UAAW,CACT96C,MAAM,QAER03B,MAAO,SAAC6d,GAAD,MAA2B,CAEhCsgB,eAAgB,QAChBC,aAAc,QACdrU,WAAY,SACZ3H,WAAY,OACZic,SAAU,OACVC,WAAY,SACZh2D,MAAO,SAETi2D,MAAO,CACLvc,QAAS,OACTsc,WAAY,SACZ/c,QAAS,EACTyX,OAAQ,EACR1wD,MAAO,QAETk2D,KAAM,SAAC3gB,GAAD,MAA2B,CAC/BmE,QAAS,OACTmc,eAAgB,QAChBC,aAAc,QACdrU,WAAY,SACZ3H,WAAY,OACZic,SAAU,OACVC,WAAY,SACZxhB,SAAUe,EAAMf,SAChBv0C,OAAQs1C,EAAMt1C,OACdD,MAAO,OACPi5C,QAAS,M,UCrIb,SAASkd,GAAa5gB,GAYpB,MAXc,CACZv1C,MAAOu1C,EAAMnxC,KACbnE,OAAQs1C,EAAMnxC,KACdwP,MAAM,GACNipB,gBAAgB,GAChB6iB,cAAe,OACfqW,SAAU,OACVvhB,SAAuB,GAAbe,EAAMnxC,KAChBs1C,QAAQ,gBAQZ,SAAS0c,GAAW3qC,EAAc8pB,GAChC,IAAMsS,EAAS,CACb7nD,MAAOu1C,EAAMnxC,KACbnE,OAAQs1C,EAAMnxC,KACdiyD,YAAa,QACbC,YAAa,EACbC,YAAa,IAGf,OAAOvjD,OAAO+D,OAAO0U,EAAOo8B,GAG9B,IAAMlK,GAAYC,aAAW,CAC3B4Y,YAAa,SAACjhB,GACZ,IAAM9pB,EAAQ0qC,GAAa5gB,GAK3B,OAJAviC,OAAO+D,OAAO0U,EAAO,CAAC+tB,UAAU,QAC9BmI,cAAe,QACbpM,EAAMsS,QAASuO,GAAW3qC,EAAO8pB,GAE9B9pB,GAETgrC,WAAY,SAAClhB,GACX,IAAM9pB,EAAQ0qC,GAAa5gB,GAG3B,OAFIA,EAAMsS,QAASuO,GAAW3qC,EAAO8pB,GAE9B9pB,KAKEirC,GAA6C,SAACnhB,GACzD,IAAMyI,EAAUL,GAAUpI,GAE1B,OAAO,eAAC,KAAD,UAAW,WAGhB,IAAImN,EAAU,GACRiU,EAAUphB,EAAM5hC,WAA2C,SAA9B4hC,EAAM5hC,UAAU7M,OAAO,GACrD6vD,IACephB,EAAM9hC,KAAKlO,MAAM,KACzB9C,SAAQ,SAAAN,GAAC,OAAIugD,GAAWvgD,EAAIA,EAAEmgB,UAAU,EAAE,GAAK,MACzDogC,EAAUA,EAAQpgC,UAAU,EAAE,IAEhC,IAAMle,EAAOmxC,EAAMsS,OA7CA,EA6CStS,EAAMnxC,KAAwBmxC,EAAMnxC,KAEhE,OAAOuyD,EACL,eAACC,GAAA,EAAD,CAAQx+C,IAAKm9B,EAAM5hC,UAAW0qC,UAAWL,EAAQwY,cACjD,eAACI,GAAA,EAAD,CAAQvY,UAAWL,EAAQyY,WAA3B,SACE,sBAAKhrC,MAAO,CAACxrB,OAAOmE,EAAMpE,MAAMoE,EAAMo1C,UAAU,SAC9CmI,cAAc,SAAUjI,QAAQ,aAAcsc,WAAW,UAD3D,SAECtT,UAITgU,GAAe3hB,YAAc,iBAEtB,IAAM8hB,GAAc,SAACthB,GAAD,OACzBwG,KAAM+a,SAAQ,kBAAM,eAAC,GAAD,gBAAoBvhB,MAExC,CAACA,EAAM5hC,UAAW4hC,EAAMsS,OAAQtS,EAAMp4B,OAAQo4B,EAAM9hC,KAAM8hC,EAAMnxC,KAAMmxC,EAAM9pB,SCtEvE,SAASsrC,GAAgBC,GAC9B,IAAMC,EAAW,IAAIj5C,KAAKg5C,GACpB/4C,EAAM,IAAID,KACVk5C,EAAOj5C,EAAI6W,gBAAkBmiC,EAASniC,cAAgBmiC,EAASniC,mBAAgB1f,EAC/E+hD,EAAQD,GAAQj5C,EAAI8W,aAAekiC,EAASliC,WAAakiC,EAASliC,WAAa,OAAI3f,EACnFgiD,EAAQF,GAAQC,GAASl5C,EAAIo5C,YAAcJ,EAASI,UAAaJ,EAASI,eAAYjiD,EACtF6M,EAAI,UAAMg1C,EAAShiC,WAAf,YAA6BgiC,EAAS/hC,aAAtC,YAAsD+hC,EAASrC,cAGzE,MAFe,UAAMsC,EAAI,UAAMA,EAAN,KAAgB,IAA1B,OAA+BC,EAAK,UAAMA,EAAN,KAAiB,IAArD,OAA0DC,EAAI,UAAMA,EAAN,KAAgB,IAA9E,OAAmFn1C,GC1B7F,SAASq1C,GAAShwD,EAAYiwD,GAEnC,IAAI34D,EAAK,GAAI47C,EAAO,GAAIgd,EAAK,GAgB7B,OAfID,EAAU,IAAMC,EAAK54D,EAAK24D,EAAU,GAAI/c,EAAO,UAC1C+c,EAAU,IACjB34D,EAAO24D,EAAU,GACjBC,EAAOD,EAAU,GAAKA,EAAU,GAAKA,EAAU,GAC/C/c,EAAS+c,EAAU,GAAK,QAAU,WAGlCC,EAAOD,EAAU,GACjB34D,EAAO24D,EAAU,IACjB/c,EAAU+c,EAAU,IAAIA,EAAU,IAAO,QAAU,UAEjDr3D,EAAU,IAAIrC,IAAIe,MACpB47C,EAAS,SAGJ,oBAAa57C,KAAMA,EAAM47C,OAAQA,EAAQid,IAAI,aAA7C,SAA2DD,GAAnDlwD,GAEV,SAASowD,GAAiB16C,GAS/B,IARA,IAMIu6C,EANEI,EAA2B,GAE3BC,EAAS,iDACTC,EAAY,IAAIC,OAAO,WAAIF,EAAJ,oBACpBA,EADoB,oFAEeA,EAFf,SAIzBtrC,EAAQ,EAC+C,QAAnDirC,EAAYM,EAAUE,KAAK/6C,EAAKlW,MAAMwlB,MAAmB,CAC/D,IAAM0rC,EAASh7C,EAAKlW,MAAMwlB,EAAOA,EAAQirC,EAAUxuB,OAC/CivB,GACFL,EAAWj6C,KAAK,gCAAmBs6C,GAAR1rC,IAE7BqrC,EAAWj6C,KAAK45C,GAAShrC,EAAQ0rC,EAAO7xD,OAAQoxD,IAChDjrC,GAAS0rC,EAAO7xD,OAASoxD,EAAU,GAAGpxD,OAIxC,OAFAwxD,EAAWj6C,KAAK,gCAAmBV,EAAKlW,MAAMwlB,IAAnBA,IAEpBqrC,EFmDTd,GAAY9hB,YAAc,cGxE1B,IAAMkjB,GAAsD,CAC1Dj7C,KAAM,QACNtB,OAAQ,MACRglB,OAAQ,QACRrd,IAAK,QACL60C,QAAS,UAELC,GAAsD,CAC1Dn7C,KAAM,QACNtB,OAAQ,MACRglB,OAAQ,QACRrd,IAAK,QACL60C,QAAS,UAIEE,GAAsE,SAAC7iB,GAElF,IAAMzF,GAA+B,QAAvByF,EAAMvsB,QAAQ3L,MAAkBk4B,EAAMvsB,QAAQ3L,KAAoB,GAC1Eg7C,EAAa9iB,EAAM8iB,WAAavoB,EAChC0E,EAAWe,EAAMf,SAAW1E,EAClC,EAAsCyF,EAAMjgB,OAArCqJ,EAAP,EAAOA,SAAU/iB,EAAjB,EAAiBA,aAAcvZ,EAA/B,EAA+BA,IAEzB4E,EAAkD,YAArCsuC,EAAMvsB,QAAQhM,KAAKzX,MAAM,KAAK,GAAmB,QAAgD,UAArCgwC,EAAMvsB,QAAQhM,KAAKzX,MAAM,KAAK,GAAiB,MAAQ,QAEtI,OAAO,eAAC,KAAD,UAAW,WAChB,IAAM6X,EAAY25C,GAAgBxhB,EAAMvsB,QAAQ5L,WAC1Ck7C,EAAW7xD,EAAYk4B,EAAS/B,gBAAkBu7B,GAAgBF,GAGlEM,EAAY9xD,EAAYk4B,EAAS/B,gBAAkB,mBAAqB,yBACxE47B,EAAYjjB,EAAMvsB,QAAQ/L,MAAQrB,EAAaW,QAErD,OAAO,eAACikC,GAAA,EAAD,CAAS9oB,MACO,YAArB6d,EAAMvsB,QAAQ3L,KACd,uCAAGhW,GAAEkuC,EAAMvsB,QAAQ/L,MAAMrB,EAAaW,QAAU,cAAgB,gBAC9D,CAAC9I,KAAK8hC,EAAMvsB,QAAQvV,OAAO,wBAAM2J,KAC/B,uCAAGm4B,EAAMvsB,QAAQvV,KAAK,wBAAM2J,KAC9BqjC,UAAU,QALP,SAOJ+X,EACD,uBAAK/sC,MAAO,CAACiuB,QAAQ,OAAQL,UAAU,OAAQC,UAAU,SAAUmf,SAAS,aAAc5b,UAAU,EAAG1D,WAAW,GAAI3E,WAAUyE,QAAQ,MAAsCwI,WAAW,WAAYoU,eAAe,cAApN,UACE,uBAAMpqC,MAAO,CAAC+zB,YAAY,UAAW1K,QAAS,WAC5C,IAAMz2B,EAAOzC,EAAaiC,KAAK03B,EAAMvsB,QAAQ/L,KACzCoB,GAAQhc,EAAI02C,QAAQ16B,IAF1B,SAIE,eAAC,GAAD,CAAa5K,KAAM8hC,EAAMvsB,QAAQvV,KAAM0J,OAAQo4B,EAAMvsB,QAAQ7L,OAC3DxJ,UAAW4hC,EAAMvsB,QAAQ9L,UAAW9Y,KAAMzE,IAA6B,IAAX04D,EAA8B,IAAXA,EAAiBxQ,QAAQ,MAG5G,wBAAMp8B,MAAO,CAAyC7X,MAAM3M,EAAW41B,gBAAgB07B,EAAW1Q,OAAO,oBAAqB5O,QAAQ,OAAQ4D,UAAU,OAAQ1D,WAAW,OAAQwX,aAAa,OAAQhJ,SAAS,MAAOjS,SAAS/1C,IAAiB,MAAQ,MAAOm6C,WAAW,OAAQtF,SAAS70C,IAAiB,SAAW,OAAQwoD,WAAW,UAA5U,UACGuP,GAAiBniB,EAAMvsB,QAAQhM,MAChC,sBAAKyO,MAAO,CAAC7X,MAAM0kD,EAAS/iB,EAAMvsB,QAAQ3L,MAAOwf,gBAAgB07B,EAAW1Q,OAAO,oBAAqB5O,QAAQ,MAAO4D,UAAU,QAAS1D,WAAW,QAASwX,aAAa,MAAOgF,UAAU,oBAAqBF,YAAY,oBAAqBrN,aAAa,oBAAqBoN,WAAW,oBAAqBx1D,MAAM,MAAOC,OAAO,MAAOknB,QAAQ,GAAI0yB,UAAU,yBAIvW,uBAAKpuB,MAAO,CAACiuB,QAAQ,OAAQL,UAAU,OAAQC,UAAU,SAAUmf,SAAS,aAAc5b,UAAU,EAAG1D,WAAW,GAAIqG,YAAY,EAAGhL,WAAUyE,QAAQ,MAAwCwI,WAAW,WAAYoU,eAAe,YAArO,UACF,wBAAMpqC,MAAO,CAAyC7X,MAAM3M,EAAW41B,gBAAgB,UAAWgrB,OAAO,oBAAqB5O,QAAQ,OAAQ4D,UAAU,OAAQ1D,WAAW,OAAQqG,YAAY,OAAQmR,aAAa,OAAQhJ,SAAS,MAAOjS,SAAS/1C,IAAiB,MAAQ,MAAOm6C,WAAW,OAAQtF,SAAS70C,IAAiB,QAAU,MAAOwoD,WAAW,UAA9V,UACGuP,GAAiBniB,EAAMvsB,QAAQhM,MAChC,sBAAKyO,MAAO,CAAC7X,MAAM0kD,EAAS/iB,EAAMvsB,QAAQ3L,MAAOwf,gBAAgB,UAAWgrB,OAAO,oBAAqB5O,QAAQ,MAAO4D,UAAU,QAAS1D,WAAW,OAAkCwX,aAAa,MAAOgF,UAAU,oBAAqBF,YAAY,oBAAqBrN,aAAa,oBAAqBoN,WAAW,oBAAqBx1D,MAAM,MAAOC,OAAO,MAAOknB,QAAQ,GAAI0yB,UAAU,sBAGhY,uBAAMpuB,MAAO,CAAC+zB,YAAY,UAAW1K,QAAS,WAC5C,IAAMz2B,EAAOzC,EAAaiC,KAAK03B,EAAMvsB,QAAQ/L,KACzCoB,GAAQhc,EAAI02C,QAAQ16B,IAF1B,SAKE,eAAC,GAAD,CAAa5K,KAAM8hC,EAAMvsB,QAAQvV,KAAM0J,OAAQo4B,EAAMvsB,QAAQ7L,OAC3DxJ,UAAW4hC,EAAMvsB,QAAQ9L,UAAW9Y,KAAMzE,IAA6B,IAAX04D,EAA8B,IAAXA,EAAiBxQ,QAAQ,eAQlH,SAAS6Q,GAAgB17C,EAAc27C,EAAgBpjB,GACrD,IAAM93B,EAAwB,CAACA,IAAIT,EAAMiiB,GAAIjhB,KAAKC,MAAOK,GAAIq6C,GAC7DnhC,GAAW0S,eAAehM,YAAY3d,GAAYvB,aAAcvB,EAAKk7C,GACrE,IAAM38C,EAAQu5B,EAAMjgB,OAAO1Z,aAAaI,MACxC,GAAI28C,EAAQ,CACV,IAAM58C,EAASw5B,EAAMjgB,OAAO1Z,aAAaG,OAAO3d,IAAIu6D,GAChD58C,GACFuB,GAAKc,WAAW,IAAIrB,GAAYC,EAAMhB,EAAMT,GAAIQ,EAAOtF,YAAYhD,KACjEuI,EAAMvF,YAAY9C,UAAWqI,EAAM+B,WAAYC,KAAKC,MAAO,iBAG/DX,GAAKc,WAAW,IAAIrB,GAAYC,EAAMhB,EAAMT,GAAIS,EAAMvF,YAAYhD,KAChEuI,EAAMvF,YAAY9C,UAAWqI,EAAM+B,WAAYC,KAAKC,MAAO,SAI1D,IAAM26C,GAA8C,SAACrjB,GAE1D,MAA4CA,EAAMjgB,OAA3ChY,EAAP,EAAOA,KAAMqhB,EAAb,EAAaA,SAAU/iB,EAAvB,EAAuBA,aAAcvZ,EAArC,EAAqCA,IAC/B27C,EAAU4X,GAAa,CAAC31D,OAAOs1C,EAAM8iB,WAAY7jB,SAASe,EAAMf,WACtE,EAAwBuH,KAAMtF,SAAS,IAAvC,mBAAOz5B,EAAP,KAAa67C,EAAb,KAEA,OAAO,uBAAKxa,UAAWL,EAAQlD,UAC7BrvB,MAAO,CAACxrB,OAAO,OAAQy5C,QAAQ,OAAQqR,cAAe,iBACtD1R,UAAU,OAAQC,UAAU,SAAiC0c,WAAY,WAAY8C,OAAO,aAAcnR,SAAS,SAF9G,UAGL,wBAAMoR,YAAU,EAACC,aAAa,MAA9B,UACE,eAACxY,GAAA,EAAD,CAAS9oB,MAAOrwB,GAAE,UAAWo5C,UAAU,QAAvC,SACE,sBAAKh1B,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,GAAiC+sB,UAAU,QAASt4B,OAAO,KAAjG,SACE,eAACk+B,GAAA,EAAD,CAAYh7C,KAAM,QAAS0wC,QAAS,WAAK,IAAD,IAChCmkB,EAAS37C,EAAKq7C,OAAL,OACb/8C,QADa,IACbA,GADa,UACbA,EAAciC,KAAKP,EAAKq7C,eADX,iBACb,EAAiCliD,mBADpB,aACb,EAA8ChD,UAAO2B,EACvDsjD,GAAgB17C,EAAMi8C,EAAS37C,EAAKq7C,OAAS,GAAIpjB,GACjDsjB,EAAQ,KAJV,SAOE,sBAAKptC,MAAO,CAACzrB,MAAML,IAAiB,SAAW,SAAqCotB,OAAO,MAA0BzpB,SAAS,WAAaooB,KAAK,OAAQtT,IAAKqiC,GAAOV,WAAW,EAAOE,IAAI,WAIhM,eAAC,KAAD,UAAW,WAAK,IAAD,IACPgf,EAAS37C,EAAKq7C,OAAL,OAAc/8C,QAAd,IAAcA,GAAd,UAAcA,EAAciC,KAAKP,EAAKq7C,eAAtC,iBAAc,EAAiCliD,mBAA/C,aAAc,EAA8ChD,UAAO2B,EAC5EnO,EAAYR,EAAYk4B,EAAS/B,gBAAkB,QAAU,QAEnE,OAAO,eAACggB,GAAA,EAAD,CAAWlI,QAAQ,WAAWgH,MAAM,GAAgEkQ,WAAW,EAAMtgC,MAAOtO,EAAM6uC,QAAS,EAEhJpgC,MAAO,CAACzrB,MAAM,MAAO2nD,SAAS,MAAO7N,WAAW,OAAQ+C,UAAUl9C,IAAiB,QAAU,QAASw5C,WAAW,OAAQM,MAAM,MAAuDqf,OAAO,cAC7LhN,WAAY,CAACrgC,MAAM,CAAC7X,MAAM3M,EAAW41B,gBAAiB,QAAS8zB,aAAa,MAAO1wD,OAAON,IAAiB,OAAQ,OAAQ60C,SAAS70C,IAAiB,SAAW,OAAQuhB,OAAO,OAC/K6qC,gBAAiB,CAACtgC,MAAM,CAAC7X,MAAM,UAC/BwsC,QAAS,WAAK/9C,EAAIqtC,cAAc/X,IAAI,SACpCuhC,OAAQ,WAAK72D,EAAIqtC,cAAchwC,OAAO,SACtCm1C,UAAW,SAAClmB,GAEK,WAAXA,EAAGrnB,KAA+B,QAAXqnB,EAAGrnB,MAC5BgW,EAAKq7C,OAAS,KAGlB3b,WAAY,SAACruB,IAMRA,EAAGgpB,SAA2B,IAAfhpB,EAAGwqC,SAAgC,KAAfxqC,EAAGwqC,UACvCT,GAAgB17C,EAAMi8C,EAAS37C,EAAKq7C,OAAS,GAAIpjB,GACjDsjB,EAAQ,MAGZte,SAAU,SAAC5rB,GAAOkqC,EAAQlqC,EAAG6rB,OAAOlvB,gBAI1C,+BACE,eAAC,KAAD,UAAW,kBAAI,qCACbhO,EAAKC,SAASlb,KAAI,SAACmtB,EAAGqW,GAAJ,OAChB,eAAC,GAAD,cAAoB7c,QAASwG,GAAO+lB,GAArB1P,iBAKzB+yB,GAAU7jB,YAAc,O,cC3KTjqB,GADS,IAHxB,mDACEsuC,gBAAiB,M,6JCSbzb,GAAYC,aAAW,CAC3BqQ,OAAQ,CACNjuD,MAAO,OACPC,OAAQ,OACRy/C,cAAe,QAEjB2Z,WAAY,CACVr5D,MAAO,OACPC,OAAQ,QAEVq5D,cAAe,SAAC/jB,GAAD,MAA0B,CACvCv1C,MAAMu1C,EAAMpuB,QAAQ/iB,KAAK,GAAK,GAAK,GACnCnE,OAAgC,IAAxBs1C,EAAMpuB,QAAQ/iB,KAAK,GAC3Bs7C,cAAe,SAEjB6Z,UAAU,SAAChkB,GAAD,MAAyB,CACjCv1C,MAAMu1C,EAAMpuB,QAAQ/iB,KAAK,GAAK,IAC9BnE,OAAQ,OACRqD,SAAS,WACTooB,MAAM,GACNsgC,SAAS,WAEXwN,QAAQ,CACNx5D,MAAO,OACPC,OAAQ,OACR+rD,SAAU,UAEZyN,SAAS,CACPz5D,MAAO,OACPC,OAAQ,OACR+rD,SAAU,SACVnvB,gBAAiB,WAWrB,SAAS68B,GAAU9a,GACjB,IAAMjhD,EvD6gBD,SAA6BmqB,GAClC,IAAInqB,EAAM,GAKV,OAJAmqB,EAAOrlB,SAAQ,SAACyB,EAAKoD,GACnB3J,EAAG,UAAMA,GAAN,OAAYA,EAAM,IAAM,IAAxB,OAA6B2J,EAA7B,YAAoCpD,MAGlCvG,EuDnhBKg8D,CAAoB/a,EAAO92B,QAEnCnqB,IAAQihD,EAAOrJ,MAAMpuB,QAAQxpB,KAAOihD,EAAOrJ,MAAMqkB,gBACnDhb,EAAOrJ,MAAMpuB,QAAQxpB,IAAMA,EAC3BihD,EAAOrJ,MAAMqkB,cAAchb,EAAOrJ,MAAMpuB,UAIrC,I,YAAM0yC,GAAiC,SAACtkB,GAC7C12C,EAA8B,WAAvB02C,EAAMpuB,QAAQ9J,MACrB,IAAMk8C,EAAYhd,kBAAuB,MACnC1kB,EAAW0d,EAAMjgB,OAAOuC,SACxB/P,EAASuE,GAAiBkpB,EAAMpuB,QAAQxpB,KACxC4nB,EAASuC,EAAO1pB,IAAI,MACpBomB,EAAWsD,EAAO1pB,IAAI,YAEtBwgD,EADYrC,kBAAe,CAAChH,QAAOztB,SAAQgyC,WAAU,EAAOC,SAAS,eAClDvtB,QACzBoS,EAAOrJ,MAAQA,EACfqJ,EAAO92B,OAASA,GACXtD,GAAYe,GvDkgBZ,SAAuCA,GAyB5C,OAtBW,IAAI1f,SAAwC,SAACC,EAASC,GAC3D+c,MACFA,KAAKI,OAAO82C,UAHA,2CAIZl3C,KAAKI,OAAOH,KAAK,QAAS,MAAM,WAC9BD,KAAKI,OAAOU,MAAMC,MAAMzlB,IAAI,CAC1BmnB,SACA00C,OAAO,kBAERhhD,MAAK,SAAC+K,GACL,IAAMM,EAAOxK,KAAKI,MAAM8J,EAAOM,MAE/Bxe,EAAQ,CAAC0e,SAASF,EAAKE,SAAU/Q,KAAM6Q,EAAK7Q,UAC3CyF,OAAM,SAAC0R,GACRxH,QAAQ8iB,MAAM,aAActb,GAC5B7kB,EAAO6kB,UAIX7kB,EAAO,yBuDthBTm0D,CAA8B30C,GAAQtM,MAAK,SAAClb,IACrCA,EAAI0V,MAAQ8hC,EAAMpuB,QAAQ1T,OAAS1V,EAAI0V,MAAS1V,EAAIymB,YACvDo6B,EAAO92B,OAAO3L,IAAI,WAAYpe,EAAIymB,UAClCpB,QAAQC,IAAR,gBAAqBtlB,EAAIymB,UAAYzmB,GACjCA,EAAI0V,OAAO8hC,EAAMpuB,QAAQ1T,KAAO1V,EAAI0V,MACxCimD,GAAU9a,OAEX1lC,OAAM,SAAA0R,GACPxH,QAAQC,IAAR,wBAA6BuH,EAAOtG,OACd,MAAlBsG,EAAOwkC,SACThsC,QAAQC,IAAI,oBACZu7B,EAAO92B,OAAO3L,IAAI,WAAY,SAC9Bu9C,GAAU9a,OAKhB,IAAMZ,EAAUL,GAAUpI,GACpBtpB,EAAUovB,cAAY,kBAAM9F,EAAMjgB,OAAOuC,SAAS5L,UAAYspB,EAAMpuB,QAAQ5L,MAC5E5d,EAAMquB,GAAaC,EAAS2yB,EAAO92B,QAGzCosB,sBAAU,WACR,IAAMznB,EAAMjnB,OAAOo5C,EAAO92B,OAAO1pB,IAAI,QAChC6tB,GAAY2yB,EAAOkb,YAAaP,EAAU/sB,SACzC2tB,MAAM1tC,IAAQA,IAAQ8sC,EAAU/sB,QAAQ4tB,YAC5Cb,EAAU/sB,QAAQutB,SAAW,aAC7BR,EAAU/sB,QAAQ4tB,UAAY3tC,EAC9BsC,YAAW,WACLwqC,EAAU/sB,UAAU+sB,EAAU/sB,QAAQutB,SAAWnb,EAAOmb,YAC3D,SAMP7lB,sBAAU,WACR,SAASmmB,IACP,IAAM5tC,EAAMjnB,OAAOo5C,EAAO92B,OAAO1pB,IAAI,QACjCm7D,EAAU/sB,SAAW+sB,EAAU/sB,QAAQ4tB,YAAc3tC,IAEvDmyB,EAAO92B,OAAO3L,IAAI,MAAOo9C,EAAU/sB,QAAQ4tB,UAAUvzD,YACrD6yD,GAAU9a,IAGd,GAAI2a,EAAU/sB,QAAS,CACrB,IACM8tB,EAAarlD,KAAEslD,UAAS,kBAAMxrC,WAAWsrC,EAD9B,YAEXG,EAAYvlD,KAAEwlD,UAAS,WAC3B7b,EAAOkb,WAAY,IAHJ,KAMjBlb,EAAOmb,SAAW,WAChBnb,EAAOkb,WAAY,EAEnBQ,IACAE,KAGFjB,EAAU/sB,QAAQutB,SAAWnb,EAAOmb,YAGrC,CAACliC,EAAS6G,eAEb,IAAMg8B,EvDkYD,SAAmCl2C,GACxC,OAAKA,KAGU,sEAAbA,GACgB,6CAAbA,GACa,4CAAbA,GACyB,UAAzBA,EAAS1d,MAAM,EAAG,IACO,UAAzB0d,EAAS1d,MAAM,EAAG,IACO,UAAzB0d,EAAS1d,MAAM,EAAG,IuD3YP6zD,CAA0Bn2C,GAE1C,OAAO,sBAAK65B,UAAW75B,EAAWw5B,EAAQwb,QAAUxb,EAAQyb,SAArD,SACJj1C,EACC,sBAAK65B,UAAYpyB,IAAYyuC,EAAW1c,EAAQwb,QAAUxb,EAAQub,UAAW/jD,IAAK+jD,EAChFqB,QAAW,SAAAjsC,GAAE,OAAIA,EAAGgpB,SAAWhpB,EAAG2lB,mBADpC,SAEE,yBAAQl8B,IAAKza,EAAK+5B,MAAO6d,EAAMpuB,QAAQxpB,IACrC0gD,UAAWpyB,EAAU+xB,EAAQqb,WAAaqB,EAAU1c,EAAQsb,cAAgBtb,EAAQiQ,WAGzFhiC,EACC,sBAAKoyB,UAAWL,EAAQwb,QAASoB,QAAW,SAAAjsC,GAAE,OAAIA,EAAGgpB,SAAWhpB,EAAG2lB,mBAAnE,SACA,yBAAQl8B,IAAKza,EAAK+5B,MAAO6d,EAAMpuB,QAAQxpB,IACrC0gD,UAAWL,EAAQqb,eAHZ,sBAAK5tC,MAAO,CAACilC,OAAO,MAAOsF,WAAW,YAAtC,SAAoD3uD,GAAE,iB,oDCrIrEwzD,uBAAoBC,UAAY,sEAChC,IA0BMvJ,I,cAeJ,aAAc,yBAddwJ,cAca,OAbbxlB,WAaa,OAZbylB,aAYa,OAXb5vC,cAA8BhW,EAWjB,KAVb6lD,MAAwB,GAUX,KATbC,gBAA0B9lD,EASb,KARbi8B,OAAiC,KAQpB,KAPb8pB,QAA+B,KAOlB,KANbC,cAAqC,KAMxB,KALbC,SAAW,CAAC,EAAE,GAKD,KAJbC,QAAU,EAIG,8GACX5mD,aAAeC,M,0CAEjB,WAAS,IAAD,OACA25C,EAAO35C,KAAKsmD,MAAMtmD,KAAK2mD,SAC7B,GAAI3mD,KAAK08B,QAAUid,EAAK,CACtB,IAAMiN,EAAYjN,EAAKkN,YAAY,CAAC1rB,MAAM,IACpCnvC,EAAIgU,KAAK4gC,MAAMpuB,QACrB,GAAIxmB,EAAEwlB,aAAa,KAAOo1C,EAAUv7D,OAASW,EAAEwlB,aAAa,KAAOo1C,EAAUt7D,OAK3E,OAJAU,EAAEwlB,aAAe,CAACo1C,EAAUv7D,MAAOu7D,EAAUt7D,QAC7CU,EAAEyD,KAAO,CAACzD,EAAEyD,KAAK,GAAIzD,EAAEyD,KAAK,GAAKzD,EAAEwlB,aAAa,GAAKxlB,EAAEwlB,aAAa,IACpExR,KAAK4gC,MAAMkmB,WAAW9mD,KAAK4gC,MAAMpuB,UAE1B,EAET,IAAM2oB,EAxDS,EAwDcn7B,KAAK4gC,MAAMpuB,QAAQ/iB,KAAK,GAAKm3D,EAAUv7D,MAC9D07D,EAAWpN,EAAKkN,YAAY,CAAC1rB,UACnCn7B,KAAK08B,OAAOrxC,MAAQ07D,EAAS17D,MAC7B2U,KAAK08B,OAAOpxC,OAASy7D,EAASz7D,OAC9B,IAAMyyC,EAAM/9B,KAAK08B,OAAOsB,WAAW,MAmCnC,OAlCID,IACE/9B,KAAKumD,YACPvmD,KAAKumD,WAAWS,SAElBhnD,KAAKumD,WAAa5M,EAAKsN,OAAO,CAACC,cAAenpB,EAAKgpB,aACnD/mD,KAAKumD,WAAWnxC,QAAQ9Q,MAAK,WAC3Bq1C,EAAKwN,iBAAiB7iD,MAAK,SAAC8iD,GAE1B,GAAI,EAAKZ,QAAS,CAChB,IAAMplB,EAAW,EAAKolB,QAAQa,WAC9BxqC,MAAMnT,KAAK03B,EAASv2B,UAAU/c,SAAQ,SAAA9B,GAAC,OAAIA,EAAE4hD,YAC7C,IAAMt5B,EAAuB,GAC7BgzC,2BAAgB,CACdF,YAAaA,EACbjhB,UAAW,EAAKqgB,QAChBO,WACAQ,SAAUjzC,IAEZA,EAAMxmB,SAAQ,SAAAua,GACZA,EAAKyO,MAAMnoB,SAAS,WACpB0Z,EAAKyO,MAAM7X,MAAM,cACjBoJ,EAAKyO,MAAMuqC,WAAW,MACtBh5C,EAAKyO,MAAM0wC,gBAAgB,QAC3Bn/C,EAAKyO,MAAMuqC,WAAW,SACtBh5C,EAAKyO,MAAMk2B,cAAc,aAI/B,EAAKuZ,gBAAa9lD,KACjB8D,OAAM,SAAA0R,SAKJ,EAGT,OAAO,I,yBAET,WAAc,IAAD,OACX,GAAIjW,KAAKomD,WAAapmD,KAAK4gC,MAA3B,CAMA5gC,KAAK4gC,MAAQ5gC,KAAKomD,SAElB,IAAMp9D,EAAM,IAAIE,IAAI8W,KAAK4gC,MAAMpuB,QAAQxpB,KACvCgX,KAAKqmD,QAAUr9D,EAAI4a,KAAO5a,EAAIiB,KAAK0jB,UAAU,EAAG3kB,EAAIiB,KAAKuH,OAASxI,EAAI4a,KAAKpS,QAAUxI,EAAIiB,KACzF,IACsC,EADlC08D,EAAU3mD,KAAK2mD,QACnB,GAA6B,WAAzB39D,EAAI4a,KAAKha,OAAO,EAAE,IACpB+8D,EAAO,UAAG91D,OAAO7H,EAAI4a,KAAKha,OAAO,IAAM,SAAhC,QAAqC,GAC9B,IAAI+8D,EAAU,GACxB3mD,KAAKynD,UAAYd,GAAW3mD,KAAKynD,WAAWd,EAAU3mD,KAAKynD,SAAS,GAErEznD,KAAKyW,UAAYkwC,IAAY3mD,KAAK2mD,QAO9B3mD,KAAK0mD,SAAS,KAAO1mD,KAAK4gC,MAAMpuB,QAAQ/iB,KAAK,IAAMuQ,KAAK0mD,SAAS,KAAO1mD,KAAK4gC,MAAMpuB,QAAQ/iB,KAAK,IACnGuQ,KAAKinD,WACPjnD,KAAK0mD,SAAW7pC,MAAMnT,KAAK1J,KAAK4gC,MAAMpuB,QAAQ/iB,QAPhDuQ,KAAK45C,QAAQ+M,GAASriD,MAAK,WACzB,EAAK2iD,YAEPjnD,KAAK2mD,QAAUA,EACf3mD,KAAK0nD,SAAWpyC,OAAOqxC,EAAU,O,yBAOrC,WAAc,IAAD,OAmCX,OAlCW,IAAIz1D,SAA0B,SAACC,EAASC,GAC7C,EAAKqlB,SACPtlB,EAAQ,EAAKslB,UAEAkxC,uBAAY,CACvB3+D,IAAKykB,GAAc,EAAK44C,SACxBuB,QAAS,yDACTC,YAAY,IAETzyC,QAAQ9Q,MAAK,SAACwjD,GACjB,EAAKrxC,SAAWqxC,EAChB,EAAKL,SAAWK,EAAIL,SACpBt2D,EAAQ,EAAKslB,aACZlS,OAAM,SAAA0R,GACM0xC,uBAAY,CACvB3+D,IAAK,EAAKq9D,QACVuB,QAAS,yDACTC,YAAY,IAETzyC,QAAQ9Q,MAAK,SAACwjD,GACjB,EAAKrxC,SAAWqxC,EAChB,EAAKL,SAAWK,EAAIL,SACpBt2D,EAAQ,EAAKslB,aACZlS,OAAM,SAAA0R,GACPxH,QAAQI,MAAR,8BAAqC,EAAKw3C,UAC1Cj1D,EAAO6kB,c,qBAWjB,SAAQ0wC,GAAiB,IAAD,OAkBtB,OAjBW,IAAIz1D,SAAsB,SAACC,EAASC,GACzC,EAAKk1D,MAAMK,GACbx1D,EAAQ,EAAKm1D,MAAMK,IAEnB,EAAKgB,cAAcrjD,MAAK,SAACwjD,GACvBA,EAAIlO,QAAQ+M,EAAQ,GAAGriD,MAAK,SAACq1C,GAC3B,EAAK2M,MAAMK,GAAWhN,EACtBxoD,EAAQ,EAAKm1D,MAAMK,OAClBpiD,OAAM,SAAC0R,GACR7kB,EAAO6kB,SAER1R,OAAM,SAAC0R,GACR7kB,EAAO6kB,W,uBAOf,SAAU0wC,QACQlmD,IAAZkmD,GAA0B91D,OAAOk3D,SAASpB,KAAWA,EAAU3mD,KAAK2mD,SACpEA,EAAU,IAAIA,EAAU,GACxBA,GAAW3mD,KAAKynD,WAAWd,EAAU3mD,KAAKynD,SAAS,GACvD,IAAMz+D,EAAG,UAAMgX,KAAKqmD,QAAX,iBAA2BM,EAAQ,GAC5C,GAAI39D,IAAQgX,KAAK4gC,MAAMpuB,QAAQxpB,IAAK,CAClC,IAAMgD,EAAIqS,OAAO+D,OAAO,GAAIpC,KAAK4gC,MAAMpuB,SACvCxmB,EAAEhD,IAAMA,EACRgX,KAAK4gC,MAAMqkB,cAAcj5D,Q,6CA7J5BiU,M,yEAAsB,K,uCACtBA,M,yEAAqB,K,wCACrBA,M,wEAAsB,M,IAgKnB+nD,GAAU,CACd3c,YAAa,SAACrxB,GAAyBA,EAAG2lB,mBAC1CsoB,UAAW,SAACjuC,GAAyBA,EAAG2lB,mBACxCuoB,cAAe,SAACluC,GAAyBA,EAAG2lB,mBAC5CwoB,YAAa,SAACnuC,GAAyBA,EAAG2lB,oBAG/ByoB,GAA8B,SAACxnB,GAC1C12C,EAA8B,QAAvB02C,EAAMpuB,QAAQ9J,MACrB,IACMuhC,EADYrC,kBAAe,IAAIgV,IACZ/kB,QACzBoS,EAAOmc,SAAWxlB,EAClB,IAAMynB,EAAYzgB,kBAA0B,MACtC0gB,EAAa1gB,kBAAuB,MACpC2gB,EAAmB3gB,kBAAuB,MAC1CtwB,EAAUovB,cAAY,kBAAM9F,EAAMjgB,OAAOuC,SAAS5L,UAAYspB,EAAMpuB,QAAQ5L,MAalF,OAXA24B,sBAAU,WACR0K,EAAOvN,OAAS2rB,EAAUxwB,QAC1BoS,EAAOuc,QAAU8B,EAAWzwB,QAC5BoS,EAAOwc,cAAgB8B,EAAiB1wB,UAEvC,CAACwwB,EAAUxwB,UAEd0H,sBAAU,WACR0K,EAAOue,iBAGF,uBAAK1xC,MAAO,CAACugC,SAAU,SAAUtM,cAAe,OAAQ5F,WAAY7tB,EAAS,OAAO,QACzFmxC,cAAiB,SAACzuC,GAAc1C,IAC9B0C,EAAG2lB,kBACH3lB,EAAG0lB,iBACHkB,EAAMjgB,OAAOuC,SAASwX,WAAWkG,EAAMpuB,QAAQ5L,MAJ5C,UAML,yBAAQkQ,MAAO,CAAEzrB,MAAM,GAAD,OAAIq9D,IAAJ,KAAyBp9D,OAAO,GAAD,OAAIo9D,IAAJ,KACnDlB,gBAAgB,WAAYtiB,UAAU,SAAD,OAAU,EA3OhC,EA2OsB,MAA8BrkC,IAAKwnD,IAC1E,sBAAKxnD,IAAKynD,EAAYxxC,MAAO,CAACnoB,SAAS,WAAYooB,KAAK,EAAGe,IAAI,EAC7DzsB,MAAM,GAAD,OAAIq9D,IAAJ,KAAyBp9D,OAAO,GAAD,OAAIo9D,IAAJ,KACpClB,gBAAgB,WAAYtiB,UAAU,SAAD,OAAU,EA9OhC,EA8OsB,KAA6Bwe,WAAY,EAC9ErM,SAAS,YACX,sBAAKx2C,IAAK0nD,IACV,sBAAKzxC,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,EAAGf,KAAK,EAAG1rB,MAAM,OAAQC,OAAO,IACpEq9D,eAAgB,WAAK1e,EAAO2e,SAAU,GAAOC,eAAgB,WAAK5e,EAAO2e,SAAU,GADrF,SAEE,eAAC,KAAD,UAAW,kBACT,eAACpJ,GAAA,EAAD,CAAUhV,GAAIP,EAAO2e,QAAS9xC,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,EAAGf,KAAK,EAAG1rB,MAAM,QAAhF,SACE,gBAAC66C,GAAA,EAAD,CAAMC,WAAS,EAAC2G,WAAW,SAA3B,UACE,eAAC5G,GAAA,EAAD,CAAMyG,MAAI,EAAV,SACE,eAAClC,GAAA,EAAD,2BAAYh7C,KAAK,QAAQwP,MAAOgrC,EAAO0c,QAAQ,EAAE,UAAU,WAAeqB,IAA1E,IACE7nB,QAAS,SAACnmB,GAASA,EAAG2lB,kBAAmBsK,EAAO8a,UAAU9a,EAAO0c,QAAU,IAC3E8B,cAAe,SAACzuC,GAAQA,EAAG2lB,mBAF7B,SAGA,eAAC,KAAD,SAGF,eAACuG,GAAA,EAAD,CAAMyG,MAAI,EAAC98C,GAAI,EAAf,SACE,eAACo4C,GAAA,EAAD,2BAAWtxB,MAAOszB,EAAOyd,UAAcM,IAAvC,IACEriB,WAAY,CAAC9mB,IAAK,EAAG/H,MAAO,CAAE+tB,UAAW,WACzCe,SAAU,SAAC5rB,GAAQiwB,EAAOyd,SAAW1tC,EAAG6rB,OAAOlvB,OAC/C4tC,OAAQ,SAACvqC,GACP,IAAMtoB,EAAMb,OAAOo5C,EAAOyd,UACtBh2D,EAAM,GAAKu4C,EAAO8a,UAAUrzD,EAAI,IAEtC22C,WAAY,SAACruB,GACX,GAAe,UAAXA,EAAGrnB,IAAgB,CACrB,IAAMjB,EAAMb,OAAOo5C,EAAOyd,UACtBh2D,EAAM,GAAKu4C,EAAO8a,UAAUrzD,EAAI,UAK5C,gBAACw0C,GAAA,EAAD,CAAMyG,MAAI,EAAC71B,MAAO,CAAC+oB,SAAS,IAA5B,eAAoCoK,EAAOwd,YAC3C,eAACvhB,GAAA,EAAD,CAAMyG,MAAI,EAAV,SACE,eAAClC,GAAA,EAAD,2BAAYh7C,KAAK,QAAQwP,MAAOgrC,EAAO0c,QAAQ1c,EAAOwd,SAAS,EAAE,UAAU,WAAeO,IAA1F,IACE7nB,QAAS,SAACnmB,GAASA,EAAG2lB,kBAAmBsK,EAAO8a,UAAU9a,EAAO0c,QAAU,IAC3E8B,cAAe,SAACzuC,GAAQA,EAAG2lB,mBAF7B,SAGA,eAAC,KAAD,uBC5RRqJ,GAAYC,aAAW,CAC3B8G,MAAO,CACL1kD,MAAO,OACPC,OAAQ,UAICw9D,GAAgD,SAACloB,GAC5D12C,EAA8B,mBAAvB02C,EAAMpuB,QAAQ9J,MAAoD,mBAAvBk4B,EAAMpuB,QAAQ9J,MAChE,IAAM2gC,EAAUL,KACVnoC,EAAM+mC,kBAAyB,MAarC,OALArI,sBAAU,WALJ1+B,EAAIg3B,UACNh3B,EAAIg3B,QAAQp0B,IAAMm9B,EAAMpuB,QAAQxpB,IAChC6X,EAAIg3B,QAAQuY,UAAW,KAMjB,CAACvvC,EAAIg3B,UAER,wBAAO6R,UAAWL,EAAQ0G,MAAOlvC,IAAKA,KCpBzCmoC,GAAYC,aAAW,CAC3B8G,MAAO,CACL1kD,MAAO,OACPC,OAAQ,UASCy9D,GAAwC,SAACnoB,GACpD12C,EAA8B,WAAvB02C,EAAMpuB,QAAQ9J,MAA4C,WAAvBk4B,EAAMpuB,QAAQ9J,MACxD,IAAM2gC,EAAUL,KACVnoC,EAAM+mC,kBAAyB,MACrC,EAA0BR,KAAMtF,UAAS,GAAzC,mBAAOxgC,EAAP,KAAc0nD,EAAd,KACM/e,EAASrC,kBAA4B,IAErCqhB,EAAkB,CAAC,IAAM,GAAK,IAAM,EAAM,EAAG,EAAG,GA0EtD,OAxEA1pB,sBAAU,WAAO,IAAD,EAEV,UAAC0K,EAAOpS,eAAR,OAAC,EAAgB3vB,SACnB+hC,EAAOpS,QAAU,CACf3vB,OAAQgb,GAASsW,yBAAyB,GAAIoH,EAAMpuB,QAAQ5L,IAAIsB,OAChEsK,QAASouB,EAAMpuB,SAEby3B,EAAOpS,QAAQ3vB,OAAO1W,OAAS,GACjCid,QAAQI,MAAR,kBAAyB+xB,EAAMpuB,QAAQ5L,GAAvC,gBAAiDqjC,EAAOpS,QAAQ3vB,OAAO1W,OAAvE,WAAwFy4C,EAAOpS,QAAQ3vB,SAI3G,IAAMqrB,EAAWjwB,cAAQ,WACvB,GAAIzC,EAAIg3B,QAAS,CACf,IAAM12B,EAAQ8oC,EAAOpS,QAAQ3vB,OAAOgB,MAAK,SAAAxW,GAAC,MAAe,UAAXA,EAAEuV,QAChD,GAAI9G,EAEF,IADiBN,EAAIg3B,QAAQ4X,qBAAqBzuC,YAAcH,EAAIg3B,QAAQ4X,UAAUhW,iBAAiB,QAAKh5B,KAC3FU,EAAO,CACtB,IAAMJ,EAAK,IAAIC,YACfD,EAAGE,SAASE,GACZ,IAAI+nD,EAAQ,EACZ/nD,EAAMgoD,OAAS,WACbD,EAAQn/D,OAAOqwB,YAAW,WAAK4uC,GAAS,KAAQ,MAGlD7nD,EAAMioD,SAAW,WACXF,IACFn/D,OAAOo5C,aAAa+lB,GACpBA,EAAQ,GAEVF,GAAS,IAGXnoD,EAAIg3B,QAAQ4X,UAAY1uC,EACxBF,EAAIg3B,QAAQuY,UAAW,OAK/B,OAAO,WACL7c,OAGD,IACHgM,sBAAU,WAuBR,IAAMpjB,EAAWK,aAtBjB,WACE,GAAIytB,EAAOpS,QAAQ3vB,OAAO1W,QAAUqP,EAAIg3B,QAAS,CAC/C,IAAM3vB,EAASrH,EAAIg3B,QAAQ4X,qBAAqBzuC,aAAeH,EAAIg3B,QAAQ4X,UAAUlW,YACrF,GAAIrxB,GAAUA,EAAO1W,OAAQ,CAC3B,IAAMu+C,EAAQ7nC,EAAOgB,MAAK,SAAA/H,GAAK,MAAmB,UAAfA,EAAM8G,QACnCkO,EAAQ,OAAG45B,QAAH,IAAGA,OAAH,EAAGA,EAAO35B,cAClBizC,EAAU,EAAS,OAARlzC,QAAQ,IAARA,OAAA,EAAAA,EAAU9qB,QAAS,GAAW,OAAR8qB,QAAQ,IAARA,OAAA,EAAAA,EAAU7qB,SAAU,GAC3D,GAAI+9D,EAAQ,IAAMpf,EAAOpS,QAAQrlB,QAAQhB,aAAatf,aAAem3D,EAAQn3D,WAAY,CACvF,GAAI+3C,EAAOpS,QAAQrlB,QAAQhB,aAAa,GAAG,CACzC,IAAM83C,EAAKrf,EAAOpS,QAAQrlB,QAAQhB,aAAa,GAAK63C,EAAQ,GACtDE,EAAKtf,EAAOpS,QAAQrlB,QAAQhB,aAAa,GAAK63C,EAAQ,GAC5D,GAAIC,IAAOC,GAAMN,EAAgB//C,MAAK,SAAA1b,GAAC,OAAIA,IAAM87D,KAAO,OAE1D,IAAMnuB,EAAQ8O,EAAOpS,QAAQrlB,QAAQ/iB,KAAK,IACvCw6C,EAAOpS,QAAQrlB,QAAQhB,aAAa,GAAKy4B,EAAOpS,QAAQrlB,QAAQhB,aAAa,GAAK63C,EAAQ,IAC7Fpf,EAAOpS,QAAQrlB,QAAQhB,aAAe63C,EACtCpf,EAAOpS,QAAQrlB,QAAQ/iB,KAAO9B,EAAMwtC,EAAOkuB,GAC3CzoB,EAAMqkB,cAAchb,EAAOpS,QAAQrlB,cAKE,KAC7C,OAAO,kBAAM4J,cAAcD,MAE1B,IAEI,wBAAOutB,UAAWL,EAAQ0G,MAAOj5B,MAAOxV,EAAQ,CAACyb,OAAQ,8BAAgC,GAAIlc,IAAKA,K,uBCvFrG2oD,G,mDACJ5gD,SAA0B,G,KAC1B6gD,UAAW,E,KACXC,aAAc,E,KACdpyC,SAAU,KAGZ,SAASqyC,GAAc/gD,EAAyBghD,EAAoBhpB,GAClE,IAAMipB,EAAyB,CAACjhD,WAAU2L,OAAO,CAACq1C,EAAIE,WAAYF,EAAInE,YAChEsE,EAAS5kD,KAAKC,UAAUykD,GAC1BjpB,EAAMpuB,QAAQxpB,MAAQ+gE,GAAUnpB,EAAMqkB,gBACxCrkB,EAAMpuB,QAAQxpB,IAAM+gE,EACpBnpB,EAAMqkB,cAAcrkB,EAAMpuB,UAiB9B,SAASw3C,GAAS3hD,EAAcu4B,GAE9BA,EAAMv4B,KAAKgM,QAAUhM,EACrB,IAAM4hD,EAAiBrpB,EAAMqJ,OAAOrhC,SAASmU,QAAO,SAAA1U,GAAI,OAAIA,EAAKgM,QAAQ7iB,UACrEovC,EAAMgpB,KACRD,GAAcM,EAAgBrpB,EAAMgpB,IAAKhpB,GAKtC,IAAMspB,GAAoC,SAACtpB,GAChD,MAAwBwG,KAAMtF,SAASlB,EAAMv4B,KAAKgM,SAAlD,mBAAOhM,EAAP,KAAa67C,EAAb,KACMiG,EAAmBviB,uBAAYnnC,GACrC8+B,sBAAU,WACR4qB,EAAiBtyB,QAAUv3B,KAAEslD,SAASoE,GAAU,IAAM,CAACI,SAAS,MAC/D,IACH,IAAMC,EAAgBF,EAAiBtyB,QAEvC,OAAO,eAAC,KAAD,UAAW,kBAClB,uBAAK/gB,MAAK,6BAAM8pB,EAAM0pB,KAAZ,IAAiB37D,SAAS,WAAYotD,OAAO,EAAG7I,OAAO,EAAG5O,QAAQ,EAAGpc,gBAAgB,SAA/F,UACE,sBAAKpR,MAAK,6BAAM8pB,EAAM0pB,KAAZ,IAAiBrrD,MAAM,MAAOtQ,SAAS,WAAYtD,MAAM,OACjEgsD,SAAU,SAAUkT,WAAW,WADjC,SAC6CliD,EAAK,WAClD,2BAAUsO,MAAOtO,EAAM43B,UAAWW,EAAMX,UACtCnpB,MAAK,6BAAM8pB,EAAM0pB,KAAZ,IAAiBrc,KAAM,UAAWjB,cAAc,WAAYmX,OAAO,OACxEx1D,SAAS,WAAYmpB,IAAI,EAAGf,KAAK,EAAG1rB,MAAM,OAAQC,OAAO,OAAQ4nD,OAAO,OACxEsX,cAAe,UAAWnT,SAAU,WAEpCzR,SAAU,SAAC5rB,GACTkqC,EAAQlqC,EAAGouB,cAAczxB,OACrB0zC,GACFA,EAAcrwC,EAAGouB,cAAczxB,MAAOiqB,IAG1C2jB,OAAQ,WACF8F,GAAgBA,EAAcrD,SAClCgD,GAAS3hD,EAAMu4B,IAEjB6K,QAAS,aAGTvL,UAAW,SAAClmB,GACK,WAAXA,EAAGrnB,KAA+B,QAAXqnB,EAAGrnB,MAC5BqnB,EAAG2lB,kBACH3lB,EAAG0lB,iBACC2qB,GAAgBA,EAAcrD,SAClCgD,GAAS3hD,EAAMu4B,GACfA,EAAMjgB,OAAOuC,SAASwX,WAAW,eAO9B+vB,GAAkC,SAAC7pB,GAAwB,IAAD,IAC/Dn4B,EAAY25C,GAAgBxhB,EAAMv4B,KAAKiF,MACvCzb,EAAM,UAAA+uC,EAAMv4B,KAAKpJ,aAAX,SAAkBzN,OAASovC,EAAMv4B,KAAKpJ,MAAQ3N,EAAkBsvC,EAAMv4B,KAAKvJ,MAEjFwrD,EAAoB,CACxBrrD,MAAOzM,EAFS,UAAAouC,EAAMv4B,KAAK/V,iBAAX,SAAsBd,OAASovC,EAAMv4B,KAAK/V,UAAYV,EAAiBC,GAEhE,GACvBq2B,gBAAgB/R,GAASsuC,eAAiBjyD,EAAKX,EAAK,IAAOW,EAAKX,EAAK,GACrEyyC,QAAQ,QACRzE,SAAU,GACV6jB,WAAY,IACZr4D,MAAM,OACNgsD,SAAU,OACVsJ,UAAW,aACXU,WAAY,WACZyC,SAAU,aACV4G,aAAc,cAEWC,EAA3B,aAAsCL,EAAtC,IAGA,OAFAK,EAAQziC,gBAAkB11B,EAAKX,EAAK,GAE7B,eAACg6C,GAAA,EAAD,CAAS9oB,MAAO,gBAAC,KAAM6nC,SAAP,WAAiBhqB,EAAMv4B,KAAKvJ,KAA5B,IAAkC,wBAAlC,IAA0C2J,KACjEqjC,UAAU,OAAOC,OAAO,EAAM8e,gCAAgC,EADvD,SAC6D,+BACnEjqB,EAAMkqB,YAAc,eAAC,GAAD,6BAAclqB,GAAd,IAAqB0pB,IAAKK,KAC/C,sBAAK7zC,MAAOwzC,EAEVpC,cAAe,WAAMtnB,EAAMqJ,OAAOwf,UAAW,GAC7C3P,cAAe,WAAMlZ,EAAMqJ,OAAOwf,UAAW,GAC7CtB,YAAa,SAACnuC,GACZ,GAAK4mB,EAAMqJ,OAAOwf,SAAlB,CACA,IAAM5jB,EAAS7rB,EAAG6rB,OAClB,GAAIA,aAAkBklB,KAAK,CACzB/wC,EAAG0lB,iBACH,IAAMsrB,EAAYjhE,OAAOkhE,eACzB,GAAID,EACF,GAAIA,EAAUE,YAAcF,EAAUG,WAAW,GAAGj5D,WAClD84D,EAAUI,sBACP,CACH,IAAMC,EAAQ50C,SAAS60C,cACvBD,EAAME,WAAW1lB,GACjBmlB,EAAUI,kBACVJ,EAAUQ,SAASH,OAjB7B,SAuBGzqB,EAAMoiB,kBAKLyI,GAAyB,CAC7BngE,OAAQ,OACRD,MAAO,OACPg2D,WAAY,WACZtW,cAAe,OACfrG,UAAW,OACXC,UAAW,UACXmf,SAAU,cAEN9a,GAAYC,aAAW,CAC3B5gC,KAAMojD,GACNC,SAAS,6BACJD,IADG,IAEN/X,OAAQ,UACRvO,WAAY,WAIHwmB,GAA+B,SAAC/qB,GAC3C12C,EAA8B,SAAvB02C,EAAMpuB,QAAQ9J,MACrB,MAAiCk4B,EAAMjgB,OAAhCuC,EAAP,EAAOA,SAAUjc,EAAjB,EAAiBA,aAEXgjC,EADY7C,KAAMQ,OAAmB,IAAI4hB,IACtB3xB,QACnBwR,EAAUL,KACVnoC,EAAM+mC,kBAAuB,MAC7B5+C,EAAM43C,EAAMpuB,QAAQxpB,IACpB6gE,EAAW1kD,KAAKI,MAAMvc,GAEtBsuB,EAAUovB,cAAY,kBAAMxjB,EAAS5L,UAAYspB,EAAMpuB,QAAQ5L,MACjE0Q,GACF4L,EAAS0oC,wBAAuB,SAAChkC,EAAKmV,GAChCnV,IAAQgZ,EAAMpuB,QAAQ5L,IAAe,KAATm2B,IAC1Bl8B,EAAIg3B,UACNoS,EAAOrhC,SAAWqhC,EAAOrhC,SAASmU,QAAO,SAAA1U,GAAI,OAAIA,EAAKgM,QAAQ7iB,UAC9Dm4D,GAAc1f,EAAOrhC,SAAU/H,EAAIg3B,QAAS+I,IAE9C1d,EAAS0oC,6BAIfrsB,sBAAU,WAEyF,IAAD,GAD3FjoB,GAAWzW,EAAIg3B,UACdh3B,EAAIg3B,QAAQiyB,aAAaD,EAASt1C,OAAO,IAAM1T,EAAIg3B,QAAQ4tB,YAAYoE,EAASt1C,OAAO,KACzF01B,EAAOyf,aAAc,EACrB,UAAA7oD,EAAIg3B,eAAJ,SAAatjB,OAAOs1C,EAASt1C,OAAO,GAAIs1C,EAASt1C,OAAO,QAIpD,CAACs1C,EAASt1C,OAAO,GAAIs1C,EAASt1C,OAAO,GAAI+C,IAGnD,IAAMu0C,EAAU,IAAI1jD,IACpB0hD,EAASjhD,SAAS9a,SAAQ,SAACg+D,GACzB,IAAM13B,EAAQ6V,EAAOrhC,SAASqP,WAAU,SAAAnP,GAAG,OAAIA,EAAIR,MAAQwjD,EAAWxjD,KAAOQ,EAAIwE,OAASw+C,EAAWx+C,SACtF,IAAX8mB,GACFy3B,EAAQ7oC,IAAIinB,EAAOrhC,SAASpX,QAC5By4C,EAAOrhC,SAASG,KAAK+iD,IACbA,EAAWxjD,MAAQrB,EAAaW,UACxCikD,EAAQ7oC,IAAIoR,GACZ6V,EAAOrhC,SAASwrB,GAAS03B,MAI7B7hB,EAAOrhC,SAAWqhC,EAAOrhC,SAASmU,QAAO,SAACjU,EAAKooB,GAAN,OACvCpoB,EAAIR,MAAQrB,EAAaW,SAAWikD,EAAQpoC,IAAIyN,MAClD+Y,EAAOrhC,SAAS7Y,KAAKod,IAErB,IAAI4+C,OAAoCtrD,EACxC,GAAI6W,EAAS,CAEX,IAAM00C,EAAO/hB,EAAOrhC,SAASmc,MACzBinC,GACF/hB,EAAOrhC,SAASG,KAAKijD,IAEf,OAAJA,QAAI,IAAJA,OAAA,EAAAA,EAAM1jD,OAAQrB,EAAaW,SAC7BqiC,EAAOrhC,SAASG,KAAK,CAACsL,QAAQ,GAAI/L,IAAIrB,EAAaW,QACjD9I,KAAKmI,EAAaI,MAAMvF,YAAYhD,KACpCG,MAAOgI,EAAaI,MAAMvF,YAAY7C,MACtC3M,UAAW2U,EAAaI,MAAMvF,YAAYxP,UAC1Cgb,KAAKjE,KAAKC,QAET2gC,EAAO3yB,UACV2yB,EAAOrhC,SAASqxB,UAChB8xB,EAAc9hB,EAAOrhC,SAASM,MAAK,SAAAmL,GAAO,OAAIA,EAAQ/L,MAAQrB,EAAaW,WAC3EqiC,EAAOrhC,SAASqxB,WAKpB,IAAMstB,EAAWtd,EAAOrhC,SAASlb,KAAI,SAAC2a,EAAM6oB,GAC1C,IAAM45B,EAAexzC,IAClBjP,EAAKC,MAAQrB,EAAaW,UAAYX,EAAaG,OAAOqc,IAAIpb,EAAKC,MAElE06C,EAA2B,GAG/B,OAFK8H,IAAc9H,EAAaD,GAAiB16C,EAAKgM,UAE/C,yBAAC,GAAD,6BAAausB,GAAb,IAAoBjuC,IAAKu+B,EAAK7oB,KAAMA,EAAMuhD,IAAK/oD,EAAIg3B,QAASmrB,WAAYA,EAC7E/Y,OAAQA,EAAQ6gB,YAAaA,EAAa7qB,UAAa53B,IAAS0jD,QAG9DE,EAAe3rD,KAAEwlD,UAAS,SAAC9rC,GAC3BnZ,EAAIg3B,UACFoS,EAAOyf,YACTzf,EAAOyf,aAAc,EAGrBC,GAAc1f,EAAOrhC,SAAU/H,EAAIg3B,QAAS+I,MAPjC,KAajB,OAFAqJ,EAAO3yB,QAAUA,EAET,sBAAKzW,IAAKA,EAAK6oC,UAAapyB,EAAU+xB,EAAQqiB,SAAWriB,EAAQhhC,KACvE49C,QAAW,SAAAjsC,GAAE,OAAIA,EAAGgpB,SAAWhpB,EAAG2lB,mBAClCusB,SAAY,SAAClyC,GAAc1C,GAAY20C,EAAajyC,IAF9C,SAILutC,KCjQE,SAAS4E,GAAqBrrD,EAAyBkvC,GAC5D,IAAMoc,EAActrD,EAChBsrD,EAAQC,WACVD,EAAQC,UAAUrc,GAAU1rC,MAC1B,eAGAC,OACA,WAAQkK,QAAQiL,KAAK,mBAAoBs2B,EAAU,cAmBlD,I,2BAAMsc,GAAqB,IAIrBC,GAAb,WAeE,WAAYt+B,EAAuB4P,EACvB2uB,EAA8BC,GAAsB,yBAftDC,gBAAmFjsD,EAe9B,KAdrDksD,kBAA6ClsD,EAcQ,KAZ5CmsD,cAY4C,OAX5CC,gBAW4C,OAV5ChvB,iBAU4C,OAR5C5P,aAQ4C,OAPrDu+B,cAOqD,OANrDC,YAAa,EAMwC,KAJvDK,cAAgB,GAIuC,KAHvDvhC,SAAW,EAG4C,KAc/DpP,cAAoC1b,EAd2B,KAiIvDssD,0BAA4BnuD,GAhIlCoB,KAAKiuB,QAAUA,EACfjuB,KAAK69B,YAAcA,EAEnB79B,KAAK4sD,SAAW5sD,KAAKgtD,eAAe/+B,GACpCjuB,KAAK6sD,WAAa7sD,KAAKitD,iBAAiBh/B,GAExCjuB,KAAK4sD,SAASn+B,QAAQzuB,KAAK6sD,YAC3B7sD,KAAK6sD,WAAWp+B,QAAQzuB,KAAK69B,aAE7B79B,KAAKwsD,SAAWA,EAChBxsD,KAAKktD,iBAAiBT,GA3B1B,+CA+BE,SAAYD,GAA+B,IAAD,OAGxC,OAFAxsD,KAAKwsD,SAAWA,EAERA,GACN,IAAK,QAAU,IAAD,EACZ,UAAAxsD,KAAK0sD,kBAAL,SAAiBr+B,aAKbruB,KAAKmc,WACPC,cAAcpc,KAAKmc,UACnBnc,KAAKmc,cAAW1b,GAEdT,KAAK2sD,cACP3sD,KAAK2sD,aAAaQ,QAEpB,MAEF,IAAK,UAAY,IAAD,EACd,UAAAntD,KAAK0sD,kBAAL,SAAiBj+B,QAAQzuB,KAAK4sD,UAE1B5sD,KAAKmc,WACPC,cAAcpc,KAAKmc,UACnBnc,KAAKmc,cAAW1b,GAEdT,KAAK2sD,cACP3sD,KAAK2sD,aAAaQ,QAEpB,MAEF,IAAK,UAAY,IAAD,EACd,UAAAntD,KAAK0sD,kBAAL,SAAiBr+B,aAKZruB,KAAK2sD,eACR3sD,KAAK2sD,aAAe3sD,KAAKotD,sBAE3BptD,KAAK2sD,aAAarrD,OAAQ,EACrBtB,KAAKmc,WACRnc,KAAKmc,SAAWK,aACd,WACwB,IAAD,EAAhBmO,GAAUjiB,OACT,OAAJ,QAAI,IAAJ,eAAMikD,oBAAN,SAAoBU,OAAO/oD,MAAK,WAE1B,EAAK6X,WACPC,cAAc,EAAKD,UACnB,EAAKA,cAAW1b,MAEjB8D,OAAM,SAAA0R,UAKb,MAGJ,MAEF,QACExH,QAAQI,MAAR,0BAAiC29C,IAIrCxsD,KAAKktD,iBAAiBltD,KAAKysD,YAC3BzsD,KAAKstD,iBAlGT,4BAqGE,SAAe1mD,GACT5G,KAAK8sD,gBAAkBlmD,IACzB5G,KAAK8sD,cAAgBlmD,EACjB5G,KAAK2sD,cACPR,GAAqBnsD,KAAK2sD,aAAc3sD,KAAK8sD,kBAzGrD,0BA8GE,SAAajnD,GACX7F,KAAKutD,mBAAmB1nD,GACxB7F,KAAKwtD,YAAYxtD,KAAKwsD,YAhH1B,wBAmHE,SAAW19D,GACT,IAYM,IlFzIYpE,EAAU+C,EkF6HtBggE,EAAO7/D,EAAMkB,EAAKH,UAClB++D,GAAQD,EAAOA,GAASztD,KAAK6sD,WAAWc,YAAc3tD,KAAK6sD,WAAWc,aACxE3tD,KAAK6sD,WAAWc,YAAc,IAAMF,GAAc,IACtDztD,KAAKurB,SAAWmiC,EAAMD,EAElBztD,KAAK6sD,WAAWe,WAAa5tD,KAAK6sD,WAAWgB,eAC/C7tD,KAAK6sD,WAAWe,UAAUzvB,eAAeuvB,EAAM5+D,EAAKH,SAAS,GAAIqR,KAAKiuB,QAAQmQ,aAC9Ep+B,KAAK6sD,WAAWiB,UAAU3vB,eAAeuvB,EAAM5+D,EAAKH,SAAS,GAAIqR,KAAKiuB,QAAQmQ,aAC9Ep+B,KAAK6sD,WAAWkB,UAAU5vB,eAAeuvB,EAAM5+D,EAAKH,SAAS,GAAIqR,KAAKiuB,QAAQmQ,aAC9Ep+B,KAAK6sD,WAAWgB,aAAa1vB,eAAervC,EAAKP,YAAY,GAAIyR,KAAKiuB,QAAQmQ,aAC9Ep+B,KAAK6sD,WAAWmB,aAAa7vB,eAAervC,EAAKP,YAAY,GAAIyR,KAAKiuB,QAAQmQ,aAC9Ep+B,KAAK6sD,WAAWoB,aAAa9vB,eAAervC,EAAKP,YAAY,GAAIyR,KAAKiuB,QAAQmQ,gBAE9E,EAAAp+B,KAAK6sD,YAAWqB,YAAhB,qBlF1IgBxjE,EkF0IqBgjE,ElF1IXjgE,EkF0IgBqB,EAAKH,SlFzI5C,CAACjE,EAAI+C,EAAE,GAAI/C,EAAI+C,EAAE,GAAI/C,EAAI+C,EAAE,QkF0I9B,EAAAuS,KAAK6sD,YAAWsB,eAAhB,oBAAkCr/D,EAAKP,eAEzCyR,KAAKstD,iBApIT,0BAsIE,WACE,IAAIc,EAAS,EACS,YAAlBpuD,KAAKwsD,WACP4B,EAASziE,KAAKI,IAAIJ,KAAK+oB,IAAI1U,KAAKurB,SAAUvrB,KAAK6sD,WAAWc,aAAe3tD,KAAK6sD,WAAWc,aACrE3tD,KAAK6sD,WAAWwB,gBAElCruD,KAAK2sD,eACP3sD,KAAK2sD,aAAayB,OAASA,KA7IjC,oCAkJE,WAA0C,OAAOpuD,KAAK+sD,2BAlJxD,IAmJE,SAAqCx9D,GACnCyQ,KAAK+sD,0BAA4Bx9D,EAC7ByQ,KAAK6sD,WAAWc,cAAgBrB,KAClCtsD,KAAK6sD,WAAWc,YAAc3tD,KAAK+sD,6BAtJzC,6BAyJE,SAAgBuB,GAIZtuD,KAAK6sD,WAAWc,YAHbW,EAG2BhC,GAFAtsD,KAAKuuD,2BA3JzC,gCAiKE,SAAmB/nD,GAA6B,IAAD,OAE3C,CAAC,iBAAkB,iBAAkB,gBAAiB,gBAAiB,cAAe,gBAAiB,eAAgB,cAAe,iBACrH1Y,SAAQ,SAAC6E,GACd,gBAARA,EACF,EAAK47D,yBAA2B/nD,EAAM,YAErC,EAAKqmD,WAAWl6D,GAAe6T,EAAO7T,QAxK/C,8BA6KE,SAAiB85D,GACXA,EACFzsD,KAAK4sD,SAASn+B,QAAQzuB,KAAK6sD,YAE3B7sD,KAAK4sD,SAASv+B,aAGZruB,KAAK2sD,eACP3sD,KAAK2sD,aAAarrD,OAASmrD,GAG7BzsD,KAAKysD,WAAaA,IAxLtB,wBA2LE,WACMzsD,KAAK0sD,YACP1sD,KAAK0sD,WAAWr+B,aAGlBruB,KAAK4sD,SAASv+B,aACdruB,KAAK6sD,WAAWx+B,aACZruB,KAAK2sD,eACP3sD,KAAK2sD,aAAayB,OAAS,EAC3BpuD,KAAK2sD,aAAaQ,QAClBntD,KAAK2sD,aAAa/e,YArMxB,uBAyME,WACE,OAAO5tC,KAAK6sD,WAAWc,cAAgBrB,KA1M3C,4BA6ME,SAAuBr+B,GACrB,IAAMugC,EAAOvgC,EAAQwgC,aAIrB,OAFAD,EAAKA,KAAK73C,MAAQ,EAEX63C,IAlNX,8BAqNE,SAAyBvgC,GAGvB,OAFeA,EAAQygC,iBAtN3B,gCA2NE,SAA2B7oD,GACrB7F,KAAK0sD,YACP1sD,KAAK0sD,WAAWr+B,kBAGH5tB,IAAXoF,GAMJ7F,KAAK0sD,WAAa1sD,KAAKiuB,QAAQO,wBAAwB3oB,QAI7BpF,IAAtBT,KAAK2sD,eACP3sD,KAAK2sD,aAAe3sD,KAAKotD,sBAG3BptD,KAAK2sD,aAAald,UAAY5pC,GAb5B7F,KAAK0sD,gBAAajsD,IAjOxB,gCAmPE,WACE,IAAMK,EAAQ,IAAI6tD,MAGlB,OAFAxC,GAAqBrrD,EAAOd,KAAK8sD,eAE1BhsD,MAvPX,KA4Pa8tD,GAAb,8MACUC,yBADV,gDAGE,SAAS5sC,GACPjiB,KAAK8uD,eAAe7sC,GACpBjiB,KAAKwtD,YAAYxtD,KAAKwsD,YAL1B,4BAQE,SAAuBvqC,GAIrB,GAHIjiB,KAAK0sD,YACP1sD,KAAK0sD,WAAWr+B,kBAEL5tB,IAATwhB,EAAJ,CAKA,IAAMj5B,EAAME,IAAIm+B,gBAAgBpF,GAI5BjiB,KAAK6uD,qBAAsB7uD,KAAK6uD,oBAAoBjhB,SACxD5tC,KAAK6uD,oBAAsB7uD,KAAKotD,qBAChCptD,KAAK6uD,oBAAoBprD,IAAMza,EAC/BgX,KAAK0sD,WAAa1sD,KAAKiuB,QAAQ8gC,yBAAyB/uD,KAAK6uD,qBAC7D7uD,KAAK0sD,WAAWj+B,QAAQzuB,KAAK4sD,UAC7B5sD,KAAK6uD,oBAAoBvtD,OAAQ,EACjC,SAAS0tD,EAAUC,GAA6B,IAAD,EAC7C,UAAAA,EAAMJ,2BAAN,SAA2BxB,OAAO9oD,OAAM,WACtC6V,YAAW,kBAAI40C,EAAUC,KAAQ,QAGrCD,CAAUhvD,WAGgBS,IAAtBT,KAAK2sD,eACP3sD,KAAK2sD,aAAe3sD,KAAKotD,qBACzBptD,KAAK2sD,aAAarrD,OAAQ,GAE5BtB,KAAK2sD,aAAalpD,IAAMva,IAAIm+B,gBAAgBpF,GAC5C,SAASitC,EAAWD,GAA6B,IAAD,EAC9C,UAAAA,EAAMtC,oBAAN,SAAoBU,OAAO9oD,OAAM,WAC/B6V,YAAW,kBAAI80C,EAAWD,KAAQ,QAGtCC,CAAWlvD,WAhCTA,KAAK0sD,gBAAajsD,IAbxB,yBAgDE,SAAY+rD,GACVxsD,KAAKwsD,SAAWA,EAChBxsD,KAAKstD,mBAlDT,GAA0Cf,IC1OpC4C,GAAmB,IA7CzB,cAWE,aAAc,sWAFdC,kBAA2BpvD,KAAK2tD,YAG9B5tD,aAAeC,MAZnB,+CAgBE,WAEE,OAtBY,IAsBLA,KAAK2tD,YArBQ,MAGxB,8BAqBE,SACiBtC,GACfrrD,KAAKovD,kBAAoB/D,EA3Bb,IACQ,IA2BpB,IAAM1rD,EAAUsH,GAAaI,MAAMlF,QAAQxC,QAC3CK,KAAKqvD,aAAa1vD,KAzBtB,0BA6BE,SACa2vD,GAKXtvD,KAAK2tD,YAA+C3tD,KAAKovD,oBAnC7D,8BAuCE,SACiBj8C,GACf9U,OAAO+D,OAAOpC,KAAMmT,OAzCxB,mDACGlT,MADH,yEAC+B,KAD/B,8CAEGA,MAFH,yEAE+B,OAF/B,6CAGGA,MAHH,yEAG8B,KAH9B,2CAIGA,MAJH,yEAI4B,OAJ5B,4CAKGA,MALH,wEAK+C,UAL/C,6CAMGA,MANH,wEAMiD,iBANjD,2CAOGA,MAPH,yEAO4BrB,MAP5B,6CAQGqB,MARH,yEAQ8B,MAR9B,0CAgBGsB,MAhBH,yHAqBGC,MArBH,wHA6BGA,MA7BH,wHAuCGA,MAvCH,mFA8Ce2tD,MAEf7rD,cAAQ,WACN,IAAMgsD,EAAQroD,GAAaI,MAAMlF,QAAQxC,QACzCwvD,GAAiBE,aAAaC,M,yBClD1BC,GAAqB,GAK3B,SAASC,KAEP,MAAoB,KAAbnmD,KAAKC,MAGd,IAAM0/B,GAAYC,aAAW,CAC3BqQ,OAAQ,CACNjuD,MAAO,OACPC,OAAQ,UAMNmkE,G,mDACJ7oC,Y,OACA8oC,KAAmB,G,KACnBC,cAAgB,E,KAChBC,mBAAqB,E,KACrBC,sBAAwB,E,KACxBC,YAAc,E,KACdC,aAAe,E,KACf58C,OAAyC,IAAItoB,I,KAC7CysB,SAAU,E,KACV04C,WAA8B,CAAC,EAAG,G,KAClCC,SAAW,G,KACXC,WAAa,E,KACbC,eAAiB,E,KACjBC,oBAAsB,E,KACtBxvB,W,KAOK,SAASyvB,GAAaz4C,GAG3B,OAPK,SAAwB04C,GAC7B,OAAO,IAAIzlE,IACTylE,EAAW5iE,KAAI,SAAA0lB,GAAK,OAAIA,EAAMxiB,MAAM,SAK/B2/D,CAFY34C,EAAShnB,MAAM,MAcpC,SAAS4/D,GAAcvmB,GACjBA,EAAO6lB,cACT3sB,aAAa8G,EAAO6lB,aACpB7lB,EAAO6lB,YAAc,GAEnB7lB,EAAO8lB,eACT5sB,aAAa8G,EAAO8lB,cACpB9lB,EAAO8lB,aAAe,GAI1B,SAASU,GAAc94C,EAAcyc,EAAe6V,GAClD//C,EAAO+/C,EAAOrjB,QACdqjB,EAAOylB,KAAO,UACdc,GAAcvmB,GACd,IACIymB,GADQlB,KACQ73C,GAASsyB,EAAOrjB,OAAO+pC,kBAC3C,GAAiC,YAA7B1mB,EAAOrjB,OAAOgqC,YACwB,IAAvC3mB,EAAOrjB,OAAOiqC,cAAcr/D,QAAgBy4C,EAAOrjB,OAAOkqC,qBAAuB18B,KAClFzoC,KAAKC,IAAIq+C,EAAOrjB,OAAOmqC,iBAAmBL,GAAUnB,IAFtD,CAQA,IAAIyB,GAAc,KACU,SAAtBC,IACJ,GAAKhnB,EAAOrjB,OAAZ,CACA,IAAMgB,EAAMqiB,EAAOrjB,OAAOmqC,iBAE1B,GAAiC,WAA7B9mB,EAAOrjB,OAAOgqC,YAA2BjlE,KAAKC,IAAIolE,EAAappC,GAAO2nC,GAKxE,OAJAtlB,EAAOrjB,OAAOymC,YACdl5C,GAAW,yBAAkB81B,EAAOrjB,OAAOgqC,WAAhC,oBACJ3mB,EAAOrjB,OAAOmqC,iBADV,oBACsCL,GAAUzmB,EAAO92B,QAMpE,IAAM7J,EAAMkmD,KACZkB,GAAUpnD,EAAMqO,GAASsyB,EAAOrjB,OAAO+pC,kBAEvCK,EAAaN,EADM,EACgBzmB,EAAOrjB,OAAO+pC,kBACjD,IAAI7tC,EAAWmnB,EAAOrjB,OAAOsqC,cACI,cAA7BjnB,EAAOrjB,OAAOgqC,YAA+B9tC,IAC/CmnB,EAAO0lB,cAAgB,EACvB1lB,EAAOrjB,OAAOymC,OACdvqC,EAAWmnB,EAAOrjB,OAAOsqC,eAEvB98B,GAAS,GAAKA,IAAU6V,EAAOrjB,OAAOkqC,qBACxC7mB,EAAO0lB,cAAgB,EACvB1lB,EAAOrjB,OAAOuqC,YAAY/8B,GAC1BtR,EAAWmnB,EAAOrjB,OAAOsqC,eAEvBpuC,IACFmnB,EAAOrjB,OAAOumC,QACV6D,EAAaluC,IAEfnL,EAAQrO,EAjBO,GAgBf0nD,GAA0BluC,GACcmnB,EAAOrjB,OAAO+pC,mBAExD1mB,EAAOrjB,OAAOwqC,KAAKJ,IAErB/mB,EAAO6lB,YAAc11C,WAAW62C,EAAQI,MAE1CJ,IAEF,SAASK,GAAehkD,EAAa28B,GACnC//C,EAAO+/C,EAAOrjB,QACdqjB,EAAOylB,KAAO,SACdc,GAAcvmB,IACkB,SAA1BsnB,IACJ,GAAKtnB,EAAOrjB,OAAZ,CACA,IAAM4qC,EAAWvnB,EAAO92B,OAAO1pB,IAAI,SAC7B2qC,EAAQvjC,OAAO2gE,IAAuB,GAE5C,GAAiC,WAA7BvnB,EAAOrjB,OAAOgqC,YACfx8B,GAAS,GAAKA,IAAU6V,EAAOrjB,OAAOkqC,mBAQvC,MAPiC,cAA7B7mB,EAAOrjB,OAAOgqC,YAA8B3mB,EAAOrjB,OAAOymC,OAC1Dj5B,GAAS,GAAKA,IAAU6V,EAAOrjB,OAAOkqC,oBACxC7mB,EAAOrjB,OAAOuqC,YAAY/8B,GAE5B6V,EAAOrjB,OAAOumC,aACdljB,EAAO8lB,aAAe31C,WAAWm3C,EAxIhB,MA6IftnB,EAAOrjB,OAAOmqC,mBAAqBzjD,IACrC28B,EAAOrjB,OAAOwqC,KAAK9jD,GACnB6G,GAAW,0BAAD,OAA2B7G,GAAQ28B,EAAO92B,SAEtD82B,EAAO4lB,sBAAwB5lB,EAAOrjB,OAAOmqC,kBAE/CQ,GAQF,SAASE,GAAcC,EAAmBpkD,EAAa28B,GAAmB,IAAD,IANpD92B,KAOP82B,EAAO92B,QANZpoB,OAAO,WACdooB,EAAOpoB,OAAO,UACdooB,EAAOpoB,OAAO,SAKdk/C,EAAO92B,OAAO3L,IAAIkqD,EAAUp8C,OAAOhI,IACnC28B,EAAO92B,OAAO3L,IAAI,OAAQ8N,OAAM,UAAC20B,EAAOrjB,cAAR,aAAC,EAAe+pC,oBAChD,IAAMz/B,EAAG,UAAG+Y,EAAOrjB,cAAV,aAAG,EAAekqC,mBAC3B7mB,EAAO92B,OAAO3L,IAAI,QAAS8N,OAAO4b,IAAa,IAC/C+Y,EAAOrJ,MAAMpuB,QAAQxpB,IArHhB,SAAsBmqB,GAC3B,IADiE,EAC7DziB,EAAM,GACNihE,EAAM,GAFuD,cAG7Cx+C,GAH6C,IAGjE,2BAA4B,CAAC,IAAlBC,EAAiB,QAC1B1iB,GAAG,UAAOihE,GAAP,OAAav+C,EAAM,GAAnB,YAAyBA,EAAM,IAClCu+C,EAAM,KALyD,8BAQjE,OAAOjhE,EA6GoBkhE,CAAa3nB,EAAO92B,QAC/C82B,EAAOrJ,MAAMqkB,cAAchb,EAAOrJ,MAAMpuB,SACxC2B,GAAW,iBAAD,OAAkBu9C,EAAlB,cAAgCpkD,GAAQ28B,EAAO92B,QAG3D,SAAS0+C,GAAgB5nB,GACvB,GAAKA,EAAOrjB,OAAZ,CACA,IAAM9E,EAAQmoB,EAAOrjB,OAAOgqC,WAC5B,GAAK3mB,EAAO3yB,SAAyB,KAAd2yB,EAAOylB,MAAuB,WAAV5tC,EAYrCmoB,EAAO2lB,qBACTxzC,cAAc6tB,EAAO2lB,oBACrB3lB,EAAO2lB,mBAAqB,OAd+B,CAE7D,IAAMxxB,EAAc6L,EAAOrjB,OAAOmqC,iBAElC,GADA58C,GAAW,0BAAD,OAA2BiqB,EAA3B,kBAAgD6L,EAAO4lB,sBAAvD,iBAAqF5lB,EAAO92B,OAAO1pB,IAAI,YAC7GkC,KAAKC,IAAIwyC,EAAc6L,EAAO4lB,uBAAyBN,GACzDtlB,EAAO4lB,sBAAwBzxB,EAE3BA,IADcvtC,OAAOo5C,EAAO92B,OAAO1pB,IAAI,YAEzCgoE,GAAc,SAAUrzB,EAAa6L,KA0B7C,SAASqjB,GAAa/hC,EAAiB0e,GACjCA,EAAOrjB,SACTqjB,EAAOimB,WD1JJ,SAAoBzC,GACzB,IAEMliC,GAFQkiC,EAAOA,GAAS0B,GAAiBxB,YAAcwB,GAAiBxB,aAC5EwB,GAAiBxB,YAAc,IAAMF,GAAc,GAC9BA,EAIvB,OAHe9hE,KAAKI,IAAIJ,KAAK+oB,IAAI6W,EAAU4jC,GAAiBxB,aAAewB,GAAiBxB,aAC1FwB,GAAiBd,eCqJGyD,CAAWvmC,GAC/B0e,EAAOrjB,OAAOmrC,UAAU9nB,EAAOgmB,SAAWhmB,EAAOimB,WAAa,MAIlE,SAAS8B,GAAwB/nB,GAC/B,GAAKA,EAAOrJ,MAAMjgB,OAAO1Z,aAAzB,EArBF,SAAwBgjC,GACtB,GAAKA,EAAOrjB,OAAZ,CACA,GAA0B,IAAtBqjB,EAAOimB,YAA8C,IAA1BjmB,EAAOkmB,eAAqB,CACzD,IAAM8B,EAAYhoB,EAAOrjB,OAAOsrC,YAAc,IAC1CD,IAAchoB,EAAOgmB,WACvBhmB,EAAOgmB,SAAWgC,QAIpBhoB,EAAOrjB,OAAOmrC,UAAU9nB,EAAOgmB,SAAWhmB,EAAOimB,WAAa,KAEhEjmB,EAAOkmB,eAAiBlmB,EAAOimB,YAW/BiC,CAAeloB,GACf,IAAMmoB,EAAS9kE,EAAM28C,EAAOrJ,MAAMpuB,QAAQ1jB,KAAKH,SAAUs7C,EAAOrJ,MAAMjgB,OAAO1Z,aAAaI,MAAMvY,KAAKH,UAErG,GAAIf,EADSN,EAAM8kE,EAAQnoB,EAAO+lB,aAChBpxD,EAAuB,CACvCqrC,EAAO+lB,WAAa,CAACoC,EAAO,GAAIA,EAAO,IACvC,IAAI,IAAI7gE,EAAE,EAAGA,EAAE,EAAGA,IACZ6gE,EAAO7gE,GAAK,IACd6gE,EAAO7gE,IAAM04C,EAAOrJ,MAAMpuB,QAAQ/iB,KAAK8B,GACnC6gE,EAAO7gE,GAAK,IAAK6gE,EAAO7gE,GAAK,IAIrC+7D,GADa1/D,EAAMwkE,GACAnoB,KAUhB,IAAMooB,GAAkC,SAACzxB,GAC9C12C,EAA8B,YAAvB02C,EAAMpuB,QAAQ9J,MACrB,IAAM2gC,EAAUL,KAEViB,EADYrC,kBAAiB,IAAI6nB,IACd53B,QACzBoS,EAAOrJ,MAAQA,EAGf,IAAMtpB,EAAUovB,cAAY,kBAAM9F,EAAMjgB,OAAOuC,SAAS5L,UAAYspB,EAAMpuB,QAAQ5L,MAG5E0rD,EAAYroB,EAAO92B,OAEzB,GADA82B,EAAO92B,OAASk9C,GAAazvB,EAAMpuB,QAAQxpB,MACtCsuB,IAAY2yB,EAAO3yB,UtFnPnB,SAAqCi7C,EAAkBC,GAC5D,IAAIC,EACJ,GAAIF,EAAK9iE,OAAS+iE,EAAK/iE,KACrB,OAAO,EAHqE,oBAKrD8iE,GALqD,IAK9E,2BAA+B,CAAC,IAAD,yBAAnB5/D,EAAmB,KAAdpD,EAAc,KAE7B,IADAkjE,EAAUD,EAAK/oE,IAAIkJ,MACHpD,QAAoBkR,IAAZgyD,IAA0BD,EAAK/uC,IAAI9wB,GACzD,OAAO,GARmE,8BAY9E,OAAO,EsFuO6B+/D,CAAoBzoB,EAAO92B,OAAQm/C,KACjEroB,EAAOrjB,OAAQ,CACbqjB,EAAO92B,OAAO1pB,IAAI,UAAY6oE,EAAU7oE,IAAI,SAC9CwgD,EAAOrjB,OAAO+rC,gBAAgB9hE,OAAOo5C,EAAO92B,OAAO1pB,IAAI,UAGzD,IAAMmpE,EAAa3oB,EAAO92B,OAAO1pB,IAAI,WAC/BopE,OAA0BpyD,IAAbmyD,GAA0BA,IAAeN,EAAU7oE,IAAI,WACpEqpE,EAAY7oB,EAAO92B,OAAO1pB,IAAI,UAC9BspE,OAA0BtyD,IAAZqyD,GAAyBA,IAAcR,EAAU7oE,IAAI,UACrEopE,GACF1+C,GAAW,0BAAD,OAA2By+C,EAA3B,WACVnC,GAAc5/D,OAAOo5C,EAAO92B,OAAO1pB,IAAI,YAAaoH,OAAOo5C,EAAO92B,OAAO1pB,IAAI,UAAWwgD,IAChF8oB,IACR5+C,GAAW,2BAAD,OAA4B2+C,EAA5B,WACVxB,GAAezgE,OAAOo5C,EAAO92B,OAAO1pB,IAAI,WAAYwgD,IAgJ1D,OA5IAA,EAAO3yB,QAAUA,EAGjBioB,sBACE,WACEr1C,EAAO02C,EAAMpuB,QAAQ5L,IACrB,IAAIosD,GAAa,EACjB,IAAK/oB,EAAOrjB,OAAQ,CAClB,IAAMhgB,EAAE,aAASg6B,EAAMpuB,QAAQ5L,IACzBggB,EAAS,IAAIqsC,KAAcrsD,GAC5BqjC,EAAO92B,OAAOsQ,IAAI,YAAewmB,EAAO92B,OAAOsQ,IAAI,WAAcwmB,EAAO92B,OAAOsQ,IAAI,WAEtFuvC,GAAa,EACb/oB,EAAO92B,OAAO3L,IAAI,UAAW8N,QAAQ,IACrCsR,EAAOymC,QAETpjB,EAAOrjB,OAASA,EAChBzS,GAAW,gBAAD,OAAiBvN,EAAjB,aAENqjC,EAAO92B,OAAOsQ,IAAI,SACpBmD,EAAO+rC,gBAAgB9hE,OAAOo5C,EAAO92B,OAAO1pB,IAAI,UAE7CwgD,EAAO3yB,UACN2yB,EAAO92B,OAAOsQ,IAAI,UACpB6tC,GAAezgE,OAAOo5C,EAAO92B,OAAO1pB,IAAI,WAAYwgD,IAC3C+oB,GAAc/oB,EAAO92B,OAAOsQ,IAAI,YACzCgtC,GAAc5/D,OAAOo5C,EAAO92B,OAAO1pB,IAAI,YAAaoH,OAAOo5C,EAAO92B,OAAO1pB,IAAI,UAAWwgD,IAK5FrjB,EAAO+O,GAAG,SAAS,SAACtkC,GAAD,OAAa8iB,GAAW,eAAgB9iB,MAC3Du1B,EAAO+O,GAAG,aAAa,kBAAMxhB,GAAW,sBACxCyS,EAAO+O,GAAG,QAAQ,kBAAMxhB,GAAW,iBAEnCyS,EAAO+O,GAAG,aAAa,WACrBxhB,GAAW,mBACXyS,EAAOssC,YAETtsC,EAAO+O,GAAG,SAAS,YACjBxhB,GAAW,eACP81B,EAAOrjB,SAET6pC,GADYjB,KACO,EAAGvlB,MAI1BrjB,EAAO+O,GAAG,UAAU,WAClBxhB,GAAW,mBAAD,OAAoByS,EAAOmqC,iBAA3B,iBAAoD9mB,EAAOylB,MAAQzlB,EAAO92B,QAChE,WAAhB82B,EAAOylB,KACTzlB,EAAOylB,KAAO,GACS,KAAhBzlB,EAAOylB,KACTzlB,EAAO92B,OAAOsQ,IAAI,WACrBrJ,YAAW,WACJ6vB,EAAO92B,OAAOsQ,IAAI,WAAcwmB,EAAO92B,OAAOsQ,IAAI,YAAoC,WAAtBmD,EAAOgqC,YAC1Ea,GAAc,SAAU7qC,EAAOmqC,iBAAkB9mB,KAElD,KAGL91B,GAAW,mBAAD,OAAoB81B,EAAOylB,OAGnB,KAAhBzlB,EAAOylB,MAAgBzlB,EAAO2lB,qBAChC3lB,EAAO2lB,mBACHpzC,YAAYq1C,GA3UL,IA2UsC5nB,OAGrDrjB,EAAO+O,GAAG,WAAW,WACnBxhB,GAAW,sBAAD,OAAuB81B,EAAOylB,KAA9B,iBAA2CzlB,EAAO0lB,eAAiB1lB,EAAO92B,QACpF,IAAIggD,GAAe,EAOnB,GANIvsC,EAAOiqC,cAAcr/D,OAAS,GAC5Bo1B,EAAOkqC,qBAAuBjgE,OAAOo5C,EAAO92B,OAAO1pB,IAAI,YACzDwgD,EAAO92B,OAAO3L,IAAI,QAAS8N,OAAOsR,EAAOkqC,qBACzCqC,GAAe,GAGC,YAAhBlpB,EAAOylB,KACLzlB,EAAO0lB,cACT1lB,EAAO0lB,cAAgB,EAEvB1lB,EAAOylB,KAAO,QAEZ,GAAoB,KAAhBzlB,EAAOylB,KAAY,CAC3B,IAEM/3C,EAFM63C,KACE5oC,EAAOmqC,iBAAmBnqC,EAAO+pC,kBAE3CyC,EAAUviE,OAAOo5C,EAAO92B,OAAO1pB,IAAI,aACtB,IAAb2pE,IAAiBA,EAAUz7C,GAC/B,IAAM/sB,EAAO+sB,EAAQy7C,IAChBnpB,EAAO92B,OAAOsQ,IAAI,YAAc0vC,GAAgBxnE,KAAKC,IAAIhB,GAAQ2kE,KAEpEkC,GAAc,UAAW95C,EAAOsyB,OAItCrjB,EAAO+O,GAAG,sBAAsB,WAC9BxhB,GAAW,4BACX,IAEMwD,EAFM63C,KACE5oC,EAAOmqC,iBAAmBnqC,EAAO+pC,kBAEzC7uC,EAAQ8E,EAAOgqC,WAErBa,GADkC,WAAV3vC,EAAqB,SAAqB,YAAVA,EAAsB,UAAY,QACnEnK,EAAOsyB,MAKlC,IAAMrjB,EAASqjB,EAAOrjB,OAkBtB,OAjBIA,IACEqjB,EAAO92B,OAAOsQ,IAAI,SACpBmD,EAAOysC,SAAS,CACdC,SAAS,WACTnkD,KAAK86B,EAAO92B,OAAO1pB,IAAI,UAEzB0qB,GAAW,gBAAD,OAAiB81B,EAAO92B,OAAO1pB,IAAI,WACrCwgD,EAAO92B,OAAOsQ,IAAI,OAC1BmD,EAAOxY,KAAK67B,EAAO92B,OAAO1pB,IAAI,MAC9B0qB,GAAW,YAAD,OAAa81B,EAAO92B,OAAO1pB,IAAI,SAIxCwgD,EAAOmmB,sBACVnmB,EAAOmmB,oBAAsB5zC,YAAYw1C,GApYzB,IAoYmE/nB,IAG9E,WACDA,EAAOrjB,QACTqjB,EAAOrjB,OAAO2sC,UAEhBtpB,EAAOrjB,YAASnmB,EACZwpC,EAAOmmB,qBACTh0C,cAAc6tB,EAAOmmB,wBAK3B,IAGK,sBAAKxpD,GAAE,YAAOg6B,EAAMpuB,QAAQ5L,IAAM8iC,UAAWL,EAAQiQ,UC1YvD,SAASka,GAAiB9qD,GAA2C,IAAxBjZ,EAAuB,uDAAhB,GAAIpE,EAAY,wDAAH,EAClEA,EAAQ,IAAKA,EAAQoE,GAezB,IAAMgkE,EAAQ,CACZ1vD,IAAK,eAAC,KAAD,CAAW+S,MAAO9rB,IAAiB,CAAC60C,SAASpwC,EAAMpE,MAAO,OAAQC,OAAO,QAAU,CAACu0C,SAASpwC,EAAMpE,MAAO,OAAQC,OAAO,UAC9H+c,KAAK,eAAC,KAAD,CAAyEyO,MAAO9rB,IAAiB,CAAC60C,SAASpwC,EAAMpE,MAAO,OAAQC,OAAO,QAAU,CAACu0C,SAASpwC,EAAMpE,MAAO,OAAQC,OAAO,UAC5LguD,OAAQ,eAAC,KAAD,CAAUxiC,MAAO,CAAC+oB,SAASpwC,EAAMpE,WACzCqoE,QAAS,eAAC,KAAD,CAAa58C,MAAO,CAAC+oB,SAASpwC,EAAMpE,WAC7CD,OAAQ,eAAC,KAAD,CAA6E0rB,MAAO9rB,IAAiB,CAAC60C,SAASpwC,EAAMpE,MAAO,OAAQC,OAAO,QAAU,CAACu0C,SAASpwC,EAAMpE,MAAO,OAAQC,OAAO,UACnMqoE,OAAQ,uBAAM78C,MAAO,CAACzrB,QAAOC,OAAOmE,GAA5B,SAAmC,eAAC,QAAD,CAAMg7B,KAAMmpC,KAAiBtoE,OAAQmE,MAChFokE,WAAY,uBAAM/8C,MAAO,CAACzrB,QAAOC,OAAOmE,GAA5B,SAAmC,eAAC,QAAD,CAAMg7B,KAAMqpC,KAAqBxoE,OAAQmE,MACxFiqD,OAAQ,eAAC,KAAD,CAAe5iC,MAAO,CAAC+oB,SAASpwC,EAAMpE,WAC9C0oE,IAAM,uBAAMj9C,MAAO,CAACzrB,QAAOC,OAAOmE,GAA5B,SAAmC,eAAC,QAAD,CAAMg7B,KAAMupC,KAAY1oE,OAAQmE,MACzEwkE,eAAgB,eAAC,KAAD,CAAiBn9C,MAAO,CAAC+oB,SAASpwC,EAAMpE,WACxD6oE,eAAgB,eAAC,KAAD,CAAep9C,MAAO,CAAC+oB,SAASpwC,EAAMpE,WACtDsd,KAAM,+BACN6J,QAAS,+BACT,QAAI/R,GAGN,OAAOgzD,EAAM/qD,GAER,SAASyrD,GAAc78C,EAAkBtrB,GAC9C,IAAM0c,EAAO1c,EAAIA,EAAE0c,KAAO,GAC1B,MAAa,eAATA,EACehW,GAAV4kB,EAAY,sBAA2B,oBAC7B,WAAT5O,EACShW,GAAV4kB,EAAY,kBAAuB,gBACzB,YAAT5O,EACShW,GAAV4kB,EAAY,mBAAwB,iBAC1B,WAAT5O,EACShW,GAAV4kB,EAAY,kBAAuB,gBACzB,SAAT5O,EACShW,GAAV4kB,EAAY,gBAAqB,cAGnC,GAIT,IAAM0xB,GAAYC,aAAW,CAC3BllC,IAAK,CACH1Y,MAAO,OACPC,OAAQ,OACR0hD,cAAe,SACfoU,SAAU,OACVrW,cAAe,QAEjBuO,OAAQ,CACNjuD,MAAO,OACPC,OAAQ,OACRy/C,cAAe,OACfmI,OAAQ,QAEVwR,WAAY,CACVr5D,MAAO,OACPC,OAAQ,OACR4nD,OAAQ,QAEV0W,IAAI,CACFv+D,MAAO,OACPC,OAAQ,UAQC8oE,GAAqC,SAACxzB,GACjD,IAAMyI,EAAUL,KACV1xB,EAAUovB,cAAY,kBAAM9F,EAAMjgB,OAAOuC,SAAS5L,UAAYspB,EAAMpuB,QAAQ5L,MA2BlF,MAxB2B,QAAvBg6B,EAAMpuB,QAAQ9J,KACX,sBAAKghC,UAAWL,EAAQtlC,IAAKN,IAAKm9B,EAAMpuB,QAAQxpB,IAAKs8C,IAAK1E,EAAMpuB,QAAQ1T,OAC9C,WAAvB8hC,EAAMpuB,QAAQ9J,MAA4C,eAAvBk4B,EAAMpuB,QAAQ9J,KACpD,sBAAKghC,UAAWL,EAAQugB,IAAxB,SACH,yBAAQlgB,UAAWpyB,EAAU+xB,EAAQqb,WAAarb,EAAQiQ,OACxDxiC,MAA4B,eAArB8pB,EAAMpuB,QAAQ9J,KAAoB,CAACwf,gBAAiB0Y,EAAMpuB,QAAQH,QAAQ,gBAAgB,SAAS,GAC1G5O,IAAKm9B,EAAMpuB,QAAQxpB,IAA8B+5B,MAAO6d,EAAMpuB,QAAQ1T,MAAzC8hC,EAAMpuB,QAAQ1T,QAEhB,YAAvB8hC,EAAMpuB,QAAQ9J,KACjB,eAAC,GAAD,gBAAak4B,IACa,WAAvBA,EAAMpuB,QAAQ9J,KACjB,eAAC,GAAD,gBAAYk4B,IACc,QAAvBA,EAAMpuB,QAAQ9J,KACjB,eAAC,GAAD,gBAASk4B,IACiB,SAAvBA,EAAMpuB,QAAQ9J,KACjB,eAAC,GAAD,gBAAUk4B,IACgB,WAAvBA,EAAMpuB,QAAQ9J,MAA4C,WAAvBk4B,EAAMpuB,QAAQ9J,KACpD,eAAC,GAAD,gBAAmBk4B,IACO,mBAAvBA,EAAMpuB,QAAQ9J,MAAoD,mBAAvBk4B,EAAMpuB,QAAQ9J,KAC5D,eAAC,GAAD,gBAA2Bk4B,IAE3B,iDAAmBA,EAAMpuB,QAAQ9J,KAAjC,QAA4Ck4B,EAAMpuB,QAAQxpB,QAMtDqrE,GAAU,SAACzzB,GAAD,OACrBwG,KAAM+a,SAAQ,kBAAM,eAAC,GAAD,gBAAgBvhB,MAEpC,CAACA,EAAMpuB,QAAQxpB,IAAK43C,EAAMpuB,QAAQ5L,GAAIg6B,EAAMpuB,QAAQ9J,KAAMk4B,EAAMjgB,OAAOuC,SAAS5L,UAAYspB,EAAMpuB,QAAQ5L,GACzGg6B,EAAMpuB,QAAQ1jB,KAAM8xC,EAAMpuB,QAAQ/iB,KAAMmxC,EAAMpuB,QAAQhB,gBACzD6iD,GAAQj0B,YAAc,U,yWChGhBwK,GAAQ4H,aAAY,CACxBC,QAAS,CACPC,QAAS,CAAEC,KAAM,WACjBC,UAAW,CAAED,KAAM,cAavB,SAAS2hB,GAAIC,EAAoBC,EAAoBloE,EACnDmoE,EAAqBC,EAAqB/hE,GAC1C,IAAMgiE,EAAY,CAChB5Y,OAAO,EACPzX,QAAQ,EACR4O,OAAO,QAGH0hB,EAAkB,CACtB7Y,OAAO,EACPzX,QAAQ,EACR4O,OAAO,OACPhO,UAAWl6C,IAAiB,aAAe,YAU7C,OAAO,gBAAC6pE,GAAA,EAAD,WACL,eAACC,GAAA,EAAD,CAAWC,MAAM,QAAQj+C,MAAO69C,EAAhC,SAA4CJ,IAC5C,eAACO,GAAA,EAAD,CAAWC,MAAM,QAAQj+C,MAAO69C,EAAhC,SAA4CH,IAC5C,eAACM,GAAA,EAAD,CAAWC,MAAM,SAASj+C,MAAO89C,EAAjC,SAAmDtoE,IACnD,eAACwoE,GAAA,EAAD,CAAWh+C,MAAO69C,EAAlB,SAA8BF,IAC9B,eAACK,GAAA,EAAD,CAAWh+C,MAAO69C,EAAlB,SAA8BD,MALV/hE,G,IASlBqiE,G,WAOJ,WAAYp0B,GAA+B,yBAN3C3zB,YAM0C,OAL1CwE,YAK0C,OAJ1C6F,aAI0C,OAH1C3F,eAG0C,OAF1C7S,UAE0C,OAD1ChQ,UAC0C,EACxCkR,KAAK2jC,KAAK/C,G,wCAEZ,SAAKA,GACEA,EAAMpuB,UACXxS,KAAKiN,OAAS2zB,EAAMpuB,QAAQvF,OAC5BjN,KAAKyR,OAASmvB,EAAMpuB,QAAQf,OAC5BzR,KAAKlB,KAAO8hC,EAAMpuB,QAAQ1T,KAC1BkB,KAAKlR,KAAO8xC,EAAMpuB,QAAQ1jB,KAC1BkR,KAAKsX,QAAUspB,EAAMjgB,OAAOuC,SAAS5L,QACrCtX,KAAK2R,UAAYivB,EAAMpuB,QAAQb,a,qBAEjC,SAAQivB,GACDA,EAAMpuB,UACXouB,EAAMpuB,QAAQvF,OAASjN,KAAKiN,OAC5B2zB,EAAMpuB,QAAQf,OAASzR,KAAKyR,OAC5BmvB,EAAMpuB,QAAQ1T,KAAOkB,KAAKlB,KAC1B8hC,EAAMpuB,QAAQ1jB,KAAOkR,KAAKlR,KAC1B8xC,EAAMjgB,OAAOuC,SAASwX,WAAW16B,KAAKsX,SACtCtX,KAAK2R,UAAYivB,EAAMpuB,QAAQb,e,KAGtBsjD,GAAsD,SAACr0B,GAClE,IACMqJ,EADY7C,KAAMQ,OAAO,IAAIotB,GAAwBp0B,IAClC/I,QAEnB0M,EAAW,CAAC1E,SAAU70C,IAAiB,MAAQ,OAGrD,SAASkqE,EAAUl7C,EAAW/D,GACb,UAAXA,GAA+B,kBAATA,IACxBg0B,EAAOtG,KAAK/C,GACRA,EAAMpuB,SACRouB,EAAMqkB,cAAcrkB,EAAMpuB,UAG9BouB,EAAMrmB,QAER,IAAM8tB,EAAa,SAACruB,GACH,UAAXA,EAAGrnB,KACLuiE,EAAUl7C,EAAI,UAMhB,EAAwB4mB,EAAMjgB,OAAvBuC,EAAP,EAAOA,SAAUx1B,EAAjB,EAAiBA,IACXynE,EAHoB,SAAC,GAAD,EAAEnlC,QAAF,EAAWolC,cAAX,EAA0BnQ,cAA1B,EAAyC6B,WAAzC,EAAqDvsC,MAArD,0BAGiB86C,CAAoBz0B,GAEjE,OAAO,eAAC8H,GAAA,EAAD,2BAAS1Y,QAASklC,GAAeC,GAAjC,IAA+C9pB,YAAa,SAACrxB,GAClEA,EAAG2lB,mBADE,SAGL,eAAC,KAAD,UAAW,2BpExCwB3zC,EoEwCxB,OACT,gBAAC4zC,GAAA,EAAD,WACE,iCAAO,iCAAO,gCAAI,8BAClB4zB,GAAiB5yB,EAAMpuB,QAAUouB,EAAMpuB,QAAQ9J,KAAO,GAAIgwB,MACtD,8BACJ,eAACuP,GAAA,EAAD,CAAWlB,MAAOr0C,GAAE,UAAWukD,WAAW,EAAOtgC,MAAOiqB,EAAMpuB,QAAUouB,EAAMpuB,QAAQ1T,KAAO,GAC3F6mC,WAAY,CAAC1F,WAAU,EAAMnpB,MAAMytB,GACnCztB,MAAO,CAAC0tB,WAAW,GAAIn5C,MAAM,QAC7B+rD,gBAAiB,CAACtgC,MAAMytB,GACxBqB,SAAU,SAAArmB,GAEHqhB,EAAMpuB,UACXouB,EAAMpuB,QAAQ1T,KAAOygB,EAAMsmB,OAAOlvB,MAClCiqB,EAAMkmB,WAAWlmB,EAAMpuB,WAEzB61B,WAAYA,EAAYrH,WAAW,aAGrC,gBAAC,KAAD,CAAkB4J,MAAOA,GAAzB,UACA,gBAACtJ,GAAA,EAAD,CAAKC,GAAI,EAAGC,GAAI,EAAhB,UACE,gBAAC1B,GAAA,EAAD,CAAQC,QAAQ,YAAYjpB,MAAO,CAACkpB,cAAc,OAAQH,SAAS70C,IAAiB,MAAQ,OAC1Fm1C,QAAS,WACFS,EAAMpuB,UACXqF,GAAiB+oB,EAAMpuB,SACvBouB,EAAMkmB,WAAWlmB,EAAMpuB,WAJ3B,UAKK,eAAC,KAAD,CAAiBsE,MAAOytB,IAL7B,QAKkD7xC,GAAE,gBANtD,QAOE,gBAACotC,GAAA,EAAD,CAAQC,QAAQ,YAAYjpB,MAAO,CAACkpB,cAAc,OAAQH,SAAS70C,IAAiB,MAAQ,OAC1Fm1C,QAAS,WACFS,EAAMpuB,UACX2F,GAAoByoB,EAAMpuB,SAC1BouB,EAAMkmB,WAAWlmB,EAAMpuB,WAJ3B,UAKK,eAAC,KAAD,CAAgBsE,MAAOytB,IAL5B,QAKgD7xC,GAAE,mBAZpD,WAcA,gBAAC4uC,GAAA,EAAD,CAAKC,GAAI,EAAGC,GAAI,EAAhB,UACE,gBAAC1B,GAAA,EAAD,CAAQC,QAAQ,YAAYjpB,MAAO,CAACkpB,cAAc,OAAQH,SAAS70C,IAAiB,MAAQ,OAC1Fm1C,QAAS,WACFS,EAAMpuB,ShEsTlB,SAAgCxmB,GACrC,GAAe,SAAXA,EAAE0c,KAAgB,CACpB,IAAM4sD,EAAMnwD,KAAKI,MAAMvZ,EAAEhD,KAGzButB,GAFa++C,EAAI1sD,SAASpX,OACxB8jE,EAAI1sD,SAASlb,KAAI,SAAAmtB,GAAC,OAAIA,EAAExG,WAAShrB,QAAO,SAAC2zB,EAAM4K,GAAP,OAAe5K,EAAQA,EAAO,KAAQ,GAAK4K,KAAO,SAExF,GAAe,YAAX57B,EAAE0c,KAAmB,CAC7B,IACM6sD,EADQvpE,EAAEhD,IAAI4H,MAAM,KACHmsB,QAAO,SAAAvvB,GAC5B,IAAMmF,EAAMnF,EAAEoD,MAAM,KAAK,GAEzB,MAAe,MAAR+B,GAAuB,SAARA,KAElBygB,EAAQmiD,EAAS/jE,OAAS+jE,EAASlsE,QAAO,SAACC,EAAKs+B,GAAN,OAAet+B,EAAMA,EAAM,IAAM,IAAMs+B,KAAO,GAC9FrR,GAAS,iCAAD,OAAkCnD,QACvB,WAAXpnB,EAAE0c,KAGV6N,GADYc,IAAa,EADVK,GAAiB1rB,EAAEhD,OAIlCutB,GAASvqB,EAAEhD,KgEzUDwsE,CAAuB50B,EAAMpuB,UAHjC,UAIK,eAAC,QAAD,CAAMsE,MAAOytB,EAAU9Z,KAAMgrC,KAAenqE,OAAQotC,KAJzD,QAIgFhmC,GAAE,wBALpF,QAME,eAACotC,GAAA,EAAD,CAAQC,QAAQ,YAAYjpB,MAAO,CAACkpB,cAAc,OAAQH,SAAS70C,IAAiB,MAAQ,OAC1Fm1C,QAAS,WACFS,EAAMpuB,SACX9kB,EAAI02C,QAAQxD,EAAMpuB,UAHtB,SAIM9f,GAAE,gBAEV,eAACgjE,GAAA,EAAD,CAAOjmE,KAAK,QAAZ,SAAqB,eAACkmE,GAAA,EAAD,UAAY,CAO7BrB,GAAI,uBAAMx9C,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OAAhD,SAAyD0H,GAAE,eAAqB,eAAC,QAAD,CAAM+3B,KAAMmrC,KAAStqE,OAAQN,IAAkB0tC,GAAsBA,KAC1J,eAACm9B,GAAA,EAAD,CAAQ52D,MAAM,YAAY0qC,QAAO,UAAE/I,EAAMpuB,eAAR,aAAE,EAAeb,UAAWi0B,SAAU,SAAC5rB,EAAI2vB,GACrE/I,EAAMpuB,UACXouB,EAAMpuB,QAAQb,UAAYg4B,EAC1B/I,EAAMkmB,WAAWlmB,EAAMpuB,aACnB,eAAC,QAAD,CAAMiY,KAAMmrC,KAAStqE,OAAQN,IAAkB0tC,GAAsBA,KAAkB,uBAAM5hB,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OAAhD,SAAyD0H,GAAE,aAAoB,SAE7K,eAAC,YAAD,UAAsBqa,GAAkB6zB,EAAMpuB,SAC5C8hD,GAAIH,IAAc,EAAMvzB,EAAMpuB,SAAS,eAAC,KAAD,IACvC,eAACqjD,GAAA,EAAD,CAAQ52D,MAAM,YAAY0qC,SAAS,UAAA/I,EAAMpuB,eAAN,eAAe5L,MAAOsc,EAAS5L,QAASsuB,SAAU,SAAC5rB,EAAI2vB,GACnF/I,EAAMpuB,SACX0Q,EAASwX,WAAWiP,EAAU/I,EAAMpuB,QAAQ5L,GAAK,OAC7C,eAAC,KAAD,IAAcutD,IAAc,EAAOvzB,EAAMpuB,eAAY/R,GAL/C,QAMd,eAAC,YAAD,WpEzG6BzU,EoEyGgB40C,EAAMpuB,QpExGpDxmB,GAAiB,WAAXA,EAAE0c,MAAgC,WAAX1c,EAAE0c,KoEyG5B4rD,GAAI,uBAAMx9C,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OAAhD,SAAyD0H,GAAE,mBAA0B,eAAC,QAAD,CAAM+3B,KAAMqrC,KAAWxqE,OAAQN,IAAkB0tC,GAAsBA,KAChK,eAACm9B,GAAA,EAAD,CAAQ52D,MAAM,YAAY0qC,QAAS38B,GAAmB4zB,EAAMpuB,SAAUozB,SAAU,SAAC5rB,EAAI2vB,GAC9E/I,EAAMpuB,WhEwalB,SAA8BxmB,EAAqB+pE,GAExD,GAAIA,EAAK,CACP,IAAI9oD,EAASJ,IAAYlhB,KAAKgG,MAAM0X,KAAKC,MAAQsD,IAAyB5gB,EAAEihB,QACxEA,EAAS,IACXA,EAASjhB,EAAEihB,OAASJ,IAEtB7gB,EAAEihB,OAASA,OAEXjhB,EAAEihB,OAASjhB,EAAEihB,OAASJ,GgEhbZmpD,CAAqBp1B,EAAMpuB,QAASm3B,GACpC/I,EAAMkmB,WAAWlmB,EAAMpuB,aACnB,eAAC,QAAD,CAAMiY,KAAMwrC,KAAoB3qE,OAAQN,IAAkB0tC,GAAoBA,KAAiB,uBAAM5hB,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OAAhD,SAAyD0H,GAAE,uBAA0B+N,IAN9K,QAOd,eAAC,YAAD,UACE6zD,GAAI,uBAAMx9C,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OAAhD,SAAyD0H,GAAE,oBAA2B,eAAC,QAAD,CAAM+3B,KAAMmrC,KAAStqE,OAAQN,IAAkB0tC,GAAsBA,KAC/J,eAACm9B,GAAA,EAAD,CAAQ52D,MAAM,YAAY0qC,UAAS,UAAA/I,EAAMpuB,eAAN,UAAeH,SAAwBuzB,SAAU,SAAC5rB,EAAI2vB,GAClF/I,EAAMpuB,UACXouB,EAAMpuB,QAAQH,UAAUs3B,QAAiBlpC,EACzCmgC,EAAMkmB,WAAWlmB,EAAMpuB,aACnB,eAAC,QAAD,CAAMiY,KAAMyrC,KAAgB5qE,OAAQN,IAAkB0tC,GAAsBA,KAAiB,uBAAM5hB,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OAAhD,SAAyD0H,GAAE,wBANlJ,WAOd,eAAC,YAAD,UAC0B,SAAxB,UAAAkuC,EAAMpuB,eAAN,eAAe9J,MACf4rD,GAAI,uBAAMx9C,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OAAhD,SAAyD0H,GAAE,oBAA2B,eAAC,QAAD,CAAM+3B,KAAMqrC,KAAWxqE,OAAQN,IAAkB0tC,GAAsBA,KAC/J,eAACm9B,GAAA,EAAD,CAAQ52D,MAAM,YAAY0qC,aAA+BlpC,KAAtB,UAAAmgC,EAAMpuB,eAAN,eAAewmB,MAAkB4M,SAAU,SAAC5rB,EAAI2vB,GAC5E/I,EAAMpuB,UACXouB,EAAMpuB,QAAQwmB,KAAO2Q,EAAW/I,EAAMpuB,QAAQwmB,KAAO4H,EAAMpuB,QAAQwmB,KAAO,YAAUv4B,EACpFmgC,EAAMkmB,WAAWlmB,EAAMpuB,aACjB,eAAC,QAAD,CAAMiY,KAAM0rC,KAAW7qE,OAAQotC,KACvC,uCACIkI,EAAMpuB,QAAQwmB,KAAO,eAACyR,GAAA,EAAD,CAAYh7C,KAAM,QAAS0wC,QAAS,WACpDS,EAAMpuB,UACXouB,EAAMpuB,QAAQwmB,KAA8B,UAAvB4H,EAAMpuB,QAAQwmB,KAAmB,OAAS,QAC/D4H,EAAMkmB,WAAWlmB,EAAMpuB,WAHF,SAIrB,eAAC,QAAD,CAAMiY,KAA2B,UAArBmW,EAAMpuB,QAAQwmB,KAAiBo9B,KAAaC,KAAU/qE,OAAQN,IAAkB0tC,GAAsBA,YACpGj4B,EACQ,UAAvBmgC,EAAMpuB,QAAQwmB,KAAmB,uBAAMliB,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OAAhD,SAAyD0H,GAAE,uBAA+B,uBAAMokB,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OAAhD,SAAyD0H,GAAE,8BAClL+N,GAhBG,QAiBd,eAAC,YAAD,UACE6zD,GAAI,uBAAMx9C,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OAAhD,SAAyD0H,GAAE,mBAA0B,eAAC,QAAD,CAAM+3B,KAAM6rC,KAAoBhrE,OAAQN,IAAkB0tC,GAAsBA,KACzK,eAAC2N,GAAA,EAAD,CAAQpnC,MAAM,YAAY0X,WAAgClW,KAAzB,UAAAmgC,EAAMpuB,eAAN,eAAeF,SAAsB,IAA6B,IAAtBsuB,EAAMpuB,QAAQF,QACzFuM,IAAK,EAAGnK,IAAK,IAEboC,MAAO,CAACzrB,MAAML,IAAiB,MAAQ,MAAOw5C,WAAWx5C,IAAiB,MAAQ,QAAS6/C,YAAY7/C,IAAiB,MAAQ,QAASk6C,UAAUl6C,IAAiB,WAAa,WACjL46C,SAAU,SAAC5rB,EAAIrD,GACRiqB,EAAMpuB,UACXouB,EAAMpuB,QAAQF,QAAoB,MAAVqE,OAAiBlW,EAAakW,EAAmB,IACzEiqB,EAAMkmB,WAAWlmB,EAAMpuB,aACpB,eAAC,QAAD,CAAMiY,KAAM8rC,KAAkBjrE,OAAQN,IAAkB0tC,GAAsBA,KAAiB,uBAAM5hB,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OAAhD,SAAyD0H,GAAE,gBAVrJ,gBAYhB,gBAAC4uC,GAAA,EAAD,CAAKC,GAAI,EAAGC,GAAI,EAAhB,UACE,eAAC1B,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAM,UAAU6X,MAAO,CAACkpB,cAAc,OAAQH,SAAS70C,IAAiB,MAAQ,OAC1Gm1C,QAAS,WACP+0B,EAAU,EAAI,UAFlB,SAGMxiE,GAAE,YACR,eAACotC,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAM,YAAY6X,MAAO,CAACkpB,cAAc,OAAQwE,WAAW,GAAI3E,SAAS70C,IAAiB,MAAQ,OAC3Hm1C,QAAS,WACFS,EAAMpuB,UACXy3B,EAAOusB,QAAQ51B,GACfA,EAAMkmB,WAAWlmB,EAAMpuB,WAJ3B,SAKM9f,GAAE,cACR,gBAACotC,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAM,YAAY6X,MAAO,CAACkpB,cAAc,OAAQwE,WAAW,GAAI3E,SAAS70C,IAAiB,MAAQ,OAE3Hm1C,QAAS,SAACnmB,GACR4mB,EAAM5Q,QAAQhW,IAHlB,UAIK,eAAC,KAAD,IAJL,SAIkCtnB,GAAE,eAftC,4B,+BCrQO,4pB,6GCoBF+jE,GAAgD,SAAC71B,GAC5D,IAAM9kB,EAAO8kB,EAAM9kB,KACbgB,EAAU8jB,EAAM9jB,QACtB,OAAO,uCACA,OAAJhB,QAAI,IAAJA,KAAMuC,KAAO,4CAAcvC,EAAKuC,aAAc5d,EAC1C,OAAJqb,QAAI,IAAJA,KAAM0C,aAAe,8CAAW1C,EAAK0C,qBAAsB/d,EAC5D,6CAAa,OAAJqb,QAAI,IAAJA,OAAA,EAAAA,EAAMiC,iBAAkB,GAAG,KAAM24C,QAAQ,GAAlD,kBACU,OAAJ56C,QAAI,IAAJA,OAAA,EAAAA,EAAMgC,qBAAsB,GAAG,KAAM44C,QAAQ,GADnD,aAEmBj2D,KAAZ,OAAJqb,QAAI,IAAJA,OAAA,EAAAA,EAAM8C,SAAsB,kDAAW9C,EAAK8C,QAAQ83C,QAAQ,GAAhC,gBAAgDj2D,EACxE,OAAJqb,QAAI,IAAJA,KAAM0B,cAAgB,+CAA2B,IAAnB1B,EAAK0B,eAAoBk5C,QAAQ,GAAzC,iBAA0Dj2D,OAC3DA,KAAjB,OAAJqb,QAAI,IAAJA,OAAA,EAAAA,EAAMyB,cAA2B,gDAA4B,KAAf,OAAJzB,QAAI,IAAJA,OAAA,EAAAA,EAAMyB,eAAkBm5C,QAAQ,GAAzC,YAAmDj2D,KAEvF,4CATK,OAUJqc,QAVI,IAUJA,OAVI,EAUJA,EAASpvB,KAAI,SAAAF,GACZ,OAAO,wCACI,SAARA,EAAE6tB,IAAe,SAAM,SACvB7tB,EAAE6vB,OAAS,uCAAG7vB,EAAE6vB,MAAL,YACT7vB,EAAE2vB,YAAc3vB,EAAE2vB,YAAc,GAAG,KAAMu5C,QAAQ,GAH/C,IAIJlpE,EAAEgwB,cAAgB,oDAA+B,IAAhBhwB,EAAEgwB,eAAoBk5C,QAAQ,GAA7C,aAAwDj2D,OACzDA,IAAjBjT,EAAE+vB,aAA2B,qDAA+B,IAAf/vB,EAAE+vB,cAAkBm5C,QAAQ,GAA5C,YAAsDj2D,OACxEA,IAAXjT,EAAEkwB,OAAqB,uDAA2B,IAATlwB,EAAEkwB,QAAag5C,QAAQ,GAAzC,aAAoDj2D,IAN7DjT,EAAEoZ,WAmBZ+vD,GACT,SAAC/1B,GACH,IAAOluC,EAAKI,KAALJ,EACDopB,EAAO4qB,cAAqC,kBAAM9F,EAAM9kB,KAAN,gBAAiB8kB,EAAM9kB,WAAQrb,KAEvF,OAAO,gBAACioC,GAAA,EAAD,CAASh1B,KAAMktB,EAAMltB,KAAMi1B,SAAU/H,EAAM+H,SAA3C,UACL,eAACzH,GAAA,EAAD,UACGxuC,EAAE,sBAEL,gBAACktC,GAAA,EAAD,WACE,eAAC,GAAD,CAAgB9jB,KAAMA,EAAMgB,QAAO,OAAEhB,QAAF,IAAEA,OAAF,EAAEA,EAAMgB,UAC3C,eAACgjB,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAM,UAAU6X,MAAO,CAACkpB,cAAc,OAAQkI,UAAU,SAClF/H,QAAS,SAACnmB,GACRA,EAAG2lB,kBACCiB,EAAM5Q,SAAS4Q,EAAM5Q,WAH7B,SAKIt9B,EAAE,gBAGR,4BASSkkE,GAA+C,SAACh2B,GAC3D,IAAIi2B,OAAqCp2D,EACnCme,EAAUgiB,EAAMhiB,QAatB,YAZgBne,IAAZme,IACFi4C,EAAc,eAAC,KAAD,CAAwBntB,UAAW9I,EAAM8I,UAAW5yB,MAAO,CAAC7X,MAAM,SAC7E2f,EAAU,KAAMi4C,EACjB,eAAC,KAAD,CAAwBntB,UAAW9I,EAAM8I,UAAW5yB,MAAO,CAAC7X,MAAM,aACjE2f,EAAU,KAAMi4C,EACjB,eAAC,KAAD,CAAwBntB,UAAW9I,EAAM8I,UAAW5yB,MAAO,CAAC7X,MAAM,WACjE2f,EAAU,KAAMi4C,EACjB,eAAC,KAAD,CAAwBntB,UAAW9I,EAAM8I,UAAW5yB,MAAO,CAAC7X,MAAM,aACjE2f,EAAU,KAAMi4C,EACjB,eAAC,KAAD,CAAwBntB,UAAW9I,EAAM8I,UAAW5yB,MAAO,CAAC7X,MAAM,aAG/D,qCAAG43D,KASCC,GAA0D,SAACl2B,GAAoC,IAAD,EACzG,EAAwBwG,KAAMtF,UAAS,GAAvC,mBAAOpuB,EAAP,KAAaqjD,EAAb,KAEMl2D,EAAMumC,KAAMQ,OAA0B,MAE5C,OAAO,gBAAC6C,GAAA,EAAD,CAAY5pC,IAAKA,EAAKs/B,QAAS,WAAM42B,GAAQ,IAA7C,UACL,eAAC,GAAD,CAAmBn4C,QAAO,UAAEgiB,EAAM9kB,YAAR,aAAE,EAAY8C,UACxC,eAAC,GAAD,CAAyB9C,KAAM8kB,EAAM9kB,KAAMpI,KAAMA,EAC/Ci1B,SAAU9nC,EAAIg3B,QAAS7H,QAAS,WAC9B+mC,GAAQ,U,aC9FVnsB,GAAQ4H,aAAY,CACxBC,QAAS,CACPC,QAAS,CAAEC,KAAM,WACjBC,UAAW,CAAED,KAAM,cAYjBtO,GAAW,CAACxE,SAAU70C,IAAiB,MAAQ,MACrDM,OAAQN,IAAiB,MAAQ,SAC3BgsE,GAAa,CAAC1rE,OAAQN,IAAiB,MAAQ,OAC/Cu5C,GAAW,CAAC1E,UAAU70C,IAAiB,QACvCisE,GAAS,CAACp3B,SAAU70C,IAAiB,SAAW,QAEzCksE,GAA4D,SAACt2B,GACxE,MAA4BA,EAAMjgB,OAA3B1Z,EAAP,EAAOA,aAAcvZ,EAArB,EAAqBA,IACf2Z,EAAQJ,EAAaI,MAC3B,EAAwBy6B,sBAAxB,mBAAO/yB,EAAP,KAAaooD,EAAb,KACA,EAA8Cr1B,qBAAS,GAAvD,mBAAO2F,EAAP,KAAwBC,EAAxB,KACA,EAAsD5F,qBAAS,GAA/D,mBAAOs1B,EAAP,KAA4BC,EAA5B,KACO3kE,EAAKI,KAALJ,EAEP,SAAS4kE,EAAYt9C,EAAW/D,GACf,UAAXA,GAA+B,kBAATA,IACxB5O,EAAM2hB,kBACN3hB,EAAMu8B,0BAAyB,IAEjChD,EAAMrmB,QAIR,IAAM8tB,EAAa,SAACruB,GACH,UAAXA,EAAGrnB,IACL2kE,EAAYt9C,EAAI,SACG,QAAXA,EAAGrnB,KAA4B,WAAXqnB,EAAGrnB,KAC/B0U,EAAM7E,8BAGV,SAAS+0D,EAAev9C,GACtBA,EAAG0lB,iBACHy3B,EAAQ,MACR9vD,EAAMvF,YAAY9C,UAAY,GAEhC,SAASw4D,EAAgBx9C,GACvBA,EAAG0lB,iBACC3wB,GACF+B,GAAc/B,GAAMzK,MAAK,SAACtb,GACxBqe,EAAMvF,YAAY9C,UAAYhW,KAKpC,IAAM6+C,EAAcT,KAAMQ,OAA0B,MAC9C6vB,EAAkBrwB,KAAMQ,OAA0B,MACvCutB,GAAgBv0B,EAA1BrmB,MAAP,aAAiCqmB,EAAjC,KAEA,OAAO,gBAAC8H,GAAA,EAAD,6BAAaysB,GAAb,IAA2BnlC,QAASsnC,EAApC,UACL,gBAACp2B,GAAA,EAAD,WACE,uBAAOpqB,MAAO,CAAC+oB,SAAU70C,IAAiB,QAAU,OAApD,SACG0H,EAAE,aAEL,uBAAMokB,MAAO,CAAC2oC,MAAM,SAApB,SACE,eAAC,GAAD,CAAqB/rC,KAAMktB,EAAMltB,KAAMoI,KAAM+G,GAAW60C,yBAE5D,gBAAC93B,GAAA,EAAD,WACE,eAAC,KAAD,UAAY,WACV,IAAM/tC,EAAMwV,EAAMswD,cACZC,EAAUvwD,EAAM2mC,kBAChB17C,EAAYR,EAAYD,GAAO,QAAU,QACzC+xD,EAAY9xD,EAAY8lE,GAAW,YAAc,OAGvD,OAAQ,uCACN,eAAC3vB,GAAA,EAAD,CAAWlB,MAAOr0C,EAAE,YAAaukD,WAAW,EAAOtgC,MAAOtP,EAAMvF,YAAYhD,KAAMgY,MAAOkgD,GACvFrxB,WAAY,CAAC7uB,MAAOutB,GAAUpE,WAAU,GAAOmX,gBAAiB,CAACtgC,MAAOytB,IACxEqB,SAAU,SAAArmB,GAAUlY,EAAMvF,YAAYhD,KAAOygB,EAAMsmB,OAAOlvB,OAC1D0xB,WAAYA,EAAYrH,WAAW,IAErC,gBAACM,GAAA,EAAD,CAAKC,GAAI,EAAT,UACE,sBAAKzqB,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,IAA/C,SAAqD0H,EAAE,aACvD,gBAAC4uC,GAAA,EAAD,CAAKG,GAAI,EAAT,UACE,eAAC3B,GAAA,EAAD,CAAQC,QAAQ,YACdjpB,MAAO,CAACoR,gBAAgBl2B,EAAUH,GAAMoN,MAAM3M,EAAW0tC,cAAc,OAAQH,SAAS70C,IAAiB,MAAQ,OACjHm1C,QAAS,WAAKuH,GAAmB,IAAQ7mC,IAAKgnC,EAFhD,SAGGn1C,EAAE,mBACL,eAACg2C,GAAA,EAAD,CAASh1B,KAAM+zB,EAAiBzX,QAAS,WAAK0X,GAAmB,IAC/DiB,SAAUd,EAAYhQ,QAAS+Q,aAAc,CAACC,SAAS,SAAUC,WAAW,SAD9E,SAEE,eAAC,KAAD,CAAc7pC,MAAS,CAAC5M,EAAER,EAAI,GAAII,EAAEJ,EAAI,GAAIlH,EAAEkH,EAAI,IAAKk3C,cAAY,EACjEnD,SAAU,SAAC3mC,EAAOsgB,GAChBA,EAAMmgB,iBACNr4B,EAAMvF,YAAY7C,MAAQ,CAACA,EAAMpN,IAAIQ,EAAG4M,EAAMpN,IAAII,EAAGgN,EAAMpN,IAAIlH,QAIrE,eAACm1C,GAAA,EAAD,CAAQC,QAAQ,YACdjpB,MAAO,CAAC7X,MAAMjN,EAAU4lE,GAAU1vC,gBAAgB07B,EAAWpf,WAAW,GAAIxE,cAAc,OAAQH,SAAS70C,IAAiB,MAAQ,OACpIm1C,QAAS,WAAKk3B,GAAuB,IAAQx2D,IAAK42D,EAFpD,SAGG/kE,EAAE,iBACL,eAACg2C,GAAA,EAAD,CAASh1B,KAAM0jD,EAAqBxuB,aAAc,CAACC,SAAS,SAAUC,WAAW,SAC/E9Y,QAAS,WAAKqnC,GAAuB,IAAS1uB,SAAU8uB,EAAgB5/B,QAD1E,SAEE,eAAC,KAAD,CAAc54B,MAAS,CAAC5M,EAAEulE,EAAQ,GAAI3lE,EAAE2lE,EAAQ,GAAIjtE,EAAEitE,EAAQ,IAC5DhyB,SAAU,SAAC3mC,EAAOsgB,GAChBA,EAAMmgB,iBACNr4B,EAAMvF,YAAYxP,UAAY,CAAC2M,EAAMpN,IAAIQ,EAAG4M,EAAMpN,IAAII,EAAGgN,EAAMpN,IAAIlH,QAIzE,eAACm1C,GAAA,EAAD,CAAQC,QAAQ,YAAYjpB,MAAO,CAAC0tB,WAAW,GAAIxE,cAAc,OAAQH,SAAS70C,IAAiB,MAAQ,OACzGm1C,QAAS,WAAK94B,EAAMvF,YAAY7C,MAAM,GAAIoI,EAAMvF,YAAYxP,UAAU,IADxE,SAEGI,EAAE,uBAGT,gBAAC4uC,GAAA,EAAD,CAAKC,GAAI,EAAT,UACE,sBAAKzqB,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OAA/C,SAAwD0H,EAAE,aAC1D,gBAAC4uC,GAAA,EAAD,CAAKC,IAAK,EAAGE,GAAI,EAAjB,UACE,wBAAwBo2B,SAAYL,EAClC1gD,MAAO,CAAC4sC,WAAW,MAAO7jB,SAAU70C,IAAiB,QAAU,OADjE,UAEE,sBAAK8rB,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,GAAIk9C,UAAU,GAA7D,SAAkEx1C,EAAE,iBACnE2U,EAAMvF,YAAY9C,UAAY,uCAC7B,sBAAKyE,IAAK4D,EAAMvF,YAAY9C,UAAW8X,MAAO,CAACxrB,OAAO,QAAS0hD,cAAc,UAAW1H,IAAI,WAC5F,wBAAOxuB,MAAOmgD,GAAQvuD,KAAK,SAASy3B,QAASo3B,EAAgB5gD,MAAM,WAFtC,gBAGzBlW,EACN,wBAAOqW,MAAOmgD,GAAQvuD,KAAK,OAAOk9B,SAAU,SAAC5rB,GAAQ,IAAD,EAClDm9C,EAAO,UAACn9C,EAAG6rB,OAAO32B,aAAX,aAAC,EAAiBy9B,KAAK,OAEhC,wBAAO71B,MAAOmgD,GAAQvuD,KAAK,SAASiO,MAAM,aAVlC,eAYV,eAACsxB,GAAA,EAAD,CAAWlB,MAAOr0C,EAAE,WAAYukD,WAAW,EAAOtgC,MAAOtP,EAAMvF,YAAY/C,MACzE+X,MAAK,6BAAMkgD,IAAN,IAAkB9uB,UAAU,IACjCvC,WAAY,CAAC7uB,MAAOutB,GAAUpE,WAAU,GAAOmX,gBAAiB,CAACtgC,MAAOytB,IACxEqB,SAAU,SAAArmB,GAAK,OAAIlY,EAAMvF,YAAY/C,MAAQwgB,EAAMsmB,OAAOlvB,OAC1D0xB,WAAYA,EAAYrH,WAAW,UAIzC,eAAC,KAAD,CAAkB4J,MAAOA,GAAzB,SACA,gBAACtJ,GAAA,EAAD,CAAKC,GAAI,EAAT,UACE,sBAAKzqB,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,IAA/C,SAAqD0H,EAAE,oBACvD,gBAAC4uC,GAAA,EAAD,CAAKC,GAAIv2C,IAAiB,GAAK,EAAGy2C,GAAIz2C,IAAiB,GAAK,EAAG8rB,MAAO,CAACouB,UAAUl6C,IAAiB,WAAa,YAA/G,UACA,eAAC67C,GAAA,EAAD,CAAkBC,QAChB,eAACyC,GAAA,EAAD,CAAUtqC,MAAM,YAAY6X,MAAO,CAAC+oB,SAAS70C,IAAiB,MAAQ,OAAQ2+C,QAAStiC,EAAMvF,YAAY1C,WACzGwmC,SAAU,SAAC5rB,GAAM3S,EAAMvF,YAAY1C,WAAa4a,EAAG6rB,OAAO8D,WACxD5C,MAAOr0C,EAAE,kBACb,eAACm0C,GAAA,EAAD,CAAkBC,QAChB,eAACyC,GAAA,EAAD,CAAUtqC,MAAM,YAAY0qC,QAAStiC,EAAMvF,YAAYzC,YACrDumC,SAAU,SAAC5rB,GAAM3S,EAAMvF,YAAYzC,YAAc2a,EAAG6rB,OAAO8D,WAC3D5C,MAAOr0C,EAAE,mBACb,eAACm0C,GAAA,EAAD,CAAkBC,QAChB,eAACyC,GAAA,EAAD,CAAUtqC,MAAM,YAAY0qC,QAAStiC,EAAMvF,YAAYxC,WACrDsmC,SAAU,SAAC5rB,GAAM3S,EAAMvF,YAAYxC,WAAa0a,EAAG6rB,OAAO8D,WAC1D5C,MAAOr0C,EAAE,kBACb,eAACm0C,GAAA,EAAD,CAAkBC,QAChB,eAACyC,GAAA,EAAD,CAAUtqC,MAAM,YAAY0qC,QAAStiC,EAAMvF,YAAYvC,WACrDqmC,SAAU,SAAC5rB,GAAM3S,EAAMvF,YAAYvC,WAAaya,EAAG6rB,OAAO8D,WAC1D5C,MAAOr0C,EAAE,gCAMnB,eAAC,KAAD,CAAkBk4C,MAAOA,GAAzB,SACA,gBAACtJ,GAAA,EAAD,CAAKC,GAAI,EAAGC,GAAI,EAAhB,UACE,eAAC1B,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAM,UAAU6X,MAAO,CAACkpB,cAAc,OAAQH,SAAS70C,IAAiB,MAAQ,OAC1Gm1C,QAAS,WACPm3B,EAAY,EAAI,UAFpB,SAGM5kE,EAAE,YACR,eAACotC,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAM,YAAY6X,MAAO,CAAC0tB,WAAW,GAAIxE,cAAc,OAAQH,SAAS70C,IAAiB,MAAQ,OAC3Hm1C,QAAS,WAAM94B,EAAM7E,8BADvB,SACuD9P,EAAE,cACzD,eAACotC,GAAA,EAAD,CAAQC,QAAQ,YAAYjpB,MAAO,CAAC0tB,WAAW,GAAIxE,cAAc,OAAQH,SAAS70C,IAAiB,MAAQ,OACzGm1C,QAAS,WACPzyC,EAAI02C,QAAQ/8B,IAFhB,SAGM3U,EAAE,0BClMVs2C,GAAYC,aAAW,CAC3BC,KAAM,SAACtI,GAAD,MAA+B,CACnCmE,QAAS,OACTmc,eAAgB,SAChBpU,WAAY,SACZzhD,MAAOu1C,EAAMnxC,KACbnE,OAAQs1C,EAAMnxC,KAEdqoE,SAAS,UAAD,OATG,IASUl3B,EAAMnxC,MAAQ,GAA3B,kBACR4nD,SAAU,WAEZ0gB,iBAAkB,SAACn3B,GAAD,MAA+B,CAC/Ct1C,OAAQ,OACR45C,UAAU,SAAD,OAAWtE,EAAMo3B,QAAU,EAAI,EAA/B,UAEXC,kBAAmB,SAACr3B,GAAD,MAA+B,CAChDv1C,MAAO,OACP65C,UAAU,SAAD,OAAWtE,EAAMo3B,QAAU,EAAI,EAA/B,YAoCN,IAAME,GAA4C,SAACt3B,GACxD,IAAMyI,EAAUL,GAAUpI,GACpBu3B,EAAWvwB,kBAAyB,MAY1C,OAVArI,sBACE,WAC4B,QAAd,OAAR44B,QAAQ,IAARA,OAAA,EAAAA,EAAUtgC,UA9BpB,SAAmBkY,EAAyBlqC,EAA+Boc,EACzEm2C,EAA+BC,GAC/B,GAAIxyD,EAASkqC,EAAMN,UAAY5pC,OAC1B,GAAIoc,GAAQA,EAAKxyB,KAAK,CACzB,IAAMzG,EAAME,IAAIm+B,gBAAgBpF,GAChC8tB,EAAMtsC,IAAMza,EAEd+mD,EAAMK,UAAW,EAEjBL,EAAMuoB,iBAAmB,WACvB,IAAMniD,EACG45B,EAAM1kD,MADT8qB,EAEI45B,EAAMzkD,YAGOmV,IAAnB0V,QAAoD1V,IAApB0V,EAClC45B,EAAMrG,UAAYvzB,GAAkBA,EAAkBiiD,EAAwBC,GAE9E5pD,QAAQI,MAAM,6CACdkhC,EAAMrG,UAAY0uB,IAYhBG,CAAUJ,EAAStgC,QAAS+I,EAAM/6B,OAAQ+6B,EAAM3e,KACtConB,EAAQ0uB,iBAAkB1uB,EAAQ4uB,qBAGhD,CAACE,EAAU9uB,EAAQ0uB,iBAAkB1uB,EAAQ4uB,kBAAmBr3B,EAAM/6B,OAAQ+6B,EAAM3e,OAG/E,sBAAKynB,UAAWL,EAAQH,KAAMpyB,MAAO8pB,EAAM9pB,MAA3C,SACL,wBAAOjW,IAAKs3D,EAAUrhD,MAAO8pB,EAAM9pB,WAIvCohD,GAAaM,aAAe,CAC1B/oE,KAAM,KAERyoE,GAAa93B,YAAc,e,qDCzEdq4B,GAAgD,SAAC73B,GAC5D,IACE9hC,EAME8hC,EANF9hC,KACAE,EAKE4hC,EALF5hC,UACAwJ,EAIEo4B,EAJFp4B,OAGGwwC,GACDpY,EAHF/6B,OAGE+6B,EAFF3e,KALF,aAOI2e,EAPJ,KAUE,OAAO,eAAC,GAAD,cAAa9hC,KAAMA,EAAM0J,OAAQA,EACxCxJ,UAAWA,GAAeg6C,KAK9Byf,GAAer4B,YAAc,iBCT7B,IAAMs4B,GAAkD,SAAC93B,GACvD,IAAM74B,EAAc64B,EAAM74B,YAG1B,OAAO,eAAC,KAAD,UAAW,WAChB,IAAMS,EAAST,EAAYqB,WAC3B,EAA0BrB,EAAYjG,YAChC6d,EAAO,CAACnX,SAAQxJ,UADtB,EAAOA,UAC0BF,KADjC,EAAkBA,MAGlB,OAAO,eAAC,GAAD,6BAAoB6gB,GAApB,IACL9Z,QAAQkC,EAAY4wD,WAAe5wD,aAAuBpB,QACtBlG,EAAlCsH,EAAYG,OAAOsd,aACrBvD,KAAMla,EAAY4wD,WAAc5wD,aAAuBpB,GACrDoB,EAAYmf,eAAWzmB,EACzB+H,OAAQA,EAAQ/Y,KAAMmxC,EAAMnxC,KAAMqnB,MAAO,CAACi0B,cAAc,QACxDitB,OAAQp3B,EAAM/+B,eAKP+2D,GAAe,SAACh4B,GAAD,aAC1BwG,KAAM+a,SAAQ,kBAAM,eAAC,GAAD,gBAAqBvhB,MAEzC,CAACA,EAAMnxC,KACLmxC,EAAM74B,YAAYjG,YAAY9C,UAC9B4hC,EAAM74B,YAAYjG,YAAY7C,MAC9B2hC,EAAM74B,YAAYjG,YAAYhD,KAC9B8hC,EAAM74B,YAAYjG,YAAYxP,UAJhC,UAMGsuC,EAAM74B,YAAkCG,cAN3C,aAME,EAAiDhH,UAErD03D,GAAax4B,YAAc,kB,8GClCrBy4B,G,mKACJ,SACE7vE,EACA8vE,GACC,IAAD,OACA,OAAO,IAAI5nE,SAAc,SAACC,EAASC,GACjC,wDAAWpI,EAAKmI,EAAS2nE,EAAY1nE,U,GANX2nE,MAkB1BtpE,GAAO,CAAC,IAAI,KAGLupE,GAAqD,SAACp4B,GACjE,IAAM//B,EAAMumC,KAAMQ,OAA0B,MACtCqxB,EAAY7xB,KAAMQ,OAAoB,MAuF5C,OArFAR,KAAM7H,WAAU,WACd,GAAK1+B,EAAIg3B,QAAT,CACAohC,EAAUphC,QAAU,CAClBqhC,MAAM,IAAIC,KACVC,SAAW,IAAID,MAAoB,CACjCE,WAAW,EACX5mE,OAAO,EACPiqC,OAAQ77B,EAAIg3B,UAEd6hB,OAAQ,IAAIyf,KACV,GACA1pE,GAAK,GAAGA,GAAK,GACb,GACA,KAEF6pE,MAAO,IAAIH,OAEb,IAAMI,EAAMN,EAAUphC,QACtB0hC,EAAIH,SAASI,QAAQ/pE,GAAK,GAAIA,GAAK,IACnC8pE,EAAIH,SAASK,cAAwC,EAA1B1vE,OAAO2vE,kBAElC,IAAMC,EAAQ,IAAIR,KAAuB,UACzCQ,EAAMhrE,SAAS6Y,IAAI,EAAG,EAAG,GAAGoyD,YAC5BL,EAAID,MAAMt2C,IAAI22C,GAgBd,IAAME,EAAS,IAAIhB,GACbiB,EAA6B,GAGnCA,EAAM/wD,KAAKzF,cAAQ,WACjB,IAAMi2D,EAAMN,EAAUphC,QACtBgiC,EAAOE,YACHn5B,EAAM74B,YAAYjG,YAAY9C,WAChCsF,MAAK,SAAA01D,GACQ,IAAD,EAART,EAAI/1D,MACN,UAAA+1D,EAAID,aAAJ,SAAW1rB,OAAO2rB,EAAI/1D,IAAI81D,QAE5BW,KAASC,wBAAwBF,EAAKV,OACtCa,KAAIzwD,KAAKswD,GAAM11D,MAAK,SAAA81D,GAAW,IAAD,EAC5B,UAAAb,EAAID,aAAJ,SAAWt2C,IAAIo3C,EAAOd,OACtBc,EAAOd,MAAMe,SAASxrB,EAAIljD,KAAKsC,GAC3BsrE,IACFA,EAAI/1D,IAAM42D,EACVE,EAAS15B,EAAM74B,YAAYjZ,KAAKP,YAAaqyC,EAAM74B,YAAY0f,gBAGlEljB,OAAM,SAACrX,GACRuhB,QAAQC,IAAI,qBAAsBxhB,UAKtC,IAAMotE,EAAW1U,qBAAS,SAAC2U,EAAKrwC,GAC9B,UAAIqvC,QAAJ,IAAIA,KAAK/1D,IAAK,CAAC,IAAD,OAkIpB,SAAqBA,EAASg3D,GAAe,IAAD,EAC1C,IAAKh3D,EAAK,OACV,IAAKg3D,EAGH,OAFAC,GAAYj3D,EAAK,gBAAiB,IAAIk3D,KAAM,EAAE,GAAG/uE,KAAKsC,GAAG,EAAE,IAAM,EAAG,QACpEwsE,GAAYj3D,EAAK,eAAgB,IAAIk3D,KAAM,EAAE,EAAE/uE,KAAKsC,GAAG,EAAE,IAAM,EAAG,GAIhEusE,EAAKltB,MA/CX,SAAiB9pC,EAASm3D,GAA4B,IAAD,IACjD,IAAIn3D,EAAK,OACT,IAAMo3D,EAAM,CAAChsB,EAAE+rB,EAAWjtD,KAAKkhC,EAAE,GAAKC,EAAE8rB,EAAWjtD,KAAKmhC,EAAGgsB,EAAEF,EAAWjtD,KAAKmtD,GAC7EJ,GAAYj3D,EAAK,OAAQo3D,EAAK,IAG9B,IAAME,EAAat3D,EAAIu3D,gBACjBC,EAAaC,KAAUC,qBAKvBC,EAAOC,GAAM,EAAET,EAAWU,IAAI7vC,EAAG,EAAG,GACpC8vC,EAAOF,GAAM,EAAET,EAAWU,IAAIhpE,EAAG,EAAG,GAE1CyoE,EAAWv0B,SAASy0B,EAAWO,OAAQJ,GACvCL,EAAWv0B,SAASy0B,EAAWQ,OAAQF,GAGvCR,EAAWv0B,SAASy0B,EAAWS,EAAGC,GAAKf,EAAWgB,MAAMC,MAAMH,EAAEX,EAAWe,SAASb,EAAWS,GAAK,KACpGX,EAAWv0B,SAASy0B,EAAWc,EAAGJ,GAAKf,EAAWgB,MAAMC,MAAME,EAAEhB,EAAWe,SAASb,EAAWc,GAAK,KACpGhB,EAAWv0B,SAASy0B,EAAWe,EAAGL,GAAKf,EAAWgB,MAAMC,MAAMG,EAAEjB,EAAWe,SAASb,EAAWe,GAAK,KACpGjB,EAAWv0B,SAASy0B,EAAWgB,EAAGN,GAAKf,EAAWgB,MAAMC,MAAMI,EAAElB,EAAWe,SAASb,EAAWgB,GAAK,KACpGlB,EAAWv0B,SAASy0B,EAAWiB,EAAGP,GAAKf,EAAWgB,MAAMC,MAAMK,EAAEnB,EAAWe,SAASb,EAAWiB,GAAK,KAIpG,IAAIC,EACF,IAAI/C,KACFuC,GAAKS,GAAcvtB,EAAI+rB,EAAWyB,MAAMvtB,EAAG,IAC3C6sB,GAAKS,GAActtB,EAAG8rB,EAAWyB,MAAMxtB,EAAG,IAC1C,EACA,OAEJutB,GAAcE,KAAKH,GACnB,UAAA14D,EAAI84D,cAAJ,mBAAYC,eAAZ,SAAqBD,OAAOJ,GAYfM,CAAQh5D,EAAKg3D,EAAKltB,MAGjC,GAAIktB,EAAK1rE,KACP2rE,GAAYj3D,EAAK,OAAQg3D,EAAK1rE,KAAK2tE,KAAKpC,SAAU,IAYlDI,GAAYj3D,EAAK,QAASg3D,EAAK1rE,KAAK4tE,MAAO,IAAM,IACjDjC,GAAYj3D,EAAK,QAASg3D,EAAK1rE,KAAK4tE,MAAO,IAAM,IAEjDjC,GAAYj3D,EAAK,gBAAiBg3D,EAAK1rE,KAAK6tE,cAAe,EAAG,IAC9DlC,GAAYj3D,EAAK,gBAAiBg3D,EAAK1rE,KAAK8tE,cAAe,EAAG,IAC9DnC,GAAYj3D,EAAK,eAAgBg3D,EAAK1rE,KAAK+tE,aAAc,EAAG,IAC5DpC,GAAYj3D,EAAK,eAAgBg3D,EAAK1rE,KAAKguE,aAAc,EAAG,IAE5DrC,GAAYj3D,EAAK,eAAgBg3D,EAAK1rE,KAAKiuE,aAAc,EAAG,IAC5DtC,GAAYj3D,EAAK,eAAgBg3D,EAAK1rE,KAAKkuE,aAAc,EAAG,IAC5DvC,GAAYj3D,EAAK,gBAAiBg3D,EAAK1rE,KAAKmuE,cAAe,EAAG,IAC9DxC,GAAYj3D,EAAK,gBAAiBg3D,EAAK1rE,KAAKouE,cAAe,EAAG,SAE9D,GAAI1C,EAAKltB,KAAK,CAEZ,IAAMstB,EAAM,CAAChsB,EAAE4rB,EAAKltB,KAAK5/B,KAAKkhC,EAAE,EAAE,GAAKC,EAAE2rB,EAAKltB,KAAK5/B,KAAKmhC,EAAE,EAAGgsB,EAAEL,EAAKltB,KAAK5/B,KAAKmtD,EAAE,GAChFJ,GAAYj3D,EAAK,QAASo3D,EAAK,IAAM,IACrCH,GAAYj3D,EAAK,QAASo3D,EAAK,IAAM,IACrCH,GAAYj3D,EAAK,gBAAiB,CAACorC,GAAGgsB,EAAIhsB,EAAE,EAAE,GAAKC,GAAG+rB,EAAI/rB,EAAE,EAAGgsB,GAAID,EAAIC,EAAE,EAAElvE,KAAKsC,GAAG,EAAE,IAAM,EAAG,GAC9FwsE,GAAYj3D,EAAK,eAAgB,CAACorC,GAAGgsB,EAAIhsB,EAAE,EAAE,GAAKC,GAAG+rB,EAAI/rB,EAAE,EAAGgsB,GAAID,EAAIC,EAAE,EAAElvE,KAAKsC,GAAG,EAAE,IAAM,EAAG,GAC7FwsE,GAAYj3D,EAAK,gBAAiB,IAAIk3D,KAAM,EAAE,KAAK,IAAM,EAAG,GAC5DD,GAAYj3D,EAAK,eAAgB,IAAIk3D,KAAM,GAAG,IAAI,IAAM,EAAG,GAC3DD,GAAYj3D,EAAK,YAAa,IAAIk3D,MAAO,GAAI,IAAK,IAAM,EAAG,GAC3DD,GAAYj3D,EAAK,WAAY,IAAIk3D,MAAO,IAAK,GAAI,IAAM,EAAG,GAK1DF,EAAK1rE,MAAQ0rE,EAAK2C,UACpB1C,GAAYj3D,EAAK,WAAY,CAE3Bq3D,EAAGL,EAAK1rE,KAAKsuE,SAASvC,EACtBhsB,EAAG2rB,EAAK2C,SAASE,UAAUxuB,EAC3BD,EAAG4rB,EAAK2C,SAASE,UAAUzuB,IAG/B,OAAI4rB,QAAJ,IAAIA,KAAM2C,WACR1C,GAAYj3D,EAAK,mBAAoBg3D,EAAK2C,SAASG,kBACnD7C,GAAYj3D,EAAK,uBAAwBg3D,EAAK2C,SAASI,sBACvD9C,GAAYj3D,EAAK,iBAAkBg3D,EAAK2C,SAASK,gBACjD/C,GAAYj3D,EAAK,oBAAqBg3D,EAAK2C,SAASM,mBACpDhD,GAAYj3D,EAAK,wBAAyBg3D,EAAK2C,SAASO,uBACxDjD,GAAYj3D,EAAK,kBAAmBg3D,EAAK2C,SAASQ,iBAClDlD,GAAYj3D,EAAK,qBAAsBg3D,EAAK2C,SAASS,oBACrDnD,GAAYj3D,EAAK,yBAA0Bg3D,EAAK2C,SAASU,wBACzDpD,GAAYj3D,EAAK,mBAAoBg3D,EAAK2C,SAASW,kBACnDrD,GAAYj3D,EAAK,oBAAqBg3D,EAAK2C,SAASY,mBACpDtD,GAAYj3D,EAAK,wBAAyBg3D,EAAK2C,SAASa,uBACxDvD,GAAYj3D,EAAK,kBAAmBg3D,EAAK2C,SAASc,iBAClDxD,GAAYj3D,EAAK,qBAAsBg3D,EAAK2C,SAASe,oBACrDzD,GAAYj3D,EAAK,yBAA0Bg3D,EAAK2C,SAASgB,wBACzD1D,GAAYj3D,EAAK,mBAAoBg3D,EAAK2C,SAASiB,mBAEjD5D,EAAK1rE,MAAQ0rE,EAAK6D,WACpB5D,GAAYj3D,EAAK,YAAa,CAE5Bq3D,EAAGL,EAAK1rE,KAAKwvE,UAAUzD,EACvBhsB,EAAG2rB,EAAK6D,UAAUE,WAAW1vB,EAC7BD,EAAG4rB,EAAK6D,UAAUE,WAAW3vB,IAG7B4rB,EAAK6D,YACP5D,GAAYj3D,EAAK,oBAAqBg3D,EAAK6D,UAAUG,mBACrD/D,GAAYj3D,EAAK,wBAAyBg3D,EAAK6D,UAAUI,uBACzDhE,GAAYj3D,EAAK,kBAAmBg3D,EAAK6D,UAAUK,iBACnDjE,GAAYj3D,EAAK,qBAAsBg3D,EAAK6D,UAAUM,oBACtDlE,GAAYj3D,EAAK,yBAAyBg3D,EAAK6D,UAAUO,wBACzDnE,GAAYj3D,EAAK,mBAAoBg3D,EAAK6D,UAAUQ,kBACpDpE,GAAYj3D,EAAK,sBAAuBg3D,EAAK6D,UAAUS,qBACvDrE,GAAYj3D,EAAK,0BAA2Bg3D,EAAK6D,UAAUU,yBAC3DtE,GAAYj3D,EAAK,oBAAqBg3D,EAAK6D,UAAUW,mBACrDvE,GAAYj3D,EAAK,qBAAsBg3D,EAAK6D,UAAUY,oBACtDxE,GAAYj3D,EAAK,yBAA0Bg3D,EAAK6D,UAAUa,wBAC1DzE,GAAYj3D,EAAK,mBAAoBg3D,EAAK6D,UAAUc,kBACpD1E,GAAYj3D,EAAK,sBAAuBg3D,EAAK6D,UAAUe,qBACvD3E,GAAYj3D,EAAK,0BAA2Bg3D,EAAK6D,UAAUgB,yBAC3D5E,GAAYj3D,EAAK,oBAAqBg3D,EAAK6D,UAAUiB,oBAEvD,UAAA97D,EAAIu3D,uBAAJ,SAAqB7nC,SAvOfqsC,CAAWhG,EAAI/1D,IAAK0mB,GACpBqvC,EAAI/1D,IAAI0vB,OAAOqmC,EAAIL,MAAMsG,YACzB,IAAMvwE,EAAMsrE,EAAM,IAAM5uE,KAAKsC,GAC7B,UAAAsrE,EAAI7f,cAAJ,SAAY/qD,SAAS6Y,IAAmB,GAAd7b,KAAK6C,IAAIS,GAAQ,EAAkB,GAAdtD,KAAK8C,IAAIQ,IACxD,UAAAsqE,EAAI7f,cAAJ,SAAY4iB,OAAO,EAAE,IAAK,GAC1B,UAAA/C,EAAIH,gBAAJ,SAAcnS,OAAOsS,EAAID,MAAQC,EAAI7f,WAEtC,IAKH,OAJAogB,EAAM/wD,KAAKzF,cAAQ,WACjBg3D,EAAS15B,EAAM74B,YAAYjZ,KAAKP,YAAaqyC,EAAM74B,YAAY0f,aAG1D,WAAK,IAAD,gBACMqyC,GADN,IACT,IAAI,EAAJ,uBAAsB5tE,EAAtB,YADS,oCAKN,qCACL,yBAAQ4qB,MAAO,CACbi0B,cAAc,OACdp8C,SAAS,WACTtD,MAAMoE,GAAK,GAAInE,OAAOmE,GAAK,GAC3BsnB,MAAOtnB,GAAK,GAAG,EAAGqoB,MAAMroB,GAAK,GAAKmP,KAC/BiC,IAAKA,OAORu6D,GAAQqE,KAAgBrE,MACxBM,GAAO+D,KAAiB/D,KAgBxBjB,GAAc,SAClBj3D,EACA1E,GAII,IAAD,EAHHu7D,EAGG,uDAHQ,CAAEzrB,EAAG,EAAGC,EAAG,EAAGgsB,EAAG,GAC5B6E,EAEG,uDAFQ,EACXC,EACG,uDADU,GAEb,GAAKn8D,EAAL,CACA,IAAMo8D,EAAI,UAAGp8D,EAAIq8D,gBAAP,aAAG,EAAcC,YACzB7E,KAAU8E,iBAAiBjhE,IAE7B,GAAK8gE,EAAL,CAEA,IAAII,EAAQ,IAAI7G,KACdkB,EAASzrB,EAAI8wB,EACbrF,EAASxrB,EAAI6wB,EACbrF,EAASQ,EAAI6E,GAEXO,GAAa,IAAI9G,OAAmB+G,aAAaF,GACrDJ,EAAKK,WAAWE,MAAMF,EAAYN,MAuBhCxD,GAAgB,IAAIhD,KCjMT,ICAA,wgHCAA,4uKCAA,olGCAA,OAA0B,qDC2CnCiH,GAAY,GACZtlC,GAAO,GAGTulC,GAAY,EAEVr3B,GAAYC,aAAW,CAC3BC,KAAM,SAACtI,GAAD,MAAwB,CAC5BjyC,SAAU,WACVooB,KAAM6pB,EAAMjyC,SAAS,GACrBmpB,IAAK8oB,EAAMjyC,SAAS,GACpBtD,MAAM,EACNC,OAAO,IAETg1E,cAAe,SAAC1/B,GAAD,MAAwB,CACrC4mB,gBAAgB,WAChBtiB,UAAU,UAAD,OAAYtE,EAAMryC,YAAlB,UAEXgyE,QAAS,SAAC3/B,GAAD,MAAwB,CAC/BjyC,SAAU,WACVtD,MAAM,GAAD,OAAK+0E,GAAYx/B,EAAMnxC,MAC5BsnB,KAAK,IAAD,OAAMqpD,GAAYx/B,EAAMnxC,KAAOqrC,GAA/B,MACJhjB,IAAI,IAAD,OAAMsoD,GAAYx/B,EAAMnxC,KAAOqrC,GAA/B,MACHiQ,cAAe,SAEjB7pC,OAAQ,SAAC0/B,GAAD,MAAwB,CAC9BjyC,SAAU,WACVooB,KAAK,IAAD,OAAM6pB,EAAMnxC,KAAOqrC,GAAnB,MACJhjB,IAAI,IAAD,OAAM8oB,EAAMnxC,KAAOqrC,GAAnB,MACH0sB,gBAAgB,WAChBtiB,UAAW,oBAAatE,EAAMnxC,KAAOqrC,GAA1B,eAAqC8F,EAAMnxC,KAAOqrC,GAAlD,0BACG8F,EAAMryC,YADT,2BACuCqyC,EAAMnxC,KAAOqrC,GADpD,gBACgE8F,EAAMnxC,KAAOqrC,GAD7E,SAGb0lC,WAAY,SAAC5/B,GAAD,MAAwB,CAClCjyC,SAAU,WACVtD,MAAoB,EAAbu1C,EAAMnxC,KACbnE,OAAqB,EAAbs1C,EAAMnxC,KACdsnB,MAAoB,EAAd6pB,EAAMnxC,KACZqoB,KAAmB,EAAd8oB,EAAMnxC,KACX6iB,QAAS,EACTy4B,cAAe,OACf7F,UAAW,aACXN,WAAY,kBAEd67B,iBAAkB,SAAC7/B,GAAD,MAAwB,CACxCjyC,SAAU,WACVtD,MAAoB,EAAbu1C,EAAMnxC,KACbnE,OAAqB,EAAbs1C,EAAMnxC,KACdsnB,MAAoB,EAAd6pB,EAAMnxC,KACZqoB,KAAmB,EAAd8oB,EAAMnxC,KACX6iB,QAAS,EACTy4B,cAAe,OACf7F,UAAW,aACXN,WAAY,kBAEdna,KAAM,SAACmW,GAAD,MAAwB,CAC5BjyC,SAAU,WACVtD,MAAoB,GAAbu1C,EAAMnxC,KACbnE,OAAqB,GAAbs1C,EAAMnxC,KACdsnB,KAAmB,GAAb6pB,EAAMnxC,KACZqoB,IAAkB,GAAb8oB,EAAMnxC,KACXs7C,cAAe,SAEjB21B,WAAY,SAAC9/B,GAAD,MAAwB,CAClCjyC,SAAU,WACVtD,MAAoB,IAAbu1C,EAAMnxC,KACbnE,OAAqB,IAAbs1C,EAAMnxC,KACdsnB,KAAmB,GAAb6pB,EAAMnxC,KACZqoB,IAAkB,GAAb8oB,EAAMnxC,KACXs1C,QAAS,OACTgG,cAAe,SAEjB41B,cAAe,SAAC//B,GAAD,MAAwB,CACrCjyC,SAAU,WACVtD,MAAoB,GAAbu1C,EAAMnxC,KACbnE,OAAqB,GAAbs1C,EAAMnxC,KACdsnB,KAAmB,GAAb6pB,EAAMnxC,KACZqoB,IAAkB,GAAb8oB,EAAMnxC,KACXs7C,cAAe,SAEjB61B,aAAc,SAAChgC,GAAD,MAAwB,CACpCjyC,SAAU,WACVtD,MAAoB,GAAbu1C,EAAMnxC,KACbnE,OAAqB,GAAbs1C,EAAMnxC,KACdsnB,MAAoB,GAAd6pB,EAAMnxC,KACZqoB,KAAmB,GAAd8oB,EAAMnxC,KACXs7C,cAAe,OACf7F,UAAW,WACXN,WAAY,gDAEdi8B,iBAAkB,SAACjgC,GAAD,MAAwB,CACxCjyC,SAAU,WACVtD,MAAoB,GAAbu1C,EAAMnxC,KACbnE,OAAqB,GAAbs1C,EAAMnxC,KACdsnB,KAAmB,GAAb6pB,EAAMnxC,KACZqoB,IAAkB,EAAb8oB,EAAMnxC,KACXs7C,cAAe,OACf7F,UAAW,WACXN,WAAY,gBAEdk8B,QAAS,SAAClgC,GAAD,MAAwB,CAC/BjyC,SAAU,WACVtD,MAAoB,IAAbu1C,EAAMnxC,KACbnE,OAAqB,IAAbs1C,EAAMnxC,KACdsnB,KAAmB,GAAb6pB,EAAMnxC,KACZqoB,KAAmB,GAAd8oB,EAAMnxC,KACXs7C,cAAe,SAEjBuR,KAAM,SAAC1b,GAAD,MAAwB,CAC5BjyC,SAAU,WACVtD,MAAoB,GAAbu1C,EAAMnxC,KACbnE,OAAqB,GAAbs1C,EAAMnxC,KACdsnB,KAAmB,GAAb6pB,EAAMnxC,KACZqoB,IAAmB,IAAb8oB,EAAMnxC,OAEdsxE,YAAa,SAACngC,GAAD,MAAuB,CAClCjyC,SAAU,WACVu2C,UAAU,UAAD,OAAYtE,EAAMryC,YAAlB,QACTlD,MAAO,QACPC,OAAQ,YAeN01E,GAAuF,SAACpgC,EAAO//B,GAGnG,IAAMkH,EAAc64B,EAAM74B,YAEpBlW,EAAMkW,EAAY4vD,cAClBsJ,EAAmBv6B,cAAY,iBAAO,CAC1C/3C,SAAUoZ,EAAYjZ,KAAKH,SAC3BJ,YAAawZ,EAAYjZ,KAAKP,YAC9B2yE,cAAen5D,EAAYxX,MAAM5B,SACjCiR,iBAAkBmI,EAAY5F,QAAQvC,qBAGlCd,EAAO4nC,cAAY,kBAAM3+B,EAAajG,YAAYhD,QAClDiD,EAAa2kC,cAAY,kBAC7B3+B,EAAayf,YAAY9iB,SAAW,EAAI/Y,KAAKI,IAAIgc,EAAahG,WAAY,OACtE2C,EAAWgiC,cAAY,kBAAM3+B,EAAYyf,YAAY9iB,YACrDC,EAAe+hC,cAAY,kBAAM3+B,EAAYyf,YAAY7iB,gBACzDjC,EAAYgkC,cAAY,kBAAM3+B,EAAYyf,YAAY9kB,aACtD/C,EAAU+mC,cAAY,kBAAM3+B,EAAY5F,QAAQxC,WAGhDwhE,EAASz6B,cAAY,kCAAM9F,EAAMjgB,OAAO1Z,aAAaI,MAAM2xB,YAAtC,aAAM,EAAsCA,QACjEooC,EAAS16B,cAAY,kBAAM3+B,EAAYyf,YAAY3kB,YACnDw+D,EAAe36B,cAAY,kBAAM3+B,EAAY6W,WAG7C0iD,EAAS56B,cAAY,WACzB,IAD+B,EAC3B9mB,EAAU/C,MAAMnT,KAAKk3B,EAAMjgB,OAAO1Z,aAAaG,OAAO9I,QAAQye,QAAO,SAAApqB,GAAG,OAAIA,IAAQiuC,EAAMjgB,OAAO1Z,aAAaW,WADnF,cAEhBgY,EAAQskB,WAFQ,IAE/B,IAAI,EAAJ,qBAAkC,CAAC,IAAD,EAC+C,MAC0E,IAFlJ3yC,EAAyB,0BAChC,QAAoEkP,KAAjE,UAAAmgC,EAAMjgB,OAAO1Z,aAAaG,OAAO3d,IAAIm2B,EAAQruB,WAA7C,eAAkD4nC,YAKnD,OAJA,IAAG,UAAAyH,EAAMjgB,OAAO1Z,aAAaG,OAAO3d,IAAIm2B,EAAQruB,WAA7C,eAAkDqV,MAAOmB,EAAYnB,IAA2E,MAArE,UAAAg6B,EAAMjgB,OAAO1Z,aAAaG,OAAO3d,IAAIm2B,EAAQruB,WAA7C,mBAAkD4nC,kBAAlD,eAA8DvyB,IAC1I,iBAAOg6B,EAAMjgB,OAAO1Z,aAAaG,OAAO3d,IAAIm2B,EAAQruB,WAApD,iBAAO,EAAkD4nC,kBAAzD,aAAO,EAA8DvyB,IAL5C,kCAc1B26D,EAAc76B,cAAY,iCAAoDjmC,KAA7C,UAAAmgC,EAAMjgB,OAAO1Z,aAAaI,MAAM2xB,YAAhC,eAAsCpyB,KAAiE,MAA7C,UAAAg6B,EAAMjgB,OAAO1Z,aAAaI,MAAM2xB,YAAhC,eAAsCpyB,IAAjG,UAA8Gg6B,EAAMjgB,OAAO1Z,aAAaI,MAAM2xB,YAA9I,aAA8G,EAAsCpyB,QAAKnG,KAI1L+gE,EAAY96B,cAAY,WAC5B,IADkC,EAC9B9mB,EAAU/C,MAAMnT,KAAKk3B,EAAMjgB,OAAO1Z,aAAaG,OAAO9I,QAAQye,QAAO,SAAApqB,GAAG,OAAIA,IAAQiuC,EAAMjgB,OAAO1Z,aAAaW,WAC9G65D,EAAoB,EAClBC,EAAW9gC,EAAMjgB,OAAO1Z,aAAaI,MAAMvY,KAHf,cAInB8wB,EAAQskB,WAJW,IAIlC,IAAI,EAAJ,qBAAkC,CAAC,IAAD,MAAzB3yC,EAAyB,0BAEhC,IAAG,UAAAqvC,EAAMjgB,OAAO1Z,aAAaG,OAAO3d,IAAIm2B,EAAQruB,WAA7C,eAAkDqV,MAAOmB,EAAYnB,SAA2EnG,KAArE,UAAAmgC,EAAMjgB,OAAO1Z,aAAaG,OAAO3d,IAAIm2B,EAAQruB,WAA7C,mBAAkD4nC,kBAAlD,eAA8DvyB,IAAkB,CAC5J,QAA8EnG,IAA3EpC,OAAOuiC,EAAMjgB,OAAO1Z,aAAaG,OAAO3d,IAAIm2B,EAAQruB,KAAKzC,KAAKH,SAE/D8yE,EAAa7zE,EADCQ,EAAgBszE,EAAUrjE,OAAOuiC,EAAMjgB,OAAO1Z,aAAaG,OAAO3d,IAAIm2B,EAAQruB,KAAKzC,MACtEH,UAE7B,OAAO8yE,IAXuB,kCAgB9BE,EAAYj7B,cAAY,kBAAM3+B,EAAYyf,YAAY1kB,YACtD8+D,EAASl7B,cAAY,kBAAM3+B,EAAYyf,YAAYzkB,SACnD8+D,EAASn7B,cAAY,kBAAM3+B,EAAYyf,YAAYxkB,SAGzD,EAA8C8+B,qBAAS,GAAvD,mBAAOggC,EAAP,KAAwBC,EAAxB,KACA,EAA4BjgC,oBAAS,CAAC,EAAE,IAAxC,mBAAOkgC,EAAP,KAAeC,EAAf,KAEA,EAAwBngC,qBAAS,GAAjC,mBAAOogC,EAAP,KAAaC,EAAb,MAEGR,GAAcK,EAAO,KAAOJ,GAAUI,EAAO,KAAOH,GACrDE,GAAmB,GAGrB,IAAIK,EAASR,EAAU,GACnBS,EAASR,EAAU,GAavB,GAXGF,IAAiC,IAApBG,IA6BhB,WACE,IAAIQ,EAASrB,EAAiBC,cAAc,GACxCqB,EAAU3hC,EAAMjgB,OAAO1Z,aAAaI,MAAMvY,KAAKH,SAAS,GAEtDzF,EAAM,iBACN+kC,EAAU,IAAIK,aACpBvkC,OAAOomB,MAAMjnB,GACZob,MAAK,SAAA2M,GAAQ,OAAIA,EAASmV,iBAC1B9hB,MAAK,SAAA8hB,GAAW,OAAI6H,EAAQu0C,gBAAgBp8C,MAC5C9hB,MAAK,SAAAm+D,GACJ,IAAMt0C,EAASF,EAAQy0C,qBACvBv0C,EAAO9H,OAASo8C,EAChB,IAAIE,EAAU10C,EAAQ20C,qBAGpBD,EAAQE,IAAIlsD,MAFX2rD,EAAUC,EAAU,GAED,EACZD,EAAUC,EAAU,IAEP,EAGD,EAEtBp0C,EAAOM,QAAQk0C,GACfA,EAAQl0C,QAAQR,EAAQ4P,aACxB1P,EAAOxW,WArDTmrD,GAGAb,EAAU,CAACL,EAAQC,IACnBE,GAAmB,KACG,IAAdJ,GAAuBG,GAC/BC,GAAmB,QAIFthE,IAAhB8gE,EACDlB,GAAY,OAEZ,GAAGiB,IAAWC,EACZ,IAAMwB,EAAS3oD,YAAW,WACrBimD,IAAa,IAChBl9B,aAAa4/B,IACD,IAATb,GACDC,GAAQ,GACR9B,MAEA8B,GAAQ,MAGT,KAmCP,IAAM94B,EAAUL,GAAU,6BACrBi4B,GADoB,IAEvBxxE,KAAMmxC,EAAMnxC,QAGd,EAA2BsY,EAAcA,EAAYqB,WAAa,CAAC,QAAS,SAA5E,mBAAOnK,EAAP,KAAc3M,EAAd,KACM0wE,EAAcpiC,EAAMnxC,KAAO,EAAI,EAC/BoS,EAAU++B,EAAM/+B,QAChBohE,EAAkBriC,EAAMnxC,KAAO2wE,GAAYtlC,GAC3CooC,EAAY9C,GAAYx/B,EAAMnxC,KAAOqrC,GA4CrCqoC,EAAS,sBAAKz5B,UAAWL,EAAQk3B,QAASl1E,MAAOu1C,EAAMnxC,KAAO2wE,GAAW90E,OAAQs1C,EAAMnxC,KAAO2wE,GAClGgD,MAAM,+BAYFC,EAAkB,CAAC,GAAK,GAAK,GAAK,GAAK,GAAK,IAC5C/yC,EAAa+yC,EAAgB31E,KAAI,SAAAg5B,GAAI,OAAK3kB,EAAa2kB,GAAmB,UAAXy6C,EACnE,gBAAC,KAAMvW,SAAP,WACE,yBAAQv4D,EAAGuuC,EAAMnxC,KAAOqrC,GAAOpU,EAAOu8C,EAAiBK,GAAIJ,EAAWK,GAAIL,EACxEl0B,OAAQ/vC,EAAOy/B,KAAK,OAAOpsB,QAAS,IAAO,EAAIoU,GAAO88C,gBAAgB,aACxE,yBAAQnxE,EAAGuuC,EAAMnxC,KAAOqrC,GAAOpU,EAAOu8C,EAAiBK,GAAIJ,EAAWK,GAAIL,EAC1El0B,OAAO,QAAQtQ,KAAK,OAAOpsB,QAAS,IAAO,EAAIoU,GAAO88C,gBAAgB,OAAOC,iBAAiB,SAJ3E/8C,QAMnBjmB,KAEEijE,EAAYL,EAAgB31E,KAAI,SAAAg5B,GAAI,OAAI3kB,EAAa2kB,EACzD,eAAC,KAAMkkC,SAAP,UACE,sBAAKnnD,ILzYI,yhHKyYsBimC,UAAWL,EAAQs3B,cAAer7B,IAAI,MADlD5e,QAGnBjmB,KA4CEkjE,EAAa,uBACjBj6B,UAAWL,EAAQk3B,QAASl1E,MAAOu1C,EAAMnxC,KAAO2wE,GAAW90E,OAAQs1C,EAAMnxC,KAAO2wE,GAAWgD,MAAM,6BADhF,UAMH,UAAXjC,GAAuBp5D,EAAYnB,KAAOg6B,EAAMjgB,OAAO1Z,aAAaW,SAAY05D,IAAWC,QAE5E9gE,IAAd+gE,GAA2BA,EAAY,KACvCz5D,EAAYnB,KAAOg6B,EAAMjgB,OAAO1Z,aAAaW,cAA6BnH,IAAhB8gE,EAF9D,yBAAQlvE,EAAG2wE,EAAaM,GAAIJ,EAAWK,GAAIL,EAAWl0B,OAAO,UAAU,eAAa,IAAItQ,KAAM,cAI1F,yBAAQrsC,EAAG2wE,EAAaM,GAAIJ,EAAWK,GAAIL,EAAWl0B,OAAO,OAAOtQ,KAAM,cAE7EpO,EACkB,UAAlB9pB,OAAOtF,OACN,qBAAGgkC,UAAS,oBAAeg+B,EAAf,YAA4BA,EAA5B,mBAAZ,UACE,uBAAMpsD,MAAO,CAACi0B,cAAe,QAC3Bz/C,OAAQ03E,EAAa33E,MAAO23E,EAAatkC,KAAMz/B,IAChD4C,EACC,uBAAO3V,EAAG,cAAO82E,EAAP,cAAwBA,EAAxB,eAA0CA,GAA1C,YACHA,EADG,YACYA,EADZ,mBACkCA,EADlC,YACiDA,GACzDtkC,KAAK,OAAOsQ,OAAQ18C,SACpBmO,KAGN,oBAAGqW,MAAO,CAACi0B,cAAe,aAUxB64B,GAAS77D,EAAYjG,YAAY9C,WAA6D,SAAhD+I,EAAYjG,YAAY9C,UAAU7M,OAAO,GAE7F,OAAO,uCACL,uBAAKu3C,UAAWL,EAAQH,KAAMpyB,MAAO,CAACvK,OAAO1K,EAAU,IAAOkG,EAAYwE,QAA1E,UACG42D,EACD,uBAAKz5B,UAAWL,EAAQi3B,cAAxB,UACGqD,EACD,uBAAKj6B,UAAWL,EAAQnoC,OAAS,cAAesqC,cAAe5K,EAAM4K,cAArE,UACE,eAACK,GAAA,EAAD,CAAS9oB,MAAOjkB,EAAhB,SACE,iCACc,UAAXqiE,GAAuBp5D,EAAYnB,KAAOg6B,EAAMjgB,OAAO1Z,aAAaW,SAAY05D,IAAWC,EAC9F,sBAAK99D,IAAKogE,GAAcn6B,UAAWw4B,EAAO74B,EAAQm3B,WAAan3B,EAAQo3B,iBAAkBr7B,WAAW,EAAOE,IAAI,WAC5F7kC,IAAd+gE,GAA2BA,EAAY,MAC1Cz5D,EAAYnB,GAAOg6B,EAAMjgB,OAAO1Z,aAAaW,SAC5C,IACD,eAAC,GAAD,gBAAYg5B,IACX8iC,EACD,sBAAKjgE,IAAgB,UAAX29D,EAAqB0C,GAA2B,SAAX1C,EAAoB2C,GAA0B,SAAX3C,EAAoB4C,QAAcvjE,EAAaipC,UAAsB,KAAX03B,EAAgB/3B,EAAQw3B,iBAAmBx3B,EAAQu3B,aAAet7B,IAAI,KAClN,eAAC,GAAD,CAAmBoE,UAAWL,EAAQq3B,WAAY9hD,QAASgiB,EAAM74B,YAAY6W,eAC1Dne,IAAjB4gE,GAA8BA,EAAe,GAAM,sBAAK59D,IC7ezD,q6ED6e2EimC,UAAWL,EAAQy3B,QAAUx7B,IAAI,UAAQ7kC,EACpHiC,EAAY,eAAC,KAAD,CAAagnC,UAAWL,EAAQ5e,KAAM+e,UAAU,4BAA0B/oC,EACtFkE,EAAe,eAAC,KAAD,CAAgB+kC,UAAWL,EAAQ5e,KAAMxrB,MAAM,cAC5DyF,EAAW,eAAC,KAAD,CAAYglC,UAAWL,EAAQ5e,KAAMxrB,MAAM,mBAAiBwB,GACxEiE,GAAY/E,EAAU,eAAC,QAAD,CAAM+pC,UAAWL,EAAQ5e,KAAMA,KAAMu1B,KAAe/gD,MAAM,cAAYwB,EAC7FmgC,EAAMqjC,WAAa,eAAC,KAAD,CAAev6B,UAAWL,EAAQ5e,KAAM+e,UAAU,cAAY/oC,OAGtF,iCACE,sBAAKgD,KAAmB,IAAdk+D,EEtfP,ssLFsfwClhE,EAAWqW,OAAqB,IAAd6qD,EAAsB,CAAC58B,QAAS,QAAS15C,MAAOqtC,GAAa/pC,SAAS,WAAYk2C,UAAW,SAAU/sB,IAAMuqD,EAAOtrD,KAAOqrD,EAAO/gB,WAAY,OAAS,CAACtc,QAAQ,QAASO,IAAI,KAC1O,sBAAKxuB,OAAqB,IAAd6qD,EAAsB,CAACz5C,gBAAgBl2B,EAAUH,GAAMmqD,aAAc,MAAOrtD,SAAS,WAAYo2C,QAAS,QAAS15C,MAAQqtC,GAAmBmM,UAAW,SAAU/sB,IAAMuqD,EAAO,GAAKtrD,KAAOqrD,EAAK,IAAM/gB,WAAY,OAAU,CAACtc,QAAQ,QAASthC,KAAmB,IAAdk+D,EAAsB55D,EAAYjG,YAAY9C,eAAYyB,EAAW6kC,IAAI,iBAMhVs+B,GAAS,sBAAKl6B,UAAWL,EAAQH,KAAMpyB,MAAO,CAACvK,OAAOxE,EAAYwE,OAAS,KAAlE,SACR,eAAC,GAAD,CAAWxE,YAAaA,WAAwBtH,MAGtDugE,GAAe5gC,YAAc,iBAKtB,IAAM8jC,GAAc,SAACtjC,GAAD,OACzBwG,KAAM+a,SAAQ,kBAAM,eAAC,GAAD,gBAAoBvhB,MAExC,CAACA,EAAMnxC,KAAMmxC,EAAM74B,YAAYnB,GAC7Bg6B,EAAM74B,YAAYjG,YAAY9C,UAC9B4hC,EAAM74B,YAAYjG,YAAY7C,MAC9B2hC,EAAM74B,YAAYjG,YAAYhD,KAC9B8hC,EAAM74B,YAAYjG,YAAYxP,aAElC4xE,GAAY9jC,YAAc,uB,yBGzfpBwK,GAAQ4H,aAAY,CACxBC,QAAS,CACPC,QAAS,CAAEC,KAAM,WACjBC,UAAW,CAAED,KAAM,cAoBjB3J,GAAYC,aAAW,CAC3BqT,KAAM,SAAC1b,GAAD,MAAwB,CAC5BjyC,SAAU,WACVtD,MAAoB,GAAbu1C,EAAMnxC,KACbnE,OAAqB,GAAbs1C,EAAMnxC,KACdsnB,KAAM6pB,EAAMjyC,SAAS,GAAkB,GAAbiyC,EAAMnxC,KAChCqoB,IAAK8oB,EAAMjyC,SAAS,GAAkB,GAAbiyC,EAAMnxC,OAEjC00E,kBAAmB,SAACvjC,GAAD,MAAuB,CACxCmE,QAAS,OACTp2C,SAAU,WACVtD,MAAO,IACPC,OAAQ,IACR+rD,SAAU,SACVlS,WAAY,OACZic,SAAU,OACVhpC,OAAQ,OAER8P,gBAAiB,cACjB0c,WAAY,cACZ8O,OAAQ,YAEV0wB,kBAAmB,SAACxjC,GAAD,MAAuB,CACxCmE,QAAS,OACTp2C,SAAU,WACVtD,MAAO,IACPC,OAAQ,IACR+rD,SAAU,SACVlS,WAAY,OACZic,SAAU,OAGVtpC,IAAK,EACLf,KAAM,EACNqB,OAAQ,OAER8P,gBAAiB,cACjB0c,WAAY,gBACZ8G,gBAAiB,OACjBgI,OAAQ,YAGV2wB,aAAc,SAACzjC,GAAD,MAAwB,CACpCjyC,SAAU,WACVtD,MAAM,IACNC,OAAO,IACPq2D,YAAY,EACZD,YAAa,QACbE,YAAY,UACZ5F,aAAa,MACb1pC,QAAS,GACTwF,IAAK,GACLf,KAAM,GACN2pC,WAAY,+DACZn0C,QAAS,OAGX+3D,SAAU,SAAC1jC,GAAD,qBACRmE,QAAS,QACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,IACLf,KAAM,IACNsqC,WAAY,MACZ3N,OAAQ,UACRgN,WAAY,WACT5E,KAGLyoB,WAAY,SAAC3jC,GAAD,qBACVmE,QAAS,QACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,GACLf,KAAM,IACNsqC,WAAY,MACZ3N,OAAQ,UACRgN,WAAY,WAET5E,KAGL0oB,SAAU,SAAC5jC,GAAD,qBACRmE,QAAS,QACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,IACLf,KAAM,IACNsqC,WAAY,MACZ3N,OAAQ,UACRgN,WAAY,WACT5E,KAGLjJ,cAAe,CACb9N,QAAS,OACTz5C,OAAQ,OACRD,MAAM,QAGRynD,cAAe,CACbnkD,SAAS,WACTmpB,IAAI,OACJf,KAAM,OACN1rB,MAAM,QACNC,OAAO,SAETynD,YAAc,CACZ1nD,MAAM,MACNC,OAAO,OACP0nD,SAAU,QACVC,UAAW,QACXC,OAAO,uBACPn8B,KAAK,OACLpoB,SAAS,YAEXwkD,QAAS,CACPpO,QAAQ,OACRp2C,SAAU,WACV61C,WAAY,OACZ4O,oBAAqB,mBACrBC,KAAK,GACL3O,UAAU,OACVC,UAAW,SACXr5C,OAAO,QACPgoD,aAAa,cAEfmxB,YAAa,CACX1/B,QAAQ,OACRp2C,SAAU,WACV61C,WAAY,OACZ4O,oBAAqB,mBACrBC,KAAK,GACL3O,UAAU,SACVC,UAAW,SACXr5C,OAAON,IAAiB,QAAU,OAClCsoD,aAAa,cAEfC,gBAAiB,CACf5kD,SAAS,WACT21C,QAAQ,OACRzE,SAAS70C,IAAiB,QAAU,MACpCwoD,WAAW,OACXC,aAAc,oBACdx0C,MAAM,UACNy0C,OAAQ,WAGVC,cAAe,CACbhlD,SAAS,WACT21C,QAAQ,OACRzE,SAAS70C,IAAiB,QAAU,MACpCwoD,WAAW,OACXC,aAAa,oBACbx0C,MAAM,UACNy0C,OAAQ,aAINoI,GAAc,CAClB,IAAK,CACHC,OAAQ,MACRC,aAAc,MACd3wD,MAAO,OACPC,OAAQ,OACRg5C,QAAS,OAMX,UAAW,CACTpc,gBAAiB,QACjB6zB,OAAQ,MACRzX,QAAS,MACT0X,aAAc,OAEhB,WAAY,CAEVD,OAAQ,MACRzX,QAAS,MACT0X,aAAc,QAIZ0oB,G,mDACJC,qBAAsB,E,KACtBC,WAAY,E,KACZC,UAAW,E,KAGX7nB,OAAS,E,KACTD,SAAW,E,KACX+nB,SAAW,E,KACXC,SAAW,E,KACXC,OAAS,E,KACTC,OAAS,E,KACTC,SAAW,E,KACXC,SAAW,E,KACXC,MAAQ,E,KACRC,MAAQ,E,KACRC,MAAQ,E,KACRC,MAAQ,E,KAERC,YAAc,G,KACdC,UAAY,E,KACZC,YAAa,E,KACb3iE,MAAQ,E,KACRC,MAAQ,E,KACR2iE,YAAc,E,KAGdC,QAAU,E,KACVC,QAAU,KAQRC,IAAsB,EACnB,SAASC,KACd,OAAOD,GAGT,IAAIE,IAA0B,EAM9B,IACIC,GAAgB,GAChBC,GAAe,GACfC,GAAoB,GACpBC,GAAe,GACfC,GAAmB,GACnBC,GAAkB,GAClBC,GAAgB,GAUpB,IAAIC,IAA4B,EACzB,SAASC,KACd,OAAOD,GAET,IAAMnkE,GAAoD,SAACu+B,GACzD,IAAMlzC,EAAMkzC,EAAMjgB,OAAOjzB,IACnBuZ,EAAe25B,EAAMjgB,OAAO1Z,aAC5Bc,EAAcd,EAAaI,MAI3BkyD,EADS3xB,kBAAoB,IAAI88B,IACpB7sC,QAGhB9vB,EAAYjG,YAAY9C,UAmB3B9U,EAAO02C,EAAM74B,YAAYnB,KAAOmB,EAAYnB,IAC5C,IAAMqjC,EAASrC,kBAA+B,IAA8B/P,QAkItE6uC,EAAS,SAAC5kD,IA/HQ,SAACA,GAEvB,IAAIjE,EAAQvwB,EAAMw0B,EAAM6kD,GAAIj5E,EAAI+X,SAASsC,EAAajZ,KAAKH,WACrDi4E,EAAOj7E,KAAKG,KAAK+xB,EAAM,GAAKA,EAAM,GAAKA,EAAM,GAAKA,EAAM,IAK9D,GAJI+oD,EArTmB,KAsTrB/oD,EAAQlwB,EAtTa,GAsTci5E,EAAM/oD,IAGvC5W,EAAaI,MAAM5C,gBAAiB,CACtC,IAAMoiE,EAAan5E,EAAIo5E,iBAAiBjpD,GACxC9V,EAAajZ,KAAKH,SAAWtB,EAAM0a,EAAajZ,KAAKH,SAAUk4E,GAE1D58B,EAAO88B,gBAAiB98B,EAAO88B,cAAgB,CAAClpD,EAAM,GAAIA,EAAM,KACrEosB,EAAO88B,cAAgB15E,EAAMM,EAAM,EAFf,GAEgCk5E,GAAal5E,EAF7C,GAEgEs8C,EAAO88B,gBAC3F,IACIn8E,EA7TU,IA4TFe,KAAKS,MAAM69C,EAAO88B,cAAc,IAAK98B,EAAO88B,cAAc,IAAoBp7E,KAAKsC,GAC9E8Z,EAAajZ,KAAKP,YAC/B3D,GA9TU,MA8TaA,GA7TZ,KA8TXA,EA/TU,MA+TYA,GA9TX,KAgUfmd,EAAajZ,KAAKP,aADK,GACU3D,OAEjCmd,EAAajZ,KAAKH,SAAWtB,EAAMK,EAAIo5E,iBAAiBjpD,GACrB9V,EAAajZ,KAAKH,UAEvDoZ,EAAYi/D,sBAAqB,GAyGjCC,CAAgBnlD,IAkBZolD,ECrbD,SAAyCR,EAAsCS,EACxEC,EAA2CjrD,EAC3CqvB,GACZ,IAAM3F,EAAS+B,kBAAW,MACpBy/B,EAAOz/B,kBAAqB,CAAC9lB,MAAM,KAAqB+V,QAExDyvC,EAAY,WACXD,EAAKvlD,MAAM+iD,UAAawC,EAAKE,WAGxBH,IACRC,EAAKE,WAAaH,EAAQC,EAAKvlD,SAH/B1F,cAAcirD,EAAKG,SACnBH,EAAKG,QAAU,IAOnB,SAASC,EAAYztD,GACnBA,EAAG0lB,iBACH1lB,EAAG2lB,kBAGLJ,sBAAU,WACR,IAAM1H,EAAUgO,EAAOhO,QAGvB,OAFO,OAAPA,QAAO,IAAPA,KAASrd,iBAAiB,YAAaitD,EAAa,CAACC,SAAQ,IAEtD,WACE,OAAP7vC,QAAO,IAAPA,KAASoL,oBAAoB,YAAawkC,MAGpC,CAAC5hC,EAAOhO,UAClB,IAAM8vC,EAAa,CACjB9hC,OAAQA,EACRwhC,KAAMA,EACNh8B,YAAa,SAACn+C,GAA8BA,EAAEyyC,mBAC9C4L,aAAc,SAACr+C,GAA8BA,EAAEyyC,mBAC/CuoB,cAAe,SAACh7D,GACdA,EAAEyyC,kBACF0nC,EAAKvlD,MAAQ,CAAC+iD,UAAS,EAAO+C,QAAQ16E,EAAE06E,QAASjB,GAAG,CAACz5E,EAAE6sD,QAAS7sD,EAAE8sD,SAChEriC,MAAM,CAACzqB,EAAE6sD,QAAS7sD,EAAE8sD,SAAUx4B,UAAUnY,KAAKC,MAAOiW,MAAMryB,GAC3C,EAAZA,EAAE06E,SAAgB/hC,EAAOhO,WAC1BsvC,GAjFV,SAAwCU,EAAa9lD,EAAS+lD,GAE5D,IADA,IAAIlgD,EAAMigD,EACHjgD,GAAOA,IAAQ7F,GAAM,CAC1B,GAAI6F,EAAImgD,WAAY,CAClB,IAAMC,EAAMpgD,EAAImgD,WAAWE,aAAa,SACxC,GAAID,GACEA,EAAIrxD,MAAMjT,SAASokE,GACrB,OAAOlgD,EAKbA,EAAMA,EAAIsgD,WAGZ,OAAO,KAkEWC,CAAWj7E,EAAE24C,OAAmBA,EAAOhO,QAASsvC,MAC3Dj6E,EAAE24C,OAAmBuiC,kBAAkBl7E,EAAEm7E,WAErChB,EAAKG,UACRH,EAAKG,QAAUhrD,YAAY8qD,EAAWnrD,IAExCkrD,EAAKvlD,MAAM+iD,UAAW,IAI1ByD,aAAc,SAACp7E,GACbA,EAAEyyC,kBACFthC,OAAO+D,OAAOilE,EAAKvlD,MAAO,CAAC+iD,UAAS,EAAO+C,QAAQ16E,EAAE06E,QAASjB,GAAG,CAACz5E,EAAE6sD,QAAS7sD,EAAE8sD,SAAUz6B,MAAMryB,KAGjGi7D,YAAa,SAACj7D,GACXA,EAAE24C,OAAmB0iC,sBAAsBr7E,EAAEm7E,WAC9CV,EAAWW,aAAap7E,IAE1Bs7E,WAAW,SAACt7E,GACVA,EAAEyyC,kBACF,IAAM9hB,EAAQjwB,EAAMN,EAAM+5E,EAAKvlD,MAAM6kD,GAAIU,EAAKvlD,MAAMnK,QAC9C8wD,EAASp/D,KAAKC,MAAQ+9D,EAAKvlD,MAAMN,UACnC3D,EAAQ,GAAK4qD,EAAS,IAAOj9B,GAC/BA,EAAct+C,IAGlB4sD,cAAe,SAAC5sD,GAA+B,IAAD,EAC5CA,EAAEyyC,kBACFthC,OAAO+D,OAAOilE,EAAKvlD,MAAO,CAAC+iD,WAAS,UAAAwC,EAAKvlD,aAAL,UAAY+iD,UAC9C+C,QAAQ16E,EAAE06E,QAASjB,GAAG,CAACz5E,EAAE6sD,QAAS7sD,EAAE8sD,SAAUz6B,MAAMryB,IAGlDm6E,EAAKvlD,MAAM+iD,WACI,EAAZ33E,EAAE06E,QACLlB,EAAOW,EAAKvlD,OAEZulD,EAAKvlD,MAAM+iD,UAAW,KAM9B,OAAO8C,EDkWMe,CAA4BhC,EAAQ,cA7BjC,SAAC5kD,GAOf,OANIA,EAAM+iD,UACR6B,EAAO5kD,GA5CO,SAAC6mD,GACjB,IAAMC,EAAcl7E,EAAI+X,SAASsC,EAAajZ,KAAKH,UAC7Ck3C,EAAS,CAAC+iC,EAAY,GAAIA,EAAY,IACtC7xD,EAAOrpB,EAAIqpB,KAAOrpB,EAAIiY,WAAW,GAAKgjE,EACtC7jC,EAAQp3C,EAAIqpB,KAAOrpB,EAAIiY,WAAW,IAAM,EAAIgjE,GAC5CvwD,EAAS1qB,EAAIiY,WAAW,IAAM,EAAIgjE,GAClC7wD,EAAM7Q,EAAaI,MAAM5C,gBAAkB/W,EAAIiY,WAAW,GAAKgjE,EAAQvwD,EACzEytB,EAAO,GAAK9uB,IAAQ8uB,EAAO,GAAK9uB,GAChC8uB,EAAO,GAAKf,IAASe,EAAO,GAAKf,GACjCe,EAAO,GAAK/tB,IAAO+tB,EAAO,GAAK/tB,GAC/B+tB,EAAO,GAAKztB,IAAUytB,EAAO,GAAKztB,GACtC,IAAIxtB,EAAO0C,EAAMs7E,EAAa/iC,GACxB+gC,EAAOj7E,KAAKG,KAAKlB,EAAK,GAAKA,EAAK,GAAKA,EAAK,GAAKA,EAAK,IACtDg8E,EAzYgB,IA0YlBh8E,EAAO+C,EA1YW,IA0Yai5E,EAAMh8E,GAC7Bg8E,EA1YQ,MA2YhBh8E,EAAO+C,EA3YS,IA2Yai5E,EAAMh8E,IAErC,IACMi+E,EAAUl7E,EADK,GACeD,EAAIo5E,iBAAiBl8E,IAEzD,GAAIe,KAAKC,IAAIi9E,EAAQ,IAAMl9E,KAAKC,IAAIi9E,EAAQ,IAD5B,GAC2C,CACzD,IAAMntC,EAAShuC,EAAIhC,OAAOiB,WAAWk8E,EAAQ,IAAKA,EAAQ,IACpDC,EAAQp7E,EAAIo5E,iBAAiB,CAACprC,EAAOxuC,EAAGwuC,EAAOvuC,IAEjD47E,GAAU,EACVD,EAAM,IAAK,OAAoBA,EAAM,IAAK,KAAkBC,GAAU,GACtED,EAAM,GAAK5oE,OAAmB4oE,EAAM,GAAK5oE,KAAiB6oE,GAAU,GACpED,EAAM,IAAK,OAAoBA,EAAM,IAAK,KAAkBC,GAAU,GACtED,EAAM,GAAK5oE,OAAmB4oE,EAAM,GAAK5oE,KAAiB6oE,GAAU,GACxE,IAAMC,EAAWt7E,EAAIu7E,eAAeH,GATqB,cAUlCE,EAVkC,GAezD,OALCttC,EAAOxuC,EAViD,KAU9CwuC,EAAOvuC,EAVuC,KAWzDO,EAAIkuC,UAAUF,GACdhuC,EAAImuC,mBAAmBH,GACvBuO,EAAOi/B,aAAeH,GAEdA,EAIV,OAFA9+B,EAAOi/B,aAAc,GAEd,EAMIC,CAAU,MAmBA,IAO+C,WAAQC,GAAc,MAC5F7pC,sBAAU,WAAO,IAAD,EACd,UAAA2nC,EAAKrhC,OAAOhO,eAAZ,SAAqB5gB,MAAM,CAACoyD,eAAc,OAuC5C,IAAMC,EAAa5iC,cAAY,iBAAO,CACpC/3C,SAAUoZ,EAAYjZ,KAAKH,SAC3Bc,KAAMmxC,EAAMnxC,KACZ8pE,IAAKA,MAEP,EAAgBxxD,EAAcA,EAAYqB,WAAa,CAAC,QAAS,SAA1DnK,EAAP,oBACMoqC,EAAUL,GAAUsgC,GACnB52E,EAAKI,KAALJ,EACP,EAAuC00C,KAAMtF,UAAS,GAA9BkI,EAAxB,oBACA,EAAoC5C,KAAMtF,UAAS,GAAnD,mBAAOynC,EAAP,KAAmBH,EAAnB,KACMI,EAAcz/B,GAAkBC,EAAaC,GAEnD,EAAgC7C,KAAMtF,UAAS,GAA/C,mBAAO2nC,EAAP,KAAiBC,EAAjB,KACA,EAAgCtiC,KAAMtF,UAAS,GAA/C,mBAAO6nC,EAAP,KAAiBC,EAAjB,KACM/3E,EAAM+uC,EAAM74B,YAAY4vD,cAC9B6O,GAAmBmD,EAEnB,MAAkC7nC,oBAAS,GAA3C,mBAAOkS,EAAP,KAAkBC,EAAlB,KAEA,EAAwCnS,qBAAU,GAAlD,mBAAO+nC,EAAP,KAAqBC,EAArB,KACA,EAAsChoC,qBAAU,GAAhD,mBAAOioC,EAAP,KAAoBC,EAApB,KAEA,EAAoCloC,qBAAU,GAA9C,mBAAOmoC,EAAP,KAAmBC,EAAnB,KACA,GAAoCpoC,qBAAU,GAA9C,qBAAOqoC,GAAP,MAAmBC,GAAnB,MACA,GAAsCtoC,qBAAU,GAAhD,qBAAOuoC,GAAP,MAAoBC,GAApB,MAEA,GAA8CxoC,qBAAU,GAAxD,qBAAOyoC,GAAP,MAAwBC,GAAxB,MACA,GAA4C1oC,qBAAU,GAAtD,qBAAO2oC,GAAP,MAAuBC,GAAvB,MAIMC,GAAY/iC,kBAAuB,MAMzC,SAASgjC,KACPxB,GAAc,GACd17E,EAAIqtC,cAAc/X,IAAI,0BAOxB,SAAS6nD,GAAe7wD,GAEnBC,GAAKzoB,OAAS,GAAKuW,EAAYjG,YAAY5C,aAAa1N,OAAS,GAiOtE,WAGI,IAAIijD,EAASL,GAAO,GAAGxjD,MAAM,KACzBk6E,EAAgBr2B,EAAOnhC,QAAQy3D,GAAoB,IACnDC,EAAqBv2B,EAAOnhC,QAAQ,4BAA8By3D,GAAoB,GAAK,QAC3FE,EAAiBx2B,EAAOnhC,QAAQy3D,GAAoB,IACpDG,EAAc92B,GAAO,GAAGxjD,MAAM,KAC9Bu6E,EAAe/2B,GAAO,GAAGxjD,MAAM,KAC/Bw6E,EAAoBD,EAAa73D,QAAQy3D,GAAoB,IAC7DM,EAAcj3B,GAAO,GAAGxjD,MAAM,KAC9B06E,EAAmBD,EAAY/3D,QAAQy3D,GAAoB,IAC/D7E,GAAezxB,EAAOq2B,GACnBb,IAAea,GAChBZ,EAAcY,GAEhB3E,GAAoB1xB,EAAOu2B,GAAoBp6E,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGA,MAAM,OAAO,GACrFu5E,KAAea,GAChBZ,GAAcY,GAEhB/E,GAAgBxxB,EAAOw2B,GACpBZ,KAAgBY,GACjBX,GAAeW,GAGjB,IAAIM,EAA6B,GAC7BC,EAAiC,GACjCC,EAA4B,GAC5BC,EAAgC,GACpCH,EAAW1iE,OAAO,GAClB2iE,EAAe3iE,OAAO,GACtB4iE,EAAU5iE,OAAO,GACjB6iE,EAAc7iE,OAAO,GACrB,IAAK,IAAItX,EAAW,EAAGA,EAAI25E,EAAY15E,OAAS,EAAGD,IAC/C,IAAkG,IAA/F25E,EAAY53D,QAAQ6yD,GAAkBv1E,MAAM,KAAK,GAAK,IAAMs6E,EAAY35E,GAAGX,MAAM,KAAK,MACrFu1E,GAAkBv1E,MAAM,KAAK,KAAOs6E,EAAY35E,GAAGX,MAAM,KAAK,IAAwC,MAAjCs6E,EAAY35E,GAAGX,MAAM,KAAK,IAAa,CAC9G,IAAI+6E,EAAWT,EAAY35E,GAAGX,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGA,MAAM,KAAK,GACrD,MAAb+6E,GACDJ,EAAWxiE,KAAKmiE,EAAY35E,IAC5Bi6E,EAAeziE,KAAKxX,IACC,MAAbo6E,IACRF,EAAU1iE,KAAKmiE,EAAY35E,IAC3Bm6E,EAAc3iE,KAAKxX,IAK3B,GAAGg6E,EAAW/5E,OAAS,EAAG,CACxB,IAAIo6E,EAAkBL,EAAWj4D,QAAQy3D,GAAoB,IAC7D3E,GAAemF,EAAWK,GAC1BpB,GAAmBgB,EAAeI,IAClC,IAAIC,EAAWX,EAAY53D,QAAQgC,OAAOi2D,EAAWK,GAAiBh7E,MAAM,UAAU,GAAK,YAC1E,IAAdi7E,GACDxF,GAAmB6E,EAAYW,GAC5BpB,KAAmBoB,EACpBnB,GAAkBmB,IAElBxF,GAAmB,GACnBqE,IAAmB,MAGrBrE,GAAmB,GACnBqE,IAAmB,SAGrBtE,GAAe,GACfoE,IAAoB,GAEpBnE,GAAmB,GACnBqE,IAAmB,GAIrBpE,GAAkB6E,EAAaC,GAC5BvB,IAAiBuB,GAClBtB,EAAgBsB,GAGlB7E,GAAgB8E,EAAYC,GACzBvB,IAAgBuB,GACjBtB,EAAesB,GAhTjBQ,GAEFlC,GAAY,GAUd,SAASj1B,GAAWD,GAClB,IAAID,EAASL,GAAOJ,GAAWpjD,MAAM,KAKrC,GAJgB6jD,EAAOC,GAIN,IAAdV,EAAiB,CAUlB,GATGU,EAAa,IACduxB,GAAgBxxB,EAAOC,GACpB21B,KAAgB31B,GACjB41B,GAAe51B,IAMhBA,GAAc,GAAKA,EAAa,GAAI,CAIrC,GAHAyxB,GAAoB1xB,EAAOC,GAAY9jD,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGA,MAAM,OAAO,GAG5D,KAAjBw1E,IAA4C,KAArBC,GAWxB,IARA,IAII0F,EAJY3F,GAAax1E,MAAM,KAAK,GAAGA,MAAM,KAAK,GAIN,IAFxBu1E,GAAkBv1E,MAAM,KAAK,GAKjDo7E,EAAe53B,GAAO,GAAGxjD,MAAM,KAC3BW,EAAI,EAAGA,EAAEy6E,EAAax6E,OAAQD,IAEpC,IAA+D,IAA5Dy6E,EAAaz6E,GAAG+hB,QAAQy4D,GAAuC,CAEhE,IAAIJ,EAAWK,EAAaz6E,GAAGX,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGA,MAAM,KAAK,GACtD,MAAb+6E,GACDvF,GAAe4F,EAAaz6E,GACzBg5E,KAAoBh5E,GACrBi5E,GAAmBj5E,IAKA,MAAbo6E,IACRtF,GAAmB2F,EAAaz6E,GAC7Bk5E,KAAmBl5E,GACpBm5E,GAAkBn5E,IAUzB44E,KAAez1B,GAChB01B,GAAc11B,GAMfA,GAAc,IAAMA,EAAa,KAClCwxB,GAAezxB,EAAOC,GACnBu1B,IAAev1B,GAChBw1B,EAAcx1B,SAMb,GAAiB,IAAdV,EAAiB,CAEzB,IAAI23B,EAAWl3B,EAAOC,GAAY9jD,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGA,MAAM,KAAK,GAOzE,GAAgB,MAAb+6E,EAAkB,CACnB,IAAIE,EAAWp3B,EAAOnhC,QAAQgC,OAAOm/B,EAAOC,GAAY9jD,MAAM,UAAU,GAAK,WAC7Ew1E,GAAe3xB,EAAOC,GACnB61B,KAAoB71B,GACrB81B,GAAmB91B,IAKJ,IAAdm3B,GACDxF,GAAmB5xB,EAAOo3B,GACvBpB,KAAmBoB,GACpBnB,GAAkBmB,KAMpBxF,GAAmB,GACnBqE,IAAmB,SAEhB,GAAgB,MAAbiB,EAAkB,CAC1B,IAAIM,EAAYx3B,EAAOnhC,QAAQgC,OAAOm/B,EAAOC,GAAY9jD,MAAM,UAAU,GAAK,WAC9Ey1E,GAAmB5xB,EAAOC,GACvB+1B,KAAmB/1B,GACpBg2B,GAAkBh2B,IAKF,IAAfu3B,GACD7F,GAAe3xB,EAAOw3B,GACnB1B,KAAoB0B,GACrBzB,GAAmByB,KAMrB7F,GAAe,GACfoE,IAAoB,UAeF,IAAdx2B,GACRsyB,GAAkB7xB,EAAOC,GACtBm1B,IAAiBn1B,GAClBo1B,EAAgBp1B,IAKI,IAAdV,IACRuyB,GAAgB9xB,EAAOC,GACpBq1B,IAAgBr1B,GACjBs1B,EAAet1B,IAvKrBsxB,GAAkBuD,EAgLlB,OAAuBznC,oBAAS,IAAhC,qBAAO7nB,GAAP,MAAYi6B,GAAZ,MAaA3U,sBAAU,WAXRpvB,MAAM,6CACH7L,MAAK,SAAC2M,GAAD,OAAcA,EAAS5I,UAC5B/D,MAAK,SAAC2M,GAAD,OAAcijC,GAAQjjC,QAW9B,IAmBF,IALA,IAAMkjC,GAA0B,GAC1BC,GAAyB,GAC3BC,GAAmB,GACnBC,GAAiBr6B,GAAKrpB,MAAM,KAEvBW,GAAE,EAAGA,GAAE+iD,GAAe9iD,OAAO,EAAGD,MAEoB,IAAtD4iD,GAAQ7gC,QAAQghC,GAAe/iD,IAAGX,MAAM,KAAK,UAAkD6P,IAApC6zC,GAAe/iD,IAAGX,MAAM,KAAK,IAC3FujD,GAAQprC,KAAKurC,GAAe/iD,IAAGX,MAAM,KAAK,IAI9C,IAAK,IAAI2jD,GAAE,EAAGA,GAAIJ,GAAQ3iD,OAAQ+iD,KAAK,CACrC,IAAK,IAAIhjD,GAAE,EAAGA,GAAE+iD,GAAe9iD,OAAO,EAAGD,KACtC4iD,GAAQI,MAAOD,GAAe/iD,IAAGX,MAAM,KAAK,KAC7CyjD,IAAYC,GAAe/iD,IAAM,KAKrC6iD,GAAOrrC,KAAKsrC,IACZA,GAAU,GAGV,IAAM02B,GAAsBrkC,cAAY,kBAAM9F,EAAM74B,YAAYjG,YAAY5C,gBAsF5E,IAAMs1C,GAAS,GACf,GAAGJ,GAAO5iD,OAAS,GAAKwiD,GAAa,EAEnC,IADA,IAAIS,GAASL,GAAOJ,GAAWpjD,MAAM,KADC,YAE7BW,GACP,GAAiB,IAAdyiD,GAOD,GAAImyB,GAAkBv1E,MAAM,KAAK,KAAO6jD,GAAOljD,GAAGX,MAAM,KAAK,IAAmC,MAA5B6jD,GAAOljD,GAAGX,MAAM,KAAK,GAAY,CAEnG,GAAgB,MADD6jD,GAAOljD,GAAGX,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGA,MAAM,KAAK,GAC3C,CAEnB,IAAIi7E,EAAWp3B,GAAOnhC,QAAQgC,OAAOm/B,GAAOljD,GAAGX,MAAM,UAAU,GAAK,WAEpE4jD,GAAOzrC,KAAK,uBAAKo3B,QAAW,WAAOwU,GAAWpjD,IAAlC,UAAuC,sBAAKkS,IAAKmxC,mBAAmBH,GAAOljD,IAAKulB,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWmH,aAAa,MAAO1X,QAAQ,MAAO4O,OAAOq3B,KAAoBh5E,EAAI,oBAAsB,uBAAmH5C,SAAS,WAAYmpB,IAAI,OAAQstB,WAAW,EAAOE,IAAI,KAU1a,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAO0sB,WAAW,MAAOj4B,QAAQ,EAAGw4B,SAAsB,IAAd8mC,EAAiB,QAAU,QAA7G,SAAsH,sBAAKpoE,KAAmB,IAAdooE,EAAkBv2D,OAAOm/B,GAAOljD,GAAGX,MAAM,UAAU,GAAK,UAAY,GAAIkmB,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,OAAQgB,IAAI,OAExS,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAO0sB,WAAW,MAAOj4B,QAAQ,EAAGw4B,QAAyB,KAAjBmhC,GAAqB,QAAU,QAAjH,SAA0H,sBAAKziE,IAAsB,KAAjByiE,GAAsB5wD,OAAO4wD,IAAgB,GAAIpvD,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,OAAQgB,IAAI,OAErR,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAO0sB,WAAW,MAAOj4B,OAAO,EAAGw4B,QAA4B,KAApBuhC,GAAwB,QAAU,QAAnH,SAA4H,sBAAK7iE,IAAyB,KAApB6iE,GAAyBhxD,OAAOgxD,IAAmB,GAAIxvD,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,MAAO31C,SAAS,WAAYmpB,IAAI,QAASwtB,IAAI,OAE9T,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAO0sB,WAAW,MAAOj4B,OAAO,EAAGw4B,QAA0B,KAAlBwhC,GAAsB,QAAU,QAAjH,SAA0H,sBAAK9iE,IAAuB,KAAlB8iE,GAAuBjxD,OAAOixD,IAAiB,GAAIzvD,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,OAAQgB,IAAI,OAKvR,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAO0sB,WAAW,MAAOj4B,QAAQ,EAAGw4B,QAA0B,KAAlBkhC,GAAsB,QAAU,QAAlH,SAA2H,sBAAKxiE,IAAuB,KAAlBwiE,GAAuB3wD,OAAO2wD,IAAiB,GAAInvD,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,OAAQgB,IAAI,YAhKlS,SAAsB/E,EAAS2rC,EAAkBC,GAC/C,GAAIA,GAAa5rC,EAAI/uC,OAEjB,IADA,IAAIsd,EAAIq9D,EAAY5rC,EAAI/uC,OAAS,EAC1Bsd,KACHyxB,EAAIx3B,UAAKtI,GAGjB8/B,EAAI13B,OAAOsjE,EAAW,EAAG5rC,EAAI13B,OAAO,EAAG,GAAG,IAmKpCujE,CAAa53B,GAAQ,EAAGA,GAAOhjD,cAEX,IAAdwiD,EACRQ,GAAOzrC,KAAK,uBAAKo3B,QAAW,WAAOwU,GAAWpjD,IAAlC,UAAuC,sBAAKkS,IAAKmxC,mBAAmBH,GAAOljD,IAAKulB,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,MAAO4O,OAAO22B,IAAiBt4E,EAAI,sBAAwB,uBAAwByqD,aAAa,MAAoCrtD,SAAS,WAAYmpB,IAAI,OAAQstB,WAAW,EAAOE,IAAI,KAc3W,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAO0sB,WAAW,MAAOj4B,OAAO,EAAGw4B,QAAyB,KAAjBqhC,GAAqB,QAAU,QAAhH,SAAyH,sBAAK3iE,IAAsB,KAAjB2iE,GAAsB9wD,OAAO8wD,IAAgB,GAAItvD,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,OAAQgB,IAAI,OAEpR,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAO0sB,WAAW,MAAOj4B,QAAQ,EAAGw4B,QAA6B,KAArBshC,GAAyB,QAAU,QAArH,SAA8H,sBAAK5iE,IAA0B,KAArB4iE,GAA0B/wD,OAAO+wD,IAAoB,GAAIvvD,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,OAAQgB,IAAI,OAEjS,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAO0sB,WAAW,MAAOj4B,QAAQ,EAAGw4B,QAAyB,KAAjBmhC,GAAqB,QAAU,QAAjH,SAA0H,sBAAKziE,IAAsB,KAAjByiE,GAAsB5wD,OAAO4wD,IAAgB,GAAIpvD,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,MAAO4O,OAAO22B,IAAiBt4E,EAAI,oBAAsB,uBAAwByqD,aAAa,MAAOrtD,SAAS,WAAYmpB,IAAI,OAAQf,KAAK,QAASuuB,IAAI,OAEja,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAO0sB,WAAW,MAAOj4B,OAAO,EAAGw4B,QAA0B,KAAlBwhC,GAAsB,QAAU,QAAjH,SAA0H,sBAAK9iE,IAAuB,KAAlB8iE,GAAuBjxD,OAAOixD,IAAiB,GAAIzvD,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,OAAQgB,IAAI,OAEvR,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAO0sB,WAAW,MAAOj4B,QAAQ,EAAGw4B,QAA0B,KAAlBkhC,GAAsB,QAAU,QAAlH,SAA2H,sBAAKxiE,IAAuB,KAAlBwiE,GAAuB3wD,OAAO2wD,IAAiB,GAAInvD,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,OAAQgB,IAAI,WAGlQ,IAAd0O,GACRQ,GAAOzrC,KAAK,uBAAKo3B,QAAW,WAAOwU,GAAWpjD,IAAlC,UAAuC,sBAAKkS,IAAKmxC,mBAAmBH,GAAOljD,IAAKulB,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,MAAO4O,OAAO62B,IAAgBx4E,EAAI,oBAAsB,uBAAwByqD,aAAa,MAAmCrtD,SAAS,WAAYmpB,IAAI,OAAQstB,WAAW,EAAOE,IAAI,KAYvW,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAO0sB,WAAW,MAAOj4B,OAAO,EAAGw4B,QAAyB,KAAjBqhC,GAAqB,QAAU,QAAhH,SAAyH,sBAAK3iE,IAAsB,KAAjB2iE,GAAsB9wD,OAAO8wD,IAAgB,GAAItvD,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,OAAQgB,IAAI,OAEpR,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAO0sB,WAAW,MAAOj4B,QAAQ,EAAGw4B,QAA6B,KAArBshC,GAAyB,QAAU,QAArH,SAA8H,sBAAK5iE,IAA0B,KAArB4iE,GAA0B/wD,OAAO+wD,IAAoB,GAAIvvD,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,OAAQgB,IAAI,OAEjS,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAO0sB,WAAW,MAAOj4B,QAAQ,EAAGw4B,QAAyB,KAAjBmhC,GAAqB,QAAU,QAAjH,SAA0H,sBAAKziE,IAAsB,KAAjByiE,GAAsB5wD,OAAO4wD,IAAgB,GAAIpvD,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,OAAQgB,IAAI,OAErR,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAO0sB,WAAW,MAAOj4B,OAAO,EAAGw4B,QAA4B,KAApBuhC,GAAwB,QAAU,QAAnH,SAA4H,sBAAK7iE,IAAyB,KAApB6iE,GAAyBhxD,OAAOgxD,IAAmB,GAAIxvD,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,MAAO31C,SAAS,WAAYmpB,IAAI,QAASwtB,IAAI,OAE9T,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAO0sB,WAAW,MAAOj4B,QAAQ,EAAGw4B,QAA0B,KAAlBkhC,GAAsB,QAAU,QAAlH,SAA2H,sBAAKxiE,IAAuB,KAAlBwiE,GAAuB3wD,OAAO2wD,IAAiB,GAAInvD,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,OAAQgB,IAAI,YA9FnR/zC,GAAW,EAAGA,GAAIkjD,GAAOjjD,OAAS,EAAGD,KAAM,GAA3CA,IAqGX,IAAM86E,GAAc,GACdC,GAAe,GACfC,GAAc,GACpB,GAAGn4B,GAAO5iD,OAAS,GAAKwiD,GAAa,EAEnC,IADA,IAAIS,GAASL,GAAOJ,GAAWpjD,MAAM,KADC,YAE7BW,IAE2B,IAA/BkjD,GAAOljD,GAAG+hB,QAAQ,SAEjB+4D,GAAYtjE,KAAK,sBAAKo3B,QAAW,WAAOwU,GAAWpjD,IAAlC,SAAuC,sBAAKkS,IAAKmxC,mBAAmBH,GAAOljD,IAAKulB,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,MAAO4O,OAAO+2B,IAAe14E,EAAI,oBAAsB,uBAAwByqD,aAAa,OAAqC5W,WAAW,EAAOE,IAAI,SAG7S,IAAhCmP,GAAOljD,GAAG+hB,QAAQ,WACa,IAA7BmhC,GAAOljD,GAAG+hB,QAAQ,OACnBg5D,GAAavjE,KAAK,sBAAKo3B,QAAW,WAAOwU,GAAWpjD,IAAlC,SAAuC,sBAAKkS,IAAKmxC,mBAAmBH,GAAOljD,IAAKulB,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,MAAO4O,OAAOm3B,KAAgB94E,EAAI,oBAAsB,uBAAwByqD,aAAa,OAAsC5W,WAAW,EAAOE,IAAI,SAGjT,IAA/BmP,GAAOljD,GAAG+hB,QAAQ,SACnBi5D,GAAYxjE,KAAK,sBAAKo3B,QAAW,WAAOwU,GAAWpjD,IAAlC,SAAuC,sBAAKkS,IAAKmxC,mBAAmBH,GAAOljD,IAAKulB,MAAO,CAACzrB,MAAM,OAAQ4nD,UAAU,OAAQ3nD,OAAO,OAAQupD,UAAU,UAAWvQ,QAAQ,MAAO4O,OAAOi3B,KAAe54E,EAAI,oBAAsB,uBAAwByqD,aAAa,OAAqC5W,WAAW,EAAOE,IAAI,SAbvU/zC,GAAW,EAAGA,GAAIkjD,GAAOjjD,OAAS,EAAGD,KAAM,GAA3CA,IAkBX,IAAMsP,GAAM+mC,kBAA0B,MAEtC,SAAS7lB,GAAK/H,GACZA,EAAG2lB,kBACH3lB,EAAG0lB,iBAGL,SAAS8sC,KACPvG,GAAgB,GAChBC,GAAe,GACfC,GAAoB,GACpBC,GAAe,GACfC,GAAmB,GACnBC,GAAkB,GAClBC,GAAgB,GAEhBqD,GAAY,GACZU,IAAgB,GAChBF,IAAe,GACfF,GAAe,GACfj2B,EAAa,GAEby2B,IAAmB,GACnBF,IAAoB,GACpBV,GAAiB,GACjBE,GAAgB,GAGlB,SAASyC,KAOmB,OAAtB9B,GAAU9yC,SAuBZ60C,KAAY/B,GAAU9yC,QAAS,CAAE80C,YAAY,IAAQroE,MAAK,SAASo4B,GACjE,IAAI1rB,EAAW,IAAIhB,SACnBgB,EAASf,OAAO,UAAWysB,EAAOkwC,aAClCz8D,MAAM,sBACJ,CACEC,OAAQ,OACRT,KAAMqB,IAGP1M,MAAK,SAAC2M,GAAD,OAAcA,EAAS5I,UAC5B/D,MAAK,SAAC2M,GAAD,OArvBY47D,EAqvBmB57D,OApvBxClJ,EAAYjG,YAAY9C,YAAc6tE,IACtB,IAAhB5C,IACHliE,EAAYjG,YAAY9C,UAAY6tE,EAEpC9kE,EAAYjG,YAAY5C,aAAe,CAACgnE,GAAcC,GAAmBF,GAAeG,GAAcE,GAAiBC,IACvHx+D,EAAYihB,kBACZjhB,EAAY67B,0BAAyB,GACrC4oC,OARF,IAA0BK,QAwvBrBtoE,OAAM,SAAClT,GACNod,QAAQC,IAAIrd,MAyBlB,SAASy7E,GAAqBjuD,EAAYnK,GACxC,OAAO/oB,KAAKgG,MAAMhG,KAAKsyC,UAAYvpB,EAAMmK,EAAM,GAAKA,GAyHtD,IAEMvQ,GAAOy+D,aACX,CACEC,YAAa,YAAoB,IAAlBpF,EAAiB,EAAjBA,QAASjB,EAAQ,EAARA,GAiCtB,GA/BAlwD,SAAS9G,KAAKsH,QACdsiD,EAAIsL,UAAW,EACftL,EAAIqL,WAAY,EAEhBkB,IAAc,EAEdvM,EAAIxc,UAAW,IAAI1zC,MAAO42C,aAC1BsZ,EAAI+L,MAAQ53E,EAAIklB,WAAW,GAC3B2mD,EAAIgM,MAAQ73E,EAAIklB,WAAW,GAdd,IAqCTg1D,GAAsC,IAAZA,EAAe,CAE3CrO,EAAIxc,UAAW,IAAI1zC,MAAO42C,aAC1BsZ,EAAIuL,SAAW6B,EAAG,GAClBpN,EAAIwL,SAAW4B,EAAG,GAIlB,IAR2C,EAQrC/mD,EAAU/C,MAAMnT,KAAKzC,EAAaG,OAAO9I,QAAQye,QAAO,SAAApqB,GAAG,OAAIA,IAAQsU,EAAaW,WAR/C,cASzBgY,EAAQskB,WATiB,IAS3C,2BAAqC,CAAC,IAAD,IAAzB3yC,EAAyB,0BAC/B2R,EAAUrS,OAAM,UAACoW,EAAaG,OAAO3d,IAAIm2B,EAAQruB,WAAjC,aAAC,EAAqCzC,KAAKH,SAAS,IACpEwU,EAAUtS,OAAM,UAACoW,EAAaG,OAAO3d,IAAIm2B,EAAQruB,WAAjC,aAAC,EAAqCzC,KAAKH,SAAS,IACpEs+E,EAASp8E,OAAOnD,EAAIklB,WAAW,IAC/Bs6D,EAASr8E,OAAOnD,EAAIklB,WAAW,IACnC,GAAGq6D,GAAW/pE,EAAQ,IAAO+pE,GAAW/pE,EAAQ,IAAOgqE,GAAW/pE,EAAQ,IAAO+pE,GAAW/pE,EAAQ,GAClG,QAfuC,8BAmB3C,IAAMgqE,EAAY/yD,YAAW,WAC3B+oB,aAAagqC,GAGb,IAAIC,EAAQ7T,EAAIuL,SAAWvL,EAAIqM,QAC3ByH,EAAQ9T,EAAIwL,SAAWxL,EAAIsM,QAI5BtM,EAAIqL,WAAuB,IAAVwI,GAAyB,IAAVC,IAEjC9T,EAAI6L,MAAQuB,EAAG,GACfpN,EAAI8L,MAAQsB,EAAG,GACfpN,EAAI2L,SAAWx3E,EAAIklB,WAAW,GAC9B2mD,EAAI4L,SAAWz3E,EAAIklB,WAAW,GAE9B82D,GAAY,MAEb,OAGPhD,OAAQ,YAAgC,EAA9B4G,KAA8B,EAAxBzvD,MAAyB,IAAlB8oD,EAAiB,EAAjBA,GAAiB,EAAbiB,QAEzBrO,EAAIqM,QAAUe,EAAG,GACjBpN,EAAIsM,QAAUc,EAAG,IAEnB4G,UAAW,YAAkB,IAAhBhuD,EAAe,EAAfA,MAAOonD,EAAQ,EAARA,GAClBpN,EAAIyL,OAAS2B,EAAG,GAChBpN,EAAI0L,OAAS0B,EAAG,GAChBpN,EAAIvc,QAAS,IAAI3zC,MAAO42C,aACxB,IAAIx5B,EAAW8yC,EAAIvc,OAASuc,EAAIxc,SAWhC,GAAIwc,EAAIyL,QAAWzL,EAAIuL,SAAS,IAAOvL,EAAIyL,QAAWzL,EAAIuL,SAAS,IAAQvL,EAAI0L,QAAW1L,EAAIwL,SAAS,IAAOxL,EAAI0L,QAAW1L,EAAIwL,SAAS,IAAmD,QAA1CzvD,OAAOjX,OAAM,OAACkhB,QAAD,IAACA,OAAD,EAACA,EAAOsmB,QAAQ2nC,UAAsB/mD,EAAW,EAAG,CAElN,IAFkN,EAE5M7G,EAAU/C,MAAMnT,KAAKzC,EAAaG,OAAO9I,QAAQye,QAAO,SAAApqB,GAAG,OAAIA,IAAQsU,EAAaW,WAFwH,cAGhMgY,EAAQskB,WAHwL,IAGlN,2BAAqC,CAAC,IAAD,IAAzB3yC,EAAyB,0BAC/B2R,EAAUrS,OAAM,UAACoW,EAAaG,OAAO3d,IAAIm2B,EAAQruB,WAAjC,aAAC,EAAqCzC,KAAKH,SAAS,IACpEwU,EAAUtS,OAAM,UAACoW,EAAaG,OAAO3d,IAAIm2B,EAAQruB,WAAjC,aAAC,EAAqCzC,KAAKH,SAAS,IACpEs+E,EAASp8E,OAAOnD,EAAIklB,WAAW,IAC/Bs6D,EAASr8E,OAAOnD,EAAIklB,WAAW,IACnC,GAAGq6D,GAAW/pE,EAAQ,IAAO+pE,GAAW/pE,EAAQ,IAAOgqE,GAAW/pE,EAAQ,IAAO+pE,GAAW/pE,EAAQ,GAClG,QAT8M,+BAapNo2D,EAAIsL,UAAW,EACftL,EAAIqL,WAAY,EAChBkB,IAAc,EACd4D,GAAY,IAGd+D,OAAO,YAAW,IAAT9G,EAAQ,EAARA,GACPpN,EAAI6L,MAAQuB,EAAG,GACfpN,EAAI8L,MAAQsB,EAAG,GACfj5E,EAAIy2C,SAASwiC,GACV8C,IACHxiE,EAAaI,MAAM9W,MAAM5B,SAAW0P,OAAO+D,OAAO,GAAI1U,EAAIklB,cAG5D24B,aAAa,SAACvxB,GACZu/C,EAAI6L,MAAQprD,EAAG0zD,QAAQ,GAAG3zB,QAC1Bwf,EAAI8L,MAAQrrD,EAAG0zD,QAAQ,GAAG1zB,QAC1B8rB,IAAc,EACdp4E,EAAIy2C,SAAS,CAACnqB,EAAG0zD,QAAQ,GAAG3zB,QAAS//B,EAAG0zD,QAAQ,GAAG1zB,UACnD/yC,EAAaI,MAAM9W,MAAM5B,SAAW0P,OAAO+D,OAAO,GAAI1U,EAAIklB,aAG5D41D,WAAW,SAACt7E,GAEV,IAAIygF,EAAezgF,EAAE0gF,eAAe,GAEhC9iF,EAAO2rB,SAASo3D,iBAAiBF,EAAa5zB,QAAS4zB,EAAa3zB,SAExEvrC,QAAQC,IAAR,OAAY5jB,QAAZ,IAAYA,OAAZ,EAAYA,EAAMgjF,SAAU,UAA5B,OAAuChjF,QAAvC,IAAuCA,OAAvC,EAAuCA,EAAM8b,IAEvB,SAAf,OAAJ9b,QAAI,IAAJA,OAAA,EAAAA,EAAMgjF,WAAmC,iBAAT,OAAJhjF,QAAI,IAAJA,OAAA,EAAAA,EAAM8b,IAGnCgkE,KAC2B,SAAf,OAAJ9/E,QAAI,IAAJA,OAAA,EAAAA,EAAMgjF,WAAmC,eAAT,OAAJhjF,QAAI,IAAJA,OAAA,EAAAA,EAAM8b,KAC1CikE,KAEF/E,IAAc,IAGlB,CACEiI,aAAa,CAACrG,SAAQ,KAO1B,OACE,8DAAK7mE,IAAKqmE,EAAKrhC,QAA4B2jC,GAAiBl7D,MAA5D,cACA,eAAC,GAAD,6BAAiBsyB,GAAjB,IAAwB/+B,SAAS,KAMjC,eAAC,GAAD,2BAAYrR,MAAM,EAAOk5C,UAAWL,EAAQiT,KAAM9S,UAAWvqC,GAAWuqE,GAAxE,IACE7+B,UAAa9pC,GACb6pC,YAAekgC,MACjB,eAAC,GAAD,CAAsBjqD,OAAQigB,EAAMjgB,OAAQjN,KAAM61D,EAAYhvD,MAv0BhE,WACE6uD,GAAc,GACd17E,EAAIqtC,cAAchwC,OAAO,2BAs0BvB49C,SAAU9nC,GAAIg3B,QAAS+Q,aAAc,CAACC,SAAS,MAAOC,WAAW,QACjEoX,gBAAkB,aAEpB,eAACpf,GAAA,EAAD,CAAQptB,KAAM+1D,EAAUz5C,QAAS,kBAAM05C,GAAY,IAAQ7vB,SAAU,kBAAM6vB,GAAY,IACnF5pB,aAAW,EACX7F,WAAY,CACVnjC,MAAO,CACLoR,gBAAiB,cACjBv5B,SAAS,WACTq/E,UAAW,OACX32B,SAAS,SACThsD,MAAO,IACPC,OAAQ,IACRyrB,KAAMlmB,OAAO0oE,EAAIuL,UAAY,IAC7BhtD,IAAKjnB,OAAO0oE,EAAIwL,UAAY,IAC5Bx4D,OAAQk9D,EAAW,KAAO,IAC1BvkC,UAAWl6C,IAAiB,aAAe,aAG/CijF,cAAe,CAAEC,WAAW,GAhBhC,SAkBI,eAACtuC,GAAA,EAAD,CAAe9oB,MAAO2yD,EAAW,CAACvkC,UAAU,aAAcN,WAAW,eAAiB,CAACM,UAAU,WAAYN,WAAW,eAAxH,SACA,eAAC2F,GAAA,EAAD,CAAMC,GAAIi/B,EAAU3yD,MAAO,CAAE8tB,WAAY6kC,EAAW,QAAU,OAA9D,SACE,uBAAK//B,UAAW+/B,EAAWpgC,EAAQ+6B,kBAAoB/6B,EAAQ86B,kBAA/D,UAEM,sBAAKz6B,UAAWL,EAAQi7B,SAAUrc,UAAW2iB,GAC3Cr/B,aAAcxpB,GADhB,SAEI,sBAAKnb,GAAG,cAAcnD,IAAKm8C,GAAUt0D,OAAQotC,GAAcrtC,MAAOqtC,GAAc5hB,MAAO,CAACouB,UAAU,cAAeI,IAAI,OAG3H,eAACuG,GAAA,EAAD,CAASC,UAAU,MAAM/oB,MAAO0mD,EAAW/2E,EAAE,oBAAsB,GAAnE,SACA,sBAAKg3C,UAAWL,EAAQk7B,WAAYtc,UAAW4iB,GAC3Ct/B,aAAcxpB,GADlB,SAEM,sBAAKnb,GAAG,YAAYnD,IEr5CzB,67HFq5C6CnY,OAAQotC,GAAcrtC,MAAOqtC,GAAc5hB,MAAO,CAACouB,UAAU,YAAaI,IAAI,SAG9H,sBAAKoE,UAAWL,EAAQg7B,wBAO9B,gBAACvjC,GAAA,EAAD,CAAQptB,KAAMi2D,EAAU35C,QAAS,kBAAMw8C,MAAyC3yB,SAAU,kBAAM2yB,MAAyCzrC,SAAS,KAAKC,WAAW,EAAMC,YAAY,EAClL6e,aAAW,EACX7F,WAAY,CACVnjC,MAAO,CACLk8B,SAAU,IACV9N,UAAWl6C,IAAiB,aAAe,aALjD,UASA,eAACk2C,GAAA,EAAD,CAAat6B,GAAG,sBAAsBu6B,mBAAmB,EAAMrqB,MAAO,CAAC+oB,SAAU70C,IAAiB,QAAU,QAASwoD,WAAW,QAAhI,SACG,wBACD,eAAC5T,GAAA,EAAD,UACE,uBAAK8J,UAAWL,EAAQwJ,cAAxB,UACA,uBAAKnJ,UAAWL,EAAQyJ,cAAxB,UACGqB,GAAQzmD,KAAI,SAACsnD,EAAO5gB,GACnB,OACE,sBAAKsV,UAAWsK,IAAc5f,EAAQiV,EAAQsK,cAAgBtK,EAAQkK,gBAAiBpT,QAAW,WA52B9F,GAEhB8T,EA02BgI7f,IAApH,SAA8H4gB,OAIpI,uBAAKl+B,MAAO,CAACnoB,SAAS,WAAYtD,MAAM,QAASC,OAAO,QAASy1C,SAAS,QAASyD,WAAW,QAAsC0D,UAAU,QAA9I,UACqB,KAAlB+9B,IAAyC,KAAjBC,GACzB,uBAAKrlE,IAAK8pE,GAAW7zD,MAAO,CAACnoB,SAAS,WAAYtD,MAAM,QAASC,OAAO,QAASy1C,SAAS,SAA1F,UACA,sBAAKjqB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAOf,KAAK,OAAlD,SACE,sBAAKD,MAAO,CAACiuB,QAA2B,KAAlBkhC,GAAuB,QAAU,QAASxiE,IAAKwiE,GAAe56E,MAAO,QAASC,OAAQ,QAAS85C,WAAW,EAAOE,IAAI,OAE7I,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAOf,KAAK,OAAlD,SACE,sBAAKD,MAAO,CAACiuB,QAA8B,KAArBshC,GAA0B,QAAU,QAAS5iE,IAAK4iE,GAAkBh7E,MAAO,QAASC,OAAQ,QAAS85C,WAAW,EAAOE,IAAI,OAEnJ,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAOf,KAAK,OAAlD,SACE,sBAAKD,MAAO,CAACiuB,QAA0B,KAAjBmhC,GAAsB,QAAU,QAASziE,IAAKyiE,GAAc76E,MAAO,QAASC,OAAQ,QAAU85C,WAAW,EAAOE,IAAI,OAE5I,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAOf,KAAK,OAAlD,SACE,sBAAKD,MAAO,CAACiuB,QAA0B,KAAjBqhC,GAAsB,QAAU,QAAS3iE,IAAK2iE,GAAc/6E,MAAO,QAASC,OAAQ,QAAU85C,WAAW,EAAME,IAAI,OAE3I,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,OAAQf,KAAK,OAAnD,SACE,sBAAKD,MAAO,CAACiuB,QAA6B,KAApBuhC,GAAyB,QAAU,QAAS7iE,IAAK6iE,GAAiBj7E,MAAO,QAASC,OAAQ,QAAS85C,WAAW,EAAOE,IAAI,OAEjJ,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAOf,KAAK,OAAlD,SACE,sBAAKD,MAAO,CAACiuB,QAA2B,KAAlBwhC,GAAuB,QAAU,QAAS9iE,IAAK8iE,GAAel7E,MAAO,QAASC,OAAQ,QAAS85C,WAAW,EAAOE,IAAI,UAI7I,+BACA,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAOf,KAAK,OAAlD,SACE,sBAAKD,MAAO,CAACoR,gBAAgBl2B,EAAUH,GAAMmqD,aAAc,OAAQv4C,IAAKm9B,EAAM74B,YAAYjG,YAAY9C,UAAW3T,MAAO,QAASC,OAAQ,QAAS85C,WAAW,EAAOE,IAAI,SAI5K,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,QAASf,KAAK,MAAO8oB,SAAS70C,IAAiB,MAAQ,MAAOwoD,WAAW,OAAQv0C,MAAM,UAAW5T,MAAM,OAAQw5C,UAAU,UAAhK,SACEjE,EAAM74B,YAAYjG,YAAYhD,aAIhC,gBAACm2C,GAAA,EAAD,WACe,IAAdjB,EACG,eAACpH,GAAA,EAAD,CAAU91B,MAAO,CAACk8B,SAAS,QAASC,UAAU,SAA9C,SACE,uBAAKvJ,UAAWL,EAAQ0J,YAAxB,UACE,sBAAKj8B,MAAO,CAACnoB,SAAS,WAAYu5C,UAAU,MAAO1D,WAAW,MAAO3E,SAAS70C,IAAiB,QAAU,QAASwoD,WAAW,OAAQv0C,MAAM,WAA3I,kBACA,sBAAKyqC,UAAWL,EAAQo7B,YAAxB,SACG4H,KAEH,sBAAKv1D,MAAO,CAACnoB,SAAS,WAAYu5C,UAAU,MAAO1D,WAAW,MAAO3E,SAAS70C,IAAiB,QAAU,QAASwoD,WAAW,OAAQv0C,MAAM,WAA3I,kBACA,sBAAKyqC,UAAWL,EAAQo7B,YAAxB,SACG8H,KAEH,sBAAKz1D,MAAO,CAACnoB,SAAS,WAAYu5C,UAAU,MAAO1D,WAAW,MAAO3E,SAAS70C,IAAiB,QAAU,QAASwoD,WAAW,OAAQv0C,MAAM,WAA3I,mBACA,sBAAKyqC,UAAWL,EAAQo7B,YAAxB,SACG6H,UAKL,eAAC1/B,GAAA,EAAD,CAAU91B,MAAO,CAACk8B,SAAS,QAASC,UAAU,SAA9C,SACF,sBAAKvJ,UAAWL,EAAQ0J,YAAxB,SACE,sBAAKrJ,UAAWL,EAAQ8J,QAAxB,SACGqB,SAIL,eAAC5H,GAAA,EAAD,CAAU91B,MAAO,CAACzrB,MAAM,QAAxB,SACA,gBAAC,KAAD,CAAkBu/C,MAAOA,GAAzB,UACA,eAAC9K,GAAA,EAAD,CACIC,QAAQ,YAERjpB,MAAO,CAAC+oB,SAAU70C,IAAiB,QAAU,MAAOk9B,gBAAgB,SAAUv5B,SAAS,WAAY61C,WAAWx5C,IAAiB,SAAW,QAC1Im1C,QAAS,WACPqsC,MALN,oBAUE,eAAC1sC,GAAA,EAAD,CACEC,QAAQ,YACR9gC,MAAM,UACN6X,MAAO,CAAC+oB,SAAU70C,IAAiB,QAAU,MAAO2D,SAAS,WAAY61C,WAAY,QACrFrE,QAAS,YA1azB,WAIE,IAAI2qC,EAAgBgC,GAAqB,GAAI,IACzC9B,EAAqB8B,GAAqB,EAAG,IAC7Cr4B,EAASL,GAAO,GAAGxjD,MAAM,KAgB1Bo6E,GAAsB,GAAKA,EAAqB,KACjD7E,GAAoB1xB,EAAOu2B,GAAoBp6E,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGA,MAAM,OAAO,GACrFu5E,KAAea,GAChBZ,GAAcY,IAGfF,GAAiB,IAAMA,EAAgB,KACxC5E,GAAezxB,EAAOq2B,GACnBb,IAAea,GAChBZ,EAAcY,IAMlB,IAAIqD,EAAa/5B,GAAO,GAAGxjD,MAAM,KAC7B26E,EAA6B,GAC7BC,EAAiC,GACjCC,EAA4B,GAC5BC,EAAgC,GACpCH,EAAW1iE,OAAO,GAClB2iE,EAAe3iE,OAAO,GACtB4iE,EAAU5iE,OAAO,GACjB6iE,EAAc7iE,OAAO,GACrB,IAAK,IAAItX,EAAW,EAAGA,EAAI48E,EAAW38E,OAAS,EAAGD,IAM9C,IAAgG,IAA7F48E,EAAW76D,QAAQ6yD,GAAkBv1E,MAAM,KAAK,GAAK,IAAMu9E,EAAW58E,GAAGX,MAAM,KAAK,KACnFu1E,GAAkBv1E,MAAM,KAAK,KAAOu9E,EAAW58E,GAAGX,MAAM,KAAK,GAAK,CACpE,IAAI+6E,EAAWwC,EAAW58E,GAAGX,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGA,MAAM,KAAK,GACpD,MAAb+6E,GACDJ,EAAWxiE,KAAKolE,EAAW58E,IAC3Bi6E,EAAeziE,KAAKxX,IACC,MAAbo6E,IACRF,EAAU1iE,KAAKolE,EAAW58E,IAC1Bm6E,EAAc3iE,KAAKxX,IAK3B,GAAGg6E,EAAW/5E,OAAS,EAAG,CACxB,IAAI48E,EAAqBtB,GAAqB,EAAGvB,EAAW/5E,OAAO,GACnE40E,GAAemF,EAAW6C,GAE1B5D,GAAmBgB,EAAe4C,IAElC,IAAIvC,EAAWsC,EAAW76D,QAAQgC,OAAOi2D,EAAW6C,GAAoBx9E,MAAM,UAAU,GAAK,YAG5E,IAAdi7E,GACDxF,GAAmB8H,EAAWtC,GAC3BpB,KAAmBoB,EACpBnB,GAAkBmB,IAElBxF,GAAmB,GACnBqE,IAAmB,MAGrBrE,GAAmB,GACnBqE,IAAmB,SAIrBtE,GAAe,GACfoE,IAAoB,GAEpBnE,GAAmB,GACnBqE,IAAmB,GAYrB,IAAI2D,EAAej6B,GAAO,GAAGxjD,MAAM,KAC/B09E,EAAkBxB,GAAqB,EAAGuB,EAAa78E,OAAO,GAClE80E,GAAkB+H,EAAaC,GAC/BxE,EAAgBwE,GAGhB,IAAIC,EAAcn6B,GAAO,GAAGxjD,MAAM,KAC9B49E,EAAiB1B,GAAqB,EAAGyB,EAAY/8E,OAAO,GAChE+0E,GAAgBgI,EAAYC,GAC5BxE,EAAewE,GA0TCC,IALJ,6BAUA,eAAC3uC,GAAA,EAAD,CACEC,QAAQ,YAERjpB,MAAO,CAAC+oB,SAAU70C,IAAiB,QAAU,MAAOk9B,gBAAgB,SAAUv5B,SAAS,WAAY61C,WAAY,QAC/GrE,QAAS,WACPssC,MALJ,gDAqBHiC,GAAyB,SAAC9tC,GAAD,OACpCwG,KAAM+a,SAAQ,kBAAM,eAAC,GAAD,gBAAsBvhB,MAE1C,CAACA,EAAMnxC,KAAMmxC,EAAM74B,YAAYjG,YAAY9C,UACzC4hC,EAAM74B,YAAYjG,YAAY7C,MAC9B2hC,EAAM74B,YAAYjG,YAAYhD,KAC9B8hC,EAAM74B,YAAYjG,YAAYxP,aAEhCo8E,GAAuBtuC,YAAc,4BG5gDhC,IAAMuuC,GAA8D,SAAC/tC,GAAuC,IAAD,IAC1G5W,EAAW4W,EAAMjgB,OAAOqJ,SAC9B,EAAwBod,KAAMtF,SAAiB,IAA/C,mBAAO8sC,EAAP,KAAaC,EAAb,KACA,EAA0BznC,KAAMtF,SAAiB,IAAjD,mBAAOp6B,EAAP,KAAconE,EAAd,KAsBA,SAASxX,EAAYt9C,EAAW/D,GAG9B2qB,EAAMrmB,QAGR,IAAM46C,EAAe92D,OAAO+D,OAAO,GAAIw+B,UAC/Bu0B,EAAqD56C,MAC7D,IAAMjS,EAAMs4B,EAAM74B,YAAc64B,EAAM74B,YAAYnB,GAAK,GAEvD,OAAO,gBAAC8hC,GAAA,EAAD,6BAAaysB,GAAb,IAA2BnlC,QAASsnC,EAApC,UACL,gBAACp2B,GAAA,EAAD,qBACGN,EAAM74B,mBADT,aACG,EAAmBjG,YAAYhD,KAChC,uBAAMgY,MAAO,CAAC2oC,MAAM,SAApB,SACE,eAAC,GAAD,CAAqB/rC,KAAMktB,EAAMltB,KAAMoI,KAAM2Y,GAAsB5R,GAAW8Q,YAAYlqC,IAAI6e,WAElG,gBAACs3B,GAAA,EAAD,WACE,eAAC0B,GAAA,EAAD,CAAKE,GAAI,EAAT,SACA,eAAC1B,GAAA,EAAD,CAAQC,QAAQ,YAAYjpB,MAAO,CAACkpB,cAAc,QAC9CG,QAAS,WAAK,IAAD,EACXm3B,IACA,UAAA12B,EAAM74B,mBAAN,SAAmBgnE,QAHzB,SAIQr8E,GAAE,cAEV,eAAC4uC,GAAA,EAAD,CAAKE,GAAI,EAAT,SACA,eAAC1B,GAAA,EAAD,CAAQC,QAAQ,YAAYjpB,MAAO,CAACkpB,cAAc,QAChDG,QAAS,WACFS,EAAM74B,cACPd,GAAaykB,WAAWjI,IAAImd,EAAM74B,YAAYnB,IAChDK,GAAaykB,WAAW3gC,OAAO61C,EAAM74B,YAAYnB,IAEjDK,GAAaykB,WAAW1I,IAAI4d,EAAM74B,YAAYnB,IAEhD0wD,MARJ,SAUK12B,EAAM74B,aAAed,GAAaykB,WAAWjI,IAAImd,EAAM74B,YAAYnB,IAClElU,GAAE,kBAAoBA,GAAE,0BAE9B,eAAC4uC,GAAA,EAAD,CAAKE,GAAI,EAAT,SACA,eAAC1B,GAAA,EAAD,CAAQC,QAAQ,YAAYjpB,MAAO,CAACkpB,cAAc,QAChDG,QAAS,WACFS,EAAM74B,cACXY,GAAKq7C,OAASpjB,EAAM74B,YAAYnB,GAChC0wD,MAJJ,SAMK5kE,GAAE,WAAY,CAACoM,KAAI,UAAE8hC,EAAM74B,mBAAR,aAAE,EAAmBjG,YAAYhD,WAEzD,eAACwiC,GAAA,EAAD,CAAKE,GAAI,EAAT,SACA,eAAC1B,GAAA,EAAD,CAAQC,QAAQ,YAAYjpB,MAAO,CAACkpB,cAAc,QAClDG,QAAS,WACFS,EAAM74B,aACX64B,EAAMjgB,OAAOjzB,IAAI02C,QAAQxD,EAAM74B,cAHjC,SAIIrV,GAAE,eAEJs3B,EAASgd,aAAe,uCACtB,gBAAC1F,GAAA,EAAD,CAAKE,GAAI,EAAT,4DAEE,eAACyG,GAAA,EAAD,CAAWlB,MAAM,OAAOr+B,KAAK,OAAOoO,MAAO,CAACoxB,WAAW,IACrDvxB,MAAOi4D,EAAMhpC,SAAU,SAAC5rB,GAAM60D,EAAQ70D,EAAGouB,cAAczxB,QAAS0xB,WA/E5E,SAAwBruB,GACtB,GAAe,UAAXA,EAAGrnB,KAA4B,SAATi8E,EAAiB,CACzC,IAAKhuC,EAAM74B,YAAe,OAE1BqS,YAAW,WAAKyI,GAAW0S,eAAehM,YACxC3d,GAAYjB,KAAM,2BAA4Bi2B,EAAM74B,YAAanB,MAAM,KACzEg6B,EAAMrmB,eA4EF,gBAAC+mB,GAAA,EAAD,CAAKE,GAAI,EAAT,8CAEE,eAACyG,GAAA,EAAD,CAAWlB,MAAM,QAAQr+B,KAAK,OAAOoO,MAAO,CAACoxB,WAAW,IACtDvxB,MAAOjP,EAAOk+B,SAAU,SAAC5rB,GAAM80D,EAAS90D,EAAGouB,cAAczxB,QAAS0xB,WA5E9E,SAAyBruB,GACvB,GAAe,UAAXA,EAAGrnB,KAA6B,UAAV+U,EAAmB,CAC3C,IAAKk5B,EAAM74B,YAAe,OAC1B,IAAMinE,EAA0B,GAChC9rD,GAASC,IAAIr1B,SAAQ,SAAA9B,GAAM,IAAD,EACpBA,EAAEslB,aAAF,UAAgBsvB,EAAM74B,mBAAtB,aAAgB,EAAmBjG,YAAYhD,OAAMkwE,EAAejmE,KAAK/c,EAAE4a,OAEjFooE,EAAelhF,SAAQ,SAAAyzB,GAAG,OAAI2B,GAASmT,cAAc9U,MAErDqf,EAAMrmB,0BC5CG,4oDCgDTyuB,GAAYC,aAAW,CAC3BqT,KAAM,SAAC1b,GAAD,MAAwB,CAC5BjyC,SAAU,WACVtD,MAAoB,GAAbu1C,EAAMnxC,KACbnE,OAAqB,GAAbs1C,EAAMnxC,KACdsnB,KAAM6pB,EAAMjyC,SAAS,GAAkB,GAAbiyC,EAAMnxC,KAChCqoB,IAAK8oB,EAAMjyC,SAAS,GAAkB,GAAbiyC,EAAMnxC,KAC/B6iB,QAAS,MAEX6xD,kBAAmB,SAACvjC,GAAD,MAAuB,CACxCmE,QAAS,OACTp2C,SAAU,WACVtD,MAAO,IACPC,OAAQ,IACR+rD,SAAU,SACVlS,WAAY,OACZic,SAAU,OACVhpC,OAAQ,OAER8P,gBAAiB,cACjB0c,WAAY,cACZ8O,OAAQ,YAEV0wB,kBAAmB,SAACxjC,GAAD,MAAuB,CACxCmE,QAAS,OACTp2C,SAAU,WACVtD,MAAO,IACPC,OAAQ,IACR+rD,SAAU,SACVlS,WAAY,OACZic,SAAU,OAGVtpC,IAAK,EACLf,KAAM,EACNqB,OAAQ,OAER8P,gBAAiB,cACjB0c,WAAY,gBACZ8G,gBAAiB,OACjBgI,OAAQ,YAGV2wB,aAAc,SAACzjC,GAAD,MAAwB,CACpCjyC,SAAU,WACVtD,MAAM,IACNC,OAAO,IACPq2D,YAAY,EACZD,YAAa,QACbE,YAAY,UACZ5F,aAAa,MACb1pC,QAAS,GACTwF,IAAK,GACLf,KAAM,GACN2pC,WAAY,+DACZn0C,QAAS,OAGX0iE,SAAU,SAACruC,GAAD,qBACRmE,QAAS,QACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,GACLf,KAAM,GACNsqC,WAAY,MACZ3N,OAAQ,UACRgN,WAAY,UACZpuC,QAAS,IACNwpC,KAGLozB,cAAe,SAACtuC,GAAD,qBACbmE,QAAS,QACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,GACLf,KAAM,GACNsqC,WAAY,MACZ3N,OAAQ,UAERgN,WAAYz5C,GAAaykB,WAAWj8B,KAAO,UAAY,WAEpDwX,GAAaykB,WAAWj8B,KAAO,EAAI0/E,GAAoBrzB,KAG5DszB,SAAU,SAACxuC,GAAD,qBACRmE,QAAS,QACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,GACLf,KAAM,IACNsqC,WAAY,MACZ3N,OAAQ,UACRgN,WAAY,WACT5E,KAGLuzB,UAAW,SAACzuC,GAAD,qBACTmE,QAAS,QACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,GACLf,KAAM,IACNsqC,WAAY,MACZ3N,OAAQ,UACRgN,WAAY,WACT5E,KAGLwzB,SAAU,SAAC1uC,GAAD,qBACRmE,QAAS,QACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,GACLf,KAAK,IACLsqC,WAAY,MACZ3N,OAAQ,UACRgN,WAAY,WACT5E,OAIDA,GAAc,CAClB,IAAK,CACHC,OAAQ,MACRC,aAAc,MACd3wD,MAAO,OACPC,OAAQ,OACRg5C,QAAS,OAGX,UAAW,CACTpc,gBAAiB,QACjB6zB,OAAQ,MACRzX,QAAS,MACT0X,aAAc,OAEhB,WAAY,CACVD,OAAQ,MACRzX,QAAS,MACT0X,aAAc,QAIZmzB,GAAoB,CACxB,IAAK,CACHpzB,OAAQ,MACRC,aAAc,MACd3wD,MAAO,OACPC,OAAQ,OACRg5C,QAAS,OAOX,UAAW,CACTpc,gBAAiB,UACjB6zB,OAAQ,MACRzX,QAAS,MACT0X,aAAc,OAEhB,WAAY,CAEVD,OAAQ,MACRzX,QAAS,MACT0X,aAAc,QAIZuzB,G,mDACJ5K,qBAAsB,E,KACtBC,WAAY,E,KACZC,UAAW,E,KAGX7nB,OAAS,E,KACTD,SAAW,E,KACX+nB,SAAW,E,KACXC,SAAW,E,KACXC,OAAS,E,KACTC,OAAS,E,KACTC,SAAW,E,KACXC,SAAW,E,KACXC,MAAQ,E,KACRC,MAAQ,E,KACRC,MAAQ,E,KACRC,MAAQ,E,KAERC,YAAc,G,KACdC,UAAY,E,KACZC,YAAa,E,KACb3iE,MAAQ,E,KACRC,MAAQ,E,KACR2iE,YAAc,E,KAGdC,QAAU,E,KACVC,QAAU,KAYZ,IAAI2J,IAAuB,EACpB,SAASC,KACd,OAAOD,GAGF,IAAMxoE,GAAgD,SAAC45B,GAC5D,IAAMqJ,EAAS7C,KAAMQ,OAAgC,IAA+B/P,QACpF,EAAgCuP,KAAMtF,UAAS,GAA/C,mBAAO4tC,EAAP,KACMlG,EAAcz/B,GADpB,KACmDE,GACnD,EAAgC7C,KAAMtF,UAAS,GAA/C,mBAAO6tC,EAAP,KAAiBC,EAAjB,KACA,EAAgBhvC,EAAM74B,YAAYqB,WAA3BnK,EAAP,oBAKMs6D,EADS3xB,kBAAqB,IAAI2nC,IACrB13C,QACnB,EAAgCuP,KAAMtF,UAAS,GAA/C,mBAAO2nC,EAAP,KAAiBC,EAAjB,KAKMh8E,EAAMkzC,EAAMjgB,OAAOjzB,IAOnB47E,EAAa5iC,cAAY,iBAAO,CACpC/3C,SAAUiyC,EAAM74B,YAAYjZ,KAAKH,SACjCc,KAAMmxC,EAAMnxC,SAER45C,EAAUL,GAAUsgC,GAEnB52E,EAAKI,KAALJ,EAmBP,IAAMi4C,EAAUvD,KAAMQ,OAA0B,MAEhD,SAAS7lB,EAAK/H,GACZA,EAAG2lB,kBACH3lB,EAAG0lB,iBAIL,IAEMpxB,EAAOy+D,aACX,CACEC,YAAa,YAAoB,IAAlBpF,EAAiB,EAAjBA,QAASjB,EAAQ,EAARA,GAEtBlwD,SAAS9G,KAAKsH,QACdsiD,EAAIsL,UAAW,EACftL,EAAIqL,WAAY,EAEhB4K,IAAe,EAEfjW,EAAIxc,UAAW,IAAI1zC,MAAO42C,aAC1BsZ,EAAI+L,MAAQ53E,EAAIklB,WAAW,GAC3B2mD,EAAIgM,MAAQ73E,EAAIklB,WAAW,GAG3B,IAAIi9D,EAAaC,KACbC,EAAaC,KAGbC,EAAwBh3B,KAG5B,IADmCi3B,OAEhCD,IAKAF,IA9BU,IAkCTnI,GAAsC,IAAZA,GAAe,CAE3CrO,EAAIxc,UAAW,IAAI1zC,MAAO42C,aAC1BsZ,EAAIuL,SAAW6B,EAAG,GAClBpN,EAAIwL,SAAW4B,EAAG,GAelB,IAAMwG,EAAY/yD,YAAW,WAE3B,GADA+oB,aAAagqC,IACV0C,EAAH,CAEA,IAAIzC,EAAQ7T,EAAIuL,SAAWvL,EAAIqM,QAC3ByH,EAAQ9T,EAAIwL,SAAWxL,EAAIsM,QAI5BtM,EAAIqL,WAAuB,IAAVwI,GAAyB,IAAVC,IAEjC9T,EAAI6L,MAAQuB,EAAG,GACfpN,EAAI8L,MAAQsB,EAAG,GACfpN,EAAI2L,SAAWx3E,EAAIklB,WAAW,GAC9B2mD,EAAI4L,SAAWz3E,EAAIklB,WAAW,GAE9B82D,GAAY,OAEb,OAGPhD,OAAQ,YAAgC,EAA9B4G,KAA8B,EAAxBzvD,MAAyB,IAAlB8oD,EAAiB,EAAjBA,GAAiB,EAAbiB,QAEzBrO,EAAIqM,QAAUe,EAAG,GACjBpN,EAAIsM,QAAUc,EAAG,IAEnB4G,UAAW,YAAiB,EAAfhuD,MAAgB,IAATonD,EAAQ,EAARA,GAClBpN,EAAIyL,OAAS2B,EAAG,GAChBpN,EAAI0L,OAAS0B,EAAG,GAChBpN,EAAIvc,QAAS,IAAI3zC,MAAO42C,aACTsZ,EAAIvc,OAASuc,EAAIxc,SAAhC,IAEIkzB,EAAwBh3B,KAGOi3B,MAGhCD,IAqBH1W,EAAIsL,UAAW,EACftL,EAAIqL,WAAY,EAChB4K,IAAe,EACf9F,GAAY,KAGd+D,OAAO,YAAW,IAAT9G,EAAQ,EAARA,GACPpN,EAAI6L,MAAQuB,EAAG,GACfpN,EAAI8L,MAAQsB,EAAG,GACfj5E,EAAIy2C,SAASwiC,GACV8C,IACHxiE,GAAaI,MAAM9W,MAAM5B,SAAW0P,OAAO+D,OAAO,GAAI1U,EAAIklB,cAG5D24B,aAAa,SAACvxB,GACZu/C,EAAI6L,MAAQprD,EAAG0zD,QAAQ,GAAG3zB,QAC1Bwf,EAAI8L,MAAQrrD,EAAG0zD,QAAQ,GAAG1zB,QAC1Bw1B,IAAe,EACf9hF,EAAIy2C,SAAS,CAACnqB,EAAG0zD,QAAQ,GAAG3zB,QAAS//B,EAAG0zD,QAAQ,GAAG1zB,UACnD/yC,GAAaI,MAAM9W,MAAM5B,SAAW0P,OAAO+D,OAAO,GAAI1U,EAAIklB,aAG5D41D,WAAW,SAACt7E,GAEV,IAAIygF,EAAezgF,EAAE0gF,eAAe,GAEhC9iF,EAAO2rB,SAASo3D,iBAAiBF,EAAa5zB,QAAS4zB,EAAa3zB,SAClD,SAAf,OAAJlvD,QAAI,IAAJA,OAAA,EAAAA,EAAMgjF,WAAmC,gBAAT,OAAJhjF,QAAI,IAAJA,OAAA,EAAAA,EAAM8b,KAEnC8iE,GAAY,GAEd8F,IAAe,IAGnB,CACEzB,aAAa,CAACrG,SAAQ,KAgC1B,OACE,gEAAS8B,GAAiBl7D,KAA1B,cAKE,eAAC,GAAD,6BAAiBsyB,GAAjB,IAAwB/+B,SAAS,KACjC,eAAC,GAAD,2BAAYrR,KAAMk/E,EAAUhmC,UAAWL,EAAQiT,KAAM9S,UAAWvqC,GAAWuqE,GAA3E,IACA7+B,UAAWA,EACXD,YAAe,SAAC1wB,GACdA,EAAG2lB,kBAxMPiB,EAAMjgB,OAAOjzB,IAAIqtC,cAAc/X,IAAI,cACnC4sD,GAAY,OA0MV,eAAC,GAAD,CAAuBl8D,KAAMi8D,EAAUp1D,MAhN3C,WACEqmB,EAAMjgB,OAAOjzB,IAAIqtC,cAAchwC,OAAO,cACtC6kF,GAAY,IA8M6CjvD,OAAQigB,EAAMjgB,OACnE5Y,YAAa64B,EAAM74B,YACnB4gC,SAAUgC,EAAU9S,QAAS+Q,aAAc,CAACC,SAAS,MAAOC,WAAW,QACvEoX,gBAAkB,aAGpB,eAACpf,GAAA,EAAD,CAAQptB,KAAM+1D,EAAUz5C,QAAS,kBAAM05C,GAAY,IAAQ7vB,SAAU,kBAAM6vB,GAAY,IACrF5pB,aAAW,EACX7F,WAAY,CACVnjC,MAAO,CACLoR,gBAAiB,cACjBv5B,SAAS,WACTq/E,UAAW,OACX32B,SAAS,SACThsD,MAAO,IACPC,OAAQ,IACRyrB,KAAMlmB,OAAO0oE,EAAIuL,UAAY,IAC7BhtD,IAAKjnB,OAAO0oE,EAAIwL,UAAY,IAC5Bx4D,OAAQk9D,EAAW,KAAO,IAC1BvkC,UAAWl6C,IAAiB,aAAe,aAG/CijF,cAAe,CAAEC,WAAW,GAhB9B,SAkBE,eAACtuC,GAAA,EAAD,CAAe9oB,MAAO2yD,EAAW,CAACvkC,UAAU,aAAcN,WAAW,eAAiB,CAACM,UAAU,WAAYN,WAAW,eAAxH,SACE,eAAC2F,GAAA,EAAD,CAAMC,GAAIi/B,EAAU3yD,MAAO,CAAE8tB,WAAY6kC,EAAW,QAAU,OAA9D,SACE,uBAAK//B,UAAW+/B,EAAWpgC,EAAQ+6B,kBAAoB/6B,EAAQ86B,kBAA/D,UACA,eAACt4B,GAAA,EAAD,CAASC,UAAU,OAAO/oB,MAAO0mD,EAAW/2E,EAAE,UAAY,GAA1D,SACI,sBAAKg3C,UAAWL,EAAQ4lC,SACtB1jC,aAAcxpB,EADhB,SAEI,sBAAKnb,GAAG,SAASnD,ICniBtB,69CDmiBqCnY,OAAQotC,GAAcrtC,MAAOqtC,GAAc5hB,MAAO,CAACouB,UAAU,cAAeI,IAAI,SAGtH,eAACuG,GAAA,EAAD,CAASC,UAAU,OAAO/oB,MAAO0mD,EAAW/2E,EAAE,sBAAwB,GAAtE,SACA,sBAAKg3C,UAAWL,EAAQ6lC,cAAejnB,UA1EnD,SAA4BjuC,GACrB4mB,EAAM74B,cACPd,GAAaykB,WAAWjI,IAAImd,EAAM74B,YAAYnB,IAChDK,GAAaykB,WAAW3gC,OAAO61C,EAAM74B,YAAYnB,IAEjDK,GAAaykB,WAAW1I,IAAI4d,EAAM74B,YAAYnB,MAsElC2kC,aAAcxpB,EADlB,SAEM,sBAAKnb,GAAG,YAAYnD,IEziBzB,ioEFyiB6CnY,OAAQotC,GAAcrtC,MAAOqtC,GAAc5hB,MAAO,CAACouB,UAAU,cAAeI,IAAI,SAG9H,eAACuG,GAAA,EAAD,CAASC,UAAU,MAAM/oB,MAAO0mD,EAAW/2E,EAAE,YAAc,GAA3D,SACA,sBAAKg3C,UAAWL,EAAQ+lC,SAAUnnB,UA3D9C,SAAsBjuC,GACf4mB,EAAM74B,cACXY,GAAKq7C,OAASpjB,EAAM74B,YAAYnB,KA0DlB2kC,aAAcxpB,EADlB,SAEM,sBAAKnb,GAAG,YAAYnD,IAAK0sE,GAAU7kF,OAAQotC,GAAcrtC,MAAOqtC,GAAc5hB,MAAO,CAACouB,UAAU,cAAeI,IAAI,SAGzH,eAACuG,GAAA,EAAD,CAASC,UAAU,QAAQ/oB,MAAO0mD,EAAW/2E,EAAE,WAAa,GAA5D,SACA,sBAAKg3C,UAAWL,EAAQgmC,UAAWpnB,UA7E/C,SAAuBjuC,GAChB4mB,EAAM74B,aACX64B,EAAMjgB,OAAOjzB,IAAI02C,QAAQxD,EAAM74B,cA4EjBwjC,aAAcxpB,EADlB,SAEM,sBAAKnb,GAAG,YAAYnD,IGrjBzB,ihCHqjByCnY,OAAQotC,GAAcrtC,MAAOqtC,GAAc5hB,MAAO,CAACouB,UAAU,cAAeI,IAAI,SAG1H,eAACuG,GAAA,EAAD,CAASC,UAAU,QAAQ/oB,MAAO0mD,EAAW/2E,EAAE,UAAY,GAA3D,SACA,sBAAKg3C,UAAWL,EAAQimC,SAAUrnB,UA9E9C,SAAoBjuC,GACb4mB,EAAM74B,aAEXqS,YAAW,WAAKyI,GAAW0S,eAAehM,YACxC3d,GAAYjB,KAAM,kBAAmBi2B,EAAM74B,YAAanB,MAAM,MA2ElD2kC,aAAcxpB,EADlB,SAEM,sBAAKnb,GAAG,YAAYnD,IAAK2sE,GAAU9kF,OAAQotC,GAAcrtC,MAAOqtC,GAAc5hB,MAAO,CAACouB,UAAU,cAAeI,IAAI,SAG3H,sBAAKoE,UAAWL,EAAQg7B,6BIpiBpC,SAASgM,GAAWC,EAAsBn1C,GACxC,IAAMo1C,EAAcD,EAAen1C,EAEnC,OAAIo1C,EAAc11C,GACTA,GAAuBy1C,EAG5BC,EAAc11C,GACTA,GAAuBy1C,EAGzBn1C,EAST,IAAM6N,GAAYC,aAAW,CAC3BC,KAAM,CACJv6C,SAAU,WACVtD,MAAO,OACPC,OAAQ,OACRwsB,IAAK,EACLf,KAAM,EACNqqC,SAAU,OACVjc,WAAY,OACZkS,SAAU,UAEZ/qD,OAAO,CACLqC,SAAU,WACVotD,OAAQ,OACRhlC,KAAK,EAAG+tB,MAAM,EAAGhtB,IAAI,EAAGM,OAAO,EAC/B/sB,MAAM,EAAGC,OAAO,GAElB45C,UAAW,SAACtE,GAAD,MAAwB,CACjCjyC,SAAU,WACVtD,MAAM,EAAGC,OAAO,EAChB45C,UAAWtE,EAAMl1C,OAAOwG,aAE1BiyE,kBAAmB,SAACvjC,GAAD,MAAuB,CACxCmE,QAAS,OACTp2C,SAAU,WACVtD,MAAO,IACPC,OAAQ,IACR+rD,SAAU,SACVlS,WAAY,OACZic,SAAU,OAGVhpC,OAAQ,OACR8sB,UAAW,WACXhd,gBAAiB,cACjB0c,WAAY,cACZ8O,OAAQ,YAEV0wB,kBAAmB,SAACxjC,GAAD,MAAuB,CACxCmE,QAAS,OACTp2C,SAAU,WACVtD,MAAO,IACPC,OAAQ,IACR+rD,SAAU,SACVlS,WAAY,OACZic,SAAU,OACVtpC,IAAM8oB,EAAM24B,IAAI8L,MAAS,IACzBtuD,KAAM/rB,IAAkB41C,EAAM24B,IAAI6L,MAAS,IAAOxkC,EAAM24B,IAAI6L,MAAS,IACrEhtD,OAAQ,OACR8sB,UAAWl6C,IAAiB,aAAe,aAC3Ck9B,gBAAiB,cACjB0c,WAAY,gBACZ8G,gBAAiB,OACjBgI,OAAQ,YAGV2wB,aAAc,SAACzjC,GAAD,MAAwB,CACpCjyC,SAAU,WACVtD,MAAM,IACNC,OAAO,IACPq2D,YAAY,EACZD,YAAa,QACbE,YAAY,UACZ5F,aAAa,MACb1pC,QAAS,GAGTwF,IAAK,GACLf,KAAM,GACN2pC,WAAY,+DACZn0C,QAAS,OAGXikE,WAAY,SAAC5vC,GAAD,qBACRmE,QAAS,QACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,IACLf,KAAM,IACNsqC,WAAY,MACZ3N,OAAQ,UACRgN,WAAY,WACT5E,KAGL20B,aAAc,SAAC7vC,GAAD,MAAuB,CACnCmE,QAAS,QACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAM8oB,EAAM24B,IAAIv2D,MAAQ,GACxB+T,KAAO6pB,EAAM24B,IAAIx2D,MAAQ,GAEzBs+C,WAAY,QAGdqvB,iBAAkB,SAAC9vC,GAAD,MAAuB,CACvCmE,QAAS,OACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAM8oB,EAAM24B,IAAIv2D,MAAQ,GACxB+T,KAAO6pB,EAAM24B,IAAIx2D,MAAQ,GAEzBs+C,WAAY,UAIZvF,GAAc,CAClB,IAAK,CACHC,OAAQ,MACRC,aAAc,MACd3wD,MAAO,OACPC,OAAQ,OACRg5C,QAAS,OAGX,UAAW,CACTpc,gBAAiB,QACjB6zB,OAAQ,MACRzX,QAAS,MACT0X,aAAc,OAEhB,WAAY,CACVD,OAAQ,MACRzX,QAAS,MACT0X,aAAc,QAMZ20B,G,mDACJhM,qBAAsB,E,KACtBC,WAAY,E,KACZC,UAAW,E,KAGX7nB,OAAS,E,KACTD,SAAW,E,KACX+nB,SAAW,E,KACXC,SAAW,E,KACXC,OAAS,E,KACTC,OAAS,E,KACTC,SAAW,E,KACXC,SAAW,E,KACXC,MAAQ,E,KACRC,MAAQ,E,KACRC,MAAQ,E,KACRC,MAAQ,E,KACRC,YAAc,G,KACdC,UAAY,E,KACZC,YAAa,E,KACb3iE,MAAQ,E,KACRC,MAAQ,E,KACR2iE,YAAc,E,KACdiL,WAAa,E,KACbC,SAAW,KAab,IAAIC,IAAc,EACX,SAASC,KACd,OAAOD,GAIR,IAAIE,GAAmB,EAEXC,GAA2B,SAACrwC,GACvC,MAA4BA,EAAMjgB,OAA3BjzB,EAAP,EAAOA,IAAKuZ,EAAZ,EAAYA,aACNvb,EAASg7C,cAAY,kBAAMh5C,EAAIhC,UAC/By6C,EAAYyB,kBAAuB,MACnC0Z,EAAQ1Z,kBAAuB,MACrC,SAAS9yB,IACP,OAAOpnB,EAAIonB,OAEb,IAAMrQ,EAAkBiiC,cAAY,kBAAMz/B,EAAaI,MAAM5C,mBAEvD80D,EADS3xB,kBAAmB,IAAI+oC,IACnB94C,QAKbvrC,EAASU,EAAiBtB,EAAQub,EAAaI,MAAMvY,KAAKH,UAChE,GAAI8V,IAAoB80D,EAAIoL,oBAE1B,GADApL,EAAIoL,oBAAsBlgE,EACtBA,EAAiB,CACnB,IAAMysE,EAAShjF,EAAc/B,EAAgBT,IAC7C,GAAIwlF,EAAQ,CACV,IAAMC,EAAYC,GAAWF,EAAQ5kF,GACrCoB,EAAImuC,mBAAmBs1C,QAErB,CACJ,IAAME,EAAYpqE,EAAaI,MAAMvY,KAAKP,YACpC2iF,EAAShjF,EAAc/B,EAAgBT,IAC7C,GAAI2lF,EAAYH,EAAQ,CACtB,IAAMC,EAAYC,IAAYC,EAAYH,GAAS5kF,GACnDoB,EAAImuC,mBAAmBs1C,IAM7B,SAASC,EAAUpjF,EAAe1B,GAChC,IACM6kF,EAAY9kF,EAAYC,GADR,IAAII,WAAa4kF,WAAW,EAAG,EAAGtjF,GACJtC,GAGpD,OAFAgC,EAAIkuC,UAAUu1C,GAEPA,EAyDT,SAASlK,EAAgBpoC,EAAe0yC,GACtC,IAAMlqE,EAAQJ,EAAaI,MACvBw+B,EAAS0rC,EACR1rC,IAASA,EAASn4C,EAAIklB,YAC3B,IAAMhoB,EAAO0C,EAAMu4C,EAAQx+B,EAAMvY,KAAKH,UACtC,GAAIf,EAAMhD,IAAS2mF,EAAc3yE,IAAqBA,IAAuB,CAC3E,IAAMyc,EAAM1tB,EAAM,GAAKC,EAAMhD,GAAOA,GACpCyc,EAAMvY,KAAKP,YAA4C,IAA9B5C,KAAKS,MAAMivB,EAAI,IAAKA,EAAI,IAAY1vB,KAAKsC,GAC9D4wC,IACFx3B,EAAMvY,KAAKH,SAAWtB,EAAMga,EAAMvY,KAAKH,SAAU0sB,IAEnDhU,EAAM2/D,sBAAqB,IAc/B,SAASwK,IA+BP,GAAuB,WAApBjY,EAAIiM,aAAgD,KAApBjM,EAAIiM,YAAoB,CACzD,GAAGjM,EAAImM,WAAa,OAGpB,GAAGz+D,EAAaI,MAAMvE,SAAW,OAOjC,GA7FJ,WACE,IAAI2uE,GAAiB,EACrB,GAAG7wC,EAAMjgB,OAAOuC,SAASC,IAAI3xB,OAAS,EACpC,IAAI,IAAID,EAAS,EAAGA,EAAEqvC,EAAMjgB,OAAOuC,SAASC,IAAI3xB,OAAQD,IACnDqvC,EAAMjgB,OAAOuC,SAASC,IAAI5xB,GAAGygB,oBAC9By/D,GAAS,GAIf,OAAOA,EAmFQC,GAIX,YApFN,WACE,GAAG9wC,EAAMjgB,OAAOuC,SAASC,IAAI3xB,OAAS,EACpC,IAAI,IAAID,EAAS,EAAGA,EAAEqvC,EAAMjgB,OAAOuC,SAASC,IAAI3xB,OAAQD,IACnDqvC,EAAMjgB,OAAOuC,SAASC,IAAI5xB,GAAGygB,oBAC9B4uB,EAAMjgB,OAAOuC,SAASC,IAAI5xB,GAAGygB,mBAAqB4uB,EAAMjgB,OAAOuC,SAASC,IAAI5xB,GAAGygB,oBAEtC,IAAxC4uB,EAAMjgB,OAAOuC,SAASC,IAAI5xB,GAAGkgB,SAC9BmvB,EAAMjgB,OAAOuC,SAASC,IAAI5xB,GAAGkgB,QAAS,GAExCmvB,EAAMjgB,OAAOuC,SAASkX,cAAcwG,EAAMjgB,OAAOuC,SAASC,IAAI5xB,IA0E9DogF,IAKW,EAEb1qE,EAAaI,MAAMvE,UAAW,EAC9BmE,EAAaI,MAAMtE,MAAQ,EAC3BkE,EAAaI,MAAMrE,MAAQ,EAE3B4uE,GAAgB,GAEhB,IAAMC,EAAYz3D,YAAW,WAC3B+oB,aAAa0uC,GACb,SAAS5K,EAAgBpoC,GAGvB,IAAMj0C,EAAO0C,EAAM,CAACisE,EAAI+L,MAAO/L,EAAIgM,OAAQ3kC,EAAMjgB,OAAO1Z,aAAaI,MAAMvY,KAAKH,UAChF,GAAIf,EAAMhD,GAAQgU,EAAuB,CACvC,IAAMyc,EAAM1tB,EAAMC,EAAMhD,GAAM,EAAIgD,EAAMhD,GAAOA,GAC/Cg2C,EAAMjgB,OAAO1Z,aAAaI,MAAMvY,KAAKP,YAA4C,IAA9B5C,KAAKS,MAAMivB,EAAI,IAAKA,EAAI,IAAY1vB,KAAKsC,GACxF4wC,IACF+B,EAAMjgB,OAAO1Z,aAAaI,MAAMvY,KAAKH,SAAWtB,EAAMuzC,EAAMjgB,OAAO1Z,aAAaI,MAAMvY,KAAKH,SAAU0sB,IAEvGulB,EAAMjgB,OAAO1Z,aAAaI,MAAM2/D,sBAAqB,GAEnD5sD,YAAW,WAAQ6sD,GAAgB,KADP,IAIlCA,EAAgB,KACf,OACyB,WAApB1N,EAAIiM,cAIZz7E,OAAOo5C,aAAao2B,EAAIoM,aAMxB1+D,EAAaI,MAAMtE,MAAQw2D,EAAIx2D,MAC/BkE,EAAaI,MAAMrE,MAAQu2D,EAAIv2D,MAC/BiE,EAAaI,MAAMvE,UAAW,GAMjB,EACb8uE,GAAgB,GAChBrY,EAAIoM,YAAc57E,OAAOqwB,YAAW,WAClCrwB,OAAOo5C,aAAao2B,EAAIoM,aAExBpM,EAAIiM,YAAc,GAClBv+D,EAAaI,MAAMvE,UAAW,EAC9BmE,EAAaI,MAAMtE,MAAQ,EAC3BkE,EAAaI,MAAMrE,MAAQ,GAEd,EACb4uE,GAAgB,KACf,MAIP,IAAMtjE,EAAOy+D,aACX,CACEC,YAAa,YAAoB,IAAlBpF,EAAiB,EAAjBA,QAASjB,EAAQ,EAARA,GACtBlwD,SAAS9G,KAAKsH,QACdsiD,EAAIsL,UAAW,EACftL,EAAIqL,WAAY,EAIjBrL,EAAIxc,UAAW,IAAI1zC,MAAO42C,aACzBsZ,EAAI+L,MAAQ53E,EAAIklB,WAAW,GAC3B2mD,EAAIgM,MAAQ73E,EAAIklB,WAAW,GAI3B,IAAIi9D,EAAaC,KACbC,EAAaC,KACb8B,EAAgBrC,KAChBQ,EAAwBh3B,KACxB84B,EAA+B7B,KAC/B8B,EAA0BjM,KAC1BkM,EAAoBxL,KAGxB,IADqCyL,OAGlCH,IACA9B,IACAkC,IACApC,IACA+B,IACAE,IACAC,IA5NU,IAmQTrK,GAAsC,IAAZA,GAAe,CAC3CrO,EAAIxc,UAAW,IAAI1zC,MAAO42C,aAC1BsZ,EAAIuL,SAAW6B,EAAG,GAClBpN,EAAIwL,SAAW4B,EAAG,GAIlB,IAP2C,EAOrC/mD,EAAU/C,MAAMnT,KAAKzC,EAAaG,OAAO9I,QAAQye,QAAO,SAAApqB,GAAG,OAAIA,IAAQsU,EAAaW,WAP/C,cAQzBgY,EAAQskB,WARiB,IAQ3C,2BAAqC,CAAC,IAAD,IAAzB3yC,EAAyB,0BAC/B2R,EAAUrS,OAAM,UAACoW,EAAaG,OAAO3d,IAAIm2B,EAAQruB,WAAjC,aAAC,EAAqCzC,KAAKH,SAAS,IACpEwU,EAAUtS,OAAM,UAACoW,EAAaG,OAAO3d,IAAIm2B,EAAQruB,WAAjC,aAAC,EAAqCzC,KAAKH,SAAS,IACpEs+E,EAASp8E,OAAOnD,EAAIklB,WAAW,IAC/Bs6D,EAASr8E,OAAOnD,EAAIklB,WAAW,IACnC,GAAGq6D,GAAW/pE,EAAQ,IAAO+pE,GAAW/pE,EAAQ,IAAOgqE,GAAW/pE,EAAQ,IAAO+pE,GAAW/pE,EAAQ,GAClG,QAduC,8BAkB3C,IAAMgqE,EAAY/yD,YAAW,WAC3B+oB,aAAagqC,GACV0C,GAEAtW,EAAIqL,YAAkC,IAArBuN,IAA8C,IAAhBrB,KAEhDvX,EAAI6L,MAAQuB,EAAG,GACfpN,EAAI8L,MAAQsB,EAAG,GACfpN,EAAI2L,SAAWx3E,EAAIklB,WAAW,GAC9B2mD,EAAI4L,SAAWz3E,EAAIklB,WAAW,IAChB,EACd82D,GAAY,GAEZ0I,GAAoB,MAErB,OAMP1L,OAAQ,YAAiC,IAA/B4G,EAA8B,EAA9BA,KAAMzvD,EAAwB,EAAxBA,MAAO8oD,EAAiB,EAAjBA,GAAIiB,EAAa,EAAbA,SACrB/pD,EAAM,IAAMA,EAAM,MAAM07C,EAAIqL,WAAY,IACxC/mD,EAAM,IAAMA,EAAM,MACpB07C,EAAIqL,WAAY,EAIdkM,IAAc,GAIlB,I/G9d0BxhF,E+G8dtB+iF,EAAsBC,KACtBrC,EAAwBh3B,KACxB84B,EAA+B7B,KAC/B8B,EAA0BjM,KAC1B+L,EAAgBrC,KAChBwC,EAAoBxL,KACxB,IAAGsL,KACA9B,IAEAoC,IACA5I,IACAuI,IACAF,IACAG,GAiCC1Y,EAAIsL,UAAYyI,GAAQhsB,EAAMzpB,SAChC,GAAKpzB,GAnWO,IAmWYmjE,EAejB,CAEL,IAAMh9E,EAAOwC,EAAe1B,EAAO8vC,UAAW3d,GACxCszD,EAAYzlF,EAAOiB,UAAP,MAAAjB,EAAM,YAAcd,IACtC8C,EAAIkuC,UAAUu1C,IAEVtzD,EAAM,IAAMA,EAAM,KACpBopD,GAAgB,EAAOv5E,EAAI6kF,iBAtBkB,CAC/C,IAAMjmF,EAASU,EAAiBtB,EAAQub,EAAaI,MAAMvY,KAAKH,UAE1D6jF,EAAUllF,EADgBD,EAAMs5E,EAAI7xD,KACZxoB,GACxBmmF,EAAUnlF,EAAMklF,EAAS30D,GAEzB60D,EAAWxjF,EAAasjF,EAASC,IAAYpjF,EAAamjF,GAAWnjF,EAAaojF,IAClF1c,EAAO7mE,E/GnhBhB,EADyBI,E+GohBsBkjF,G/GnhB1C,IAAKljF,EAAI,I+GmhB2CuuB,GAAS,GAAK,EAAI,EAClE80D,EAAQhnF,KAAKinF,KAAKF,GAAY3c,EACpC,GAAIvQ,MAAMmtB,GACR,OAGF,IAAMxB,EAAYC,EAAUljF,EAAcykF,GAAQrmF,GAClD2a,EAAaI,MAAMvY,KAAKP,aAAeL,EAAc/B,EAAgBglF,MAc3E5D,UAAW,YAAkB,IAAhBhuD,EAAe,EAAfA,MAAOonD,EAAQ,EAARA,GAClBpN,EAAIyL,OAAS2B,EAAG,GAChBpN,EAAI0L,OAAS0B,EAAG,GAShBpN,EAAIvc,QAAS,IAAI3zC,MAAO42C,aACxB,IAAIx5B,EAAW8yC,EAAIvc,OAASuc,EAAIxc,SAE5BkzB,EAAwBh3B,KACxB84B,EAA+B7B,KAC/B+B,EAAoBxL,KACpBoM,EAAqBP,KACrBQ,ET3YH9M,GS6YD,IADqCkM,OAElCY,IAEAf,IACAc,IACA5C,IACAgC,EAAH,CAuBA,GAAI1Y,EAAIyL,QAAWzL,EAAIuL,SAAS,IAAOvL,EAAIyL,QAAWzL,EAAIuL,SAAS,IAAQvL,EAAI0L,QAAW1L,EAAIwL,SAAS,IAAOxL,EAAI0L,QAAW1L,EAAIwL,SAAS,IAAmD,QAA1CzvD,OAAOjX,OAAM,OAACkhB,QAAD,IAACA,OAAD,EAACA,EAAOsmB,QAAQ2nC,UAAsB/mD,EAAW,EAAG,CAElN,IAFkN,EAE5M7G,EAAU/C,MAAMnT,KAAKzC,EAAaG,OAAO9I,QAAQye,QAAO,SAAApqB,GAAG,OAAIA,IAAQsU,EAAaW,WAFwH,cAGhMgY,EAAQskB,WAHwL,IAGlN,2BAAqC,CAAC,IAAD,IAAzB3yC,EAAyB,0BAC/B2R,EAAUrS,OAAM,UAACoW,EAAaG,OAAO3d,IAAIm2B,EAAQruB,WAAjC,aAAC,EAAqCzC,KAAKH,SAAS,IACpEwU,EAAUtS,OAAM,UAACoW,EAAaG,OAAO3d,IAAIm2B,EAAQruB,WAAjC,aAAC,EAAqCzC,KAAKH,SAAS,IACpEs+E,EAASp8E,OAAOnD,EAAIklB,WAAW,IAC/Bs6D,EAASr8E,OAAOnD,EAAIklB,WAAW,IACnC,GAAGq6D,GAAW/pE,EAAQ,IAAO+pE,GAAW/pE,EAAQ,IAAOgqE,GAAW/pE,EAAQ,IAAO+pE,GAAW/pE,EAAQ,GAClG,QAT8M,+BAuC5L,KAAb,OAALoc,QAAK,IAALA,OAAA,EAAAA,EAAOwzD,QACTxZ,EAAIiM,YAAc,SACS,KAAb,OAALjmD,QAAK,IAALA,OAAA,EAAAA,EAAOwzD,UAGhBxZ,EAAIiM,YAAc,SAClBjM,EAAIx2D,MAAQkE,EAAaI,MAAM9W,MAAM5B,SAAS,GAAKsY,EAAaI,MAAMvY,KAAKH,SAAS,GACpF4qE,EAAIv2D,MAAQiE,EAAaI,MAAM9W,MAAM5B,SAAS,GAAGsY,EAAaI,MAAMvY,KAAKH,SAAS,IAMpF4qE,EAAImM,YAAa,EACjB,IAAMxc,EAAQ9uC,YAAW,WACvB+oB,aAAa+lB,GACVqQ,EAAImM,aACLnM,EAAImM,YAAa,GACD,IAAb+D,IACkB,IAAhBqH,IACDU,KAINV,IAAc,IACb,KAEDplF,EAAOwG,aAAexE,EAAIutC,gBAAgB/oC,aAC5CxE,EAAImuC,mBAAmBnwC,GACvBu7E,GAAgB,EAAOv5E,EAAI6kF,cAG7BhZ,EAAIsL,UAAW,EACftL,EAAIqL,WAAY,GAEF,EACd8E,GAAY,KAEdsJ,QAAS,YAAwC,IAAD,gBAArCC,GAAqC,GAAhC/mF,EAAgC,KAA7BxB,EAA6B,KAAzBmtD,EAAyB,EAAzBA,OAAewvB,GAAU,EAAjB9nD,MAAiB,EAAV8nD,MACpC,QAAa5mE,IAAT4mE,EACF,MAAO,CAACn7E,EAAGxB,GAGb,kBAAiB28E,EAAjB,GAAO6L,EAAP,KAAWC,EAAX,KAEM7mF,EAASe,EAAMwqD,EAA4B/iC,KAG7CqmB,EAAQjvC,EADE,GACUA,EAAIgnF,EAAKhnF,GADnB,GACiCgnF,EAAKhnF,EAAK,GAAKA,EAAIgnF,GADpD,GAId/3C,EAAQk1C,GAAW5kF,EAAcC,GAASyvC,GAE1C,IAIMg2C,EAAY9kF,EAAYC,EAJTmY,GAClB,IAAI/X,WAAa82C,UAAUrI,EAAOA,EAAO,IACzC,IAAIzuC,WAAa82C,UAAUrI,EAAOA,EAAO,GAAGm2C,WAAW,EAAG,EAAG5mF,EAAIyoF,GAEhBznF,GAOpD,OANAgC,EAAIkuC,UAAUu1C,GAET1sE,IACHwC,EAAaI,MAAMvY,KAAKP,aAAeL,EAAc/B,EAAgBglF,KAGhE,CAACjlF,EAAGxB,IAEb0oF,WAAY,kBAAM1lF,EAAImuC,mBAAmBnwC,IACzC+hF,OAAO,YAAW,IAAT9G,EAAQ,EAARA,GACPj5E,EAAIy2C,SAASwiC,GACT1/D,EAAaI,MAAM9W,MAAM5B,SAAS,KAAOjB,EAAIklB,WAAW,IACvD3L,EAAaI,MAAM9W,MAAM5B,SAAS,KAAOjB,EAAIklB,WAAW,KAC3D3L,EAAaI,MAAM9W,MAAM5B,SAAW0P,OAAO+D,OAAO,GAAI1U,EAAIklB,cAU9D24B,aAAa,SAACvxB,GACZu/C,EAAI6L,MAAQprD,EAAG0zD,QAAQ,GAAG3zB,QAC1Bwf,EAAI8L,MAAQrrD,EAAG0zD,QAAQ,GAAG1zB,QAC1BtsD,EAAIy2C,SAAS,CAACnqB,EAAG0zD,QAAQ,GAAG3zB,QAAS//B,EAAG0zD,QAAQ,GAAG1zB,UACnD/yC,EAAaI,MAAM9W,MAAM5B,SAAW0P,OAAO+D,OAAO,GAAI1U,EAAIklB,aAG5D41D,WAAW,SAACt7E,GACV,IAAIygF,EAAezgF,EAAE0gF,eAAe,GAChC9iF,EAAO2rB,SAASo3D,iBAAiBF,EAAa5zB,QAAS4zB,EAAa3zB,SACxEg3B,KAEA,IAAMqC,EAAWj5D,YAAW,WAC1B+oB,aAAakwC,GACW,IAArBrC,KACCzX,EAAIiM,YAAc,SAClBjM,EAAIx2D,MAAQkE,EAAaI,MAAM9W,MAAM5B,SAAS,GAAKsY,EAAaI,MAAMvY,KAAKH,SAAS,GACpF4qE,EAAIv2D,MAAQiE,EAAaI,MAAM9W,MAAM5B,SAAS,GAAGsY,EAAaI,MAAMvY,KAAKH,SAAS,IAGtFqiF,GAAmB,IAClB,KACmB,SAAf,OAAJlmF,QAAI,IAAJA,OAAA,EAAAA,EAAMgjF,WAAmC,gBAAT,OAAJhjF,QAAI,IAAJA,OAAA,EAAAA,EAAM8b,MACnCwrE,GAAoB,GACpB1I,GAAY,MAIlB,CACEqE,aAAa,CAACrG,SAAQ,KAK1BnoC,sBACE,WACE+zC,MAGF,IAIF/zC,sBACE,WACE,SAASg0C,EAAiBh0D,GAEpBA,EAAMyjB,UACJj5C,OAAOypF,gBAAkBzpF,OAAOypF,eAAer4C,MAAQ,EACrD5b,EAAMk0D,OAAS,GACjBl0D,EAAMmgB,iBAMRngB,EAAMmgB,kBASZ,OAFA31C,OAAO0sB,SAAS9G,KAAK6K,iBAAiB,QAAS+4D,EAAkB,CAAC7L,SAAS,IAEpE,WACL39E,OAAO0sB,SAAS9G,KAAKszB,oBAAoB,QAASswC,MAGtD,IAmDF,IAAMD,EAAgB1rC,mBAClB,WACA,GAAI0Z,EAAMzpB,QAAS,CAGjB,IAFA,IAAIjQ,EAAM05B,EAAMzpB,QACZ67C,EAAa,EACV9rD,GACL8rD,GAAc9rD,EAAI8rD,WAClB9rD,EAAMA,EAAI+rD,aAGZjmF,EAAIkmF,cAAc,CAACtyB,EAAMzpB,QAAQg8C,YAAavyB,EAAMzpB,QAAQujB,eAC5D1tD,EAAIomF,QAAQJ,OAIhB77C,QAEIyxC,EAAyB,CAC7B59E,SACAk1C,QACA24B,OAeF,MAAgCz3B,qBAAS,GAAzC,mBAAO2nC,EAAP,KAAiBC,EAAjB,KACA,EAAgD5nC,qBAAS,GAAzD,mBAAOqwC,EAAP,KAAyBC,EAAzB,KACA,EAAwCtwC,qBAAS,GAAjD,mBAAqB8vC,GAArB,WAEMvoC,EAAUL,GAAUsgC,GAE1B,OACE,iDAAK5/B,UAAWL,EAAQH,KAAMroC,IAAKygD,GAAWhzC,KAA9C,cACE,eAAC,KAAD,CAAgBylE,SAAaT,IAC7B,sBAAK5pC,UAAWL,EAAQ/8C,OAAQ25D,QAzsBpC,SAAsB1mC,GACpB,IAAKA,EAAMyjB,QAAS,CAAC,IAAD,EAOd7H,EAAQxvC,KAAKI,IAAI,IAAKwzB,EAAMk0D,OAAS,KAGzC,GAAc,KAFdt4C,EAAQk1C,GAAW5kF,EAAciC,EAAIhC,QAASyvC,IAG5C,OAIF,IAAMg2C,GAAY,EAAAzjF,EAAIhC,QAAOyvC,MAAX,SAAiBA,EAAOA,EAAO,GAA/B,mBACbnuC,EAAiBU,EAAIhC,OAAO8vC,UAAW9tC,EAAI6C,UAChD7C,EAAIkuC,UAAUu1C,GACdzjF,EAAImuC,mBAAmBs1C,KAsrBvB,SACE,sBAAKvqE,GAAG,gBAAgB8iC,UAAWL,EAAQnE,UAAWrkC,IAAKslC,EAA3D,SACKvF,EAAMQ,aAIhB,uBAAKsI,UAAW+/B,EAAWpgC,EAAQ+6B,kBAAoB/6B,EAAQ86B,kBAA/D,UACG,eAACt4B,GAAA,EAAD,CAASC,UAAU,SAAS/oB,MAAO0mD,EAAW/2E,GAAE,gBAAkB,GAAlE,SACI,sBAAKg3C,UAAWL,EAAQmnC,WAAYvoB,UAxB5C,SAA2B+rB,GAEzB5B,GAAoB,GACpB1I,GAAY,IAsBJn+B,aA7BV,SAAcvxB,GACZA,EAAG2lB,kBACH3lB,EAAG0lB,kBA0BG,SAEI,sBAAK94B,GAAG,aAAanD,IAAKwwE,GAAa3oF,OAAQotC,GAAcrtC,MAAOqtC,GAAc4M,IAAI,SAG9F,sBAAKoE,UAAWL,EAAQg7B,kBAKxB,eAAC,GAAD,6BAAiBzjC,GAAjB,IAAwBltB,KAAMy+D,EAAkBniD,QAAS,kBAAMoiD,GAAoB,IAAQz6B,MAAO4hB,EAAI2L,SAAUttB,MAAO2hB,EAAI4L,SAAUttB,OAAQ,cAAe7iC,MAAO,eAKzKi8D,GAAK7wC,YAAc,UCj/BJ,wlL,+DCyFT8zC,G,mDACJtM,QAAU,E,KACVuM,cAAe,E,KAEfC,aAAe,E,KACfC,OAAQ,E,KACRC,MAAQ,G,KACRvR,OAAS,E,KACThmB,SAAW,E,KACXC,OAAS,E,KACTu3B,QAAU,E,KACVC,SAAW,E,KACXC,QAAU,E,KACVC,SAAW,E,KACXC,WAAY,E,KACZC,WAAY,E,KACZtP,MAAQ,E,KACRC,MAAQ,E,KACRC,YAAc,G,KACdC,UAAY,E,KACZC,YAAa,E,KACb3iE,MAAQ,E,KACRC,MAAQ,E,KACR6xE,SAAU,E,KACVlP,YAAc,E,KAEdmP,cAAe,E,KACfC,aAAe,E,KAEfC,QAAU,E,KACVC,QAAU,E,KACVC,QAAU,E,KACVC,mBAAoB,E,KACpBC,mBAAoB,E,KACpBxE,WAAa,E,KACbC,SAAW,KAGTwE,IAA4B,EACzB,SAAS/C,KACd,OAAO+C,GAET,IAAIC,IAAoB,EACjB,SAASxF,KACd,OAAOwF,GAQT,IAAIC,IAAqB,EAClB,SAASrF,KACd,OAAOqF,GAGT,IAAIC,IAA2B,EACxB,SAAStD,KACd,OAAOsD,GAGT,IAAIC,IAAe,EACZ,SAASzF,KACd,OAAOyF,GAST,IAAIzE,GAAmB,EAIV0E,GAAwC,SAAC90C,GAuBpD,MAAwBkB,oBAASlB,EAAMpuB,QAAQ1jB,MAA/C,mBAAOA,EAAP,KAAa6mF,EAAb,KACA,EAAwB7zC,oBAASlB,EAAMpuB,QAAQ/iB,MAA/C,mBAAOA,EAAP,KAAa+pE,EAAb,KACA,EAAoC13B,oBAASryC,GAA7C,mBAAOmmF,EAAP,KAAmBC,EAAnB,KACA,EAA0C/zC,oBAAShzC,EAAKH,UAAxD,mBAAOmnF,EAAP,KAAsBC,EAAtB,KAEA,EAAkCj0C,qBAAS,GAA3C,mBAAOnwB,EAAP,KAAkBqkE,EAAlB,KACA,EAAgCl0C,qBAAS,GAAzC,mBAAO6tC,EAAP,KAAiBC,EAAjB,KACA,EAAoD9tC,oBAAShzC,EAAKP,aAAlE,mBAAO0nF,EAAP,KAA2BC,EAA3B,KACA,EAAgCp0C,qBAAS,GAAzC,mBAAO+iC,EAAP,KAAiBsR,EAAjB,KACMC,EAAMxuC,kBAAY,MACxB,EAAsChH,EAAMjgB,OAArCuC,EAAP,EAAOA,SAAUx1B,EAAjB,EAAiBA,IAAKuZ,EAAtB,EAAsBA,aAChBqQ,EAAUovB,cAAY,kBAAMxjB,EAAS5L,UAAYspB,EAAMpuB,QAAQ5L,MAGrE,IACMqjC,EADYrC,kBAAyB,IAAIssC,IACtBr8C,QAEnBw+C,EAAe3vC,cAAY,kBAAM9F,EAAMpuB,QAAQb,aACrD,EAAgDmwB,qBAAS,GAAzD,mBAAOqwC,GAAP,KAAyBC,GAAzB,KACA,GAAoCtwC,qBAAS,GAA7C,qBAAOw0C,GAAP,MAAmBC,GAAnB,MAGA,GAAoCz0C,qBAAS,GAA7C,qBAAO00C,GAAP,MAAmBC,GAAnB,MAEA,GAA4C30C,qBAAS,GAArD,qBAAO40C,GAAP,MAAuBC,GAAvB,MAEApB,GAAqBpD,GACrB,IAAMyE,GAAex8D,YAAW,WAC9B+oB,aAAayzC,IACdpB,GAA2BgB,KACzB,KAGG1kE,GAAkB40B,cAAY,kBAAM9F,EAAMpuB,QAAQV,mBAClDC,GAAiB20B,cAAY,kBAAM9F,EAAMpuB,QAAQT,kBACjD8kE,GAAcnwC,cAAY,kBAAM9F,EAAMpuB,QAAQR,qBACnC6kE,GACjB,OAAwB/0C,oBAAS,GAAjC,qBAAOx0B,GAAP,MAAawpE,GAAb,MAEMC,GAAyC,QAA5Bn2C,EAAMpuB,QAAQd,UAAsB,UAAyC,YAA5BkvB,EAAMpuB,QAAQd,UAA0B,cAAgB,SAE5H,GAAwCowB,qBAAS,GAAjD,qBAAqB8vC,IAArB,aA0EA,SAASoF,KAAsB,IAAD,IACxBZ,EAAIv+C,UAAWu+C,EAAIv+C,QAAQo/C,UAAU1oF,YAAcO,EAAKP,YAAcb,EAAI2sE,UAC9E,IAAM6c,EAAcvlE,EAAY+mB,GAAe,EAC/C,UAAA09C,EAAIv+C,eAAJ,SAAas/C,eAAe,CAACvoC,EAAE9/C,EAAKH,SAAS,GAAIkgD,EAAE//C,EAAKH,SAAS,GAAKuoF,IACtE,UAAAd,EAAIv+C,eAAJ,SAAau/C,WAAW,CAAC/rF,MAAMoE,EAAK,GAAInE,OAAOmE,EAAK,GAAKynF,IAW3D,SAASn1D,GAAK/H,GACZA,EAAG2lB,kBACH3lB,EAAG0lB,iBA8JL,SAAS23C,KACJptC,EAAOoqC,QACVpqC,EAAOoqC,OAAQ,EACfpqC,EAAOqqC,MAAQ,MACfvqF,OAAOo5C,aAAa8G,EAAO84B,QAE3BuU,GAAc,IAGhB,SAASC,KACHpyE,KAAKC,UAAUtW,KAAUqW,KAAKC,UAAUw7B,EAAMpuB,QAAQ1jB,OACxDqW,KAAKC,UAAU3V,KAAU0V,KAAKC,UAAUw7B,EAAMpuB,QAAQ/iB,QACtDmxC,EAAMpuB,QAAQ/iB,KAAd,YAAyBA,GACzBmxC,EAAMpuB,QAAQ1jB,KAAd,gBAAyBA,GACzB8xC,EAAMqkB,cAAcrkB,EAAMpuB,SAE1BmkE,IAAkB,IAgCtB,SAASnF,KAIP,GAFA/iE,QAAQC,IAAIu7B,EAAOu7B,YAAa,WAEN,WAAvBv7B,EAAOu7B,YAA0B,CAClC,GAAGv7B,EAAOy7B,WAAa,OAGxB,GAAGqL,KAAkB,OACrB,GAAGyF,GAAa,OAGhB,GAAGE,GAAiB,OACpB,GAAGG,GAAc,QAEH,EACb5sC,EAAOu7B,YAAc,GACrBv+D,EAAaI,MAAMvE,UAAW,EAC9BmE,EAAaI,MAAMtE,MAAQ,EAC3BkE,EAAaI,MAAMrE,MAAQ,EAC3B4uE,IAAgB,GAChB,IAAMC,EAAYz3D,YAAW,WAC3B+oB,aAAa0uC,GAEV5nC,EAAO4qC,SACV,SAAS5N,EAAgBpoC,GACvB,IAAMx3B,EAAQJ,EAAaI,MAErBzc,EAAO0C,EAAM,CAAC28C,EAAOq7B,MAAOr7B,EAAOs7B,OAAQl+D,EAAMvY,KAAKH,UAC5D,GAAIf,EAAMhD,GAAQgU,EAAuB,CACvC,IAAMyc,EAAM1tB,EAAMC,EAAMhD,GAAM,EAAIgD,EAAMhD,GAAOA,GAC/Cyc,EAAMvY,KAAKP,YAA4C,IAA9B5C,KAAKS,MAAMivB,EAAI,IAAKA,EAAI,IAAY1vB,KAAKsC,GAC9D4wC,EACFx3B,EAAMvY,KAAKH,SAAWtB,EAAMga,EAAMvY,KAAKH,SAAU0sB,IAEjDk7D,IAAc,GAEhBxsF,OAAOo5C,aAAa8G,EAAOmqC,cAwdrC,WAEE,IAAMoD,EAAUp9D,YAAY,WAC1B+oB,aAAaq0C,GACbjB,IAAc,KAn9BO,KAwffkB,IAEApwE,EAAM2/D,sBAAqB,GAE3B5sD,YAAW,WAAQ6sD,GAAgB,KADL,IAIlCA,EAAgB,KACf,QACE,GAA0B,WAAvBh9B,EAAOu7B,YAA0B,CACzC,GAAGgQ,GAA2B,OAC9BzrF,OAAOo5C,aAAa8G,EAAO07B,cACd,EACbiM,IAAgB,GAChB3qE,EAAaI,MAAMtE,MAAQknC,EAAOlnC,MAClCkE,EAAaI,MAAMrE,MAAQinC,EAAOjnC,MAClCiE,EAAaI,MAAMvE,UAAW,EAC9BmnC,EAAO07B,YAAc57E,OAAOqwB,YAAW,WACrCrwB,OAAOo5C,aAAa8G,EAAO07B,aAC3B17B,EAAOu7B,YAAc,GACrBv+D,EAAaI,MAAMvE,UAAW,EAC9BmE,EAAaI,MAAMtE,MAAQ,EAC3BkE,EAAaI,MAAMrE,MAAQ,GACd,EACb4uE,IAAgB,KACf,SAC4B,gBAAvB3nC,EAAOu7B,aAEfv7B,EAAOu7B,YAAc,GAElB5kC,EAAMpuB,QAAQV,iBACf8uB,EAAMpuB,QAAQV,iBAAkB,EAChC8uB,EAAMpuB,QAAQT,gBAAiB,IAG/B6uB,EAAMpuB,QAAQV,iBAAkB,EAChC8uB,EAAMpuB,QAAQT,gBAAiB,GAGjC6uB,EAAMqkB,cAAcrkB,EAAMpuB,UACK,eAAvBy3B,EAAOu7B,cACfv7B,EAAOu7B,YAAc,GAGrB5kC,EAAMpuB,QAAQV,iBAAkB,EAChC8uB,EAAMpuB,QAAQT,gBAAiB,EAC/B6uB,EAAMqkB,cAAcrkB,EAAMpuB,eA3XJ/R,IAAvBmgC,EAAMpuB,QAAQwmB,OACgB,YAA5B4H,EAAMpuB,QAAQd,UACfkvB,EAAMpuB,QAAQwmB,KAAO,QAErB4H,EAAMpuB,QAAQwmB,UAAOv4B,GAOzB8+B,sBACE,WA+BE,GA9BA0K,EAAOkqC,cAAe,GAajBvzC,EAAMpuB,QAAQ/iB,KAAK,GAAK,IAAMmxC,EAAMpuB,QAAQ/iB,KAAK,GAAK,KACvD+pE,EAAQ,CAAC54B,EAAMpuB,QAAQ/iB,KAAK,IAAM,IAAImxC,EAAMpuB,QAAQ/iB,KAAK,IAAKmxC,EAAMpuB,QAAQ/iB,KAAK,IAAM,IAAMmxC,EAAMpuB,QAAQ/iB,KAAK,MAElH8nF,KAGE32C,EAAMpuB,QAAQX,gBAAqC,IAApBC,KAAgD,IAAnBC,GAE9Dk4B,EAAO8qC,aAAehrF,OAAOyyB,aAAY,WACvCs6D,IAAQ,SAACxpE,GAAD,OAAUA,EAAO,QACxB,IACKyE,IACR+kE,GAAQ,GACR/sF,OAAOqyB,cAAc6tB,EAAO8qC,eAE5BhrF,OAAOqyB,cAAc6tB,EAAO8qC,cAEC,QAA5Bn0C,EAAMpuB,QAAQd,UAAqB,CACpC3nB,OAAOo5C,aAAa8G,EAAO84B,QAE3B,IAAM2U,EAAUt9D,YAAY,WAC1B+oB,aAAau0C,IACI,IAAd/lE,IACH0jE,IAAoB,EACnBW,GAAa,MACb,GASP,OAPO11E,KAAEq3E,QAAQloF,EAAMmxC,EAAMpuB,QAAQ/iB,OACjC+pE,EAAQl5D,KAAEC,UAAUqgC,EAAMpuB,QAAQ/iB,OAE/B6Q,KAAEq3E,QAAQ7oF,EAAM8xC,EAAMpuB,QAAQ1jB,OACjC6mF,EAAQr1E,KAAEC,UAAUqgC,EAAMpuB,QAAQ1jB,OAG/B,WAEL/E,OAAOqyB,cAAc6tB,EAAO8qC,iBAM9B,CAACn0C,EAAMpuB,QAASouB,EAAMpuB,QAAQX,cAAe+uB,EAAMpuB,QAAQV,kBAU7D8lE,4BACE,WACEZ,OAGF,CAACloF,EAAMW,EAAMkiB,EAAWjkB,EAAI2sE,WA6S9B,IAAMwd,GAAWj3C,EAAMpuB,QAAQf,OAEzBqmE,IAAiB,IAAMnsF,KAAKgG,MAAO2b,GAAO,IAAS,KAAKnb,OAAO,GAAK,KAAO,IAAMxG,KAAKgG,MAAO2b,GAAO,IAAQ,KAAKnb,OAAO,GAAK,KAAO,IAAQmb,GAAO,GAAM,KAAMnb,OAAO,GAEtK4lF,GAAsC,CAC1C9xB,QAAQ,SAAC+tB,GACJ/pC,EAAOoqC,OACL1iE,IACDs4B,EAAOoqC,OAAQ,EACfpqC,EAAOqqC,MAAQ,MACfvqF,OAAOo5C,aAAa8G,EAAO84B,QACzBuU,GAAc,KAItB7uB,cAAe,SAACurB,GA7alB,IAAoBje,EA8aZhpD,GAAkB6zB,EAAMpuB,WAC1BuP,GAAKiyD,GA/aSje,GAgbFz+C,EAhbmB4L,EAASwX,WAAWq7B,EAAOn1B,EAAMpuB,QAAQ5L,GAAK,MAmbjF8/D,OAAQ,YAAwC,IAAtC4G,EAAqC,EAArCA,KAAMzvD,EAA+B,EAA/BA,MAAO0B,EAAwB,EAAxBA,MAAWqoD,GAAa,EAAjBjB,GAAiB,EAAbiB,SAEhC0N,GAAY10C,EAAMpuB,QAAQf,OAC1BgkE,IAAe,EACfxrC,EAAOoqC,OAAQ,EAEXwD,IACDlmE,IAEE,OAAL4N,QAAK,IAALA,KAAOogB,kBACH2tC,GAnJR,SAAqBzvD,EAAwB+pD,EAAgBroD,GAC3D,IAAI0qB,EAAOkqC,aAGX,GA5bgB,IA4bZvM,EAAyB,CAE3B,IAAIoQ,EADJ9B,GAAuBD,EAAqBp4D,EAAM,GAAKA,EAAM,IAHpC,KAMvBm6D,EADO,OAALz4D,QAAK,IAALA,KAAO04D,UAAP,OAAmB14D,QAAnB,IAAmBA,KAAOyjB,QACnBizC,EAEAA,EAAqBA,EAPZ,GAUpB,IACM3pF,EAASe,EAAMyB,EAAKH,SAAUpB,EADZ,GACkCkC,IAC1DX,EAAKH,SAAWtB,EAAMyB,EAAKH,SACLrB,EAAMyB,EAAuBD,EAAKP,YAAcypF,EAAQ1rF,GAASA,IACvFwC,EAAKP,YAAcypF,EACnBrC,EAAQt3E,OAAO+D,OAAO,GAAItT,QACtB,CACJ,IAAMopF,EAAKxqF,EAAIo5E,iBAAiBjpD,GAC1Bs6D,EAAKppF,GAAwBD,EAAKP,YAAa2pF,GACrDppF,EAAKH,SAAWtB,EAAMyB,EAAKH,SAAUwpF,GACrCxC,EAAQt3E,OAAO+D,OAAO,GAAItT,KA8HxBspF,CAAYv6D,EAAO+pD,EAASroD,KAGhCytD,YAAa,YAAiD,IAA/CztD,EAA8C,EAA9CA,MAAO6oB,EAAuC,EAAvCA,cAAsBw/B,GAAiB,EAAxB/pD,MAAwB,EAAjB+pD,SAASjB,EAAQ,EAARA,GAEnD,GAAmB,gBAAX,OAALpnD,QAAK,IAALA,OAAA,EAAAA,EAAO7W,QACV+sE,IAAe,GACZ9jE,GAAH,CAEAwkE,GAAY,GACZlsC,EAAO29B,QAAUA,EACjB39B,EAAOkqC,cAAe,EAClB/rC,aAAyBiwC,SAAW94D,aAAiB+4D,cACvDlwC,EAAcggC,kBAAd,OAAgC7oD,QAAhC,IAAgCA,OAAhC,EAAgCA,EAAO8oD,WAGzCp+B,EAAOkrC,mBAAoB,EAC3BlrC,EAAO0qC,WAAY,EACnB1qC,EAAOoqC,OAAQ,EACfpqC,EAAO8S,UAAW,IAAI1zC,MAAO42C,aAC7BhW,EAAOq7B,MAAQ53E,EAAIklB,WAAW,GAC9Bq3B,EAAOs7B,MAAQ73E,EAAIklB,WAAW,GAC9B7oB,OAAOo5C,aAAa8G,EAAO84B,QAC3B94B,EAAOgrC,QAAUtO,EAAG,GACpB18B,EAAOirC,QAAUvO,EAAG,GAEpB18B,EAAO+qC,QAAUnkF,OAAO+vC,EAAMpuB,QAAQjG,QAEtC,IAAMgsE,EAAcn+D,YAAW,WAG7B,GADA+oB,aAAao1C,GACVtuC,EAAOoqC,QAAuB,IAAd1iE,IAA0C,IAAnB+kE,KAAyD,IAA7BlB,IAA2D,IAArBxE,GAAwB,CAClI,IAAMpmF,EAAO0C,EAAMI,EAAIklB,WAAY9jB,EAAKH,UACxCs7C,EAAOsqC,QAAU1jF,OAAOjG,EAAK,IAC7Bq/C,EAAOuqC,SAAW3jF,OAAOjG,EAAK,IAC9ByqF,IAAoB,EACpBW,GAAa,MAEd,OAELzI,UAAW,YAAiD,IAA/ChuD,EAA8C,EAA9CA,MAAO6oB,EAAuC,EAAvCA,cAAuC,EAAxBvqB,MAAwB,EAAjB+pD,QAAiB,EAARjB,GAiBjD,GAfA8O,IAAe,EACfH,IAAY,EACZrrC,EAAOoqC,OAAQ,EACfpqC,EAAOqqC,MAAQ,MACfvqF,OAAOo5C,aAAa8G,EAAO84B,QACiB,QAAzCztD,OAAOjX,OAAM,OAACkhB,QAAD,IAACA,OAAD,EAACA,EAAOsmB,QAAQioC,UAC9BwJ,GAAc,GAEdA,GAAc,GAIhB7oE,QAAQC,IAAIiD,EAAW,SAAU+/D,OAG9B//D,EAGH,GADa+/D,MAwSjB,WACE,GAAG9wC,EAAMjgB,OAAOuC,SAASC,IAAI3xB,OAAS,EACpC,IAAI,IAAID,EAAS,EAAGA,EAAEqvC,EAAMjgB,OAAOuC,SAASC,IAAI3xB,OAAQD,IACnDqvC,EAAMjgB,OAAOuC,SAASC,IAAI5xB,GAAGygB,mBAAqB4uB,EAAMjgB,OAAOuC,SAASC,IAAI5xB,GAAGqV,KAAOg6B,EAAMpuB,QAAQ5L,KACrGg6B,EAAMjgB,OAAOuC,SAASC,IAAI5xB,GAAGygB,mBAAqB4uB,EAAMjgB,OAAOuC,SAASC,IAAI5xB,GAAGygB,oBAEtC,IAAxC4uB,EAAMjgB,OAAOuC,SAASC,IAAI5xB,GAAGkgB,QAAoBmvB,EAAMjgB,OAAOuC,SAASC,IAAI5xB,GAAGqV,KAAOg6B,EAAMpuB,QAAQ5L,KACpGg6B,EAAMjgB,OAAOuC,SAASC,IAAI5xB,GAAGkgB,QAAS,GAExCmvB,EAAMjgB,OAAOuC,SAASkX,cAAcwG,EAAMjgB,OAAOuC,SAASC,IAAI5xB,IA/S9DogF,OADF,CAiBA,GAZAwE,GAAY,GACPlsC,EAAOkqC,cAAeoD,KAC3BttC,EAAOkqC,cAAe,EAElB/rC,aAAyBiwC,SAAW94D,aAAiB+4D,cACvDlwC,EAAcmgC,sBAAd,OAAoChpD,QAApC,IAAoCA,OAApC,EAAoCA,EAAO8oD,YAExC36E,EAAIqtC,cAActrC,MAAQw6C,EAAO29B,QAItC39B,EAAO29B,QAAU,EACdhnC,EAAMpuB,QAAQR,mBAAqBi4B,EAAOkrC,kBAI3C,OAHAlrC,EAAOkrC,mBAAoB,EAmSjC,WACE,IACMqD,EAAgB,GACtBtC,GAAuBD,EAAqB,EAAI,GAFrB,KAI3B,IAAI+B,EAASlpF,EAAKP,YAAciqF,EAE1BC,EAAkB,GAClBnsF,EAASe,EAAMyB,EAAKH,SAAUpB,EAAKkrF,EAAiBhpF,IAC1DX,EAAKH,SAAWtB,EAAMyB,EAAKH,SACLrB,EAAMyB,EAAuBD,EAAKP,YAAcypF,EAAQ1rF,GAASA,IACvFwC,EAAKP,YAAcypF,EACK,MAArBlpF,EAAKP,cACNO,EAAKP,YAAc,GAErBonF,EAAQt3E,OAAO+D,OAAO,GAAItT,IAjTtB4pF,QACAnB,KAGF,IAAIoB,EAAS/3C,EAAMpuB,QAAQ/iB,KAAK,IAAM/B,EAAIklB,WAAW,GAAKguB,EAAMpuB,QAAQ1jB,KAAKH,SAAS,IAClFiqF,EAASh4C,EAAMpuB,QAAQ/iB,KAAK,IAAMmxC,EAAMpuB,QAAQ/iB,KAAK,IAAM/B,EAAIklB,WAAW,GAAKguB,EAAMpuB,QAAQ1jB,KAAKH,SAAS,KACzF,KAAb,OAAL4wB,QAAK,IAALA,OAAA,EAAAA,EAAOwzD,QAKN4F,EAAS,GAAKA,EAAS,IAAMC,EAAUh4C,EAAMpuB,QAAQ/iB,KAAK,GAAG,EAAI,IAAOmpF,EAASh4C,EAAMpuB,QAAQ/iB,KAAK,GAAG,EAAI,GAE5Gw6C,EAAOu7B,YAAc,cAGrBv7B,EAAOu7B,YAAc,SAEI,KAAb,OAALjmD,QAAK,IAALA,OAAA,EAAAA,EAAOwzD,UAGX4F,EAAS,GAAKA,EAAS,IAAMC,EAAUh4C,EAAMpuB,QAAQ/iB,KAAK,GAAG,EAAI,IAAOmpF,EAASh4C,EAAMpuB,QAAQ/iB,KAAK,GAAG,EAAI,GAE9Gw6C,EAAOu7B,YAAc,cAErBv7B,EAAOu7B,YAAc,SAGrBv7B,EAAOlnC,MAAQkE,EAAaI,MAAM9W,MAAM5B,SAAS,GAAKsY,EAAaI,MAAMvY,KAAKH,SAAS,GACvFs7C,EAAOjnC,MAAQiE,EAAaI,MAAM9W,MAAM5B,SAAS,GAAGsY,EAAaI,MAAMvY,KAAKH,SAAS,KAGzFs7C,EAAOy7B,YAAa,EACpB,IAAMxc,EAAQ9uC,YAAW,WACvB+oB,aAAa+lB,GAEVjf,EAAOy7B,aACRz7B,EAAOy7B,YAAa,EAClB8L,QAEH,OAEL/D,OAAO,YAAkB,IAAhBluD,EAAe,EAAfA,MAAOonD,EAAQ,EAARA,GACd,IAAGh1D,EAAH,CACmB,eAAX,OAAL4N,QAAK,IAALA,OAAA,EAAAA,EAAO7W,QAA4C,KAAnB1d,IACjCi/C,EAAO4qC,SAAU,EAEjB5qC,EAAO4qC,SAAU,EAGnB,IAAMjqF,EAAO0C,EAAM,CAACq5E,EAAG,GAAIA,EAAG,IAAK73E,EAAKH,UACxCs7C,EAAOsqC,QAAU1jF,OAAOjG,EAAK,IAC7Bq/C,EAAOuqC,SAAW3jF,OAAOjG,EAAK,IAE5B8C,EAAIy2C,SAASwiC,KAGjBxe,YAAa,SAACztC,GAAapD,GAAUoD,EAAIilB,mBACzCuoB,cAAe,SAACxtC,GAAapD,GAAUoD,EAAIilB,mBAC3C8nC,YAAa,SAACv6E,GACZ+8C,EAAO4qC,SAAU,EACjB5qC,EAAOwqC,QAAU5jF,OAAOnD,EAAIklB,WAAW,IACvCq3B,EAAOyqC,SAAW7jF,OAAOnD,EAAIklB,WAAW,IAEpCq3B,EAAOyqC,UAAazqC,EAAOuqC,SAAS,IAAOvqC,EAAOyqC,UAAazqC,EAAOuqC,SAAS,IAAQvqC,EAAOwqC,SAAYxqC,EAAOsqC,QAAQ,IAAOtqC,EAAOwqC,SAAYxqC,EAAOsqC,QAAQ,IACpKtqC,EAAOoqC,OAAQ,EACfpqC,EAAOkrC,mBAAoB,IAE3BlrC,EAAOoqC,OAAQ,EACfpqC,EAAOkrC,mBAAoB,IAG/BltB,UAAW,SAACvtC,GACV,GAAGpD,EACDoD,EAAIilB,sBACC,CACL,GAAGjlB,EAAImyB,OAAS,EAAI,OAUpB,GARA5C,EAAO0qC,WAAY,EAInB1qC,EAAO4qC,SAAU,EACjB5qC,EAAO+S,QAAS,IAAI3zC,MAAO42C,aACZhW,EAAO+S,OAAS/S,EAAO8S,SAExB,GAA4C,QAAvCznC,OAAOjX,OAAOqc,EAAImrB,QAAQ2nC,WAAoC,IAAd77D,KAC7C,IAAjBs4B,EAAOoqC,OAAmB1iE,GAAW,SAK9CknE,YAAa,SAACn+D,GAEZ46D,GAAY10C,EAAMpuB,QAAQf,OACvBE,IACHs4B,EAAOwqC,QAAU5jF,OAAOnD,EAAIklB,WAAW,IACvCq3B,EAAOyqC,SAAW7jF,OAAOnD,EAAIklB,WAAW,IAEpCq3B,EAAOyqC,UAAazqC,EAAOuqC,SAAS,IAAOvqC,EAAOyqC,UAAazqC,EAAOuqC,SAAS,IAAQvqC,EAAOwqC,SAAYxqC,EAAOsqC,QAAQ,IAAOtqC,EAAOwqC,SAAYxqC,EAAOsqC,QAAQ,IACpKtqC,EAAOoqC,OAAQ,EACfpqC,EAAOkrC,mBAAoB,IAE3BlrC,EAAOoqC,OAAQ,EACfpqC,EAAOkrC,mBAAoB,KAG/BjrC,YAAa,SAACxvB,GACZ+6D,IAAe,EAEfxrC,EAAOmrC,mBAAoB,EAE3BnrC,EAAOqqC,MAAQh/D,OAAOjX,OAAOqc,EAAImrB,QAAQ2nC,SACzCzjF,OAAOo5C,aAAa8G,EAAO84B,SAE7Bn1C,WAAY,SAAClT,GACR/I,IAEH8jE,IAAe,EAEfxrC,EAAOmrC,mBAAoB,EAC3BnrC,EAAO0qC,WAAY,EACnBW,IAAY,IAGd/pC,aAAc,SAAC7wB,GACVpD,GAAUoD,EAAIilB,kBAEjB,IAAIm5C,EAAQp+D,EAAIgzD,QAAQ,GAExB,GADA+H,IAAe,GACZ9jE,EAAH,CAEAwkE,GAAY,GACZlsC,EAAOkqC,cAAe,EAGtBlqC,EAAO4qC,SAAU,EACjB,IAAMjqF,EAAO0C,EAAM,CAACwrF,EAAM/+B,QAAS++B,EAAM9+B,SAAUlrD,EAAKH,UACxDs7C,EAAOsqC,QAAU1jF,OAAOjG,EAAK,IAC7Bq/C,EAAOuqC,SAAW3jF,OAAOjG,EAAK,IAC9B8C,EAAIy2C,SAAS,CAAC20C,EAAM/+B,QAAS++B,EAAM9+B,UAMnC/P,EAAOkrC,mBAAoB,EAC3BlrC,EAAO0qC,WAAY,EACnB1qC,EAAOoqC,OAAQ,EACfpqC,EAAO8S,UAAW,IAAI1zC,MAAO42C,aAC7BhW,EAAOq7B,MAAQ53E,EAAIklB,WAAW,GAC9Bq3B,EAAOs7B,MAAQ73E,EAAIklB,WAAW,GAC9B7oB,OAAOo5C,aAAa8G,EAAO84B,QAC3B94B,EAAOgrC,QAAU6D,EAAM/+B,QACvB9P,EAAOirC,QAAU4D,EAAM9+B,QAEvB/P,EAAO+qC,QAAUnkF,OAAO+vC,EAAMpuB,QAAQjG,QAGtC,IAAMgsE,EAAcn+D,YAAW,WAE7B+oB,aAAao1C,GAIb,IAAIQ,EAAahI,KACjB,IAAiB,IAAdp/D,IAAuC,IAAhBklE,KAAsD,IAA7BrB,IAA2D,IAArBxE,GAAwB,CAC/G,GAAG+H,EAAa,OAChB,IAAMnuF,EAAO0C,EAAMI,EAAIklB,WAAY9jB,EAAKH,UACxCs7C,EAAOsqC,QAAU1jF,OAAOjG,EAAK,IAC7Bq/C,EAAOuqC,SAAW3jF,OAAOjG,EAAK,IAC9ByqF,IAAoB,EACpBW,GAAa,MAEd,OAGLxN,WAAW,SAACt7E,GACV+8C,EAAOoqC,OAAQ,EACfoB,IAAe,EACfxrC,EAAO4qC,SAAU,EACjB,IAAIlH,EAAezgF,EAAE0gF,eAAe,GAChC9iF,EAAO2rB,SAASo3D,iBAAiBF,EAAa5zB,QAAS4zB,EAAa3zB,SACtEg3B,KAEA,IAAMqC,EAAWj5D,YAAW,WAC1B+oB,aAAakwC,GACW,IAArBrC,KAED/mC,EAAOu7B,YAAc,SACrBv7B,EAAOlnC,MAAQkE,EAAaI,MAAM9W,MAAM5B,SAAS,GAAKsY,EAAaI,MAAMvY,KAAKH,SAAS,GACvFs7C,EAAOjnC,MAAQiE,EAAaI,MAAM9W,MAAM5B,SAAS,GAAGsY,EAAaI,MAAMvY,KAAKH,SAAS,IAIvF,IAAMqqF,EAAe5+D,YAAW,WAC9B+oB,aAAa61C,GACbhI,GAAmB,IAClB,OACF,KAGmB,SAAf,OAAJlmF,QAAI,IAAJA,OAAA,EAAAA,EAAMgjF,WAAmC,mBAAT,OAAJhjF,QAAI,IAAJA,OAAA,EAAAA,EAAM8b,KACnCywE,KACAjF,IAAoB,IACO,SAAf,OAAJtnF,QAAI,IAAJA,OAAA,EAAAA,EAAMgjF,WAAmC,mBAAT,OAAJhjF,QAAI,IAAJA,OAAA,EAAAA,EAAM8b,KAC1CywE,KACAZ,IAAc,IACa,SAAf,OAAJ3rF,QAAI,IAAJA,OAAA,EAAAA,EAAMgjF,WAAmC,iBAAT,OAAJhjF,QAAI,IAAJA,OAAA,EAAAA,EAAM8b,KAC1CywE,KACA3pF,EAAIqtC,cAAc/X,IAAI,eACtB4sD,GAAY,IAEe,SAAf,OAAJ9kF,QAAI,IAAJA,OAAA,EAAAA,EAAMgjF,WAAmC,iBAAT,OAAJhjF,QAAI,IAAJA,OAAA,EAAAA,EAAM8b,KAC1CqjC,EAAOoqC,OAAQ,EAEW,SAAvBzzC,EAAMpuB,QAAQwmB,KACf4H,EAAMpuB,QAAQwmB,KAAO,QAEU,QAA5B4H,EAAMpuB,QAAQd,eACajR,IAAvBmgC,EAAMpuB,QAAQwmB,KACf4H,EAAMpuB,QAAQwmB,KAAO,QAErB4H,EAAMpuB,QAAQwmB,UAAOv4B,EAGvBmgC,EAAMpuB,QAAQwmB,KAAO,OAG3B4H,EAAMqkB,cAAcrkB,EAAMpuB,SAC1B6kE,MAC2B,SAAf,OAAJvsF,QAAI,IAAJA,OAAA,EAAAA,EAAMgjF,WAAmC,qBAAT,OAAJhjF,QAAI,IAAJA,OAAA,EAAAA,EAAM8b,KAC1CuR,GAAoByoB,EAAMpuB,SAC1BouB,EAAMqkB,cAAcrkB,EAAMpuB,SAC1B6kE,MAC2B,SAAf,OAAJvsF,QAAI,IAAJA,OAAA,EAAAA,EAAMgjF,WAAmC,sBAAT,OAAJhjF,QAAI,IAAJA,OAAA,EAAAA,EAAM8b,KAC1CiR,GAAiB+oB,EAAMpuB,SACvBouB,EAAMqkB,cAAcrkB,EAAMpuB,SAC1B6kE,MAC2B,SAAf,OAAJvsF,QAAI,IAAJA,OAAA,EAAAA,EAAMgjF,WAAmC,wBAAT,OAAJhjF,QAAI,IAAJA,OAAA,EAAAA,EAAM8b,KAC1Cg6B,EAAMpuB,QAAQR,mBAAqB4uB,EAAMpuB,QAAQR,kBACjD4uB,EAAMpuB,QAAQf,QAAUmvB,EAAMpuB,QAAQf,OACtCmvB,EAAMqkB,cAAcrkB,EAAMpuB,SAC1B6kE,MAC4B,SAAf,OAAJvsF,QAAI,IAAJA,OAAA,EAAAA,EAAMgjF,WAAyC,UAAf,OAAJhjF,QAAI,IAAJA,OAAA,EAAAA,EAAMgjF,WAA0C,SAAf,OAAJhjF,QAAI,IAAJA,OAAA,EAAAA,EAAMgjF,WAAyC,SAAf,OAAJhjF,QAAI,IAAJA,OAAA,EAAAA,EAAMgjF,WAAoC,sBAAT,OAAJhjF,QAAI,IAAJA,OAAA,EAAAA,EAAM8b,IAatG,SAAf,OAAJ9b,QAAI,IAAJA,OAAA,EAAAA,EAAMgjF,WACZwJ,GAAc,IAbhBrtC,EAAOoqC,OAAQ,EACZzzC,EAAMpuB,QAAQX,eACf+uB,EAAMpuB,QAAQX,eAAgB,EAC9B+uB,EAAMpuB,QAAQV,iBAAkB,EAChC8uB,EAAMpuB,QAAQT,gBAAiB,IAE/B6uB,EAAMpuB,QAAQX,eAAgB,EAC9B+uB,EAAMpuB,QAAQV,iBAAkB,EAChC8uB,EAAMpuB,QAAQT,gBAAiB,GAEjC6uB,EAAMqkB,cAAcrkB,EAAMpuB,SAC1B6kE,QAQR,SAAS3F,KACP,IAAID,GAAiB,EACrB,GAAG7wC,EAAMjgB,OAAOuC,SAASC,IAAI3xB,OAAS,EACpC,IAAI,IAAID,EAAS,EAAGA,EAAEqvC,EAAMjgB,OAAOuC,SAASC,IAAI3xB,OAAQD,IACnDqvC,EAAMjgB,OAAOuC,SAASC,IAAI5xB,GAAGygB,mBAAqB4uB,EAAMjgB,OAAOuC,SAASC,IAAI5xB,GAAGqV,KAAOg6B,EAAMpuB,QAAQ5L,KACrG6qE,GAAS,GAIf,OAAOA,EA0CT,SAAS6F,GAAc2B,GACrB,IAAMvB,EAAUt9D,YAAY,WAE1B+oB,aAAau0C,GACbrC,IAAoB,EACpBW,GAAa,KACF,IAATiD,GAGN,IAAMC,GAAwC76E,OAAO+D,OAAO,GAAI21E,IAChEmB,GAAkBxS,OAAS,SAAC/mD,GAAoC,IAAD,EAEzDk4D,IAAWnqF,EAAIqtC,cAActX,IAAImd,EAAMpuB,QAAQ5L,KACnD,UAAAmxE,GAAgBrR,cAAhB,SAAwBqI,K,UAAWpvD,IA8ErC,IAAM0pB,GAAUL,GAAU,CAACpI,QAAO9xC,OAAMW,OAAMkiB,YAAW2kE,cAAY7kE,OAAOmvB,EAAMpuB,QAAQf,OAAQozD,WAAUvtD,UAASi9D,QAAQtqC,EAAOsqC,QAASC,SAASvqC,EAAOuqC,SAAUH,MAAMpqC,EAAOoqC,MAAO8E,OAAO9C,EAActzE,MAAMknC,EAAOlnC,MAAOC,MAAMinC,EAAOjnC,QAE3Oo2E,GAAahyC,KAAMQ,OAAuB,MAC1CyxC,GAAUjyC,KAAMQ,OAAuB,MACvC0xC,GAAoBvM,aAAWmM,IAC/BK,GAAkBxM,aAAWgL,IAyF7ByB,GACJ,iDAAK9vC,UAAWL,GAAQowC,cAAkBH,MAA1C,cACE,uBAAK5vC,UAAWL,GAAQ72B,QAAS3R,IAAKu4E,GACpC3tC,QAAS,WACH3+B,GAA8B8zB,EAAMpuB,UAAY8E,GAClD5pB,EAAIqtC,cAAc/X,IAAI4d,EAAMpuB,QAAQ5L,KAGxC29C,OAAQ,WACFz3C,GAA8B8zB,EAAMpuB,UAAY8E,GAClD5pB,EAAIqtC,cAAchwC,OAAO61C,EAAMpuB,QAAQ5L,KAR7C,UAYE,eAAC,GAAD,gBAAag6B,IAGb,sBAAK8I,UAAWL,GAAQqwC,oBAAxB,SACE,sBAAKhwC,UAAWL,GAAQswC,cAAxB,SAAwC/4C,EAAMpuB,QAAQ1T,SAExD,sBAAK4qC,UAAWL,GAAQuwC,qBAAxB,SACE,sBAAKlwC,UAAWL,GAAQwwC,eAAxB,SAAyC/B,OAG3C,sBAAKpuC,UAAYmtC,KAA6B,IAAdllE,EAAuB03B,GAAQywC,aAAgBxD,IAAsC,UAAvB11C,EAAMpuB,QAAQwmB,KAAoBqQ,GAAQ0wC,YAASt5E,IAEzJ,sBAAKqW,MAAO,CAACnoB,SAAS,WAAYtD,MAAMoE,EAAK,GAAInE,OAAOmE,EAAK,GAAIqoB,IAAI,EAAGf,KAAK,GAA7E,SAEW8/D,KAA6B,IAAdllE,EAClB,iCACA,sBAAKmF,MAAO,CAACzrB,MAAM,OAAQC,OAAO,OAA8CqD,SAAS,WAAYooB,KAAK,QAASe,IAAI,QAASoQ,gBAAgB,UAAW8zB,aAAa,OAAxK,SACE,eAAC,QAAD,CAAMvxB,KAAMuvD,KAAWljE,MAAO,CAACzrB,MAAMqtC,GAAa,IAAKptC,OAAOotC,GAAa,IAAKz5B,MAAM,QAAStQ,SAAS,WAAYooB,KAAK,MAAOe,IAAI,WAEtI,sBAAKhB,MAAO,CAACzrB,MAAM,OAAQC,OAAO,OAA8CqD,SAAS,WAAYooB,KAAMtnB,EAAK,GAAK,GAAKqoB,IAAI,QAASoQ,gBAAgB,UAAW8zB,aAAa,OAA/K,SACA,eAAC,QAAD,CAAMvxB,KAAMuvD,KAAWljE,MAAO,CAACzrB,MAAMqtC,GAAa,IAAKptC,OAAOotC,GAAa,IAAKz5B,MAAM,QAAStQ,SAAS,WAAYooB,KAAK,QAASe,IAAI,WAEtI,sBAAKhB,MAAO,CAACzrB,MAAM,OAAQC,OAAO,OAA8CqD,SAAS,WAAYooB,KAAMtnB,EAAK,GAAK,GAAM,KAAMqoB,IAAKroB,EAAK,GAAK,GAAM,KAAMy4B,gBAAgB,UAAW8zB,aAAa,OAApM,SAKE,eAAC,QAAD,CAAMvxB,KAAMuvD,KAAWljE,MAAO,CAACzrB,MAAMqtC,GAAa,IAAKptC,OAAOotC,GAAa,IAAKz5B,MAAM,QAAStQ,SAAS,WAAYooB,KAAK,MAAOe,IAAI,WAItI,sBAAKhB,MAAO,CAACzrB,MAAM,OAAQC,OAAO,OAA8CqD,SAAS,WAAYooB,KAAK,QAASe,IAAKroB,EAAK,GAAK,GAAM,KAAMy4B,gBAAgB,UAAW8zB,aAAa,OAAtL,SACE,eAAC,QAAD,CAAMvxB,KAAMuvD,KAAWljE,MAAO,CAACzrB,MAAMqtC,GAAa,IAAKptC,OAAOotC,GAAa,IAAKz5B,MAAM,QAAStQ,SAAS,WAAYooB,KAAK,MAAOe,IAAI,WAGtI,sBAAKhB,MAAO,CAACzrB,MAAM,OAAQC,OAAO,OAA8CqD,SAAS,WAAYooB,KAAOtnB,EAAK,GAAG,EAAI,GAA2BqoB,IAAKroB,EAAK,GAAG,EAAK,GAAIy4B,gBAAgB,UAAW8zB,aAAa,OAAjN,SAEA,eAAC,KAAD,CAAiBllC,MAAO,CAACzrB,MAAMqtC,GAAcptC,OAAOotC,GAAcz5B,MAAM,QAAStQ,SAAS,WAAYooB,KAAK,MAAOe,IAAI,cAGpH,QAGJ,iDAAK4xB,UAAWL,GAAQ4wC,eAAmBV,MAA3C,cACA,sBAAK7vC,UAAWL,GAAQ6wC,eACnBC,aAAgB,aAEf3uC,cAAiB,WACfokC,GAAY,GACZliF,EAAIqtC,cAAc/X,IAAI,gBAL9B,SAQQ,eAAC,GAAD,2BAAmBtP,KAAMi8D,GAAc/uC,GAAvC,IAA8CrmB,MAxzB1D,WACEq1D,GAAY,GACRhvC,EAAMpuB,QAAQf,SAChB4jE,IAAoB,EACpBW,GAAa,IAEftoF,EAAIqtC,cAAchwC,OAAO,eACzB61C,EAAMqkB,cAAcrkB,EAAMpuB,UAkzBlBm2B,SAAUywC,GAAWvhD,QAAS+Q,aAAc,CAACC,SAAS,MAAOC,WAAW,cAM5E,gBAAChI,GAAA,EAAD,CAAQptB,KAAM8iE,GAAYxmD,QAAS,kBAAMymD,IAAc,IAAQ58B,SAAU,kBAAM48B,IAAc,IAC7F32B,aAAW,EACXhpC,MAAO0/D,GAAa,CAACjqE,OAAO,KAAM24B,UAAUl6C,IAAiB,WAAa,YAAc,CAACuhB,QAAQ,KAAM24B,UAAUl6C,IAAiB,WAAa,YAC/IijF,cAAe,CAAEC,WAAW,GAH5B,UAKE,eAACtuC,GAAA,EAAD,CAAe9oB,MAAO,CAACquB,WAAY,OAAQtF,SAAS,OAAQ2T,WAAW,QAAvE,SAEE9gD,GAAE,aAAeqkF,KAGnB,gBAACqD,GAAA,EAAD,WACE,eAACt6C,GAAA,EAAD,CAAQC,QAAQ,YAAoCjpB,MAAO,CAACkpB,cAAc,OAAQkI,UAAU,QAAShgB,gBAAgB,SAAU58B,OAAO,OAAQu0C,SAAS,OAAQ2T,WAAW,QAC1KrT,QAAS,SAACnmB,GACRy8D,IAAc,IAFhB,SAII/jF,GAAE,cACN,eAACotC,GAAA,EAAD,CAAQC,QAAQ,YAAoCjpB,MAAO,CAACkpB,cAAc,OAAQkI,UAAU,QAAShgB,gBAAgB,UAAW58B,OAAO,OAAQu0C,SAAS,OAAQ2T,WAAW,QAC3KrT,QAAS,SAACnmB,GAAQ,IAAD,EACfy8D,IAAc,GAGd,UAAA71C,EAAM5Q,eAAN,SAAe++C,KAAK,KAAM/0D,IAL5B,SAMItnB,GAAE,6BAOhB,OACE,uBAAKg3C,UAAWL,GAAQlD,UAAWrvB,MAAO,CAACvK,OAAOq0B,EAAMpuB,QAAQjG,QAASi/B,cACvE,SAACwoC,GACCA,EAAIr0C,kBACJq0C,EAAIt0C,kBAHR,UAgBgC,YAA5BkB,EAAMpuB,QAAQd,WAAuD,WAA5BkvB,EAAMpuB,QAAQd,UACvD,eAAC,KAAD,CAAKg4B,UAAWL,GAAQgxC,OAAQC,eAAgB3oE,EAAY4oE,GAAiB1D,GAAc2D,GAAeD,GAC1GE,gBAAiB5C,GAASh3E,IAAKu1E,EAG/BsE,cArSN,SAAuB1G,GAClBriE,IACHs4B,EAAOkqC,cAAe,EACtBH,EAAIr0C,kBAAmBq0C,EAAIt0C,iBAC3Bm2C,EAAcpmF,GACdsmF,EAAiBjnF,EAAKH,YAiSlBolF,SA1RN,SAAkBC,EAA6B34D,EAAUvwB,EAAqB+yB,EAAWrY,GACvF,IAAGmM,EAGH,GAFAqiE,EAAIr0C,kBAAmBq0C,EAAIt0C,iBAEvBuK,EAAOkqC,aACT6C,SADF,CAKA,IAAM77C,GAAS1vC,EAAciC,EAAIhC,QAAUO,EAAcyB,EAAIhC,SAAW,EAClEivF,EAAsB,CAAC98D,EAAMxyB,MAAQ8vC,EAAOtd,EAAMvyB,OAAS6vC,GAQ7Dy/C,GAAY,EACVC,EAA6B,CAAC,EAAG,GAW3B,eAARx/D,GACFw/D,EAAS,IAAMF,EAAG,GAClBC,EAAYA,GAAuB,IAAVD,EAAG,IAElB,aAARt/D,IACFw/D,EAAS,IAAMF,EAAG,GAClBC,EAAYA,GAAuB,IAAVD,EAAG,IAElB,YAARt/D,IACFw/D,EAAS,IAAMF,EAAG,GAClBC,EAAYA,GAAuB,IAAVD,EAAG,IAG1BC,IACF9rF,EAAKH,SAAWtB,EAAMyoF,EAAe+E,GACrClF,EAAQt3E,OAAO+D,OAAO,GAAItT,KAG5B,IAAMu6D,EAAUh8D,EAAMuoF,EAAY+E,GAClC,GAAGtxB,EAAQ,GAAK,IAAMA,EAAQ,GAAK,GAAI,CACrC,GAAIzoB,EAAMpuB,QAAQhB,aAAa,GAAI,CACjC,IAAMm3D,EAAQ/nC,EAAMpuB,QAAQhB,aAAa,GAAKovB,EAAMpuB,QAAQhB,aAAa,GACrE63C,EAAQ,GAAKsf,EAAQtf,EAAQ,KAAMA,EAAQ,GAAKsf,EAAQtf,EAAQ,IAChEA,EAAQ,GAAKsf,EAAQtf,EAAQ,KAAMA,EAAQ,GAAKA,EAAQ,GAAKsf,GAEnEnP,EAAQnQ,QAERkuB,OAkOEuD,aAhSN,WACKnpE,IACEs4B,EAAOkqC,cAAeoD,KAC3BttC,EAAOkqC,cAAe,IA+RlB4G,mBAAoB,CAClBC,QAASC,GACTC,SAAUD,GACVE,WAAYF,GACZG,YAAaH,IAEfI,oBAAqBhyC,GAAQ4xC,aAd7B,SAsBGzB,KACI,GAET,eAAC,GAAD,6BAAiB54C,GAAjB,IAAwBltB,KAAMy+D,GAAkBniD,QAAS,kBAAMoiD,IAAoB,IAAQz6B,MAAO7oD,EAAKH,SAAS,GAAKs7C,EAAOuqC,SAAU58B,MAAO9oD,EAAKH,SAAS,GAAKs7C,EAAOsqC,QAAS18B,OAAQ,cAAe7iC,MAAO,UAG9M,eAAC8rB,GAAA,EAAD,CAAQptB,KAAM/B,EAAWqe,QAAS,kBAAMgmD,GAAa,IAAQn8B,SAAU,kBAAMm8B,GAAa,IAC1Fl2B,aAAW,EACT7F,WAAY,CACVnjC,MAAO,CACLoR,gBAAiB,cACjBv5B,SAAS,WACTq/E,UAAW,OACX32B,SAAS,SAKTtgC,KAAMlmB,OAAOo5C,EAAOgrC,SAAW,IAC/Bn9D,IAAKjnB,OAAOo5C,EAAOirC,SAAW,IAC9B3oE,OAAQoF,EAAY,KAAO,IAC3BuzB,UAAWl6C,IAAiB,aAAe,aAG/CijF,cAAe,CAAEC,WAAW,GAlB9B,SAoBE,eAACtuC,GAAA,EAAD,CAAe9oB,MAAOnF,EAAY,CAACuzB,UAAU,aAAcN,WAAW,eAAiB,CAACM,UAAU,WAAYN,WAAW,eAAzH,SAEA,eAAC2F,GAAA,EAAD,CAAMC,GAAI74B,EAAWmF,MAAO,CAAE8tB,WAAYjzB,EAAY,QAAU,OAAhE,SACE,uBAAK+3B,UAAWL,GAAQiyC,sBACpBnB,aAAgB,aAMd3uC,cAAiB,aAPvB,UAmBI,eAACK,GAAA,EAAD,CAASC,UAAU,MAAM/oB,MAAOknB,EAAOoqC,MAAQ3hF,GAAE,aAAe,GAAhE,SACE,sBAAKg3C,UAAWL,GAAQkyC,qBAAsBtzB,UA3iC5D,SAA0B+rB,GACxBjyD,GAAKiyD,GACLn8D,GAAiB+oB,EAAMpuB,SACvBouB,EAAMqkB,cAAcrkB,EAAMpuB,SAC1B6kE,MAwiCc9rC,aAAcxpB,GAAMo4D,aAAc9C,GADpC,SAEI,sBAAKzwE,GAAG,mBAAmBnD,IC74ChC,ygED64CsDnY,OAAQotC,GAAcrtC,MAAOqtC,GAAc4M,IAAI,SAEtG,eAACuG,GAAA,EAAD,CAASC,UAAU,MAAM/oB,MAAOknB,EAAOoqC,MAAQ3hF,GAAE,gBAAkB,GAAnE,SACE,sBAAKg3C,UAAWL,GAAQmyC,wBAAyBvzB,UA1iC/D,SAA6B+rB,GAC3BjyD,GAAKiyD,GACL77D,GAAoByoB,EAAMpuB,SAC1BouB,EAAMqkB,cAAcrkB,EAAMpuB,SAC1B6kE,MAuiCc9rC,aAAcxpB,GAAMo4D,aAAc9C,GADpC,SAEI,sBAAKzwE,GAAG,kBAAkBnD,IEl5C/B,inEFk5CoDnY,OAAQotC,GAAcrtC,MAAOqtC,GAAc4M,IAAI,SAEtG,eAACuG,GAAA,EAAD,CAASC,UAAU,MAAM/oB,MAAOknB,EAAOoqC,MAAgC,UAAvBzzC,EAAMpuB,QAAQwmB,KAAmBtmC,GAAE,iBAAmBA,GAAE,eAAkB,GAA1H,SACA,sBAAKg3C,UAAWL,GAAQoyC,YAAaxzB,UAl/B/C,SAAqB+rB,GACnBjyD,GAAKiyD,GACL/pC,EAAOoqC,OAAQ,EAEW,SAAvBzzC,EAAMpuB,QAAQwmB,KACf4H,EAAMpuB,QAAQwmB,KAAO,QAEU,QAA5B4H,EAAMpuB,QAAQd,eACajR,IAAvBmgC,EAAMpuB,QAAQwmB,KACf4H,EAAMpuB,QAAQwmB,KAAO,QAErB4H,EAAMpuB,QAAQwmB,UAAOv4B,EAGvBmgC,EAAMpuB,QAAQwmB,KAAO,OAG3B4H,EAAMqkB,cAAcrkB,EAAMpuB,SAC1B6kE,MAg+BqE9rC,aAAcxpB,GAAMo4D,aAAc9C,GAA/F,SACE,sBAAKzwE,GAAG,cAAcnD,KAAKm9B,EAAMpuB,QAAQwmB,KAAmB0iD,IAAkCpwF,OAAQotC,GAAcrtC,MAAOqtC,GAAc4M,IAAI,SAG/I,sBAAKoE,UAAWL,GAAQsyC,mBAAoB1zB,UAz8BtD,SAAqB+rB,GACnBjyD,GAAKiyD,GACLtmF,EAAIqtC,cAAc/X,IAAI,eACtB4sD,GAAY,GACZyH,MAq8B4E9rC,aAAcxpB,GAAMo4D,aAAc9C,GAAax2E,IAAKw4E,GAAxH,SACI,sBAAKzyE,GAAG,cAAcnD,IAAKm8C,GAAUt0D,OAAQotC,GAAcrtC,MAAOqtC,GAAc4M,IAAI,OAKtF,sBAAKoE,UAAWL,GAAQuyC,aAAc3zB,UAnlClD,SAAsB+rB,GACpBjyD,GAAKiyD,GAELqD,KACAZ,IAAc,IA+kC2FlrC,aAAcxpB,GAAMo4D,aAAc9C,GAAjI,SACE,sBAAKzwE,GAAG,gBAAgBnD,IGh6CzB,qvFHg6CyCnY,OAAQotC,GAAcrtC,MAAOqtC,GAAc4M,IAAI,OAE3F,eAACuG,GAAA,EAAD,CAASC,UAAU,SAAS/oB,MAAOknB,EAAOoqC,MAAQ3hF,GAAE,gBAAkB,GAAtE,SACE,sBAAKg3C,UAAWL,GAAQwyC,kBAAmB5zB,UAljCvD,SAA2B+rB,GACzBqD,KACAjF,IAAoB,IAijCR7mC,aAAcxpB,GAAMo4D,aAAc9C,GADpC,SAEI,sBAAKzwE,GAAG,gBAAgBnD,IAAKwwE,GAAa3oF,OAAQotC,GAAcrtC,MAAOqtC,GAAc4M,IAAI,SAG/F,eAACuG,GAAA,EAAD,CAASC,UAAU,MAAM/oB,MAAOknB,EAAOoqC,MAASzzC,EAAMpuB,QAAQX,cAAgBnf,GAAE,kBAAoBA,GAAE,iBAAoB,GAA1H,SACE,sBAAKg3C,UAAWL,GAAQyyC,iBAAkB7zB,UAxiCtD,SAA0B+rB,GAexBjyD,GAAKiyD,GACL/pC,EAAOoqC,OAAQ,EAEZzzC,EAAMpuB,QAAQX,eACf+uB,EAAMpuB,QAAQX,eAAgB,EAC9B+uB,EAAMpuB,QAAQV,iBAAkB,EAChC8uB,EAAMpuB,QAAQT,gBAAiB,IAI/B6uB,EAAMpuB,QAAQX,eAAgB,EAC9B+uB,EAAMpuB,QAAQV,iBAAkB,EAChC8uB,EAAMpuB,QAAQT,gBAAiB,GAGjC6uB,EAAMqkB,cAAcrkB,EAAMpuB,SAC1B6kE,MA0gCY9rC,aAAcxpB,GAAMo4D,aAAc9C,GADpC,UAEKz2C,EAAMpuB,QAAQX,cAAgB,eAAC,KAAD,CAAkBjL,GAAG,mBAAmBkQ,MAAO,CAACzrB,MAAMqtC,GAAcptC,OAAOotC,GAAcz5B,MAAM,gBAKpI,eAAC4sC,GAAA,EAAD,CAASC,UAAU,MAAM/oB,MAAOknB,EAAOoqC,MAASzzC,EAAMpuB,QAAQR,kBAAoBtf,GAAE,mBAAqBA,GAAE,iBAAoB,GAA/H,SACE,sBAAKg3C,UAAWL,GAAQ0yC,mBAAoB9zB,UA5jCxD,SAA4B+rB,GAC1BjyD,GAAKiyD,GAELpzC,EAAMpuB,QAAQR,mBAAqB4uB,EAAMpuB,QAAQR,kBACjD4uB,EAAMpuB,QAAQf,QAAUmvB,EAAMpuB,QAAQf,OACtCmvB,EAAMqkB,cAAcrkB,EAAMpuB,SAI1B6kE,MAojCY9rC,aAAcxpB,GAAMo4D,aAAc9C,GADpC,UAEKz2C,EAAMpuB,QAAQR,kBAAoB,eAAC,KAAD,CAAiBpL,GAAG,qBAAqBkQ,MAAO,CAACzrB,MAAMqtC,GAAcptC,OAAOotC,GAAcz5B,MAAM,gBAMzI,sBAAKyqC,UAAW/3B,EAAY03B,GAAQ2yC,yBAAsBv7E,iBAgKhEq7C,GAAc,CAClB,IAAK,CACHC,OAAQ,MACRC,aAAc,MACd3wD,MAAO,OACPC,OAAQ,OACRg5C,QAAS,OAMX,UAAW,CACTpc,gBAAiB,QACjB6zB,OAAQ,MACRzX,QAAS,MACT0X,aAAc,OAEhB,WAAY,CAEVD,OAAQ,MACRzX,QAAS,MACT0X,aAAc,QAIZmzB,GAAoB,CACxB,IAAK,CACHpzB,OAAQ,MACRC,aAAc,MACd3wD,MAAO,OACPC,OAAQ,OACRg5C,QAAS,OAMX,UAAW,CACTpc,gBAAiB,UACjB6zB,OAAQ,MACRzX,QAAS,MACT0X,aAAc,OAEhB,WAAY,CAEVD,OAAQ,MACRzX,QAAS,MACT0X,aAAc,QAIZigC,GAAsB,CAC1B,IAAK,CACHlgC,OAAQ,MACRC,aAAc,MACd3wD,MAAO,OACPC,OAAQ,OACRg5C,QAAS,OAKX,UAAW,CACTpc,gBAAiB,UACjB6zB,OAAQ,MACRzX,QAAS,MACT0X,aAAc,OAEhB,WAAY,CAEVD,OAAQ,MACRzX,QAAS,MACT0X,aAAc,QAMZhT,GAAYC,aAAW,CAC3B9C,UAAW,SAACvF,GACV,IAAMs7C,EAAM,IAAIxvF,UAGhB,OAFAwvF,EAAI5K,WAAW,EAAG,EAAG1wC,EAAM9xC,KAAKP,aAExB,CACNw2C,QAASnE,EAAMA,MAAMu7C,QAAU,OAAS,QACxC9wF,MAAM,EACNC,OAAO,EACP45C,UAAWg3C,EAAIhqF,WACfvD,SAAU,aAGd0rF,OAAQ,SAACz5C,GAAD,MAAwB,CAC9Bob,aAAcpb,EAAMjvB,UAAY,kBAAoB,UACpDuW,gBAAiB0Y,EAAMA,MAAMpuB,QAAQH,QAAU,gBAC7C8D,GAASsuC,eAAiB,wBAA0B,sBACtDupB,UAAWptC,EAAMA,MAAMpuB,QAAQH,aAAU5R,EACvC0V,GAASsuC,eAAiB,0CACxB,gDAENg1B,aAAc,SAAC74C,GAAD,MAAwB,CACpCv1C,MAAM,OACNC,OAAO,SAGTyuF,OAAO,SAACn5C,GAAD,MAAwB,CAC7BjyC,SAAWiyC,EAAMA,MAAMpuB,QAAQb,UAAY,WAAa,WACxDtmB,MAAOu1C,EAAMnxC,KAAK,GAAK,EACvBnE,OAAQs1C,EAAMnxC,KAAK,GAAK,EACxBkyD,YAAY,EACZD,YAAa,SACbE,YAAY,MACZ5F,aAAa,EACblkC,IAAM8oB,EAAMA,MAAMpuB,QAAQb,UAAY,QAAaivB,EAAMnxC,KAAK,GAAO,EAAK,KAC1EsnB,KAAM,SAGR+iE,aAAa,SAACl5C,GAAD,MAAwB,CACnCjyC,SAAWiyC,EAAMA,MAAMpuB,QAAQb,UAAY,WAAa,WACxDtmB,MAAOu1C,EAAMnxC,KAAK,GAAK,EACvBnE,OAAQs1C,EAAMnxC,KAAK,GAAK,EACxBkyD,YAAY,EACZD,YAAa,SACbE,YAAY,UACZ5F,aAAa,EACblkC,IAAM8oB,EAAMA,MAAMpuB,QAAQb,UAAY,QAAaivB,EAAMnxC,KAAK,GAAO,EAAK,KAC1EsnB,KAAM,SAIRkjE,cAAe,SAACr5C,GAAD,OACbA,EAAMjvB,UACN,GAEA,CACEtmB,MAAM,EACN+wF,OAAO,EACPztF,SAAS,WACTmpB,IAAI,IAGRusD,aAAc,SAACzjC,GAAD,MAAwB,CACpCjyC,SAAU,WACVtD,MAAM,IACNC,OAAO,IACPq2D,YAAY,EACZD,YAAa,QACbE,YAAY,UACZ5F,aAAa,MACb1pC,QAAS,GACTwF,IAAK,GACLf,KAAM,GAEN2pC,WAAY,+DACZn0C,QAAS,OAGXyvE,oBAAqB,SAACp7C,GAAD,MAAwB,CAC3CjyC,SAAU,WACVtD,MAAM,IACNC,OAAO,IACPq2D,YAAY,EACZD,YAAa,QACbE,YAAY,UACZ5F,aAAa,MACb1pC,QAAS,GACTwF,IAAK,GACLf,KAAM,GAEN2pC,WAAY,+DACZn0C,QAAS,OAIX+uE,sBAAuB,SAAC16C,GACtB,IAAM16B,EAAyB,CAC7B6+B,QAAS,OACT15C,MAAM,QACNC,OAAO,QACP48B,gBAAgB,cAChBv5B,SAAS,WAGT+kD,OAAQ,WAgBV,OAdK9S,EAAMjvB,WAQTzL,EAAE,QAAc,OAChBA,EAAE,SAAe,WACjBA,EAAE,OAAa,SATfA,EAAE,QAAc,OAChBA,EAAE,SAAe,WACjBA,EAAE,OAAa,OACfA,EAAE,IAAU,OACZA,EAAE,KAAW,QASRA,GAGTg0E,eAAgB,SAACt5C,GACf,IAAM16B,EAAyB,CAC7B6+B,QAAS,OACTp2C,SAAU,WACVtD,OAAQu1C,EAAMnvB,OAAS,KACvBnmB,QAASs1C,EAAMnvB,OAAS,KACxB4lC,SAAU,SACVlS,WAAY,OACZic,SAAU,OACVtpC,IAAK,OACLf,KAAM,OACNqB,OAAQ,OACR8sB,UAAW,WAIXhd,gBAAiB,cACjB0c,WAAY,gBACZ8O,OAAQ,WAEV,GAAK9S,EAAMjvB,UAOJ,CACLzL,EAAE,QAAc,OAChBA,EAAE,SAAe,WACjBA,EAAE,OAAa,OAEf,IAAIm2E,EAAYxrF,OAAO+vC,EAAMA,MAAMjgB,OAAOjzB,IAAIhC,OAAOhB,GAEjD4xF,EAAY,IAAID,EAChBE,EAAQ,IAAO,IAAMF,EACrBG,EAAO,EAETA,EADCH,GAAa,GAAKA,EAAY,EACxB,IAAO,EAAIA,EACI,IAAdA,EACD,IAAO,EAAIA,EACVA,EAAY,IACb,IAAO,EAAIA,EACVA,EAAY,KAAQA,EAAY,GACjC,IAAO,EAAIA,EAEX,IAAO,EAAIA,EAEpBn2E,EAAE,IAAW06B,EAAM2zC,QAAYgI,EAAK,EACpCr2E,EAAE,KAA6C,QAAlC06B,EAAMA,MAAMpuB,QAAQd,UAAuBkvB,EAAM4zC,SAAY,IAAW5zC,EAAM4zC,SAAagI,EAAK,EAG7Gt2E,EAAE,UAAgB,SAASo2E,EAAU,SA/BrCp2E,EAAE,QAAc,OAChBA,EAAE,SAAe,WACjBA,EAAE,OAAa,OACfA,EAAE,IAAU,OACZA,EAAE,KAAW,OACbA,EAAE,UAAgB,WA4BpB,OAAOA,GAETsM,QAAS,SAACouB,GAAD,MAAwB,CAC/BjyC,SAAU,WACVmpB,KAAM8oB,EAAMjvB,UAAY+mB,GAAe,IAAMkI,EAAMtpB,QAvLlC,EAuL2D,GAC5EP,KAAM6pB,EAAMtpB,SAxLK,EAwLqB,EACtCjsB,MAAOu1C,EAAMnxC,KAAK,GAClBnE,OAAQs1C,EAAMnxC,KAAK,GACnB2xD,SAAU,OACVrW,cAAenK,EAAMikC,SAAW,OAAS,OACzCljB,YA7LiB,EA8LjBC,YAAa,SACbF,YAAa9gB,EAAMtpB,QAAU,QAAU,OACvCo8B,OAAQ9S,EAAMtpB,QAAU,eAAY7W,EACpC6R,QAASsuB,EAAMA,MAAMpuB,QAAQF,UAE/BmqE,KAAM,SAAC77C,GAAD,OACJA,EAAMjvB,UAAN,cAEE44C,WAAY,SACZlJ,WAAY,MAEZ1yD,SAAU,WACVmpB,IAAK,IACLf,KAAM,KACH+kC,IACD,CACFyO,WAAY,WAEhBmyB,IAAK,SAAC97C,GAAD,OACHA,EAAMjvB,UAAN,cACEozB,QAASnE,EAAMA,MAAM+7C,QAAU,OAAS,QACxCrxF,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,IACLf,KAAM,GACNsqC,WAAY,MACZ3N,OAAQ,UAERgN,WAAY9f,EAAMnvB,OAAS,UAAY,WACpCmvB,EAAMnvB,OAAWmvB,EAAMyzC,MAAQv4B,GAAcqzB,GAAsBvuC,EAAMyzC,MAAQv4B,GAAcmgC,IAChG,CAACl3C,QAAQ,SAGf63C,WAAY,SAACh8C,GAAD,OACVA,EAAMjvB,UAAN,cACEozB,QAASnE,EAAMA,MAAM+7C,QAAU,OAAS,QACxCrxF,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,IACLf,KAAM,GACNsqC,WAAY,MACZ3N,OAAQ,UACRgN,WAAY9f,EAAMnvB,OAAS,UAAY,WACpCmvB,EAAMnvB,OAAWmvB,EAAMyzC,MAAQv4B,GAAcqzB,GAAsBvuC,EAAMyzC,MAAQv4B,GAAcmgC,IAChG,CAACl3C,QAAQ,SAGf83C,KAAM,SAACj8C,GAAD,OACJA,EAAMjvB,UAAN,cACEozB,QAASnE,EAAMA,MAAM+7C,QAAU,OAAS,QACxCrxF,OAAQotC,GACR/pC,SAAS,WACTmpB,IAAK,GACLf,KAAM,GACNsqC,WAAY,MACZ3N,OAAQ,UAERgN,WAAyC,UAA7B9f,EAAMA,MAAMpuB,QAAQwmB,KAAmB,UAAY,WAC/B,UAA7B4H,EAAMA,MAAMpuB,QAAQwmB,KAAqB4H,EAAMyzC,MAAQv4B,GAAcqzB,GAAsBvuC,EAAMyzC,MAAQv4B,GAAcmgC,IACxH,CAACl3C,QAAQ,SAGf02C,YAAa,SAAC76C,GAAD,OACXA,EAAMjvB,UAAN,cACEozB,QAASnE,EAAMA,MAAM+7C,QAAU,OAAS,QACxCrxF,OAAQotC,GACR/pC,SAAS,WACTmpB,IAAK,IACLf,KAAM,GACNsqC,WAAY,MACZ3N,OAAQ,UACRgN,WAAyC,UAA7B9f,EAAMA,MAAMpuB,QAAQwmB,KAAmB,UAAY,WAC/B,UAA7B4H,EAAMA,MAAMpuB,QAAQwmB,KAAqB4H,EAAMyzC,MAAQv4B,GAAcqzB,GAAsBvuC,EAAMyzC,MAAQv4B,GAAcmgC,IACxH,CAACl3C,QAAQ,SAIf+3C,YAAa,SAACl8C,GAAD,OACXA,EAAMjvB,UAAN,cACEozB,QAAS,QACTz5C,OAAQotC,GACRmM,UAAW,SACXwc,WAAY,MACZ1yD,SAAS,WACT+kD,OAAQ,UACR57B,IAAK,IACLf,KAAM,IAEN2pC,WAAY,WACT5E,IACD,CAAC/W,QAAQ,SAGf42C,mBAAoB,SAAC/6C,GAAD,OAClBA,EAAMjvB,UAAN,cACEozB,QAAS,QACTz5C,OAAQotC,GACRmM,UAAW,SACXwc,WAAY,MACZ1yD,SAAS,WACT+kD,OAAQ,UACR57B,IAAK,IACLf,KAAM,IACN2pC,WAAY,WACT5E,IACD,CAAC/W,QAAQ,SAGfyrC,WAAY,SAAC5vC,GAAD,OACVA,EAAMjvB,UAAN,cACEozB,QAAS,QACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SAGX/sB,IAAK,IACLf,KAAM,IACNsqC,WAAY,MACZ3N,OAAQ,UACRgN,WAAY,WACT5E,IACD,CAAC/W,QAAQ,SAGf82C,kBAAmB,SAACj7C,GAAD,OACjBA,EAAMjvB,UAAN,cACEozB,QAAS,QACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,IACLf,KAAM,IACNsqC,WAAY,MACZ3N,OAAQ,UACRgN,WAAY,WACT5E,IACD,CAAC/W,QAAQ,SAGfg4C,UAAW,SAACn8C,GAAD,OACTA,EAAMjvB,UAAN,cACEozB,QAASnE,EAAMA,MAAM+7C,QAAU,OAAS,QACxCrxF,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,GACLf,KAAM,IACNsqC,WAAY,MACZ3N,OAAQ,UAERgN,WAAa9f,EAAMA,MAAMpuB,QAAQX,cAAgB,UAAY,WAC1D+uB,EAAMA,MAAMpuB,QAAQX,cAAkB+uB,EAAMyzC,MAAQv4B,GAAcqzB,GAAsBvuC,EAAMyzC,MAAQv4B,GAAcmgC,IACrH,CAACl3C,QAAQ,SAGf+2C,iBAAkB,SAACl7C,GAAD,OAChBA,EAAMjvB,UAAN,cACEozB,QAASnE,EAAMA,MAAM+7C,QAAU,OAAS,QACxCrxF,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,GACLf,KAAM,GACNsqC,WAAY,MACZ3N,OAAQ,UACRgN,WAAa9f,EAAMA,MAAMpuB,QAAQX,cAAgB,UAAY,WAC1D+uB,EAAMA,MAAMpuB,QAAQX,cAAkB+uB,EAAMyzC,MAAQv4B,GAAcqzB,GAAsBvuC,EAAMyzC,MAAQv4B,GAAcmgC,IACrH,CAACl3C,QAAQ,SAGfg3C,mBAAoB,SAACn7C,GAAD,OAClBA,EAAMjvB,UAAN,cACEozB,QAASnE,EAAMA,MAAM+7C,QAAU,OAAS,QACxCrxF,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,GACLf,KAAM,GACNsqC,WAAY,MACZ3N,OAAQ,UACRgN,WAAa9f,EAAMA,MAAMpuB,QAAQR,kBAAoB,UAAY,WAC9D4uB,EAAMA,MAAMpuB,QAAQX,cAAkB+uB,EAAMyzC,MAAQv4B,GAAcqzB,GAAsBvuC,EAAMyzC,MAAQv4B,GAAcmgC,IACrH,CAACl3C,QAAQ,SAGfi4C,YAAa,SAACp8C,GAAD,OACXA,EAAMjvB,UAAN,cACEozB,QAAS,QACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,IACLf,KAAM,IACNsqC,WAAY,MACZ3N,OAAQ,UACRgN,WAAY,WACT5E,IACD,CAAC/W,QAAQ,SAGfk4C,cAAe,SAACr8C,GAAD,OACbA,EAAMjvB,UAAN,cACEozB,QAAS,QACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,GACLf,KAAM,IACNsqC,WAAY,MACZ3N,OAAQ,UAERgN,WAAY,WACT5E,IACD,CAAC/W,QAAQ,SAGfw2C,qBAAsB,SAAC36C,GAAD,OACpBA,EAAMjvB,UAAN,cACEozB,QAAS,QACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,GACLf,KAAM,IACNsqC,WAAY,MACZ3N,OAAQ,UACRgN,WAAY,WACT5E,IACD,CAAC/W,QAAQ,SAGfm4C,iBAAkB,SAACt8C,GAAD,OAChBA,EAAMjvB,UAAN,cACEozB,QAAS,QACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,GACLf,KAAM,IACNsqC,WAAY,MACZ3N,OAAQ,UAERgN,WAAY,WACT5E,IACD,CAAC/W,QAAQ,SAGfy2C,wBAAyB,SAAC56C,GAAD,OACvBA,EAAMjvB,UAAN,cACEozB,QAAS,QACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAK,GACLf,KAAM,IACNsqC,WAAY,MACZ3N,OAAQ,UACRgN,WAAY,WACT5E,IACD,CAAC/W,QAAQ,SAGfo4C,eAAgB,SAACv8C,GAAD,OACdA,EAAMjvB,UAAN,cACEozB,QAAS,QACTz5C,OAAQotC,GACR/pC,SAAS,WACTmpB,IAAK,MACLf,KAAM,QACNsqC,WAAY,MACZ3N,OAAQ,UAERgN,WAAY,WACT5E,IACD,CAAC/W,QAAQ,SAGfq4C,KAAM,SAACx8C,GAAD,OACJA,EAAMjvB,UAAN,cACEozB,QAAUnE,EAAMA,MAAM+7C,UAAY5vE,GAAkB6zB,EAAMA,MAAMpuB,SAAY,OAAS,QACrFlnB,OAAQotC,GACR2oB,WAAY,MACZ3N,OAAQ,UACRgN,WAAY,UACZ/xD,SAAU,WACVmpB,IAAK,IACLf,KAAM,KACH+kC,IACD,CAAC/W,QAAQ,SAEfr8B,KAAM,SAACk4B,GAAD,qBACJmE,QAASnE,EAAMjvB,UAAY,QAAU,OACrCrmB,OAAQotC,GACR/pC,SAAS,WACTmpB,IAAK,IACLf,KAAM,GAEN2pC,WAAY,WACT5E,KAELvhC,MAAO,SAACqmB,GAAD,qBACL2pB,WAAY3pB,EAAMjvB,UAAY,UAAY,SAC1ChjB,SAAS,WACTk2C,UAAW,OACX/sB,IAAK,GACLf,KAAM,IACN+tB,MAAM,EACNiX,OAAO,EACPzX,QAAQ,EACRh5C,OAAQotC,GACRsjB,aAAc,cAEdtI,OAAQ,UACRgN,WAAY,WACT5E,KAGL8/B,aAAc,SAACh7C,GAAD,qBACZ2pB,WAAY3pB,EAAMjvB,UAAY,UAAY,SAC1ChjB,SAAS,WACTk2C,UAAW,OACX/sB,IAAK,GACLf,KAAM,IACN+tB,MAAM,EACNiX,OAAO,EACPzX,QAAQ,EACRh5C,OAAQotC,GACRsjB,aAAc,cACdtI,OAAQ,UACRgN,WAAY,WACT5E,KAGL49B,oBAAqB,SAAC94C,GAAD,MAAwB,CAC3CmE,QAAUnE,EAAMu4C,QAAuC,KAA7Bv4C,EAAMA,MAAMpuB,QAAQ1T,KAAe,QAAU,OACvE00C,WAAY,OACZ3T,SAAU70C,IAAiB,QAAU,MACrCK,OAAkC,IAA3Bu1C,EAAM9xC,KAAKP,aAAqBqyC,EAAM9xC,KAAKP,YAAsBqyC,EAAMnxC,KAAK,IACnFnE,QAAmC,IAA3Bs1C,EAAM9xC,KAAKP,aAAqBqyC,EAAM9xC,KAAKP,YAAsBqyC,EAAMnxC,KAAK,IACpF60C,QAAQ,EACRpc,gBAAiB,YACjB2c,UAAW,SACXmX,aAAc,EACd1I,aAAc,SACd3kD,SAAS,WACTypB,OAAQ,EACR8sB,UAAsC,IAA3BtE,EAAM9xC,KAAKP,YAAoB,eAA4C,KAA3BqyC,EAAM9xC,KAAKP,YAAqB,iBAA8C,MAA3BqyC,EAAM9xC,KAAKP,YAAsB,kBAA+C,MAA3BqyC,EAAM9xC,KAAKP,YAAsB,kBAAoB,eACxNwoB,KAAiC,IAA3B6pB,EAAM9xC,KAAKP,aAAgD,MAA3BqyC,EAAM9xC,KAAKP,aAAuB,EAA+B,MAA3BqyC,EAAM9xC,KAAKP,aAAuBqyC,EAAMnxC,KAAK,GAAKmxC,EAAMnxC,KAAK,IAAI,EAAI,IAAMmxC,EAAMnxC,KAAK,GAAKmxC,EAAMnxC,KAAK,IAAI,EACtLqoB,IAAiC,IAA3B8oB,EAAM9xC,KAAKP,YAAoB,EAA+B,MAA3BqyC,EAAM9xC,KAAKP,aAAuB,GAAK,EAChFi5D,gBAAiB,WAGnBmyB,cAAe,SAAC/4C,GAAD,MAAwB,CACrCmE,QAAUnE,EAAMu4C,QAAuC,KAA7Bv4C,EAAMA,MAAMpuB,QAAQ1T,KAAe,QAAU,OACvE00C,WAAY,OACZ3T,SAAU70C,IAAiB,QAAU,MACrCK,MAA0C,GAAlCu1C,EAAMA,MAAMpuB,QAAQ1T,KAAKtN,OAAc,KAC/ClG,OAAQ,KACRw/C,aAAc,EACdtG,WAAuC,IAA3B5D,EAAM9xC,KAAKP,aAAgD,MAA3BqyC,EAAM9xC,KAAKP,aAAwBqyC,EAAMnxC,KAAK,GAAyC,GAAlCmxC,EAAMA,MAAMpuB,QAAQ1T,KAAKtN,QAAc,EAAI,EAAI,MAASovC,EAAMnxC,KAAK,GAAyC,GAAlCmxC,EAAMA,MAAMpuB,QAAQ1T,KAAKtN,QAAc,EAAI,EAAI,KAC1N02C,WAAY,GACZ5D,QAAQ,EACRpc,gBAAiB,UACjB2c,UAAW,SACXmX,aAAc,EACd3E,SAAS,SACT/D,aAAc,SACd3kD,SAAS,WACTypB,OAAQ,IAGVwhE,qBAAsB,SAACh5C,GAAD,MAAwB,CAC5CmE,QAAUnE,EAAMA,MAAMpuB,QAAQX,cAAgB,QAAU,OACxD2hC,WAAY,OACZ3T,SAAU70C,IAAiB,QAAU,MACrCK,OAAkC,IAA3Bu1C,EAAM9xC,KAAKP,aAAqBqyC,EAAM9xC,KAAKP,YAAsBqyC,EAAMnxC,KAAK,IACnFnE,QAAmC,IAA3Bs1C,EAAM9xC,KAAKP,aAAqBqyC,EAAM9xC,KAAKP,YAAsBqyC,EAAMnxC,KAAK,IACpF60C,QAAQ,EACRpc,gBAAiB,YACjB2c,UAAW,SACXmX,aAAc,EACd1I,aAAc,SACd3kD,SAAS,WACTypB,OAAQ,EACR8sB,UAAsC,IAA3BtE,EAAM9xC,KAAKP,YAAoB,eAA4C,KAA3BqyC,EAAM9xC,KAAKP,YAAqB,iBAA8C,MAA3BqyC,EAAM9xC,KAAKP,YAAsB,kBAA+C,MAA3BqyC,EAAM9xC,KAAKP,YAAsB,kBAAoB,eAExNwoB,KAAiC,IAA3B6pB,EAAM9xC,KAAKP,aAAgD,MAA3BqyC,EAAM9xC,KAAKP,aAAuB,EAA+B,MAA3BqyC,EAAM9xC,KAAKP,aAAuBqyC,EAAMnxC,KAAK,GAAKmxC,EAAMnxC,KAAK,IAAI,EAAI,GAAKmxC,EAAMnxC,KAAK,GAAKmxC,EAAMnxC,KAAK,IAAI,EAAI,EAEzLqoB,KAAiC,IAA3B8oB,EAAM9xC,KAAKP,aAAyBqyC,EAAM9xC,KAAKP,aAAf,GAEtCi5D,gBAAiB,WAGnBqyB,eAAgB,SAACj5C,GAAD,MAAwB,CACtCmE,QAAUnE,EAAMA,MAAMpuB,QAAQX,cAAgB,QAAU,OACxD2hC,WAAY,OACZ3T,SAAU70C,IAAiB,QAAU,MACrCK,MAAQ,OACRC,OAAQ,OACRk5C,WAAuC,IAA3B5D,EAAM9xC,KAAKP,aAAgD,MAA3BqyC,EAAM9xC,KAAKP,aAAwBqyC,EAAMnxC,KAAK,GAAO,IAAK,EAAI,EAAI,MAASmxC,EAAMnxC,KAAK,GAAO,IAAK,EAAI,EAAI,KACtJy4C,UAAsC,IAA3BtH,EAAM9xC,KAAKP,aAAgD,MAA3BqyC,EAAM9xC,KAAKP,YAAsBqyC,EAAMnxC,KAAK,GAAK,GAAKmxC,EAAMnxC,KAAK,GAAK,GACjHq7C,aAAc,MACdxG,QAAQ,EACRpc,gBAAiB,UACjB2c,UAAW,SACXmX,aAAc,EACd3E,SAAS,SACT/D,aAAc,SACd3kD,SAAS,WACTypB,OAAQ,IAGVq4D,aAAc,SAAC7vC,GAAD,MAAuB,CACnCmE,QAAS,QACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAM8oB,EAAM59B,MAAQ,GACpB+T,KAAO6pB,EAAM79B,MAAQ,GACrBs+C,WAAY,QAGdqvB,iBAAkB,SAAC9vC,GAAD,MAAuB,CACvCmE,QAAS,OACTz5C,OAAQotC,GACR/pC,SAAS,WACTk2C,UAAW,SACX/sB,IAAM8oB,EAAM59B,MAAQ,GACpB+T,KAAO6pB,EAAM79B,MAAQ,GACrBs+C,WAAY,QAGd45B,aAAa,CACXvnC,OAAQ,UAIN8mC,GAAe,CACnBpiE,QAAQ,EACR+iE,YAAY,EACZC,aAAa,EACbrkE,MAAM,EACN+tB,OAAO,EACPhtB,KAAK,EACLkjE,SAAS,EACTE,UAAS,GAELX,GAAgB,CACpBniE,QAAQ,EACR+iE,YAAY,EACZC,aAAa,EACbrkE,MAAM,EACN+tB,OAAO,EACPhtB,KAAK,EACLkjE,SAAS,EACTE,UAAS,GAGLD,GAAe,CACnB5vF,MAAO,OACPC,OAAQ,OACR2T,MAAO,QACP+8C,aAAc,MACdtI,OAAQ,QAGVgiC,GAAWt1C,YAAc,aI/yElB,IAAMi9C,GAAuB,SAACz8C,GACnC,MAAO,CACL5Q,QAAS,SAACgkD,GACR7/D,GAAW,0BAA2BysB,EAAMpuB,QAAQ5L,IACpDotE,EAAIr0C,kBACJiB,EAAMjgB,OAAOjzB,IAAIqtC,cAAchwC,OAAO61C,EAAMpuB,QAAQ5L,IACpDg6B,EAAMjgB,OAAOjzB,IAAIqtC,cAAchwC,OAAO,eACtC61C,EAAMjgB,OAAOuC,SAASmT,cAAcuK,EAAMpuB,QAAQ5L,KAEpDq+C,cAAc,SAACj5D,GAEb40C,EAAMjgB,OAAOuC,SAASkX,cAAc/7B,OAAO+D,OAAO,GAAIpW,KAExD86D,WAAW,SAAC96D,GACV40C,EAAMjgB,OAAOuC,SAASo6D,gBAAgBj/E,OAAO+D,OAAO,GAAIpW,OAKjDuxF,GAA+C,SAAC38C,GAC3D,OAAO,eAAC,GAAD,6BAAgBA,GAAhB,IAAuBw0B,eAAe,GAAWioB,GAAqBz8C,MAG/E28C,GAAcn9C,YAAc,gB,qDCT5B,SAASo9C,GAAmBhrE,GpG4GrB,IAA6BxmB,EoG3GlC,IpG2GkCA,EoG3GVwmB,IpG4GXxmB,EAAE8C,KAAKH,SAAS,KAAOue,GoG1GpC,OAAOsF,EAIF,IAAMirE,GACwE,SAAC78C,GACpF,IAAMyI,EAAU4X,GAAa,CAAC31D,OAAOs1C,EAAM8iB,WAAY7jB,SAASe,EAAMf,WACtE,EAAgCuH,KAAMtF,UAAS,GAA/C,mBAAO6tC,EAAP,KAAiBC,EAAjB,KACM/uE,EAAMumC,KAAMQ,OAA0B,MACb81C,GAAgB98C,EAAxC8iB,WAAwC9iB,EAA5BpuB,QAAnB,aAA+CouB,EAA/C,KACI+8C,OAA0Cl9E,EACxC/S,EAAMkzC,EAAMjgB,OAAOjzB,IAEnBkwF,EAAWl3C,cAAY,WAC3B,OAAO9F,EAAMpuB,QAAQlB,aAGjBusE,EAAan3C,cAAY,WAC7B,OAAO9F,EAAMpuB,QAAQjB,YAGjBusE,EAAap3C,cAAY,WAC7B,IAAIznC,EAAQ2hC,EAAMpuB,QAAQvT,MACrBA,EAAMzN,SAEPyN,EADF,OAAI2+E,QAAJ,IAAIA,KAAUpsF,OACJF,EAAkBssF,GAElB,CAAC,IAAM,IAAM,MAGzB,IAAItrF,EAAYsuC,EAAMpuB,QAAQvT,MACzB3M,EAAUd,SACbc,EAAYV,EAAiBqN,IAE/B,IAAMiD,EAAanQ,EAAoBkN,GAEvC,MADe,CAACjN,EAAUiN,GAAQjN,EAAUM,GAAYN,EAAUkQ,OAI9D67E,EAA2C,QAA5Bn9C,EAAMpuB,QAAQd,UAAuB,QAAuC,YAA5BkvB,EAAMpuB,QAAQd,UAA2B,YAA2C,SAA5BkvB,EAAMpuB,QAAQd,UAAwB,OAAsC,WAA5BkvB,EAAMpuB,QAAQd,UAA0B,SAAW,GAEhO,OAAO,eAAC,KAAD,UAAW,WAAM,IAAD,IACfssE,EAAWxqB,GAAiB5yB,EAAMpuB,QAAQ9J,KAAMk4B,EAAMf,UACtDr3B,EAASpW,EAAewuC,EAAMpuB,QAAQlB,WAQ5C,OANA,UAAIsvB,EAAMpuB,QAAQvT,aAAlB,OAAI,EAAqBzN,SAASgX,EAAO,GAAKxW,EAAU4uC,EAAMpuB,QAAQvT,QACtE,UAAI2hC,EAAMpuB,QAAQlgB,iBAAlB,OAAI,EAAyBd,SAASgX,EAAO,GAAKxW,EAAU4uC,EAAMpuB,QAAQlgB,YACtEq9E,IACFgO,EAAgBH,GAAmB58C,EAAMjgB,OAAOuC,SAASha,KAAK03B,EAAMpuB,QAAQ5L,MAGvE,uCACL,eAACilC,GAAA,EAAD,CAAS9oB,MAAO,uCAAG6d,EAAMpuB,QAAQ1T,KAAK,wBAAO8hC,EAAMpuB,QAAQlB,aAAew6B,UAAU,QAApF,SACE,gBAAChM,GAAA,EAAD,CAAQj/B,IAAKA,EAA+B6oC,UAAWL,EAAQkY,KAE7DzqC,MAAO,CAAkC7X,MAAM,UAA0B88C,OAAQ,iBAAkB/b,cAAc,OAAQrxC,SAAS,WAAYooB,KAAK,MAAOmxB,UAAW,MAAOpwB,IAAI,MAAOxsB,OAAON,IAAiB,OAAS,QACxNm1C,QAAS,WACP,IAAMtV,EAAQ3H,GAASha,KAAK03B,EAAMpuB,QAAQ5L,IAC1C,GAAIikB,EACFn9B,EAAI02C,QAAQvZ,OACT,CACH3H,GAAS+6D,eAAe,CAACr9C,EAAMpuB,QAAQ5L,KACvC,IAAM2sB,EAAWjwB,cAAQ,WACvB,IAAMunB,EAAQ3H,GAASha,KAAK03B,EAAMpuB,QAAQ5L,IACtCikB,IACFn9B,EAAI02C,QAAQvZ,GACZ0I,UAKRiY,cAAe,WAEb,GADcgyC,GAAmBt6D,GAASha,KAAK03B,EAAMpuB,QAAQ5L,KAE3DgpE,GAAY,GACZliF,EAAIqtC,cAAc/X,IAAI,mBACnB,CACHE,GAAS+6D,eAAe,CAACr9C,EAAMpuB,QAAQ5L,KACvC,IAAM2sB,EAAWjwB,cAAQ,WACTk6E,GAAmBt6D,GAASha,KAAK03B,EAAMpuB,QAAQ5L,OAE3DgpE,GAAY,GACZliF,EAAIqtC,cAAc/X,IAAI,eACtBuQ,UA9BV,UAmCEyqD,EACF,uBAAKlnE,MAAO,CAACnoB,SAAS,WAAYsQ,MAAM,UAAW8X,KAAK,MAAOguB,QAAQ,OAAQlF,SAAS70C,IAAiB,OAAS,QAAlH,UAEC+yF,EACD,sBAAKjnE,MAAO,CAACnoB,SAAS,WAAYooB,KAAK,MAAO9X,MAAM,WAApD,SACwB,KAAvB2hC,EAAMpuB,QAAQ1T,KAAa,KAAO8hC,EAAMpuB,QAAQ1T,KAAO,IAAM,QAGhD,KAAb8+E,EACD,sBAAK9mE,MAAO,CAACnoB,SAAS,WAAYtD,MAAM,OAAQy5C,MAAM95C,IAAiB,OAAS,OAAQ65C,UAAU,QAAS/sB,IAAI,OAA/G,SACA,eAAC,GAAD,CAAao7B,QAAQ,EAAM1qC,OAAQs1E,EAAYruF,KAAMzE,IAAiB,GAAK,GAAI8T,UAAmB2B,IAAbm9E,EAAyBA,EAAW,GAAI5+E,eAA0ByB,IAAfo9E,EAA2BA,EAAa,OACvK,QAGX,eAAC,GAAD,0CAAuBH,GAAvB,IAAqClrE,QAASmrE,GACxCN,GAAqBz8C,IAD3B,IACmCltB,KAAMi8D,EACvCp1D,MAAO,WACLq1D,GAAY,GACXliF,EAAIqtC,cAAchwC,OAAO,gBAE5B49C,SAAU9nC,EAAIg3B,QAAS+Q,aAAc,CAACC,SAAS,MAAOC,WAAW,mBAM5Do1C,GAAgD,SAACt9C,GAG5D,IAAM1d,EAAW0d,EAAMjgB,OAAOuC,SACxBC,EAAMujB,cAAY,WACtB,IAAMvjB,EAENtG,MAAMnT,KAAKwZ,EAASC,KAUpB,OATAA,EAAIpzB,MAAK,SAACrF,EAAEC,GACV,IAAIub,EAAKxb,EAAEoU,KAAKq/E,cAAcxzF,EAAEmU,MAKhC,OAJW,IAAPoH,IAAWA,EAAKxb,EAAE4mB,UAAU6sE,cAAcxzF,EAAE2mB,YACrC,IAAPpL,IAAWA,EAAKxb,EAAEge,KAAKy1E,cAAcxzF,EAAE+d,OAChC,IAAPxC,IAAWA,EAAKxb,EAAEkc,GAAGu3E,cAAcxzF,EAAEic,KAElCV,KAGFid,KAGLi7D,EAAgB,EACpBj7D,EAAIpG,QAAO,SAAA4vB,GAAI,MAAuB,WAAnBA,EAAKj7B,aAAwBhkB,KAAI,SAAC8kB,EAAS4hB,GAAV,MAC5B,WAAtB5hB,EAAQd,UAAyB0sE,IAAkB,KAKrD,IAAM9mE,EAAUovB,cAAY,kBAAMxjB,EAAS5L,WACrC+xB,EAAU4X,GAAa,CAAC31D,OAAOs1C,EAAM8iB,WAAY7jB,SAASe,EAAMf,WAChE54B,EAAey/B,cAAY,kBAAM9F,EAAMjgB,OAAO1Z,gBAE9Co3E,EAAWl7D,EAAIz1B,KAAI,SAAA1B,GAAC,MACR,WAAhBA,EAAE0lB,UACF,eAAC,GAAD,2BAAwBc,QAAWxmB,GAAO40C,GAA1C,IAAiD09C,GAAIr3E,IAAnCjb,EAAE4a,IAEZ,kCAEHlU,EAAKI,KAALJ,EAYP,OAAO,uBAAKg3C,UAAWL,EAAQlD,UAAxB,UACL,uBAAKuD,UAAWL,EAAQtmB,MAAOjM,MAAO,CAAC7X,MAAM,YAAaulC,WAAWx5C,IAAiB,OAAO,MAAOs5C,QAAQ,OAAQ0X,aAAa,MAA4C9T,UAAU,MAAO/C,WAAW,OAAQqO,WAAW,OAAQ3T,SAAS70C,IAAiB,OAAS,QAAvQ,UAAiT0H,EAAE,YAAnT,KAAmU0rF,EAAqDlsF,WAAxX,IACGolB,EAAU,gBAACwoB,GAAA,EAAD,CAAQC,QAAQ,YAAYtwC,KAAK,QAAQwP,MAAM,YACxD6X,MAAO,CAAC0tB,WAAW,EAAGF,QAAQ,EAAGh5C,OAAO,SAAUu0C,SAAS,OAC3DM,QAAS,WAAMjd,EAASwX,WAAW,KAF1B,UAGP,eAAC,KAAD,CAAU5jB,MAAO,CAAC+oB,SAAS,UAHpB,OAGqCntC,EAAE,wBAA2B+N,KAE9E49E,MAGLH,GAAY99C,YAAc,c,qCCvLbm+C,GAA4C,SAAC39C,GACxD,IAAOluC,EAAKI,KAALJ,EACDopB,EAAO4qB,cAAY,WAAK,IAAD,IACrB/pB,EAAwB,GACxB6hE,EAAU,UAAG37D,GAAWsT,qBAAd,iBAAG,EAA0Bta,eAA7B,aAAG,EAAmCC,KAClD0iE,GAAY7hE,EAAM5T,KAAKy1E,GAC3B,IAAMC,EAAgC5hE,MAAMnT,KAAKmZ,GAAW8Q,YAAY9oB,UACrEnd,KAAI,SAAA0Z,GAAM,yBAAIA,EAAOmU,iBAAX,iBAAI,EAAkBM,eAAtB,aAAI,EAA2BC,QAAyBiB,QAAO,SAAAvvB,GAAC,YAAMiT,IAAJjT,KAC/EmvB,EAAM5T,KAAN,MAAA4T,EAAK,YAAS8hE,IAId,IAHA,IAAMC,EAA+C,GAC/C7wF,EAAM,GACNivB,EAAuB,GATF,aAUvB,IAAMwN,EAAE,KACV,IAAI,IAAM33B,KAAO23B,EACH,SAAR33B,GAA0B,YAARA,GAA6B,gBAARA,GAAiC,iBAARA,IAC9D9E,EAAI8E,GAAM9E,EAAI8E,GAAO9E,EAAI8E,GAAQ23B,EAAW33B,GAC3C9E,EAAI8E,GAAQ23B,EAAW33B,IAGhC,GAAI23B,EAAG9L,aAAa,CAClB,IAAMmgE,EAAMr0D,EAAG9L,aAAaogE,YAAY,KAClCC,EAAav0D,EAAG9L,aAAc7Q,UAAU,EAAEgxE,GAC1CG,EAAWJ,EAAQx1E,MAAK,SAAA1b,GAAC,OAAIA,EAAE,KAAK88B,EAAGjP,KAAO7tB,EAAE,GAAGmgB,UAAU,EAAGgxE,KAASE,KAC/E,GAAKC,EAEA,CACH,IAAMpgE,EAAO4L,EAAG9L,aAAc7Q,UAAUgxE,EAAI,GAC5CG,EAAS,IAAT,WAAmBpgE,QAHnBggE,EAAQ31E,KAAK,CAACuhB,EAAGjP,IAAKiP,EAAG9L,aAAc8L,EAAGjM,OAK5CvB,EAAQ/T,KAAR,MAAA+T,EAAO,YAASwN,EAAGxN,YAjBvB,MAAgBH,EAAhB,eAAuB,IAoBvB,GAAIA,EAAMnrB,OAAO,CACf,IAAMutF,EAAWlxF,EACjBkxF,EAASxhE,aAAewhE,EAASxhE,aAAewhE,EAASxhE,aAAaZ,EAAMnrB,YAASiP,EACrFs+E,EAASrhE,OAASqhE,EAASrhE,OAASqhE,EAASrhE,OAAOf,EAAMnrB,YAASiP,EACnEs+E,EAASngE,QAAUmgE,EAASngE,QAAUmgE,EAASngE,QAAQjC,EAAMnrB,YAASiP,EACtEs+E,EAASvhE,cAAiBuhE,EAASvhE,cAAgBuhE,EAASvhE,cAAcb,EAAMnrB,YAASiP,EAE3F,IAAMwZ,EAAO0Q,GAAUiS,MAAMnZ,IAAI,uBAAoBhjB,EAAY+F,OAAOmlB,cACxE,MAAO,CACLpQ,UAAWoB,EAAMnrB,OAAS3D,OAAuB4S,EACjDqc,UACA4hE,UACAzkE,WAIGM,EAAwBqmB,EAAxBrmB,MAAUykE,EAAjB,aAA+Bp+C,EAA/B,IACA,OAAO,eAACq+C,GAAA,EAAD,6BAAYD,GAAZ,IAAwBE,eAAe,EAAOpoE,MAAO,CAACvK,OAAO,GAA7D,SACL,gBAAC4yE,GAAA,EAAD,CAAOroE,MAAO,CAAC4pC,WAAW,sBAAuBpc,QAAQ,SAAzD,UACE,uBAAKxtB,MAAO,CAAC4tB,UAAU,QAAvB,UACE,kCAAShyC,EAAE,sBAA6B,wBACxC,2CAAaopB,EAAK7B,QACO,IAAxB6B,EAAK4iE,QAAQltF,OAAe,mDAC3BsqB,EAAK4iE,QAAQhxF,KAAI,SAAC0xF,EAAQluD,GAAT,OAAiB,uCAChB,SAAZkuD,EAAO,GAAY,SAAI,SADK,IACCA,EAAO,GACvCA,EAAO,GAAK,uCAAE,wBAAF,YAAmBA,EAAO,WAAS3+E,IAFNywB,MAI9C,eAAC,GAAD,CAAgBpV,KAAMA,EAAKP,UAAWuB,QAAShB,EAAKgB,aAEtD,eAACgjB,GAAA,EAAD,CAAQC,QAAQ,YAAY9gC,MAAM,UAAU6X,MAAO,CAACkpB,cAAc,OAAQkI,UAAU,SAClF/H,QAAS5lB,EADX,SAEI7nB,EAAE,oB,qEC3CNs2C,GAAYC,aAAW,CAC3B23B,aAAc,SAAChgC,GAAD,MAAwB,CACpCjyC,SAAU,WACVtD,MAAoB,GAAbu1C,EAAMnxC,KACbnE,OAAqB,GAAbs1C,EAAMnxC,KACdsnB,MAAoB,GAAd6pB,EAAMnxC,KACZqoB,KAAmB,GAAd8oB,EAAMnxC,KACXs7C,cAAe,OACf7F,UAAW,WACXN,WAAY,gDAEdi8B,iBAAkB,SAACjgC,GAAD,MAAwB,CACxCjyC,SAAU,WACVtD,MAAoB,GAAbu1C,EAAMnxC,KACbnE,OAAqB,GAAbs1C,EAAMnxC,KACdsnB,KAAmB,GAAb6pB,EAAMnxC,KACZqoB,IAAkB,EAAb8oB,EAAMnxC,KACXs7C,cAAe,OACf7F,UAAW,WACXN,WAAY,kBAIHy6C,GAAkF,SAACz+C,GAC9F,IAAMlzC,EAAMkzC,EAAMjgB,OAAOjzB,IACnBoR,EAAO4nC,cAAY,kBAAO9F,EAAM74B,YAAYjG,YAAYhD,QACxDE,EAAY0nC,cAAY,kBAAO9F,EAAM74B,YAAYjG,YAAY9C,aAC7DwJ,EAASk+B,cAAY,kBlH+DtB,SAA+B5kC,GACpC,IAAI7C,EAAQ6C,EAAY7C,MACnBA,EAAMzN,SAEPyN,EADE6C,EAAYhD,KAAKtN,OACXF,EAAkBwQ,EAAYhD,MAE9B,CAAC,IAAM,IAAM,MAGzB,IAAIxM,EAAYwP,EAAYxP,UACvBA,EAAUd,SACbc,EAAYV,EAAiBqN,IAE/B,IAAMiD,EAAanQ,EAAoBkN,GAGvC,MAFe,CAACjN,EAAUiN,GAAQjN,EAAUM,GAAYN,EAAUkQ,IkH7EjCo9E,CAAsB1+C,EAAM74B,YAAYjG,gBACnErS,EAAOi3C,cAAY,kBAAM9F,EAAM8iB,cAC/Bra,EAAU4X,GAAa,CAAC31D,OAAOs1C,EAAM8iB,WAAY7jB,SAASe,EAAMf,WACtE,EAAgCuH,KAAMtF,UAAS,GAA/C,mBAAO6tC,EAAP,KAAiBC,EAAjB,KACM/uE,EAAMumC,KAAMQ,OAA0B,MACtB23C,GAAgB3+C,EAA/B8iB,WAAP,aAAsC9iB,EAAtC,KAGM4+C,EAAex2C,GAAU,CAC7Bv5C,KAAMzE,IAAqC,EAAnB41C,EAAM8iB,WAAsC,IAAnB9iB,EAAM8iB,aAGnD2d,EAAe36B,cAAY,kBAAM9F,EAAM74B,YAAY6W,WAKnD6gE,EAAW/4C,cAAY,WAC3B,IADiC,EAC7B9mB,EAAU/C,MAAMnT,KAAKk3B,EAAMjgB,OAAO1Z,aAAaG,OAAO9I,QAAQye,QAAO,SAAApqB,GAAG,OAAIA,IAAQiuC,EAAMjgB,OAAO1Z,aAAaW,WADjF,cAElBgY,EAAQskB,WAFU,IAEjC,IAAI,EAAJ,qBAAkC,CAAC,IAAD,EAC+C,MACkF,IAF1J3yC,EAAyB,0BAChC,QAAoEkP,KAAjE,UAAAmgC,EAAMjgB,OAAO1Z,aAAaG,OAAO3d,IAAIm2B,EAAQruB,WAA7C,eAAkD4nC,YAKnD,MAAO,GAJP,IAAG,UAAAyH,EAAMjgB,OAAO1Z,aAAaG,OAAO3d,IAAIm2B,EAAQruB,WAA7C,eAAkDqV,MAAOg6B,EAAM74B,YAAYnB,IAA6E,MAAvE,UAAAg6B,EAAMjgB,OAAO1Z,aAAaG,OAAO3d,IAAIm2B,EAAQruB,WAA7C,mBAAkD4nC,kBAAlD,eAA8Dr6B,MAChJ,MAAO,gBAAO8hC,EAAMjgB,OAAO1Z,aAAaG,OAAO3d,IAAIm2B,EAAQruB,WAApD,iBAAO,EAAkD4nC,kBAAzD,aAAO,EAA8Dr6B,MAAO,KALxD,kCAc7B4gF,EAAeh5C,cAAY,WAC/B,IADqC,EACjC9mB,EAAU/C,MAAMnT,KAAKk3B,EAAMjgB,OAAO1Z,aAAaG,OAAO9I,QAAQye,QAAO,SAAApqB,GAAG,OAAIA,IAAQiuC,EAAMjgB,OAAO1Z,aAAaW,WAD7E,cAEtBgY,EAAQskB,WAFc,IAErC,IAAI,EAAJ,qBAAkC,CAAC,IAAD,EACkD,IACmF,EAF9J3yC,EAAyB,0BAChC,GAA8E,MAA3E,UAAAqvC,EAAMjgB,OAAO1Z,aAAaG,OAAO3d,IAAIm2B,EAAQruB,WAA7C,eAAkDi2B,YAAY3kB,UAK/D,MAAO,GAJP,IAAG,UAAA+9B,EAAMjgB,OAAO1Z,aAAaG,OAAO3d,IAAIm2B,EAAQruB,WAA7C,eAAkDqV,MAAOg6B,EAAM74B,YAAYnB,IAAiF,MAA3E,UAAAg6B,EAAMjgB,OAAO1Z,aAAaG,OAAO3d,IAAIm2B,EAAQruB,WAA7C,eAAkDi2B,YAAY3kB,UAChJ,iBAAO+9B,EAAMjgB,OAAO1Z,aAAaG,OAAO3d,IAAIm2B,EAAQruB,WAApD,aAAO,EAAkDi2B,YAAY3kB,UALtC,kCAYjC88E,EAAcj5C,cAAY,kBAAM9F,EAAMjgB,OAAO1Z,aAAaI,MAAMmgB,YAAY3kB,YAC5E+8E,EAAYl5C,cAAY,iCAAsDjmC,KAA/C,UAAAmgC,EAAMjgB,OAAO1Z,aAAaI,MAAM2xB,YAAhC,eAAsCl6B,OAAqE,MAA/C,UAAA8hC,EAAMjgB,OAAO1Z,aAAaI,MAAM2xB,YAAhC,eAAsCl6B,MAAe,gBAAK8hC,EAAMjgB,OAAO1Z,aAAaI,MAAM2xB,YAArC,aAAK,EAAsCl6B,MAAK,IAAM,MAE5M,SAASqhC,IACP,GAAIS,EAAM74B,YAAY5F,QAAQzC,QAC5BhS,EAAI02C,QAAQxD,EAAM74B,iBACf,CACAvB,OAAOmlB,eACR9I,GAAW0S,eAAexH,4BACxBniB,GAAYD,2BAA4B,CAACi1B,EAAM74B,YAAYnB,KAE/D,IAAM2sB,EAAWjwB,cAAQ,WACnBs9B,EAAM74B,YAAY5F,QAAQzC,UAC5BhS,EAAI02C,QAAQxD,EAAM74B,aAClBwrB,SAKR,SAASiY,IACP,GAAI5K,EAAM74B,YAAY5F,QAAQzC,QAC5BkwE,GAAY,GACZliF,EAAIqtC,cAAc/X,IAAI,uBACnB,CACAxc,OAAOmlB,eACR9I,GAAW0S,eAAexH,4BACxBniB,GAAYD,2BAA4B,CAACi1B,EAAM74B,YAAYnB,KAE/D,IAAM2sB,EAAWjwB,cAAQ,WACnBs9B,EAAM74B,YAAY5F,QAAQzC,UAC5BkwE,GAAY,GACZliF,EAAIqtC,cAAc/X,IAAI,mBACtBuQ,SAkCR,OAAO,uCACL,eAACsY,GAAA,EAAD,CAAS9oB,MAAO,uBAAMjM,MAAO,CAAC+oB,SAAS70C,IAAiB,OAAS,QAAjD,mBAA8D41C,EAAM74B,YAAYjG,YAAYhD,KAA5F,aAAqG8hC,EAAM74B,YAAYnB,GAAvH,OAAsIklC,UAAU,QAAhK,SACE,uBAAKpC,UAAWL,EAAQiY,MAA4CxqC,MAAO,CAACilC,OAAO,iBAAkBptD,SAAS,WAAYooB,KAAK,MAAOmxB,UAAW,MAAOpwB,IAAI,OAA5J,UACE,gBAAC2yB,GAAA,EAAD,CAAY3zB,MAAO,CAACilC,OAAO,EAAGzX,QAAQ,EAAG4D,UAAW,MAAO1D,WAAWx5C,IAAiB,OAAS,OAAQm1C,QAASA,EAASqL,cAAeA,EAAzI,UACE,eAAC,GAAD,CAAa0H,QAAQ,EAAM1qC,OAAQA,EAA0B/Y,KAAOzE,IAAyB,IAAPyE,EAAsB,EAAPA,EAAYqP,KAAMA,EAAME,UAAWA,IACxI,sBACAyE,IAAOm9B,EAAMjgB,OAAO1Z,aAAaW,UAAYg5B,EAAM74B,YAAYnB,GAC7C,UAAhB+4E,EAA0B7b,GAAgC,SAAhB6b,EAAyB5b,GAA+B,SAAhB4b,EAAyB3b,QAAcvjE,EAAgC,UAAjBi/E,EAA2B5b,GAAiC,SAAjB4b,EAA0B3b,GAAgC,SAAjB2b,EAA0B1b,QAAcvjE,EAEpQipC,UAAa9I,EAAMjgB,OAAO1Z,aAAaW,UAAYg5B,EAAM74B,YAAYnB,GACnD,KAAhB+4E,EAAqBH,EAAa3e,iBAAmB2e,EAAa5e,aAC9C,KAAjB8e,EAAsBF,EAAa3e,iBAAmB2e,EAAa5e,aACrEt7B,IAAI,QAEX,gBAACxF,GAAA,EAAD,CAAkC4J,UAAWL,EAAQkY,KAAM1gD,IAAKA,EAC9DiW,MAAO,CAAkC7X,MAAM,UAA0B+gC,cAAc,OAAQwE,WAAW,OAAQ0D,UAAW,OAAQsL,WAAY,OAAQ3T,SAAU70C,IAAiB,OAAS,OAAQM,OAAO,QAC5M60C,QAASA,EAASqL,cAAeA,EAFnC,UAGK1sC,EACD,sBAAKgY,MAAO,CAAC7X,MAAM,UAAWurD,cAAc,MAAO77D,SAAS,WAAY61C,WAAW,MAAO3E,SAAS70C,IAAiB,SAAW,QAA/H,SAA0I41C,EAAMjgB,OAAO1Z,aAAaW,UAAYg5B,EAAM74B,YAAYnB,GAAMg5E,EAAYH,OAExN,sBAAK3oE,MAAO,CAACnoB,SAAS,WAAYtD,MAAM,OAAQC,OAAO,OAAwCw5C,MAAM95C,IAAiB,OAAS,OAAQk9C,UAAW,OAAlJ,cACuBznC,IAAjB4gE,GAA8BA,EAAe,GAAM,sBAAKh2E,MAAOL,IAAiB,OAAS,OAAQM,OAAQN,IAAiB,OAAS,OAAQyY,IClM1I,irBDkM6J2hC,WAAW,EAAOtuB,MAAO,CAACquB,WAAW,QAASG,IAAI,UAA0B7kC,IAAjB4gE,GAA8BA,EAAe,IAAMA,EAAe,GAAM,sBAAKh2E,MAAOL,IAAiB,OAAS,OAAQM,OAAQN,IAAiB,OAAS,OAAQyY,IElMxX,qrBFkM8Y2hC,WAAW,EAAOtuB,MAAO,CAACquB,WAAW,QAASG,IAAI,KAAQ,sBAAKj6C,MAAOL,IAAiB,OAAS,OAAQM,OAAQN,IAAiB,OAAS,OAAQyY,IGlMhiB,yrBHkMkjB2hC,WAAW,EAAOtuB,MAAO,CAACquB,WAAW,QAASG,IAAI,YAK9mB1E,EAAM74B,YAAYnB,KAAOg6B,EAAMjgB,OAAO1Z,aAAaW,QAClD,eAAC,GAAD,CAAsB+Y,OAAQigB,EAAMjgB,OAAQjN,KAAMi8D,EAAUp1D,MAAO,WACjEq1D,GAAY,GACZliF,EAAIqtC,cAAchwC,OAAO,oBACxB49C,SAAU9nC,EAAIg3B,QAAS+Q,aAAc,CAACC,SAAS,MAAOC,WAAW,WACpE,eAAC,GAAD,6BAA2By2C,GAA3B,IAAyC7rE,KAAMi8D,EAAUp1D,MAAO,WAC9Dq1D,GAAY,GACZliF,EAAIqtC,cAAchwC,OAAO,oBACxBgd,YAAa64B,EAAMjgB,OAAO1Z,aAAaG,OAAO3d,IAAIm3C,EAAM74B,YAAYnB,IACrE+hC,SAAU9nC,EAAIg3B,QAAS+Q,aAAc,CAACC,SAAS,MAAOC,WAAW,gBAK5D+2C,GAA6F,SAACj/C,GACzG,MAAgCwG,KAAMtF,UAAS,GAA/C,mBAAOg+C,EAAP,KAAiBC,EAAjB,KACM94E,EAAe25B,EAAMjgB,OAAO1Z,aAE5BoiC,EAAU4X,GAAa,CAAC31D,OAAQs1C,EAAM8iB,WAAY7jB,SAAUe,EAAMf,WACjEj4B,EAA4Dg5B,EAA5Dh5B,QAASuwB,EAAmDyI,EAAnDzI,UAAWurB,EAAwC9iB,EAAxC8iB,WAAY7jB,EAA4Be,EAA5Bf,SAAamgD,EAApD,aAAmEp/C,EAAnE,IACMq/C,EAAS,cAAIv8B,aAAY7jB,YAAamgD,GAG5C7nD,EAAUpoC,MAAK,SAACrF,EAAGC,GACjB,IAAMu1F,EAAKj5E,EAAaG,OAAO3d,IAAIiB,GAC7By1F,EAAKl5E,EAAaG,OAAO3d,IAAIkB,GAC/Bub,EAAKg6E,EAAIp+E,YAAYhD,KAAKq/E,cAAcgC,EAAIr+E,YAAYhD,UAAM2B,EAAW,CAAC2/E,YAAa,WAK3F,OAJW,IAAPl6E,IACFA,GAAMg6E,EAAIp+E,YAAY9C,WAAa,IAAIm/E,cAAcgC,EAAIr+E,YAAY9C,WAAa,QAAIyB,EAAW,CAAC2/E,YAAa,YAG1Gl6E,KAET,IAAMm6E,EAAiBloD,EAAUzqC,KAAI,SAAAkZ,GAAE,OACrC,eAAC,GAAD,cACEmB,YAAad,EAAaG,OAAO3d,IAAImd,IACjCq5E,GAFgBr5E,MAGlB05E,EAAgB,eAAC,GAAD,cAA+Bv4E,YAAad,EAAaI,OAAW44E,GAA9Cr4E,GACtC/G,EAAMumC,KAAMQ,OAAuB,MAEzC,OACE,uBAAK8B,UAAWL,EAAQlD,UAAxB,UACE,uBAAKuD,UAAWL,EAAQtmB,MAAsCjM,MAAO,CAAC7X,MAAM,YAA4BulC,WAAYx5C,IAAiB,OAAS,MAAOs5C,QAAQ,OAAQ0X,aAAa,MAA4C9T,UAAU,MAAO/C,WAAW,OAAQqO,WAAW,OAAQ3T,SAAS70C,IAAiB,OAAS,QAAS6V,IAAKA,EACpUs/B,QAAS,WAAK4/C,GAAY,IAD5B,UAE2B/6E,eAAeK,QAAQ,QAFlD,MAE8D4B,EAAaG,OAAO3X,KAAO,GAAGyC,WAF5F,OAGA,eAAC,GAAD,2BAAcwhB,KAAMosE,EAClBvlE,MAAO,WAAKwlE,GAAY,KAAaC,GADvC,IACoDr3C,SAAU9nC,EAAIg3B,WACjEyoD,EAAcD,MAIrBR,GAAmBz/C,YAAc,kBAE1B,IAAMmgD,GAAkBn5C,KAAMigC,MACnC,SAACzmC,GACC,IAAMh5B,EAAU8+B,cAAY,kBAAM9F,EAAMjgB,OAAO1Z,aAAaW,WACtDuiB,EAAMuc,cAAY,kBAAM7pB,MAAMnT,KAAKk3B,EAAMjgB,OAAO1Z,aAAaG,OAAO9I,WAE1E,OAAO,eAAC,GAAD,6BAAwBsiC,GAAxB,IAA+Bh5B,QAASA,EAASuwB,UAAahO,QI7JnEq2D,GAAwB,CAC5B98B,WAAW,GACX7jB,SAAS,IAaX,IAAM4gD,GAAgBpiF,OAAO+D,OAAO,GAAIo+E,IAE3BE,GAA4C,SAAC9/C,GACxD,IAAMyI,EAAUmX,KAChB,EAA4B1e,oBAAiB,GAA7C,mBAAO3G,EAAP,KAAcwlD,EAAd,KAEMC,EAAWl6C,cAAY,kBAAM9F,EAAMjgB,OAAOuC,SAASC,OAUnD7U,EAAOy+D,aACX,CACEiG,QAAS,YAAwC,IAAD,gBAArCC,GAAqC,GAAhC/mF,EAAgC,KAA7BxB,EAA6B,KAAV28E,GAAU,EAAzBxvB,OAAyB,EAAjBt4B,MAAiB,EAAV8nD,MACpC,QAAa5mE,IAAT4mE,EACF,MAAO,CAACn7E,EAAGxB,GAEb,IAAOwoF,EAAP,YAAa7L,EAAb,MAOA,OApBW,SAAClsC,GAChB98B,OAAO+D,OAAOq+E,GAAeD,IAC7BC,GAAc5gD,UAAY1E,EAC1BslD,GAAc/8B,YAAcvoB,EAC5BwlD,EAAWxlD,GAaP0lD,CApCR,SAAoBvQ,EAAsBn1C,GACxC,IAAMo1C,EAAcD,EAAen1C,EAInC,OAAIo1C,EAHa,IAIbA,EAHa,MAKVA,EA4BQF,CAAWl1C,EADAjvC,EADN,GACkBA,EAAIgnF,EAAKhnF,GAD3B,GACyCgnF,EAAKhnF,EAAK,GAAKA,EAAIgnF,GAD5D,KAKP,CAAChnF,EAAGxB,KAGf,CACEqjF,aAAa,CAACrG,SAAQ,KAMpBoZ,EAAgBp6C,cAAY,kBC/G3Bq6C,MDmHDC,EAAmBt6C,cAAY,kBC9G9Bu6C,MDmHP,OACE,kDAAS3yE,KAAT,aACkB,SAAfsyB,EAAMl4B,KACP,gBAAC,KAAD,CAAW9X,MAAM,aAAaswF,YAAY,MAAMC,iBAAoB93C,EAAQ0X,kBAC1EqgC,UAAa,CAAC18C,UAAW,OAAQC,UAAW,SAAUt5C,MAAM,OAAQ2nD,SAAS,SAD/E,UAGI,eAACutC,GAAD,6BAAqB3/C,GAAW6/C,KAElC,eAAC,GAAD,6BAAe7/C,GAAY6/C,QAEX,YAAf7/C,EAAMl4B,KACT,eAAC,KAAD,CAAW9X,MAAM,aAAaswF,YAAY,OAAOC,iBAAoB93C,EAAQ0X,kBAC3EqgC,UAAa,CAAC18C,UAAW,OAAQC,UAAW,SAAUt5C,MAAM,OAAQ2nD,SAAS,SAD/E,SAEI,eAAC,GAAD,6BAAiBpS,GAAY6/C,OAGjC,qCACCG,EAAS7jE,QAAO,SAAA4vB,GAAI,MAAuB,WAAnBA,EAAKj7B,aAAwBhkB,KAAI,SAAA8kB,GAAO,OAC9DsuE,IAAkBtuE,EAAQ9J,OAA8B,IAAtBs4E,EACnC,eAAC,KAAD,CAAWpwF,MAAM,aAAaswF,YAAY,OAAOC,iBAAoB93C,EAAQ0X,kBAC3EqgC,UAAa,CAAC18C,UAAW,OAAQC,UAAW,SAAUt5C,MAAM,OAAQ2nD,SAAS,SAD/E,SAEI,yBAAQvvC,IAAM+O,EAAQxpB,IAAK+5B,MAAOvQ,EAAQ9J,KAAM24E,mBAAmB,EAAMC,YAAa,EAAGxqE,MAAO,CAACzrB,MAAM,OAAQC,OAAO,YAExH,wCAOVo1F,GAAQtgD,YAAc,UE5LtB,IAAM4I,GAAYC,aAAW,CAC3Bs4C,eAAgB,CACdj2F,OAAQ,OACRD,MAAO,OACP68B,gBAAiB,QAEnB6nB,MAAM,CACJvL,WAAY,OACZqG,YAAa,OACb9F,QAAS,QAET15C,MAAO,UAILktE,GAAY,SAChBxoB,EACAlqC,GAEAkqC,EAAMN,UAAY5pC,EAClBkqC,EAAMK,UAAW,GAMNoxC,GAAwC,SAAC5gD,GACpD,IAAMyI,EAAUL,KACVnjC,EAAS6gC,cAAY,kBAAO9F,EAAMjgB,OAAOuC,SAASoW,oBAClD6+B,EAAWvwB,kBAAyB,MAC1CrI,sBACE,WACM44B,GAAYA,EAAStgC,SACvB0gC,GAAUJ,EAAStgC,QAAShyB,GAAkB,QAGlD,CAACA,IAQH,MAA4Ci8B,sBAArC2/C,EAAP,oBACMx3C,EAASrC,kBAAY,IAC3BqC,EAAOpS,QAAQ4pD,YAAcA,EAC7B,IAAMC,EAAO95C,kBAA4C,IAEzD,GAAIhH,EAAM+gD,cAAe,CACvB,KAAOD,EAAK7pD,QAAQrmC,QAAUiwF,EAAcA,EAAYjwF,OAAS,IAC/DkwF,EAAK7pD,QAAQ9uB,KAAKq+B,KAAMw6C,aAE1BF,EAAK7pD,QAAQ/pC,SAAQ,SAAC+S,EAAKqwB,GACrBrwB,EAAIg3B,SAAW4pD,GAAevwD,EAAMuwD,EAAYjwF,QAClD+mE,GAAU13D,EAAIg3B,QAAS4pD,EAAYvwD,GAAKrrB,WAK9C05B,sBACE,WAAO,IAAD,EACJ,UAAI0K,EAAOpS,eAAX,OAAI,EAAgB1b,WAClBC,cAAc6tB,EAAOpS,QAAQ1b,UAC7B8tB,EAAOpS,QAAQ1b,cAAW1b,KAG9B,CAACmgC,EAAM+gD,gBAGT,IAAM7vD,EAAU8O,EAAM+gD,eAAiBF,EAAeA,EAAY/zF,KAAI,SAACm0F,EAAY3wD,GAAb,OACpE,uBAAepa,MAAO,CAACiuB,QAAQ,eAAgBp2C,SAAS,WAAYq+C,cAAc,OAAlF,UACE,wBAAOl2B,MAAO,CAACzrB,MAAM,KAAMwV,IAAK6gF,EAAK7pD,QAAQ3G,KAC7C,sBAAKpa,MAAO,CAACnoB,SAAS,WAAYooB,KAAK,EAAGe,IAAI,EAC5C7Y,MAAM4iF,EAAW5iF,MAAOoiD,WAAY,YADtC,SAEGwgC,EAAW96C,UAJN7V,WAONzwB,EAGN,OACE,uBAAKipC,UAAWL,EAAQk4C,eAAxB,UACE,wBAAO1gF,IAAKs3D,EAAUzuB,UAAWL,EAAQ0G,MAAOj5B,MAAO,CAACyzC,WAAa1kD,EAAS,UAAY,YAC1F,sBAAKiR,MAAO,CAACnoB,SAAS,WAAYooB,KAAK,EAAGe,IAAI,GAA9C,SACGga,QAKT0vD,GAAWphD,YAAc,aCpFlB,IAAM0hD,GAA0C,SAAClhD,GACtD,IAAM35B,EAAe25B,EAAMjgB,OAAO1Z,aAC5Bc,EAAcd,EAAaiC,KAAK03B,EAAMt5B,eACtC3Y,EAAW+3C,cAAY,kBAAM3+B,EAAYxX,MAAM5B,YAC/CmQ,EAAO4nC,cAAY,kBAAM3+B,EAAYjG,YAAYhD,QACvD,EAAgBiJ,EAAYqB,WAArBnK,EAAP,oBACA,IAAKtQ,EACH,OAAO,yBAET,IAAMkT,EAAU++B,EAAMt5B,gBAAkBL,EAAaW,QAE/C8rC,EAAS,sBAAK58B,MAAO,CAACzrB,MAAM,GAAIC,OAAO,GAAIyrB,KAAKpoB,EAAS,GAAImpB,IAAInpB,EAAS,GAAIA,SAAS,WAC3Fo8C,cAAelpC,EAAU,OAAS,OAAQ0K,OAAO1K,EAAU,IAAOkG,EAAYwE,OAAO,KADxE,SAGb,sBAAK62D,MAAM,6BAA6B2e,QAAQ,aAAhD,SACE,0BAASC,OAAO,iDAAiDhzC,OAAO,QAAQtQ,KAAMz/B,EAAOgjF,YAAY,UAI7G,OAAOpgF,EAAU6xC,EACd,eAAC7H,GAAA,EAAD,CAAS9oB,MAAOjkB,EAAhB,SAAuB40C,KC3Bf/sC,GAAkD,SAACi6B,GAC9D,OAAO,eAAC,GAAD,6BAAiBA,GAAjB,IAAwB/+B,SAAS,EAAOoiE,YAAY,MCavDie,GAA4B,SAACthD,GACjC,IAAM7pB,EAAOprB,KAAKkzB,IAAI+hB,EAAMjpB,MAAM,GAAIipB,EAAMuhD,IAAI,IAC1CrqE,EAAMnsB,KAAKkzB,IAAI+hB,EAAMjpB,MAAM,GAAIipB,EAAMuhD,IAAI,IACzC92F,EAAQM,KAAKC,IAAIg1C,EAAMjpB,MAAM,GAAKipB,EAAMuhD,IAAI,IAC5C72F,EAASK,KAAKC,IAAIg1C,EAAMjpB,MAAM,GAAKipB,EAAMuhD,IAAI,IAEnD,OAAO,sBAAK/e,MAAM,6BAA6BtsD,MAAO,CAACnoB,SAAS,WAAYooB,OAAMe,MAAKzsB,QAAOC,SAAQy/C,cAAc,UAClHg3C,QAAO,gBAAW12F,EAAX,aAAqBC,GAC5B60C,QAAW,WACTS,EAAMjgB,OAAO1Z,aAAaykB,WAAW3gC,OAAO61C,EAAMx5B,QAClDw5B,EAAMjgB,OAAO1Z,aAAaklB,kBAAmB,GAJ1C,SAOL,uBAAMi2D,GAAIxhD,EAAMjpB,MAAM,GAAKZ,EAAMsrE,GAAIzhD,EAAMjpB,MAAM,GAAKG,EACpDwqE,GAAI1hD,EAAMuhD,IAAI,GAAKprE,EAAMwrE,GAAI3hD,EAAMuhD,IAAI,GAAKrqE,EAAKk3B,OAAO,aAIjDwzC,GAAuC,SAAC5hD,GACnD,IAAM6hD,EAAQ7hD,EAAMjgB,OAAO1Z,aACrB2Y,EAAU8mB,cAAY,WAC1B,IAAMg8C,EAAK7lE,MAAMnT,KAAK+4E,EAAMr7E,OAAOyD,UAAUkS,QAAO,SAAA1qB,GAAC,OAAIA,EAAE8P,QAAQzC,WAC7DyjB,EAAoBtG,MAAMnT,KAAKg5E,GACrCv/D,EAAIpa,KAAK05E,EAAMp7E,OACf8b,EAAIpzB,MAAK,SAACrF,EAAEC,GAAH,OAASD,EAAEoE,KAAKH,SAAS,GAAKhE,EAAGmE,KAAKH,SAAS,MACxD,IAAI,IAAI4C,EAAE,EAAGA,EAAE4xB,EAAI3xB,SAAUD,EAC3B4xB,EAAI5xB,GAAGgb,OAAShb,EAAE,EAGpB,OAAOmxF,KAEH96E,EAAU8+B,cAAY,kBAAM+7C,EAAM76E,WAClCy4E,EAAiBzgE,EAAQlyB,KAAI,SAAA2E,GAAC,OAAI,eAAC,GAAD,CAA8BsuB,OAAQigB,EAAMjgB,OAClF5Y,YAAa1V,EAAG5C,KAAMmP,IADwCvM,EAAEuU,OAE5D05E,EAAgB,eAAC,GAAD,CAAgCv4E,YAAa06E,EAAMp7E,MACvE5X,KAAMmP,GAAkB+hB,OAAQigB,EAAMjgB,QADK,SAEvCgiE,EAAQj8C,cACZ,kBAAM7pB,MAAMnT,KAAK+4E,EAAM/2D,YAAYh+B,KAAI,SAACk1F,GACtC,IAAMjrE,EAAQ8qE,EAAMp7E,MAAMvY,KAAKH,SACzByY,EAASq7E,EAAMr7E,OAAO3d,IAAIm5F,GAChC,GAAKx7E,EAAL,CACA,IAAM+6E,EAAM/6E,EAAOtY,KAAKH,SAExB,OAAO,eAAC,GAAD,CAAMgpB,MAAOA,EAAOwqE,IAAKA,EAAe/6E,OAAQw7E,EAAKjiE,OAAQigB,EAAMjgB,QAAhCiiE,UAIxCC,EADUn8C,cAAY,kBAAK7pB,MAAMnT,KAAK+4E,EAAM56E,SAASvJ,WAC1B5Q,KAAI,SAAAkZ,GAAE,OAAI,eAAC,GAAD,CAA8B+Z,OAAQigB,EAAMjgB,OACrF5Y,YAAa06E,EAAM56E,SAASpe,IAAImd,GAAMnX,KAAMmP,IADuBgI,MAI/Dk8E,EADWp8C,cAAY,kBAAM7pB,MAAMnT,KAAK+4E,EAAMr7E,OAAO9I,QAAQye,QAAO,SAAAnW,GAAE,OAAK67E,EAAMv5E,KAAKtC,GAAKrW,MAAMC,WACnE9C,KAClC,SAAAkZ,GAAE,OAAI,eAAC,GAAD,CAA6BU,cAAeV,EAAI+Z,OAAQigB,EAAMjgB,QAA9D,YAAuB/Z,OAGzBm8E,EADiBr8C,cAAY,kBAAM+7C,EAAMp7E,MAAM9W,MAAMC,QAEvD,eAAC,GAAD,CAA6B8W,cAAeM,EAAU+Y,OAAQigB,EAAMjgB,QAAlD,gBAA+DlgB,EAErF,OAA8B,OAA1B1X,EAAcoiC,QAA2B,yBAI3C,uBAAKrU,MAAO,CAACnoB,SAAS,WAAY4d,OAAO,OAAzC,UACGo2E,EACAE,EACAxC,EACAC,EACAwC,EACAC,MAKPP,GAAiBpiD,YAAc,oBCjFxB,IAAM4iD,GAAmC,SAACpiD,GAC/C,IAAMlzC,EAAMkzC,EAAMjgB,OAAOjzB,IAoBzB,SAASu1F,EAAWC,I5G6Xf,SAAwCA,EAA4Bx1F,GACzE,OAAO,IAAIwD,SAA0B,SAACC,EAASC,GAC7C,OAAI8xF,QAAJ,IAAIA,KAActmD,MAAMl5B,SAAS,SAAW,WAI1C,IAHA,IAAMsxC,EAAQn4B,MAAMnT,KAAKw5E,EAAaluC,OAChC9xB,EAA4B,GAC5BigE,EAAgB,GAHmB,aAIrC,IAAMx2C,EAAI,KACN59B,EAAO49B,EAAKy2C,YAClB,GAAkB,SAAdz2C,EAAK1kC,MAAmB8G,EAAM,CAChC,IAAIs0E,OACY5iF,GACoB,IAAhCksC,EAAKjkC,KAAK4K,QAAQ,SACpB+vE,EAAUzuE,GACY,oBAAd+3B,EAAKjkC,OACb26E,EAAU5tE,IAER4tE,GACFA,EAAQt0E,EAAMrhB,GAAK4W,MAAK,SAACkO,GACvBA,EAAQ1T,KAAOiQ,EAAKjQ,KACpBokB,EAASna,KAAKyJ,GACV0Q,EAAS1xB,OAAS2xF,EAAQ3xF,SAAWwjD,EAAMxjD,SAC7C0xB,EAAS1xB,OAASL,EAAQ+xB,GAAY9xB,EAAO+xF,OAE9C5+E,OAAM,SAAC0R,GACRktE,EAAQp6E,KAAKkN,GACTiN,EAAS1xB,OAAS2xF,EAAQ3xF,SAAYwjD,EAAMxjD,SAC9C0xB,EAAS1xB,OAASL,EAAQ+xB,GAAY9xB,EAAO+xF,YAKnDA,EAAQp6E,KAAK,uBAzBjB,MAAkBisC,EAAlB,eAAyB,IAJiB,GAgCtC,OAAIkuC,QAAJ,IAAIA,KAActmD,MAAMl5B,SAAS,cACrCw/E,EAAaluC,MAAM,GAAGsuC,aAAY,SAAC5yF,GACjC2lB,GAAsB3lB,EAAKhD,EAAK,EAAG,EAAG,IAAI4W,MAAK,SAAAtY,GAAC,OAAImF,EAAQ,CAACnF,OAAKuY,MAAMnT,OAG1Eqd,QAAQI,MAAM,2BAAd,OAA0Cq0E,QAA1C,IAA0CA,OAA1C,EAA0CA,EAActmD,OACxDxrC,EAAO,2BAAD,cAA4B8xF,QAA5B,IAA4BA,OAA5B,EAA4BA,EAActmD,a4GpalD2mD,CAA+BL,EAAcx1F,GAAK4W,MAAK,SAAAub,GAAO,IAAD,gBAC5CA,GAD4C,IAC3D,IAAI,EAAJ,qBAAkB,CAAC,IAAT7zB,EAAQ,QAEd+rB,GAAe4hB,aAAa3tC,IAH2B,kCAoB/DuzC,sBACE,WACEx1C,OAAO0sB,SAAS9G,KAAK6K,iBACnB,SACA,SAAC+E,GA3CP,IAAiBy0D,IA4CDz0D,EA1CVxH,GAAeqhC,cAA2C,IAA3B1rD,EAAIqtC,cAActrC,MAAcukF,EAAIwP,gBACrExP,EAAIt0C,iBACJujD,EAAWjP,EAAIwP,kBA0Cb,CAAC9b,SAAQ,IAEX39E,OAAO0sB,SAAS9G,KAAK6K,iBACnB,QACA,SAAC+E,GA3CP,IAAgBy0D,KA4CDz0D,GA1CTmgB,iBACJs0C,EAAIr0C,kBACAq0C,EAAIkP,cACND,EAAWjP,EAAIkP,gBAyCb,CAACxb,SAAQ,IAEX39E,OAAO0sB,SAAS9G,KAAK6K,iBACnB,YACA,SAACR,GAAQ,IAAD,EAENA,EAAG0lB,iBACH1lB,EAAG2lB,kBACH,UAAI3lB,EAAGkpE,oBAAP,OAAI,EAAiBO,aACnBzpE,EAAGkpE,aAAaO,WAAa,UAGjC,CAAC/b,SAAQ,MAIb,IAEF,IAAMgc,EAAgBh9C,cAAY,kBAAM3uB,GAAerF,UAGvD,OACE,eAAC,GAAD,6BAAgBkuB,GAAhB,IAAuBu7C,QAAgC,KAAvBuH,EAAch7E,KAAa8J,QAASkxE,EAClE/G,QAAW,SAAC3I,GA3Cd0P,EAAcz2E,OAASthB,KAAKgG,MAAM0X,KAAKC,MAAQsD,IAC/C82E,EAAcjyE,QAAS,EACvBsG,GAAe6hB,gBAAgBt5B,KAAEC,UAAUmjF,IAC3C3rE,GAAe4rE,UAAUpxE,OAyCvByd,QAAW,SAACgkD,GACVj8D,GAAe4rE,UAAUpxE,MACzByhE,EAAIr0C,mBAENslB,cAAiB,SAAC2+B,GAChB7rE,GAAe4rE,UAAUC,IAE3B98B,WAAc,SAAC88B,GACb7rE,GAAe4rE,UAAUC,Q,mBCzF3B56C,GAAYC,aAAW,CAC3B46C,YAAY,CACVziC,SAAU,OACVjc,WAAY,UAIH2+C,GAAa18C,KAAMigC,MAC9B,SAACzmC,GACC,IAAM1d,EAAW0d,EAAMjgB,OAAOuC,SACxBmmB,EAAUL,KACO00C,GAAgB98C,EAAhCmjD,YAAP,aAAuCnjD,EAAvC,KAEA,OAAQ,uBAAK8I,UAAWL,EAAQw6C,YAAxB,UACN,eAAC,KAAD,UACE,WACE,IAAM1gE,EAAMtG,MAAMnT,KAAKwZ,EAASC,KAC1B6gE,EAAWpjD,EAAMmjD,YAAc5gE,EAAIpG,QAAO,SAAA/wB,GAAC,OAAKghB,GAAmBhhB,MAAMm3B,EAE/E,OAAO,qCACL6gE,EAASt2F,KAAI,SAAA6B,GAAG,OACd,eAAC,GAAD,cAA4BijB,QAASjjB,GAASmuF,GAA1BnuF,EAAIqX,YAIlC,eAAC,GAAD,gBAAmB82E,UAGrB,SAAC1gE,EAAM+f,GACL,OAAOz8B,KAAEq3E,QAAQ36D,EAAK2D,OAAOuC,SAASC,IAAK4Z,EAAKpc,OAAOuC,SAASC,MAAQnG,EAAK+mE,cAAgBhnD,EAAKgnD,eAGtGD,GAAW1jD,YAAc,aCnCzB,IAEM4I,GAAYC,aAAW,CAC3BllC,IAAK,SAAC68B,GACJ,OAAIA,EAAMmjD,YACD,CAACh/C,QAAS,QAKZ,CACLp2C,SAAU,WACVmpB,KAAK,KACLf,MAAM,KACNmR,gBANWl2B,EAAU4uC,EAAMlC,MAS3BpzC,OAAQ4U,GACR7U,MAAO6U,KAGX+jF,KAAM,SAACrjD,GACL,OAAIA,EAAMmjD,YACD,CACLh/C,QAAQ,QAIL,CACLp2C,SAAU,WACVmpB,IAAK,EACLgtB,MAAO,EACP1sB,OAAQ,EACRrB,KAAM,EACNglC,OAAQ,OACRzwD,OAAQ,OACR81D,SAAU,OACVjc,WAAY,OACZ4F,cAAe,WAURm5C,GAAiC,SAACtjD,GAC7C,IAAM5W,EAAW4W,EAAMjgB,OAAOqJ,SACxBs/C,EAAU,cACdrqE,MAAO,CAAC,EAAE,EAAE,GACZy/B,KAAM,CAAC,EAAE,EAAE,IACRkC,GAEL8F,cAAY,WACV4iC,EAAWrqE,MAAQ+qB,EAAS9B,gBAC5BohD,EAAW5qC,KAAO1U,EAAS/B,kBAE7B,IAAMohB,EAAUL,GAAUsgC,GAE1B,OAAO,eAAC,KAAD,UAAW,WAChB,OAAO,sBAAK5/B,UAAWL,EAAQtlC,UAGnCmgF,GAAW9jD,YAAc,aC5DlB,IAAMv1C,GAA0B,SAAC+1C,GAEtC,OACE,gBAAC,GAAD,6BAAUA,GAAV,cACE,eAAC,GAAD,gBAAqBA,IACrB,eAACkjD,GAAD,gBAAgBljD,IAChB,eAAC,GAAD,gBAAsBA,SAI5B/1C,GAAIu1C,YAAc,MCrBH,I,oFCAA,wjDCAA,g7DCAA,wwCC+CT0b,GAAc,CAClB,IAAK,CACHC,OAAQ,MACRC,aAAc,MACd3wD,MAAOL,IAAiB,QAAU,OAClCM,OAAQN,IAAiB,OAAS,OAClC65C,UAAW,WAITmE,GAAYC,aAAW,CAC3BpmC,SAAS,cAEPvX,OAAQ,GACRqD,SAAS,WACT+kD,OAAQ,UACRxrB,gBAAiB,UACjB4c,MAAO,GACJgX,IAELqoC,eAAe,cACbp/C,QAAS,QACTz5C,OAAQ,GACRqD,SAAS,WACT+kD,OAAQ,UACRxrB,gBAAiB,UACjB4c,MAAO,GACJgX,IAEL3V,UAAU,CACRx3C,SAAU,WACVtD,MAAO,MAEP+sB,OAAQ,GACR0sB,MAAM,EACNR,QAAS,EACTkY,QAAS,OACTzR,cAAe,QAEjB2R,QAAQ,CAACrxD,MAAM,QACfsxD,aAAa,CAACtxD,MAAM,OAAQ05C,QAAQ,OAAQqR,cAAc,SAAUtJ,WAAW,cAG3E8P,G,mDACJC,gBAAsCp8C,E,KACtCq8C,SAAU,KAGCsnC,GAAgD,SAACxjD,GAC5D,MAA4BA,EAAMjgB,OAA3BjzB,EAAP,EAAOA,IAAKuZ,EAAZ,EAAYA,aAUZ,EAAsCmgC,KAAMtF,UAAkB,GAA9D,mBAAOuiD,EAAP,KAAoBC,EAApB,KACA,EAAoCl9C,KAAMtF,UAAkB,GAA5D,mBAAOyiD,EAAP,KAAmBC,EAAnB,KACA,EAAoCp9C,KAAMtF,UAAkB,GAA5D,mBAAO2iD,EAAP,KAAmBC,EAAnB,KAaMz6C,EADYrC,kBAAe,IAAIgV,IACZ/kB,QACnB8lB,EAAe/V,kBAAuB,MAYtCyB,EAAUL,KAGhB,SAAS27C,IACP,OAAOj3F,EAAIiY,WAAW,IAAMjY,EAAI6C,MAAM,GAAK7C,EAAIonB,OAAO,IAAM,GAE9D,IAAMypC,EAAgB7X,aAAYi+C,GAuDlC,OAtDAplD,sBAAU,WACJolD,MAAwB16C,EAAO6S,SAAU,GAI/C,SAAuBtsD,GACrB,GAAIA,EAAM,CAAC,IAAD,EAEJy5C,EAAO4S,aACT1Z,aAAa8G,EAAO4S,YACpB5S,EAAO4S,gBAAap8C,GAEtB,UAAAk9C,EAAa9lB,eAAb,SAAsB5gB,aAEjBgzB,EAAO4S,aACV5S,EAAO4S,WAAaziC,YAAW,WAE7B6vB,EAAO4S,gBAAap8C,IACS,MAhBnCmkF,CAAcrmC,IAAkBtU,EAAO6S,WAE/B,CAACyB,EAAetU,EAAO6S,UAoBjCvd,sBAAU,WACR,IAAMW,EAAY,SAAChzC,KAsBnB,OAFAnD,OAAOywB,iBAAiB,UAAW0lB,GAE5B,WACLn2C,OAAOk5C,oBAAoB,UAAW/C,MAGhC,IAGHkH,KAAM+a,SAAQ,WAyDnB,IAAM5C,EAAW,GA8DjB,OAAO,sBAAK1+C,IAAK88C,EAAcjU,UAAWL,EAAQlD,UAA3C,SACL,gBAACqZ,GAAA,EAAD,CAAUhV,IAAI,EAAMnB,QAASA,EAA7B,UAuFE,eAAC,GAAD,CAAS55C,KAAMzE,IAAiB,IAAM,GACpCm1C,QAAY,YAvIlB,WACEl5B,EAAaI,MAAMxE,SAAW,GAC9B6hF,GAAc,GACdF,GAAc,GACd,IAAMzhB,EAAS3oD,YAAW,WACxB+oB,aAAa4/B,GACVshB,GACDp9E,EAAaI,MAAMxE,SAAW,GAC9ByhF,GAAe,KAEfr9E,EAAaI,MAAMxE,SAAW,QAC9ByhF,GAAe,MAEjB,KA2HIO,IAFJ,SAKGR,EAAc,sBAAK36C,UAAWL,EAAQ86C,eAAxB,SACb,sBAAK1gF,IAAKqhF,GAAWhuE,MAAO,CAACzrB,MAAMk0D,EAAUj0D,OAAOi0D,EAAU5wD,SAAS,WAAYmpB,IAAI9sB,IAAiB,OAAS,OAAQ+rB,KAAK/rB,IAAiB,MAAQ,OAAQk6C,UAAYl6C,IAAiB,WAAa,YAAas6C,IAAI,OACxN,sBAAKoE,UAAWL,EAAQxmC,SAAxB,SACF,sBAAKY,IAAKqhF,GAAWhuE,MAAO,CAACzrB,MAAM,GAAIC,OAAO,GAAIqD,SAAS,WAAYmpB,IAAI9sB,IAAiB,OAAS,OAAQ+rB,KAAK/rB,IAAiB,MAAQ,OAAQk6C,UAAYl6C,IAAiB,WAAa,YAAas6C,IAAI,SAElN,eAAC,GAAD,CAAS71C,KAAMzE,IAAiB,IAAM,GACpCm1C,QAAY,YAlIlB,WACEl5B,EAAaI,MAAMxE,SAAW,GAC9B6hF,GAAc,GACdJ,GAAe,GACf,IAAMvhB,EAAS3oD,YAAW,WACxB+oB,aAAa4/B,GACVwhB,GACDt9E,EAAaI,MAAMxE,SAAW,GAC9B2hF,GAAc,KAEdv9E,EAAaI,MAAMxE,SAAW,OAC9B2hF,GAAc,MAEhB,KAsHIO,IAFJ,SAKGR,EAAa,sBAAK76C,UAAWL,EAAQ86C,eAAxB,SACZ,sBAAK1gF,IAAKuhF,GAAUluE,MAAO,CAACzrB,MAAMk0D,EAAUj0D,OAAOi0D,EAAU5wD,SAAS,WAAYmpB,IAAI9sB,IAAiB,OAAS,OAAQ+rB,KAAK/rB,IAAiB,MAAQ,OAAQk6C,UAAYl6C,IAAiB,WAAa,YAAas6C,IAAI,OACvN,sBAAKoE,UAAWL,EAAQxmC,SAAxB,SACF,sBAAKY,IAAKuhF,GAAUluE,MAAO,CAACzrB,MAAM,GAAIC,OAAO,GAAIqD,SAAS,WAAYmpB,IAAI9sB,IAAiB,OAAS,OAAQ+rB,KAAK/rB,IAAiB,MAAQ,OAAQk6C,UAAYl6C,IAAiB,WAAa,YAAas6C,IAAI,SAEjN,eAAC,GAAD,CAAS71C,KAAMzE,IAAiB,IAAM,GACpCm1C,QAAY,YA7HlB,WACEl5B,EAAaI,MAAMxE,SAAW,GAC9B2hF,GAAc,GACdF,GAAe,GACf,IAAMvhB,EAAS3oD,YAAW,WACxB+oB,aAAa4/B,GACV0hB,GACDx9E,EAAaI,MAAMxE,SAAW,GAC9B6hF,GAAc,KAEdz9E,EAAaI,MAAMxE,SAAW,OAC9B6hF,GAAc,MAEhB,KAiHIO,IAFJ,SAKGR,EAAa,sBAAK/6C,UAAWL,EAAQ86C,eAAxB,SACZ,sBAAK1gF,IAAKyhF,GAAUpuE,MAAO,CAACzrB,MAAMk0D,EAAUj0D,OAAOi0D,EAAU5wD,SAAS,WAAYmpB,IAAI9sB,IAAiB,OAAS,OAAQ+rB,KAAK/rB,IAAiB,MAAQ,OAAQk6C,UAAYl6C,IAAiB,WAAa,YAAas6C,IAAI,OACvN,sBAAKoE,UAAWL,EAAQxmC,SAAxB,SACF,sBAAKY,IAAKyhF,GAAUpuE,MAAO,CAACzrB,MAAM,GAAIC,OAAO,GAAIqD,SAAS,WAAYmpB,IAAI9sB,IAAiB,OAAS,OAAQ+rB,KAAK/rB,IAAiB,MAAQ,OAAQk6C,UAAYl6C,IAAiB,WAAa,YAAas6C,IAAI,gBAqDrN,CAAC++C,EAAaE,EAAYE,KAI9BL,GAAUhkD,YAAc,YC3dxB,IAAM0b,GAAc,CAClB,IAAK,CACHC,OAAQ,MACRC,aAAc,MACd3wD,MAAO,QACPC,OAAQ,QACRu5C,UAAW,SACXwS,SAAU,SACVv/B,IAAK,MACLwgE,aAAc,SAIZtvC,GAAYC,aAAW,CAC3Bk8C,aAAc,CACZpgD,QAAS,QACT15C,MAAM,QACNsD,SAAS,WACTooB,KAAK,QACL8tB,UAAU,SACV5lC,MAAO,UACPu0C,WAAY,OACZ3T,SAAU,OACVulD,WAAY,uEAEdC,iBAAkB,CAChBtgD,QAAS,QACT15C,MAAM,QACNsD,SAAS,WACTmpB,IAAK,QACLf,KAAK,QACL8tB,UAAU,SACV5lC,MAAO,UACPu0C,WAAY,OACZ3T,SAAU,OACVulD,WAAY,uEAEdE,iBAAiB,CACfvgD,QAAS,QAEXwgD,IAAI,CACFxgD,QAAQ,OACRzyB,QAAS,EACTsyB,WAAY,yBAEd4gD,UAAW,CACTzgD,QAAQ,QACRzyB,QAAS,EACTsyB,WAAY,yBAEd6gD,QAAQ,cACN1gD,QAAS,OACTz5C,OAAQ,GACRqD,SAAS,WACTu5B,gBAAiB,QACjBgd,UAAW,kBACXJ,MAAO,GACJgX,IAEL4pC,cAAc,cACZ3gD,QAAS,QACTz5C,OAAQ,GACRqD,SAAS,WACTm+C,WAAW,SACX5kB,gBAAiB,QACjBgd,UAAW,kBACXJ,MAAO,GACJgX,IAEL3V,UAAU,CACRx3C,SAAU,WACVtD,MAAO,MACPysB,IAAK,KACLgtB,MAAM,GACNR,QAAS,EACTkY,QAAS,OACTzR,cAAe,QAEjB2R,QAAQ,CAACrxD,MAAM,QACfsxD,aAAa,CAACtxD,MAAM,OAAQ05C,QAAQ,OAAQqR,cAAc,SAAUtJ,WAAW,cAGpE64C,GAAiD,SAAC/kD,GAAW,IAAD,IAChE35B,EAAgB25B,EAAMjgB,OAAtB1Z,aACDpV,EAAMoV,EAAaI,MAAMswD,cACzBiuB,EtEkFC3oC,GsEhFDr9B,EAAU/C,MAAMnT,KAAKzC,EAAaG,OAAO9I,QAAQye,QAAO,SAAApqB,GAAG,OAAIA,IAAQsU,EAAaW,WACtFi+E,EAAmB,EANgD,cAOrDjmE,EAAQskB,WAP6C,IAOvE,2BAAqC,CAAC,IAAD,EAAzB3yC,EAAyB,+BAC2BkP,KAA7D,UAAAwG,EAAaG,OAAO3d,IAAIm2B,EAAQruB,WAAhC,eAAqC2W,OAAOsd,gBAC7CqgE,EAAYt0F,IATyD,8BAYvE,IAAMkxF,EAAQ7hD,EAAMjgB,OAAO1Z,aACrBkjB,EAAMuc,cAAY,kBAAM7pB,MAAMnT,KAAK+4E,EAAMr7E,OAAO9I,QAAQye,QAAO,SAACnW,GACpE,IAAMQ,EAASq7E,EAAMv5E,KAAKtC,GAC1B,QAAkCnG,IAA/B2G,EAAOc,OAAOsd,aACb,OAAOpe,QAIf,EAAoCggC,KAAMtF,SAAS3X,GAAnD,mBAAO27D,EAAP,KAAmBC,EAAnB,KAEA,GAAG57D,EAAI34B,SAAWs0F,EAAWt0F,OAAQ,CACnC,IAAIw0F,EAAU77D,EAAIpN,OAAOkpE,EAASH,IAC9BI,EAAUJ,EAAW/oE,OAAOkpE,EAAS97D,IAMzC47D,EALkB,IAAf57D,EAAI34B,OACI,GAEAw0F,EAAQG,OAAOD,IAI5B,SAASD,EAASG,GAChB,OAAO,SAASvuD,GACd,OAEc,IAFPuuD,EAAWrpE,QAAO,SAASspE,GAChC,OAAOA,IAAUxuD,KAChBrmC,QAGL,IAAM80F,EAAc5/C,cAAY,kBAAMqZ,QAAQ94C,EAAaI,MAAMsxD,cAC3D4tB,EAAc7/C,cAAY,wBAAMqZ,QAAO,UAAC94C,EAAaG,OAAO3d,IAAIq8F,EAAWA,EAAWt0F,OAAO,WAAtD,aAAC,EAA0DmnE,cAClG6tB,EAAI,UAAGv/E,EAAaG,OAAO3d,IAAIq8F,EAAWA,EAAWt0F,OAAO,WAAxD,aAAG,EAA0DmmE,cAEjE8uB,EAAgB//C,cAAY,kBAAOz/B,EAAaI,MAAMa,OAAOsd,gBAE7DkhE,EAAWhgD,cAAY,kCAAOz/B,EAAaG,OAAO3d,IAAIq8F,EAAWA,EAAWt0F,OAAO,WAA5D,aAAO,EAA0D0W,OAAOsd,gBAEjG3f,GAAUygF,GAAiBr/E,aAAwBN,IACtC4/E,GAAiBt/E,aAAwBN,QAC/ClG,EAAXimF,EADAD,EAGIxkE,EAAOpc,GAAWoB,aAAwBN,GAAuBM,EAAaigB,eAAWzmB,EAE7F,EAAwC2mC,KAAMtF,UAAmC,IAAhBwkD,IAAyC,IAAhBC,GAA1F,mBAAOI,EAAP,KAAqBC,EAArB,KACA,EAAgCx/C,KAAMtF,UAAkB,GAAxD,mBAAO+kD,EAAP,KAAiBC,EAAjB,KACM3uB,EAAWvwB,kBAAyB,MAC1C,EAAkC9F,oBAAS,GAA3C,mBAAOilD,EAAP,KAAkBC,EAAlB,KACMrpC,EAAe/V,kBAAuB,MAU5C,QAAcnnC,IAAXoF,EAAsB,CACvB,IAAIohF,EAAW,GACfA,EAAW,iBACc,IAAtBrB,EACDqB,EAAW,aAERX,EACAO,GACDC,GAAY,GAEJP,EAERU,EAAW,IAEXA,EAAW,cACK,IAAbJ,IACDzsE,YAAY,WACV,IAAI8sE,EAAQH,EACTG,GAAS,GAEVF,EADAE,GAAS,KAGX,KACCH,GAAa,IAEdC,EAAa,GACbF,GAAY,WAMlBG,EAAW,GAEf,IAAM59C,EAAUL,KAwDhB,OAvDAzJ,sBAAU,WAMR,OAL0B,QAAd,OAAR44B,QAAQ,IAARA,OAAA,EAAAA,EAAUtgC,YAehB,SAAmBkY,EAAyBlqC,EAA+Boc,EACzEm2C,EAA+BC,GAE/B,GAAIxyD,EAASkqC,EAAMN,UAAY5pC,OAC1B,GAAIoc,EAAK,CACZ,IAAMj5B,EAAME,IAAIm+B,gBAAgBpF,GAChC8tB,EAAMtsC,IAAMza,EAEd+mD,EAAMK,UAAW,EACjBL,EAAMuoB,iBAAmB,WACvB,IAAMniD,EAAW,CACf9qB,MAAO,IACPC,OAAQ,UAEamV,IAAnB0V,EAAS9qB,YAA2CoV,IAApB0V,EAAS7qB,OAC3CykD,EAAMrG,UAAYvzB,EAAS9qB,OAAS8qB,EAAS7qB,OAAS8sE,EAAwBC,GAE9E5pD,QAAQI,MAAM,6CACdkhC,EAAMrG,UAAY0uB,IAhCpBG,CAAUJ,EAAStgC,QAAShyB,EAAQoc,EAClC,MAAO,OAWX2kE,GAAiC,IAAhBN,IAAyC,IAAhBC,IARnC,YACc,IAAhBD,GACDU,EAAa,OA+BnBznD,sBAAU,WAWR,OAAO,eAIC,IACH,eAAC,KAAD,UAAW,WAAO,IAAD,IACxB,OAAO,sBAAK1+B,IAAK88C,EAAcjU,UAAWL,EAAQlD,UAA3C,SACL,gBAACqZ,GAAA,EAAD,CAAUhV,IAAI,EAAMnB,QAASA,EAA7B,UACE,eAAC,GAAD,CAAS55C,KAAM,IAAKi6C,WAA6B,IAAhB48C,IAAyC,IAAhBC,IAAsC,IAAbM,EAAuBx9C,EAAQm8C,UAAYn8C,EAAQk8C,IACtIplD,QAAY,aADZ,SASA,sBAAKuJ,UAAYi9C,EAAgBt9C,EAAQq8C,cAAgBr8C,EAAQo8C,QAAjE,SACE,wBAAO5kF,IAAKs3D,EAAUrhD,MAAO,CAACzrB,MAAO,QAASC,OAAO,QAASqD,SAAU,WAAYu5C,UAAU,QAAS1D,WAAW,gBAGpH,sBAAK1tB,OAAoB,IAAb+vE,QAAiCpmF,IAAXoF,EAAuB,CAACxa,MAAM,QAASC,OAAO,QAAS0wD,aAAc,MAAMlkC,IAAI,SAAUgtB,MAAM,SAAUn2C,SAAS,WAAYu5B,gBAAgB,QAA+D5V,QAAS,EAAGsyB,WAAY,yBAA2B,CAAuBv5C,MAAM,QAASC,OAAO,QAAS0wD,aAAc,MAAOlkC,IAAI,SAAUgtB,MAAM,SAAUn2C,SAAS,WAAYu5B,gBAAgB,QAAyC5V,QAAS,EAAGsyB,WAAY,yBAAjf,SACE,oBAAG9tB,MAAoB,kBAAbmwE,QAA2CxmF,IAAXoF,EAAuB,CAACk/B,QAAQ,QAAU,CAACA,QAAQ,QAASp2C,SAAS,WAAYsQ,MAAM,MAAO6Y,IAAI,QAASzsB,MAAM,QAASw5C,UAAU,SAAUhF,SAAS,OAAQ2T,WAAW,YAGtN,uBAAK18B,MAAO,CAACxrB,OAAO,OAAQD,MAAM,QAASw5C,UAAU,SAAUl2C,SAAS,WAAYooB,KAAK,QACvFi2B,cAAc,SAAUjI,QAAQ,OAAQqR,cAAc,MAAOiL,WAAW,SAAUnZ,UAAW,QAASjpC,MAAM,QAASo4C,SAAS,UADhI,UAEI,sBAAKvgC,MAAO,CAACnoB,SAAS,WAAYo2C,QAAsB,eAAbkiD,EAA4B,QAAU,OAAQ57F,MAAM,OAAQC,OAAO,OAAQ48C,UAAU,MAAO1D,WAAY,OAAQtc,gBAAgBo+D,EAAct0F,EAAUH,QAAiB4O,IAAT+lF,EAAqBx0F,EAAUw0F,QAAQ/lF,EAAYu7C,aAAc,OAAQv4C,IAAK6iF,EAAcr/E,EAAaI,MAAMvF,YAAY9C,UAAlC,UAA8CiI,EAAaG,OAAO3d,IAAIm2B,EAAQimE,WAA9E,aAA8C,EAA6C/jF,YAAY9C,UAAYsmC,IAAI,KAC3Z,oBAAGxuB,MAAO,CAACnoB,SAAS,WAAYu5C,UAAU,MAAO1D,WAAW,MAAO6S,SAAS,SAAUtS,QAAsB,eAAbkiD,EAA4B,QAAU,OAAQpnD,SAAU70C,IAAiB,OAAS,OAAQwoD,WAAW,QAApM,SAA8M8yC,EAAcr/E,EAAaI,MAAMvF,YAAYhD,KAAlC,UAAyCmI,EAAaG,OAAO3d,IAAIm2B,EAAQimE,WAAzE,aAAyC,EAA6C/jF,YAAYhD,UAE/T,sBAAK4qC,UAAW48C,GAA8B,IAAfn8D,EAAI34B,SAAsC,IAAtBo0F,EAA8Bv8C,EAAQi8C,iBAAmBj8C,EAAQ87C,aAApH,4BAGA,oBAAGz7C,UAAwB,eAAbu9C,EAA4B59C,EAAQi8C,iBAAmBj8C,EAAQg8C,iBAA7E,SAAgG4B,aAUtGtB,GAAWvlD,YAAc,adxPzB,IAAI2gD,GAAmB,GAKvB,IAAIE,IAAmB,EAMvB,IAAIhb,GAAgB,GAChBC,GAAe,GACfC,GAAoB,GACpBC,GAAe,GACfC,GAAmB,GACnBC,GAAkB,GAClBC,GAAgB,GAEP4gB,GAAoB,WAE/B,IAAM99C,EAAU8W,KAEVx/B,EAAgB,CACpBjzB,IAAK05F,GACLngF,aAAcwzB,GACdvX,SAAUmkE,GACV1+E,KAAM2+E,GACNt9D,SAAUA,IAENu9D,EAAS3/C,kBAAuB,MACtC,EAAwB9F,qBAAkB,GAA1C,mBAAO0lD,EAAP,KAAaC,EAAb,KACA,EAAkC3lD,qBAAkB,GAApD,mBAAO4lD,EAAP,KAAkBC,EAAlB,KACA,EAAgC7lD,oBAAS,IAAzC,mBAAO8lD,EAAP,KAAiBC,EAAjB,KACA,EAAwC/lD,qBAAU,GAAlD,mBAAO+nC,EAAP,KAAqBC,EAArB,KACA,EAAsChoC,qBAAU,GAAhD,mBAAOioC,EAAP,KAAoBC,EAApB,KACA,EAAoCloC,qBAAU,GAA9C,mBAAOmoC,EAAP,KAAmBC,EAAnB,KACA,EAAoCpoC,qBAAU,GAA9C,mBAAOqoC,EAAP,KAAmBC,EAAnB,KACA,EAAsCtoC,qBAAU,GAAhD,mBAAOuoC,EAAP,KAAoBC,EAApB,KACA,EAA8CxoC,qBAAU,GAAxD,mBAAOyoC,EAAP,KAAwBC,EAAxB,KACA,EAA4C1oC,qBAAU,GAAtD,mBAAO2oC,EAAP,KAAuBC,EAAvB,KAEA,EAAgC5oC,qBAAS,GAAzC,mBAAOgmD,EAAP,KAAiBC,EAAjB,KAEA,EAAgCjmD,oBAAS,CAAE8M,EAAG,EAAGC,EAAG,IAApD,mBAAOlgD,EAAP,KAAiBu/D,GAAjB,KACA,GAA4CpsB,qBAAU,GAAtD,qBAAOkmD,GAAP,MAAuBC,GAAvB,MAGMtd,GAAY/iC,kBAAuB,MAGnCsgD,GAActgD,kBAAkB,MAChCugD,GAAcvgD,kBAAkB,MAChCwgD,GAAcxgD,kBAAkB,MAChCygD,GAAczgD,kBAAkB,MAChC0gD,GAAc1gD,kBAAkB,MAChC2gD,GAAc3gD,kBAAkB,MAChC4gD,GAAc5gD,kBAAkB,MAChC6gD,GAAc7gD,kBAAkB,MAChC8gD,GAAc9gD,kBAAkB,MAGlC+gD,GAAqB,GACrBC,GAAqB,GACrBC,GAAuB,GACvBC,GAAoB,GAClBlI,GAAWl6C,cAAY,kBAAM/lB,EAAOuC,SAASC,OACnDy9D,GAAS7jE,QAAO,SAAA4vB,GAAI,MAAqB,YAAjBA,EAAKj7B,aAAuBhkB,KAAI,SAAA8kB,GAAO,OAC7Dm2E,GAAcn2E,EAAQxpB,OAExB43F,GAAS7jE,QAAO,SAAA4vB,GAAI,MAAqB,YAAjBA,EAAKj7B,aAAuBhkB,KAAI,SAAA8kB,GAAO,OAC7Do2E,GAAcp2E,EAAQZ,eAIxBgvE,GAAS7jE,QAAO,SAAA4vB,GAAI,MAAuB,WAAnBA,EAAKj7B,aAAwBhkB,KAAI,SAAC8kB,EAAS4hB,GAAV,OAC7C,IAAVA,GAA4B,KAAbwzD,EAAkBC,EAAYr1E,EAAQ9J,MAAQ,MAG/Dk4E,GAAS7jE,QAAO,SAAA4vB,GAAI,MAAuB,WAAnBA,EAAKj7B,aAAwBhkB,KAAI,SAAC8kB,EAAS4hB,GAAV,OAIvDwzD,IAAap1E,EAAQ9J,KAAOmgF,GAAgBr2E,EAAQL,UAAY,MAElEyuE,GAAS7jE,QAAO,SAAA4vB,GAAI,MAAuB,WAAnBA,EAAKj7B,aAAwBhkB,KAAI,SAAC8kB,EAAS4hB,GAAV,OACvD00D,GAAc//E,KAAKyJ,EAAQ9J,SAG7B,IAAIqgF,IAAQ,EACNC,GAActiD,cAAY,kBAAM/lB,EAAO1Z,aAAaW,WACpDqhF,GAAYjkF,eAAeK,QAAQ,QACnC6jF,GAAgBxiD,cAAY,kBAAM9E,QAEhC4lD,EACRzG,GAAY6G,EAEZ,IAIC,GAAuB9lD,oBAAS,IAAhC,qBAAO7nB,GAAP,MAAYi6B,GAAZ,MACA,GAA4BpS,oBAAS,IAArC,qBAAOqnD,GAAP,MAAeC,GAAf,MAyBIC,GAA4B,GAC5BC,GAA4B,GAClB,KAAXH,KACDE,GAAaF,GAAOv4F,MAAM,MAC1B04F,GAAaH,GAAOv4F,MAAM,MACfm0B,OAGbwa,sBAAU,WAMR,GArCApvB,MAAM,6CACH7L,MAAK,SAAC2M,GAAD,OAAcA,EAAS5I,UAC5B/D,MAAK,SAAC2M,GAAD,OAAcijC,GAAQjjC,MAS9Bd,MAAM,uCACH7L,MAAK,SAAC2M,GAAD,OAAcA,EAAS5I,UAC5B/D,MAAK,SAAC2M,GAAD,OAAcm4E,GAAUn4E,MhFL5BywB,IgF6BkBsnD,GAAa,CACjC,GAAqB,MAAlBE,KAAyC,IAAhBjf,SAA6ExpE,IAAvDkgB,EAAO1Z,aAAaI,MAAMvF,YAAY5C,cAA4F,IAA9DyhB,EAAO1Z,aAAaI,MAAMvF,YAAY5C,aAAa1N,QAAe,EAgE5L,WAWA,IALA,IAAM2iD,EAA0B,GAC1BC,EAAyB,GAC3BC,EAAmB,GACnBC,EAAiBr6B,GAAKrpB,MAAM,KAEvBW,EAAE,EAAGA,EAAE+iD,EAAe9iD,OAAO,EAAGD,KACoB,IAAtD4iD,EAAQ7gC,QAAQghC,EAAe/iD,GAAGX,MAAM,KAAK,UAAkD6P,IAApC6zC,EAAe/iD,GAAGX,MAAM,KAAK,IACzFujD,EAAQprC,KAAKurC,EAAe/iD,GAAGX,MAAM,KAAK,IAI9C,IAAK,IAAI2jD,EAAE,EAAGA,EAAIJ,EAAQ3iD,OAAQ+iD,IAAK,CACrC,IAAK,IAAIhjD,EAAE,EAAGA,EAAE+iD,EAAe9iD,OAAO,EAAGD,IACtC4iD,EAAQI,KAAOD,EAAe/iD,GAAGX,MAAM,KAAK,KAC7CyjD,GAAYC,EAAe/iD,GAAM,KAGrC6iD,EAAOrrC,KAAKsrC,GACZA,EAAU,GAKV,IAAIy2B,EAAgBgC,GAAqB,GAAI,IACzC9B,EAAqB8B,GAAqB,EAAG,IAC7Cr4B,EAASL,EAAO,GAAGxjD,MAAM,KACzBq6E,EAAiBx2B,EAAOnhC,QAAQ,wCAMhC2yD,GAAgBxxB,EAAOw2B,GACpBZ,IAAgBY,GACjBX,EAAeW,GAIlBD,GAAsB,GAAKA,EAAqB,KACjD7E,GAAoB1xB,EAAOu2B,GAAoBp6E,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGA,MAAM,OAAO,GACrFu5E,IAAea,GAChBZ,EAAcY,IAGfF,GAAiB,IAAMA,EAAgB,KACxC5E,GAAezxB,EAAOq2B,GACnBb,IAAea,GAChBZ,EAAcY,IAMlB,IAAIqD,EAAa/5B,EAAO,GAAGxjD,MAAM,KAC7B26E,EAA6B,GAC7BC,EAAiC,GACjCC,EAA4B,GAC5BC,EAAgC,GACpCH,EAAW1iE,OAAO,GAClB2iE,EAAe3iE,OAAO,GACtB4iE,EAAU5iE,OAAO,GACjB6iE,EAAc7iE,OAAO,GACrB,IAAK,IAAItX,EAAW,EAAGA,EAAI48E,EAAW38E,OAAS,EAAGD,IAM9C,IAAgG,IAA7F48E,EAAW76D,QAAQ6yD,GAAkBv1E,MAAM,KAAK,GAAK,IAAMu9E,EAAW58E,GAAGX,MAAM,KAAK,KACnFu1E,GAAkBv1E,MAAM,KAAK,KAAOu9E,EAAW58E,GAAGX,MAAM,KAAK,GAAK,CACpE,IAAI+6E,EAAWwC,EAAW58E,GAAGX,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGA,MAAM,KAAK,GACpD,MAAb+6E,GACDJ,EAAWxiE,KAAKolE,EAAW58E,IAC3Bi6E,EAAeziE,KAAKxX,IACC,MAAbo6E,IACRF,EAAU1iE,KAAKolE,EAAW58E,IAC1Bm6E,EAAc3iE,KAAKxX,IAK3B,GAAGg6E,EAAW/5E,OAAS,EAAG,CACxB,IAAI48E,EAAqBtB,GAAqB,EAAGvB,EAAW/5E,OAAO,GACnE40E,GAAemF,EAAW6C,GAEvB7D,IAAoBiB,EAAe4C,IACpC5D,EAAmBgB,EAAe4C,IAGpC,IAAIvC,EAAWsC,EAAW76D,QAAQgC,OAAOi2D,EAAW6C,GAAoBx9E,MAAM,UAAU,GAAK,YAG5E,IAAdi7E,GACDxF,GAAmB8H,EAAWtC,GAC3BpB,IAAmBoB,EACpBnB,EAAkBmB,IAElBxF,GAAmB,GACnBqE,GAAmB,MAGrBrE,GAAmB,GACnBqE,GAAmB,SAIrBtE,GAAe,GACfoE,GAAoB,GAEpBnE,GAAmB,GACnBqE,GAAmB,GAYrB,IAAI2D,EAAej6B,EAAO,GAAGxjD,MAAM,KAC/B09E,EAAkBxB,GAAqB,EAAGuB,EAAa78E,OAAO,GAClE80E,GAAkB+H,EAAaC,GAC5BzE,IAAiByE,GAClBxE,EAAgBwE,GAIlB,IAAIC,EAAcn6B,EAAO,GAAGxjD,MAAM,KAC9B49E,EAAiB1B,GAAqB,EAAGyB,EAAY/8E,OAAO,GAChE+0E,GAAgBgI,EAAYC,GACzBzE,IAAgByE,GACjBxE,EAAewE,GA3MbC,GACA,IAAM8a,EAAWnvE,YAAW,WAC1B+oB,aAAaomD,GAsBrB,WACE,GAA0B,OAAtB5e,GAAU9yC,QACZ,OAGF60C,KAAY/B,GAAU9yC,QAAS,CAAE80C,YAAY,IAAQroE,MAAK,SAASo4B,GACjE,IAAI1rB,EAAW,IAAIhB,SACnBgB,EAASf,OAAO,UAAWysB,EAAOkwC,aAClCz8D,MAAM,sBACJ,CACEC,OAAQ,OACRT,KAAMqB,IAGP1M,MAAK,SAAC2M,GAAD,OAAcA,EAAS5I,UAC5B/D,MAAK,SAAC2M,GAAD,OASc47D,EATiB57D,EAUzC0P,EAAO1Z,aAAaI,MAAMvF,YAAY9C,UAAY6tE,EAGlDlsD,EAAO1Z,aAAaI,MAAMvF,YAAY5C,aAAe,CAACgnE,GAAcC,GAAmBF,GAAeG,GAAcE,GAAiBC,IAErI5lD,EAAO1Z,aAAaI,MAAM2hB,uBAC1BrI,EAAO1Z,aAAaI,MAAMu8B,0BAAyB,GAPrD,IAA0BipC,QANvBtoE,OAAM,SAAClT,GACNod,QAAQC,IAAIrd,MAxCRm4F,KACC,IAEL,IAAMC,EAAarvE,YAAW,WAC5B+oB,aAAasmD,GACb9B,GAAa,GAEQ,MAAlB/lD,OAAyC,IAAhBqoC,GAC1B8d,GAAY,KAEb,SAIP,OAAwCjmD,oBAAS,GAAjD,qBAAO4nD,GAAP,MAAqBC,GAArB,MACMC,GAAeP,GAAW73F,OAAO,EAEvC,IAAIqrB,MAAMq+B,QAAQmuC,KAAeA,GAAW73F,QAAU,EACpD,OAAO,KAqCT,SAASs7E,GAAqBjuD,EAAYnK,GACxC,OAAO/oB,KAAKgG,MAAMhG,KAAKsyC,UAAYvpB,EAAMmK,EAAM,GAAKA,GA2MvD,SAASgrE,GAAS5vE,EAAU6vE,EAAeC,GAGtC9vE,EAAK20B,GAAK,KAAkB,IAAX30B,EAAK20B,EACvBsf,GAAY,CAAEtf,EAAG,EAAGC,EAAG,KAIzBqf,GAAY,CAAEtf,EAAG30B,EAAK20B,EAAGC,EAAG50B,EAAK40B,IACjCoyC,GAAWtyF,EAASigD,EAKpBo7C,GAAoBF,GACpBG,GAAqBH,GAqUrB7B,GAAkB6B,IAmCpB,SAASG,GAAqBH,GAGR,IAAD,EAcA,YAfnB,GAA4B,IAAzBhB,GAAct3F,QACf,GAAc,IAAXs4F,EAC2C,IAAzCzrF,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCi5C,EAAY,WAEZA,EAAY,cAET,GAAc,IAAXiC,EAAc,CAAC,IAAD,EACsB,IAAzCzrF,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCi5C,EAAY,QAEZA,EAAY,eAIhB,GAAc,IAAXiC,EAC2C,IAAzCzrF,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCi5C,EAAY,WACqC,IAAzCxpF,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAC3CqyC,IAAY,EACZgH,IAAmB,GACnBJ,EAAYiB,GAAcgB,KACuB,IAAzCzrF,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAC3CqyC,IAAY,EACZgH,IAAmB,GACnBJ,EAAYiB,GAAcgB,EAAO,KACgB,IAAzCzrF,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAC3CqyC,IAAY,EACZgH,IAAmB,GACnBJ,EAAYiB,GAAcgB,EAAO,KACgB,IAAzCzrF,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAC3CqyC,IAAY,EACZgH,IAAmB,GACnBJ,EAAYiB,GAAcgB,EAAO,KACgB,IAAzCzrF,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAC3CqyC,IAAY,EACZgH,IAAmB,GACnBJ,EAAYiB,GAAcgB,EAAO,KAEjCjC,EAAY,cAET,GAAc,IAAXiC,EAAc,CAAC,IAAD,YACsB,IAAzCzrF,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCi5C,EAAY,QACqC,IAAzCxpF,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAC3CqyC,IAAY,EACZgH,IAAmB,GACnBJ,EAAYiB,GAAcgB,EAAO,KACgB,IAAzCzrF,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAC3CqyC,IAAY,EACZgH,IAAmB,GACnBJ,EAAYiB,GAAcgB,KACuB,IAAzCzrF,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAC3CqyC,IAAY,EACZgH,IAAmB,GACnBJ,EAAYiB,GAAcgB,EAAO,KACgB,IAAzCzrF,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAC3CqyC,IAAY,EACZgH,IAAmB,GACnBJ,EAAYiB,GAAcgB,EAAO,KACgB,IAAzCzrF,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAC3CqyC,IAAY,EACZgH,IAAmB,GACnBJ,EAAYiB,GAAcgB,EAAO,KAEjCjC,EAAY,cAET,GAAGiC,GAAU,EAAG,CAAC,IAAD,YACuB,IAAzCzrF,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCi5C,EAAY,QACqC,IAAzCxpF,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAC3Ci5C,EAAY,WACqC,IAAzCxpF,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAIM,IAAzCvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAIM,IAAzCvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAIM,IAAzCvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAX3CqyC,IAAY,EACZgH,IAAmB,GACnBJ,EAAYiB,GAAcgB,EAAO,KAcjCjC,EAAY,UAyBpB,SAASmC,GAAoBF,GAE3B,GAAc,IAAXA,EAAc,CAAC,IAAD,gBAIR,IAMA,IAMA,IAMA,IAMA,IAMA,IAMA,IAvCHI,EAAY,EAChB,GAAG7rF,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACpFs7C,GAAwB,OAExB7rF,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAK,EAE1C,GAAGxwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACxCs7C,GAAwB,OAExB7rF,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,EAEhF,GAAG7rF,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACxCs7C,GAAwB,OAExB7rF,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,EAEhF,GAAG7rF,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACxCs7C,GAAwB,OAExB7rF,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,EAEhF,GAAG7rF,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACxCs7C,GAAwB,OAExB7rF,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,EAEhF,GAAG7rF,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACxCs7C,GAAwB,OAExB7rF,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,EAEhF,GAAG7rF,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACxCs7C,GAAwB,OAExB7rF,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAG3E,GAAc,IAAXJ,EAAc,CAAC,IAAD,kBAIf,IAYA,IAMA,IAMA,IAMA,IAMA,IAvCHI,EAAY,EAChB,GAAG7rF,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACxCs7C,GAAwB,OAExB7rF,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAK,EAE1C,GAAGxwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACpFs7C,GAAwB,OACnB,GAA4C,IAAzC7rF,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAS,CAAC,IAAD,IACpDvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,EAEhF,GAAG7rF,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACxCs7C,GAAwB,OAExB7rF,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,EAEhF,GAAG7rF,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACxCs7C,GAAwB,OAExB7rF,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,EAEhF,GAAG7rF,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACxCs7C,GAAwB,OAExB7rF,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,EAEhF,GAAG7rF,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACxCs7C,GAAwB,OAExB7rF,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,EAEhF,GAAG7rF,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACxCs7C,GAAwB,OAExB7rF,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE3E,GAAc,IAAXJ,EAAc,CAAC,IAAD,mBAIf,MAMA,MAMA,MAMA,MAMA,MAMA,MAMA,MAvCHI,GAAY,EAChB,GAAG7rF,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,EAE1C,GAAGxwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACpFs7C,IAAwB,OAExB7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE3E,GAAc,IAAXJ,EAAc,CAAC,IAAD,wBAIf,MAMA,MAMA,MAMA,MAMA,MAMA,MAMA,MAvCHI,GAAY,EAChB,GAAG7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACpFs7C,IAAwB,OAExB7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE3E,GAAc,IAAXJ,EAAc,CAAC,IAAD,wBAIf,MAMA,MAMA,MAMA,MAMA,MAMA,MAMA,MAvCHI,GAAY,EAChB,GAAG7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACpFs7C,IAAwB,OAExB7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE3E,GAAc,IAAXJ,EAAc,CAAC,IAAD,wBAIf,MAMA,MAMA,MAMA,MAMA,MAMA,MAMA,MAvCHI,GAAY,EAChB,GAAG7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACpFs7C,IAAwB,OAExB7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE3E,GAAc,IAAXJ,EAAc,CAAC,IAAD,wBAIf,MAMA,MAMA,MAMA,MAMA,MAMA,MAMA,MAvCHI,GAAY,EAChB,GAAG7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCs7C,IAAwB,OAExB7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAEhF,GAAG7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,GAAMvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACrFs7C,IAAwB,OAExB7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,IAMpF,SAASC,GAASlwE,EAAUmwE,EAAaN,GA+LvC,GAAG7vE,EAAK40B,GAAgB,GAAVi7C,GAAkB7vE,EAAK40B,EAAK,KAAiB,GAAVi7C,GAAkB7vE,EAAK20B,IAAOjuB,EAAOjzB,IAAIiY,WAAW,GAAK,KAAQsU,EAAK20B,EAAI,EAAG,CAG5H,GAAc,IAAXk7C,EAGD,YADAO,GAAe,EAAG,QAEb,GAAc,IAAXP,EAGR,YADAO,GAAe,EAAG,WAEK,IAAD,EAAjB,GAAc,IAAXP,EACRzrF,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAAK,cACnC,GAAc,IAAXk7C,EAAc,CAAC,IAAD,EACtBzrF,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAAK,cACnC,GAAc,IAAXk7C,EAAc,CAAC,IAAD,EACtBzrF,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAAK,cACnC,GAAc,IAAXk7C,EAAc,CAAC,IAAD,EACtBzrF,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAAK,cACnC,GAAc,IAAXk7C,EAAc,CAAC,IAAD,EACtBzrF,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAAK,SAK1C,IAAI07C,EAAiBvgG,OAAO2pB,KAAK02E,EAAM,GAAI,yCACvClhC,EAAQ1sC,aAAY,WACtB,UAAG8tE,QAAH,IAAGA,KAAgBC,OAAQ,CAKvB,GAJAnuE,cAAc8sC,GAIA,IAAX4gC,EAAc,CAAC,IAAD,gBAE0E,IAM1C,IAOA,IAOA,IAMA,IAMA,IAMA,IAvC3CI,EAAY,EAChB,GAAG7rF,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACpFvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAK,OAExCq7C,GAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,EAAiC,GAAZA,OAE9EA,GAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE9EA,GAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE9EA,GAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE9EA,GAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE9EA,GAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE3E,GAAc,IAAXJ,EAAc,CAAC,IAAD,gBAEyB,IAM0C,IAO1C,IAOA,IAMA,IAMA,IAMA,IAvC3CI,EAAY,EAChB,GAA4C,IAAzC7rF,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAK,OAExCq7C,GAAwB,EAE1B,GAAG7rF,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACpFvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE9EA,GAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE9EA,GAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE9EA,GAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE9EA,GAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE9EA,GAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE3E,GAAc,IAAXJ,EAAc,CAAC,IAAD,oBAEyB,MAMA,MAO0C,MAO1C,MAMA,MAMA,MAMA,MAvC3CI,GAAY,EAChB,GAA4C,IAAzC7rF,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAG1B,GAAG7rF,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACpFvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE3E,GAAc,IAAXJ,EAAc,CAAC,IAAD,wBAEyB,MAMA,MAOA,MAO0C,MAM1C,MAMA,MAMA,MAvC3CI,GAAY,EAChB,GAA4C,IAAzC7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAG1B,GAAG7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACpFvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE3E,GAAc,IAAXJ,EAAc,CAAC,IAAD,wBAEyB,MAMA,MAOA,MAOA,MAM0C,MAM1C,MAMA,MAvC3CI,GAAY,EAChB,GAA4C,IAAzC7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAAG7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACpFvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE3E,GAAc,IAAXJ,EAAc,CAAC,IAAD,wBAEyB,MAMA,MAOA,MAOA,MAMA,MAM2C,MAM3C,MAvC3CI,GAAY,EAChB,GAA4C,IAAzC7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAAG7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,GAAMvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACrFvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE3E,GAAc,IAAXJ,EAAc,CAAC,IAAD,wBAEyB,MAMA,MAOA,MAOA,MAMA,MAMA,MAM2C,MAvCtFI,GAAY,EAChB,GAA4C,IAAzC7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAAG7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,GAAMvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACrFvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAKlFh8B,GAAY,CAACtf,EAAE,EAAGC,EAAE,OAEzB,KAsKCoyC,IAAY,EAEZwG,GAAQ,IA8BhB,SAAS4C,GAAej2D,EAAcpf,GACpC,GAAa,IAAVof,EAAa,CAAC,IAAD,gBAE2E,IAM1C,IAOA,IAOA,IAOA,IAOA,IAOA,IA1C3C81D,EAAY,EAChB,GAAG7rF,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACpFvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAK,OAExCq7C,GAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,EAAiC,GAAZA,OAE9EA,GAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE9EA,GAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE9EA,GAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE9EA,GAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE9EA,GAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAG3E,GAAa,IAAV91D,EAAa,CAAC,IAAD,gBAE0B,IAM0C,IAO1C,IAOA,IAMA,IAMA,IAMA,IAvC3C81D,EAAY,EAChB,GAA4C,IAAzC7rF,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAK,OAExCq7C,GAAwB,EAE1B,GAAG7rF,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACpFvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE9EA,GAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE9EA,GAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE9EA,GAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE9EA,GAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAE9EA,GAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,OAG3E,GAAa,IAAV91D,EAAa,CAAC,IAAD,iBAE0B,MAMA,MAOF,MAOE,MAMA,MAMA,MAMA,MAvC3C81D,GAAY,EAChB,GAA4C,IAAzC7rF,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAG1B,GAAG7rF,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACxCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,GAAkB,GAAbq7C,QAExCA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAG3E,GAAa,IAAV91D,EAAa,CAAC,IAAD,qBAE0B,MAMA,MAOA,MAOF,MAME,MAMA,MAMA,MAvC3C81D,GAAY,EAChB,GAA4C,IAAzC7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAG1B,GAAG7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAErC,GAAa,IAAVza,EAAa,CAAC,IAAD,qBAE0B,MAMA,MAOA,MAOA,MAMF,MAME,MAMA,MAvC3C81D,GAAY,EAChB,GAA4C,IAAzC7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAAG7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE3E,GAAa,IAAV91D,EAAa,CAAC,IAAD,qBAE0B,MAMA,MAOA,MAOA,MAMA,MAMF,MAME,MAvC3C81D,GAAY,EAChB,GAA4C,IAAzC7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAAG7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE3E,GAAa,IAAV91D,EAAa,CAAC,IAAD,qBAE0B,MAMA,MAOA,MAOA,MAMA,MAMA,MAMF,MAvCzC81D,GAAY,EAChB,GAA4C,IAAzC7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,OAExCq7C,IAAwB,EAG1B,GAA4C,IAAzC7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAA4C,IAAzC7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EACpCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,QAE9EA,IAAwB,EAE1B,GAAG7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACxCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,GAGlFjJ,IAAY,EACZ/yB,GAAY,CAACtf,EAAE,EAAGC,EAAE,IACpBo5C,IAAmB,GACnBJ,EAAY7yE,GA92DZjrB,OAAOywB,iBAAiB,WAAW,SAACR,GAE/BA,EAAGgpB,SAEQ,OAAXhpB,EAAGrnB,MAA0B,IAAVo2F,KACpB/uE,EAAG0lB,iBACHqpD,IAAQ,GACI,IAATvB,EACDC,GAAQ,IAEE,IAATD,GACDC,GAAQ,MAGX,IAEH19F,OAAOywB,iBAAiB,aAAa,SAACR,GAEpCA,EAAG0lB,mBAEmB,CAACgoC,SAAS,EAAO8iB,SAAS,IAElDzgG,OAAOywB,iBAAiB,eAAe,SAACR,GACtCA,EAAG0lB,mBACmB,CAACgoC,SAAS,EAAO8iB,SAAS,IAGlDzgG,OAAOqa,QAAU,SAACiQ,EAAS8Z,EAAQs8D,EAAQC,EAAO77E,GAUhD,MATwB,kBAAd,OAALA,QAAK,IAALA,OAAA,EAAAA,EAAOwF,UAAiD,6CAAd,OAALxF,QAAK,IAALA,OAAA,EAAAA,EAAOwF,UACjC,OAAZA,GAA+B,OAAX8Z,GAA8B,OAAXs8D,GAA6B,OAAVC,EAM5Dj8E,QAAQiL,KAAR,0BAAgCrF,GAAW8Z,EAAQs8D,EAAQC,EAAO77E,IALlE8b,GAAUC,QAAQ,cACY,OAA1B7hC,EAAcoiC,SAChBphC,OAAOC,SAASghC,WAKb,GA40DX,IACIvX,GADAk3E,GAAa,GA8ZjB,SAASC,GAAerrE,EAAWvK,EAAco1E,EAAaN,GAC5DvqE,EAAMmgB,iBACNirD,GAAO5hF,MAAK,IAAIM,MAAOwhF,WACvB9gG,OAAOo5C,aAAa1vB,IACpBA,GAAU1pB,OAAOqwB,YAAW,WA/Z9B,IAAgC0wE,EAA+BC,EAgarDJ,GAAOn5F,OAAS,GAAKm5F,GAAOA,GAAOn5F,OAAS,GAAKm5F,GAAOA,GAAOn5F,OAAS,GAAK,IAhZvF,SAAqB+tB,EAAWurE,EAAgBE,EAAeD,GAE7D,GAAgB,IAAbA,GAA+B,SAAZD,GAAkC,YAAZA,EAIrC,GAAgB,IAAbC,GAA+B,SAAZD,GAAkC,YAAZA,EAI5C,GAAgB,IAAbC,GAA+B,SAAZD,GAAkC,YAAZA,EAI5C,GAAgB,IAAbC,GAA+B,SAAZD,GAAkC,YAAZA,EAI5C,GAAgB,IAAbC,GAA+B,SAAZD,GAAkC,YAAZA,EAI5C,GAAgB,IAAbC,GAA+B,SAAZD,GAAkC,YAAZA,EAI5C,GAAgB,IAAbC,GAA+B,SAAZD,GAAkC,YAAZA,EAI5C,CACL,GAAgB,IAAbC,EAAgB,CAAC,IAAD,MACjB,GAAG1sF,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EAAI,OAC1FvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAAK,cACnC,GAAgB,IAAbm8C,EAAgB,CAAC,IAAD,MACxB,GAAG1sF,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EAAI,OAC1FvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAAK,cACnC,GAAgB,IAAbm8C,EAAgB,CAAC,IAAD,MACxB,GAAG1sF,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EAAI,OAC1FvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAAK,cACnC,GAAgB,IAAbm8C,EAAgB,CAAC,IAAD,MACxB,GAAG1sF,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EAAI,OAC1FvwC,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAAK,cACnC,GAAgB,IAAbm8C,EAAgB,CAAC,IAAD,MACxB,GAAG1sF,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EAAI,OAC1FvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAAK,cACnC,GAAgB,IAAbm8C,EAAgB,CAAC,IAAD,MACxB,GAAG1sF,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EAAI,OAC1FvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAAK,cACnC,GAAgB,IAAbm8C,EAAgB,CAAC,IAAD,MACxB,GAAG1sF,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EAAI,OAC1FvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAAK,SAK1C,IAAI07C,EAAiBvgG,OAAO2pB,KAAKs3E,EAAQ,GAAI,yCACzC9hC,EAAQ1sC,aAAY,WACtB,UAAG8tE,QAAH,IAAGA,KAAgBC,OAAQ,CAKvB,GAJAnuE,cAAc8sC,GAIE,IAAb6hC,EAAgB,CAAC,IAAD,gBAEwE,IAM1C,IAOA,IAOA,IAMA,IAMA,IAMA,IAvC3Cb,EAAY,EACb7rF,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GACpFvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAK,GAExCq7C,GAAwB,EAEkB,IAAzC7rF,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GACpCvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,GAE9EA,GAAwB,EAGkB,IAAzC7rF,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GACpCvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,GAE9EA,GAAwB,EAGkB,IAAzC7rF,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GACpCvwC,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,GAE9EA,GAAwB,EAEkB,IAAzC7rF,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GACpCvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,GAE9EA,GAAwB,EAEkB,IAAzC7rF,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,GACpCvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,GAE9EA,GAAwB,EAEkB,IAAzC7rF,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,IACpCvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,QAE3E,GAAgB,IAAba,EAAgB,CAAC,IAAD,gBAEuB,IAM0C,IAO1C,IAOA,IAMA,IAMA,IAMA,IAvC3Cb,EAAY,EAC4B,IAAzC7rF,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GACpCvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAK,GAExCq7C,GAAwB,EAEvB7rF,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GACpFvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,GAE9EA,GAAwB,EAGkB,IAAzC7rF,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GACpCvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,GAE9EA,GAAwB,EAGkB,IAAzC7rF,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GACpCvwC,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,GAE9EA,GAAwB,EAEkB,IAAzC7rF,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GACpCvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,GAE9EA,GAAwB,EAEkB,IAAzC7rF,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,GACpCvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,GAE9EA,GAAwB,EAEkB,IAAzC7rF,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,IACpCvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,GAAkC,GAAbA,QAE3E,GAAgB,IAAba,EAAgB,CAAC,IAAD,sBAEuB,MAMA,MAO0C,MAO1C,MAMA,MAMA,MAMA,MAvC3Cb,GAAY,EAC4B,IAAzC7rF,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,GAExCq7C,IAAwB,EAEkB,IAAzC7rF,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,IAE9EA,IAAwB,EAGvB7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,GACpFvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,IAE9EA,IAAwB,EAGkB,IAAzC7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,IAE9EA,IAAwB,EAEkB,IAAzC7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,IAE9EA,IAAwB,EAEkB,IAAzC7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,IAE9EA,IAAwB,EAEkB,IAAzC7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,IACpCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,SAE3E,GAAgB,IAAba,EAAgB,CAAC,IAAD,wBAEuB,MAMA,MAOA,MAO0C,MAM1C,MAMA,MAMA,MAvC3Cb,GAAY,EAC4B,IAAzC7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,GAExCq7C,IAAwB,EAEkB,IAAzC7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,GAExCq7C,IAAwB,EAGkB,IAAzC7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,IAE9EA,IAAwB,EAGvB7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,GACpFvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,IAE9EA,IAAwB,EAEkB,IAAzC7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,GAExCq7C,IAAwB,EAEkB,IAAzC7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,IAE9EA,IAAwB,EAEkB,IAAzC7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,IACpCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,SAE3E,GAAgB,IAAba,EAAgB,CAAC,IAAD,wBAEuB,MAMA,MAOA,MAOA,MAM0C,MAM1C,MAMA,MAvC3Cb,GAAY,EAC4B,IAAzC7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,GAExCq7C,IAAwB,EAEkB,IAAzC7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,GAExCq7C,IAAwB,EAGkB,IAAzC7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,GAExCq7C,IAAwB,EAGkB,IAAzC7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,IAE9EA,IAAwB,EAEvB7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,GACpFvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,IAE9EA,IAAwB,EAEkB,IAAzC7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,IAE9EA,IAAwB,EAEkB,IAAzC7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,IACpCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,SAE3E,GAAgB,IAAba,EAAgB,CAAC,IAAD,wBAEuB,MAMA,MAOA,MAOA,MAMA,MAM2C,MAM3C,MAvC3Cb,GAAY,EAC4B,IAAzC7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,GAExCq7C,IAAwB,EAEkB,IAAzC7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,GAExCq7C,IAAwB,EAGkB,IAAzC7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,GAExCq7C,IAAwB,EAGkB,IAAzC7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,IAE9EA,IAAwB,EAEkB,IAAzC7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,IAE9EA,IAAwB,EAEvB7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,GAAMvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,GACrFvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,IAE9EA,IAAwB,EAEkB,IAAzC7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,IACpCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,SAE3E,GAAgB,IAAba,EAAgB,CAAC,IAAD,wBAEuB,MAMA,MAOA,MAOA,MAMA,MAMA,MAM2C,MAvCtFb,GAAY,EAC4B,IAAzC7rF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,GAExCq7C,IAAwB,EAEkB,IAAzC7rF,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,GAExCq7C,IAAwB,EAGkB,IAAzC7rF,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAAC+pF,GAAYvwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAK,GAExCq7C,IAAwB,EAGkB,IAAzC7rF,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACgqF,GAAYxwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,IAE9EA,IAAwB,EAEkB,IAAzC7rF,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACiqF,GAAYzwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,IAE9EA,IAAwB,EAEkB,IAAzC7rF,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,GACpCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,IAE9EA,IAAwB,GAEvB7rF,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,GAAMvwC,OAAM,WAACkqF,GAAY1wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,KACrFvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EACvCvwC,OAAM,WAACmqF,GAAY3wD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAI7jD,KAA+B,IAAbk/F,IAAkC,GAAbA,IAIlFjJ,IAAY,EACZ/yB,GAAY,CAACtf,EAAE,EAAGC,EAAE,IACpBg5C,EAAYiD,MAEjB,SA/VwE,CAAC,IAAD,QACzE,GAAGzsF,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EAAI,OAC1FvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAAKjjD,KAAKgG,MAAMhG,KAAKsyC,UAAYtd,EAAOjzB,IAAIiY,WAAW,GAAK,IAAM,GAAK,KAC1GtH,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAIljD,KAAKgG,MAAM,IAAAhG,KAAKsyC,SAA4B,KAAmB,GAAZ8sD,MAPjB,CAAC,IAAD,QACzE,GAAG1sF,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EAAI,OAC1FvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAAKjjD,KAAKgG,MAAMhG,KAAKsyC,UAAYtd,EAAOjzB,IAAIiY,WAAW,GAAK,IAAM,GAAK,KAC1GtH,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAIljD,KAAKgG,MAAM,IAAAhG,KAAKsyC,SAA4B,KAAmB,GAAZ8sD,MAPjB,CAAC,IAAD,QACzE,GAAG1sF,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EAAI,OAC1FvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAAKjjD,KAAKgG,MAAMhG,KAAKsyC,UAAYtd,EAAOjzB,IAAIiY,WAAW,GAAK,IAAM,GAAK,KAC1GtH,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAIljD,KAAKgG,MAAM,IAAAhG,KAAKsyC,SAA4B,KAAmB,GAAZ8sD,MAPjB,CAAC,IAAD,QACzE,GAAG1sF,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EAAI,OAC1FvwC,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAAKjjD,KAAKgG,MAAMhG,KAAKsyC,UAAYtd,EAAOjzB,IAAIiY,WAAW,GAAK,IAAM,GAAK,KAC1GtH,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAIljD,KAAKgG,MAAM,IAAAhG,KAAKsyC,SAA4B,KAAmB,GAAZ8sD,MAPjB,CAAC,IAAD,QACzE,GAAG1sF,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EAAI,OAC1FvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAAKjjD,KAAKgG,MAAMhG,KAAKsyC,UAAYtd,EAAOjzB,IAAIiY,WAAW,GAAK,IAAM,GAAK,KAC1GtH,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO+sB,EAAIljD,KAAKgG,MAAM,IAAAhG,KAAKsyC,SAA4B,KAAmB,GAAZ8sD,MAPjB,CAAC,IAAD,SACzE,GAAG1sF,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EAAI,OAC1FvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,GAAKjjD,KAAKgG,MAAMhG,KAAKsyC,UAAYtd,EAAOjzB,IAAIiY,WAAW,GAAK,IAAM,GAAK,KAC1GtH,OAAM,WAAC8pF,GAAYtwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAIljD,KAAKgG,MAAM,IAAAhG,KAAKsyC,SAA4B,KAAmB,GAAZ8sD,MAPxB,CAAC,IAAD,YAClE,GAAG1sF,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,EAAI,EAAI,OAC1FvwC,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO8sB,GAAKjjD,KAAKgG,MAAMhG,KAAKsyC,UAAYtd,EAAOjzB,IAAIiY,WAAW,GAAK,IAAM,GAAK,KAC1GtH,OAAM,WAAC6pF,GAAYrwD,eAAb,cAAC,GAAqB/V,OAAO+sB,EAAIljD,KAAKgG,MAAM,IAAAhG,KAAKsyC,SAA4B,KAAmB,GAAZ8sD,EA2X5Ff,GAAoBe,GAGpBd,GAAqBc,GAErB9C,GAAkB8C,GAGlBtD,GAAQ,GASAwD,CAAY1rE,EAAMsmB,OAAQ7wB,EAAOo1E,EAAMN,IAE3BvqE,EAAMsmB,OAnaIilD,EAmaI91E,EAna2B+1E,EAmadjB,GAja3Cn7F,EAASigD,EAAI,GAAKjgD,EAASigD,EAAI,IAAMo5C,KAAmB+C,IAC1DhC,IAAQ,GACI,IAATvB,EACEI,IAAakD,GACdrD,GAAQ,IAGA,IAATD,GACDC,GAAQ,GAEVI,EAAYiD,GACZ7C,GAAkB8C,OAwZjB,KAKH,OAAO,eAAC,KAAD,UAAW,WAAK,IAAD,QACpB,OAAO,uBAAKlqF,IAAK0mF,EAAQ79C,UAAWL,EAAQ+W,KAAMtpC,MAAO,CAACoR,gBAAiB,WAApE,UAGD,gBAAC,KAAD,CAAWgjE,YAAqB,IAAT1D,EAAgB,CAACziD,QAAS,QAAS7c,gBAA8B,SAAb0/D,EAAsB,UAAyB,YAAbA,EAAyB,UAAyB,UAAbA,EAAuBiB,GAAgB,QAChL7a,UAAwB,UAAb4Z,EAAuB,0BAA4B,2BAA6B,CAAC7iD,QAAS,OAAQ7c,gBAAiB,QAASwhB,UAAWL,EAAQ3K,KAAM9tC,MAAM,WACvLu6F,QAAS,EAAGjK,aAAsB,IAATsG,EAAgBx8F,IAAiB,MAA4D,MAAsC,OAFpJ,UAIA,gBAAC,YAAD,WACE,eAAC,GAAD,CAAY22F,cA3nFF,MA2nFgChhE,OAAQA,IAClD,eAAC,KAAD,UAAW,kBAAM,eAAC,GAAD,CAAKojE,iBAAsDtjF,IAAzC4mF,GAAoB/tD,kBA5nF7C,MA6nFO3Y,OAAQA,OA4CzB,eAAC,KAAD,CAAqJ9f,IAAKqnF,GAAqBxhB,OAAQ,SAACx5E,EAAG+sB,GAAJ,OAAa4vE,GAAS5vE,EAAM,IAAY4H,OAAQ,SAAC30B,EAAG+sB,GAAJ,OAAakwE,GAASlwE,EAAM,GAAI,IAAImxE,gBAAiB,CAACx8C,EAAG,EAAGC,EAAG,GAAtS,SAEA,uBAAK/3B,MAAO,CAACnoB,SAAS,WAAYm2C,MAAa,KAAahtB,KAAI9sB,IAAiBqgG,GAAoDrvC,aAAc,MAAOjX,QAAQ,OAAQx4B,OAAOm7E,EAAY,EAAiB,SAAbE,GAA+C,IAAnBI,GAAN,GAAoC,GAAa18F,OAAO,QAA/Q,UACA,uBAAMwrB,MAAO,CAACnoB,SAAS,WAAYm2C,MAAa,KAAahtB,IAAI,MAAOkkC,aAAc,MAAOjX,QAAQ,OAAQx4B,OAAOm7E,EAAY,EAAiB,SAAbE,EAAsB,GAAM,IAE9JznD,QAAS,SAACjzC,GAER09F,GAAe19F,EAAG,OAAQ,GAAI,IAEhCs7E,WAAY,SAACt7E,GACX09F,GAAe19F,EAAG,OAAQ,GAAI,IAPlC,UAWI,sBAAKuW,IStvFN,y0HTsvF4BqT,MAAO,CAACzrB,MAAML,IAAiB,IAAM,GAAIM,OAAO,OAAQqD,SAAS,WAAYmpB,IAAI,MAAOf,MAAK/rB,IAAiB,OAAem6C,WAAW,OAAQ54B,OAAOm7E,EAAY,EAAiB,SAAbE,EAAsB,GAAM,IAAcxiD,WAAW,EAAOE,IAAI,KAClQ,sBAAK7hC,IAAK6nF,GAAex0E,MAAO,CAACzrB,MAAML,IAAiB,IAAM,GAAIM,OAAON,IAAiB,IAAM,GAAIiU,MAAM,QAAStQ,SAAS,WAAYmpB,IAAI,MAAOf,KAAK/rB,IAAiB,OAAS,MAAQm6C,WAAW,OAAQ54B,OAAOm7E,EAAY,EAAI,IAAKtiD,WAAW,EAAOE,IAAI,QAGjQ,uBAAKxuB,MAAO,CAACnoB,SAAU,WAAYtD,MAAM,QAASC,OAAO,MAAOyrB,KAAK,MAAwBmR,gBAAgB,UAAW8zB,aAAa,MAAOhJ,SAAS,QAASl7B,IAAI,MAClKitB,QAAU1mC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAAC6pF,GAAYrwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EAAM,QAAU,OAASriC,QAAQ,MAD9H,UAEA,eAAC,KAAD,CAAcuK,MAAO,CAACzrB,MAAM,OAAQC,OAAO,OAAQqD,SAAS,WAAYm2C,MAAM,OAAQ7lC,MAAM,QAASqlC,QAAQt5C,IAAiB,OAAS,MAAOk6C,UAAUl6C,IAAiB,WAAa,WAAYuhB,OAAO,MACvM4zB,QAAS,WACPkqD,GAAe,EAAG,SAEpB7hB,WAAY,WACV6hB,GAAe,EAAG,WAGpB,eAAC,GAAD,CAAS1pE,OAAQA,EAAQjY,KAAM,gBA5ByI,GAmC3K,eAAC,KAAD,CAAqJ7H,IAAKsnF,GAAqBzhB,OAAQ,SAACx5E,EAAG+sB,GAAJ,OAAa4vE,GAAS5vE,EAAM,IAAe4H,OAAQ,SAAC30B,EAAG+sB,GAAJ,OAAakwE,GAASlwE,EAAM,GAAI,IAAImxE,gBAAiB,CAACx8C,EAAG,EAAGC,EAAG,GAAzS,SAED,uBAAK/3B,MAAO,CAACnoB,SAAS,WAAYm2C,MAAa,KAAahtB,IAAI9sB,IAAiBqgG,IAA4BE,GAAwBvvC,aAAc,MAAOjX,QAAQ,OAAQx4B,OAAOm7E,EAAY,EAAiB,YAAbE,GAAkD,IAAnBI,GAAN,GAAoC,GAAa18F,OAAO,QAAlR,UACA,uBAAMwrB,MAAO,CAACnoB,SAAS,WAAYm2C,MAAa,KAAahtB,IAAI,MAAOkkC,aAAc,MAAOjX,QAAQ,OAAQx4B,OAAOm7E,EAAY,EAAiB,YAAbE,EAAyB,GAAM,IACjKznD,QAAS,SAACjzC,GAER09F,GAAe19F,EAAG,UAAW,GAAI,IAEnCs7E,WAAY,SAACt7E,GACX09F,GAAe19F,EAAG,UAAW,GAAI,IANrC,UAUI,sBAAKuW,IexxFN,yzHfwxF+BqT,MAAO,CAACzrB,MAAML,IAAiB,IAAM,GAAIM,OAAO,OAAQqD,SAAS,WAAYmpB,IAAI,MAAOf,MAAK/rB,IAAiB,OAAem6C,WAAW,OAAQ54B,OAAOm7E,EAAY,EAAiB,YAAbE,EAAyB,GAAM,IAAcxiD,WAAW,EAAOE,IAAI,KACxQ,sBAAK7hC,IgBzxFN,qyChByxF6BqT,MAAO,CAACzrB,MAAML,IAAiB,IAAM,GAAIM,OAAON,IAAiB,IAAM,GAAIiU,MAAM,QAAStQ,SAAS,WAAYmpB,IAAI,MAAOf,KAAK/rB,IAAiB,OAAS,MAAQm6C,WAAW,OAAQ54B,OAAOm7E,EAAY,EAAI,IAAKtiD,WAAW,EAAOE,IAAI,QAGpQ,uBAAKxuB,MAAO,CAACnoB,SAAU,WAAYtD,MAAM,QAASC,OAAO,MAAOyrB,KAAK,MAAwBmR,gBAAgB,UAAW8zB,aAAa,MAAOhJ,SAAS,QAASl7B,IAAI,MAClKitB,QAAU1mC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAAC8pF,GAAYtwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,EAAM,QAAU,OAASriC,QAAQ,MAD9H,UAEA,eAAC,KAAD,CAAcuK,MAAO,CAACzrB,MAAM,OAAQC,OAAO,OAAQqD,SAAS,WAAYm2C,MAAM,OAAQ7lC,MAAM,QAASqlC,QAAQt5C,IAAiB,OAAS,MAAOk6C,UAAUl6C,IAAiB,WAAa,WAAYuhB,OAAO,MACvM4zB,QAAS,WACPkqD,GAAe,EAAG,YAEpB7hB,WAAY,WACV6hB,GAAe,EAAG,cAGpB,eAAC,GAAD,CAAS1pE,OAAQA,EAAQjY,KAAM,mBA3B0I,GAqD5K,qCACCk4E,GAAS7jE,QAAO,SAAA4vB,GAAI,MAAuB,WAAnBA,EAAKj7B,aAAwBhkB,KAAI,SAAC8kB,EAAS4hB,GAAV,+BACzD,eAAC,KAAD,CAA8Eo3D,OAAwB,KAAhBh5E,EAAQxpB,IAAa,CAAC8uB,KAAmB,IAAZsc,EAAM,GAAWrd,OAAQ4J,EAAOjzB,IAAIiY,WAAW,GAAK,IAAKm/B,OAAQ,GAAI1sB,OAASuI,EAAOjzB,IAAIiY,WAAW,IAAM,GAAkB,IAAXyuB,EAAM,KAAc,GAExPvzB,IAAMuzB,EAAM,IAAO,EAAIg0D,GAAwB,IAAVh0D,EAAci0D,GAAwB,IAAVj0D,EAAck0D,GAAwB,IAAVl0D,EAAcm0D,GAAwB,IAAVn0D,EAAco0D,GAAwB,IAAVp0D,EAAcq0D,GAAcC,GAEjKhiB,OAAQ,SAACx5E,EAAG+sB,GAAJ,OAAa4vE,GAAS5vE,EAAOma,EAAM,EAAI5hB,EAAQ9J,OAAOmZ,OAAQ,SAAC30B,EAAG+sB,GAAJ,OAAakwE,GAASlwE,EAAMzH,EAAQxpB,IAAMorC,EAAM,IAA0Cg3D,gBAAiB,CAACx8C,EAAG,EAAGC,EAAG,GAJ3M,SAME,uBAAK/3B,MAAO,CAACnoB,SAAS,WAAYm2C,MAAa,KAAahtB,IAAI9sB,IA7rFnD,EA6rFiG,KAAXopC,EAAM,GA9rF5F,EA8rFmI,IAATA,EAAM,GAAQ4nB,aAAc,MAAOjX,QAAQ,OAAQx4B,OAAOm7E,EAAY,EAAIE,IAAap1E,EAAQ9J,MAAas/E,KAAoB5zD,EAAM,EAAhC,GAA4C,IAAOA,EAAM,EAAG,GAAK9oC,OAAO,QAArT,UACA,uBAAMwrB,MAAO,CAACnoB,SAAS,WAAYm2C,MAAa,KAAahtB,IAAI,MAAOkkC,aAAc,MAAOjX,QAAQ,OAAQx4B,OAAOm7E,EAAY,EAAIE,IAAap1E,EAAQ9J,KAAO,GAAM,IAAO0rB,EAAM,EAAG,IAEpL+L,QAAS,SAACjzC,GAGR09F,GAAe19F,EAAGslB,EAAQ9J,KAAM8J,EAAQxpB,IAAMorC,EAAM,IAsBtDo0C,WAAY,SAACt7E,GACX09F,GAAe19F,EAAGslB,EAAQ9J,KAAM8J,EAAQxpB,IAAMorC,EAAM,IA5BxD,UA+DE,sBAAK3wB,IAAK+O,EAAQP,UAAW6E,MAAO,CAACzrB,MAAML,IAAiB,IAAM,GAAIM,OAAO,OAAQqD,SAAS,WAAYmpB,IAAI,MAAwFf,MAAK/rB,IAAiB,OAAem6C,WAAW,OAAQ54B,OAAOm7E,EAAY,EAAIE,IAAap1E,EAAQ9J,KAAO,GAAM,IAAO0rB,EAAM,EAAG,IAAMgR,WAAW,EAAOE,IAAI,KACnW,sBAAK7hC,IAAK+O,EAAQN,SAAU4E,MAAO,CAACzrB,MAAML,IAAiB,IAAM,GAAIM,OAAON,IAAiB,IAAM,GAAIiU,MAAM,QAAStQ,SAAS,WAAYmpB,IAAI,MAA4Ff,KAAK/rB,IAAiB,OAAS,MAAQm6C,WAAW,OAAQ54B,OAAOm7E,EAAY,EAAI,IAAKtiD,WAAW,EAAOE,IAAI,QAGzV,uBAAKxuB,MAAO,CAACnoB,SAAU,WAAYtD,MAAM,QAASC,OAAO,MAAOyrB,KAAK,MAAwBmR,gBAAgB1V,EAAQL,UAAW6pC,aAAa,MAAOhJ,SAAS,QAASl7B,IAAI,MAE1KitB,SAAU1mC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAAC+pF,GAAYvwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,IAAOxa,EAAM,IAAO,IAAiB/1B,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAACgqF,GAAYxwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,IAAOxa,EAAM,IAAO,IAAiB/1B,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAACiqF,GAAYzwD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,IAAOxa,EAAM,IAAO,IAAiB/1B,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAACkqF,GAAY1wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,IAAOxa,EAAM,IAAO,IAAiB/1B,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,GAAKvwC,OAAM,UAACmqF,GAAY3wD,eAAb,aAAC,EAAqB/V,OAAO8sB,EAAI,IAAOxa,EAAM,IAAO,EAA3d,QAA0e,OAEhY7nB,QAAQ,MAJxO,UAKA,eAAC,KAAD,CAAcuK,MAAO,CAACzrB,MAAM,OAAQC,OAAO,OAAQqD,SAAS,WAAYm2C,MAAM,OAAQ7lC,MAAM,QAASqlC,QAAQt5C,IAAiB,OAAS,MAAOk6C,UAAUl6C,IAAiB,WAAa,WAAYuhB,OAAO,MACvM4zB,QAAS,WAGPkqD,GAAgBj2D,EAAM,EAAI5hB,EAAQ9J,OAEpC8/D,WAAY,WAGV6hB,GAAgBj2D,EAAM,EAAI5hB,EAAQ9J,SA+K9B,yBAAQjF,IAAK+O,EAAQxpB,IAAK+5B,MAAOvQ,EAAQ9J,KAAM24E,mBAAmB,EAAMC,YAAa,EAAGxqE,MAAO,CAACzrB,MAAM,OAAQC,OAAO,iBAnQzH8oC,EAAM,QA2Qd,eAAC,GAAD,CAAQzT,OAAQA,EAAQr1B,OAASN,KAAkBE,IAAgB,SAAMuV,IACzE,eAAC,GAAD,CAAYkgB,OAAQA,EAAQr1B,OAASN,KAAkBE,IAAgB,SAAMuV,IAC7E,eAAC,GAAD,CAAWkgB,OAAQA,EAAQr1B,OAASN,KAAkBE,IAAgB,SAAMuV,OAE9E,sBAAKqW,MAAO,CAACiuB,SAAmB,IAATyiD,EAAgB,QAAU,OAASx0C,SAAS,QAAS3nD,MAAM,OAAQ01C,SAAS,SAAnG,SACE,eAAC,GAAD,CAASpgB,OAAQA,EAAQjY,KAAMq4E,UAGnC,uBAAkCjqE,MAAO,CAACzrB,MAAM,OAAQC,OAAO,OAAQwhD,WAAW,SAAUoU,eAAe,SAAUlU,cAAc,SAASr+C,SAAS,WAAYu5B,gBAAiB,UAAW2c,UAAU,SAAUE,QAAQ2iD,EAAY,QAAU,QAA/O,UACA,oBAAG5wE,MAAO,CAAC+tB,UAAU,QAAS5lC,MAAO,QAAStQ,SAAS,WAAYm2C,MAAM,SAAUhtB,IAAI,OAAQ+nB,SAAU70C,IAAiB,SAAW,OAAQwoD,WAAW,UAAxJ,2BACE,uBAAK18B,MAAO,CAACnoB,SAAS,WAAYmpB,IAAoB,KAAhB6wE,GAAqB,MAAQ,MAAnE,UACA,oBAAG7xE,MAAO,CAAC+tB,UAAU,SAAU5lC,MAAO,QAAQ4gC,SAAS70C,IAAiB,OAAS,SAAUwoD,WAAW,UAAtG,wBACA,oBAAG18B,MAAOmyE,GAAY,CAACpkD,UAAU,SAAU5lC,MAAO,QAASipC,UAAUl9C,IAAiB,UAAY,UAAW60C,SAAS70C,IAAiB,SAAW,SAAUwoD,WAAW,OAAQlhC,QAAS,EAAGsyB,WAAY,iBAAmB,CAACC,UAAU,SAAU5lC,MAAO,QAASipC,UAAUl9C,IAAiB,UAAY,UAAW60C,SAAS70C,IAAiB,OAAS,SAAUwoD,WAAW,OAAQlhC,QAAS,GAA1X,SAA+X22E,KAC/X,sBAAKxlF,IAAKklF,GAAa7xE,MAAO6xE,GAAc,CAACr9F,OAAQ,QAAS45C,UAAW,WAAY5yB,QAAQ,EAAGsyB,WAAY,kCAAmCO,WAAW,QAAU,CAAC75C,OAAQ,MAAO45C,UAAW,WAAY5yB,QAAQ,EAAGsyB,WAAY,gBAAiBO,WAAW,QAASC,WAAW,EAAOE,IAAI,KAC7R,oBAAGxuB,MAAO,CAAC+tB,UAAU,SAAU5lC,MAAO,UAAW4gC,SAAS70C,IAAiB,SAAW,OAAQqsD,SAAS,SAAU1oD,SAAS,WAAYu5C,UAAU,SAAU78C,MAAM,MAAOm5C,WAAW,MAAOgP,WAAW,UAApM,SAAgNo1C,KAChN,sBAAK9xE,MAAO,CAACzrB,MAAML,IAAiB,OAAS,OAAQk9B,gBAAgB,YAAa8zB,aAAc,MAAOrtD,SAAS,WAAYu5C,UAA0B,KAAhBygD,GAAqB,OAAS,QAASxjD,WAAW,QAAS1hC,IAAKkd,EAAO1Z,aAAaI,MAAMvF,YAAY9C,UAAWomC,WAAW,EAAOE,IAAI,KAC/Q,oBAAGxuB,MAAO,CAAC+tB,UAAU,SAAU5lC,MAAO,QAASipC,UAAU,SAAUrI,SAAS70C,IAAiB,OAAS,SAAUwoD,WAAW,UAA3H,SAAuI7yB,EAAO1Z,aAAaI,MAAMvF,YAAYhD,OAC7K,oBAAGgY,MAAO,CAAC+tB,UAAU,SAAU5lC,MAAO,QAASipC,UAAU,SAASrI,SAAS70C,IAAiB,OAAS,SAAUwoD,WAAW,UAA1H,+CACA,oBAAG18B,MAAO,CAAC+tB,UAAU,SAAU5lC,MAAO,QAASipC,UAAUl9C,IAAiB,UAAY,UAAU60C,SAAS70C,IAAiB,OAAS,SAAUwoD,WAAW,UAAxJ,wDACA,sBAAK18B,MAAO,CAACzrB,MAAML,IAAiB,QAAU,OAAQ2D,SAAS,WAAYw2C,WAAW,QAAS1hC,IAAKsiC,GAASX,WAAW,EAAOE,IAAI,WAInI,uBAAKzkC,IAAK8pE,GAAW7zD,MAAO,CAACnoB,SAAS,WAAYtD,MAAM,QAASC,OAAO,QAASy1C,SAAS,QAASx0B,QAAQ,KAA3G,UACE,sBAAKuK,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAOf,KAAK,OAAlD,SACE,sBAAKD,MAAO,CAACiuB,QAA2B,KAAlBkhC,GAAuB,QAAU,QAASxiE,IAAKwiE,GAAe56E,MAAO,QAASC,OAAQ,QAAS85C,WAAW,EAAOE,IAAI,OAE7I,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAOf,KAAK,OAAlD,SACE,sBAAKD,MAAO,CAACiuB,QAA8B,KAArBshC,GAA0B,QAAU,QAAS5iE,IAAK4iE,GAAkBh7E,MAAO,QAASC,OAAQ,QAAS85C,WAAW,EAAOE,IAAI,OAEnJ,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAOf,KAAK,OAAlD,SACE,sBAAKD,MAAO,CAACiuB,QAA0B,KAAjBmhC,GAAsB,QAAU,QAASziE,IAAKyiE,GAAc76E,MAAO,QAASC,OAAQ,QAAU85C,WAAW,EAAOE,IAAI,OAE5I,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAOf,KAAK,OAAlD,SACE,sBAAKD,MAAO,CAACiuB,QAA0B,KAAjBqhC,GAAsB,QAAU,QAAS3iE,IAAK2iE,GAAc/6E,MAAO,QAASC,OAAQ,QAAU85C,WAAW,EAAME,IAAI,OAE3I,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,OAAQf,KAAK,OAAnD,SACE,sBAAKD,MAAO,CAACiuB,QAA6B,KAApBuhC,GAAyB,QAAU,QAAS7iE,IAAK6iE,GAAiBj7E,MAAO,QAASC,OAAQ,QAAS85C,WAAW,EAAOE,IAAI,OAEjJ,sBAAKxuB,MAAO,CAACnoB,SAAS,WAAYmpB,IAAI,MAAOf,KAAK,OAAlD,SACE,sBAAKD,MAAO,CAACiuB,QAA2B,KAAlBwhC,GAAuB,QAAU,QAAS9iE,IAAK8iE,GAAel7E,MAAO,QAASC,OAAQ,QAAS85C,WAAW,EAAOE,IAAI,UAM/I,eAACxE,GAAA,EAAD,CAAQptB,KAAMo0E,EAAU93D,QAAS,kBAAM+3D,GAAY,IAAQluC,SAAU,kBAAMkuC,GAAY,IACvFjoC,aAAW,EACX7F,WAAY,CACVnjC,MAAO,CACLoR,gBAAiB,QACjBv5B,SAAS,WAET0oD,SAAS,SACT2E,aAAc,OACd3wD,MAAO,IACPC,OAAQ,IACRihB,OAAQ,EACRwK,KAAM,QACNmuB,UAAWl6C,IAAiB,aAAe,aAG/CijF,cAAe,CAAEC,WAAW,GAhB5B,SAkBA,eAACtuC,GAAA,EAAD,CAAe9oB,MAAO,CAACugC,SAAS,UAAhC,SACE,iCACE,sBAAKvgC,MAAO,CAACnoB,SAAS,WAAYooB,KAAK,OAAvC,SACE,qCAEEsyE,GAAW37F,KAAI,SAAC6yD,EAAOnsB,GACrB,OACE,sBAAKsV,UAAWtV,IAAUs1D,GAAergD,EAAQiX,YAAcjX,EAAQkX,MAAvE,SACGnsB,IAAUs1D,IACR,sBAAKjmF,IAAK88C,EAAOl1D,MAAO,QAASC,OAAQ,QAASg6C,IAAI,MAFwBlR,UAW3F,sBAAKtd,MAAO,CAACzrB,MAAM,OAAQC,OAAO,MAAO48B,gBAAgB,YAAav5B,SAAS,WAAYmpB,IAAI,SAC/F,uBAAKhB,MAAO,CAACiuB,QAAQ,OAAQp2C,SAAS,WAAYmpB,IAAI,OAAQzsB,MAAM,QAApE,UACE,sBAAK80C,QAAS,WA3xFvBwpD,GAAiC,IAAjBD,GAAqBE,GAAa,EAAIF,GAAe,IA2xF5D,SACE,eAAC,KAAD,CAAkBhgD,UAAWL,EAAQgX,aAEvC,sBAAKlgB,QAAS,WAzxFvBwpD,GAAgBD,KAAiBE,GAAa,EAAI,EAAIF,GAAe,IAyxF5D,SACE,eAAC,KAAD,CAAqBhgD,UAAWL,EAAQtM,SAE1C,sBAAKjmB,MAAO,CAACiuB,QAAQ,OAAQ15C,MAAM,MAAO61D,eAAe,SAAUvyD,SAAS,WAAYmpB,IAAI,OAAQf,KAAK,OAAzG,SAEEuyE,GAAW57F,KAAI,SAAC6yD,EAAOnsB,GACrB,OACE,sBAAKtd,MAAO,CAACnoB,SAAS,WAAYtD,MAAM,OAAQC,OAAO,OAAQ0wD,aAAa,MAAO9zB,gBAAiBkM,IAAUs1D,GAAe,QAAU,YAAa58C,WAAW,SAAUiP,OAAO,+BAYpMorC,GAAI/mD,YAAc,MiB1rGX,IAAMqrD,GAAwBt8B,GCW/Bu8B,GAAiC,aAEvC,SAASC,GAA0BC,EAAsB7jF,EACtByK,GACjC,IAAMq5E,EAAavrF,KAAEC,UAAUwH,EAAcA,EAAYjZ,KACvD0jB,EAAUA,EAAQ1jB,KAAO,CAACH,SAAS,CAAC,EAAG,GAAIJ,YAAY,IAUzD,OATIikB,GACFo5E,EAAUj9F,SAASb,SAAQ,SAAC0X,EAAK0rB,GAC/B,GAAI06D,EAAUj9F,SAASuiC,GAAO26D,EAAWl9F,SAASuiC,GAAM,CACtD,IAAM46D,EAASF,EAAUj9F,SAASuiC,GAAO26D,EAAWl9F,SAASuiC,GAC7D26D,EAAWl9F,SAASuiC,IAAQvlC,KAAKkzB,IAAIrM,EAAQ/iB,KAAKyhC,GAAM46D,EAAS,EAAIA,EAAS,OAK7E19F,EAAgBw9F,EAAWC,GAG7B,IAAME,GAAb,WAIE,WAAYC,EAA8Cx5E,EACxDpL,EAAqC6nD,GAAmB,yBAJzC1sC,UAAiC,GAKhDviB,KAAKuiB,UAAUxZ,KAAKzF,cAAQ,WACxB,IAAM+D,EAAQ2kF,EAASviG,MACjB4E,EAAOiS,KAAE2rF,MAAM5kF,EAAMvY,MACS,SAAhCuY,EAAMtB,wBAAoC1X,EAAKE,YAAc,GACjE,IAAM29F,EAAeP,GAA0Bt9F,EAAM+Y,EAAQoL,GAC7D,GAAIpL,EAAO,CACT,IAAI+kF,GAAqB,EACrBC,GAAoB,EAWxB,GATInlF,GAAaykB,WAAWjI,IAAIrc,EAAOR,IACrCulF,GAAqB,EACb/kF,EAAO+xB,aACZ/xB,EAAO+xB,aAAe9xB,EAAM2xB,KAC7BmzD,GAAqB,EAErBC,GAAoB,IAGlBA,IAAmBD,GAAuB9kF,EAAM2xB,KAAK,CAAC,IAAD,EACnD9oC,EAAOV,EAAQ6X,EAAM2xB,KAAKlqC,KAAMuY,EAAM2xB,KAAKvpC,MAEjD28F,IADAD,EAAqBn8F,EAAeoX,EAAOtY,KAAKH,SAAU,GAAsBuB,MAClB,UAAlBmX,EAAM2xB,KAAKA,MAA4C,WAA1B,UAAA5xB,EAAO+xB,kBAAP,eAAmBH,OAE9F,IAAK5xB,EAAOjF,QAAQzC,SAAW0sF,EAE7Bn9B,EAAMo9B,WAAWx9F,EAAyB,CAACN,YAAY,EAAGI,SAAS,CAACuR,GAAUA,OAC9EwrF,GAAS,QAAD,OAAStkF,EAAOR,GAAhB,gBAA0BQ,EAAOjF,QAAQzC,QAAzC,kBAA0D0sF,EAA1D,iBAAoFD,QACzF,CACH,GAAIA,EAAmB,CACrBT,GAAS,gBAAD,OAAiBtkF,EAAOR,KAChC,IAAM2kB,EAAW39B,EAAMs+F,EAAav9F,UAChC48B,EAAW,QAAQ2gE,EAAav9F,SAAWhB,EAAM,EAAE49B,EAAU2gE,EAAav9F,WAGhFsgE,EAAMo9B,WAAWx9F,EAAyBq9F,UAExC,GAAI15E,EAAQ,CAEhB,IAAM85E,IAAsBjlF,EAAM2xB,OAC/BxmB,EAAQ9F,aAAahJ,SAAS2D,EAAM2xB,OAASxmB,EAAQ7F,iBAAiBjJ,SAAS2D,EAAM2xB,OAClFozD,GAAqBE,GAAuB95E,EAAQ7F,iBAAiBzD,MAAK,SAAA2xD,GAAC,MAAe,UAAXA,EAAE7hC,QACvF,GAAIszD,EAAoB,CAEtBZ,GAAS,gBAAD,OAAiBl5E,EAAQ5L,KACjC,IAAM2kB,EAAW39B,EAAMs+F,EAAav9F,UAChC48B,EAAW,QACb2gE,EAAav9F,SAAWhB,EAAM,EAAE49B,EAAU2gE,EAAav9F,gBAEjDy9F,IAERn9B,EAAMo9B,WAAWx9F,EAAyB,CAACN,YAAY,EAAGI,SAAS,CAACuR,GAAUA,OAC9EwrF,GAAS,QAAD,OAASl5E,EAAQ5L,GAAjB,kBAA6BwlF,EAA7B,iBAAuDE,KAEjE,IAAMx9F,EAAOD,EAAyBq9F,GACtCj9B,EAAMo9B,WAAWv9F,QAEjB2f,QAAQI,MAAR,gDAKN7O,KAAKuiB,UAAUxZ,KAAKzF,cAClB,WACE,IAAMnC,EAAQiG,EAASA,EAAOc,OAAOpH,MAAQoiB,GAASqpE,gBAAgB/5E,EAAS5L,GAAI,SAC7E7F,EAAK,IAAIC,YACXG,IACFJ,EAAGE,SAASE,GACZ8tD,EAAMu9B,aAAazrF,QAKzBf,KAAKuiB,UAAUxZ,KAAKzF,cAClB,kBAAM2rD,EAAMw9B,mBAAmBhB,QAGjCzrF,KAAKuiB,UAAUxZ,KAAKzF,cAClB,kBAAM2rD,EAAMy9B,kBAAsB,OAANtlF,QAAM,IAANA,MAAQjF,QAAQxC,cAnFlD,2CAuFE,WAAW,IAAD,gBACeK,KAAKuiB,WADpB,IACR,2BAAuC,EACrCgR,EADqC,YAD/B,mCAvFZ,KA8Fao5D,GAAb,WAGE,WAAYX,EAA8C/8B,EAA6BlnD,EAAmCwZ,GAAe,yBAFxHgB,UAAiC,GAGhDviB,KAAKuiB,UAAUxZ,KAAKzF,cAClB,WACE,IAGIkP,EAHEnL,EAAQ2kF,EAASviG,MACjB4E,EAAOiS,KAAE2rF,MAAM5kF,EAAMvY,MACS,SAAhCuY,EAAMtB,wBAAoC1X,EAAKE,YAAc,IAE5DwZ,GAAewZ,IAClB/O,EAAU0Q,GAAS2E,aAAatG,IAGlC,IACMzyB,EAAOD,EADQ88F,GAA0Bt9F,EAAM0Z,EAAayK,IAElEy8C,EAAMo9B,WAAWv9F,OAKrBkR,KAAKuiB,UAAUxZ,KAAKzF,cAClB,WAAO,IAAD,EAEAkP,GACCzK,GAAewZ,IAClB/O,EAAU0Q,GAAS2E,aAAatG,IAElC0tC,EAAM29B,SAAS7kF,EAAcA,EAAYqf,UAAf,UAA2B5U,SAA3B,aAA2B,EAAS4U,eAKlEpnB,KAAKuiB,UAAUxZ,KAAKzF,cAClB,kBAAM2rD,EAAMw9B,mBAAmBhB,QAlCrC,2CAsCE,WAAW,IAAD,gBACezrF,KAAKuiB,WADpB,IACR,2BAAuC,EACrCgR,EADqC,YAD/B,mCAtCZ,KCtHas5D,GAAb,WAYE,aAAc,yBAXGC,aAA6B,IAAI/iG,OAAOukC,aAW3C,KAVGy+D,iBAAmB/sF,KAAK8sF,aAAahvD,+BAUxC,KARG6uB,aAAe,IAAIgC,MAQtB,KAPNnC,SAAqB,QAOf,KAJdwgC,MAEI,GAsDAhtF,KAAK2sD,aAAald,UAAYzvC,KAAK+sF,iBAAiBlnF,OAhE1D,8CAoEE,SAAWe,GAKT,OAJA1c,OAA0BuW,IAAnBT,KAAKgtF,MAAMpmF,IAClB5G,KAAKgtF,MAAMpmF,GAAM,IAAI2lD,GAAUvsD,KAAK8sF,aAAc9sF,KAAK+sF,iBACxB/sF,KAAKwsD,UAAWxsD,KAAKitF,kBAE7CjtF,KAAKgtF,MAAMpmF,KAzEtB,yBA2EE,SAAYA,GACV1c,OAA0BuW,IAAnBT,KAAKgtF,MAAMpmF,IAClB,IAAMsmF,EAAO,IAAIt+B,GAAqB5uD,KAAK8sF,aAAc9sF,KAAK+sF,iBAC/B/sF,KAAKwsD,UAAWxsD,KAAKitF,kBAGpD,OAFAjtF,KAAKgtF,MAAMpmF,GAAMsmF,EAEVA,IAjFX,2BAmFE,SAActmF,GAEZ5G,KAAKgtF,MAAMpmF,GAAIynB,oBACRruB,KAAKgtF,MAAMpmF,KAtFtB,4BAyFE,SAAe4lD,EAAoBlrD,GAAiB,IAAD,OAkBjD,GAjBApX,EAAoB,UAAbsiE,GACe,UAAlBxsD,KAAKwsD,UAEPlpD,cAAQ,WACN,IAAM6pF,EAAU,IAAIhlF,IAAI0a,GAAWiS,mBAAmBzB,gBAAgBtB,OAAOrkC,KAC3E,SAAAmX,GAAI,MAA2B,WAAvBA,EAAKoa,SAASpO,KAAoBhM,EAAKoa,SAASnX,KAAKA,KAAOjD,EAAKoa,SAASpO,SAEpF,IAAK,IAAMjK,KAAM,EAAKomF,MAChBG,EAAQ1pE,IAAI7c,IAAO,EAAKomF,MAAMpmF,aAAegoD,GAC/C,EAAKo+B,MAAMpmF,GAAI4mD,YAAY,EAAKhB,UAEhC,EAAKwgC,MAAMpmF,GAAI4mD,YAAY,YAM/BhB,IAAaxsD,KAAKwsD,UAAYlrD,IAAUtB,KAAKitF,iBAAjD,CAKA,OAFAjtF,KAAKwsD,SAAWA,EAERA,GACN,IAAK,UAGH,IAAMrwC,EAAWK,aACf,WACMmO,GAAUjiB,OAEkB,cAA5B,EAAKokF,aAAahrE,OAEpB1F,cAAcD,GAEhB,EAAK2wE,aAAan+D,SAClB,EAAKg+B,aAAaU,UAEpB,KAGF,IAAK,IAAMzmD,KAAM5G,KAAKgtF,MACpBhtF,KAAKgtF,MAAMpmF,GAAI4mD,YAAYhB,GAE7B,MAEF,IAAK,UAIH,IAAK,IAAM5lD,KAHX5G,KAAK8sF,aAAaM,UAClBptF,KAAK2sD,aAAaQ,QAEDntD,KAAKgtF,MACpBhtF,KAAKgtF,MAAMpmF,GAAI4mD,YAAYhB,GAE7B,MAEF,QACE/9C,QAAQI,MAAR,iCAAwC29C,IAI5CxsD,KAAKitF,iBAAmB3rF,KArJ5B,4BAwJE,SAAe0uC,GAEb,IAAK,IAAMk9C,KADX/gC,GAAqBnsD,KAAK2sD,aAAc3c,GACrBhwC,KAAKgtF,MACtBhtF,KAAKgtF,MAAME,GAAMG,eAAer9C,KA3JtC,4BAsKE,WACE,QAAShwC,KAAK+sF,iBAAiBlnF,OAAO0zB,YAAY/nC,OAAS,GACtDwO,KAAK+sF,iBAAiBlnF,OAAO0zB,YAAY,GAAG+zD,UAxKrD,IAgKE,SAAqBhsF,GACnB,IAAK,IAAMsF,KAAM5G,KAAKgtF,MACpBhtF,KAAKgtF,MAAMpmF,GAAIsmD,kBAAkB5rD,GAEnCtB,KAAK+sF,iBAAiBlnF,OAAO0zB,YAAYzrC,SAAQ,SAACqT,GAAYA,EAAMmsF,SAAWhsF,SApKnF,KCJaisF,GAAU,ICOvB,WAeE,aAAe,IAAD,gCAdGA,QAAU,IAAIV,GAcjB,KAZGW,gBAEb,GAUU,KARNC,YAAc,IAAI5iG,IAQZ,KAPN6iG,cAAgB,IAAI7iG,IAOd,KANN8iG,aAAe,IAAI9iG,IAMb,KALN+iG,qBAAuB,IAAI/iG,IAKrB,KAeNgjG,gBAAkB,WACxB,IAAMC,EAAa,IAAIjjG,IAAIoc,GAAaG,QAClC+tB,EAAQ1qC,EAAQqjG,EAAY,EAAKL,aACvBhjG,EAAQ,EAAKgjG,YAAaK,GAClChgG,QAAQ,EAAKigG,cACrB54D,EAAMrnC,QAAQ,EAAKkgG,WACnB,EAAKP,YAAcK,GArBP,KAwBNG,kBAAoB,WAC1B,IAAMC,EAAe,IAAIrjG,IAAIoc,GAAaY,UACpCstB,EAAQ1qC,EAAQyjG,EAAc,EAAKR,eACzBjjG,EAAQ,EAAKijG,cAAeQ,GACpCpgG,QAAQ,EAAKm5B,gBACrBkO,EAAMrnC,QAAQ,EAAKqgG,aACnB,EAAKT,cAAgBQ,GA9BT,KAiCNE,yBAA2B,WACjC,IAAMC,EAAsB,IAAIxjG,IAAIq4B,GAAS4W,kBACvC3E,EAAQ1qC,EAAQ4jG,EAAqB,EAAKT,sBAChCnjG,EAAQ,EAAKmjG,qBAAsBS,GAC3CvgG,QAAQ,EAAKm5B,gBACrBkO,EAAMrnC,QAAQ,EAAKwgG,oBACnB,EAAKV,qBAAuBS,GAvChB,KA2CNE,uBAAyB,WAC/B,IAAMC,EAAsBtrE,GAASurE,yBAAyB1xE,QAAO,SAAAwE,GAAG,OAAI2B,GAASqpE,gBAAgBhrE,EAAK,YACpGusE,EAAa,IAAIjjG,IAAI2jG,EAAoB9gG,KAAI,SAAA6zB,GAAG,MAAI,CAACA,EAAK2B,GAASha,KAAKqY,QACxE4T,EAAQ1qC,EAAQqjG,EAAY,EAAKH,cACvBljG,EAAQ,EAAKkjG,aAAcG,GACnChgG,QAAQ,EAAK4gG,eACrBv5D,EAAMrnC,QAAQ,EAAK6gG,YACnB,EAAKhB,aAAeG,GAlDR,KAqDN7mE,eAAiB,SAAC2nE,GACxB,IAAMhoF,EAAKgoF,EAAGhoF,GACd,EAAK4mF,gBAAgB5mF,GAAIioF,iBAClB,EAAKrB,gBAAgB5mF,GAE5B,EAAK2mF,QAAQuB,cAAcloF,IA1Df,KA4DNunF,YAAc,SAACS,GACrB,IAAMhoF,EAAKgoF,EAAGhoF,GACRqoD,EAAQ,EAAKs+B,QAAQY,YAAYvnF,GACvC,EAAK4mF,gBAAgB5mF,GAAM,IAAI+lF,GAA0B1lF,GAAaC,OAAQ+nD,EAAO2/B,IA/DzE,KAiENN,mBAAqB,SAACS,GAE5B,IAAMnoF,EAAKmoF,EAAGnoF,GACRqoD,EAAQ,EAAKs+B,QAAQY,YAAYvnF,GACvC,EAAK4mF,gBAAgB5mF,GAAM,IAAI+lF,GAA0B1lF,GAAaC,OAAQ+nD,OAAOxuD,EAAWsuF,EAAGnoF,KArEvF,KAwENmnF,aAAe,SAACz5D,GACtB,IAAM1tB,EAAK0tB,EAAG1tB,GACd,EAAK4mF,gBAAgB5mF,GAAIioF,iBAClB,EAAKrB,gBAAgB5mF,GAE5B,EAAK2mF,QAAQuB,cAAcloF,IA7Ef,KA+ENonF,UAAY,SAAC5mF,GACnB,IAAM6nD,EAAQ,EAAKs+B,QAAQyB,WAAW5nF,EAAOR,IAC7C,EAAK4mF,gBAAgBpmF,EAAOR,IAAM,IAAImlF,GAAe9kF,GAAaC,YAAQzG,EAAW2G,EAAQ6nD,IAjFjF,KAoFNy/B,cAAgB,SAACl8E,GACvB,EAAKg7E,gBAAgBh7E,EAAQ5L,IAAIioF,iBAC1B,EAAKrB,gBAAgBh7E,EAAQ5L,IACpC,EAAK2mF,QAAQuB,cAAct8E,EAAQ5L,KAvFvB,KAyFN+nF,WAAa,SAACn8E,GACpB,IAAMy8C,EAAQ,EAAKs+B,QAAQyB,WAAWx8E,EAAQ5L,IAC9C,EAAK4mF,gBAAgBh7E,EAAQ5L,IAAM,IAAImlF,GAAe9kF,GAAaC,OAAQsL,OAAS/R,EAAWwuD,IA1FjE,OAA1BlmE,EAAcoiC,UAElB7nB,aAAQtD,KAAK6tF,iBACbvqF,aAAQtD,KAAKiuF,mBACb3qF,aAAQtD,KAAKouF,0BACb9qF,aAAQtD,KAAKuuF,wBACbjrF,cACE,WACE,IAAMsB,EAAcqC,GAAaI,MAAMzC,aAAeqC,GAAaI,MAAMlF,QAAQvC,iBACjF,EAAK2tF,QAAQ0B,eAAehoF,GAAaI,MAAM5E,eAAiB,UAAY,UAAWmC,OAzB/F,kDAYE,SAAsBorC,GACpBhwC,KAAKutF,QAAQF,eAAer9C,OAbhC,M,wCCCIk/C,GAAW,IAAIC,YAAS,CAACC,WAAY,SAACrgF,GACxC,MAAM,oDAAN,OAA2DA,MAE7DmgF,GAASG,WAAW,CAClBC,gBAAiB,EACjBC,iBAAiB,EACjBC,uBAAwB,GACxBC,sBAAuB,GACvBC,qBAAoB,IAGtB,IAWIxjD,GAXAyjD,GAAW,IAAIC,YAAS,CAACR,WAAY,SAACrgF,GACxC,MAAM,qDAAN,OAA4DA,MAE9D4gF,GAASN,WAAW,CAGlBQ,YAAa,EACbC,iBAAiB,IAKnB,IAAIC,IAAe,EACZ,SAASC,KACV9jD,KACFA,GAAQuD,UAAY,KACpBvD,GAAQ0B,SACR1B,QAAUzrC,GAEZsvF,IAAe,ECXjB,SAASE,KACP,OAAOhpF,GAAaI,MAAMrF,WAAaiF,GAAaI,MAAMlF,QAAQvC,mBAC/DqH,GAAaW,SAAqC,OAA1B7e,EAAcoiC,QAE3C7nB,cAAQ,WACN,IAAMssC,EAAM3oC,GAAaI,MAAM/E,iBAAiBk8C,iBAEhD,GAAIyxC,KACFptE,GAAWwc,sBAAiB5+B,GAAW6D,MAAK,WAC1C2C,GAAaI,MAAMtF,WAAa,SAE/B,CACH,IAAMZ,EAAQ0hB,GAAW6a,mBACzB,GAAIv8B,GAASA,EAAM6uC,WAAaJ,EAAO,OA7BzB,IAAI1+C,SAAiB,SAAC+S,EAAgBC,GACpD,IAAM0rC,EAAM3oC,GAAaI,MAAM/E,iBAAiBk8C,iBAChDl0D,UAAU0yC,aAAa8S,aAAa,CAClChvC,MAAM,CAACkvC,SAAUJ,KAChBtrC,MAAK,SAACvD,GACP,IAAMI,EAAQJ,EAAG24B,iBAAiB,GAC9Bv4B,GACF8C,EAAe,CAAC9C,QAAO2G,KAAKb,GAAaI,MAAMT,GAAIiK,KAAK,cAEzDtM,MAAML,MAqBQI,MAAK,SAACnD,GACH,IAAD,EAAb8uF,KACF,UAAA9uF,EAAMA,aAAN,SAAa4gB,OAEbc,GAAWwc,iBAAiBl+B,MAE7B+S,QAAQmU,QAMf/kB,cAAQ,WACN,IAAMssC,EAAM3oC,GAAaI,MAAM/E,iBAAiBm8C,kBAC5C7O,GACFsgD,GAAa7C,eAAez9C,MAMhC,SAASugD,KACP,OAAOlpF,GAAaI,MAAMpF,WAAagF,GAAaI,MAAMlF,QAAQvC,mBAC/DqH,GAAaW,SAAqC,OAA1B7e,EAAcoiC,QCtC3C,SAASilE,MAIT,SAASC,KACPC,KAASrpC,OACL,eAAC,GAAD,IACFxwC,SAAS85E,eAAe,SDiC5BjtF,cAAQ,WACN,IAAMssC,EAAM3oC,GAAaI,MAAM/E,iBAAiButC,iBAC1C1wC,EAAY8H,GAAaI,MAAMvF,YAAY3C,UACjD,GAAIgxF,KACFH,KACAxgD,KAEE3sB,GAAWuc,yBAAoB3+B,GAAW6D,MAAK,SAAAnD,GAAK,cAAIA,QAAJ,IAAIA,OAAJ,EAAIA,EAAOA,MAAM4gB,eAOvE,GADqE,SAAvD9a,GAAaI,MAAMvF,YAAY9C,UAAU7M,OAAO,GAE5Dq9C,KDzCC,SAAsBghD,EAAmB5gD,GAC9CogD,KACgB,IAAI9+F,SAAc,SAAC+S,EAAgBC,GAC5C0rC,IAAKA,EAAM3oC,GAAaI,MAAM/E,iBAAiButC,kBAEpD,IAAM4gD,EAAQ,6BAAOjqF,OAAOypC,IAAIygD,iBAAiB3gD,OAAnC,IACZ1kD,MAAM,CACJ4sD,MAAM,KAER3sD,OAAO,CACL2sD,MAAM,KAERD,UAAW,CACTC,MAAO,MAGX3tD,UAAU0yC,aAAa8S,aACrB,CAACC,MAAM,cACLC,SAASJ,GACN6gD,KAELnsF,MAAK,SAACvD,IAENmrC,GAAUniD,OAAO0sB,SAASC,cAAc,UAChC+4B,UAAY1uC,EACpBmrC,GAAQkE,UAAW,EACfogD,EACFb,GAASgB,WAAU,SAAAC,GACjB,IAAMC,EAASD,EAAQE,mBAAmB,GACpCrpE,EAAmB,CACvB6lB,KAAKujD,GAAUpxB,KAAesxB,MAAMF,EAAO,CACzCG,QAAQ,YACRjhD,MAAM7D,MAGVjlC,GAAaI,MAAMogB,QAAUA,KAG/BynE,GAASyB,WAAU,SAAAC,GAIjB,IAAMC,EAASD,EAAQK,cACjBC,EAASN,EAAQO,cACjBC,EAAYR,EAAgBS,GAC5BC,EAAcV,EAAQW,mBACtBC,EAAaZ,EAAQa,kBACrBhqE,EAAmB,CACvB6lB,KAAKujD,GAAUpxB,KAAesxB,MAAMF,EAAO,CACzCG,QAAQ,YACRjhD,MAAM7D,KAERp9C,KAAMsiG,GAAUF,GAAWzxB,KAAesxB,MAAMK,EAASF,EAAO,CAC9DF,QAAQ,YACRjhD,MAAM7D,GACNwlD,UAAW,CAAEpmG,OAAQ,EAAGD,MAAO,GAC/BsmG,YAAY,IAEdx0B,SAAUq0B,GAAc/xB,KAAesxB,MAAMS,EAAW,QACxDnzB,UAAWizB,GAAe7xB,KAAesxB,MAAMO,EAAY,UAE7DrqF,GAAaI,MAAMogB,QAAUA,KAcjCsoE,IAAe,EAXf,SAAS7mC,EAAM0oC,GACK,IAAD,EAAb7B,KACF,UAAI7jD,UAAJ,OAAI,EAASyE,WACXihD,EAAS59E,KAAK,CAACoU,MAAO8jB,KAAU5nC,MAAK,WACnCva,OAAOqwB,YAAW,WAAK8uC,EAAM0oC,KAAY7iE,OAG3ChlC,OAAOqwB,YAAW,WAAK8uC,EAAM0oC,KAAY7iE,KAK/Cm6B,CAAMsnC,EAAWb,GAAWT,IAC5BjrF,OACCM,MAAML,MCpCP2tF,EAAc1yF,OACX,CACH6wF,KACA,IAAM7uF,EAAQ0hB,GAAWivE,sBACzB,GAAI3wF,GAASA,EAAM6uC,WAAaJ,EAAO,OACvCD,GAAkBxwC,GAAWmF,MAAK,SAACnD,GAC5BgvF,KAGE,OAALhvF,QAAK,IAALA,KAAOA,MAAM4gB,OAFbc,GAAWuc,oBAAoBj+B,MAIhC+S,QAAQmU,QChFjB0pE,aAAU,CACNC,eAAgB,UlJiBXn/F,IAAKo/F,IAAIC,KAAkBD,IAAIE,KAAsBz8E,KAAKnX,IkJbxD+F,MAEX,WACE,IAAM8tF,EAAephG,EAAao/F,GAAbp/F,GACrBohG,EAAa9tF,KAAKtT,EAAaq/F,KAC/B+B,EAAa9tF,KAAKtT,EAAaqhG,QAcjC,IAAIC,GAAS,GACb,SAASD,KACPtoG,OAAOywB,iBAAiB,gBAAgB,SAACR,GAKvC,GAJAs4E,GAAM,UAAMA,GAAN,gCAAoCjpF,OAApC,KACNpE,aAAaC,QAAQ,MAAOotF,KAGvB3nE,GAAUjiB,OACZwa,GAASw1B,wBAAwBlnD,QAAU0xB,GAASmW,kBAAoBpyB,GAAaW,SAOtF,OANA0qF,IAAU,aACVt4E,EAAG0lB,iBACH1lB,EAAGu4E,2BACHv4E,EAAGw4E,YAAc,GACjBvtF,aAAaC,QAAQ,MAAOotF,IAErBt4E,EAAGw4E,YAEZ3vE,GAAWwH,WAGbM,GAAU8nE,kBACVr1D,cAAK,iBAAyB,KAAnBzS,GAAUjiB,QAAa,WAChC,IAAMhf,EAAOX,EAAcW,MAAQ,IACnCm5B,GAAW6vE,MAAMhpG,S","file":"static/js/main.7145fbd9.chunk.js","sourcesContent":["import {decodeGetParams} from './parameters'\r\n\r\nexport const urlParameters = decodeGetParams(window.location.href)\r\n","interface Params {\r\n  [key: string]: string | null\r\n  room: string | null               // conference room name\r\n  name: string | null               // user name\r\n  headphone: headphoneType | null   // stereo headphone output\r\n  speaker: headphoneType | null     // monaural speaker output\r\n  cameraOn: muteType | null       // Mute the camera at start\r\n  muteMic: muteType | null          // Mute the mic at start\r\n  testBot: string | null            // Tester bot mode\r\n  skipEntrance: string | null       // skip entrance\r\n}\r\n\r\nexport function decodeGetParams(url: string): Params {\r\n  const urlObj = new URL(decodeURI(url))\r\n  const props = ['room', 'name', 'headphone', 'speaker', 'cameraOn', 'muteMic', 'testBot', 'skipEntrance']\r\n\r\n  const res: Params = props.reduce(\r\n    (pre, prop) => {\r\n      pre[prop] = urlObj.searchParams.get(prop)\r\n\r\n      return pre\r\n    },\r\n    {} as Params,\r\n  )\r\n  //res.room = urlObj.pathname.substr(1).toLowerCase().replace(/[./@]/, '_') + (res.room ? res.room.toLowerCase() : '')\r\n  res.room = urlObj.pathname.substr(1).replace(/[./@]/, '_') + (res.room ? res.room : '')\r\n\r\n  return res\r\n}\r\n\r\ntype headphoneType = ''\r\ntype muteType = 'yes' | 'true' | 'no' | 'false'\r\n\r\n","export function assert(input: any): asserts input {\r\n  if (!input) {\r\n    throw new Error('Not a truthy value')\r\n  }\r\n}\r\n\r\nexport function strcmp(a:string, b:string) {\r\n  if (a < b) { return -1 }\r\n  if (a > b) { return 1 }\r\n\r\n  return 0\r\n}\r\n\r\nexport const isChromium = /Chrome/.test(navigator.userAgent)\r\nexport const isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor)\r\n\r\nexport function shallowEqualsForMap<T1, T2>(map1:Map<T1, T2>, map2:Map<T1, T2>) {\r\n  let testVal\r\n  if (map1.size !== map2.size) {\r\n    return false\r\n  }\r\n  for (const [key, val] of map1) {\r\n    testVal = map2.get(key)\r\n    if (testVal !== val || (testVal === undefined && !map2.has(key))) {\r\n      return false\r\n    }\r\n  }\r\n\r\n  return true\r\n}\r\n\r\n/// a - b for two maps\r\nexport function diffMap<K, V1, V2>(a:Map<K, V1>, b:Map<K, V2>) {\r\n  const diff = new Map<K, V1>(a)\r\n  for (const elem of b) {\r\n    diff.delete(elem[0])\r\n  }\r\n\r\n  return diff\r\n}\r\n\r\n/// a - b for two sets\r\nexport function diffSet<K>(a:Set<K>, b:Set<K>) {\r\n  const diff = new Set<K>(a)\r\n  for (const elem of b) {\r\n    diff.delete(elem)\r\n  }\r\n\r\n  return diff\r\n}\r\n\r\nexport function intersectionMap<K, V1, V2>(a:Map<K, V1>, b:Map<K, V2>) {\r\n  const com = new Map<K, V1>()\r\n  a.forEach((v, k) => {\r\n    if (b.has(k)) {\r\n      com.set(k, v)\r\n    }\r\n  })\r\n\r\n  return com\r\n}\r\n\r\nexport function extract<T>(properties: Record<keyof T, true>) {\r\n  return function<TActual extends T>(value: TActual) {\r\n    const result = {} as T\r\n    for (const property of Object.keys(properties) as (keyof T)[]) {\r\n      result[property] = value[property]\r\n    }\r\n\r\n    return result\r\n  }\r\n}\r\n\r\nexport function isSmartphone() {\r\n  if (navigator.userAgent.match(/iPhone|Android.+Mobile/)) {\r\n    return true\r\n  }\r\n\r\n  return false\r\n}\r\n\r\nexport function isPortrait() {\r\n  if (window.parent.screen.width < window.parent.screen.height) {\r\n    return true\r\n  }\r\n\r\n  return false\r\n}\r\n\r\nexport function isSelfUrl(url: URL){\r\n  return (url.host === window.location.host && url.pathname === window.location.pathname)\r\n}\r\n\r\nexport function checkImageUrl(url: string){\r\n  const img = new Image()\r\n  img.src = url\r\n  const promise = new Promise<string>((resolutionFunc, rejectionFunc) => {\r\n    img.onload = () => { resolutionFunc(url) }\r\n    img.onerror = () => { rejectionFunc('') }\r\n  })\r\n\r\n  return promise\r\n}\r\n","export function multiply(matrix: (DOMMatrix | DOMMatrixReadOnly)[]) {\r\n  return matrix.reduce((p: DOMMatrix, c) => p.multiplySelf(c), new DOMMatrix())\r\n}\r\n\r\nexport function extractScaleX(matrix: DOMMatrix | DOMMatrixReadOnly) {\r\n  return Math.abs(Math.sign(matrix.a) * Math.sqrt(Math.pow(matrix.a, 2) + Math.pow(matrix.c, 2)))\r\n}\r\n\r\nexport function extractScaleY(matrix: DOMMatrix | DOMMatrixReadOnly) {\r\n  return Math.abs(Math.sign(matrix.d) * Math.sqrt(Math.pow(matrix.b, 2) + Math.pow(matrix.d, 2)))\r\n}\r\n\r\nexport function extractScale(matrix: DOMMatrix | DOMMatrixReadOnly): [number, number] {\r\n  return [\r\n    extractScaleX(matrix),\r\n    extractScaleY(matrix),\r\n  ]\r\n}\r\n\r\nexport function extractRotation(matrix: DOMMatrix | DOMMatrixReadOnly): number {\r\n  return Math.atan2(-matrix.c, matrix.a)\r\n}\r\n\r\nexport function transfromAt(center:[number, number], tranform: DOMMatrixReadOnly, baseMatrix:DOMMatrixReadOnly) {\r\n  const tm = (new DOMMatrix()).translate(-center[0], -center[1])\r\n  const itm = (new DOMMatrix()).translateSelf(...center)\r\n  const newMatrix = multiply([itm, tranform, tm, baseMatrix])\r\n\r\n  return newMatrix\r\n}\r\n\r\nexport function transformPoint2D(\r\n  matrix: DOMMatrixReadOnly | DOMMatrix, point: [number, number]): [number, number] {\r\n  return [\r\n    matrix.a * point[0] + matrix.c * point[1] + matrix.e,\r\n    matrix.b * point[0] + matrix.d * point[1] + matrix.f,\r\n  ]\r\n}\r\n\r\nexport function rotateVector2D(\r\n  matrix: DOMMatrixReadOnly | DOMMatrix, point: [number, number]): [number, number] {\r\n  return [\r\n    matrix.a * point[0] + matrix.c * point[1],\r\n    matrix.b * point[0] + matrix.d * point[1],\r\n  ]\r\n}\r\n","export interface Pose2DMap {\r\n  position: [number, number]\r\n  orientation: number\r\n}\r\nexport function clonePose2DMap(p:Pose2DMap):Pose2DMap{\r\n  return {position:[p.position[0], p.position[1]], orientation:p.orientation}\r\n}\r\nexport function cloneV2(v:number[]):[number, number]{\r\n  return [v[0], v[1]]\r\n}\r\n\r\nexport interface Pose3DAudio {  // right hand cartesian coordinate system\r\n  position: [number, number, number],\r\n  orientation: [number, number, number],\r\n}\r\n\r\nexport function addV2(a:number[], b:number[]): [number, number] {\r\n  return [a[0] + b[0], a[1] + b[1]]\r\n}\r\nexport function subV2(a:number[], b:number[]): [number, number] {\r\n  return [a[0] - b[0], a[1] - b[1]]\r\n}\r\nexport function mulV<S extends number, T extends number[]>(s: S, v: T): T {\r\n  return v.map(e => s*e) as T\r\n}\r\nexport function mulV2(a:number, v:number[]): [number, number] {\r\n  return [a * v[0], a * v[1]]\r\n}\r\nexport function mulV3(a:number, v:number[]): [number, number, number] {\r\n  return [a * v[0], a * v[1], a * v[2]]\r\n}\r\nexport function normV(v:number[]): number {\r\n  let sum = 0\r\n  v.forEach(e => sum += e * e)\r\n\r\n  return Math.sqrt(sum)\r\n}\r\n\r\nexport function degree2Radian(degree: number): number {\r\n  return degree * Math.PI / 180\r\n}\r\n\r\nexport function radian2Degree(radian: number): number {\r\n  return radian * 180 / Math.PI\r\n}\r\n\r\n// relative pose for coordinate: position orientation direction is from positive axis x to positive axis y\r\nexport function getRelativePose(\r\n  base: Pose2DMap,\r\n  relative: Pose2DMap,\r\n  ): Pose2DMap {\r\n  const radian = degree2Radian(base.orientation)\r\n  const s = Math.sin(radian)\r\n  const c = Math.cos(radian)\r\n\r\n  const translatedPosition = [relative.position[0] - base.position[0], relative.position[1] - base.position[1]]\r\n\r\n  const rotatedPosition: [number, number] = [\r\n    translatedPosition[1] * s + translatedPosition[0] * c,\r\n    translatedPosition[1] * c - translatedPosition[0] * s,\r\n  ]\r\n\r\n  const orientation = relative.orientation - base.orientation\r\n\r\n  return {\r\n    position: rotatedPosition,\r\n    orientation: orientation < 0 ? orientation + 360 : orientation,\r\n  }\r\n}\r\n\r\nexport function convertToAudioCoordinate(pose: Pose2DMap): Pose3DAudio {\r\n  const radian = degree2Radian(pose.orientation)\r\n\r\n  return {\r\n    position: [pose.position[0], 0, -pose.position[1]],\r\n    orientation: [Math.sin(radian), 0, Math.cos(radian)],\r\n  }\r\n}\r\n\r\nexport function rotateVector2DByDegree(\r\n  degree: number, vector: [number, number]): [number, number] {\r\n  const rad = degree * (Math.PI / 180)\r\n  const c = Math.cos(rad)\r\n  const s = Math.sin(rad)\r\n\r\n  return [\r\n    c * vector[0] - s * vector[1],\r\n    s * vector[0] + c * vector[1],\r\n  ]\r\n}\r\n\r\n\r\nexport function crossProduct(vec1: [number, number], vec2: [number, number]): number {\r\n  return vec1[0] * vec2[0] + vec1[1] * vec2[1]\r\n}\r\n\r\nexport function vectorLength(vec: [number, number]): number {\r\n  return Math.sqrt(vec.reduce((pre, val) => pre + val * val, 0))\r\n}\r\n\r\nexport function rotate90ClockWise(vec: [number, number]): [number, number] {\r\n  return [vec[1], -vec[0]]\r\n}\r\n\r\n\r\nexport function square(s: number) {\r\n  return s * s\r\n}\r\n\r\n//  rect or circle\r\nexport type Shape = [number, number, number, number] | [number, number, number]\r\n\r\n//  rect: [top, right, bottom, left]\r\nexport function getRect(pose: Pose2DMap, size: [number, number]):[number, number, number, number]{\r\n  if (pose.orientation === 0){\r\n    return [pose.position[1], pose.position[0] + size[0], pose.position[1] + size[1], pose.position[0]]\r\n  }\r\n  const lt = rotateVector2DByDegree(pose.orientation, pose.position)\r\n  const vr = rotateVector2DByDegree(pose.orientation, [size[0], 0])\r\n  const vb = rotateVector2DByDegree(pose.orientation, [0, size[1]])\r\n  const xs = [lt[0], lt[0]+vr[0], lt[0]+vb[0], lt[0]+vr[0]+vb[0]]\r\n  const ys = [lt[1], lt[1]+vr[1], lt[1]+vb[1], lt[1]+vr[1]+vb[1]]\r\n  xs.sort((a,b) => a-b)\r\n  ys.sort((a,b) => a-b)\r\n\r\n  return [ys[0], xs[3], ys[3], xs[0]]\r\n}\r\n\r\nexport function isOverlapped(a:number[], b:number[]){\r\n  if (a[0] > b[2] || a[2] < b[0]) { return false }\r\n  if (a[3] > b[1] || a[1] < b[3]) { return false }\r\n\r\n  return true\r\n}\r\nexport function isOverlappedToCircle(rect:number[], circle:number[]){\r\n  if (isInRect(circle as [number, number], rect)){ return true }\r\n  const d2 = Math.min(square(rect[3] - circle[0]), square(rect[1] - circle[0]))\r\n    + Math.min(square(rect[0] - circle[1]), square(rect[2] - circle[1]))\r\n\r\n  return d2 < square(circle[2])\r\n}\r\n\r\nexport function isInRect(point: [number, number], rect:number[]){\r\n  return rect[3] <= point[0] && point[0] <= rect[1]\r\n    && rect[0] <= point[1] && point[1] <= rect[2]\r\n}\r\nexport function isCircleInRect(point: [number, number], radius:number, rect:number[]){\r\n  return rect[3] <= point[0]-radius && point[0]+radius <= rect[1]\r\n    && rect[0] <= point[1]-radius && point[1]+radius <= rect[2]\r\n}\r\nexport function isInCircle(point: [number, number], circle:number[]){\r\n  const d2 = square(point[0] - circle[0]) + square(point[1] - circle[1])\r\n\r\n  return d2 <= square(circle[2])\r\n}\r\n\r\nexport interface Mouse{\r\n  position:[number, number]\r\n  show: boolean\r\n}\r\n\r\nfunction round(n:number){\r\n  return Math.round(n*100) / 100\r\n}\r\nexport function pose2Str(pose:Pose2DMap){\r\n  return `${round(pose.position[0])},${round(pose.position[1])},${round(pose.orientation)}`\r\n}\r\nexport function mouse2Str(mouse: Mouse){\r\n  return `${mouse.position[0]},${mouse.position[1]},${mouse.show?'t':''}`\r\n}\r\nexport function str2Pose(str:string){\r\n  const poseArray = str.split(',')\r\n  const pose:Pose2DMap = {position:[Number(poseArray[0]), Number(poseArray[1])] as [number, number],\r\n    orientation:Number(poseArray[2])}\r\n\r\n  return pose\r\n}\r\nexport function str2Mouse(str:string){\r\n  const mouseArray = str.split(',')\r\n  const mouse:Mouse = {position:[Number(mouseArray[0]),Number(mouseArray[1])], show: mouseArray[2] ? true : false}\r\n\r\n  return mouse\r\n}\r\n","export function resolveAtEnd(func: () => void): () => Promise<void> {\r\n  return () => new Promise((resolve: () => void, reject: (reason: any) => void) => {\r\n    try {\r\n      func()\r\n      resolve()\r\n    } catch (err) {\r\n      reject(err)\r\n      throw err\r\n    }\r\n  })\r\n}\r\n","export function getRandomColorRGB(v:string):[number, number, number] {\r\n  let sum = 0\r\n  for (let i = 0; i !== v.length; i += 1) {\r\n    sum = v.charCodeAt(i) + sum * 13\r\n  }\r\n  const num = sum % 0x1000\r\n  const r = Math.floor(num / 0x100) % 0x10\r\n  const g = Math.floor(num / 0x10) % 0x10\r\n  const b = Math.floor(num) % 0x10\r\n\r\n  return [r * 17, g * 17, b * 17]\r\n}\r\n\r\nexport function findTextColorRGB(rgb: number[]):number[] {\r\n  const textColor = isDarkColor(rgb) ? [255, 255, 8*17] : [0,0,8*17]\r\n\r\n  return textColor\r\n}\r\nexport function isDarkColor(rgb: number[]){\r\n  return rgb[0] + rgb[1] + rgb[2] * 0.2 < 20 * 17\r\n}\r\n\r\nexport function findReverseColorRGB(rgb: number[]):number[] {\r\n  return [255-rgb[0], 255-rgb[1], 255-rgb[2]]\r\n}\r\n\r\nexport function rgb2Color(rgb: number[]):string{\r\n  const [r, g, b] = [Math.floor(rgb[0]), Math.floor(rgb[1]), Math.floor(rgb[2])]\r\n  const color = `#${`0${r.toString(16)}`.slice(-2)}${`0${g.toString(16)}`.slice(-2)}${`0${b.toString(16)}`.slice(-2)}`\r\n\r\n  return color\r\n}\r\n\r\nexport function rgb2Colors(rgb: number[]):[string, string, string]{\r\n  const [r, g, b] = [rgb[0] / 17, rgb[1] / 17, rgb[2] / 17]\r\n  const textColor = isDarkColor(rgb) ? '#FF8' : '#008'\r\n  const color = `#${r.toString(16)}${g.toString(16)}${b.toString(16)}`\r\n  const reverseColor = `#${(15 - r).toString(16)}${(15 - g).toString(16)}${(15 - b).toString(16)}`\r\n\r\n  return [color, textColor, reverseColor]\r\n}\r\n\r\nexport function getRandomColor(v:string):[string, string, string] {\r\n  const rgb = getRandomColorRGB(v)\r\n  return rgb2Colors(rgb)\r\n}\r\n\r\nexport function rgba(rgb:number[], alpha: number) {\r\n  return `rgba(${rgb[0]},${rgb[1]},${rgb[2]},${alpha})`\r\n}\r\n","import i18n, {TOptions} from 'i18next'\r\nimport i18nLanguageDetector from 'i18next-browser-languagedetector'\r\nimport {initReactI18next, useTranslation as useTrans} from 'react-i18next'\r\nimport {EnKeyList, enTranslate} from './en'\r\nimport {JaKeyList, jaTranslate} from './ja'\r\n\r\nexport type KeyList = EnKeyList & JaKeyList\r\nexport function t(key: KeyList, options?:string | TOptions) {\r\n  return i18n.t(key, options)\r\n}\r\nexport interface UseTranslationResponse{\r\n  t:(key: KeyList) => string\r\n  i18n: typeof i18n\r\n  ready: boolean\r\n}\r\nexport function useTranslation():UseTranslationResponse {\r\n  const res = useTrans()\r\n\r\n  return res as UseTranslationResponse\r\n}\r\n\r\nconst resources = {\r\n  en: {translation: enTranslate},\r\n  ja: {translation: jaTranslate},\r\n}\r\nexport const i18nSupportedLngs = Object.keys(resources)\r\nexport const i18nOptions = {\r\n  resources,\r\n  supportedLngs:i18nSupportedLngs,\r\n  fallbackLng: i18nSupportedLngs[0],\r\n  interpolation: {escapeValue: false},\r\n}\r\nexport function i18nInit() {\r\n  return i18n.use(initReactI18next).use(i18nLanguageDetector).init(i18nOptions)\r\n}\r\n","export const enTranslate = {\r\n  enAbout: 'A video chat with a 2D map, where you will hear others\\' voices based on the location.'\r\n    + ' It holds multiple conversations in a venue parallelly, and you may walk around between them.'\r\n    + ' Sharing screens, cameras, texts, images, YouTube, and documents on google drive are supported.'\r\n    + ' You may drop or paste on the map.',\r\n  enTopPageUrl: 'https://scrapbox.io/binaural-meet/Top_page',\r\n  enMoreInfo: '... more info',\r\n  YourName: 'MY NAME',\r\n  Venue: 'MEETING SPACE',\r\n  EnterTheVenue: 'Enter the venue',\r\n  Contents: 'Contents',\r\n  'Create and Share': 'Create and Share',\r\n  'Share Text':'Share Text',\r\n  'Share iframe':'Share web page (Can\\'t display many sites)',\r\n  'Share image':'Share image',\r\n  'Share zone image':'Share zone image',\r\n  'Select video camera to share':'Select video camera to share',\r\n  'Meeting Space':'Meeting Space',\r\n  shareImport: '_Load...',\r\n  shareImportTip: 'Load the shared content from the downloaded .json file.',\r\n  shareDownload: '_Save Meeting Space',\r\n  shareDownloadTip: 'Download all shared contents except screen sharing and cameras to a file.',\r\n  shareIframe: 'I_frame',\r\n  shareIframeTip: 'Web pages that can be displayed are limited to those that can be displayed in an iframe.',\r\n  shareText: '_Text (can paste directly)',\r\n  sharePaste: 'Paste from clipboard (_v)',\r\n  sharePasteTip: 'Ctrl+V / Cmd+V shortcut directly works on the map. URL to PDF, images, YouTube, Google Docs',\r\n  shareImage: 'Ima_ge (can paste directly)',\r\n  shareZoneImage: '_Chat Zone',\r\n  shareImageTip: 'Image files will be uploaded to gyazo.com. You can also paste the URL of the image.',\r\n  shareGDrive: 'Import Files from Google Drive',\r\n  shareGDriveTip: 'Upload any available file from Google Drive',\r\n  shareWhiteboard: '_Whiteboard',\r\n  shareWhiteboardTip: 'Place the wbo.ophir.dev whiteboard.',\r\n  shareEditEnd: 'Stop editing',\r\n  shareCamera: '_Camera',\r\n  shareScreenBackground:'Screen as the _background',\r\n  stopScreenBackground:'Stop _background screen',\r\n  shareScreenContent:'_Screen',\r\n  shareScreenContentTip:'Reducing the screen update frequency (fps) will reduce the network load.',\r\n  stopScreen:'C_lose all screen and camera windows',\r\n  frameRateSetting: 'Frame rate:',\r\n  fps: 'fps',\r\n  shareMouse:'_Mouse cursor',\r\n  shareMouseTip:'Show the mouse cursor to other participants. The avatar also always gazes at the mouse cursor.',\r\n  stopMouse: 'Stop sharing _Mouse cursor',\r\n  recorderMenuTitle: '_Record and playback',\r\n  recorderStart: 'Start _recording',\r\n  recorderStop: 'Stop _recording',\r\n  playerStop: 'Stop _playback',\r\n  playerPlayfile: '_Load and play',\r\n\r\n  ttCreateAndshare: '_Create and share',\r\n  ttMicMute: '_Mic mute',\r\n  ttPlayAndRec: '_Record and Playback',\r\n  headphoneL1Chrome: 'Stereo headphone (Caution: no echo cancel)',\r\n  headphoneL1: 'Stereo headphone',\r\n  headphoneL2: 'Monaural speaker',\r\n  etConnection: 'No connection',\r\n  emConnection: 'Please check internet connection. Earshot Chat uses https. If internet is OK, the server may have problems.',\r\n  etMicPermission: 'No permission to use microphone',\r\n  emMicPermission: 'Your browser does not permit to use microphone. Please give the permission and reload your browser.',\r\n  etNoMic: 'No microphone',\r\n  emNoMic: 'Please check if your PC has a microphone. Earshot Chat requires it.',\r\n  emClose: 'Close',\r\n  emNeverShow: 'Never show this in this session',\r\n  etNoChannel: 'No data channel',\r\n  emNoChannel: 'Please check firewall setting. Earshot Chat connect to https (port 443/TCP) and port 8801-8810/UDP or 80/TCP.',\r\n\r\n  etDataConnection: 'Data connection failed',\r\n  etRtcConnection: 'Media connection failed',\r\n  emDataConnection: 'Please check firewall setting. Earshot Chat connect to https (port 443/TCP).',\r\n  emRtcConnection: 'Please check firewall setting. Earshot Chat connect to https (port 443/TCP).',\r\n\r\n  ctTitle: 'Show Title',\r\n  ctUnTitle: 'Hide Title',\r\n\r\n  etRetry: 'Please reload',\r\n  emRetry: 'The connection had been cut off once. Please click the reload button of the browser.',\r\n  imageDropzoneText:'Drag and drop images here or click',\r\n  lsTitle:'Avatar and notification setting',\r\n  lsName: 'Name',\r\n  lsColor: 'Color',\r\n  lsColorAvatar:'Avatar',\r\n  lsColorText:'Text',\r\n  lsAutoColor:'Auto',\r\n  lsImage: 'Avatar image',\r\n  lsEmail: 'Input email to use Gravatar\\'s image',\r\n  lsImageFile: 'Upload file to use image file',\r\n  btSave: 'Save and close',\r\n  btCancel: 'Cancel change',\r\n  lsNotifyCall: 'Called',\r\n  lsNotifyTouch: 'Touched',\r\n  lsNotifyNear: 'Approached',\r\n  lsNotifyYarn: 'Yarn phone',\r\n  rsCall: 'Call',\r\n  lsNotification: 'Notification',\r\n  rsConnectYarnPhone: 'Connect yarn phone',\r\n  rsCutYarnPhone: 'Disconnect yarn phone',\r\n  rsChatTo: 'Send chat only to {{name}}',\r\n  ctPin: 'Lock position and size',\r\n  ctUnpin: 'Unlock position and size',\r\n  ctEdit: 'Start editing (No view sync)',\r\n  ctEndEdit: 'End editing (Sync view)',\r\n  ctUploadZone: 'Upload and share',\r\n  ctEditIframe: 'Browse page (No sync)',\r\n  ctEndEditIframe: 'End browse (No sync)',\r\n  ctEditText: 'Edit (No scroll sync)',\r\n  ctEndEditText: 'End edit (Sync scroll)',\r\n  ctEditWhiteboard: 'Edit (No scroll sync)',\r\n  ctEndEditWhiteboard: 'End edit (No scroll sync)',\r\n  ctEditGDrive: 'Edit/Update (No scroll sync)',\r\n  ctEndEditGDrive: 'End edit (No auto-update)',\r\n  ctEndEditYoutube: 'Sync play pos',\r\n  ctEditYoutube: 'No sync',\r\n  ctMoveTop: 'Move to the top',\r\n  ctMoveBottom: 'Move to the bottom',\r\n  ctWallpaper: 'Make this wallpaper',\r\n  ctUnWallpaper: 'Remove this from wallpaper',\r\n  ctCopyToClipboard: 'Copy to clipboard',\r\n  ctMaximize: 'Zoom and move to maximize this content',\r\n  ctUnMaximize: 'Unmaximize and restore the view',\r\n  ctDelete: 'Delete',\r\n  ctClose: 'Close',\r\n  ctName: 'Titile',\r\n  ctFocus: 'Show it in the center',\r\n  ctFrameVisible: 'Normal frame',\r\n  ctFrameInvisible: 'Invisible frame',\r\n  ctOpenAudioZone: 'Meeting space',\r\n  ctClosedAudioZone: 'Sound proof room',\r\n  ctNotAudioZone: 'Just an image',\r\n  ctOpaque: 'Opaque',\r\n  ctTransparent: 'Transparent',\r\n  ctGenerateAvatar: 'Customize Avatar',\r\n  deleteMsg: 'Remove',\r\n  upload: 'Upload',\r\n  Save: 'Save',\r\n  Clear: 'Clear',\r\n  Cancel: 'Cancel',\r\n  broadcastMyVoice: 'Broadcast my voice',\r\n  showTrackedFace: 'Show only facial feature points',\r\n  trackWholeBody: 'Track whole body',\r\n  soundLocalizationBasedOn: 'Sound localization based on',\r\n  stereoNote: 'Are you really using headphones?',\r\n  stereoNoteDesc: 'If you use it with a speaker, it will echo back the other party\\'s voice, making it very difficult for the other party to speak.',\r\n  stereoConfirmed: 'Confirmed and change into headphone mode',\r\n  stereoCancel: 'Keep loudspeaker mode',\r\n  slAvatar: 'Avatar (avatar\\'s direction)',\r\n  slUser: 'User (top is front)',\r\n  usage: 'How to use',\r\n  cmJoined: '{{name}} joined.',\r\n  cmLeft: '{{name}} Left.',\r\n  cmNameChanged: '{{old}} changed its name to {{new}}.',\r\n  cmCallBy: '{{name}} called you.',\r\n  cmCallTo: 'You called {{name}}.',\r\n  cmToAll: 'To all',\r\n  cmToName: 'To {{name}}',\r\n  cmSend: 'Send (CTRL+Enter)',\r\n  cmPrivateFrom: 'Private from {{name}}',\r\n  cmPrivateTo: 'Private to {{name}}',\r\n  noCalled: '{{name}} called you.',\r\n  noTouched: '{{name}} touched you.',\r\n  noNear: '{{name}} approached you.',\r\n  noYarn: '{{name}} connected yarn.',\r\n  afkTitle: 'In away from keyboard mode (L / Esc)',\r\n  afkMessage: 'Hit any key or click mouse to return.',\r\n  gdFailed: 'The file in Google Drive could not be accessed.\\r\\nChange the file-sharing settings so that everyone on the Internet can see it.',\r\n  videoLimit: 'Limit on the number of video streams',\r\n  audioLimit: 'Limit on the number of audio streams',\r\n  connectionStatus: 'Connection Status',\r\n  deleteImageMsg: 'Remove Image?',\r\n  deleteZoneMsg: 'Remove Chat Zone?',\r\n  deleteTextMsg: 'Remove Text?',\r\n  deleteYes: 'Remove',\r\n  ctKick: 'Kick user from meeting',\r\n  deleteNo: \"Don't Remove\",\r\n  copyClipboard: 'Meeting address copied to clipboard',\r\n  deleteAlert: 'ALERT',\r\n  ctProximity: 'Enable Chat Zone',\r\n  ctUnProximity: 'Disable Chat Zone',\r\n  ctStopWatchOn: 'Start zone stopwatch',\r\n  ctStopWatchOff: 'Stop zone stopwatch',\r\n  ctScaleRotate: 'Enable Scale and Rotate',\r\n  ctUnScaleRotate: 'Disable Scale and Rotate',\r\n  settingPreference: '_Preferences...',\r\n  meetingSpace: '_Meeting Space',\r\n  meetingDesc: 'Meeting Description',\r\n  broadcastMyVideo: 'Broadcast my video',\r\n  broadcastMySpeakVideo: 'Speak & Show',\r\n  stereoswitch: 'Stereo sound (via headset)',\r\n}\r\nexport type EnKeyList = keyof typeof enTranslate\r\n","export const jaTranslate = {\r\n  enAbout: '位置に応じて声が届く2Dマップ付きビデオチャットです。'\r\n  + '会場内に複数の会話が並立し、会話間を歩き回ることができます。'\r\n  + '画面、カメラ、テキスト、画像、YouTube、Googleドライブの文書を共有できます。マップにURL等をドロップ/ペーストできます。',\r\n  enTopPageUrl: 'https://scrapbox.io/binaural-meet/%E3%83%88%E3%83%83%E3%83%97%E3%83%9A%E3%83%BC%E3%82%B8',\r\n  enMoreInfo: '詳細',\r\n  YourName: 'お名前を入力ください',\r\n  Venue: '会場名',\r\n  EnterTheVenue: '入場',\r\n  Contents: '共有',\r\n  createAndShareTitle: '共有 (_c)',\r\n  'Create and Share': 'テキストの共有',\r\n  'Share Text':'テキストの共有',\r\n  'Share iframe':'テキストの共有',\r\n  'Share image':'テキストの共有',\r\n  'Share zone image':'テキストの共有',\r\n  'Select video camera to share':'テキストの共有',\r\n  'Meeting Space':'テキストの共有',\r\n  shareImport: 'ファイルからインポート (_i)',\r\n  shareImportTip: 'ダウンロードしたファイルから、共有コンテンツをロードします。',\r\n  shareDownload: 'ファイルにダウンロード (_d)',\r\n  shareDownloadTip: '画面共有とカメラ以外の全共有コンテンツをファイルにダウンロードします。',\r\n  shareIframe: 'Webページ (_f)',\r\n  shareIframeTip: '表示できるWebページはiframeで表示できるものに限られます。',\r\n  shareText: 'テキスト (_t / 直接ペースト可)',\r\n  sharePaste: 'ペースト (_v)',\r\n  sharePasteTip: 'マップ上で Ctrl+V / Cmd+V でも貼付けできます。PDF、画像、YouTube、Google DocsへのURLを認識します。',\r\n  shareImage: '画像 (_g)',\r\n  shareZoneImage: '画像 (_g / 直接ペースト可)',\r\n  shareImageTip: 'マップ上で Ctrl+V / Cmd+V で貼付けできます。画像は gyazo.com にアップロードされます。画像のURLも貼付けできます。',\r\n  shareGDrive: 'Import Files from Google Drive',\r\n  shareGDriveTip: 'Upload any available file from Google Drive',\r\n  shareWhiteboard: 'ホワイトボード (_w)',\r\n  shareWhiteboardTip: 'wbo.ophir.dev のホワイトボードを置きます。',\r\n  deleteMsg: '映像ストリ',\r\n  ctGenerateAvatar: '防音会議室',\r\n  ctUploadZone: '不透明',\r\n  shareEditEnd: '編集終了',\r\n  shareCamera: 'ビデオカメラ (_c)',\r\n  shareScreenBackground:'背景に画面共有 (_b)',\r\n  stopScreenBackground:'背景の画面共有を停止 (_b)',\r\n  shareScreenContent:'画面共有 (_s)',\r\n  shareScreenContentTip:'画面更新の頻度(fps)を下げるとネットワーク負荷が減ります。',\r\n  stopScreen:'画面共有・カメラをすべて閉じる (_l)',\r\n  shareMouse:'マウスカーソル (_m)',\r\n  shareMouseTip:'マウスカーソルが他の参加者にも見えるようになります。アバターの目もマウスカーソルを向いています。',\r\n  recorderMenuTitle: '録画と再生(_r)',\r\n  recorderStart: '録画開始(_r)',\r\n  recorderStop: '録画停止(_r)',\r\n  playerStop: '再生停止(_p)',\r\n  playerPlayfile: 'ファイルを再生(_l)',\r\n\r\n  ttCreateAndshare: '作成と共有 (_c)',\r\n  ttPlayAndRec: '録画と再生 (_r)',\r\n  stopMouse: 'マウスカーソルの共有停止 (_m)',\r\n  frameRateSetting: 'フレームレート',\r\n  fps: 'fps',\r\n  ttMicMute: 'マイクのミュート (_m)',\r\n  headphoneL1Chrome: 'ヘッドフォン (ステレオ / 注意:エコキャンなし)',\r\n  headphoneL1: 'ヘッドフォン (ステレオ)',\r\n  headphoneL2: 'スピーカー (モノラル)',\r\n  etConnection: 'インターネット接続なし',\r\n  emConnection: 'インターネット接続を確認してください。Earshot Chatは https を使います。インターネット接続の問題でなければ、サーバの問題かもしれません。',\r\n  etMicPermission: 'マイク利用不可',\r\n  emMicPermission: 'ブラウザがマイクの利用を許可しませんでした。ブラウザのURLの左の鍵のアイコンから許可し、ブラウザをリロードしてください。',\r\n  etNoMic: 'マイクがありません',\r\n  emNoMic: 'Earshot Chatにはマイクが必要です。パソコンにマイクがついていることを確認してください。',\r\n  emClose: '閉じる',\r\n  emNeverShow: 'このセッションでは表示しない',\r\n  etDataConnection: 'データサーバに接続できません',\r\n  etRtcConnection: 'メディアサーバに通信ができません',\r\n  emDataConnection: 'ファイアウォールの設定を確認してください。Earshot Chat は https(443番)ポートに接続します。',\r\n  emRtcConnection: 'ファイアウォールの設定を確認してください。Earshot Chat は https(443番)ポートに接続します。',\r\n//  etRetry: '再接続中',\r\n//  emRetry: '接続が切れたので、再接続を試みています。インターネット接続を確認してください。',\r\n  etRetry: 'ブラウザの更新ボタンを押してください',\r\n  emRetry: '一度接続が切れました。ブラウザの更新(リロード)ボタンを押してください。',\r\n  imageDropzoneText:'画像をドラッグ＆ドロップするか、クリックしてください',\r\n  lsTitle:'アバターと通知の設定',\r\n  lsColor:'色',\r\n  lsColorAvatar:'アバター色',\r\n  lsColorText:'文字色',\r\n  lsAutoColor:'自動',\r\n  lsName: 'お名前',\r\n  lsImage: 'アバターの画像',\r\n  lsEmail: 'Gravatarの画像を使う場合はEmailを入力',\r\n  lsImageFile: '画像ファイルの場合はファイルをアップロード',\r\n  btSave: '保存して閉じる',\r\n  btCancel: ' もとに戻す ',\r\n  lsNotification: '通知の設定',\r\n  lsNotifyCall: '呼出',\r\n  lsNotifyTouch: '接触',\r\n  lsNotifyNear: '接近',\r\n  lsNotifyYarn: '糸電話',\r\n  rsCall: '呼び出す',\r\n  rsConnectYarnPhone: '糸電話をつなぐ',\r\n  rsCutYarnPhone: '糸電話を切る',\r\n  rsChatTo: '{{name}}だけにチャットを送る',\r\n  ctPin: '位置/サイズを固定する',\r\n  ctUnpin: '位置/サイズを可変にする',\r\n  ctEditIframe: 'ページをブラウズ (非同期)',\r\n  ctEndEditIframe: 'ブラウズを終了 (同期なし)',\r\n  ctEditText: '編集開始 (表示位置は非同期)',\r\n  ctEndEditText: '編集終了 (表示位置を同期)',\r\n  ctEditWhiteboard: '編集開始 (表示位置は非同期)',\r\n  ctEndEditWhiteboard: '編集終了 (表示位置は非同期)',\r\n  ctEditGDrive: '編集開始・表示更新 (表示位置は非同期)',\r\n  ctEndEditGDrive: '編集終了 (自動更新なし)',\r\n  ctEndEditYoutube: '再生位置を同期',\r\n  ctEditYoutube: '同期しない',\r\n  ctMoveTop: '一番上に移動',\r\n  ctMoveBottom: '一番下に移動',\r\n  ctWallpaper: '壁紙にする',\r\n  ctUnWallpaper: '壁紙からはずす',\r\n  ctCopyToClipboard: 'クリップボードにコピー',\r\n  ctMaximize: '最大化するように拡大する',\r\n  ctUnMaximize: '最大化と拡大を戻す',\r\n  ctFocus: '中央に表示',\r\n  ctDelete: '削除する',\r\n  ctClose: '閉じる',\r\n  ctName: 'タイトル',\r\n  ctFrameVisible: 'フレームあり',\r\n  ctFrameInvisible: 'フレームなし',\r\n  ctOpenAudioZone: '会議場所',\r\n  ctClosedAudioZone: '防音会議室',\r\n  ctNotAudioZone: 'ただの画像',\r\n  ctOpaque: '不透明',\r\n  ctTransparent: '透明',\r\n  upload: 'アップロード',\r\n  Save: '保存',\r\n  Clear: 'クリア',\r\n  Cancel: 'キャンセル',\r\n  broadcastMyVoice: '声を全員に届ける',\r\n  showTrackedFace: '顔の特徴点のみ表示',\r\n  trackWholeBody: '全身をトラック',\r\n  soundLocalizationBasedOn: '音像定位の向きの基準',\r\n  stereoNote: '本当にヘッドフォンを使っていますか？',\r\n  stereoNoteDesc: 'スピーカーで使用すると相手の声をエコーバックしてしまうため、相手がとても話しにくくなります。',\r\n  stereoConfirmed: '確認したので、ヘッドフォンモードに変更',\r\n  stereoCancel: 'スピーカモードのままにする',\r\n  slAvatar: 'アバターの向き',\r\n  slUser: 'ユーザーの向き(上が前)',\r\n  usage: '使い方',\r\n  cmJoined: '{{name}}が参加。',\r\n  cmLeft: '{{name}}が退出。',\r\n  cmNameChanged: '{{old}} が {{new}} に名前を変更。',\r\n  cmCallBy: '{{name}}があなたを呼びました。',\r\n  cmCallTo: 'あなたが{{name}}を呼びました。',\r\n  cmToAll: '全員へ',\r\n  cmToName: '{{name}}へ',\r\n  cmSend: '送信 (CTRL+Enter)',\r\n  cmPrivateFrom: '{{name}}から個人宛',\r\n  cmPrivateTo: '自分から{{name}}宛',\r\n  noCalled: '{{name}}が呼びました。',\r\n  noTouched: '{{name}}が触れました。',\r\n  noNear: '{{name}}が近づきました。',\r\n  noYarn: '{{name}}が糸電話をつなぎました。',\r\n  afkTitle: '離席中モード (L / Esc)',\r\n  afkMessage: 'キーかマウスクリックで戻ります。',\r\n  gdFailed: 'Google Driveのファイルにアクセスできませんでした。\\r\\nファイルを共有設定を変え、インターネット上の全員が閲覧できるようにしてください。',\r\n  videoLimit: '映像ストリーム数の上限',\r\n  audioLimit: '音声ストリーム数の上限',\r\n  connectionStatus: '通信状態',\r\n  deleteImageMsg: '映像ストリーム数の上限?',\r\n  deleteZoneMsg: '映像ストリーム数の上限?',\r\n  deleteTextMsg: '映像ストリーム数の上限?',\r\n  deleteYes: '通信状態',\r\n  deleteNo: '通信状態',\r\n  copyClipboard : '通信状態',\r\n  deleteAlert: '通信状態',\r\n  ctProximity: '位置/サイズを固定する',\r\n  ctUnProximity: '位置/サイズを可変にする',\r\n  ctScaleRotate: '位置/サイズを可変にする',\r\n  ctUnScaleRotate: '位置/サイズを可変にする',\r\n  ctStopWatchOn: '位置/サイズを可変にする',\r\n  ctStopWatchOff: '位置/サイズを可変にする',\r\n  ctKick: '中央に表示',\r\n  settingPreference: 'ファイルからインポート (_i)',\r\n  meetingSpace: 'ファイルにダウンロード (_d)',\r\n  meetingDesc: 'ファイルにダウンロード (_d)',\r\n  broadcastMyVideo: '声を全員に届ける',\r\n  broadcastMySpeakVideo: '声を全員に届ける',\r\n  stereoswitch: '声を全員に届ける',\r\n  ctTitle: '位置/サイズを固定する',\r\n  ctUnTitle: '位置/サイズを可変にする',\r\n}\r\nexport type JaKeyList = keyof typeof jaTranslate\r\n","import { ISharedContent } from '@models/ISharedContent'\r\nimport {MapObject} from './MapObject'\r\nimport {findReverseColorRGB, findTextColorRGB, getRandomColorRGB, rgb2Color} from './utils/color'\r\nimport {Mouse} from './utils/coordinates'\r\nimport * as Kalidokit from 'kalidokit'\r\n\r\nexport const PARTICIPANT_SIZE = 60\r\n\r\nexport interface VRMRigs{\r\n  face?:Kalidokit.TFace,\r\n  pose?:Kalidokit.TPose,\r\n  leftHand?: Kalidokit.THand<'Left'>\r\n  rightHand?: Kalidokit.THand<'Right'>\r\n}\r\n\r\nexport interface ParticipantBase extends MapObject{\r\n  physics: Physics\r\n  mouse: Mouse\r\n  viewpoint: Viewpoint\r\n  id: string\r\n  information: RemoteInformation|LocalInformation\r\n  zIndex: number\r\n  vrmRigs?: VRMRigs\r\n}\r\n\r\nexport interface PlaybackParticipant extends ParticipantBase {\r\n  audioBlob?: Blob\r\n  videoBlob?: Blob\r\n}\r\n\r\nexport interface PlaybackContent extends ISharedContent {\r\n  audioBlob?: Blob\r\n  videoBlob?: Blob\r\n}\r\n\r\nexport interface RemoteParticipant extends ParticipantBase {\r\n  tracks: Tracks\r\n  informationReceived: boolean\r\n  closedZone?: ISharedContent\r\n  inLocalsZone: boolean\r\n}\r\n\r\nexport interface LocalParticipant extends ParticipantBase {\r\n  soundLocalizationBase: SoundLocalizationBase\r\n  information: LocalInformation\r\n  zone?: ISharedContent\r\n  tracks: Tracks\r\n}\r\nexport type Participant = LocalParticipant | RemoteParticipant\r\n\r\nexport interface BaseInformation {\r\n  name: string\r\n  avatarSrc: string\r\n  color: number[]\r\n  textColor: number[]\r\n  randomAvatar: string[]\r\n}\r\nexport interface RemoteInformation extends BaseInformation{\r\n}\r\nexport interface LocalInformation extends BaseInformation{\r\n  email: string\r\n  faceTrack: boolean\r\n  notifyCall: boolean\r\n  notifyTouch: boolean\r\n  notifyNear: boolean\r\n  notifyYarn: boolean\r\n}\r\nexport const defaultInformation:LocalInformation = {\r\n  name: '',\r\n  email: '',\r\n  avatarSrc: '',\r\n  color: [],\r\n  textColor: [],\r\n  randomAvatar: [],\r\n  faceTrack: false,\r\n  notifyCall: true,\r\n  notifyTouch: false,\r\n  notifyNear: false,\r\n  notifyYarn: false,\r\n}\r\nexport const defaultRemoteInformation:RemoteInformation = {\r\n  name: '',\r\n  avatarSrc: '',\r\n  color: [],\r\n  textColor: [],\r\n  randomAvatar: [],\r\n}\r\nexport interface Tracks {\r\n  audio: MediaStreamTrack | undefined\r\n  avatar: MediaStreamTrack | undefined\r\n  audioStream: MediaStream | undefined\r\n  avatarStream: MediaStream | undefined\r\n}\r\n\r\nexport interface TrackStates{\r\n  micMuted: boolean,\r\n  speakerMuted: boolean,\r\n  headphone: boolean,\r\n  emoticon: string,\r\n  pingIcon: boolean,\r\n  pingX: number,\r\n  pingY: number,\r\n  remoteID: string,\r\n  remoteX: number,\r\n  remoteY: number,\r\n}\r\nexport interface Physics {\r\n  located: boolean            //  located on map or not\r\n  onStage: boolean            //  bloardcast or not\r\n  awayFromKeyboard: boolean\r\n}\r\nexport const defaultPhysics: Physics = {\r\n  located: true,\r\n  onStage: false,\r\n  awayFromKeyboard: false,\r\n}\r\nexport interface Viewpoint{\r\n  height: number              //  zoom (viewing range) of the map\r\n  center: [number, number]    //  center of the map from the avatar\r\n  nodding?: number            //  up-down nose direction\r\n}\r\nexport const defaultViewpoint: Viewpoint = {\r\n  height: 0,\r\n  center: [0,0],\r\n}\r\nexport type SoundLocalizationBase = 'avatar' | 'user'\r\n\r\nexport function getColorOfParticipant(information: BaseInformation) {\r\n  let color = information.color\r\n  if (!color.length) {\r\n    if (information.name.length){\r\n      color = getRandomColorRGB(information.name)\r\n    }else{\r\n      color = [0xD0, 0xD0, 0xE0]\r\n    }\r\n  }\r\n  let textColor = information.textColor\r\n  if (!textColor.length) {\r\n    textColor = findTextColorRGB(color)\r\n  }\r\n  const reverseRGB = findReverseColorRGB(color)\r\n  const colors = [rgb2Color(color), rgb2Color(textColor), rgb2Color(reverseRGB)]\r\n\r\n  return colors\r\n}\r\n","import {makeObservable, observable} from 'mobx'\r\n\r\nexport class DevicePreference {\r\n  constructor() {\r\n    makeObservable(this)\r\n  }\r\n  [id: string]: string|undefined\r\n  @observable audioInputDevice:string|undefined = undefined\r\n  @observable videoInputDevice:string|undefined = undefined\r\n  @observable audioOutputDevice:string|undefined = undefined\r\n}\r\n","export const MAP_SIZE = 5000\r\nexport const MAP_CENTER:[number, number] = [0, 0]\r\n","import {MAP_CENTER} from '@components/Constants'\r\nimport {MapObject as IMapObject} from '@models/MapObject'\r\nimport {Pose2DMap} from '@models/utils'\r\nimport _ from 'lodash'\r\nimport { makeObservable, observable} from 'mobx'\r\nimport {shallowObservable, Store} from './utils'\r\n\r\nexport const defaultValue: IMapObject = {\r\n  pose: {\r\n    position: [MAP_CENTER[0], MAP_CENTER[1]],\r\n    orientation: 0,\r\n  },\r\n}\r\n\r\nexport class MapObject implements Store<IMapObject> {\r\n  @observable pose: Pose2DMap\r\n\r\n  constructor() {\r\n    this.pose = _.cloneDeep(defaultValue.pose)\r\n    makeObservable(this)\r\n  }\r\n\r\n  static fromPlain(obj: IMapObject) {\r\n    const store = new MapObject()\r\n    store.pose = shallowObservable(_.cloneDeep(obj.pose))\r\n  }\r\n}\r\n","import {IObservable, observable} from 'mobx'\r\n\r\nexport function shallowObservable<T extends Object>(obj: T) {\r\n  return observable(obj, undefined, {deep: false})\r\n}\r\n\r\nexport type Store<T> = {\r\n  [K in keyof T]: T[K] | (T[K] & IObservable)\r\n}\r\n","import {\r\n  defaultInformation, defaultPhysics, defaultRemoteInformation,\r\n  defaultViewpoint, LocalInformation,\r\n  ParticipantBase as IParticipantBase, Physics, RemoteInformation, Tracks, TrackStates as ITrackStates, VRMRigs\r\n} from '@models/Participant'\r\nimport {findReverseColorRGB, findTextColorRGB, getRandomColorRGB, rgb2Color} from '@models/utils'\r\nimport {Mouse} from '@models/utils'\r\nimport {MapObject} from '@stores/MapObject'\r\nimport {Store} from '@stores/utils'\r\nimport {action, computed, makeObservable, observable} from 'mobx'\r\n\r\nexport class TracksStore implements Tracks{\r\n  constructor(){\r\n    makeObservable(this)\r\n  }\r\n  @observable.ref audio:MediaStreamTrack|undefined = undefined\r\n  @observable.ref avatar:MediaStreamTrack|undefined = undefined\r\n  @observable avatarOk = this.avatar ? !this.avatar.muted : true\r\n  @computed get audioStream() {\r\n    if (this.audio){\r\n      const ms = new MediaStream()\r\n      if (this.audio) ms.addTrack(this.audio)\r\n      return ms\r\n    }\r\n    return undefined\r\n  }\r\n  @computed get avatarStream() {\r\n    if (this.avatar){\r\n      const ms = new MediaStream()\r\n      if (this.avatar) ms.addTrack(this.avatar)\r\n      return ms\r\n    }\r\n    return undefined\r\n  }\r\n  @action onMuteChanged(track: MediaStreamTrack, mute: boolean) {\r\n    if (track === this.avatar) {\r\n      this.avatarOk = !mute\r\n    }\r\n  }\r\n}\r\n\r\nexport class TrackStates implements Store<ITrackStates>{\r\n  @observable micMuted = false\r\n  @observable speakerMuted = false\r\n  @observable headphone = false\r\n  @observable emoticon = ''\r\n  @observable pingIcon = false\r\n  @observable pingX = 0\r\n  @observable pingY = 0\r\n\r\n  // For Remote movement\r\n  @observable remoteID = ''\r\n  @observable remoteX = 0\r\n  @observable remoteY = 0\r\n  constructor(){\r\n    makeObservable(this)\r\n  }\r\n}\r\n\r\nexport class ParticipantBase extends MapObject implements Store<IParticipantBase> {\r\n  @observable id = ''\r\n  @observable zIndex = 0\r\n  @observable.shallow physics = defaultPhysics\r\n  @observable.shallow viewpoint = defaultViewpoint\r\n  @observable.shallow mouse:Mouse = {position:[0, 0], show:false}\r\n  @observable.shallow information: LocalInformation | RemoteInformation\r\n  @observable muteAudio = false\r\n  @observable muteSpeaker = false\r\n  @observable muteVideo = false\r\n  @observable audioLevel = 0\r\n  @action setAudioLevel(a:number) { this.audioLevel = a }\r\n  @observable recording = false\r\n  // determines whether the audio would be rendered\r\n  @computed get showAudio () {\r\n    return !this.muteAudio\r\n  }\r\n  // determines whether the video would be rendered\r\n  @computed get showVideo () {\r\n    return !this.muteVideo\r\n  }\r\n  @observable quality:number|undefined = undefined\r\n  @observable.ref vrmRigs:VRMRigs|undefined = undefined\r\n\r\n  constructor(isLocal=false) {\r\n    super()\r\n    if (isLocal){\r\n      this.information = defaultInformation\r\n    }else{\r\n      this.information = defaultRemoteInformation\r\n    }\r\n    makeObservable(this)\r\n  }\r\n\r\n  getColor() {\r\n    let color = this.information.color\r\n    if (!color.length) {\r\n      if (this.information.name.length){\r\n        color = getRandomColorRGB(this.information.name)\r\n      }else{\r\n        color = [0xD0, 0xD0, 0xE0]\r\n      }\r\n    }\r\n    let textColor = this.information.textColor\r\n    if (!textColor.length) {\r\n      textColor = findTextColorRGB(color)\r\n    }\r\n    const reverseRGB = findReverseColorRGB(color)\r\n    const colors = [rgb2Color(color), rgb2Color(textColor), rgb2Color(reverseRGB)]\r\n\r\n    return colors\r\n  }\r\n\r\n  getColorRGB() {\r\n    return this.information.color.length ? this.information.color : getRandomColorRGB(this.information.name)\r\n  }\r\n  getTextColorRGB() {\r\n    let textColor = this.information.textColor\r\n    if (!textColor.length) {\r\n      let color = this.information.color\r\n      if (!color.length) {\r\n        color = getRandomColorRGB(this.information.name)\r\n      }\r\n      textColor = findTextColorRGB(color)\r\n    }\r\n\r\n    return textColor\r\n  }\r\n\r\n  @action.bound\r\n  setPhysics(physics: Partial<Physics>) {\r\n    Object.assign(this.physics, physics)\r\n  }\r\n}\r\n","import { ISharedContent } from '@models/ISharedContent'\r\nimport {LocalInformation, LocalParticipant as ILocalParticipant, Physics, RemoteInformation, TrackStates} from '@models/Participant'\r\nimport {urlParameters} from '@models/url'\r\nimport {checkImageUrl, mulV2, Pose2DMap, subV2} from '@models/utils'\r\nimport {MapData} from '@stores/Map'\r\nimport {Store} from '@stores/utils'\r\nimport md5 from 'md5'\r\nimport {action, computed, makeObservable, observable} from 'mobx'\r\nimport {autorun} from 'mobx'\r\nimport {DevicePreference} from './localPlugins'\r\nimport {ParticipantBase, TracksStore} from './ParticipantBase'\r\n// config.js\r\ndeclare const config:any                  //  from ../../config.js included from index.html\r\n\r\nexport interface MediaSettings{\r\n  stream:{\r\n    muteVideo: boolean,\r\n    muteAudio: boolean,\r\n    muteSpeaker: boolean,\r\n  },\r\n  device:DevicePreference,\r\n  headphone: boolean,\r\n  soundLocalizationBase: string,\r\n  uploadPreference: string\r\n}\r\n\r\ninterface PhysicsInfo{\r\n  pose: Pose2DMap,\r\n  physics: Physics,\r\n}\r\n\r\ntype UploaderPreference = 'gyazo' | 'gdrive'\r\n\r\nexport class LocalParticipant extends ParticipantBase implements Store<ILocalParticipant> {\r\n  devicePreference = new DevicePreference()\r\n  @observable.shallow tracks = new TracksStore()\r\n  @observable useStereoAudio = false  //  will be override by url switch\r\n\r\n  @observable emoticon = ''  //  for emoticon\r\n  @observable pingIcon = false  //  for ping status\r\n  @observable pingX = 0  //  for ping location X\r\n  @observable pingY = 0  //  for ping location y\r\n\r\n  @observable remoteID = ''  //  for remote movement\r\n  @observable remoteX = 0  //  for remote movement\r\n  @observable remoteY = 0  //  for remote movement\r\n\r\n  @observable headphoneConfirmed = false  //  Ask if really use headphone or not\r\n  @observable thirdPersonView = config.thirdPersonView as boolean\r\n  @observable soundLocalizationBase = config.soundLocalizationBase ? config.soundLocalizationBase : 'user'\r\n  @observable uploaderPreference:UploaderPreference = config.uploaderPreference ? config.uploaderPreference : 'gyazo'\r\n  @observable.ref zone:ISharedContent|undefined = undefined    //  The zone on which the local participant located.\r\n  @observable remoteVideoLimit = config.remoteVideoLimit as number || -1\r\n  @observable remoteAudioLimit = config.remoteAudioLimit as number || -1\r\n  @observable audioInputDevice:string|undefined = undefined\r\n  @observable videoInputDevice:string|undefined = undefined\r\n  @observable audioOutputDevice:string|undefined = undefined\r\n\r\n\r\n  information = this.information as LocalInformation\r\n  @observable.ref informationToSend:RemoteInformation|undefined\r\n  @action setThirdPersonView(tpv: boolean) { this.thirdPersonView = tpv }\r\n  @computed get trackStates():TrackStates {\r\n    return {\r\n      micMuted: this.muteAudio,\r\n      speakerMuted: this.muteSpeaker,\r\n      headphone: this.useStereoAudio,\r\n      emoticon: this.emoticon,\r\n      pingIcon: this.pingIcon,\r\n      pingX: this.pingX,\r\n      pingY: this.pingY,\r\n      remoteID: this.remoteID,\r\n      remoteX: this.remoteX,\r\n      remoteY: this.remoteY,\r\n    }\r\n  }\r\n//  get info():LocalInformation { return this.information as LocalInformation}\r\n\r\n  constructor() {\r\n    super(true)\r\n    this.informationToSend = undefined\r\n    makeObservable(this)\r\n    this.loadInformationFromStorage()\r\n    if (urlParameters.name) { this.information.name = urlParameters.name }\r\n    this.useStereoAudio = urlParameters.headphone !== null ? true : false\r\n    //  console.debug('URL headphone', urlParameters.headphone)\r\n    this.muteAudio = urlParameters.muteMic !== null ? true : false\r\n    //  console.debug('URL muteMic', urlParameters.muteMic)\r\n    this.muteVideo = urlParameters.cameraOn !== null ? false : true\r\n    //  console.debug('URL cameraOn', urlParameters.cameraOn)\r\n    this.emoticon = '' // for emoticon\r\n    this.pingIcon = false // for video status\r\n    this.pingX = 0 // for ping X\r\n    this.pingY = 0 // for ping y\r\n\r\n    this.remoteID = '' // for remote Id\r\n    this.remoteX = 0 // for remote X\r\n    this.remoteY = 0 // for remote Id\r\n\r\n    this.loadMediaSettingsFromStorage()\r\n    this.loadPhysicsFromStorage()\r\n    autorun(() => { //  image avatar\r\n      const gravatar = 'https://www.gravatar.com/avatar/'\r\n      const vrm = 'https://binaural.me/public_packages/uploader/vrm'\r\n      let src = this.information.avatarSrc\r\n      if ((!src || src.includes(gravatar, 0) || src.includes(vrm, 0)) && this.information.email){\r\n        const email = this.information.email.trim()\r\n        if (email.includes(vrm) && email.slice(-4) === '.vrm'){\r\n          src = email\r\n        }else{\r\n          const hash = md5(this.information.email.trim().toLowerCase())\r\n          src = `${gravatar}${hash}?d=404`\r\n        }\r\n      }\r\n      if (src){\r\n        if (src.slice(-4)==='.vrm'){\r\n          this.information.avatarSrc = src\r\n        }else{\r\n          checkImageUrl(src).then((src)=>{\r\n            this.information.avatarSrc = src\r\n          }).catch(()=>{\r\n            this.information.avatarSrc = ''\r\n          })\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  //  send infomration to other participants\r\n  @action sendInformation(){\r\n    const {email, ...info} = this.information\r\n    this.informationToSend = info\r\n  }\r\n  //  save and load participant's name etc.\r\n  saveInformationToStorage(isLocalStorage:boolean) {\r\n    let storage = sessionStorage\r\n    if (isLocalStorage) { storage = localStorage }\r\n    //  console.log(storage === localStorage ? 'Save to localStorage' : 'Save to sessionStorage')\r\n    storage.setItem('localParticipantInformation', JSON.stringify(this.information))\r\n  }\r\n  @action.bound\r\n  loadInformationFromStorage() {\r\n    let storage = localStorage\r\n    if (sessionStorage.getItem('localParticipantInformation')) {\r\n      storage = sessionStorage\r\n    }\r\n    //  console.debug(storage === localStorage ? 'Load from localStorage' : 'Load from sessionStorage')\r\n    const infoInStr = storage.getItem('localParticipantInformation')\r\n    if (infoInStr) {\r\n      Object.assign(this.information, JSON.parse(infoInStr))\r\n    }\r\n  }\r\n\r\n  @action updateViewpointCenter(map: MapData){\r\n    const pos = map.toWindow(this.pose.position)\r\n    this.viewpoint.center = subV2(mulV2(0.5, map.screenSize), pos)\r\n  }\r\n\r\n  //  Save and MediaSettings etc.\r\n  saveMediaSettingsToStorage() {\r\n    const muteStatus:MediaSettings = {\r\n      stream:{\r\n        muteVideo: this.muteVideo,\r\n        muteAudio: this.muteAudio,\r\n        muteSpeaker: this.muteSpeaker,\r\n      },\r\n      device:this.devicePreference,\r\n      headphone: this.useStereoAudio,\r\n      soundLocalizationBase: this.soundLocalizationBase,\r\n      uploadPreference: this.uploaderPreference,\r\n    }\r\n    //  console.log(storage === localStorage ? 'Save to localStorage' : 'Save to sessionStorage')\r\n    localStorage.setItem('localParticipantStreamControl', JSON.stringify(muteStatus))\r\n    sessionStorage.setItem('localParticipantStreamControl', JSON.stringify(muteStatus))\r\n  }\r\n  @action.bound\r\n  loadMediaSettingsFromStorage(rv?: MediaSettings) {\r\n    const settingStrInLocal = localStorage.getItem('localParticipantStreamControl')\r\n    const settingStrInSession = sessionStorage.getItem('localParticipantStreamControl')\r\n    let settingLocal: MediaSettings|undefined = undefined\r\n    let settingSession: MediaSettings|undefined = undefined\r\n    if (settingStrInLocal) { settingLocal = JSON.parse(settingStrInLocal) as MediaSettings }\r\n    if (settingStrInSession) { settingSession = JSON.parse(settingStrInSession) as MediaSettings }\r\n    const setting = settingLocal\r\n    if (setting){\r\n      setting.stream.muteVideo = true\r\n      if (settingSession){ setting.stream.muteVideo = settingSession.stream.muteVideo }\r\n      if (rv){\r\n        Object.assign(rv, setting)\r\n      }else{\r\n        Object.assign(this, setting.stream)\r\n        Object.assign(this.devicePreference, setting.device)\r\n        this.useStereoAudio = setting.headphone\r\n        this.soundLocalizationBase = setting.soundLocalizationBase\r\n      }\r\n    }\r\n  }\r\n\r\n  //  Save and load physics\r\n  savePhysicsToStorage(isLocalStorage:boolean) {\r\n    let storage = sessionStorage\r\n    if (isLocalStorage) { storage = localStorage }\r\n    //  console.log(storage === localStorage ? 'Save to localStorage' : 'Save to sessionStorage')\r\n    const physics: PhysicsInfo = {\r\n      pose: this.pose,\r\n      physics: this.physics,\r\n    }\r\n    storage.setItem('localParticipantPhysics', JSON.stringify(physics))\r\n  }\r\n  @action.bound\r\n  loadPhysicsFromStorage() {\r\n    let storage = localStorage\r\n    if (sessionStorage.getItem('localParticipantPhysics')) {\r\n      storage = sessionStorage\r\n    }\r\n    //  console.debug(storage === localStorage ? 'Load from localStorage' : 'Load from sessionStorage')\r\n    const str = storage.getItem('localParticipantPhysics')\r\n    if (str) {\r\n      const physics = JSON.parse(str) as PhysicsInfo\r\n      Object.assign(this.physics, physics.physics)\r\n      Object.assign(this.pose, physics.pose)\r\n    }\r\n  }\r\n\r\n}\r\n","import {ISharedContent} from '@models/ISharedContent'\r\nimport {PlaybackParticipant as IPlaybackParticipant, RemoteInformation} from '@models/Participant'\r\nimport {action, makeObservable, observable} from 'mobx'\r\nimport {Store} from '../utils'\r\nimport {ParticipantBase, TrackStates} from './ParticipantBase'\r\n\r\n\r\nexport class PlaybackParticipant extends ParticipantBase implements Store<IPlaybackParticipant> {\r\n  information:RemoteInformation = this.information as RemoteInformation\r\n  informationReceived = false\r\n  @observable trackStates = new TrackStates()\r\n  @observable called = false\r\n  @observable inLocalsZone = false\r\n  @observable.ref closedZone: ISharedContent | undefined = undefined\r\n  @observable videoBlob: Blob|undefined\r\n  @observable audioBlob: Blob|undefined\r\n  lastDistance = 0\r\n  constructor(id:string) {\r\n    super()\r\n    makeObservable(this)\r\n    this.id = id\r\n  }\r\n  @action call(){\r\n    this.called = true\r\n  }\r\n}\r\n","import { ISharedContent } from '@models/ISharedContent'\r\nimport {RemoteInformation, RemoteParticipant as IRemoteParticipant} from '@models/Participant'\r\nimport {action, makeObservable, observable} from 'mobx'\r\nimport {Store} from '../utils'\r\nimport {ParticipantBase, TracksStore, TrackStates} from './ParticipantBase'\r\n\r\n\r\nexport class RemoteParticipant extends ParticipantBase implements Store<IRemoteParticipant> {\r\n  information:RemoteInformation = this.information as RemoteInformation\r\n  informationReceived = false\r\n  @observable.shallow tracks = new TracksStore()\r\n  @observable trackStates = new TrackStates()\r\n  @observable called = false\r\n  @observable inLocalsZone = false\r\n  @observable.ref closedZone: ISharedContent | undefined = undefined\r\n  lastDistance = 0\r\n  constructor(id:string) {\r\n    super()\r\n    makeObservable(this)\r\n    this.id = id\r\n  }\r\n  @action call(){\r\n    this.called = true\r\n  }\r\n}\r\n","import { PARTICIPANT_SIZE } from '@models/Participant'\r\nimport { TrackKind } from '@models/utils'\r\nimport {action, computed, makeObservable, observable} from 'mobx'\r\nimport {LocalParticipant} from './LocalParticipant'\r\nimport {PlaybackParticipant} from './PlaybackParticipant'\r\nimport {RemoteParticipant} from './RemoteParticipant'\r\n\r\nexport class Participants {\r\n  constructor() {\r\n    makeObservable(this)\r\n  }\r\n\r\n  @observable.shallow readonly remote = new Map<string, RemoteParticipant>()\r\n  local_ = observable.box(new LocalParticipant())\r\n  @observable.shallow readonly playback = new Map<string, PlaybackParticipant>()\r\n\r\n  @observable readonly yarnPhones = new Set<string>()\r\n  @observable yarnPhoneUpdated = false\r\n\r\n  @computed get count(): number {\r\n    return this.remote.size\r\n  }\r\n\r\n  @computed get local(): LocalParticipant {\r\n    return this.local_.get()\r\n  }\r\n\r\n  @computed get localId(): string {\r\n    return this.local.id\r\n  }\r\n\r\n  @action\r\n  setLocalId(id: string) {\r\n    this.local.id = id\r\n  }\r\n\r\n  @action\r\n  join(participantId: string) {\r\n    //  console.debug(`${participantId} join`)\r\n    const newParticipant = new RemoteParticipant(participantId)\r\n    newParticipant.physics.located = false\r\n    this.remote.set(participantId, newParticipant)\r\n    return newParticipant\r\n  }\r\n\r\n  @action\r\n  getOrCreateRemote(participantId: string){\r\n    let r = this.remote.get(participantId)\r\n    if (!r){\r\n      r = this.join(participantId)\r\n    }\r\n    return r\r\n  }\r\n  getRemote(participantId: string){\r\n    return this.remote.get(participantId)\r\n  }\r\n\r\n  @action\r\n  leave(participantId: string) {\r\n    this.remote.delete(participantId)\r\n  }\r\n\r\n  @action leaveAll(){\r\n    this.remote.clear()\r\n    this.setLocalId('')\r\n  }\r\n\r\n  find(participantId: string): LocalParticipant | RemoteParticipant | undefined {\r\n    if (participantId === this.localId) {\r\n\r\n      return this.local\r\n    }\r\n\r\n    const res = this.remote.get(participantId)\r\n\r\n    return res\r\n  }\r\n\r\n  getOrCreatePlayback(id: string){\r\n    let rv = this.playback.get(id)\r\n    if (!rv){\r\n      rv = new PlaybackParticipant(id)\r\n      this.playback.set(id, rv)\r\n    }\r\n\r\n    return rv\r\n  }\r\n  removePlayback(id:string){\r\n    return this.playback.delete(id)\r\n  }\r\n\r\n  addRemoteTrack(peer: string, track: MediaStreamTrack){\r\n    const participant = participants.getOrCreateRemote(peer)\r\n    if (track.kind === 'audio'){\r\n      participant.tracks.audio = track\r\n    }else{\r\n      participant.tracks.avatar = track\r\n    }\r\n  }\r\n  removeRemoteTrack(peer: string, kind: TrackKind){\r\n    const remote = this.remote.get(peer)\r\n    if (!remote) { return false }\r\n    if (kind === 'audio') {\r\n      remote.tracks.audio = undefined\r\n    } else {\r\n      remote.tracks.avatar = undefined\r\n    }\r\n    return true\r\n  }\r\n\r\n  isLocal(participantId: string) {\r\n    return participantId === this.localId\r\n  }\r\n\r\n  audibleArea(){\r\n    return [this.local.pose.position[0], this.local.pose.position[1], PARTICIPANT_SIZE * 7]\r\n  }\r\n}\r\n\r\nconst participants = new Participants()\r\ndeclare const d:any\r\nd.participants = participants\r\nexport default participants\r\n","import {t} from '@models/locales'\r\nimport participants from '@stores/participants/Participants'\r\nimport {action, makeObservable, observable} from 'mobx'\r\nimport { LocalParticipant } from './participants/LocalParticipant'\r\nimport { RemoteParticipant } from './participants/RemoteParticipant'\r\n\r\nexport type ChatMessageType = 'text' | 'log' | 'called' | 'callTo' | 'private'\r\nexport interface ChatMessageToSend{\r\n  msg:string, //  message\r\n  ts:number,  //  timestamp\r\n  to:string   //  send to\r\n}\r\nexport class ChatMessage {\r\n  type:ChatMessageType = 'text'\r\n  text\r\n  pid\r\n  name\r\n  avatarUrl\r\n  timestamp\r\n  colors\r\n  constructor(text:string, pid: string, name:string, avatarUrl:string,\r\n    colors:string[], timestamp: number, type:ChatMessageType) {\r\n    this.text = text\r\n    this.pid = pid\r\n    this.name = name\r\n    this.avatarUrl = avatarUrl\r\n    this.colors = colors\r\n    this.timestamp = timestamp\r\n    this.type = type\r\n  }\r\n}\r\n\r\nexport class Chat {\r\n  @observable messages:ChatMessage[] = []\r\n  @observable sendTo = ''\r\n\r\n  constructor() {\r\n    makeObservable(this)\r\n  }\r\n  @action limitMessages(){\r\n    const MESSAGES_MAX = 1000\r\n    if (chat.messages.length > MESSAGES_MAX){ chat.messages.splice(0, chat.messages.length - MESSAGES_MAX) }\r\n  }\r\n  @action addMessage(msg:ChatMessage){\r\n    this.messages.push(msg)\r\n    this.limitMessages()\r\n  }\r\n  participantNameChanged(pid:string, oldName: string){\r\n    const participant = participants.find(pid)\r\n    if (participant){\r\n      const cm = new ChatMessage('', participant.id, participant.information.name,\r\n        participant.information.avatarSrc, participant.getColor(), Date.now(), 'log')\r\n      cm.text = t('cmNameChanged', {old: oldName, new: cm.name})\r\n      this.addMessage(cm)\r\n    }\r\n  }\r\n  participantJoined(pid: string){\r\n    const participant = participants.find(pid)\r\n    if (participant){\r\n      const cm = new ChatMessage('', participant.id, participant.information.name,\r\n        participant.information.avatarSrc, participant.getColor(), Date.now(), 'log')\r\n      cm.text = t('cmJoined', {name:cm.name})\r\n      this.addMessage(cm)\r\n    }\r\n  }\r\n  participantLeft(pid: string){\r\n    const participant = participants.find(pid)\r\n    if (participant){\r\n      const cm = new ChatMessage('', participant.id, participant.information.name,\r\n        participant.information.avatarSrc, participant.getColor(), Date.now(), 'log')\r\n      cm.text = t('cmLeft', {name:cm.name})\r\n      this.addMessage(cm)\r\n    }\r\n  }\r\n  calledBy(from: RemoteParticipant|LocalParticipant){\r\n    const cm = new ChatMessage('', from.id, from.information.name,\r\n    from.information.avatarSrc, from.getColor(), Date.now(), 'called')\r\n    cm.text = t('cmCallBy', {name:cm.name})\r\n    this.addMessage(cm)\r\n  }\r\n  callTo(to: RemoteParticipant|LocalParticipant){\r\n    const cm = new ChatMessage('', to.id, to.information.name,\r\n    to.information.avatarSrc, to.getColor(), Date.now(), 'callTo')\r\n    cm.text = t('cmCallTo', {name:cm.name})\r\n    this.addMessage(cm)\r\n  }\r\n}\r\n\r\nconst chat = new Chat()\r\nexport default chat\r\n","//  messages forward only when participants are in the range.\r\nexport const ParticipantMessageType = {\r\n  PARTICIPANT_AFK: 'p_afk',                     //  boolean\r\n  PARTICIPANT_TRACKSTATES: 'p_trackSt',         //  TrackStates\r\n  PARTICIPANT_VIEWPOINT: 'p_viewpoint',         //  Viewpoint\r\n}\r\nexport type ParticipantMessageKeys = keyof typeof ParticipantMessageType\r\n\r\nexport const PoseMessageType = {\r\n  PARTICIPANT_POSE: 'mp',                       //  special text, -> presence and message\r\n  PARTICIPANT_MOUSE: 'mm',                      //  special text, -> presence and message\r\n  PARTICIPANT_ON_STAGE: 'p_onStage',            //  boolean\r\n}\r\n\r\nexport const StoredMessageType = {\r\n  ...ParticipantMessageType,\r\n  PARTICIPANT_INFO: 'p_info',                   //  RemoteInformation, -> presence\r\n  PARTICIPANT_VRMRIG: 'p_vrm',\r\n}\r\n\r\nexport type StoredMessageKeys = keyof typeof StoredMessageType\r\n\r\nexport const InstantMessageType = {\r\n  PARTICIPANT_TRACKLIMITS: 'm_track_limits',    //  [number, number], message, Usually not used.\r\n  YARN_PHONE: 'YARN_PHONE',                     //  pids[] -> message\r\n  CHAT_MESSAGE: 'm_chat',                       //  ChatMessageToSend, -> text chat message\r\n  CALL_REMOTE: 'call_remote',                   //  pid:string, give notification to a remote user.\r\n  MUTE_VIDEO: 'm_mute_video',                   //  boolean, ask to mute video\r\n  MUTE_AUDIO: 'm_mute_audio',                   //  boolean, ask to mute audio\r\n  AUDIO_LEVEL: 'm_audio_level',                 //  audio level notification\r\n  RELOAD_BROWSER: 'm_reload',                   //  not used, ask to reload browser\r\n  KICK: 'm_kick',                               //  reason:string\r\n}\r\nexport type InstantMessageKeys = keyof typeof InstantMessageType\r\nexport const InstantMessageTypes = new Set(Object.values(InstantMessageType))\r\n\r\n\r\n//  messages which can be merged.\r\nexport const ObjectArrayMessageType = {\r\n  CONTENT_UPDATE_REQUEST: 'c_update',     //  IShraedContent[]\r\n  CONTENT_INFO_UPDATE: 'c_info_update',   //  SharedContentInfo[], only bmRelayServer to clients.\r\n}\r\nexport const ObjectArrayMessageTypes = new Set(Object.values(ObjectArrayMessageType))\r\n\r\nexport const StringArrayMessageType = {\r\n  CONTENT_REMOVE_REQUEST: 'c_remove',             //  ids:string[]\r\n  PARTICIPANT_OUT: 'p_out',                       //  ids:stirng[], server to client only\r\n  MOUSE_OUT: 'm_out',                             //  ids:stirng[], server to client only\r\n  CONTENT_OUT: 'c_out',                           //  ids:stirng[], server to client only\r\n}\r\nexport const StringArrayMessageTypes = new Set(Object.values(StringArrayMessageType))\r\n\r\nexport const ClientToServerOnlyMessageType = {\r\n  CONTENT_UPDATE_REQUEST_BY_ID: 'c_update_by_id', //  cids:string[],\r\n  REQUEST_ALL: 'req_all',                       //  request all stored information\r\n  REQUEST_RANGE: 'req_range', //  rect:number[4], circle:number[3]. request updated message related to the range\r\n  REQUEST_PARTICIPANT_STATES: 'req_p_state',    //  -> message, to get states to display participant\r\n}\r\n\r\nexport const MessageType = {\r\n  ...ObjectArrayMessageType,\r\n  ...StringArrayMessageType,\r\n  ...InstantMessageType,\r\n  ...StoredMessageType,\r\n  ...PoseMessageType,\r\n  ...ClientToServerOnlyMessageType,\r\n\r\n  //  special\r\n  PARTICIPANT_LEFT: 'm_participant_left',       //  id:string,  remove info\r\n  ROOM_PROP:  'room_prop',                      //  [name:string, value:string], set room property\r\n  REQUEST_TO: 'req_to',                         //  ids:string[], request for info of specific participant\r\n\r\n  //  only for JVB\r\n  FRAGMENT_HEAD: 'frag_head',\r\n  FRAGMENT_CONTENT: 'frag_cont',\r\n}\r\nexport type MessageKeys = keyof typeof MessageType\r\n","import {MapObject} from './MapObject'\r\nconst MAXIMIZABLE_IMAGE_MIN_WIDTH = 200\r\n\r\n//export type ContentType = 'img' | 'text' | 'pdf' | 'youtube' | 'iframe' | 'screen' | 'camera' |\r\n//  'gdrive' | 'whiteboard' | 'playbackScreen' | 'playbackCamera' |  ''\r\nexport type ContentType = 'img' | 'text' | 'pdf' | 'youtube' | 'iframe' | 'screen' | 'camera' |\r\n  'gdrive' | 'whiteboard' | 'playbackScreen' | 'playbackCamera' | 'chat' | 'content' |  ''\r\n\r\nexport interface SharedContentInfoData {\r\n  name: string                    //  name or title of the content.\r\n  ownerName: string               //  name of the initial owner\r\n  ownerURL: string                //  url of the initial owner\r\n  color:number[]                  //  color in the left var\r\n  textColor:number[]              //  textColor in the left var\r\n  type: ContentType               //  content type ('img', etc)\r\n  shareType:string                // share type\r\n  contentDesc:string              // for room description\r\n  baseImage:string                // for app base image\r\n  baseIcon:string                 // for app icon\r\n  baseColor:string                // right panel bg color\r\n}\r\nexport interface SharedContentId{\r\n  id: string                      //  unique ID (generated by participant id + number)\r\n}\r\nexport interface SharedContentInfo extends SharedContentInfoData, SharedContentId{\r\n}\r\nexport function isEqualSharedContentInfo(a:SharedContentInfo, b:SharedContentInfo){\r\n  return a.name === b.name && a.ownerName === b.ownerName && a.ownerURL === b.ownerURL\r\n    && a.color.toString() === b.color.toString() && a.textColor.toString() === b.textColor.toString() && a.contentDesc.toString() === b.contentDesc.toString() && a.baseImage.toString() === b.baseImage.toString() && a.baseIcon.toString() === b.baseIcon.toString() && a.baseColor.toString() === b.baseColor.toString()\r\n}\r\nexport function extractSharedContentInfo(c: SharedContentInfo){\r\n  const rv:SharedContentInfo = {id:c.id, name: c.name, ownerName: c.ownerName, ownerURL: c.ownerURL,\r\n    color:c.color, textColor: c.textColor, type: c.type, shareType: c.shareType, contentDesc: c.contentDesc, baseImage:c.baseImage, baseIcon:c.baseIcon, baseColor:c.baseColor}\r\n\r\n  return rv\r\n}\r\n\r\nexport type ZoneType = 'open' | 'close'\r\n\r\nexport interface SharedContentDataToSend extends SharedContentInfoData {\r\n  zorder: number                  //  unix timestamp when shared or moved to top.\r\n  url: string                     //  url or text to share\r\n  size: [number, number]          //  current size of the content\r\n  originalSize: [number, number]  //  original size of the content or [0, 0]\r\n  pinned: boolean                //  pinned (not resizable or resizable)\r\n  noFrame?: boolean               //  no (invisible) frame\r\n  opacity?: number                //  opacity\r\n  zone?: ZoneType                 //  is this a audio zone is the zone closed or open?\r\n  // New\r\n  showTitle:boolean               // for showing the title\r\n  showStopWatch:boolean           // for showing stop watch\r\n  stopWatchToggle:boolean         // storing stop watch time toggle\r\n  stopWatchReset:boolean          // Reset the stopwatch\r\n  scaleRotateToggle:boolean       // for scaling and rotation\r\n}\r\n\r\nexport interface SharedContentData extends SharedContentDataToSend {\r\n  playback?: boolean                  //  is playback or normal content\r\n  zIndex?: number                     //  zIndex for display\r\n  overlapZones: ISharedContent[]      //  other zones overlap this\r\n  surroundingZones: ISharedContent[]  //  surrounded zones\r\n}\r\n\r\nexport interface ISharedContent extends MapObject, SharedContentData, SharedContentId {\r\n}\r\nexport interface ISharedContentToSend extends MapObject, SharedContentDataToSend, SharedContentId {\r\n}\r\nexport interface ISharedContentToSave extends MapObject, SharedContentDataToSend{\r\n}\r\nexport interface IPlaybackContent extends ISharedContent{\r\n  audioBlob?: Blob\r\n  videoBlob?: Blob\r\n}\r\n\r\nexport function contentsToSend(them: ISharedContent[]) {\r\n  for(const content of them){\r\n    const c = content as any\r\n    delete c.playback\r\n    delete c.zIndex\r\n    delete c.zones\r\n  }\r\n  return them as ISharedContentToSend[]\r\n}\r\nexport function receiveToContents(them: ISharedContentToSend[]) {\r\n  for(const content of them){\r\n    const c = content as ISharedContent\r\n    c.overlapZones = []\r\n    c.surroundingZones = []\r\n  }\r\n  return them as ISharedContent[]\r\n}\r\nexport function contentsToSave(them: ISharedContent[]) {\r\n  for(const content of them){\r\n    const c = content as any\r\n    delete c.playback\r\n    delete c.zIndex\r\n    delete c.zones\r\n    delete c.id\r\n  }\r\n  return them as ISharedContentToSave[]\r\n}\r\nexport function loadToContents(them: ISharedContentToSend[]) {\r\n  return receiveToContents(them)\r\n}\r\n\r\nexport const TIME_RESOLUTION_IN_MS = 100\r\nexport const TEN_YEAR = 1000 * 60 * 60 * 24 * 365 * 10 / TIME_RESOLUTION_IN_MS\r\n\r\n//  Does content use keyinput during editing or not.\r\nexport function doseContentEditingUseKeyinput(c: ISharedContent){\r\n  return c.type === 'text' || c.type === 'pdf'\r\n}\r\n//  can this type of content be a wall paper or not\r\nexport function canContentBeAWallpaper(c?: ISharedContent){\r\n  return c && (c.type !== 'camera' && c.type !== 'screen')\r\n}\r\n//  editable or not\r\nexport function isContentEditable(c?: ISharedContent) {\r\n  return c && (c.type === 'text' || c.type === 'iframe' || c.type === 'pdf' ||\r\n    c.type === 'whiteboard' || c.type === 'gdrive' || c.type === 'youtube')\r\n}\r\n//  maximizable or not\r\nexport function isContentMaximizable(c?: ISharedContent) {\r\n  return c && (c.type === 'iframe' || c.type === 'pdf' || c.type === 'whiteboard' ||\r\n    c.type === 'gdrive' || c.type === 'youtube' || c.type === 'screen' || c.type === 'camera'\r\n    ||  (c.type === 'img' && c.size[0] > MAXIMIZABLE_IMAGE_MIN_WIDTH))\r\n}\r\n//  wallpaper or not\r\nexport function isContentWallpaper(c?: ISharedContent) {\r\n  return c && c.zorder <= TEN_YEAR\r\n}\r\nexport const CONTENT_OUT_OF_RANGE_VALUE = 1024*1024\r\nexport function isContentOutOfRange(c?: ISharedContent) {\r\n  return !c || c.pose.position[0] === CONTENT_OUT_OF_RANGE_VALUE\r\n}\r\nexport function isContentRtc(c?: SharedContentInfoData){\r\n  return c && (c.type === 'camera' || c.type === 'screen')\r\n}\r\n\r\nexport interface WallpaperStore {\r\n  room: string\r\n  contents: SharedContentData[]\r\n}\r\n\r\nexport interface TextMessage {\r\n  message: string, //  text to display\r\n  name: string, //  The name of whom create this text\r\n  color?:number[]        //  background color\r\n  textColor?:number[]    //  textColor\r\n  pid: string,  //  The pid of whom create this text\r\n  time: number, //  Timestamp when this message created.\r\n}\r\nexport interface TextMessages {\r\n  messages: TextMessage[]\r\n  scroll: [number, number]\r\n}\r\n\r\nexport function compTextMessage(t1: TextMessage, t2: TextMessage) {\r\n  return t1.time - t2.time\r\n}\r\n","// config.js\r\ndeclare const config:any             //  from ../../config.js included from index.html\r\nexport const CORS_PROXY_URL = config.corsProxyUrl || 'https://binaural.me/cors_proxy/'\r\n\r\nexport function getProxiedUrl(url:string){\r\n  const heads = ['http://', 'https://']\r\n  let rv = url\r\n  heads.forEach((head) => {\r\n    if (url.substring(0, head.length) === head){\r\n      rv = url.substring(head.length)\r\n    }\r\n  })\r\n  rv = `${CORS_PROXY_URL}${rv}`\r\n\r\n  return rv\r\n}\r\n","/**\r\n * Abstract class to store base Google credentials\r\n */\r\nclass GoogleDrive {\r\n  private clientId: string\r\n  private clientSecret: string\r\n  private appId: string\r\n  private apiToken: string\r\n  private scopes: string[]\r\n\r\n  private loadState = 0\r\n\r\n  constructor(\r\n    clientId=\"858773398697-vki2lito392c5dlss9s31ap077nn0qbd.apps.googleusercontent.com\",\r\n    clientSecret='',\r\n    appId='binarual-meet',\r\n    apiToken='AIzaSyAADCXxUujmh0VqXIzJofwl03MA5O8v8EQ', scopes=['https://www.googleapis.com/auth/drive.file']) {\r\n    this.clientId = clientId\r\n    this.clientSecret = clientSecret\r\n    this.appId = appId\r\n    this.apiToken=apiToken\r\n    this.scopes = scopes\r\n    // while (!gapi) {\r\n    //   //gapi is loading lock until done\r\n    //   console.log('D: loading gapi')\r\n    // }\r\n    gapi.load('auth', {'callback': this.onAuthApiLoad.bind(this)})\r\n    // while (this.loadState<2) {\r\n    //   //apis still loading\r\n    //   console.log('D: loading gapi APIs')\r\n    // }\r\n  }\r\n\r\n\r\n  private onAuthApiLoad() {\r\n    this.loadState++\r\n    gapi.client.load('drive', 'v3',this.onDriveLoad.bind(this))\r\n  }\r\n  private onDriveLoad() {\r\n    this.loadState++\r\n  }\r\n\r\n  private async login() {\r\n    const res = await new Promise((resolve, reject)=>{\r\n      console.log(gapi.auth);\r\n      gapi.auth.authorize(\r\n        {\r\n          'client_id': this.clientId,\r\n          'scope': this.scopes,\r\n          'immediate': true\r\n        },\r\n        (r)=>r.error?gapi.auth.authorize(\r\n          {\r\n            'client_id': this.clientId,\r\n            'scope': this.scopes,\r\n            'immediate': false\r\n          },\r\n          (k)=>k.error?reject(k):resolve(k)):resolve(r))\r\n    })\r\n    console.log(res)\r\n  }\r\n\r\n  /**\r\n   * uploadFileToGoogleDrive with autogenerated name\r\n   */\r\n  public async uploadFileToGoogleDrive(file: File) {\r\n    await this.login()\r\n\r\n    //upsert custom folder (to be a little more organized 😊)\r\n    const {result:{files}} = await gapi.client.drive.files.list({\r\n      q:\"name='Earshot Chat Files' and mimeType='application/vnd.google-apps.folder' and not trashed=true\"\r\n    })\r\n\r\n    let dirId=''\r\n    if(!files?.length){\r\n      var fileMetadata = {\r\n        'name' : 'Earshot Chat Files',\r\n        'mimeType' : 'application/vnd.google-apps.folder',\r\n      }\r\n      const directoryResponse = await gapi.client.drive.files.create({\r\n        resource: fileMetadata,\r\n      })\r\n      dirId =JSON.parse(directoryResponse.body).id\r\n    }\r\n    else{\r\n      dirId = files[0].id || ''\r\n    }\r\n\r\n    //store the file\r\n\r\n    const metadata = {\r\n        name: file.name,\r\n        mimeType: file.type,\r\n        parents: [dirId], // Please set folderId here.\r\n    }\r\n    const form = new FormData()\r\n    form.append('metadata', new Blob([JSON.stringify(metadata)], {type: 'application/json'}))\r\n    form.append('file', file)\r\n    const fileUploadResponse = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {\r\n      method: 'POST',\r\n      headers: new Headers({'Authorization': 'Bearer ' + gapi.auth.getToken().access_token}),\r\n      body: form\r\n    }).then((res) => {\r\n      return res.json()\r\n    })\r\n\r\n    await gapi.client.drive.permissions.create({\r\n      fileId: fileUploadResponse.id,\r\n      resource: {\r\n        role: 'reader',\r\n        type: 'anyone',\r\n      }\r\n    } as any)\r\n\r\n  //   const webViewLink = await gapi.client.drive.files.get({\r\n  //     fileId: res.id,\r\n  //     fields: 'webViewLink'\r\n  // }).then(response =>\r\n  //     JSON.parse(response.body).webViewLink\r\n  // );\r\n    return `https://drive.google.com/uc?export=view&id=${fileUploadResponse.id}`\r\n  }\r\n}\r\n\r\n\r\n//always export a default instance\r\nexport default new GoogleDrive()","export interface GayazoReturnType{\r\n  url: string,\r\n  size: [number, number],\r\n}\r\nexport function uploadToGyazo(imageData: Blob):Promise<string> {\r\n  const promise = new Promise<string>((resolutionFunc, rejectionFunc) => {\r\n    const formData = new FormData()\r\n    formData.append('access_token', 'e9889a51fca19f2712ec046016b7ec0808953103e32cd327b91f11bfddaa8533')\r\n    formData.append('imagedata', imageData)\r\n    fetch('https://upload.gyazo.com/api/upload', {method: 'POST', body: formData})\r\n    .then(response => response.json())\r\n    .then((responseJson) => {\r\n      // console.log(\"URL = \" + responseJson.url)\r\n      //  To do, add URL and ask user position to place the image\r\n      resolutionFunc(responseJson.url)\r\n    })\r\n    .catch((error) => {\r\n      if (`${error}` === 'TypeError: Failed to fetch'){\r\n        rejectionFunc('type')\r\n      }else{\r\n        console.error(error)\r\n        rejectionFunc('')\r\n      }\r\n    })\r\n  })\r\n\r\n  return promise\r\n}\r\n\r\nexport function getImageSize(url: string) {\r\n  const promise = new Promise<[number, number]>((resolutionFunc, rejectionFunc) => {\r\n    const img = new Image()\r\n    img.src = url\r\n    img.onload = () => {\r\n      const size:[number, number] = [img.width, img.height]\r\n      resolutionFunc(size)\r\n    }\r\n    img.onerror = () => { rejectionFunc([0, 0]) }\r\n  })\r\n\r\n  return promise\r\n}\r\n","import {getProxiedUrl} from '@models/api/CORS'\r\nimport GoogleDrive from '@models/api/GoogleDrive'\r\nimport {getImageSize, uploadToGyazo} from '@models/api/Gyazo'\r\nimport {ContentType, isContentWallpaper, ISharedContent, TEN_YEAR, TextMessages,\r\n   TIME_RESOLUTION_IN_MS} from '@models/ISharedContent'\r\nimport {Pose2DMap} from '@models/utils'\r\nimport { getMimeType } from '@models/utils'\r\nimport {isSelfUrl} from '@models/utils'\r\nimport {MapData} from '@stores/Map'\r\nimport {defaultValue as mapObjectDefaultValue} from '@stores/MapObject'\r\nimport _ from 'lodash'\r\nimport participants from '../participants/Participants'\r\nimport sharedContents, {contentLog} from './SharedContents'\r\nimport { Step } from '@components/footer/share/Step'\r\n\r\nexport const defaultContent: ISharedContent = Object.assign({}, mapObjectDefaultValue, {\r\n  name: '',\r\n  ownerName: '',\r\n  ownerURL: '',\r\n  color: [],\r\n  textColor: [],\r\n  type: '' as ContentType,\r\n  url: '',\r\n  size: [0, 0] as [number, number],\r\n  originalSize: [0, 0] as [number, number],\r\n  id: '',\r\n  zorder: 0,\r\n  pinned: false,\r\n  overlapZones:[],\r\n  surroundingZones:[],\r\n\r\n  // New Addition\r\n  shareType: '',\r\n  showTitle: false,\r\n  contentDesc: '',\r\n  showStopWatch: false,\r\n  stopWatchToggle: false,\r\n  stopWatchReset: false,\r\n  scaleRotateToggle: false,\r\n  baseImage: '',\r\n  baseIcon: '',\r\n  baseColor: '',\r\n})\r\n\r\nclass SharedContentImp implements ISharedContent {\r\n  name!: string\r\n  ownerName!: string\r\n  ownerURL!: string\r\n  color!: number[]\r\n  textColor!: number[]\r\n  type!: ContentType\r\n  url!: string\r\n  id!: string\r\n  zorder!: number\r\n  pinned!: boolean\r\n  pose!: Pose2DMap\r\n  size!: [number, number]\r\n  overlapZones!: ISharedContent[]\r\n  surroundingZones!: ISharedContent[]\r\n  originalSize!:[number, number]\r\n  noFrame?: boolean\r\n  opacity?: number\r\n  shareType!: string\r\n  showTitle!: boolean\r\n  contentDesc!: string\r\n  showStopWatch!: boolean\r\n  stopWatchToggle!: boolean\r\n  stopWatchReset!: boolean\r\n  scaleRotateToggle!: boolean\r\n  baseImage!: string\r\n  baseIcon!: string\r\n  baseColor!:string\r\n  constructor() {\r\n    Object.assign(this, _.cloneDeep(defaultContent))\r\n  }\r\n}\r\n\r\nexport function createContent() {\r\n  const content = new SharedContentImp()\r\n  content.ownerName = participants.local.information.name\r\n  content.color = participants.local.information.color\r\n  content.textColor = participants.local.information.textColor\r\n  content.ownerURL = participants.local.information.avatarSrc\r\n  content.zorder = Date.now()\r\n\r\n  return content\r\n}\r\n\r\nfunction makeItPdf(pasted:ISharedContent, urlStr: string, map:MapData){\r\n  pasted.type = 'pdf'\r\n  pasted.url = urlStr\r\n  pasted.pose.position[0] = map.mouseOnMap[0]\r\n  pasted.pose.position[1] = map.mouseOnMap[1]\r\n  pasted.size[0] = 500\r\n  pasted.size[1] = pasted.size[0] * 1.41421356\r\n}\r\n\r\nexport function createContentOfIframe(urlStr: string, map: MapData, xCord:number, yCord:number, from:string) {\r\n  return new Promise<ISharedContent>((resolve, reject) => {\r\n    const pasted = createContent()\r\n    const url = new URL(urlStr)\r\n    if (url.hostname === 'youtu.be' || url.hostname === 'youtube.com' || url.hostname === 'www.youtube.com') {\r\n      const paramStrs = url.search.slice(1).split('&')\r\n      const params = new Map<string, string>(paramStrs.map(str => str.split('=') as [string, string]))\r\n      if (url.hostname === 'youtu.be') {\r\n        params.set('v', url.pathname.slice(1))\r\n      }\r\n      pasted.url = ''\r\n      for (const param of params) {\r\n        if (pasted.url === '') {\r\n          pasted.url = `${param[0]}=${param[1]}`\r\n        }else {\r\n          pasted.url = `${pasted.url}&${param[0]}=${param[1]}`\r\n        }\r\n      }\r\n      pasted.type = 'youtube'\r\n      if(from === 'contextmenu') {\r\n        pasted.pose.position[0] = Number(xCord)\r\n        pasted.pose.position[1] = Number(yCord)\r\n      } else {\r\n        pasted.pose.position[0] = map.mouseOnMap[0]\r\n        pasted.pose.position[1] = map.mouseOnMap[1]\r\n      }\r\n      pasted.size[0] = 640\r\n      pasted.size[1] = 380\r\n    }else if (url.hostname === 'drive.google.com' || url.hostname === 'docs.google.com') {  //  google drive\r\n      pasted.type = 'gdrive'\r\n      const fileIdStart = url.pathname.slice(url.pathname.indexOf('/d/') + 3)\r\n      const fileId = fileIdStart.slice(0, fileIdStart.indexOf('/'))\r\n      pasted.url = `id=${fileId}`\r\n      pasted.pose.position[0] = map.mouseOnMap[0]\r\n      pasted.pose.position[1] = map.mouseOnMap[1]\r\n      pasted.size[0] = 900\r\n      pasted.size[1] = 700\r\n    }else if (url.hostname === 'wbo.ophir.dev'){  //  whiteboard\r\n      pasted.type = 'whiteboard'\r\n      pasted.url = urlStr\r\n      pasted.pose.position[0] = map.mouseOnMap[0]\r\n      pasted.pose.position[1] = map.mouseOnMap[1]\r\n      pasted.size[0] = 700\r\n      pasted.size[1] = 740\r\n    }else if (url.pathname.substring(url.pathname.length-4) === '.pdf' ||\r\n      url.pathname.substring(url.pathname.length-4) === '.PDF' ){  //  pdf\r\n      makeItPdf(pasted, urlStr, map)\r\n    }else {  //  generic iframe\r\n      //  get mime type first\r\n      getMimeType(getProxiedUrl(urlStr)).then((type)=>{\r\n        if (type==='application/pdf'){\r\n          makeItPdf(pasted, urlStr, map)\r\n          resolve(pasted)\r\n        }\r\n      }).finally(()=>{\r\n        if (!pasted.type){\r\n          pasted.type = 'iframe'\r\n          pasted.url = urlStr\r\n          pasted.pose.position[0] = map.mouseOnMap[0]\r\n          pasted.pose.position[1] = map.mouseOnMap[1]\r\n          pasted.size[0] = 600\r\n          pasted.size[1] = 800\r\n          resolve(pasted)\r\n        }\r\n      })\r\n    }\r\n    if (pasted.type){\r\n      resolve(pasted)\r\n      contentLog(`${pasted.type} created url = ${pasted.url}`)\r\n    }\r\n})\r\n}\r\nexport function createContentOfText(message: string, map: MapData, xCord:number, yCord:number, from:string) {\r\n  const pasted = createContent()\r\n  pasted.type = 'text'\r\n  const textMessage = {\r\n    message,\r\n    pid: participants.localId,\r\n    name: participants.local.information.name,\r\n    color: participants.local.information.color,\r\n    textColor: participants.local.information.textColor,\r\n    time: Date.now(),\r\n  }\r\n  const texts: TextMessages = {messages:[textMessage], scroll:[0, 0]}\r\n  pasted.url = JSON.stringify(texts)\r\n  if(from === 'contextmenu') {\r\n    pasted.pose.position[0] = Number(xCord)\r\n    pasted.pose.position[1] = Number(yCord)\r\n  } else {\r\n    pasted.pose.position[0] = map.mouseOnMap[0]\r\n    pasted.pose.position[1] = map.mouseOnMap[1]\r\n  }\r\n  const slen = Math.ceil(Math.sqrt(message.length))\r\n  const STRING_SCALE_W = 20\r\n  const STRING_SCALE_H = 25\r\n  pasted.size[0] = Math.max(slen * STRING_SCALE_W, 200)\r\n  pasted.size[1] = Math.max(slen * STRING_SCALE_H, slen ? STRING_SCALE_H : STRING_SCALE_H * 3)\r\n\r\n  return pasted\r\n}\r\nexport function createContentOfTextOnly(message: string, map: MapData, xCord:number, yCord:number, from:string) {\r\n  //console.log(xCord, \" --- \", yCord, \" : \", from)\r\n  const pasted = createContent()\r\n  pasted.type = 'text'\r\n  pasted.shareType = 'text'\r\n  pasted.noFrame = true\r\n  //pasted.pinned = true\r\n  const textMessage = {\r\n    message,\r\n    pid: participants.localId,\r\n    name: participants.local.information.name,\r\n    color: participants.local.information.color,\r\n    textColor: participants.local.information.textColor,\r\n    time: Date.now(),\r\n  }\r\n  const texts: TextMessages = {messages:[textMessage], scroll:[0, 0]}\r\n  pasted.url = JSON.stringify(texts)\r\n\r\n\r\n  if(from === 'contextmenu') {\r\n    pasted.pose.position[0] = Number(xCord)\r\n    pasted.pose.position[1] = Number(yCord)\r\n  } else {\r\n    pasted.pose.position[0] = map.mouseOnMap[0]\r\n    pasted.pose.position[1] = map.mouseOnMap[1]\r\n  }\r\n  const slen = Math.ceil(Math.sqrt(message.length))\r\n  const STRING_SCALE_W = 20\r\n  const STRING_SCALE_H = 25\r\n  pasted.size[0] = Math.max(slen * STRING_SCALE_W, 200)\r\n  pasted.size[1] = Math.max(slen * STRING_SCALE_H, slen ? STRING_SCALE_H : STRING_SCALE_H * 3)\r\n  return pasted\r\n}\r\n\r\nexport function createContentOfImage(imageFile: File, map: MapData, offset?:[number, number], uploadType?: \"gyazo\" | \"gdrive\", _type?:Step, xCord?:number, yCord?:number, from?:string, desc?:string)\r\n  : Promise<SharedContentImp> {\r\n  const promise = new Promise<SharedContentImp>((resolutionFunc, rejectionFunc) => {\r\n    if (!uploadType || uploadType === 'gyazo'){\r\n      uploadToGyazo(imageFile).then((url) => {\r\n        createContentOfImageUrl(url, map, offset, _type, xCord, yCord, from, desc).then(resolutionFunc)\r\n      }).catch((error) => {\r\n        if (error === 'type'){\r\n          GoogleDrive.uploadFileToGoogleDrive(imageFile).then((url) => {\r\n            createContentOfImageUrl(url, map, offset, _type, xCord, yCord, from, desc).then(resolutionFunc)\r\n          }).catch(rejectionFunc)\r\n        }else{\r\n          rejectionFunc(error)\r\n        }\r\n      })\r\n    }else{\r\n      GoogleDrive.uploadFileToGoogleDrive(imageFile).then((url) => {\r\n        createContentOfImageUrl(url, map, offset, _type, xCord, yCord, from, desc).then(resolutionFunc).catch(rejectionFunc)\r\n      })\r\n    }\r\n  })\r\n\r\n  return promise\r\n}\r\n\r\nexport function createContentOfImageUrl(url: string, map: MapData,\r\n  offset?:[number, number], _type?:Step, xCord?:number, yCord?:number, from?:string, desc?:string): Promise<SharedContentImp> {\r\n  //const IMAGESIZE_LIMIT = 500\r\n  const promise = new Promise<SharedContentImp>((resolutionFunc, rejectionFunc) => {\r\n    getImageSize(url).then((size) => {\r\n      // console.log(\"mousePos:\" + (global as any).mousePositionOnMap)\r\n      const pasted = createContent()\r\n      pasted.type = 'img'\r\n\r\n      if(_type === \"image\") {\r\n        pasted.shareType = \"img\"\r\n      } else if(_type === \"zoneimage\") {\r\n        pasted.shareType = 'zoneimg'\r\n      } else if(_type === \"roomImage\") {\r\n        pasted.shareType = 'roomimg'\r\n      }\r\n      // Assign the desc values of content uploaded to differentiate between the images/room image\r\n      pasted.contentDesc = String(desc?.toString())\r\n      pasted.noFrame = true\r\n      // For EDIT Mode\r\n      //pasted.pinned = true\r\n      pasted.scaleRotateToggle = true\r\n\r\n      pasted.url = url\r\n      //const max = size[0] > size[1] ? size[0] : size[1]\r\n      //const scale = max > IMAGESIZE_LIMIT ? IMAGESIZE_LIMIT / max : 1\r\n      //pasted.size = [size[0] * scale, size[1] * scale]\r\n      pasted.size = [size[0], size[1]]\r\n      pasted.originalSize = [size[0], size[1]]\r\n      const CENTER = 0.5\r\n      for (let i = 0; i < pasted.pose.position.length; i += 1) {\r\n        if (offset) {\r\n          if(from === 'contextmenu') {\r\n            pasted.pose.position[0] = Number(xCord)\r\n            pasted.pose.position[1] = Number(yCord)\r\n          } else {\r\n            pasted.pose.position[i] = map.mouseOnMap[i] + offset[i]\r\n          }\r\n        }else {\r\n          pasted.pose.position[i] = map.mouseOnMap[i] - CENTER * pasted.size[i]\r\n        }\r\n      }\r\n      resolutionFunc(pasted)\r\n    })\r\n  })\r\n\r\n  return promise\r\n}\r\n\r\ndeclare const gapi:any    //  google api from index.html\r\nlet GoogleAuth:any        // Google Auth object.\r\n//  let isAuthorized = false\r\nfunction updateSigninStatus(isSignedIn:boolean) {\r\n  if (isSignedIn) {\r\n    //  isAuthorized = true\r\n  } else {\r\n    //isAuthorized = false\r\n  }\r\n}\r\n\r\nexport function createContentOfPdf(file: File, map: MapData, offset?:[number, number]): Promise<SharedContentImp> {\r\n  console.error('createContentOfPdf called.')\r\n  const promise = new Promise<SharedContentImp>((resolutionFunc, rejectionFunc) => {\r\n    if (gapi) {\r\n      const API_KEY = 'AIzaSyCE4B2cKycH0fVmBznwfr1ynnNf2qNEU9M'\r\n      const CLIENT_ID = '188672642721-3f8u1671ecugbl2ukhjmb18nv283upm0.apps.googleusercontent.com'\r\n      gapi.client.init(\r\n        {\r\n          apiKey: API_KEY,\r\n          clientId: CLIENT_ID,\r\n          scope: 'https://www.googleapis.com/auth/drive.appdata',\r\n          discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'],\r\n        },\r\n      ).then(\r\n        () => {\r\n          console.log('Before getAuthInstance')\r\n          GoogleAuth = gapi.auth2.getAuthInstance()\r\n          // Listen for sign-in state changes.\r\n          console.log('Before listen updateSigninStatus')\r\n          GoogleAuth.isSignedIn.listen(updateSigninStatus)\r\n        },\r\n        (reason:any) => {\r\n          console.log('gapi.client.init failed:', reason)\r\n        },\r\n      )\r\n    }\r\n  })\r\n\r\n  return promise\r\n}\r\n\r\n\r\nexport function createContentOfVideo(tracks: MediaStreamTrack[], map: MapData, type:ContentType, xCord:number, yCord:number, from:string) {\r\n  const pasted = createContent()\r\n  pasted.type = type\r\n  pasted.url = ''\r\n  if(from === 'contextmenu') {\r\n    pasted.pose.position[0] = Number(xCord)\r\n    pasted.pose.position[1] = Number(yCord)\r\n  } else {\r\n    pasted.pose.position[0] = map.mouseOnMap[0]\r\n    pasted.pose.position[1] = map.mouseOnMap[1]\r\n  }\r\n  const track = tracks.find(track => track.kind === 'video')\r\n  const settings = track?.getSettings()\r\n  if (settings) {\r\n    pasted.originalSize = [settings.width || 0, settings.height || 0]\r\n  }else {\r\n    pasted.originalSize = [0, 0]\r\n  }\r\n  pasted.size = [(pasted.originalSize[0] || 640) / 2, (pasted.originalSize[1] || 360) / 2]\r\n\r\n  return pasted\r\n}\r\n\r\nexport function createContentFromText(str: string, map:MapData, xCord:number, yCord:number, from:string){\r\n  return new Promise<ISharedContent>((resolve, reject)=>{\r\n    let content = undefined\r\n    if (str.indexOf('http://') === 0 || str.indexOf('https://') === 0) {\r\n      const url = new URL(str)\r\n      const ext = str.slice(-4)\r\n      if (isSelfUrl(url)) {\r\n        //  Openning of self url makes infinite loop. So, create text instead.\r\n        content = createContentOfText(str, map, xCord, yCord, from)\r\n        content.name = '! recursive reference'\r\n        resolve(content)\r\n      }else if (ext === '.jpg' || ext === '.JPG' || ext === 'jpeg' || ext === 'JPEG' ||\r\n        ext === '.png' || ext === '.PNG' || ext === '.gif' || ext === '.GIF' ||\r\n        ext === '.svg' || ext === '.SVG') {\r\n        createContentOfImageUrl(str, map).then((content) => {\r\n          content.name = url.pathname\r\n          resolve(content)\r\n        }).catch(reject)\r\n      }else {\r\n        createContentOfIframe(str, map, xCord, yCord, from).then((content) => {\r\n          if (content.type === 'iframe') {\r\n            //  iframe is not work well because of CORS problem.\r\n            content = createContentOfText(str, map, xCord, yCord, from)\r\n            content.name = `${url.host}${url.pathname}${url.search}`\r\n          }\r\n          if (content.type === 'youtube') {\r\n            content.name = `${url.search.substring(1)}`\r\n          }else {\r\n            content.name = `${url.host}${url.pathname}${url.search}`\r\n          }\r\n          resolve(content)\r\n        }).catch(reject)\r\n      }\r\n    }else {\r\n      content = createContentOfText(str, map, xCord, yCord, from)\r\n      content.name = str.substring(0, 20)\r\n      resolve(content)\r\n    }\r\n  })\r\n}\r\n//  set pasted or dragged content to pasted content (not shared) or create shared content directly\r\nexport function createContentsFromDataTransfer(dataTransfer: DataTransfer, map: MapData) {\r\n  return new Promise<ISharedContent[]>((resolve, reject)=>{\r\n    if (dataTransfer?.types.includes('Files')) {   //  If file is pasted)\r\n      const items = Array.from(dataTransfer.items)\r\n      const contents:ISharedContent[] = []\r\n      const reasons:any[] = []\r\n      for(const item of items){\r\n        const file = item.getAsFile()\r\n        if (item.kind === 'file' && file) {\r\n          let creator: ((file:File, map:MapData, offset?:[number, number]) => Promise<ISharedContent>)\r\n            | undefined = undefined\r\n          if (item.type.indexOf('image') !== -1) {\r\n            creator = createContentOfImage\r\n          }else if (item.type === 'application/pdf') {\r\n            creator = createContentOfPdf\r\n          }\r\n          if (creator) {\r\n            creator(file, map).then((content) => {\r\n              content.name = file.name\r\n              contents.push(content)\r\n              if (contents.length + reasons.length === items.length){\r\n                contents.length ? resolve(contents) : reject(reasons)\r\n              }\r\n            }).catch((reason) => {\r\n              reasons.push(reason)\r\n              if (contents.length + reasons.length  === items.length){\r\n                contents.length ? resolve(contents) : reject(reasons)\r\n              }\r\n            })\r\n          }\r\n        }else{\r\n          reasons.push('Creator not found.')\r\n        }\r\n      }\r\n    }else if (dataTransfer?.types.includes('text/plain')) {\r\n      dataTransfer.items[0].getAsString((str:string) => {\r\n        createContentFromText(str, map, 0, 0, '').then(c => resolve([c])).catch(reject)\r\n      })\r\n    }else {\r\n      console.error('Unhandled content types:', dataTransfer?.types)\r\n      reject(`Unhandled content types:${dataTransfer?.types}`)\r\n    }\r\n  })\r\n}\r\n/*\r\nconst extractData = extract<ISharedContent>({\r\n  zorder: true, name: true, ownerName: true, color: true, textColor:true,\r\n  type: true, url: true, pose: true, size: true, originalSize: true, pinned: true,\r\n  noFrame: true, opacity: true, zone:true, playback:true\r\n})\r\nexport function extractContentData(c:ISharedContent) {\r\n  return extractData(c)\r\n}\r\nexport function extractContentDatas(cs:ISharedContent[]) {\r\n  return cs.map(extractContentData)\r\n}\r\nconst extractDataAndId = extract<SharedContentData|SharedContentId|MapObject>({\r\n  zorder: true, name: true, ownerName: true, color: true, textColor:true,\r\n  type: true, url: true, pose: true, size: true, originalSize: true,\r\n  pinned: true, noFrame: true, opacity:true, zone:true, id: true, playback: true\r\n})\r\nexport function extractContentDataAndId(c: ISharedContent) {\r\n  return extractDataAndId(c)\r\n}\r\nexport function extractContentDataAndIds(cs: ISharedContent[]) {\r\n  return cs.map(extractDataAndId)\r\n}\r\n*/\r\n\r\nfunction execCopy(str: string){\r\n  const temp = document.createElement('textarea')\r\n  temp.value = str\r\n  temp.selectionStart = 0\r\n  temp.selectionEnd = temp.value.length\r\n  const s = temp.style\r\n  s.position = 'fixed'\r\n  s.left = '-100%'\r\n\r\n  document.body.appendChild(temp)\r\n  temp.focus()\r\n  const result = document.execCommand('copy')\r\n  temp.blur()\r\n  document.body.removeChild(temp)\r\n\r\n  return result\r\n}\r\n\r\nexport function copyContentToClipboard(c: ISharedContent){\r\n  if (c.type === 'text'){\r\n    const tms = JSON.parse(c.url) as TextMessages\r\n    const text = tms.messages.length ?\r\n      tms.messages.map(m => m.message).reduce((prev, cur) => prev ? (prev + '\\n') : '' + cur) : ''\r\n    execCopy(text)\r\n  }else if (c.type === 'youtube'){\r\n    const array = c.url.split('&')\r\n    const paramUrl = array.filter(s => {\r\n      const key = s.split('=')[0]\r\n\r\n      return key === 'v' || key === 'list' }\r\n    )\r\n    const param = paramUrl.length ? paramUrl.reduce((pre, cur) => (pre ? pre + '&' : '') + cur) : ''\r\n    execCopy(`https://www.youtube.com/watch?${param}`)\r\n  }else if (c.type === 'gdrive'){\r\n    const params = getParamsFromUrl(c.url)\r\n    const url = getGDriveUrl(true, params)\r\n    execCopy(url)\r\n  }else{\r\n    execCopy(c.url)\r\n  }\r\n}\r\n\r\nexport function isGDrivePreviewScrollable(mimeType?: string) {\r\n  if (!mimeType){ return true }\r\n\r\n  return !(\r\n    mimeType === 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\r\n    || mimeType === 'application/vnd.google-apps.presentation'\r\n    || mimeType === 'application/vnd.google-apps.spreadsheet'\r\n    || mimeType.slice(0, 5) === 'image'\r\n    || mimeType.slice(0, 5) === 'video'\r\n    || mimeType.slice(0, 5) === 'audio'\r\n  )\r\n}\r\nexport function isGDrivePreviewEditUrl(mimeType?: string){\r\n  if (!mimeType){ return false }\r\n\r\n  return mimeType === 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\r\n  || mimeType === 'application/vnd.google-apps.spreadsheet'\r\n  || mimeType === 'application/vnd.google-apps.document'\r\n  || mimeType === 'application/vnd.google-apps.presentation'\r\n}\r\n\r\nexport function getGDriveUrl(editing: boolean, params: Map<string, string>){\r\n  const fileId = params.get('id')\r\n  let mimeType = params.get('mimeType')\r\n  mimeType = mimeType ? mimeType : ''\r\n  const comp = 'application/vnd.google-apps.'\r\n\r\n  let url = `https://drive.google.com/file/d/${fileId}/preview`\r\n  if (editing || isGDrivePreviewEditUrl(mimeType)){\r\n    if (mimeType.substr(0, comp.length) === comp){\r\n      let app = mimeType.substr(comp.length)\r\n      if (app !== 'failed'){\r\n        if (app === 'spreadsheet'){ app = 'spreadsheets' }\r\n        url = `https://docs.google.com/${app}/d/${fileId}/edit`\r\n      }\r\n    } else if (mimeType === 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet') {\r\n      const app = 'spreadsheets'\r\n      url = `https://docs.google.com/${app}/d/${fileId}/edit`\r\n    }\r\n  }\r\n\r\n  return url\r\n}\r\nexport function getBeforeParamsOfUrl(url: string){\r\n  const start = url.indexOf('?')\r\n\r\n  return start < 0 ? url : url.substring(0, start)\r\n}\r\nexport function getParamsFromUrl(url: string){\r\n  const start = url.indexOf('?')\r\n  const paramStr = start >= 0 ? url.substr(start) : url\r\n  const params = new Map(paramStr.split('&').map(str => str.split('=') as [string, string]))\r\n\r\n  return params\r\n}\r\nexport function getStringFromParams(params: Map<string, string>){\r\n  let url = ''\r\n  params.forEach((val, key) => {\r\n    url = `${url}${url ? '&' : ''}${key}=${val}`\r\n  })\r\n\r\n  return url\r\n}\r\nexport function getInformationOfGDriveContent(fileId: string){\r\n  //  console.log('GAPI try to get mimeType')\r\n  const API_KEY = 'AIzaSyCE4B2cKycH0fVmBznwfr1ynnNf2qNEU9M'\r\n  const rv = new Promise<{name:string, mimeType:string}>((resolve, reject)=>{\r\n    if (gapi){\r\n      gapi.client.setApiKey(API_KEY)\r\n      gapi.client.load('drive', 'v3', () => {\r\n        gapi.client.drive.files.get({\r\n          fileId,\r\n          fields:'mimeType,name',\r\n        })\r\n        .then((result:any) => {\r\n          const body = JSON.parse(result.body)\r\n          //  console.log(`GAPI mimeType:${body.mimeType}  name:${body.name}`)\r\n          resolve({mimeType:body.mimeType, name: body.name})\r\n        }).catch((reason:any) => {\r\n          console.debug('GAPI error', reason)\r\n          reject(reason)\r\n        })\r\n      })\r\n    }else{\r\n      reject('gapi is not loaded')\r\n    }\r\n  })\r\n\r\n  return rv\r\n}\r\n\r\n//  change zorder to the top.\r\nexport function moveContentToTop(c: SharedContentImp) {\r\n  if (isContentWallpaper(c)){\r\n    let top = sharedContents.sorted.findIndex(c => c.zorder > TEN_YEAR)\r\n    if (top < 0){ top = sharedContents.sorted.length }\r\n    top -= 1\r\n    if (top >= 0){\r\n      const order = sharedContents.sorted[top].zorder + 1\r\n      c.zorder = order <= TEN_YEAR ? order : TEN_YEAR\r\n    }\r\n  }else{\r\n    c.zorder = Math.floor(Date.now() / TIME_RESOLUTION_IN_MS)\r\n  }\r\n}\r\n//  change zorder to the bottom.\r\nexport function moveContentToBottom(c: SharedContentImp) {\r\n  if (isContentWallpaper(c)){\r\n    const bottom = sharedContents.sorted[0]\r\n    if (bottom !== c) {\r\n      c.zorder = bottom.zorder - 1\r\n    }\r\n  }else{\r\n    const bottom = sharedContents.sorted.find(c => c.zorder > TEN_YEAR)\r\n    if (!bottom) {\r\n      moveContentToTop(c)\r\n    }else{\r\n      c.zorder = bottom.zorder - 1\r\n    }\r\n  }\r\n}\r\n//  change zorder to far below the bottom.\r\nexport function makeContentWallpaper(c: SharedContentImp, flag: boolean) {\r\n  //if (isContentWallpaper(c)) { return }\r\n  if (flag){\r\n    let zorder = TEN_YEAR - (Math.floor(Date.now() / TIME_RESOLUTION_IN_MS) - c.zorder)\r\n    if (zorder < 0){\r\n      zorder = c.zorder % TEN_YEAR\r\n    }\r\n    c.zorder = zorder\r\n  }else{\r\n    c.zorder = c.zorder + TEN_YEAR\r\n  }\r\n}\r\n","export function getMimeType(url: string){\r\n  return new Promise((resolve, reject)=>{\r\n    const xhttp = new XMLHttpRequest()\r\n    xhttp.timeout = 5000\r\n    xhttp.open('GET', url)\r\n    xhttp.onreadystatechange = function () {\r\n      if (this.readyState === this.LOADING) {\r\n        const type = this.getResponseHeader(\"Content-Type\")\r\n        this.abort()\r\n        resolve(type)\r\n      }\r\n    }\r\n    xhttp.send()\r\n  })\r\n}\r\n","import {EventEmitter} from 'events'\r\nimport {RemoteProducer} from './Conference'\r\nimport {MSCreateTransportMessage, MSMessage, MSPeerMessage, MSMessageType, MSRoomMessage, MSRTPCapabilitiesReply,\r\n  MSTransportDirection, MSCreateTransportReply, MSConnectTransportMessage, MSConnectTransportReply,\r\n  MSProduceTransportMessage, MSProduceTransportReply, MSTrackRole, MSConsumeTransportMessage, MSConsumeTransportReply, MSRemoteUpdateMessage, MSRemoteLeftMessage, MSResumeConsumerMessage, MSResumeConsumerReply, MSCloseProducerMessage, MSCloseProducerReply} from './MediaMessages'\r\nimport * as mediasoup from 'mediasoup-client';\r\nimport { observable } from 'mobx';\r\nimport participants from '@stores/participants/Participants';\r\n\r\n// config.js\r\ndeclare const config:any                  //  from ../../config.js included from index.html\r\n\r\n//  Log level and module log options\r\nexport const RTC_CON_LOG = false\r\nexport const rtcLog = RTC_CON_LOG ? console.log : (a:any) => {}\r\n\r\ntype RtcConnectionEvent = 'remoteUpdate' | 'remoteLeft' | 'connect' | 'disconnect'\r\n\r\nexport class RtcConnection{\r\n  private peer_=''\r\n  private connected = false\r\n  get peer() {return this.peer_}\r\n  private mainServer?:WebSocket\r\n  private device?:mediasoup.Device\r\n  private handlers = new Map<MSMessageType, (msg: MSMessage)=>void>()\r\n  private promises = new Map<number, {resolve:(a:any)=>void, reject?:(a:any)=>void, arg?:any} >()\r\n  private messageNumber = 1\r\n\r\n  public constructor(){\r\n    this.handlers.set('connect', this.onConnect)\r\n    this.handlers.set('createTransport', this.onCreateTransport)\r\n    this.handlers.set('rtpCapabilities', this.onRtpCapabilities)\r\n    this.handlers.set('connectTransport', this.onConnectTransport)\r\n    this.handlers.set('produceTransport', this.onProduceTransport)\r\n    this.handlers.set('closeProducer', this.onCloseProducer)\r\n    this.handlers.set('consumeTransport', this.onConsumeTransport)\r\n    this.handlers.set('resumeConsumer', this.onResumeConsumer)\r\n    this.handlers.set('remoteUpdate', this.onRemoteUpdate)\r\n    this.handlers.set('remoteLeft', this.onRemoteLeft)\r\n    try{\r\n      this.device = new mediasoup.Device();\r\n    }catch (error:any){\r\n      if (error.name === 'UnsupportedError')\r\n        console.warn('browser not supported');\r\n    }\r\n  }\r\n\r\n  public isConnected(){\r\n    return this.connected && this.mainServer?.readyState === WebSocket.OPEN\r\n  }\r\n\r\n  //  connect to main server. return my peer id got.\r\n  public connect(room: string, peer: string){\r\n    rtcLog(`rtcConn connect(${room}, ${peer})`)\r\n    const promise = new Promise<string>((resolve, reject)=>{\r\n      this.mainServer = new WebSocket(config.mainServer)\r\n      const onOpenEvent = () => {\r\n        const msg:MSPeerMessage = {\r\n          type:'connect',\r\n          peer,\r\n        }\r\n        this.sendWithPromise(msg, resolve, reject, room)\r\n      }\r\n      const onMessageEvent = (ev: MessageEvent<any>)=> {\r\n        const msg = JSON.parse(ev.data) as MSMessage\r\n        const func = this.handlers.get(msg.type)\r\n        if (func){\r\n          func.bind(this)(msg)\r\n        }else{\r\n          console.error(`unhandled message ${msg.type} received`, msg)\r\n        }\r\n      }\r\n      const onCloseEvent = () => {\r\n        rtcLog('onClose() for mainServer')\r\n        this.connected = false\r\n        this.emit('disconnect')\r\n\r\n        setTimeout(()=>{\r\n          this.mainServer = new WebSocket(config.mainServer)\r\n          setEventHandler()\r\n        }, 5 * 1000)\r\n      }\r\n      const onErrorEvent = () => {\r\n        console.error(`Error in WebSocket for ${config.mainServer}`)\r\n        this.mainServer?.close(3000, 'onError')\r\n        onCloseEvent()\r\n      }\r\n\r\n      const setEventHandler = () => {\r\n        this.mainServer?.addEventListener('error', onErrorEvent)\r\n        this.mainServer?.addEventListener('message', onMessageEvent)\r\n        this.mainServer?.addEventListener('open', onOpenEvent)\r\n        this.mainServer?.addEventListener('close', onCloseEvent)\r\n      }\r\n      setEventHandler()\r\n    })\r\n    return promise\r\n  }\r\n  public disconnect(){\r\n    this.mainServer?.close()\r\n    this.peer_ = ''\r\n  }\r\n\r\n  private setMessageSerialNumber(msg: MSMessage){\r\n    this.messageNumber++;\r\n    msg.sn = this.messageNumber\r\n  }\r\n  private setMessagePromise(msg:MSMessage, resolve:(a:any)=>void, reject?:(reson:any)=>void, arg?:any){\r\n    this.setMessageSerialNumber(msg)\r\n    this.promises.set(msg.sn!, {resolve, reject, arg})\r\n  }\r\n  private getMessageArg(msg:MSMessage){\r\n    if (msg.sn){\r\n      return this.promises.get(msg.sn)?.arg\r\n    }\r\n  }\r\n  private sendWithPromise(msg:MSMessage, resolve:(a:any)=>void, reject?:(reson:any)=>void, arg?:any){\r\n    if (!this.mainServer) {\r\n      if (reject){\r\n        reject('no mainServer')\r\n      }\r\n    }else{\r\n      this.setMessagePromise(msg, resolve, reject, arg)\r\n      this.mainServer.send(JSON.stringify(msg))\r\n    }\r\n  }\r\n  private resolveMessage(m: MSMessage, a?:any){\r\n    const sn = m.sn\r\n    if (sn){\r\n      this.promises.get(sn)?.resolve(a)\r\n      this.promises.delete(sn)\r\n    }\r\n  }\r\n  private rejectMessage(m: MSMessage, a?:any){\r\n    const sn = m.sn\r\n    if (sn){\r\n      const reject = this.promises.get(sn)?.reject\r\n      if (reject) reject(a)\r\n      this.promises.delete(sn)\r\n    }\r\n  }\r\n\r\n\r\n  private loadDevice(peer: string){\r\n    const promise = new Promise<void>((resolve, reject)=>{\r\n      const msg:MSPeerMessage = {\r\n        type:'rtpCapabilities',\r\n        peer\r\n      }\r\n      this.sendWithPromise(msg, resolve, reject)\r\n    })\r\n    return promise\r\n  }\r\n  private onRtpCapabilities(base: MSMessage){\r\n    const msg = base as MSRTPCapabilitiesReply\r\n    this.device?.load({routerRtpCapabilities: msg.rtpCapabilities}).then(()=>{\r\n      this.resolveMessage(base)\r\n    })\r\n  }\r\n\r\n  private onConnect(base: MSMessage){\r\n    rtcLog(`onConnect( ${JSON.stringify(base)}`)\r\n    const msg = base as MSPeerMessage\r\n    this.peer_ = msg.peer\r\n    const room = this.getMessageArg(msg) as string\r\n    if (this.mainServer){\r\n      const roomMsg:MSRoomMessage = {\r\n        type: 'join',\r\n        peer:msg.peer,\r\n        room\r\n      }\r\n      rtcLog(`join sent ${JSON.stringify(roomMsg)}`)\r\n      this.mainServer.send(JSON.stringify(roomMsg))\r\n      this.loadDevice(msg.peer).then(()=>{\r\n        this.resolveMessage(msg, msg.peer)\r\n        this.connected = true\r\n        this.emitter.emit('connect')\r\n      })\r\n    }else{\r\n      this.rejectMessage(msg)\r\n      throw new Error('No connection has been established.')\r\n    }\r\n  }\r\n\r\n  public createTransport(dir: MSTransportDirection, remote?: string){\r\n    if (dir === 'receive' && !remote){\r\n      console.error(`createTransport(): remote must be specified.`)\r\n    }\r\n    const promise = new Promise<mediasoup.types.Transport>((resolve, reject) => {\r\n      const msg:MSCreateTransportMessage = {\r\n        type:'createTransport',\r\n        peer:this.peer,\r\n        remote,\r\n        dir\r\n      }\r\n      this.sendWithPromise(msg, resolve, reject, remote)\r\n    })\r\n    return promise\r\n  }\r\n  private onCreateTransport(base: MSMessage){\r\n    const msg = base as MSCreateTransportReply\r\n    const {type, peer, transport, iceServers, ...params} = msg\r\n    const option: mediasoup.types.TransportOptions = {\r\n      id:transport,\r\n      ...params,\r\n      iceServers,\r\n      iceTransportPolicy: 'all',\r\n    }\r\n\r\n    let transportObject:mediasoup.types.Transport|undefined\r\n    if (msg.dir === 'send'){\r\n      transportObject = this.device?.createSendTransport(option)\r\n    }else{\r\n      transportObject = this.device?.createRecvTransport(option)\r\n    }\r\n    if (transportObject){\r\n      const remote = this.getMessageArg(msg)\r\n      startUpdateTransportStat(transportObject, msg.dir, remote)\r\n      this.resolveMessage(msg, transportObject)\r\n    }\r\n    this.rejectMessage(msg)\r\n  }\r\n\r\n  public connectTransport(transport: mediasoup.types.Transport, dtlsParameters: mediasoup.types.DtlsParameters, remote?:string){\r\n    const promise = new Promise<string>((resolve, reject) => {\r\n      const msg:MSConnectTransportMessage = {\r\n        type:'connectTransport',\r\n        peer:this.peer,\r\n        remote,\r\n        dtlsParameters,\r\n        transport: transport.id,\r\n      }\r\n      this.sendWithPromise(msg, resolve, reject)\r\n    })\r\n    return promise\r\n  }\r\n  private onConnectTransport(base:MSMessage){\r\n    const msg = base as MSConnectTransportReply\r\n    if (msg.error){\r\n      this.rejectMessage(msg, msg.error)\r\n    }else{\r\n      this.resolveMessage(msg, '')\r\n    }\r\n\r\n  }\r\n\r\n  public produceTransport(params:{transport:string, kind:mediasoup.types.MediaKind,\r\n    role: MSTrackRole|string, rtpParameters:mediasoup.types.RtpParameters,\r\n    paused:boolean, appData:any}){\r\n    const promise = new Promise<string>((resolve, reject) => {\r\n      const msg:MSProduceTransportMessage = {\r\n        type:'produceTransport',\r\n        peer:this.peer,\r\n        ...params,\r\n      }\r\n      this.sendWithPromise(msg, resolve, reject)\r\n    })\r\n    return promise\r\n  }\r\n  private onProduceTransport(base:MSMessage){\r\n    const msg = base as MSProduceTransportReply\r\n    if (msg.error){\r\n      this.rejectMessage(msg, msg.error)\r\n    }else{\r\n      this.resolveMessage(msg, msg.producer)\r\n    }\r\n  }\r\n\r\n  public closeProducer(producer: string){\r\n    const promise = new Promise<string>((resolve, reject) => {\r\n      const msg:MSCloseProducerMessage = {\r\n        type:'closeProducer',\r\n        peer:this.peer,\r\n        producer\r\n      }\r\n      this.sendWithPromise(msg, resolve, reject)\r\n    })\r\n    return promise\r\n  }\r\n  private onCloseProducer(base: MSMessage){\r\n    const msg = base as MSCloseProducerReply\r\n    if (msg.error){\r\n      this.rejectMessage(msg, msg.error)\r\n    }else{\r\n      this.resolveMessage(msg)\r\n    }\r\n  }\r\n  public consumeTransport(transport: string, producer:RemoteProducer){\r\n    const promise = new Promise<mediasoup.types.ConsumerOptions>((resolve, reject) => {\r\n      const msg:MSConsumeTransportMessage = {\r\n        type:'consumeTransport',\r\n        peer:this.peer,\r\n        remote: producer.peer.peer,\r\n        rtpCapabilities: this.device!.rtpCapabilities,\r\n        transport,\r\n        producer:producer.id,\r\n      }\r\n      this.sendWithPromise(msg, resolve, reject)\r\n    })\r\n    return promise\r\n  }\r\n  private onConsumeTransport(base:MSMessage){\r\n    const msg = base as MSConsumeTransportReply\r\n    if (msg.error){\r\n      this.rejectMessage(msg, msg.error)\r\n    }else{\r\n      const consumerOptions: mediasoup.types.ConsumerOptions = {\r\n        id: msg.consumer,\r\n        producerId: msg.producer,\r\n        kind: msg.kind,\r\n        rtpParameters: msg.rtpParameters!\r\n      }\r\n      this.resolveMessage(msg, consumerOptions)\r\n    }\r\n  }\r\n  public resumeConsumer(consumer: string, remote: string){\r\n    const promise = new Promise<void>((resolve, reject) => {\r\n      const msg:MSResumeConsumerMessage = {\r\n        type:'resumeConsumer',\r\n        peer:this.peer,\r\n        remote: remote,\r\n        consumer\r\n      }\r\n      this.sendWithPromise(msg, resolve, reject)\r\n    })\r\n    return promise\r\n  }\r\n  private onResumeConsumer(base: MSMessage){\r\n    const reply = base as MSResumeConsumerReply\r\n    if(reply.error){\r\n      this.rejectMessage(reply, reply.error)\r\n    }else{\r\n      this.resolveMessage(reply)\r\n    }\r\n  }\r\n\r\n  private emitter = new EventEmitter()\r\n  public addListener(event:RtcConnectionEvent, listener:(...args:any[])=>void){\r\n    this.emitter.addListener(event, listener)\r\n  }\r\n  public removeListener(event:RtcConnectionEvent, listener:(...args:any[])=>void){\r\n    this.emitter.removeListener(event, listener)\r\n  }\r\n  public removeAllListener(){\r\n    this.emitter.removeAllListeners()\r\n  }\r\n  private emit(event:RtcConnectionEvent, ...args: any[]){\r\n    this.emitter.emit(event, args)\r\n  }\r\n\r\n  private onRemoteUpdate(base: MSMessage){\r\n    const msg = base as MSRemoteUpdateMessage\r\n    this.emit('remoteUpdate', msg.remotes)\r\n  }\r\n  private onRemoteLeft(base: MSMessage){\r\n    const msg = base as MSRemoteLeftMessage\r\n    this.emit('remoteLeft', msg.remotes)\r\n  }\r\n}\r\n\r\n\r\nexport interface RTCRemoteInboundRtpStreamStats extends RTCReceivedRtpStreamStats {\r\n  localId: string\r\n  roundTripTime: number\r\n  totalRoundTripTime: number\r\n  fractionLost: number\r\n  roundTripTimeMeasurements: number\r\n}\r\nexport interface RTCRemoteOutboundRtpStreamStats extends RTCSentRtpStreamStats {\r\n  localId: string\r\n  roundTripTime: number\r\n  totalRoundTripTime: number\r\n  fractionLost: number\r\n  roundTripTimeMeasurements: number\r\n}\r\n\r\nexport interface RTCCodecStats extends RTCStats{\r\n  payloadType:number\r\n  trnsportId:string\r\n  mimeType:string\r\n  clockRate:number\r\n  channels:number\r\n  sdpFmtpLine:string\r\n}\r\nexport interface RTCIceCandidateEx extends RTCIceCandidate{\r\n  url?: string\r\n}\r\nexport interface TransportStat{\r\n  dir:MSTransportDirection\r\n  fractionLost?:number\r\n  roundTripTime?:number\r\n  jitter?:number\r\n  timestamp:number\r\n  receivedBytePerSec?:number\r\n  sentBytePerSec?:number\r\n  bytesSent:number\r\n  bytesReceived:number\r\n  turn?: string\r\n  localServer?: string\r\n  remoteServer?: string\r\n  streams: StreamStat[]\r\n  quality?: number  //  0 - 100, 100 is best\r\n}\r\ninterface RTCOutboundRtpStreamStatsEx extends RTCOutboundRtpStreamStats{\r\n  targetBitrate?: number\r\n}\r\ninterface RTCInboundRtpStreamStatsEx extends RTCInboundRtpStreamStats{\r\n  bytesReceived: number\r\n\r\n}\r\nexport const defaultTransportStat:TransportStat={\r\n  timestamp:0,\r\n  bytesSent:0,\r\n  bytesReceived:0,\r\n  streams:[],\r\n  dir: 'send',\r\n}\r\n\r\nexport interface RTCOutStreamStat{\r\n  id: string\r\n  local: RTCOutboundRtpStreamStatsEx\r\n  remote?: RTCRemoteInboundRtpStreamStats\r\n}\r\nexport interface RTCInStreamStat{\r\n  id: string\r\n  local: RTCInboundRtpStreamStatsEx\r\n  remote?: RTCRemoteOutboundRtpStreamStats\r\n}\r\nexport interface StreamStat{\r\n  dir: MSTransportDirection\r\n  bytesPerSec?:number\r\n  codec?: string\r\n  targetBitrate?: number\r\n  fractionLost?: number\r\n  roundTripTime?: number\r\n  jitter?: number\r\n  id: string\r\n}\r\n\r\nexport function stopTransportStatUpdate(transport: mediasoup.types.Transport){\r\n  if (transport.appData.interval) window.clearInterval(transport.appData.interval as number)\r\n  delete transport.appData.interval\r\n}\r\nexport function startUpdateTransportStat(transport: mediasoup.types.Transport, dir: MSTransportDirection, remote?: string){\r\n  //  add stat and listener to transport\r\n  if (!transport.appData.stat){\r\n    const tStat:TransportStat = {...defaultTransportStat, dir}\r\n    transport.appData.stat = observable(tStat)\r\n    transport.observer.addListener('close', ()=>{\r\n      stopTransportStatUpdate(transport)\r\n    })\r\n  }\r\n\r\n  //  set interval timer\r\n  let outStreamsPrev = new Map<string, RTCOutStreamStat>()\r\n  let inStreamsPrev = new Map<string, RTCInStreamStat>()\r\n  transport.appData.interval = window.setInterval(()=>{\r\n    const curStat = transport.appData.stat as TransportStat\r\n    transport?.getStats().then((stats)=>{\r\n      const keys = Array.from(stats.keys())\r\n\r\n      /*\r\n      //  log all stats\r\n      let str=''\r\n      keys.forEach((key)=>{ str = `${str}\\n ${key}:${JSON.stringify(stats.get(key))}` })\r\n      console.log(str)\r\n      //  */\r\n      let streamStats:StreamStat[]\r\n      if (dir === 'send'){\r\n        const streamIds = keys.filter(k => k.includes('RTCOutboundRTPVideoStream') || k.includes('RTCOutboundRTPAudioStream'))\r\n          .map(k => k.substring('RTCOutboundRTP'.length))\r\n        const streams = streamIds.map(id => ({\r\n          id,\r\n          local: stats.get(`RTCOutboundRTP${id}`) as RTCOutboundRtpStreamStatsEx,\r\n          remote: stats.get(`RTCRemoteInboundRtp${id}`) as RTCRemoteInboundRtpStreamStats|undefined,\r\n        }))\r\n        streamStats = streams.map(stream => {\r\n          const prev = outStreamsPrev.get(stream.id)\r\n          const dt = prev?.local?.timestamp ? (stream.local.timestamp - prev.local.timestamp)/1000 : 0\r\n\r\n          if (stream.local.codecId){\r\n            stats.get(stream.local.codecId)\r\n          }\r\n          const rv:StreamStat = {\r\n            dir,\r\n            id: stream.id,\r\n            bytesPerSec: (dt && stream.local.bytesSent && prev?.local?.bytesSent) ?\r\n              (stream.local.bytesSent-prev.local.bytesSent)/dt : 0,\r\n            codec: stream.local.codecId ? (stats.get(stream.local.codecId) as RTCCodecStats).mimeType : undefined,\r\n            targetBitrate: stream.local.targetBitrate,\r\n            //jitter: stream.remote?.jitter,\r\n            fractionLost: stream.remote?.fractionLost,\r\n            roundTripTime: stream.remote?.roundTripTime\r\n          }\r\n          return rv\r\n        })\r\n        outStreamsPrev = new Map(streams.map((s) => [s.id, s]))\r\n      }else{\r\n        const streamIds = keys.filter(k => k.includes('RTCInboundRTPVideoStream') || k.includes('RTCInboundRTPAudioStream'))\r\n          .map(k => k.substring('RTCInboundRTP'.length))\r\n        const streams = streamIds.map(id => ({\r\n          id,\r\n          local: stats.get(`RTCInboundRTP${id}`) as RTCInboundRtpStreamStatsEx,\r\n          remote: stats.get(`RTCRemoteOutboundRTP${id}`) as RTCRemoteOutboundRtpStreamStats,\r\n        }))\r\n        //  console.log(JSON.stringify(streams))\r\n        streamStats = streams.map(stream => {\r\n          const prev = inStreamsPrev.get(stream.id)\r\n          const dt = prev?.local?.timestamp ? (stream.local.timestamp - prev.local.timestamp)/1000 : 0\r\n\r\n          if (stream.local.codecId){\r\n            stats.get(stream.local.codecId)\r\n          }\r\n          const rv:StreamStat = {\r\n            dir,\r\n            id: stream.id,\r\n            bytesPerSec: (dt && stream.local.bytesReceived && prev?.local?.bytesReceived) ?\r\n              (stream.local.bytesReceived -prev.local.bytesReceived)/dt : 0,\r\n            codec: stream.local.codecId ? (stats.get(stream.local.codecId) as RTCCodecStats).mimeType : undefined,\r\n            jitter: stream.local.jitter,\r\n            fractionLost: stream.remote?.fractionLost,\r\n            roundTripTime: stream.remote?.roundTripTime\r\n          }\r\n          return rv\r\n        })\r\n        inStreamsPrev = new Map(streams.map((s) => [s.id, s]))\r\n      }\r\n      //  clear\r\n      curStat.fractionLost = undefined\r\n      curStat.roundTripTime = undefined\r\n      curStat.jitter = undefined\r\n      setAverageOf('fractionLost', curStat, streamStats)\r\n      setAverageOf('roundTripTime', curStat, streamStats)\r\n      setAverageOf('jitter', curStat, streamStats)\r\n\r\n      const tkey = keys.find(k => k.substring(0, 'RTCTransport'.length) === 'RTCTransport')\r\n      if (tkey){\r\n        const tStat = stats.get(tkey) as RTCTransportStats\r\n        const delta = (tStat.timestamp - curStat.timestamp)/1000\r\n        curStat.timestamp = tStat.timestamp\r\n        if (tStat.bytesReceived){\r\n          curStat.receivedBytePerSec = Math.floor((tStat.bytesReceived - curStat.bytesReceived) / delta)\r\n          curStat.bytesReceived = tStat.bytesReceived\r\n        }\r\n        if (tStat.bytesSent){\r\n          curStat.sentBytePerSec = Math.floor((tStat.bytesSent - curStat.bytesSent) / delta)\r\n          curStat.bytesSent = tStat.bytesSent\r\n        }\r\n        const ckey = tStat.selectedCandidatePairId\r\n        if (ckey){\r\n          const pair = stats.get(ckey) as RTCIceCandidatePairStats\r\n          const lc = stats.get(pair.localCandidateId) as RTCIceCandidateEx\r\n          //  local server is client's IP address and port. Do not need to show.\r\n          //  curStat.localServer = `${lc.address}:${lc.port}/${lc.protocol}`\r\n          curStat.turn = lc.url\r\n          const rc = stats.get(pair.remoteCandidateId) as RTCIceCandidateEx\r\n          curStat.remoteServer = `${rc.address}:${rc.port}/${rc.protocol}`\r\n        }\r\n      }\r\n      let quality=undefined\r\n      if (curStat.fractionLost!==undefined || curStat.roundTripTime!==undefined || curStat.jitter !== undefined){\r\n        const fractionLost = curStat.fractionLost ? curStat.fractionLost : 0\r\n        const roundTripTime = curStat.roundTripTime ? curStat.roundTripTime : 0\r\n        const jitter = (!roundTripTime && curStat.jitter) ? curStat.jitter : 0\r\n        quality = 100 - (fractionLost>1e-10 ? Math.pow(fractionLost, -10) : 0) * 100\r\n         - roundTripTime * 100 - jitter * 100\r\n        quality = Math.max(Math.min(quality, 100), 0)\r\n      }\r\n      curStat.quality = quality\r\n      curStat.streams = streamStats\r\n      //console.log(`curStat: ${JSON.stringify(curStat)}`)\r\n      const participant = dir==='send' ? participants.local : participants.getRemote(remote!)\r\n      if (participant){\r\n        participant.quality = curStat.quality\r\n      }\r\n    }).catch()\r\n  }, 5000)\r\n}\r\n\r\nfunction setAverageOf<S,T>(prop: string, curStat:S, stats: T[]){\r\n  const cs = curStat as any\r\n  const ss = stats as any[]\r\n  let count = 0\r\n  cs[prop] = undefined\r\n  for(const s of ss){\r\n    if (s[prop]){\r\n      cs[prop] = s[prop] + (cs[prop] ? cs[prop] : 0)\r\n      count ++\r\n    }\r\n  }\r\n  if (cs[prop]){\r\n    cs[prop] /= count\r\n  }\r\n}\r\n","\r\nfunction pad2(n: number){\r\n  return (\"0\" + n).slice(-2)\r\n}\r\nfunction pad4(n: number){\r\n  return (\"000\" + n).slice(-4)\r\n}\r\n\r\nexport function dateTimeString(n?: number){\r\n  if (n===undefined){\r\n    n = Date.now()\r\n  }\r\n  const d = new Date(n)\r\n  return `${pad4(d.getFullYear())}.${pad2(d.getMonth()+1)}.${pad2(d.getDay())}_`\r\n   + `${pad2(d.getHours())}.${pad2(d.getMinutes())}`\r\n}\r\n","import {Stores} from '@components/utils'\r\nimport {contentsToSend, IPlaybackContent} from '@models/ISharedContent'\r\nimport {ParticipantBase, RemoteInformation, Viewpoint, VRMRigs} from '@models/Participant'\r\nimport {mouse2Str, pose2Str, str2Mouse, str2Pose} from '@models/utils'\r\nimport {LocalParticipant} from '@stores/participants/LocalParticipant'\r\nimport { TrackStates } from '@stores/participants/ParticipantBase'\r\nimport participants from '@stores/participants/Participants'\r\nimport {RemoteParticipant} from '@stores/participants/RemoteParticipant'\r\nimport contents from '@stores/sharedContents/SharedContents'\r\nimport {autorun, IReactionDisposer, makeObservable, observable} from 'mobx'\r\nimport {BMMessage} from './DataMessage'\r\nimport {MessageType} from './DataMessageType'\r\nimport {Dexie, IndexableType, Table} from 'dexie'\r\nimport { conference } from './Conference'\r\nimport { dateTimeString } from '@models/utils/date'\r\ndeclare const d:any                  //  from index.html\r\n\r\nconst recorderDb = new Dexie('recorderDb');\r\nrecorderDb.version(1).stores({\r\n  records: '++id, title, room, duration, time',\r\n  recMessages: '++id',\r\n  recMedias: 'id',\r\n  blobs: '++id'\r\n});\r\n\r\ntype MediaRole = 'mic' | 'avatar' | 'camera' | 'screen'\r\ntype MediaKind = 'audio' | 'video' | 'invalid'\r\ntype BlobKind = MediaKind | 'json'\r\n\r\nexport const dbRecords = (recorderDb as any).records as Table\r\nexport const dbMediaRecs = (recorderDb as any).recMedias as Table\r\nexport const dbMessageRecs = (recorderDb as any).recMessages as Table\r\nexport const dbBlobs = (recorderDb as any).blobs as Table\r\nexport interface DBRecord{\r\n  id?: number\r\n  room: string\r\n  time: number\r\n  duration: number\r\n  title: string\r\n  blob?: Blob      //  archived blob includes all\r\n}\r\nexport interface DBBlob{\r\n  id?: number\r\n  blob: Blob\r\n}\r\nexport interface DBMediaRec extends MediaRecBase{\r\n  blobs: number[]   //  blob in DBBlob\r\n}\r\n\r\nexport interface MediaRecBase{\r\n  id: string\r\n  pid?: string\r\n  cid?: string\r\n  role: MediaRole\r\n  kind: MediaKind\r\n  startTime:number\r\n  endTime:number\r\n}\r\nexport interface MediaRecData extends MediaRecBase{\r\n  blobs: Blob[]\r\n}\r\nclass MediaRec implements MediaRecData{\r\n  private media: MediaRecorder\r\n  get stream(){ return this.media.stream }\r\n  get state(){ return this.media.state }\r\n  id: string\r\n  pid?: string\r\n  cid?: string\r\n  role: MediaRole\r\n  kind: MediaKind\r\n  startTime = 0\r\n  endTime = 0\r\n  blobs: Blob[] = []\r\n  onData: (media:MediaRec)=>void = ()=>{}\r\n  constructor(stream: MediaStream, role:MediaRole, kind:MediaKind, id:string, opt?: {cid?:string, pid?: string}){\r\n    this.id = id\r\n    this.role = role\r\n    this.pid = opt?.pid\r\n    this.cid = opt?.cid\r\n    this.kind = kind\r\n    this.media = new MediaRecorder(stream)\r\n    this.media.addEventListener('dataavailable', this.onDataAvailable.bind(this))\r\n    this.media.addEventListener('stop', this.onStop.bind(this) )\r\n  }\r\n  start(){\r\n    if (this.media.state === 'inactive'){\r\n      this.media.start()\r\n      this.startTime = Date.now()\r\n    }else{\r\n      console.error(`Failed to start. Media for cid:${this.cid} pid:${this.pid}`\r\n        + ` is already in ${this.media.state}.`, this)\r\n    }\r\n  }\r\n  stop(){\r\n    if (this.media.state !== 'inactive'){\r\n      this.media.stop()\r\n    }\r\n  }\r\n  requestData(){\r\n    if (this.media.state !== 'inactive'){\r\n      this.media.requestData()\r\n    }\r\n  }\r\n  private onStop(){\r\n    this.endTime = Date.now()\r\n  }\r\n  private onDataAvailable(ev: BlobEvent){\r\n    const blob = ev.data\r\n    this.blobs.push(blob)\r\n    //  console.log(`p:${this.pid} c:${this.cid} role:${this.role} blob type:${blob.type} size:${blob.size}`)\r\n    //  + `url:${window.URL.createObjectURL(blob)}`)\r\n    this.onData(this)\r\n  }\r\n}\r\nexport interface BlobHeader{\r\n  cid?: string\r\n  pid?: string\r\n  role: string\r\n  size: number\r\n  kind: BlobKind\r\n  time?: number\r\n  duration?: number\r\n}\r\n\r\nclass Message{\r\n  msg: BMMessage\r\n  time: number\r\n  constructor(msg: BMMessage, time?:number){\r\n    this.msg = msg\r\n    this.time = time ? time : Date.now()\r\n  }\r\n}\r\nexport interface DBRecMessage{\r\n  id?: number\r\n  messages: Message[]\r\n  length: number\r\n}\r\n\r\ninterface JSONPart{\r\n  startTime: number\r\n  endTime: number\r\n  messages: Message[]\r\n}\r\nexport class Recorder{\r\n  medias = new Map<string, MediaRec>()\r\n  messages: Message[] = []\r\n  @observable recording = false\r\n  startTime = 0\r\n  endTime = 0\r\n\r\n  private intervalTimer=0\r\n  private stoppedMedias: MediaRec[] = []\r\n  private disposers:IReactionDisposer[] = []\r\n  private MessageTypesToRecord = new Set<string>([\r\n    MessageType.PARTICIPANT_INFO, MessageType.PARTICIPANT_POSE, MessageType.PARTICIPANT_MOUSE,\r\n    MessageType.PARTICIPANT_AFK, MessageType.PARTICIPANT_TRACKSTATES, MessageType.PARTICIPANT_VIEWPOINT,\r\n    MessageType.PARTICIPANT_ON_STAGE, MessageType.CONTENT_UPDATE_REQUEST, MessageType.CONTENT_REMOVE_REQUEST])\r\n  private lastMessageValues= new Map<string, string>()\r\n\r\n  constructor(){\r\n    makeObservable(this)\r\n  }\r\n  public clear(){\r\n    this.medias.clear()\r\n    this.messages = []\r\n    this.stoppedMedias = []\r\n    this.startTime = 0\r\n    this.endTime = 0\r\n    this.lastMessageValues.clear()\r\n  }\r\n  ///  Start to record\r\n  public start(stores: Stores){\r\n    this.clear()\r\n    //  start recording\r\n    this.recording = true\r\n    this.startTime = Date.now()\r\n    const dbRec: DBRecord = {\r\n      room: conference.room,\r\n      time: this.startTime,\r\n      duration: 0,\r\n      title: '',\r\n      blob: undefined,\r\n    }\r\n    dbRecords.add(dbRec)\r\n    //  list all track related to participants and contents\r\n    this.disposers.push(autorun(()=>{\r\n      this.observeAndRecordMedia()\r\n    }))\r\n\r\n    //  Record all contents\r\n    const cs = contentsToSend(stores.contents.all)\r\n    this.messages.push({msg:{t:MessageType.CONTENT_UPDATE_REQUEST, v:JSON.stringify(cs)}, time: Date.now()})\r\n    //  Record all participants\r\n    const participants:ParticipantBase[] = Array.from(stores.participants.remote.values())\r\n    participants.unshift(stores.participants.local)\r\n    for(const p of participants){\r\n      this.messages.push(\r\n        {msg:{t:MessageType.PARTICIPANT_INFO, p:p.id, v:JSON.stringify(p.information)}, time: Date.now()})\r\n      this.messages.push(\r\n        {msg:{t:MessageType.PARTICIPANT_POSE, p: p.id, v:JSON.stringify(pose2Str(p.pose))}, time: Date.now()})\r\n      this.messages.push(\r\n        {msg:{t:MessageType.PARTICIPANT_MOUSE, p: p.id, v:JSON.stringify(mouse2Str(p.mouse))}, time: Date.now()})\r\n    }\r\n    if (this.intervalTimer) window.clearInterval(this.intervalTimer)\r\n    this.intervalTimer = window.setInterval(()=>{\r\n      this.saveDiffToDB()\r\n    }, 3 * 1000)\r\n  }\r\n\r\n  /// stop and save to db\r\n  public stop(){\r\n    if (this.intervalTimer){\r\n      window.clearInterval(this.intervalTimer)\r\n      this.intervalTimer = 0\r\n    }\r\n    for(const d of this.disposers){ d() }\r\n    this.disposers = []\r\n    const promise = new Promise<DBRecord>((resolve, reject)=>{\r\n      this.stopMediaRecordings().then((medias:MediaRec[])=>{\r\n        this.endTime = Date.now()\r\n        this.makeRecord(medias).then((dbr)=>{\r\n          dbBlobs.clear().then(()=>{\r\n            dbMediaRecs.clear().then(()=>{\r\n              dbMessageRecs.clear().then(()=>resolve(dbr))\r\n            })\r\n          })\r\n        }).catch(reject)\r\n      })\r\n    })\r\n\r\n    return promise\r\n  }\r\n  //  called by DataConnection.ts\r\n  public recordMessage(msg:BMMessage){\r\n    if (this.recording && this.MessageTypesToRecord.has(msg.t)){\r\n      if (msg.t === MessageType.PARTICIPANT_MOUSE || msg.t === MessageType.PARTICIPANT_POSE){\r\n        if (this.lastMessageValues.get(msg.t) !== msg.v){\r\n          this.lastMessageValues.set(msg.t, msg.v)\r\n          this.messages.push(new Message(msg))\r\n        }\r\n      }else{\r\n        this.messages.push(new Message(msg))\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  //  incremental save to indexedDB\r\n  private saveDiffToDB(){\r\n    const promise = new Promise<void>((resolve)=>{\r\n      const medias = Array.from(this.medias.values())\r\n      let count = medias.length + 1\r\n      const resolveAll = () => {\r\n        count --\r\n        if (count === 0){\r\n          //console.log(`saveDiffToDB() ${medias.length} media, ${this.messages.length} msg`)\r\n          resolve()\r\n        }\r\n      }\r\n      this.saveMediaRecordings().then(()=>{\r\n        for (const media of medias){\r\n          dbMediaRecs.get(media.id).then((inDb)=>{\r\n            const dbMedia:DBMediaRec = inDb ? inDb as DBMediaRec : {\r\n              id: media.id,\r\n              startTime: media.startTime,\r\n              endTime: media.endTime,\r\n              pid: media.pid,\r\n              cid: media.cid,\r\n              role: media.role,\r\n              kind: media.kind,\r\n              blobs: []\r\n            }\r\n            dbMedia.startTime = media.startTime\r\n            dbMedia.endTime = media.endTime\r\n            const blobsToAdd = media.blobs.slice(dbMedia.blobs.length)\r\n            let addCount = 0\r\n            for(const blob of blobsToAdd){\r\n              const dbBlob:DBBlob = { blob }\r\n              //  eslint-disable-next-line no-loop-func\r\n              dbBlobs.add(dbBlob).then((blobId:IndexableType)=>{\r\n                dbMedia.blobs.push(blobId as number)\r\n                addCount++\r\n                if (addCount === blobsToAdd.length){\r\n                  dbMediaRecs.put(dbMedia, dbMedia.id).then(()=>{\r\n                    resolveAll()\r\n                  })\r\n                }\r\n              })\r\n            }\r\n          })\r\n        }\r\n      })\r\n      dbMessageRecs.toArray().then((dbMsgs:DBRecMessage[])=>{\r\n        const dbLen = dbMsgs.reduce((p,c) => p + c.length, 0)\r\n        if (this.messages.length > dbLen){\r\n          const messagesToAdd = this.messages.slice(dbLen)\r\n          const dbMsgToAdd: DBRecMessage = {\r\n            messages:messagesToAdd,\r\n            length:messagesToAdd.length\r\n          }\r\n          dbMessageRecs.add(dbMsgToAdd).then(()=>{\r\n            resolveAll()\r\n          })\r\n        }else{\r\n          resolveAll()\r\n        }\r\n      })\r\n    })\r\n    return promise\r\n  }\r\n\r\n  private converting = false\r\n  public convertDiffsToRecord(){\r\n    let maxEndTime = 0\r\n    const promise = new Promise<DBRecord>((resolve, reject)=>{\r\n      if (recorder.recording || this.converting) { reject(); return }\r\n      this.converting = true\r\n      dbRecords.where({title:''}).count(nRecord => {\r\n        if (nRecord === 0){ reject(); return}\r\n        //  console.log(`convert start nRecord=${nRecord}`)\r\n        dbMessageRecs.toArray((dbMsgs:DBRecMessage[])=>{\r\n          dbMediaRecs.toArray((dbMedias:DBMediaRec[])=>{\r\n            const medias: MediaRecData[] = []\r\n            if (dbMsgs.length || dbMedias.length){\r\n              this.messages = []\r\n              let count = 1\r\n              const resolveAll = () => {\r\n                count --\r\n                if (count === 0){\r\n                  dbMessageRecs.clear().then(()=>{\r\n                    dbMediaRecs.clear().then(()=>{\r\n                      dbBlobs.clear().then(()=>{\r\n                        this.endTime = maxEndTime\r\n                        this.makeRecord(medias, true).then((dbRec)=>{\r\n                          this.converting = false\r\n                          resolve(dbRec)\r\n                        }).catch(reject)\r\n                      })\r\n                    })\r\n                  })\r\n                }\r\n              }\r\n              for(const msg of dbMsgs){\r\n                for(const m of msg.messages){\r\n                  maxEndTime = Math.max(m.time, maxEndTime)\r\n                }\r\n                this.messages.push(...msg.messages)\r\n              }\r\n              for(const m of dbMedias){\r\n                maxEndTime = Math.max(m.endTime, m.startTime, maxEndTime)\r\n                const blobs:(Blob)[] = Array(m.blobs.length)\r\n                count += blobs.length\r\n                const media:MediaRecData = {\r\n                  id:m.id,\r\n                  pid:m.pid,\r\n                  cid:m.cid,\r\n                  role:m.role,\r\n                  kind:m.kind,\r\n                  startTime:m.startTime,\r\n                  endTime:m.endTime,\r\n                  blobs,\r\n                }\r\n                medias.push(media)\r\n                m.blobs.forEach((b, i)=>{\r\n                  dbBlobs.get(b).then((b:DBBlob)=>{\r\n                    blobs[i] = b.blob\r\n                    resolveAll()\r\n                  })\r\n                })\r\n              }\r\n              resolveAll()\r\n            }else{\r\n              reject()\r\n            }\r\n          })\r\n        })\r\n\r\n      })\r\n    })\r\n    return promise\r\n  }\r\n\r\n  private stopMediaRecordings(){\r\n    this.recording = false\r\n    let count = 0\r\n    const promise = new Promise<MediaRec[]>((resolve, reject)=>{\r\n      const resolveAll = ()=>{\r\n        count ++\r\n        if (count === medias.length){\r\n          resolve(medias)\r\n        }\r\n      }\r\n      const medias = this.stoppedMedias\r\n      medias.push(...this.medias.values())\r\n      if (medias.length){\r\n        for(const media of medias) {\r\n          if (media.state === 'inactive'){\r\n            resolveAll()\r\n          }else{\r\n            // eslint-disable-next-line no-loop-func\r\n            media.onData = () => { resolveAll() }\r\n            media.stop()\r\n          }\r\n        }\r\n      }else{\r\n        resolve(medias)\r\n      }\r\n    })\r\n\r\n    return promise\r\n  }\r\n\r\n  private makeRecord(medias: MediaRecData[], useDbData?: boolean){\r\n    const promise = new Promise<DBRecord>((resolve, reject) => {\r\n      dbRecords.where({title:''}).toArray().then((records)=>{\r\n        if (records.length){\r\n          const record = records.pop()\r\n          if (useDbData) this.startTime = record.time\r\n          const room = useDbData ? record.room : conference.room\r\n          const blob = this.makeBlob(medias)\r\n          const saveRecord:DBRecord = {\r\n            id: record.id,\r\n            room,\r\n            time: this.startTime,\r\n            duration: this.endTime - this.startTime,\r\n            title: `BMR_${room}_${dateTimeString(this.startTime)}`,\r\n            blob\r\n          }\r\n\r\n          let count = records.length + 1\r\n          const resolveAll = ()=>{\r\n            count--\r\n            if (count === 0){\r\n              resolve(saveRecord)\r\n            }\r\n          }\r\n\r\n          for(const r of records) {\r\n            dbRecords.delete(r.id).then(resolveAll)\r\n          }\r\n          dbRecords.put(saveRecord, saveRecord.id).then(()=>{\r\n            resolveAll()\r\n          }).catch(()=>{\r\n            reject('Failed to add record to IndexedDB')\r\n          })\r\n        }else{\r\n          const msg = 'The record created when starts to record not found in db.'\r\n          console.error(msg)\r\n          reject(msg)\r\n        }\r\n      })\r\n    })\r\n    return promise\r\n  }\r\n  private makeBlob(medias: MediaRecData[]){\r\n    const blobs:Blob[] = []\r\n    const headers:BlobHeader[] = []\r\n    const jsonPart:JSONPart = {startTime:this.startTime, endTime: this.endTime, messages:this.messages}\r\n    const blob = new Blob([JSON.stringify(jsonPart)], {type:'application/json'})\r\n    const header:BlobHeader = {role:'message', size:blob.size, kind:'json'}\r\n    blobs.push(blob)\r\n    headers.push(header)\r\n    for(const m of medias){\r\n      if (m.blobs.length){\r\n        const blob = new Blob(m.blobs)\r\n        const header:BlobHeader = {\r\n          pid:m.pid, cid: m.cid, role:m.role, size:blob.size, kind:m.kind,\r\n          time: m.startTime, duration: m.endTime - m.startTime}\r\n        if (blob.size){\r\n          blobs.push(blob)\r\n          headers.push(header)\r\n        }\r\n      }\r\n    }\r\n\r\n    blobs.unshift(new Blob([JSON.stringify(headers)], {type:'application/json'}))\r\n    const headerLen = new Uint32Array(1)\r\n    headerLen[0] = blobs[0].size\r\n    blobs.unshift(new Blob([headerLen]))\r\n    return new Blob(blobs, {type:'application/octet-stream'})\r\n  }\r\n  private saveMediaRecordings(){\r\n    let count = 0\r\n    const promise = new Promise<MediaRec[]>((resolve, reject)=>{\r\n      function resolveAll(){\r\n        count ++\r\n        if (count === medias.length){\r\n          resolve(medias)\r\n        }\r\n      }\r\n      const medias = Array.from(this.medias.values())\r\n      if (medias.length){\r\n        for(const media of medias) {\r\n          if (media.state === 'inactive'){\r\n            resolveAll()\r\n          }else{\r\n            media.onData = () => {\r\n              media.onData = ()=>{}\r\n              media.endTime = Date.now()\r\n              resolveAll()\r\n            }\r\n            media.requestData()\r\n          }\r\n        }\r\n      }else{\r\n        resolve(medias)\r\n      }\r\n    })\r\n    return promise\r\n  }\r\n\r\n  private observeAndRecordMedia(){\r\n    const remains = new Set(this.medias.keys()) //  medias which should be deleted\r\n    //  Participants\r\n    const all:(RemoteParticipant|LocalParticipant)[] = Array.from(participants.remote.values())\r\n    all.push(participants.local)\r\n    for(const p of all){\r\n      const vid = `pv_${p.id}`\r\n      remains.delete(vid)\r\n      if (p.tracks.avatarStream){\r\n        if (!this.medias.has(vid)){\r\n          const media = new MediaRec(p.tracks.avatarStream, 'avatar', 'video', vid, {pid:p.id})\r\n          this.medias.set(vid, media)\r\n          media.start()\r\n        }\r\n      }else{\r\n        const media = this.medias.get(vid)\r\n        if (media){\r\n          media.stop()\r\n          this.stoppedMedias.push(media)\r\n          this.medias.delete(vid)\r\n        }\r\n      }\r\n      const aid = `pa_${p.id}`\r\n      if (p.tracks.audioStream){\r\n        if (!this.medias.has(aid)){\r\n          const media = new MediaRec(p.tracks.audioStream, 'avatar', 'audio', aid, {pid:p.id})\r\n          this.medias.set(aid, media)\r\n          media.start()\r\n        }\r\n      }else{\r\n        const media = this.medias.get(aid)\r\n        if (media){\r\n          media.stop()\r\n          this.stoppedMedias.push(media)\r\n          this.medias.delete(aid)\r\n        }\r\n      }\r\n    }\r\n    //  Contents\r\n    const rtcContents = contents.getAllRtcContentIds()\r\n    for (const rcid of rtcContents){\r\n      const c = contents.find(rcid)\r\n      if (c && (c.type === 'screen' || c.type === 'camera')){\r\n        const tracks = contents.contentTracks.get(rcid)!.tracks\r\n        for(const track of tracks){\r\n          let id\r\n          if (track.kind === 'audio'){\r\n            id = `ca_${c.id}`\r\n          }else{\r\n            id = `cv_${c.id}`\r\n          }\r\n          remains.delete(id)\r\n          if (!this.medias.has(id)){\r\n            const stream = new MediaStream([track])\r\n            const media = new MediaRec(stream, c.type, track.kind as MediaKind, id, {cid:c.id})\r\n            this.medias.set(id, media)\r\n            media.start()\r\n            console.log(`Rec for ${id}: ${JSON.stringify(media)}`)\r\n          }\r\n        }\r\n      }\r\n    }\r\n    //  Remove when participat or content has removed\r\n    for(const id of remains){\r\n      const media = this.medias.get(id)\r\n      if (media){\r\n        media.stop()\r\n        this.stoppedMedias.push(media)\r\n        this.medias.delete(id)\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nclass MediaPlay{\r\n  blob: Blob\r\n  time: number\r\n  duration?: number\r\n  cid?:string\r\n  pid?:string\r\n  role:string\r\n  kind:MediaKind\r\n  constructor(blob: Blob, header:BlobHeader){\r\n    this.blob = blob\r\n    this.time = header.time!\r\n    this.duration = header.duration\r\n    this.cid = header.cid\r\n    this.pid = header.pid\r\n    this.role = header.role\r\n    if (header.kind === 'audio' || header.kind === 'video'){\r\n      this.kind = header.kind\r\n    }else{\r\n      this.kind = 'invalid'\r\n    }\r\n    //console.log(`MediaPlay URL:${URL.createObjectURL(this.blob)} ${JSON.stringify(this)}`)\r\n  }\r\n}\r\nclass Player{\r\n  messages: Message[] = []\r\n  medias: MediaPlay[] = []\r\n  startTime = 0\r\n  endTime = 0\r\n  @observable playing = false\r\n  constructor(){\r\n    makeObservable(this)\r\n  }\r\n\r\n  clear(){\r\n    this.messages = []\r\n    this.medias = []\r\n    this.startTime = 0\r\n    this.endTime = 0\r\n  }\r\n  load(archive: Blob){\r\n    this.clear()\r\n    const promise = new Promise<Player>((resolve) => {\r\n      let start = 0\r\n      archive.slice(start, start+4).arrayBuffer().then(buffer => {\r\n        start += 4\r\n        const view = new Int32Array(buffer)\r\n        const headerLen = view[0]\r\n        let count = 0\r\n        archive.slice(start, start+headerLen).text().then(text => {\r\n          start += headerLen\r\n          const headers = JSON.parse(text) as BlobHeader[]\r\n          //  console.log(JSON.stringify(headers))\r\n          for(const header of headers){\r\n            if (header.role === 'message'){\r\n              //  eslint-disable-next-line no-loop-func\r\n              archive.slice(start, start+header.size).text().then(text => {\r\n                const jsonPart = JSON.parse(text) as JSONPart\r\n                this.messages = jsonPart.messages\r\n                this.startTime = jsonPart.startTime\r\n                this.endTime = jsonPart.endTime\r\n                count ++\r\n                if (count === headers.length){ resolve(this) }\r\n              })\r\n            }else{\r\n              //  eslint-disable-next-line no-loop-func\r\n              archive.slice(start, start+header.size).arrayBuffer().then(ab => {\r\n                const blob = new Blob([ab])\r\n                this.medias.push(new MediaPlay(blob, header))\r\n                count ++\r\n                if (count === headers.length){ resolve(this) }\r\n              })\r\n            }\r\n            start += header.size\r\n          }\r\n          if (archive.size !== start){\r\n            console.error(`archive size ${archive.size} not matched to end of blobs ${start}.`)\r\n          }\r\n        })\r\n      })\r\n    })\r\n\r\n    return promise\r\n  }\r\n  play(){\r\n    this.playing = true\r\n    const messages = Array.from(this.messages)\r\n    const medias = Array.from(this.medias)\r\n    messages.sort((a,b) => a.time - b.time)\r\n    medias.sort((a,b) => a.time - b.time)\r\n    let time = this.startTime\r\n    const timeDiff = Date.now() - this.startTime\r\n    const step = () => {\r\n      time = Date.now() - timeDiff\r\n      while (messages.length && messages[0].time < time){\r\n        const message = messages.shift()!\r\n        player.playMessage(message.msg)\r\n      }\r\n      while (medias.length && medias[0].time < time){\r\n        const media = medias.shift()!\r\n        player.playMedia(media)\r\n        if (media.duration) {\r\n          setTimeout(()=>{\r\n            this.stopMedia(media)\r\n          }, media.duration)\r\n        }\r\n      }\r\n      if (time < player.endTime){\r\n        setTimeout(() => {step()}, 30)\r\n      }else{\r\n        this.cleanup()\r\n      }\r\n    }\r\n    step()\r\n  }\r\n  stop(){\r\n    player.endTime = 0\r\n  }\r\n  private pids = new Set<string>()\r\n  private cids = new Set<string>()\r\n  private cleanup(){\r\n    this.playing = false\r\n    this.pids.forEach(pid=>{\r\n      participants.removePlayback(pid)\r\n    })\r\n    this.cids.forEach(cid=>{\r\n      contents.removePlayback(cid)\r\n    })\r\n  }\r\n\r\n  private stopMedia(media:MediaPlay){\r\n    if (media.pid && media.role === 'avatar'){\r\n      const pid = `p_${media.pid}`\r\n      const p = participants.playback.get(pid)\r\n      if (p){\r\n        p.videoBlob = undefined\r\n      }\r\n    }\r\n  }\r\n  private playMedia(media:MediaPlay){\r\n      //  console.log(`media:${media.blob.type}, pid:${media.pid}, cid:${media.pid}, role:${media.role}`)\r\n    if (media.pid){\r\n      const pid = `p_${media.pid}`\r\n      this.pids.add(pid)\r\n      const obj = participants.getOrCreatePlayback(pid)\r\n      if (media.kind === 'audio'){\r\n        obj.audioBlob = media.blob\r\n      }else if (media.kind === 'video'){\r\n        obj.videoBlob = media.blob\r\n      }else{\r\n        console.error(`Unknown media kind ${media.kind}`)\r\n      }\r\n    }else if (media.cid){\r\n      const cid = `p_${media.cid}`\r\n      this.cids.add(cid)\r\n      const obj = contents.getOrCreatePlayback(cid)\r\n      if (media.kind === 'audio'){\r\n        obj.audioBlob = media.blob\r\n      }else if (media.kind === 'video'){\r\n        obj.videoBlob = media.blob\r\n        obj.url = URL.createObjectURL(media.blob)\r\n      }else{\r\n        console.error(`Unknown media kind ${media.kind}`)\r\n      }\r\n      contents.updatePlayback(obj)\r\n    }\r\n  }\r\n  private playMessage(msg: BMMessage){\r\n    //console.log(`playMessage ${msg.t}`, msg)\r\n    const pid = msg.p ? `p_${msg.p}` : ''\r\n    if (pid){ this.pids.add(pid) }\r\n    const p = pid ? participants.getOrCreatePlayback(pid) : undefined\r\n    let notHandled = true\r\n    const v = JSON.parse(msg.v)\r\n    if (p){\r\n      notHandled = false\r\n      switch(msg.t){\r\n        case MessageType.PARTICIPANT_INFO: p.information = v as RemoteInformation; break\r\n        case MessageType.PARTICIPANT_POSE: p.pose = str2Pose(v as string); break\r\n        case MessageType.PARTICIPANT_MOUSE: p.mouse = str2Mouse(v as string); break\r\n        case MessageType.PARTICIPANT_AFK: p.physics.awayFromKeyboard = v as boolean; break\r\n        case MessageType.PARTICIPANT_TRACKSTATES: Object.assign(p.trackStates, v as TrackStates); break\r\n        case MessageType.PARTICIPANT_VIEWPOINT: Object.assign(p.viewpoint, v as Viewpoint); break\r\n        case MessageType.PARTICIPANT_ON_STAGE: p.physics.onStage = v as boolean; break\r\n        case MessageType.PARTICIPANT_VRMRIG: p.vrmRigs = v as VRMRigs; break\r\n        default: notHandled = true; break\r\n      }\r\n    }\r\n    if (notHandled){\r\n      notHandled = false\r\n      switch(msg.t){\r\n        case MessageType.CONTENT_UPDATE_REQUEST: this.onContentUpdateRequest(msg); break\r\n        case MessageType.CONTENT_REMOVE_REQUEST: this.onContentRemoveRequest(msg); break\r\n        default: notHandled = true; break\r\n      }\r\n    }\r\n    if (notHandled){\r\n      console.warn(`Playback did not handle message:`, msg)\r\n    }\r\n  }\r\n  private onContentUpdateRequest(msg: BMMessage){\r\n    const cs = JSON.parse(msg.v) as IPlaybackContent[]\r\n    for(const c of cs){\r\n      //  console.log('CONTENT_UPDATE_REQUEST:', c)\r\n      c.id = `p_${c.id}`\r\n      const cur = contents.findPlayback(c.id)\r\n      if (cur){\r\n        c.audioBlob = cur.audioBlob\r\n        c.videoBlob = cur.videoBlob\r\n        c.url = cur.url\r\n      }\r\n      if (c.type === 'camera' || c.type === 'screen'){\r\n        c.type = c.type === 'camera' ? 'playbackCamera' : 'playbackScreen'\r\n      }\r\n      contents.updatePlayback(c)\r\n      this.cids.add(c.id)\r\n    }\r\n  }\r\n  private onContentRemoveRequest(msg: BMMessage){\r\n    const cids = JSON.parse(msg.v) as string[]\r\n    for(const cid of cids){\r\n      contents.removePlayback(`p_${cid}`)\r\n    }\r\n  }\r\n}\r\n\r\nexport const recorder = new Recorder()\r\nexport const player = new Player()\r\nd.recorder = recorder\r\nd.player = player\r\n","import {action, makeObservable, observable} from 'mobx'\r\n\r\n\r\nexport class RoomInfo{\r\n  /* defaultBackgroundFill = [0xDF, 0xDB, 0xE5]\r\n  defaultBackgroundColor = [0xB9, 0xB2, 0xC4] */\r\n  defaultBackgroundFill = [0xFF, 0xFF, 0xFF]\r\n  defaultBackgroundColor = [0xFF, 0xFF, 0xFF]\r\n\r\n  @observable roomProps = new Map<string, string>()\r\n  @observable password=''\r\n  @observable newPassword=''\r\n  @observable passMatched=false\r\n  @observable backgroundFill = this.defaultBackgroundFill\r\n  @observable backgroundColor = this.defaultBackgroundColor\r\n\r\n  @observable roomDetails=JSON.stringify({name:'',image:'',desc:''})\r\n\r\n  constructor() {\r\n    makeObservable(this)\r\n  }\r\n  @action onUpdateProp(key:string, val:string|undefined){\r\n    if (val === undefined){\r\n      this.roomProps.delete(key)\r\n    }else{\r\n      this.roomProps.set(key, val)\r\n    }\r\n    //  console.log(`onUpdateProp(${key}, ${val})`)\r\n    switch(key){\r\n      case 'backgroundFill': this.backgroundFill = val ? JSON.parse(val) : this.defaultBackgroundFill; break\r\n      case 'backgroundColor': this.backgroundColor = val ? JSON.parse(val) : this.defaultBackgroundColor; break\r\n      case 'roomDetails': this.roomDetails = val ? JSON.parse(val) : this.roomDetails; break\r\n    }\r\n  }\r\n}\r\n\r\nexport default new RoomInfo()\r\n","export function getNotificationPermission(){\r\n  if (Notification.permission !== 'granted' && Notification.permission !== 'denied') {\r\n    Notification.requestPermission()\r\n  }\r\n}\r\nexport function notification(title: string, options?: NotificationOptions){\r\n  if (Notification.permission === \"granted\") {\r\n    // tslint:disable-next-line: no-unused-expression\r\n    new Notification(title, options)\r\n  }\r\n}\r\n","import {recorder} from '@models/conference/Recorder'\r\nimport {ISharedContent, contentsToSend, ISharedContentToSend, receiveToContents} from '@models/ISharedContent'\r\nimport {CONTENT_OUT_OF_RANGE_VALUE} from '@models/ISharedContent'\r\nimport { KickTime } from '@models/KickTime'\r\nimport {t} from '@models/locales'\r\nimport {defaultRemoteInformation, PARTICIPANT_SIZE, RemoteInformation, TrackStates, Viewpoint, VRMRigs} from '@models/Participant'\r\nimport {urlParameters} from '@models/url'\r\nimport {mouse2Str, pose2Str, str2Mouse, str2Pose} from '@models/utils'\r\nimport {normV, subV2} from '@models/utils'\r\nimport {assert} from '@models/utils'\r\nimport chat, { ChatMessage, ChatMessageToSend } from '@stores/Chat'\r\nimport errorInfo from '@stores/ErrorInfo'\r\nimport {MediaSettings} from '@stores/participants/LocalParticipant'\r\nimport participants from '@stores/participants/Participants'\r\nimport roomInfo from '@stores/RoomInfo'\r\nimport contents from '@stores/sharedContents/SharedContents'\r\nimport {autorun, IReactionDisposer} from 'mobx'\r\nimport {BMMessage} from './DataMessage'\r\nimport {DataConnection} from './DataConnection'\r\nimport {MessageType} from './DataMessageType'\r\nimport {notification} from './Notification'\r\n\r\ndeclare const config:any             //  from ../../config.js included from index.html\r\nconst SYNC_LOG = false\r\nconst syncLog = SYNC_LOG ? console.log : () => {}\r\n\r\nexport class DataSync{\r\n  connection: DataConnection\r\n  disposers: IReactionDisposer[] = []\r\n\r\n  constructor(c:DataConnection) {\r\n    this.connection = c\r\n    //  setInterval(()=>{ this.checkRemoteAlive() }, 1000)\r\n  }\r\n  sendAllAboutMe(bSendRandP: boolean){\r\n    syncLog('sendAllAboutMe called.')\r\n    this.sendPoseMessage(bSendRandP)\r\n    this.sendMouseMessage()\r\n    participants.local.sendInformation()\r\n    this.sendOnStage()\r\n    this.sendTrackStates()\r\n    this.sendViewpointNow()\r\n    this.sendMyContents()\r\n    this.sendAfkChanged()\r\n  }\r\n  //\r\n  sendPoseMessage(bSendRandP: boolean){\r\n    const poseStr = pose2Str(participants.local.pose)\r\n    this.connection.sendMessage(MessageType.PARTICIPANT_POSE, poseStr, undefined, bSendRandP)\r\n  }\r\n  sendMouseMessage(){\r\n    const mouseStr = mouse2Str(participants.local.mouse)\r\n    this.connection.sendMessage(MessageType.PARTICIPANT_MOUSE, mouseStr)\r\n    //  console.log(`Mouse: ${mouseStr} sent.`)\r\n  }\r\n  sendParticipantInfo(){\r\n    if (!participants.local.informationToSend){ return }\r\n    this.connection.sendMessage(MessageType.PARTICIPANT_INFO, {...participants.local.informationToSend})\r\n    let name = participants.local.information.name\r\n    while(name.slice(0,1) === '_'){ name = name.slice(1) }\r\n  }\r\n  sendAudioLevel(){\r\n    this.connection.sendMessage(MessageType.AUDIO_LEVEL, participants.local.audioLevel)\r\n  }\r\n  sendOnStage(){\r\n    this.connection.sendMessage(MessageType.PARTICIPANT_ON_STAGE, participants.local.physics.onStage)\r\n  }\r\n  sendTrackStates() {\r\n    this.connection.sendMessage(MessageType.PARTICIPANT_TRACKSTATES,\r\n      {...participants.local.trackStates})\r\n  }\r\n  sendViewpointNow() {\r\n    this.connection.sendMessage(MessageType.PARTICIPANT_VIEWPOINT,\r\n        {...participants.local.viewpoint})\r\n  }\r\n  sendAfkChanged(){\r\n    this.connection.sendMessage(MessageType.PARTICIPANT_AFK, participants.local.physics.awayFromKeyboard)\r\n  }\r\n\r\n  //  Only for test (admin config dialog).\r\n  sendTrackLimits(to:string, limits?:number[]) {\r\n    this.connection.sendMessage(MessageType.PARTICIPANT_TRACKLIMITS, limits ? limits :\r\n      [participants.local.remoteVideoLimit, participants.local.remoteAudioLimit],  to ? to : undefined)\r\n  }\r\n  //  Send vrm rig\r\n  private sendVrmRig(){\r\n    this.connection.sendMessage(MessageType.PARTICIPANT_VRMRIG, participants.local.vrmRigs)\r\n    this.connection.flushSendMessages()\r\n  }\r\n  //  Send content update request to pid\r\n  sendContentUpdateRequest(pid: string, updatedContents: ISharedContent[]) {\r\n    const contentsDataToSend = contentsToSend(updatedContents)\r\n    this.connection.sendMessage(MessageType.CONTENT_UPDATE_REQUEST, contentsDataToSend, pid)\r\n  }\r\n  //  Send content remove request to pid\r\n  sendContentRemoveRequest(pid: string, removedIds: string[]) {\r\n    this.connection.sendMessage(MessageType.CONTENT_REMOVE_REQUEST, removedIds, pid)\r\n  }\r\n  //  send myContents of local to remote participants.\r\n  sendMyContents() {\r\n      this.sendContentUpdateRequest('', Array.from(contents.roomContents.values()))\r\n  }\r\n\r\n  //  message handler\r\n  private onRoomProp(key: string, value: string){\r\n    roomInfo.onUpdateProp(key, value)\r\n  }\r\n  private onParticipantTrackLimits(limits:number[]){\r\n    participants.local.remoteVideoLimit = limits[0]\r\n    participants.local.remoteAudioLimit = limits[1]\r\n  }\r\n  private onParticipantVrmRig(id:string|undefined, rig:VRMRigs){\r\n    if (id){\r\n      const remote = participants.getRemote(id)\r\n      if (remote) remote.vrmRigs = rig\r\n    }\r\n  }\r\n  private onParticipantLeft(ids: string[]){\r\n    for(const id of ids){\r\n      chat.participantLeft(id)\r\n      participants.leave(id)\r\n    }\r\n  }\r\n  private onChatMessage(pid: string|undefined, msg: ChatMessageToSend){\r\n    assert(pid)\r\n    //  console.log(`PRIVATE_MESSAGE_RECEIVED id:${id}, text:${msg.msg}, ts:${msg.ts}`)\r\n    const from = participants.find(pid)\r\n    if (from){\r\n      chat.addMessage(new ChatMessage(msg.msg, from.id, from.information.name,\r\n        from.information.avatarSrc, from.getColor(), msg.ts, msg.to ? 'private':'text'))\r\n    }\r\n  }\r\n  private onCallRemote(from:string|undefined){\r\n    assert(from)\r\n    const caller = participants.find(from)\r\n    if (caller){\r\n      chat.calledBy(caller)\r\n      if (participants.local.information.notifyCall){\r\n        notification(t('noCalled', {name: caller?.information.name}), {icon: './favicon.ico'})\r\n      }\r\n    }\r\n  }\r\n  private onAfkChanged(from:string|undefined, afk: boolean){\r\n    assert(from)\r\n    const remote = participants.find(from)\r\n    if (remote){ remote.physics.awayFromKeyboard = afk }\r\n  }\r\n  public onKicked(pid:string|undefined, reason:string){\r\n    assert(pid)\r\n    errorInfo.setType('kicked', participants.remote.get(pid)?.information.name, reason)\r\n    const str = window.localStorage.getItem('kickTimes')\r\n    let found:KickTime|undefined = undefined\r\n    let kickTimes:KickTime[] = []\r\n    if (this.connection.room){\r\n      if (str){\r\n        kickTimes = JSON.parse(str) as KickTime[]\r\n        found = kickTimes.find(kt => kt.room === this.connection.room)\r\n      }\r\n      if (!found){\r\n        found = {room:this.connection.room, time:0}\r\n        kickTimes.push(found)\r\n      }\r\n      found.time = Date.now()\r\n      window.localStorage.setItem('kickTimes', JSON.stringify(kickTimes))\r\n    }\r\n    setTimeout(()=>{\r\n      window.location.reload()\r\n    }, 10000)\r\n  }\r\n  private onParticipantOut(pids: string[]){\r\n    pids.forEach(pid => {\r\n      const participant = participants.find(pid)\r\n      if (participant){\r\n        participant.physics.located = false\r\n      }\r\n    })\r\n  }\r\n  private onMouseOut(pids: string[]){\r\n    pids.forEach(pid => {\r\n      const participant = participants.find(pid)\r\n      if (participant){\r\n        participant.mouse.position = [CONTENT_OUT_OF_RANGE_VALUE, CONTENT_OUT_OF_RANGE_VALUE]\r\n      }\r\n    })\r\n  }\r\n  private onContentOut(cids: string[]){\r\n    cids.forEach(cid => {\r\n      const content = contents.find(cid)\r\n      if (content){\r\n        const newContent = Object.assign({}, content)\r\n        newContent.pose = {position: [CONTENT_OUT_OF_RANGE_VALUE, CONTENT_OUT_OF_RANGE_VALUE],\r\n          orientation: content.pose.orientation}\r\n        contents.updateByRemoteRequest([newContent])\r\n        //  console.log(`content out ${cid}`)\r\n      }\r\n    })\r\n  }\r\n\r\n  private onParticipantInfo(from:string|undefined, info:RemoteInformation){\r\n    assert(from)\r\n    if (urlParameters.testBot !== null) { return }\r\n    if (from !== participants.localId){\r\n      const remote = participants.getOrCreateRemote(from)\r\n      if (!remote) return\r\n      const name = remote.information.name\r\n      Object.assign(remote.information, info)\r\n      if (name !== remote.information.name){\r\n        if (name === defaultRemoteInformation.name){\r\n          chat.participantJoined(from)\r\n        }else{\r\n          chat.participantNameChanged(from, name)\r\n        }\r\n      }\r\n      remote.informationReceived = true\r\n      syncLog(`Info of ${from} received.`)\r\n    }\r\n  }\r\n  private onParticipantTrackState(from:string|undefined, states:TrackStates){\r\n    assert(from)\r\n    if (urlParameters.testBot !== null) { return }\r\n\r\n    if (from !== participants.localId){\r\n      const remote = participants.getRemote(from)\r\n      if (!remote) return\r\n      Object.assign(remote.trackStates, states)\r\n    }\r\n  }\r\n  private onParticipantPose(from:string|undefined, poseStr:string){\r\n    assert(from)\r\n    if (from !== participants.localId){\r\n      const remote = participants.getRemote(from)\r\n      if (!remote) return\r\n      const pose = str2Pose(poseStr)\r\n      const local = participants.local\r\n      remote.pose.orientation = pose.orientation\r\n      remote.pose.position = pose.position\r\n      remote.physics.located = true\r\n      if (local.information.notifyNear || local.information.notifyTouch){\r\n        const distance = normV(subV2(remote.pose.position, local.pose.position))\r\n        const NEAR = PARTICIPANT_SIZE * 3\r\n        const TOUCH = PARTICIPANT_SIZE\r\n        if (remote.lastDistance > TOUCH &&  distance <= TOUCH\r\n          && local.information.notifyTouch){\r\n          notification(t('noTouched',{name: remote.information.name}), {icon: './favicon.ico'})\r\n        }else if (remote.lastDistance > NEAR && distance < NEAR && local.information.notifyNear){\r\n          notification(t('noNear', {name: remote.information.name}), {icon: './favicon.ico'})\r\n        }\r\n        remote.lastDistance = distance\r\n      }\r\n    }\r\n  }\r\n  private onParticipantAudioLevel(from:string|undefined, l:number){\r\n    if (from && from !== participants.localId){\r\n      const remote = participants.getRemote(from)\r\n      if (remote) remote.audioLevel = l\r\n    }\r\n  }\r\n  private onParticipantMouse(from:string|undefined, mouseStr:string){\r\n    assert(from)\r\n    const mouse = str2Mouse(mouseStr)\r\n    if (urlParameters.testBot !== null) { return }\r\n    if (from !== participants.localId){\r\n      const remote = participants.getRemote(from)\r\n      if (remote) Object.assign(remote.mouse, mouse)\r\n    }\r\n  }\r\n  private onParticipantOnStage(from:string|undefined, onStage:boolean){\r\n    assert(from)\r\n    if (from !== participants.localId){\r\n      const remote = participants.getRemote(from)\r\n      if (remote) remote.physics.onStage = onStage\r\n    }\r\n  }\r\n  private onParticipantViewpoint(from:string|undefined, viewpoint:Viewpoint){\r\n    assert(from)\r\n    if (urlParameters.testBot !== null) { return }\r\n\r\n    if (from !== participants.localId){\r\n      const remote = participants.getRemote(from)\r\n      if (remote) Object.assign(remote.viewpoint, viewpoint)\r\n    }\r\n  }\r\n  private onYarnPhone(from:string|undefined, connectedPids:string[]){\r\n    assert(from)\r\n    //  console.log(`yarn from ${from} local:${participants.localId}`)\r\n    const myself = connectedPids.find(id => id === participants.localId)\r\n    if (myself) {\r\n      if (!participants.yarnPhones.has(from)){\r\n        participants.yarnPhones.add(from)\r\n        if (participants.local.information.notifyYarn){\r\n          const remote = participants.find(from)\r\n          if (remote){\r\n            notification(t('noYarn', {name: remote.information.name}), {icon: './favicon.ico'})\r\n          }\r\n        }\r\n      }\r\n    }else {\r\n      participants.yarnPhones.delete(from)\r\n    }\r\n  }\r\n  private onMuteVideo(value: boolean){\r\n    const setting = {} as MediaSettings\r\n    participants.local.loadMediaSettingsFromStorage(setting)\r\n    participants.local.muteVideo = value || setting.stream.muteVideo\r\n  }\r\n  private onMuteAudio(value: boolean){\r\n    const setting = {} as MediaSettings\r\n    participants.local.loadMediaSettingsFromStorage(setting)\r\n    participants.local.muteAudio = value || setting.stream.muteAudio\r\n  }\r\n  private onReloadBrower(){\r\n    window.location.reload()\r\n  }\r\n  //  contents\r\n  private onContentInfoUpdate(cs:ISharedContent[]){\r\n    assert(config.bmRelayServer)\r\n    cs.forEach(c => contents.roomContentsInfo.set(c.id, c))\r\n  }\r\n  private onContentUpdateRequest(cds:ISharedContentToSend[]){\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    const cs = receiveToContents(cds)\r\n    contents.updateByRemoteRequest(cs)\r\n  }\r\n  private onContentRemoveRequest(cids:string[]){\r\n    contents.removeByRemoteRequest(cids)\r\n  }\r\n\r\n  observeStart(){\r\n    this.disposers.push(autorun(() => {\r\n      participants.remote.forEach((remote)=>{\r\n        if (remote.called){\r\n          remote.called = false\r\n          this.connection.sendMessage(MessageType.CALL_REMOTE, {}, remote.id)\r\n          chat.callTo(remote)\r\n        }\r\n      })\r\n    }))\r\n    this.disposers.push(autorun(this.sendAfkChanged.bind(this)))\r\n    this.disposers.push(autorun(this.sendParticipantInfo.bind(this)))\r\n    this.disposers.push(autorun(this.sendAudioLevel.bind(this)))\r\n    this.disposers.push(autorun(this.sendTrackStates.bind(this)))\r\n    this.disposers.push(autorun(this.sendPoseMessage.bind(this, false)))\r\n    this.disposers.push(autorun(this.sendMouseMessage.bind(this)))\r\n    this.disposers.push(autorun(this.sendViewpointNow.bind(this)))\r\n    this.disposers.push(autorun(this.sendOnStage.bind(this)))\r\n    this.disposers.push(autorun(this.sendVrmRig.bind(this)))\r\n\r\n    const sendYarnPhones = () => {\r\n      if (participants.yarnPhoneUpdated) {\r\n        participants.yarnPhoneUpdated = false\r\n        this.connection.sendMessage(MessageType.YARN_PHONE, Array.from(participants.yarnPhones))\r\n      }\r\n    }\r\n    this.disposers.push(autorun(() => { sendYarnPhones() }))\r\n  }\r\n  observeEnd() {\r\n    this.disposers.forEach(d => d())\r\n  }\r\n\r\n\r\n  // tslint:disable-next-line: cyclomatic-complexity\r\n  onBmMessage(msgs: BMMessage[]){\r\n    syncLog(`Recv data msg: ${msgs.map(m => m.t).reduce((p, c)=>`${p} ${c}`,'')}.`)\r\n    //syncLog(`Recv data msg: ${JSON.stringify(msgs)}.`)\r\n    for(const msg of msgs){\r\n      recorder.recordMessage(msg)\r\n      switch(msg.t){\r\n        case MessageType.ROOM_PROP: this.onRoomProp(...(JSON.parse(msg.v) as [string, string])); break\r\n        case MessageType.REQUEST_TO: this.sendAllAboutMe(false); break\r\n        case MessageType.PARTICIPANT_AFK: this.onAfkChanged(msg.p, JSON.parse(msg.v)); break\r\n        case MessageType.PARTICIPANT_LEFT: this.onParticipantLeft(JSON.parse(msg.v)); break\r\n        case MessageType.CALL_REMOTE: this.onCallRemote(msg.p); break\r\n        case MessageType.CHAT_MESSAGE: this.onChatMessage(msg.p, JSON.parse(msg.v)); break\r\n        case MessageType.CONTENT_REMOVE_REQUEST: this.onContentRemoveRequest(JSON.parse(msg.v)); break\r\n        case MessageType.CONTENT_UPDATE_REQUEST: this.onContentUpdateRequest(JSON.parse(msg.v)); break\r\n        case MessageType.CONTENT_INFO_UPDATE: this.onContentInfoUpdate(JSON.parse(msg.v)); break\r\n        case MessageType.PARTICIPANT_INFO: this.onParticipantInfo(msg.p, JSON.parse(msg.v)); break\r\n        case MessageType.PARTICIPANT_MOUSE: this.onParticipantMouse(msg.p, JSON.parse(msg.v)); break\r\n        case MessageType.PARTICIPANT_POSE: this.onParticipantPose(msg.p, JSON.parse(msg.v)); break\r\n        case MessageType.PARTICIPANT_ON_STAGE: this.onParticipantOnStage(msg.p, JSON.parse(msg.v)); break\r\n        case MessageType.PARTICIPANT_TRACKSTATES: this.onParticipantTrackState(msg.p, JSON.parse(msg.v)); break\r\n        case MessageType.PARTICIPANT_VIEWPOINT: this.onParticipantViewpoint(msg.p, JSON.parse(msg.v)); break\r\n        case MessageType.AUDIO_LEVEL: this.onParticipantAudioLevel(msg.p, JSON.parse(msg.v)); break\r\n        case MessageType.PARTICIPANT_TRACKLIMITS: this.onParticipantTrackLimits(JSON.parse(msg.v)); break\r\n        case MessageType.PARTICIPANT_VRMRIG: this.onParticipantVrmRig(msg.p, JSON.parse(msg.v)); break\r\n        case MessageType.YARN_PHONE: this.onYarnPhone(msg.p, JSON.parse(msg.v)); break\r\n        case MessageType.RELOAD_BROWSER: this.onReloadBrower(); break\r\n        case MessageType.MUTE_VIDEO: this.onMuteVideo(JSON.parse(msg.v)); break\r\n        case MessageType.MUTE_AUDIO: this.onMuteAudio(JSON.parse(msg.v)); break\r\n        case MessageType.KICK: this.onKicked(msg.p, JSON.parse(msg.v)); break\r\n        case MessageType.PARTICIPANT_OUT: this.onParticipantOut(JSON.parse(msg.v)); break\r\n        case MessageType.MOUSE_OUT: this.onMouseOut(JSON.parse(msg.v)); break\r\n        case MessageType.CONTENT_OUT: this.onContentOut(JSON.parse(msg.v)); break\r\n        default:\r\n          console.log(`Unhandled message type ${msg.t} from ${msg.p}`)\r\n          break\r\n      }\r\n    }\r\n    this.checkInfo()\r\n  }\r\n  checkInfo(){\r\n    const remotes = Array.from(participants.remote.values())\r\n    const ids = remotes.filter(remote => !remote.informationReceived).map(remote => remote.id)\r\n    if (ids.length){\r\n      syncLog(`checkInfo sent ${ids}`)\r\n      this.connection.pushOrUpdateMessageViaRelay(MessageType.REQUEST_TO, ids)\r\n    }\r\n  }\r\n}\r\n","import {MSTrack} from '@models/utils'\r\n\r\nexport class AudioMeter{\r\n  context?: AudioContext\r\n  analyser?: AnalyserNode\r\n  source?: MediaStreamAudioSourceNode\r\n  private BUFFERLEN = 32\r\n  setSource(track?: MSTrack){\r\n    //  close previous graph\r\n    this.source?.disconnect()\r\n    this.analyser?.disconnect()\r\n    this.context?.close()\r\n    this.source = undefined\r\n    this.analyser = undefined\r\n    this.context = undefined\r\n    //  create new graph\r\n    if (track){\r\n      this.context = new AudioContext();\r\n      this.analyser = this.context.createAnalyser();\r\n      this.source = this.context.createMediaStreamSource(new MediaStream([track.track]));\r\n      if (this.analyser && this.source){\r\n        this.source.connect(this.analyser)\r\n        //  Never connect to destination. It will output the sound.\r\n        //  this.analyser.connect(this.context.destination)\r\n        this.analyser.fftSize = this.BUFFERLEN\r\n      }\r\n    }\r\n  }\r\n  getAudioLevel(){\r\n    if (!this.context) return 0\r\n    if (this.context.state === 'suspended') {\r\n      this.context.resume();\r\n    }\r\n    const buffer = new Float32Array(this.BUFFERLEN)\r\n    this.analyser?.getFloatTimeDomainData(buffer)\r\n    const volume = buffer.reduce((prev, cur)=>prev+Math.abs(cur), 0) / this.BUFFERLEN\r\n    //  console.log(`local audio level ${volume}`)\r\n    return volume\r\n  }\r\n}\r\n\r\n","import {MAP_SIZE} from '@components/Constants'\r\nimport {recorder} from '@models/conference/Recorder'\r\nimport {assert} from '@models/utils'\r\nimport map from '@stores/Map'\r\nimport {default as participants} from '@stores/participants/Participants'\r\nimport roomInfo from '@stores/RoomInfo'\r\nimport {BMMessage} from './DataMessage'\r\nimport {ClientToServerOnlyMessageType, MessageType, ObjectArrayMessageTypes, StringArrayMessageTypes} from './DataMessageType'\r\nimport {DataSync} from '@models/conference/DataSync'\r\nimport {AudioMeter} from '@models/audio/AudioMeter'\r\n\r\n\r\n//  Log level and module log options\r\nexport const DATACONLOG = false\r\nexport const dataLog = DATACONLOG ? console.log : (a:any) => {}\r\nexport const dataDebug = DATACONLOG ? console.debug : (a:any) => {}\r\nexport let dataRequestInterval:number = 100\r\n\r\n// config.js\r\ndeclare const config:any             //  from ../../config.js included from index.html\r\n\r\n//  Cathegolies of BMMessage's types\r\nconst stringArrayMessageTypesForClient = new Set(StringArrayMessageTypes)\r\nstringArrayMessageTypesForClient.add(ClientToServerOnlyMessageType.CONTENT_UPDATE_REQUEST_BY_ID)\r\nstringArrayMessageTypesForClient.add(ClientToServerOnlyMessageType.REQUEST_PARTICIPANT_STATES)\r\n\r\n\r\nexport class DataConnection {\r\n  relaySocket:WebSocket|undefined = undefined //  Socket for message passing via separate relay server\r\n  private peer_=''\r\n  public get peer(){ return this.peer_ }\r\n  private room_=''\r\n  public get room(){ return this.room_ }\r\n  private lastRequestTime = Date.now()\r\n  private lastReceivedTime = Date.now()\r\n  private messagesToSendToRelay: BMMessage[] = []\r\n  private relayRttLast = 50\r\n  private relayRttAverage = 50\r\n\r\n  private sync_ = new DataSync(this)\r\n  public get sync() { return this.sync_ }\r\n  private audioMeter_ = new AudioMeter()\r\n  public get audioMeter() {return this.audioMeter_}\r\n\r\n  public isConnected(){\r\n    return this.relaySocket?.readyState === WebSocket.OPEN\r\n  }\r\n  public setRoomProp(name:string, value:string){\r\n    //  console.log(`setRoomProp(${name}, ${value})`)\r\n    this.pushOrUpdateMessageViaRelay(MessageType.ROOM_PROP, [name, value])\r\n    roomInfo.onUpdateProp(name, value)\r\n  }\r\n\r\n  public connect(room: string, peer: string){\r\n    this.room_ = room\r\n    this.peer_ = peer\r\n    dataLog(`connect(${room}, ${peer})`)\r\n\r\n    const promise = new Promise<void>((resolve, reject)=>{\r\n      if (!config.bmRelayServer){ reject(); return }\r\n      if (this.relaySocket){ resolve(); return }\r\n      const onOpen = () => {\r\n        dataLog(`dataConn socket onOpen`)\r\n        this.messagesToSendToRelay = []\r\n        this.sync.sendAllAboutMe(true)\r\n        this.pushOrUpdateMessageViaRelay(MessageType.REQUEST_ALL, {})\r\n        this.flushSendMessages()\r\n      }\r\n      const onMessage = (ev: MessageEvent<any>)=> {\r\n        //  console.log(`ws:`, ev)\r\n        if (typeof ev.data === 'string') {\r\n          this.lastReceivedTime = Date.now()\r\n          this.relayRttLast = this.lastReceivedTime - this.lastRequestTime\r\n\r\n          const msgs = JSON.parse(ev.data) as BMMessage[]\r\n          //  console.log(`Relay sock onMessage len:${msgs.length}`)\r\n          //*\r\n          if (msgs.length){\r\n            this.receivedMessages.push(...msgs)\r\n          }\r\n          const alpha = 0.3\r\n          if (msgs.length){\r\n            this.relayRttAverage = alpha * this.relayRttLast + (1-alpha) * this.relayRttAverage\r\n          }\r\n        }\r\n      }\r\n      const onClose = () => {\r\n        setTimeout(()=>{\r\n          this.relaySocket = new WebSocket(config.bmRelayServer)\r\n          setHandler()\r\n        }, 5 * 1000)\r\n      }\r\n      const onError = () => {\r\n        console.error(`Error in WebSocket for ${config.bmRelayServer}`)\r\n        this.relaySocket?.close(3000, 'onError')\r\n        onClose()\r\n      }\r\n      const setHandler = () => {\r\n        this.relaySocket?.addEventListener('error', onError)\r\n        this.relaySocket?.addEventListener('message', onMessage)\r\n        this.relaySocket?.addEventListener('open', onOpen)\r\n        this.relaySocket?.addEventListener('close', onClose)\r\n      }\r\n      this.relaySocket = new WebSocket(config.bmRelayServer)\r\n      setHandler()\r\n      //  start periodical communication with relay server.\r\n      this.step()\r\n      this.sync.observeStart()\r\n      this.sync.sendAllAboutMe(true)\r\n    })\r\n    return promise\r\n  }\r\n  public disconnect(){\r\n    if (config.bmRelayServer && this.peer){\r\n      this.sync.observeEnd()\r\n      this.pushOrUpdateMessageViaRelay(MessageType.PARTICIPANT_LEFT, [this.peer])\r\n      this.flushSendMessages()\r\n    }\r\n    //  stop relayServer communication.\r\n    this.stopStep = true\r\n    this.room_ = ''\r\n    this.peer_ = ''\r\n    this.relaySocket?.close()\r\n    this.relaySocket = undefined\r\n  }\r\n\r\n  private updateAudioLevel(){\r\n    if (participants.local.trackStates.micMuted){\r\n      participants.local.setAudioLevel(0)\r\n    }else{\r\n      participants.local.setAudioLevel(this.audioMeter.getAudioLevel())\r\n    }\r\n  }\r\n\r\n\r\n  private stopStep = false\r\n  private step(){\r\n    const period = 50\r\n    if (this.relaySocket?.readyState === WebSocket.OPEN){\r\n      const timeToProcess = period * 0.8\r\n      const deadline = Date.now() + timeToProcess\r\n      while(Date.now() < deadline && this.receivedMessages.length){\r\n        const msg = this.receivedMessages.shift()\r\n        if (msg){\r\n          this.sync.onBmMessage([msg])\r\n        }\r\n      }\r\n      dataRequestInterval = Math.min(\r\n        //Math.max((this.relayRttAverage-20) * participants.remote.size/40, 0) + 20, 3*1000)\r\n        Math.max((this.relayRttAverage-20), 0) + 20, 3*1000)\r\n        //console.log(`RTTAve:${this.relayRttAverage.toFixed(2)} Last:${this.relayRttLast}  dataRequestInterval=${dataRequestInterval}`)\r\n        const REQUEST_WAIT_TIMEOUT = dataRequestInterval + 20 * 1000  //  wait 20 sec when failed to receive message.\r\n      const now = Date.now()\r\n      if (now < deadline && this.relaySocket && !this.receivedMessages.length\r\n        && now - this.lastRequestTime > dataRequestInterval\r\n        && (this.lastReceivedTime >= this.lastRequestTime\r\n          || now - this.lastRequestTime > REQUEST_WAIT_TIMEOUT)){\r\n          this.lastRequestTime = now\r\n          const area = recorder.recording ? [-MAP_SIZE*2, MAP_SIZE*2, MAP_SIZE*2, -MAP_SIZE*2]\r\n            : map.visibleArea()\r\n          this.pushOrUpdateMessageViaRelay(MessageType.REQUEST_RANGE, [area, participants.audibleArea()])\r\n          this.updateAudioLevel()\r\n          this.flushSendMessages()\r\n      }\r\n      //  console.log(`step RTT:${this.relayRttAverage} remain:${deadline - Date.now()}/${timeToProcess}`)\r\n    }\r\n    if (!this.stopStep){\r\n      setTimeout(()=>{this.step()}, period)\r\n    }else{\r\n      this.stopStep = false\r\n    }\r\n  }\r\n\r\n  sendMessage(type:string, value:any, to?: string, sendRandP?: boolean) {\r\n      this.pushOrUpdateMessageViaRelay(type, value, to, sendRandP)\r\n  }\r\n  receivedMessages: BMMessage[] = []\r\n\r\n  pushOrUpdateMessageViaRelay(type:string, value:any, dest?:string, sendRandP?:boolean) {\r\n    assert(config.bmRelayServer)\r\n    if (!this.relaySocket || this.relaySocket.readyState !== WebSocket.OPEN){ return }\r\n    if (!this.room || !this.peer){\r\n      console.warn(`Relay Socket: Not connected. room:${this.room} id:${this.peer}.`)\r\n\r\n      return\r\n    }\r\n\r\n\r\n    const msg:BMMessage = {t:type, v:''}\r\n    if (sendRandP) {\r\n      msg.r = this.room\r\n      msg.p = this.peer\r\n    }\r\n    if (dest){\r\n      msg.d = dest\r\n    }\r\n    const idx = this.messagesToSendToRelay.findIndex(m =>\r\n      m.t === msg.t && m.r === msg.r && m.p === msg.p && m.d === msg.d)\r\n    if (idx >= 0){\r\n      if (stringArrayMessageTypesForClient.has(msg.t)){\r\n        const oldV = JSON.parse(this.messagesToSendToRelay[idx].v) as string[]\r\n        for(const ne of value as string[]){\r\n          if (oldV.findIndex(e => e === ne) < 0){ oldV.push(ne) }\r\n        }\r\n        this.messagesToSendToRelay[idx].v = JSON.stringify(oldV)\r\n      }else if (ObjectArrayMessageTypes.has(msg.t)){\r\n        const oldV = JSON.parse(this.messagesToSendToRelay[idx].v) as {id:string}[]\r\n        for(const ne of value as {id:string}[]){\r\n          const found = oldV.findIndex(e => e.id === ne.id)\r\n          if (found >= 0){\r\n            oldV[found] = ne\r\n          }else{\r\n            oldV.push(ne)\r\n          }\r\n        }\r\n        this.messagesToSendToRelay[idx].v = JSON.stringify(oldV)\r\n      }else{  //  overwrite\r\n        //console.log(`overwrite messageType: ${msg.t}`)\r\n        msg.v = JSON.stringify(value)\r\n        this.messagesToSendToRelay[idx] = msg\r\n      }\r\n    }else{\r\n      msg.v = JSON.stringify(value)\r\n      this.messagesToSendToRelay.push(msg)\r\n      //console.log(`msg:${JSON.stringify(msg)} messages: ${JSON.stringify(this.messagesToSendToRelay)}`)\r\n    }\r\n\r\n    if (recorder.recording){\r\n      msg.p = this.peer\r\n      recorder.recordMessage(msg)\r\n    }\r\n  }\r\n  public flushSendMessages() {\r\n    if (this.messagesToSendToRelay.length === 0){ return }\r\n\r\n    if (this.relaySocket?.readyState === WebSocket.OPEN){\r\n      this.relaySocket.send(JSON.stringify(this.messagesToSendToRelay))\r\n      //  console.log(`Sent bmMessages: ${JSON.stringify(this.messagesToSendToRelay)}`)\r\n      this.messagesToSendToRelay = []\r\n    }else{\r\n      //  console.log(`Wait to send bmMessages: ${JSON.stringify(this.messagesToSendToRelay)}`)\r\n      this.relaySocket?.addEventListener('open', ()=> {\r\n        const waitAndSend = ()=>{\r\n          if(this.relaySocket?.readyState !== WebSocket.OPEN){\r\n            setTimeout(waitAndSend, 100)\r\n          }else{\r\n            this.relaySocket?.send(JSON.stringify(this.messagesToSendToRelay))\r\n            this.messagesToSendToRelay = []\r\n          }\r\n        }\r\n        waitAndSend()\r\n      })\r\n    }\r\n  }\r\n}\r\n","import {Conference, RemoteProducer} from '@models/conference'\r\nimport {isContentRtc} from '@models/ISharedContent'\r\nimport {PARTICIPANT_SIZE} from '@models/Participant'\r\nimport {participantsStore as participants} from '@stores/participants'\r\nimport {LocalParticipant} from '@stores/participants/LocalParticipant'\r\nimport contents from '@stores/sharedContents/SharedContents'\r\nimport {autorun, IReactionDisposer, makeObservable, observable} from 'mobx'\r\nimport {RemoteObjectInfo, LocalObjectInfo} from './priorityTypes'\r\n\r\nexport const PRIORITYLOG = true\r\nexport const priorityLog = PRIORITYLOG ? console.log : (a:any) => {}\r\nexport const priorityDebug = PRIORITYLOG ? console.debug : (a:any) => {}\r\n\r\nfunction getIdFromProducer(p: RemoteProducer){\r\n  if (p.role === 'avatar') return p.peer.peer\r\n  return p.role\r\n}\r\n\r\nfunction extractRemoteObjectInfo(producer: RemoteProducer): RemoteObjectInfo|undefined {\r\n  if (producer.role === 'avatar'){\r\n    const participant = participants.getRemote(producer.peer.peer)!\r\n    return participant ? {\r\n      id: producer.peer.peer,\r\n      producer,\r\n      onStage : producer.kind === 'audio' &&\r\n        (participant.physics.onStage || participants.yarnPhones.has(participant.id) || participant.inLocalsZone),\r\n      pose: {\r\n        ...participant.pose,\r\n      },\r\n      size: [0, 0],\r\n      offset: 0,\r\n      priority : 0,\r\n      muted: producer.kind === 'audio' ? participant.muteAudio : participant.muteVideo\r\n    } : undefined\r\n  }else if(producer.role === 'mainScreen'){\r\n    return {\r\n      id: producer.role,\r\n      producer,\r\n      onStage : true,\r\n      pose: {position:[0, 0], orientation: 0},\r\n      size: [0, 0],\r\n      offset: -PARTICIPANT_SIZE * 100,\r\n      priority : 0,\r\n      muted: false,\r\n    }\r\n  }else{\r\n    const content = contents.find(producer.role)!\r\n    return content ? {\r\n      id:producer.role,\r\n      producer,\r\n      onStage : false,\r\n      pose: {\r\n        ...content.pose,\r\n      },\r\n      size: content.size,\r\n      offset: producer.kind==='video' ? -PARTICIPANT_SIZE * 10 : 0,\r\n      priority : 0,\r\n      muted: false,\r\n    } : undefined\r\n  }\r\n}\r\n\r\nfunction extractLocalObjectInfo(participant: LocalParticipant): LocalObjectInfo {\r\n  return {\r\n    id: participant.id,\r\n    pose: {\r\n      ...participant.pose,\r\n    },\r\n    onStage: false,\r\n  }\r\n}\r\n\r\nexport interface VideoAudioTrackInfo{\r\n  videos: RemoteObjectInfo[]\r\n  audios: RemoteObjectInfo[]\r\n}\r\nexport function videoAudioTrackInfoDiff(a:VideoAudioTrackInfo, b:VideoAudioTrackInfo){\r\n  return {\r\n    videos: a.videos.filter(a => !b.videos.find(b => a.id === b.id)),\r\n    audios: a.audios.filter(a => !b.audios.find(b => a.id === b.id)),\r\n  }\r\n}\r\nexport function trackInfoMerege(va:VideoAudioTrackInfo){\r\n  return [...va.audios, ...va.videos]\r\n}\r\n\r\nexport class PriorityCalculator {\r\n  // props cache\r\n  private local: LocalObjectInfo\r\n\r\n  // batch update\r\n  private updateAll = true      // true when local participant is changed\r\n  private readonly updateSet = new Set<string>() // store changed remote participant\r\n  private limits = [-1, -1]     // limits on maximum numbers of remote video and audio tracks.\r\n  private limitUpdated = false  // true when local participant.remoteVideoLimit orremoteAudioLimit changes\r\n\r\n  // priority cache\r\n  private readonly priorityMaps = [new Map<string, RemoteObjectInfo>(), new Map<string, RemoteObjectInfo>()]\r\n  lastContentVideos: string[] = []\r\n  lastParticipantVideos: string[] = []\r\n  lastAudios: string[] = []\r\n\r\n  // list of observable track info lists\r\n  @observable.ref tracksToConsume:VideoAudioTrackInfo = {videos:[], audios:[]}\r\n\r\n  private disposers: IReactionDisposer[] = []\r\n  private _enabled = false\r\n\r\n  private conference: Conference\r\n  constructor(conf:Conference) {\r\n    const recalculateInterval = 500\r\n    this.conference = conf\r\n    let intervalHandle: number | undefined = undefined\r\n    this.conference.rtcConnection.addListener('connect', ()=>{\r\n      this.enable()\r\n      intervalHandle = window.setInterval(\r\n        () => {this.update()},\r\n        recalculateInterval,\r\n      )\r\n    })\r\n    this.conference.rtcConnection.addListener('disconnect', ()=>{\r\n      this.disable()\r\n      if (intervalHandle !== undefined) {\r\n        clearInterval(intervalHandle)\r\n      }\r\n    })\r\n    autorun(() => {\r\n      const local = participants.local\r\n      this.setLimits([local.remoteVideoLimit, local.remoteAudioLimit])\r\n    })\r\n\r\n    this.local = extractLocalObjectInfo(participants.local)\r\n    makeObservable(this)\r\n  }\r\n\r\n  public clear(){\r\n    this.disable()\r\n    this.updateAll = true\r\n    this.updateSet.clear()\r\n    this.priorityMaps.forEach(m => m.clear())\r\n    this.tracksToConsume = {videos:[],audios:[]}\r\n    this.lastContentVideos = []\r\n    this.lastParticipantVideos = []\r\n    this.lastAudios = []\r\n  }\r\n\r\n  public setLimits(limits:number[]):void {\r\n    this.limits[0] = limits[0]\r\n    this.limits[1] = limits[1]\r\n    this.limitUpdated = true\r\n  }\r\n\r\n  private UPDATE_INTERVAL = 500\r\n  private intervalId:number = 0\r\n  // start observing participants store\r\n  public enable() {\r\n    // track local change\r\n    const localChangeDisposer = autorun(() => {\r\n      const local = participants.local\r\n      this.local = extractLocalObjectInfo(local)\r\n      this.updateAll = true\r\n    })\r\n    this.disposers = [localChangeDisposer]\r\n    this.intervalId = window.setInterval(()=>{this.update()}, this.UPDATE_INTERVAL)\r\n    this.updateAll = true\r\n    this._enabled = true\r\n  }\r\n\r\n  // stop observing participants store\r\n  public disable() {\r\n    window.clearInterval(this.intervalId)\r\n    this.intervalId = 0\r\n    this.disposers.forEach(disposer => disposer())\r\n\r\n    this._enabled = false\r\n  }\r\n\r\n  // update lastPriority\r\n  private update() {\r\n    if (!this.haveUpdates) { return }\r\n\r\n    this.calcPriority()\r\n\r\n    this.updateAll = false\r\n    this.updateSet.clear()\r\n    this.limitUpdated = false\r\n  }\r\n\r\n  private calcPriority() {\r\n    //  list remote peers\r\n    const producersForMainScreen: RemoteProducer[] = []\r\n    this.conference.remotePeers.forEach(peer => {\r\n      for(const producer of peer.producers){\r\n        const id = getIdFromProducer(producer)\r\n        if (this.updateAll || this.updateSet.has(id)){\r\n          if (producer.role === 'mainScreen'){\r\n            //  Do nothing here for mainScreen. add later.\r\n            producersForMainScreen.push(producer)\r\n          }else{\r\n            const objInfo = extractRemoteObjectInfo(producer)\r\n            if (objInfo){\r\n              objInfo.priority = this.calcPriorityValue(this.local, objInfo)\r\n              this.priorityMaps[producer.kind === 'video' ? 0 : 1].set(id, objInfo)\r\n            }\r\n          }\r\n        }\r\n      }\r\n    })\r\n\r\n    //  update prioritizedTrackLists\r\n    const prioritizedTrackInfoLists = this.priorityMaps.map(priorityMap =>\r\n      Array.from(priorityMap.values()).sort((a, b) => a.priority - b.priority)\r\n    ) as [RemoteObjectInfo[], RemoteObjectInfo[]]\r\n\r\n    //  add main tracks\r\n    for(const producer of producersForMainScreen){\r\n      const info = extractRemoteObjectInfo(producer)\r\n      if (info){\r\n        prioritizedTrackInfoLists[producer.kind === 'video' ? 0 : 1].unshift(info)\r\n        this.conference.removeLocalTrackByRole('mainScreen')\r\n      }\r\n    }\r\n\r\n    //  limit length\r\n    const videos = prioritizedTrackInfoLists[0].filter(info => !info.muted)\r\n    if (videos.length > this.limits[0]) videos.length = this.limits[0]\r\n    const audios = prioritizedTrackInfoLists[1].filter(info => !info.muted)\r\n    if (videos.length > this.limits[1]) videos.length = this.limits[1]\r\n\r\n    //  done\r\n    this.tracksToConsume = {videos, audios}\r\n    /*\r\n    const vstrs = videos.map(i => i.producer.role==='avatar' ? 'p:' + i.producer.peer.peer : 'c:'+i.producer.role)\r\n    const astrs = audios.map(i => i.producer.role==='avatar' ? 'p:' + i.producer.peer.peer : 'c:'+i.producer.role)\r\n    console.log(`Priority: video=${vstrs} audio=${astrs}`)\r\n    //  */\r\n  }\r\n\r\n  // lower value means higher priority\r\n  private calcPriorityValue(local: LocalObjectInfo, remote: RemoteObjectInfo): number {\r\n    if (remote.onStage) { return 0 }\r\n    const delta = remote.size.map((sz, idx) => {\r\n      let diff:number = remote.pose.position[idx] - local.pose.position[idx]\r\n      if (diff < 0) {\r\n        diff += sz\r\n        if (diff > 0) { diff = 0 }\r\n      }\r\n\r\n      return diff\r\n    })\r\n    const distance = Math.sqrt(delta[0] * delta[0] + delta[1] * delta[1]) + remote.offset\r\n\r\n    return distance\r\n  }\r\n\r\n  private get haveUpdates(): boolean {\r\n    return this.updateAll || this.updateSet.size !== 0 || this.limitUpdated\r\n  }\r\n\r\n\r\n  private remoteDisposers = new Map<string, IReactionDisposer>()\r\n  public onRemoveProducer(producer: RemoteProducer){\r\n    const others = producer.peer.producers.filter(p => p.role === producer.role)\r\n    const id = getIdFromProducer(producer)\r\n    const index = producer.kind === 'audio' ? 1 : 0\r\n    this.priorityMaps[index].delete(id)\r\n\r\n    if (others.length === 0){ //  remove\r\n      if (id !== 'mainScreen'){\r\n        this.onRemoveObject(id)\r\n      }\r\n    }else{\r\n      this.updateSet.add(id)\r\n    }\r\n  }\r\n  private onRemoveObject(id: string){\r\n    const disposer = this.remoteDisposers.get(id)\r\n    if (disposer === undefined) {\r\n      throw new Error(`Cannot find disposer for remote object with id: ${id}`)\r\n    }\r\n    disposer()\r\n    this.remoteDisposers.delete(id)\r\n    this.updateSet.add(id)\r\n    priorityLog('onRemoveObject:', id, this.priorityMaps[0])\r\n  }\r\n  public onAddProducer(producer: RemoteProducer){\r\n    const id = getIdFromProducer(producer)\r\n    if (this.remoteDisposers.has(id)){\r\n      this.updateSet.add(id)\r\n    }else{\r\n      if (producer.role === 'avatar'){\r\n        this.remoteDisposers.set(id, autorun(() => {\r\n          const rp = participants.remote.get(id)\r\n          if (rp){\r\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n            const important = rp.physics.onStage || participants.yarnPhones.has(rp.id)\r\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n            const moved = rp.pose.position\r\n            this.updateSet.add(id)\r\n          }\r\n        }))\r\n      }else if (producer.role === 'mainScreen') {\r\n        this.updateSet.add(id)\r\n      }else {  //  contents\r\n        this.remoteDisposers.set(id, autorun(() => {\r\n          const c = contents.roomContents.get(id)\r\n          if (isContentRtc(c)){\r\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n            const moved = c!.pose.position\r\n          }\r\n          this.updateSet.add(id)\r\n        }))\r\n      }\r\n    }\r\n  }\r\n}\r\n","import * as mediasoup from 'mediasoup-client'\r\nexport type MSMessageType = 'connect' | 'join' | 'rtpCapabilities' | 'leave' |\r\n  'remoteUpdate' | 'remoteLeft' |\r\n  'workerAdd' | 'workerDelete' | 'workerUpdate' |\r\n  'createTransport' | 'closeTransport' | 'connectTransport' |\r\n  'produceTransport' | 'closeProducer' | 'consumeTransport' | 'resumeConsumer'\r\nexport interface MSMessage{\r\n  type: MSMessageType\r\n  sn?: number\r\n}\r\nexport interface MSPeerMessage extends MSMessage{\r\n  peer: string\r\n  remote?: string\r\n}\r\nexport type MSTrackRole = 'camera' | 'mic' | 'window' | string\r\nexport interface MSRemoteProducer{\r\n  id: string                      //  producer id\r\n  role: MSTrackRole               //  role of track for this producer\r\n  kind: mediasoup.types.MediaKind //  kind of this producer\r\n}\r\nexport function isEqualMSRP(a:MSRemoteProducer, b:MSRemoteProducer){\r\n  return a.kind === b.kind && a.role === b.role\r\n}\r\n\r\nexport interface MSRemotePeer{\r\n  peer: string\r\n  producers: MSRemoteProducer[]   // producers of the remote peer\r\n}\r\n\r\nexport interface MSRemoteUpdateMessage extends MSMessage{\r\n  remotes: MSRemotePeer[]\r\n}\r\nexport interface MSRemoteLeftMessage extends MSMessage{\r\n  remotes: string[]\r\n}\r\n\r\nexport interface MSRoomMessage extends MSPeerMessage{\r\n  room: string\r\n}\r\nexport interface MSWorkerUpdateMessage extends MSPeerMessage{\r\n  load: number\r\n}\r\n\r\nexport interface MSRTPCapabilitiesReply extends MSPeerMessage{\r\n  rtpCapabilities: mediasoup.types.RtpCapabilities\r\n}\r\n\r\n//  direction see from clients\r\nexport type MSTransportDirection = 'send' | 'receive'\r\n//  c->s\r\nexport interface MSCreateTransportMessage extends MSPeerMessage{\r\n  dir: MSTransportDirection\r\n}\r\n//  s->c\r\nexport interface MSCreateTransportReply extends MSPeerMessage{\r\n  transport: string\r\n  iceParameters:mediasoup.types.IceParameters\r\n  iceCandidates:mediasoup.types.IceCandidate[]\r\n  dtlsParameters:mediasoup.types.DtlsParameters\r\n  dir: MSTransportDirection\r\n  iceServers?: RTCIceServer[]\r\n}\r\n\r\nexport interface MSConnectTransportMessage extends MSPeerMessage{\r\n  transport: string,\r\n  dtlsParameters: mediasoup.types.DtlsParameters,\r\n}\r\nexport interface MSConnectTransportReply extends MSPeerMessage{\r\n  error: string\r\n}\r\n\r\nexport interface MSProduceTransportMessage extends MSPeerMessage{\r\n  transport: string\r\n  role: MSTrackRole\r\n  kind: mediasoup.types.MediaKind\r\n  rtpParameters: mediasoup.types.RtpParameters,\r\n  paused?: boolean\r\n}\r\nexport interface MSProduceTransportReply extends MSPeerMessage{\r\n  producer?: string\r\n  role: MSTrackRole\r\n  kind: mediasoup.types.MediaKind\r\n  error?:string\r\n}\r\n\r\nexport interface MSCloseProducerMessage extends MSPeerMessage{\r\n  producer: string\r\n}\r\nexport interface MSCloseProducerReply extends MSPeerMessage{\r\n  error?: string\r\n}\r\n\r\nexport interface MSConsumeTransportMessage extends MSPeerMessage{\r\n  transport: string\r\n  producer: string\r\n  rtpCapabilities: mediasoup.types.RtpCapabilities,\r\n}\r\nexport interface MSConsumeTransportReply extends MSPeerMessage{\r\n  consumer?: string\r\n  producer?: string\r\n  kind?: mediasoup.types.MediaKind\r\n  rtpParameters?: mediasoup.types.RtpParameters\r\n  error?:string\r\n}\r\n\r\nexport interface MSResumeConsumerMessage extends MSPeerMessage{\r\n  consumer: string\r\n}\r\nexport interface MSResumeConsumerReply extends MSPeerMessage{\r\n  error?: string\r\n}\r\n\r\nexport interface MSCloseTransportMessage extends MSMessage{\r\n  transport: string,\r\n}\r\n","import {KickTime} from '@models/KickTime'\r\nimport {assert, MSTrack, Roles} from '@models/utils'\r\nimport {default as participants} from '@stores/participants/Participants'\r\nimport contents from '@stores/sharedContents/SharedContents'\r\nimport {ClientToServerOnlyMessageType, StringArrayMessageTypes} from './DataMessageType'\r\nimport {RtcConnection, TransportStat} from './RtcConnection'\r\nimport {DataConnection} from './DataConnection'\r\nimport * as mediasoup from 'mediasoup-client'\r\nimport { MSRemotePeer, MSTransportDirection, MSRemoteProducer} from './MediaMessages'\r\nimport { autorun } from 'mobx'\r\nimport { PriorityCalculator, trackInfoMerege, VideoAudioTrackInfo, videoAudioTrackInfoDiff } from '@models/conference/PriorityCalculator'\r\nimport { isEqualMSRP } from '@models/conference/MediaMessages'\r\n\r\n//  Log level and module log options\r\nexport const CONNECTIONLOG = false\r\nexport const TRACKLOG = false        // show add, remove... of tracks\r\nexport const EVENTLOG = false\r\nexport const SENDLOG = false\r\nexport const trackLog = TRACKLOG ? console.log : (a:any) => {}\r\nexport const connLog = CONNECTIONLOG ? console.log : (a:any) => {}\r\nexport const connDebug = CONNECTIONLOG ? console.debug : (a:any) => {}\r\nexport const eventLog = EVENTLOG ? console.log : (a:any) => {}\r\nexport const sendLog = SENDLOG ? console.log : (a:any) => {}\r\n\r\n// config.js\r\ndeclare const d:any                  //  from index.html\r\n\r\n//  Cathegolies of BMMessage's types\r\nconst stringArrayMessageTypesForClient = new Set(StringArrayMessageTypes)\r\nstringArrayMessageTypesForClient.add(ClientToServerOnlyMessageType.CONTENT_UPDATE_REQUEST_BY_ID)\r\nstringArrayMessageTypesForClient.add(ClientToServerOnlyMessageType.REQUEST_PARTICIPANT_STATES)\r\n\r\nexport interface RemoteProducer extends MSRemoteProducer{\r\n  peer: RemotePeer                    //  remote peer\r\n  consumer?: mediasoup.types.Consumer //  consumer for the remote producer\r\n}\r\nexport interface RemotePeer{\r\n  peer: string\r\n  transport?: mediasoup.types.Transport   // receive transport\r\n  producers: RemoteProducer[]             // producers of the remote peer\r\n}\r\nexport function getStatFromRemotePeer(r?: RemotePeer){\r\n  return r?.transport?.appData.stat as TransportStat\r\n}\r\n\r\nexport interface LocalProducer{\r\n  id: string\r\n  role: string | Roles\r\n  producer: mediasoup.types.Producer\r\n}\r\nexport interface ProducerData extends Record<string, unknown>{\r\n  track: MSTrack\r\n}\r\nexport interface ConsumerData extends Record<string, unknown>{\r\n  producer: RemoteProducer\r\n}\r\n\r\nexport class Conference {\r\n  private room_=''    //  room name\r\n  public get room(){ return this.room_ }\r\n\r\n  //  rtc (mediasoup) related\r\n  private rtcConnection_ = new RtcConnection()\r\n  public get rtcConnection(){ return this.rtcConnection_ }\r\n  private remotePeers_ = new Map<string, RemotePeer>()\r\n  public get remotePeers(){return this.remotePeers_}\r\n  private localProducers: mediasoup.types.Producer[] = []\r\n  private sendTransport_?: mediasoup.types.Transport\r\n  public priorityCalculator\r\n  //  map related\r\n  private dataConnection_ = new DataConnection()\r\n  public get dataConnection(){ return this.dataConnection_ }\r\n\r\n  constructor(){\r\n    this.rtcConnection.addListener('remoteUpdate', this.onRemoteUpdate.bind(this))\r\n    this.rtcConnection.addListener('remoteLeft', this.onRemoteLeft.bind(this))\r\n    this.priorityCalculator = new PriorityCalculator(this)\r\n    let oldTracks: VideoAudioTrackInfo = {videos:[], audios:[]}\r\n    autorun(()=>{\r\n      const added = trackInfoMerege(videoAudioTrackInfoDiff(this.priorityCalculator.tracksToConsume, oldTracks))\r\n      const removed = trackInfoMerege(videoAudioTrackInfoDiff(oldTracks, this.priorityCalculator.tracksToConsume))\r\n      for(const info of added){ if(!info.producer.consumer) this.addConsumer(info.producer) }\r\n      for(const info of removed){ this.removeConsumer(info.producer) }\r\n      oldTracks = this.priorityCalculator.tracksToConsume\r\n    })\r\n  }\r\n  public isDataConnected(){\r\n    return this.dataConnection.isConnected()\r\n  }\r\n  public isRtcConnected(){\r\n    return this.rtcConnection.isConnected()\r\n  }\r\n\r\n  public enter(room: string){\r\n    const promise = new Promise<void>((resolve, reject) => {\r\n      //  check last kicked time and stop the operation if recently kicked.\r\n      const str = window.localStorage.getItem('kickTimes')\r\n      if (str){\r\n        const kickTimes = JSON.parse(str) as KickTime[]\r\n        const found = kickTimes.find(kt => kt.room === this.room)\r\n        if (found){\r\n          const diff = Date.now() - found.time\r\n          const KICK_WAIT_MIN = 15  //  Can not login KICK_WAIT_MIN minutes once kicked.\r\n          if (diff < KICK_WAIT_MIN * 60 * 1000){\r\n            window.location.reload()\r\n            reject('kicked')\r\n            return\r\n          }\r\n        }\r\n      }\r\n\r\n      //  connect to peer\r\n      const peer = participants.local.information.name.substring(0, 4)\r\n      this.rtcConnection.connect(room, peer).then((peer)=>{\r\n        //  register event handlers and join\r\n        //  set id\r\n        participants.setLocalId(peer)\r\n        //  create tracks\r\n        for (const prop in participants.local.devicePreference) {\r\n          if (participants.local.devicePreference[prop] === undefined) {\r\n            participants.local.devicePreference[prop] = ''\r\n          }\r\n        }\r\n        //  connect to relay server for get contents and participants info.\r\n        this.dataConnection.connect(room, peer).then(()=>{\r\n          this.dataConnection.sync.sendAllAboutMe(true)\r\n          resolve()\r\n        }).catch(reject)\r\n      }).catch(reject)\r\n    })\r\n\r\n    //  To access from debug console, add object d to the window.\r\n    d.conference = this\r\n\r\n    return promise\r\n  }\r\n\r\n  public leave(){\r\n    this.dataConnection.disconnect()\r\n    this.rtcConnection.disconnect()\r\n    this.room_ = ''\r\n  }\r\n\r\n  // mediasoup\r\n  private createTransport(dir: MSTransportDirection, remote?: RemotePeer){\r\n    if (dir === 'receive' && !remote){\r\n      console.error(`createTransport(); remote must be specified for receive transport.`)\r\n    }\r\n    const promise = new Promise<mediasoup.types.Transport>((resolve, reject)=>{\r\n      this.rtcConnection.createTransport(dir, remote?.peer).then(transport => {\r\n        transport.on('connect', ({ dtlsParameters }, callback, errback) => {\r\n          //  console.log('transport connect event', 'send');\r\n          this.rtcConnection.connectTransport(transport, dtlsParameters, remote?.peer).then(()=>{\r\n            callback()\r\n          }).catch((error:string)=>{\r\n            console.error(`error in connecting transport:${error}`);\r\n            //errback()\r\n            reject()\r\n          })\r\n        });\r\n        if (dir === 'send'){\r\n          transport.on('produce', ({ kind, rtpParameters, appData }, callback, errback) => {\r\n            //  console.log('transport produce event', appData);\r\n            const track = (appData as ProducerData).track\r\n            this.rtcConnection.produceTransport({\r\n              transport:transport.id, kind, role:track.role, rtpParameters, paused:false, appData\r\n            }).then((id)=>{\r\n              callback({id})\r\n            }).catch((error)=>{\r\n              console.error('error setting up server-side producer', error)\r\n              errback(error)\r\n              reject()\r\n            })\r\n          })\r\n        }\r\n        transport.on('connectionstatechange', (state) => {\r\n          //  console.log(`transport ${transport.id} connectionstatechange ${state}`);\r\n          if (dir==='receive' && state === 'connected'){\r\n            assert(remote)\r\n            const consumers = Array.from(remote.producers.values()).map(p => p.consumer).filter(c => c)\r\n            for(const consumer of consumers){\r\n              this.rtcConnection.resumeConsumer(consumer!.id, remote.peer)\r\n              //console.log(`resumeConsumer finished for ${consumer!.id}.`)\r\n              consumer!.resume()\r\n            }\r\n          }\r\n          if (state === 'closed' || state === 'failed' || state === 'disconnected') {\r\n            //  console.log('transport closed ... leaving the room and resetting');\r\n            //TODO: leaveRoom();\r\n          }\r\n        });\r\n        resolve(transport)\r\n      }).catch(reject)\r\n    })\r\n    return promise\r\n  }\r\n\r\n  private getSendTransport(){\r\n    const promise = new Promise<mediasoup.types.Transport>((resolve, reject)=>{\r\n      if (this.sendTransport){\r\n        resolve(this.sendTransport)\r\n      }else{\r\n        this.createTransport('send').then(transport=>{\r\n          this.sendTransport_ = transport\r\n          resolve(transport)\r\n        }).catch(reject)\r\n      }\r\n    })\r\n    return promise\r\n  }\r\n  private getReceiveTransport(peer: RemotePeer){\r\n    const promise = new Promise<mediasoup.types.Transport>((resolve, reject)=>{\r\n      if (peer.transport){\r\n        resolve(peer.transport)\r\n      }else{\r\n        this.createTransport('receive', peer).then(transport => {\r\n          peer.transport = transport\r\n          resolve(transport)\r\n        }).catch(reject)\r\n      }\r\n    })\r\n    return promise\r\n  }\r\n  public get sendTransport(){\r\n    return this.sendTransport_\r\n  }\r\n  public get sendTransportStat(){\r\n    return this.sendTransport_?.appData.stat as TransportStat\r\n  }\r\n\r\n  public addOrReplaceLocalTrack(track:MSTrack, maxBitRate?:number){\r\n    const promise = new Promise<mediasoup.types.Producer>((resolve, reject)=>{\r\n      //  add content track to contents\r\n      if (track.role === 'avatar'){\r\n        if (track.track.kind === 'audio'){\r\n          participants.local.tracks.audio = track.track\r\n        }else{\r\n          participants.local.tracks.avatar = track.track\r\n        }\r\n      }else{\r\n        contents.addTrack(track.peer, track.role, track.track)\r\n        if (track.track.kind === 'video'){\r\n          track.track.addEventListener('ended', ()=>{\r\n            contents.removeByLocal(track.role)\r\n          })\r\n        }\r\n      }\r\n      //  create producer\r\n      const producer = this.localProducers.find(p => {\r\n        const old = (p.appData as ProducerData).track\r\n        return old.role === track.role && old.track.kind === track.track.kind\r\n      })\r\n      if (producer){\r\n        producer.replaceTrack(track).then(()=>{\r\n          (producer.appData as ProducerData).track = track\r\n          resolve(producer)\r\n        }).catch(reject)\r\n      }else{\r\n        this.getSendTransport().then((transport) => {\r\n          // add track to produce\r\n          transport.produce({\r\n            track:track.track,\r\n            encodings:maxBitRate ? [{maxBitrate:maxBitRate}] : undefined,\r\n            appData:{track}\r\n          }).then( producer => {\r\n            this.localProducers.push(producer)\r\n            resolve(producer)\r\n          })\r\n        })\r\n      }\r\n    })\r\n    return promise\r\n  }\r\n  public removeLocalTrack(track:MSTrack){\r\n    assert(track.peer === this.rtcConnection.peer)\r\n    this.removeLocalTrackByRole(track.role, track.track.kind as mediasoup.types.MediaKind)\r\n  }\r\n  public removeLocalTrackByRole(role:Roles, kind?:mediasoup.types.MediaKind){\r\n    if (role === 'avatar'){\r\n      if (kind === 'audio' || !kind) participants.local.tracks.audio = undefined\r\n      if (kind === 'video' || !kind) participants.local.tracks.avatar = undefined\r\n    }else{\r\n      contents.removeTrack(this.rtcConnection.peer, role, kind)\r\n    }\r\n    this.localProducers.forEach((producer)=>{\r\n      const track = (producer.appData as ProducerData).track\r\n      if (track.role === role && (!kind || kind === track.track.kind)){\r\n        producer.close()\r\n        this.rtcConnection.closeProducer(producer.id)\r\n        this.localProducers = this.localProducers.filter(p => p !== producer)\r\n      }\r\n    })\r\n  }\r\n  public closeTrack(peer:string, role: string, kind?: mediasoup.types.MediaKind){\r\n    const promise = new Promise<void>((resolve, reject)=>{\r\n      const remote = this.remotePeers.get(peer)\r\n      if (!remote) {reject(); return}\r\n      let counter = 0\r\n      remote.producers.forEach(p => {\r\n        if (p.role === role && (!kind || p.kind === kind)){\r\n          counter ++\r\n          this.getConsumer(p).then((consumer)=>{\r\n            consumer.close()\r\n            counter --\r\n            if (counter === 0) resolve()\r\n          })\r\n        }\r\n      })\r\n    })\r\n    return promise\r\n  }\r\n\r\n  private getConsumer(producer: RemoteProducer){\r\n    const promise = new Promise<mediasoup.types.Consumer>((resolve, reject)=>{\r\n      if (producer.consumer){\r\n        resolve(producer.consumer)\r\n      }else{\r\n        this.getReceiveTransport(producer.peer).then(transport => {\r\n          this.rtcConnection.consumeTransport(transport.id, producer).then(consumeParams=>{\r\n            transport.consume(consumeParams).then(consumer => {\r\n              producer.consumer = consumer\r\n              if (transport.connectionState === 'connected'){\r\n                this.rtcConnection.resumeConsumer(consumer.id, producer.peer.peer).then(()=>{\r\n                  //console.log(`resumeConsumer finished for ${consumer.id}.`)\r\n                })\r\n              }\r\n              resolve(consumer)\r\n            }).catch(reject)\r\n          }).catch(reject)\r\n        }).catch(reject)\r\n      }\r\n    })\r\n    return promise\r\n  }\r\n\r\n  //  Commmands for local tracks --------------------------------------------\r\n  private localMicTrack?: MSTrack\r\n  private localCameraTrack?: MSTrack\r\n  public setLocalMicTrack(track?: MSTrack){\r\n    const promise = new Promise<void>((resolve, reject) => {\r\n      if (track === this.localMicTrack){ resolve(); return}\r\n      //  remove old\r\n      if (this.localMicTrack) {\r\n        this.removeLocalTrack(this.localMicTrack)\r\n      }\r\n      //  add new\r\n      this.localMicTrack = track\r\n      this.dataConnection.audioMeter.setSource(this.localMicTrack)\r\n      if (track){\r\n        this.addOrReplaceLocalTrack(track, 96*1024).then(()=>{resolve()}).catch(reject)\r\n      }else{\r\n        resolve()\r\n      }\r\n    })\r\n    return promise\r\n  }\r\n\r\n\r\n  private doSetLocalCameraTrack(track?:MSTrack) {\r\n    const promise = new Promise<mediasoup.types.Producer|void>((resolve, reject) => {\r\n      this.localCameraTrack = track\r\n      if (this.localCameraTrack){\r\n        this.addOrReplaceLocalTrack(this.localCameraTrack, 128*1024).then(resolve).catch(reject)\r\n      }else{\r\n        resolve()\r\n      }\r\n    })\r\n    return promise\r\n  }\r\n  public setLocalCameraTrack(track: MSTrack|undefined) {\r\n    const promise = new Promise<MSTrack|void>((resolve, reject) => {\r\n      if (track){\r\n        if (track === this.localCameraTrack) {\r\n          resolve()\r\n        }else{\r\n          //  this.cameraTrackConverter(track)\r\n          if (this.localCameraTrack) {\r\n            this.removeLocalTrack(this.localCameraTrack)\r\n          }\r\n          this.doSetLocalCameraTrack(track).then(()=>{resolve()})\r\n        }\r\n      }else{\r\n        if (this.localCameraTrack) {\r\n          this.removeLocalTrack(this.localCameraTrack)\r\n          this.doSetLocalCameraTrack(track).then(()=>{resolve()})\r\n        }else {\r\n          resolve()\r\n        }\r\n      }\r\n    })\r\n\r\n    return promise\r\n  }\r\n  public getLocalMicTrack() {\r\n    return this.localMicTrack\r\n  }\r\n  public getLocalCameraTrack() {\r\n    return this.localCameraTrack\r\n  }\r\n\r\n  //  event\r\n  private onRemoteUpdate(arg: [MSRemotePeer[]]){\r\n    const msremotes = arg[0]\r\n    for (const msr of msremotes){\r\n      if (msr.peer === this.rtcConnection.peer) continue\r\n      const remote = this.remotePeers.get(msr.peer)\r\n      if (remote){\r\n        const addeds:MSRemoteProducer[] = []\r\n        const removeds = remote.producers.filter(p => !msr.producers.find(m => isEqualMSRP(p, m)))\r\n        for(const msrp of msr.producers){\r\n          const current = remote.producers.find(p => isEqualMSRP(p, msrp))\r\n          if (current){\r\n            //  update exsiting producer\r\n            if (current.id !== msrp.id){  //  producer changed and need to create new producer\r\n              addeds.push(msrp)\r\n              removeds.push(current)\r\n            }\r\n          }else{\r\n            addeds.push(msrp)\r\n          }\r\n        }\r\n        const addedProducers = addeds.map(added => ({...added, peer:remote}))\r\n        if (removeds.length) this.onProducerRemoved(removeds, remote)\r\n        if (addedProducers.length) this.onProducerAdded(addedProducers, remote)\r\n      }else{\r\n        const newRemote:RemotePeer = {\r\n          peer: msr.peer,\r\n          producers:[]\r\n        }\r\n        const producers = msr.producers.map(msp => ({...msp, peer:newRemote}))\r\n        this.remotePeers.set(msr.peer, newRemote)\r\n        this.onProducerAdded(producers, newRemote)\r\n      }\r\n    }\r\n  }\r\n  private onRemoteLeft(args: [string[]]){\r\n    const remoteIds = args[0]\r\n    for(const id of remoteIds){\r\n      if (id !== this.rtcConnection.peer){\r\n        const remote = this.remotePeers.get(id)\r\n        if (remote) {\r\n          this.onProducerRemoved(remote.producers, remote)\r\n        }\r\n        this.remotePeers.delete(id)\r\n        participants.leave(id)\r\n      }\r\n    }\r\n  }\r\n  private onProducerAdded(producers: RemoteProducer[], remote: RemotePeer){\r\n    const ps = [...producers]\r\n    remote.producers.push(...ps)\r\n    for(const producer of ps){\r\n      this.priorityCalculator.onAddProducer(producer)\r\n    }\r\n  }\r\n  private onProducerRemoved(producers: RemoteProducer[], remote: RemotePeer){\r\n    const removes = [...producers]\r\n    remote.producers = remote.producers.filter(p => removes.find(r => !isEqualMSRP(p, r)))\r\n    for(const producer of producers){\r\n      this.removeConsumer(producer)\r\n      this.priorityCalculator.onRemoveProducer(producer)\r\n    }\r\n  }\r\n  private addConsumer(producer: RemoteProducer){\r\n    this.getConsumer(producer).then((consumer)=>{\r\n      if (producer.role === 'avatar'){\r\n        participants.addRemoteTrack(producer.peer.peer, consumer.track)\r\n      }else{\r\n        contents.addTrack(producer.peer.peer, producer.role, consumer.track)\r\n      }\r\n    }).catch((e) => {\r\n      console.error(`conference.onProducerAdded(): ${e}`)\r\n    })\r\n  }\r\n  private removeConsumer(producer: RemoteProducer){\r\n    if (producer.consumer){\r\n      producer.consumer.close()\r\n      producer.consumer = undefined\r\n      if (producer.role === 'avatar'){\r\n        participants.removeRemoteTrack(producer.peer.peer, producer.kind)\r\n      }else{\r\n        contents.removeTrack(producer.peer.peer, producer.role, producer.kind)\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\nexport const conference = new Conference()\r\n","import {MessageType} from '@models/conference/DataMessageType'\r\nimport {IPlaybackContent, isContentWallpaper, ISharedContent, SharedContentInfo} from '@models/ISharedContent'\r\nimport {PARTICIPANT_SIZE, PlaybackContent} from '@models/Participant'\r\nimport {Roles, TrackKind} from '@models/utils'\r\nimport {assert} from '@models/utils'\r\nimport {getRect, isCircleInRect} from '@models/utils'\r\nimport {default as participantsStore} from '@stores/participants/Participants'\r\nimport participants from '@stores/participants/Participants'\r\nimport {EventEmitter} from 'events'\r\nimport {action, autorun, makeObservable, observable} from 'mobx'\r\nimport {createContent, defaultContent, moveContentToTop} from './SharedContentCreator'\r\nimport {conference} from '@models/conference'\r\nimport _ from 'lodash'\r\n\r\nexport const CONTENTLOG = false      // show manipulations and sharing of content\r\nexport const contentLog = CONTENTLOG ? console.log : (a:any) => {}\r\nexport const contentDebug = CONTENTLOG ? console.debug : (a:any) => {}\r\n\r\nexport const TITLE_HEIGHT = 35 //24\r\n\r\nfunction zorderComp(a:ISharedContent, b:ISharedContent) {\r\n  return a.zorder - b.zorder\r\n}\r\n\r\nexport interface PeerAndTracks {\r\n  peer: string\r\n  tracks: MediaStreamTrack[]\r\n}\r\n\r\nexport class SharedContents extends EventEmitter {\r\n  private contentIdCounter = 0\r\n  constructor() {\r\n    super()\r\n    makeObservable(this)\r\n    const fps = localStorage.getItem('screenFps')\r\n    if (fps){ this.screenFps = JSON.parse(fps) }\r\n    autorun(() => { //  save screen Fps\r\n      localStorage.setItem('screenFps', JSON.stringify(this.screenFps))\r\n    })\r\n    autorun(() => { //  update audio zone of the local participant\r\n      const pos = participants.local.pose.position\r\n      participants.local.zone = this.zones.find(c => isCircleInRect(pos, 0.5*PARTICIPANT_SIZE, getRect(c.pose, c.size)))\r\n      //  console.log(`sc autorun local zone:${participants.local.zone?.id}`)\r\n    })\r\n    autorun(() => { //  update closed audio zones of remote participants\r\n      const closeds = this.closedZones.map(c => ({content:c, rect:getRect(c.pose, c.size)}))\r\n      participants.remote.forEach(r => {\r\n        if (!r.muteAudio && r.physics.located){\r\n          const found = closeds.find(c => isCircleInRect(r.pose.position, 0.5*PARTICIPANT_SIZE, c.rect))\r\n          r.closedZone = found?.content\r\n        }else{\r\n          r.closedZone = undefined\r\n        }\r\n      })\r\n    })\r\n  }\r\n  @action setEditing(id: string){\r\n    if (id !== this.editing && this.beforeChangeEditing){\r\n      this.beforeChangeEditing(this.editing, id)\r\n    }\r\n    this.editing = id\r\n  }\r\n  private beforeChangeEditing?: (cur:string, next:string) => void = undefined\r\n  public setBeforeChangeEditing(callback?: (cur:string, next:string)=>void, id?:string){\r\n    if (!id || id === this.editing){\r\n      this.beforeChangeEditing = callback\r\n    }\r\n  }\r\n\r\n  // -----------------------------------------------------------------\r\n  //  Contents\r\n  //  All shared contents in Z order. Observed by component.\r\n  @observable pasteEnabled = true\r\n  @observable editing = ''                        //  the user editing content\r\n  @observable.shallow all: ISharedContent[] = []  //  all contents to display\r\n  sorted: ISharedContent[] = []                   //  all contents sorted by zorder (bottom to top)\r\n  @observable.shallow zones: ISharedContent[] = []        //  audio zones sorted by zorder (top to bottom)\r\n  @observable.shallow closedZones: ISharedContent[] = []  //  closed audio zones sorted by zorder (top to bottom)\r\n  //  Contents by room  used only when a relay server exsits.\r\n  @observable.shallow roomContents = new Map<string, ISharedContent>()\r\n  //  Contents info     used only when a relay server exsits.\r\n  @observable.shallow roomContentsInfo = new Map<string, SharedContentInfo>()\r\n  //  Contents for playback.\r\n  @observable.shallow playbackContents = new Map<string, IPlaybackContent>()\r\n\r\n  //  Tracks\r\n  @observable.ref mainScreenStream?: MediaStream\r\n  @observable mainScreenOwner: string | undefined\r\n  @observable.deep contentTracks = new Map<string, PeerAndTracks>()  //  cid -> stream\r\n  public getContentTracks(cid:string){ return this.contentTracks.get(cid) }\r\n  public getContentTrack(cid:string, kind:TrackKind){\r\n    const tracks = this.contentTracks.get(cid)?.tracks\r\n    return tracks?.find(t => t.kind === kind)\r\n  }\r\n  public getOrCreateContentTracks(peer: string, cid: string): PeerAndTracks{\r\n    if(!this.contentTracks.has(cid)){\r\n      this.contentTracks.set(cid, {peer, tracks:[]})\r\n    }\r\n    const pat = this.contentTracks.get(cid)!\r\n    if (peer){\r\n      assert(!pat.peer || pat.peer === peer)\r\n      pat.peer = peer\r\n    }\r\n    return pat\r\n  }\r\n\r\n  public addTrack(peer: string, role: Roles, track: MediaStreamTrack){\r\n    if (role === 'mainScreen'){\r\n      const ms = new MediaStream()\r\n      ms.addTrack(track)\r\n      if (this.mainScreenOwner !== peer){\r\n        this.mainScreenOwner = peer\r\n        this.mainScreenStream = ms\r\n      }else{\r\n        this.mainScreenStream?.getTracks().forEach(track => {\r\n          ms.addTrack(track)\r\n        })\r\n        this.mainScreenStream = ms\r\n      }\r\n    }else{\r\n      const tracks = this.getOrCreateContentTracks(peer, role).tracks\r\n      tracks.push(track)\r\n    }\r\n  }\r\n  public removeTrack(peer: string, role: Roles, kind?: TrackKind){\r\n    if (role === 'mainScreen'){\r\n      if (this.mainScreenOwner === peer){\r\n        const ms = new MediaStream()\r\n        if (kind){\r\n          if (kind === 'audio'){\r\n            this.mainScreenStream?.getVideoTracks().forEach(ms.addTrack)\r\n          }else{\r\n            this.mainScreenStream?.getAudioTracks().forEach(ms.addTrack)\r\n          }\r\n        }\r\n        if (ms.getTracks().length){\r\n          this.mainScreenStream = ms\r\n        }else{\r\n          this.mainScreenStream = undefined\r\n        }\r\n        this.mainScreenOwner = undefined\r\n      }\r\n    }else{\r\n      const tracks = this.contentTracks.get(role)?.tracks\r\n      if (tracks){\r\n        if (kind){\r\n          const i = tracks.findIndex(t=>t.kind === kind)\r\n          if (i>=0){\r\n            tracks[i].stop()\r\n            tracks.splice(i, 1)\r\n          }\r\n        }else{\r\n          tracks.forEach(track => {\r\n            track.stop()\r\n          })\r\n          tracks.length = 0\r\n        }\r\n      }else{\r\n        console.error(`removeRemoteTrack(): tracks for content ${role} not found.`)\r\n      }\r\n    }\r\n  }\r\n  public getAllRtcContentIds(){\r\n    return Array.from(this.contentTracks.keys())\r\n  }\r\n  public getLocalRtcContentIds(){\r\n    return Array.from(this.contentTracks.keys())\r\n      .filter(cid=>this.contentTracks.get(cid)!.peer === conference.rtcConnection.peer)\r\n  }\r\n  public getRemoteRtcContentIds(){\r\n    return Array.from(this.contentTracks.keys())\r\n      .filter(cid=>this.contentTracks.get(cid)!.peer !== conference.rtcConnection.peer)\r\n  }\r\n\r\n  //  pasted content\r\n  @observable.ref pasted:ISharedContent = createContent()\r\n  @action setPasted(c:ISharedContent) {\r\n    console.log('setPasted:', c)\r\n    this.pasted = c\r\n  }\r\n  @action sharePasted() {\r\n    this.shareContent(this.pasted)\r\n    this.pasted = createContent()\r\n  }\r\n  //  share content\r\n  @action shareContent(content:ISharedContent) {\r\n    moveContentToTop(content)\r\n    this.addLocalContent(content)\r\n  }\r\n  public assignId(c:ISharedContent) {\r\n    if (!c.id) {\r\n      c.id = this.getUniqueId()\r\n    }\r\n  }\r\n\r\n  @action updatePlayback(content: IPlaybackContent){\r\n    content.playback = true\r\n    this.playbackContents.set(content.id, content)\r\n    this.updateAll()\r\n  }\r\n  @action removePlayback(cid: string){\r\n    this.playbackContents.delete(cid)\r\n    this.updateAll()\r\n  }\r\n  findPlayback(cid: string){\r\n    return this.playbackContents.get(cid)\r\n  }\r\n  getOrCreatePlayback(cid: string): PlaybackContent{\r\n    let rv = this.findPlayback(cid)\r\n    if (!rv){\r\n      rv = _.cloneDeep(defaultContent)\r\n      rv.id = cid\r\n      this.playbackContents.set(cid, rv)\r\n    }\r\n    return rv\r\n  }\r\n  public find(cid: string) {\r\n    return this.roomContents.get(cid)\r\n  }\r\n\r\n  private updateAll() {\r\n    const newAll:ISharedContent[] = []\r\n    Object.assign(newAll, Array.from(this.roomContents.values()))\r\n    newAll.push(...Array.from(this.playbackContents.values()))\r\n\r\n    const newSorted = Array.from(newAll).sort(zorderComp)\r\n    newSorted.forEach((c, idx) => {c.zIndex = idx+1})\r\n\r\n    //  update observed values\r\n    this.all = newAll\r\n    this.sorted = newSorted\r\n    this.zones = this.sorted.filter(c => c.zone !== undefined).reverse()\r\n    this.closedZones = this.zones.filter(c => c.zone === 'close')\r\n  }\r\n\r\n  //  wallpaper contents\r\n  wallpapers = ''\r\n  private getWallpaper() {\r\n    let nWallpapers = this.sorted.findIndex((c) => !isContentWallpaper(c))\r\n    if (nWallpapers < 0) { nWallpapers = this.sorted.length }\r\n\r\n    return this.sorted.slice(0, nWallpapers)\r\n  }\r\n\r\n  //  add\r\n  addLocalContent(c:ISharedContent) {\r\n    this.assignId(c)\r\n    this.updateByLocal(c)\r\n  }\r\n\r\n  //  Temporaly update local only no sync with other participant.\r\n  //  This makes non-detectable inconsistency and must call updateByLocal() soon later.\r\n  updateLocalOnly(newContent: ISharedContent){\r\n    this.roomContents.set(newContent.id, newContent)\r\n    this.updateAll()\r\n  }\r\n  //  updated by local user\r\n  updateByLocal(newContent: ISharedContent) {\r\n    this.roomContents.set(newContent.id, newContent)\r\n    conference.dataConnection.sync.sendContentUpdateRequest('', [newContent])\r\n    this.updateAll()\r\n    this.roomContentsInfo.set(newContent.id, newContent)\r\n  }\r\n\r\n  //  removed by local user\r\n  removeByLocal(cid: string) {\r\n    if (cid === 'mainScreen'){\r\n      if (this.mainScreenOwner === conference.rtcConnection.peer){\r\n        conference.removeLocalTrackByRole('mainScreen')\r\n      }\r\n    }else{\r\n      const toRemove = this.roomContents.get(cid)\r\n      if (toRemove){\r\n        this.disposeContent(toRemove)\r\n        this.roomContents.delete(cid)\r\n      }\r\n      conference.dataConnection.sync.sendContentRemoveRequest('', [cid])\r\n      this.roomContentsInfo.delete(cid)\r\n    }\r\n    this.updateAll()\r\n  }\r\n  //  request content by id which is not sent yet.\r\n  requestContent(cids: string[]){\r\n    conference.dataConnection.pushOrUpdateMessageViaRelay(MessageType.CONTENT_UPDATE_REQUEST_BY_ID, cids)\r\n  }\r\n  //  Update request from remote.\r\n  updateByRemoteRequest(cs: ISharedContent[]) {\r\n    for (const c of cs) {\r\n      this.roomContents.set(c.id, c)\r\n      if ((c.type === 'screen' || c.type === 'camera')) {\r\n        this.onUpdateScreenContent(c)\r\n      }\r\n    }\r\n    this.updateAll()\r\n  }\r\n  //  Remove request from remote.\r\n  removeByRemoteRequest(cids: string[]) {\r\n    for (const cid of cids) {\r\n      const toRemove = this.roomContents.get(cid)\r\n      if (toRemove){\r\n        this.disposeContent(toRemove)\r\n        this.roomContents.delete(cid)\r\n      }else{\r\n        if (contents.editing === cid){\r\n          contents.editing = ''\r\n        }\r\n      }\r\n      contents.roomContentsInfo.delete(cid)\r\n    }\r\n    this.updateAll()\r\n  }\r\n  clearAllRemotes(){\r\n    this.roomContents.clear()\r\n    this.roomContentsInfo.clear()\r\n  }\r\n\r\n  removeAllContents(){\r\n    const cids = Array.from(this.roomContentsInfo.keys())\r\n    conference.dataConnection.sync.sendContentRemoveRequest('', cids)\r\n    this.roomContents.clear()\r\n    this.roomContentsInfo.clear()\r\n    this.updateAll()\r\n  }\r\n\r\n  // create a new unique content id\r\n  private getUniqueId(): string {\r\n    const pid = participantsStore.localId\r\n    while (1) {\r\n      this.contentIdCounter += 1\r\n      const id = `${pid}_${this.contentIdCounter}`\r\n      if (!this.roomContents.has(id) && !participantsStore.remote.has(id)) { return id }\r\n    }\r\n\r\n    //  eslint-disable-next-line no-unreachable\r\n    return ''\r\n  }\r\n\r\n  private disposeContent(c: ISharedContent) {\r\n    if (c.id === this.editing){\r\n      this.setEditing('')\r\n    }\r\n    if (c.type === 'screen' || c.type === 'camera') {\r\n      const peerAndTracks = this.contentTracks.get(c.id)\r\n      if (peerAndTracks?.peer) {\r\n        if (peerAndTracks.peer === participants.localId){\r\n          conference.removeLocalTrackByRole(c.id)\r\n        }else{\r\n          conference.closeTrack(peerAndTracks.peer, c.id)\r\n        }\r\n        this.contentTracks.delete(c.id)\r\n      }\r\n    }\r\n  }\r\n\r\n  private onUpdateScreenContent(c: ISharedContent){\r\n  }\r\n\r\n  //  screen fps setting\r\n  @observable screenFps = 5\r\n  @action setScreenFps(fps: number){ this.screenFps = fps }\r\n}\r\n\r\nconst contents = new SharedContents()\r\ndeclare const d:any\r\nd.contents = contents\r\nexport default contents\r\n","import {ISharedContent} from '@models/ISharedContent'\r\nimport {MapObject as IMapObject} from '@models/MapObject'\r\nimport { PARTICIPANT_SIZE } from '@models/Participant'\r\nimport {\r\n  addV2, extractRotation, extractScaleX, radian2Degree, rotateVector2D, subV2, transformPoint2D} from '@models/utils'\r\nimport {TITLE_HEIGHT} from '@stores/sharedContents/SharedContents'\r\nimport {action, computed, makeObservable, observable} from 'mobx'\r\nimport { participants } from '.'\r\n\r\nexport const SCALE_LIMIT = {\r\n  minScale: 0.2,\r\n  maxScale: 5,\r\n}\r\n\r\nconst HALF = 0.5\r\nexport class MapData {\r\n  constructor() {\r\n    makeObservable(this)\r\n    this.loadMatrixFromStorage()\r\n  }\r\n\r\n  @observable matrix: DOMMatrixReadOnly = new DOMMatrixReadOnly()\r\n  @observable committedMatrix: DOMMatrixReadOnly = new DOMMatrixReadOnly()\r\n  @observable matrixBeforeZoom?:DOMMatrixReadOnly\r\n  @observable screenSize: [number, number] = [0, 0]   //  size of the client window of the map\r\n  @computed get offset(): [number, number] {\r\n    return [-(this.left + this.screenSize[0] * HALF), -(this.screenSize[1] * HALF)]\r\n  }\r\n  @computed get offsetFromElement(): [number, number] {\r\n    return [-(this.screenSize[0] * HALF), -(this.screenSize[1] * HALF)]\r\n  }\r\n  @computed get rotation(): number {\r\n    return radian2Degree(extractRotation(this.committedMatrix))\r\n  }\r\n  @observable left = 0\r\n  @observable mouse: [number, number] = [0, 0]\r\n  @observable mouseOnMap: [number, number] = [0, 0]\r\n  @action setMatrix(m: DOMMatrixReadOnly) {\r\n    this.matrix = m\r\n    this.updateViewpoint(m)\r\n  }\r\n  private updateViewpoint(m: DOMMatrixReadOnly){\r\n    const scale = extractScaleX(m)\r\n    const width = this.screenSize[0] / scale\r\n    participants.local.viewpoint.height = width\r\n    participants.local.updateViewpointCenter(this)\r\n  }\r\n  @action setCommittedMatrix(m: DOMMatrixReadOnly) {\r\n    const mouse = this.toWindow(this.mouseOnMap)\r\n    this.committedMatrix = m\r\n    this.mouseOnMap = this.fromWindow(mouse)\r\n    this.saveMatrixToStorage(false)\r\n    this.matrixBeforeZoom = undefined\r\n    this.updateViewpoint(m)\r\n  }\r\n  @action setScreenSize(s:[number, number]) {   //  size of the client window of the map\r\n    this.screenSize[0] = s[0]\r\n    this.screenSize[1] = s[1]\r\n    this.updateViewpoint(this.committedMatrix)\r\n  }\r\n  @action setLeft(l:number) {\r\n    this.left = l\r\n  }\r\n  @action setMouse(m:[number, number]) {\r\n    this.mouse = addV2(m, this.offset)\r\n    this.mouseOnMap = transformPoint2D(this.matrix.inverse(), this.mouse)\r\n  }\r\n  @action focusOn(obj: IMapObject) {\r\n    const im = this.matrix.inverse()\r\n    const diff = subV2(obj.pose.position, [im.e, im.f])\r\n    const trn = new DOMMatrix().translate(-diff[0], -diff[1])\r\n    const newMat = trn.preMultiplySelf(this.matrix)\r\n    this.setMatrix(newMat)\r\n    this.setCommittedMatrix(newMat)\r\n  }\r\n  @action zoomTo(content: ISharedContent){\r\n    const matrixOrg = this.matrix\r\n    const contentSize = Array.from(content.size)\r\n    contentSize[1] += TITLE_HEIGHT\r\n    const scales = [map.screenSize[0] / contentSize[0], map.screenSize[1] / contentSize[1]]\r\n    const newScale = Math.max(Math.min(scales[0], scales[1], SCALE_LIMIT.maxScale), SCALE_LIMIT.minScale)\r\n    const oldScale = extractScaleX(matrixOrg)\r\n\r\n    const im = matrixOrg.inverse()\r\n    const diff = subV2(content.pose.position, [im.e, im.f])\r\n\r\n    const left = contentSize[0] / 2\r\n    const top = (this.screenSize[1] / newScale) / 2 - TITLE_HEIGHT\r\n    const trn = new DOMMatrix().translate(-diff[0] - left, -diff[1] - top)\r\n\r\n\r\n    const newMat = trn.preMultiplySelf(matrixOrg).preMultiplySelf(new DOMMatrix().scale(newScale/oldScale))\r\n    console.log(`newScale:${newScale} old${oldScale}  newMat scaleX=${extractScaleX(newMat)}`)\r\n    this.setMatrix(newMat)\r\n    this.setCommittedMatrix(newMat)\r\n    this.matrixBeforeZoom = matrixOrg\r\n    console.log(`zoomTo: before: ${this.matrixBeforeZoom}`)\r\n  }\r\n  @action restoreZoom(){\r\n    if (this.matrixBeforeZoom){\r\n      this.setMatrix(this.matrixBeforeZoom)\r\n      this.setCommittedMatrix(this.matrixBeforeZoom)\r\n    }\r\n  }\r\n  @computed get zoomed(){\r\n    return this.matrixBeforeZoom !== undefined\r\n  }\r\n  @computed get centerOnMap(){\r\n    return transformPoint2D(this.matrix.inverse(), [0,0])\r\n  }\r\n\r\n  toWindow(pos:[number, number]) {\r\n    return subV2(transformPoint2D(this.matrix, pos), this.offset)\r\n  }\r\n  fromWindow(pos:[number, number]) {\r\n    return transformPoint2D(this.matrix.inverse(), addV2(pos, this.offset))\r\n  }\r\n  toElement(pos:[number, number]) {\r\n    return subV2(transformPoint2D(this.matrix, pos), this.offsetFromElement)\r\n  }\r\n  rotateFromWindow(pos:[number, number]) {\r\n    return rotateVector2D(this.matrix.inverse(), pos)\r\n  }\r\n  rotateToWindow(pos:[number, number]) {\r\n    return rotateVector2D(this.matrix, pos)\r\n  }\r\n  visibleArea(){\r\n    const lt = this.fromWindow([0,0])\r\n    const rb = this.fromWindow(this.screenSize)\r\n    const margin = PARTICIPANT_SIZE\r\n//    console.log(`visibleArea ${lt}, ${rb}`)\r\n\r\n    return [lt[1] - margin, rb[0] + margin, rb[1] + margin, lt[0] - margin]\r\n  }\r\n  readonly keyInputUsers = new Set<string>()\r\n\r\n  saveMatrixToStorage(isLocalStorage: boolean) {\r\n    let storage = sessionStorage\r\n    if (isLocalStorage) { storage = localStorage }\r\n    const ar = [this.matrix.a, this.matrix.b, this.matrix.c, this.matrix.d, this.matrix.e, this.matrix.f]\r\n    storage.setItem('mapMatrix', JSON.stringify(ar))\r\n  }\r\n  @action loadMatrixFromStorage() {\r\n    let storage = localStorage\r\n    if (sessionStorage.getItem('mapMatrix')) {\r\n      storage = sessionStorage\r\n    }\r\n    const str = storage.getItem('mapMatrix')\r\n    if (str) {\r\n      const ar = JSON.parse(str)\r\n      const newMat = new DOMMatrix()\r\n      newMat.a = ar[0]\r\n      newMat.b = ar[1]\r\n      newMat.c = ar[2]\r\n      newMat.d = ar[3]\r\n      newMat.e = ar[4]\r\n      newMat.f = ar[5]\r\n      this.setMatrix(newMat)\r\n      this.setCommittedMatrix(newMat)\r\n      //console.log(`loadMatrixFromStorage() loaded.`)\r\n    }\r\n  }\r\n}\r\n\r\nconst map = new MapData()\r\ndeclare const d:any\r\nd.map = map\r\nexport default map\r\n","import {MAP_SIZE} from '@components/Constants'\r\nimport {t} from '@models/locales'\r\nimport { defaultInformation } from '@models/Participant'\r\nimport {urlParameters} from '@models/url'\r\nimport {addV2, diffSet, mulV2} from '@models/utils'\r\nimport map from '@stores/Map'\r\nimport participants from '@stores/participants/Participants'\r\nimport {action, autorun, computed, makeObservable, observable, when} from 'mobx'\r\nimport {conference} from '@models/conference'\r\n\r\nexport type ErrorType = '' | 'connection' | 'retry' | 'noMic' | 'micPermission' | 'rtcConnection' | 'dataConnection' | 'entrance' | 'afk' | 'kicked'\r\n\r\nexport class ErrorInfo {\r\n  @computed get fatal() { return !this.type }\r\n  @observable type:ErrorType = 'entrance'\r\n  @observable types: Set<ErrorType> = new Set()\r\n  @observable supressedTypes:Set<ErrorType> = new Set()\r\n  reason? = ''\r\n  name? = ''\r\n  @action setType(type: ErrorType, name?:string, reason?:string){\r\n    this.type = type\r\n    this.types.add(type)\r\n    this.reason = reason\r\n    this.name = name\r\n  }\r\n  @computed get title() {\r\n    switch(this.type){\r\n      case 'connection': return t('etConnection')\r\n      case 'retry': return t('etRetry')\r\n      case 'noMic': return t('etNoMic')\r\n      case 'micPermission': return t('etMicPermission')\r\n      case 'rtcConnection': return t('etRtcConnection')\r\n      case 'dataConnection': return t('etDataConnection')\r\n      case 'entrance': return ''\r\n      case 'afk': return t('afkTitle')\r\n      case 'kicked': return `Kicked by ${this.name}. ${this.reason}`\r\n    }\r\n\r\n    return this.type\r\n  }\r\n  @computed get message() {\r\n    switch(this.type){\r\n      case 'connection': return t('emConnection')\r\n      case 'retry': return t('emRetry')\r\n      case 'noMic': return t('emNoMic')\r\n      case 'micPermission': return t('emMicPermission')\r\n      case 'rtcConnection': return t('emRtcConnection')\r\n      case 'dataConnection': return t('emDataConnection')\r\n      case 'entrance': return ''\r\n      case 'afk': return t('afkMessage')\r\n      case 'kicked': return ''\r\n    }\r\n\r\n    return `no message defined for ${this.type}`\r\n  }\r\n\r\n  show(){\r\n    if (this.type === ''){\r\n      const types = diffSet(this.types, this.supressedTypes)\r\n      if (types.size){\r\n        this.type = types.values().next().value\r\n      }\r\n    }\r\n\r\n    return this.type!=='' && !this.supressedTypes.has(this.type)\r\n  }\r\n\r\n  constructor() {\r\n    makeObservable(this)\r\n    if (urlParameters['testBot'] !== null) {\r\n      this.clear()\r\n    }\r\n    autorun(() => {\r\n      if (this.show()) {\r\n        map.keyInputUsers.add('errorDialog')\r\n      }else {\r\n        map.keyInputUsers.delete('errorDialog')\r\n      }\r\n    })\r\n    autorun(() => {\r\n      if (participants.local.physics.awayFromKeyboard){\r\n        this.setType('afk')\r\n      }\r\n    })\r\n  }\r\n\r\n  //  media devices\r\n  private videoInputs:MediaDeviceInfo[] = []\r\n  private audioInputs:MediaDeviceInfo[] = []\r\n  private audioOutputs:MediaDeviceInfo[] = []\r\n  private enumerateDevices() {\r\n    navigator.mediaDevices.enumerateDevices().then((devices) => {\r\n      this.videoInputs = []\r\n      this.audioInputs = []\r\n      this.audioOutputs = []\r\n      devices.forEach((device) => {\r\n        if (device.kind === 'videoinput') { this.videoInputs.push(device) }\r\n        if (device.kind === 'audioinput') { this.audioInputs.push(device) }\r\n        if (device.kind === 'audiooutput') { this.audioOutputs.push(device) }\r\n      })\r\n    }).catch(() => { console.error('Device enumeration error') })\r\n  }\r\n  /// check errors after try to start the connection to the XMPP server.\r\n  @action connectionStart() {\r\n    //  even when reload, user interaction is needed to play sound.\r\n    //  const nav = window?.performance?.getEntriesByType('navigation')[0] as any\r\n    //  console.log(nav)\r\n    if (urlParameters.skipEntrance !== null/* || nav.type === 'reload'*/  ){\r\n      this.clear()\r\n      participants.local.sendInformation()\r\n    }\r\n    this.enumerateDevices()\r\n    if (urlParameters.testBot === null)  {\r\n      when(() => this.type === '', () => {\r\n        setTimeout(this.checkConnection.bind(this), 4 * 1000)\r\n      })\r\n    }else { //  testBot\r\n      setTimeout(this.startTestBot.bind(this), 3000)\r\n    }\r\n  }\r\n  @action clear(type?: ErrorType) {\r\n    if (this.type === 'afk'){\r\n      participants.local.physics.awayFromKeyboard = false\r\n    }\r\n    if (type){\r\n      this.types.delete(type)\r\n      if (this.type === type) { this.type = '' }\r\n    }else{\r\n      this.types.clear()\r\n      this.type = ''\r\n    }\r\n  }\r\n  @action checkConnection() {\r\n    if (!conference.isRtcConnected()) {\r\n      this.setType('rtcConnection')\r\n      setTimeout(this.checkConnection.bind(this), 5 * 1000)\r\n    }else if (!conference.isDataConnected()){\r\n      this.setType('dataConnection')\r\n      setTimeout(this.checkConnection.bind(this), 5 * 1000)\r\n    }else {\r\n      this.clear('rtcConnection')\r\n      this.clear('dataConnection')\r\n      this.checkMic()\r\n    }\r\n  }\r\n  @action checkMic() {\r\n    if (participants.localId && !participants.local.muteAudio && !conference.getLocalMicTrack()) {\r\n      if (this.audioInputs.length) {\r\n        this.setType('micPermission')\r\n        //  this.message += 'You have: '\r\n        //  this.audioInputs.forEach((device) => { this.message += `[${device.deviceId} - ${device.label}]` })\r\n      }else {\r\n        this.clear('micPermission')\r\n        this.setType('noMic')\r\n      }\r\n      setTimeout(this.checkMic.bind(this),   5 * 1000)\r\n    }else {\r\n      if (participants.local.muteAudio){\r\n        setTimeout(this.checkMic.bind(this),   5 * 1000)\r\n      }\r\n      this.clear('noMic')\r\n      this.clear('micPermission')\r\n    }\r\n  }\r\n  //  testBot\r\n  canvas: HTMLCanvasElement|undefined = undefined\r\n  oscillator: OscillatorNode|undefined = undefined\r\n  startTestBot () {\r\n    participants.local.muteAudio = false\r\n    participants.local.muteVideo = false\r\n    let counter = 0\r\n    //  Create dummy audio\r\n    const ctxA = new AudioContext()\r\n    this.oscillator = ctxA.createOscillator()\r\n    this.oscillator.type = 'triangle' // sine, square, sawtooth, triangle\r\n    const destination = ctxA.createMediaStreamDestination()\r\n    this.oscillator.connect(destination)\r\n    this.oscillator.start()\r\n    //  Create dummy video\r\n    this.canvas = document.createElement('canvas')\r\n    const width = 240\r\n    const height = 240\r\n    this.canvas.style.width = `${width}px`\r\n    this.canvas.style.height = `${height}px`\r\n    const ctx = this.canvas.getContext('2d')\r\n    const center = [Math.random() * MAP_SIZE / 2, (Math.random() - 0.5) * MAP_SIZE]\r\n    const draw = () => {\r\n      if (!ctx || !ctxA) { return }\r\n      //  update audio frequency also\r\n      this.oscillator?.frequency.setValueAtTime(440 + counter % 440, ctxA.currentTime) // 440HzはA4(4番目のラ)\r\n      //  update camera image\r\n      const colors = ['green', 'blue']\r\n      const nearestVideo = conference.priorityCalculator.tracksToConsume.videos[0]?.producer\r\n      const nearestAudio = conference.priorityCalculator.tracksToConsume.audios[0]?.producer\r\n      if (nearestVideo && nearestVideo.consumer?.track.muted) { colors[0] = 'yellow' }\r\n      if (nearestAudio && nearestAudio.consumer?.track.muted) { colors[1] = 'red' }\r\n      ctx.fillStyle = colors[0]\r\n      ctx.beginPath()\r\n      ctx.ellipse(width * 0.63, height * 0.33, width * 0.1, height * 0.4, counter / 20, 0, Math.PI * 2)\r\n      ctx.fill()\r\n      ctx.fillStyle = colors[1]\r\n      ctx.beginPath()\r\n      ctx.ellipse(width * 0.63, height * 0.33, width * 0.1, height * 0.4, -counter / 20, 0, Math.PI * 2)\r\n      ctx.fill()\r\n      counter += 1\r\n    }\r\n    setInterval(draw, 1000 / 20)\r\n    const chars = '01234567890ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijlkmnopqrstuvwxyz'\r\n    const randChar = () =>  chars.substr(Math.floor(Math.random() * chars.length), 1)\r\n    participants.local.information = defaultInformation\r\n    participants.local.information.name = `testBot ${randChar()}${randChar()}${randChar()}`\r\n    participants.local.sendInformation()\r\n    participants.local.pose.position = center as [number, number]\r\n\r\n    const move = () => {\r\n      participants.local.pose.position = addV2(center, mulV2(100, [Math.cos(counter / 60), Math.sin(counter / 60)]))\r\n      //  Reload when not connected.\r\n      //  This does not work well: It causes unnecessary reload because WebSocket can often be reconnected.\r\n      /*\r\n      if (urlParameters.testBot !== null &&\r\n          connection.conference._jitsiConference?.room &&\r\n          !connection.conference._jitsiConference?.room.connected){\r\n        setTimeout(()=>{\r\n          if (!connection.conference._jitsiConference?.room.connected){\r\n            window.location.reload()  //  testBot will reload when channel is closed.\r\n          }\r\n        }, 20 * 1000)\r\n      }\r\n      */\r\n    }\r\n    const win = window as any\r\n    if (win.requestIdleCallback) {\r\n      const moveTask = () => {  //  onIdle, wait 50ms and run move()\r\n        setTimeout(() => {\r\n          move()\r\n          win.requestIdleCallback(moveTask)\r\n        },         50)\r\n      }\r\n      moveTask()\r\n    }else {\r\n      setInterval(move, 1000)\r\n    }\r\n\r\n    const vidoeStream = (this.canvas as any).captureStream(20) as MediaStream\r\n    const videoTrack = vidoeStream.getVideoTracks()[0]\r\n    const audioTrack = destination.stream.getAudioTracks()[0]\r\n    conference.setLocalCameraTrack({track:videoTrack, peer:participants.local.id, role:'avatar'})\r\n    conference.setLocalMicTrack({track:audioTrack, peer:participants.local.id, role:'avatar'})\r\n  }\r\n}\r\n\r\nconst errorInfo = new ErrorInfo()\r\ndeclare const d:any\r\nd.error = errorInfo\r\nexport default errorInfo\r\n","export default __webpack_public_path__ + \"static/media/whoo-screen_chat.52e62a85.png\";","export default __webpack_public_path__ + \"static/media/people_login.db1eab64.png\";","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","import Button from '@material-ui/core/Button'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport {t} from '@models/locales'\r\nimport {isSmartphone} from '@models/utils'\r\nimport errorInfo from '@stores/ErrorInfo'\r\nimport map from '@stores/Map'\r\nimport React, { useEffect } from 'react'\r\nimport {ErrorDialogFrame} from './ErrorDialog'\r\n\r\nexport const AfkDialog: React.FC<{}> = () => {\r\n  useEffect(()=>{\r\n    map.keyInputUsers.add('AfkDialog')\r\n  })\r\n  const onClose = (ev:{}) => {\r\n    map.keyInputUsers.delete('AfkDialog')\r\n    const evKey = ev as React.KeyboardEvent\r\n    if (evKey.code){\r\n      //  console.log(`onClose code=${evKey.code}`)\r\n      evKey.preventDefault()\r\n      evKey.stopPropagation()\r\n    }\r\n    errorInfo.clear()\r\n  }\r\n\r\n  return <ErrorDialogFrame onClose={onClose}>\r\n    <DialogContent style={{fontSize: isSmartphone() ? '2em' : '1em'}}>\r\n      <Button color=\"primary\" variant=\"contained\" style={{textTransform:'none'}} autoFocus={true}\r\n        onKeyDown={onClose} onClick={onClose}>\r\n        {t('afkMessage')}\r\n      </Button>\r\n      </DialogContent>\r\n  </ErrorDialogFrame>\r\n}\r\nAfkDialog.displayName = 'AfkDialog'\r\n","\r\n/*\r\nconst _NOUN_ = [\r\n];\r\n*/\r\n\r\n/**\r\n * The list of plural nouns.\r\n * @const\r\n */\r\nconst _PLURALNOUN_ = [\r\n    'Abilities', 'Absences', 'Abundances', 'Academics',\r\n    'Academies', 'Accents', 'Acceptances', 'Accesses', 'Accidents',\r\n    'Accommodations', 'Accomplishments', 'Accordances', 'Accountabilities',\r\n    'Accountants', 'Accounts', 'Accumulations', 'Accuracies', 'Accusations',\r\n    'Accused', 'Achievements', 'Acids', 'Acquisitions', 'Acres', 'Actions',\r\n    'Activations', 'Activists', 'Activities', 'Actors', 'Actresses', 'Acts',\r\n    'Adaptations', 'Addictions', 'Additions', 'Addresses', 'Adjustments',\r\n    'Administrations', 'Administrators', 'Admissions', 'Adolescents',\r\n    'Adoptions', 'Ads', 'Adults', 'Advances', 'Advantages', 'Adventures',\r\n    'Advertisements', 'Advertisings', 'Advice', 'Advocates', 'Affairs',\r\n    'Affections', 'Aftermaths', 'Afternoons', 'Agencies', 'Agendas',\r\n    'Agents', 'Ages', 'Aggressions', 'Agreements', 'Agricultures', 'Aides',\r\n    'Alarms', 'Albums', 'Alerts', 'Aliens', 'Alignments',\r\n    'Allegations', 'Alliances', 'Allies', 'Allocations', 'Allowances',\r\n    'Alternatives', 'Aluminium', 'Amateurs', 'Ambassadors', 'Ambitions',\r\n    'Ambulances', 'Amendments', 'Amounts', 'Analogies', 'Analyses',\r\n    'Analysts', 'Ancestors', 'Anchors', 'Angels', 'Angers', 'Angles',\r\n    'Animals', 'Animations', 'Ankles', 'Anniversaries', 'Announcements',\r\n    'Answers', 'Anxieties', 'Apartments', 'Apologies', 'Apparatus',\r\n    'Appeals', 'Appearances', 'Appetites', 'Apples', 'Applicants',\r\n    'Applications', 'Appointments', 'Appreciations', 'Approaches',\r\n    'Approvals', 'Apps', 'Aprils', 'Architects', 'Architectures',\r\n    'Archives', 'Areas', 'Arenas', 'Arguments', 'Armies',\r\n    'Arrangements', 'Arrays', 'Arrests', 'Arrivals', 'Arrows', 'Articles',\r\n    'Artists', 'Arts', 'Artworks', 'Ashes', 'Aspects', 'Aspirations',\r\n    'Assaults', 'Assemblies', 'Assertions', 'Assessments',\r\n    'Assets', 'Assignments', 'Assistances', 'Assistants', 'Associations',\r\n    'Assumptions', 'Assurances', 'Asylums', 'Athletes', 'Atmospheres',\r\n    'Attachments', 'Attacks', 'Attempts', 'Attendances',\r\n    'Attentions', 'Attitudes', 'Attorneys', 'Attractions', 'Attributes',\r\n    'Auctions', 'Audiences', 'Audits', 'Augusts', 'Aunts', 'Authorities',\r\n    'Authors', 'Autonomies', 'Autos', 'Autumns', 'Availabilities',\r\n    'Averages', 'Awards', 'Awarenesses', 'Babies', 'Backdrops',\r\n    'Backgrounds', 'Backings', 'Backs', 'Backups', 'Bacterias', 'Badges',\r\n    'Bags', 'Bails', 'Balances', 'Ballets', 'Balloons', 'Ballots', 'Balls',\r\n    'Bananas', 'Bands', 'Banks', 'Banners', 'Bans', 'Bargains', 'Barrels',\r\n    'Barriers', 'Bars', 'Baseballs', 'Basements', 'Bases',\r\n    'Basketballs', 'Baskets', 'Basses', 'Bathrooms', 'Baths', 'Bats',\r\n    'Batteries', 'Battlefields', 'Battles', 'Bays', 'Beaches', 'Beams',\r\n    'Beans', 'Bears', 'Beasts', 'Beats', 'Beauties', 'Bedrooms', 'Beds',\r\n    'Beefs', 'Beers', 'Bees', 'Beginnings', 'Behalves', 'Behaviours',\r\n    'Beings', 'Beliefs', 'Bells', 'Belts', 'Benches', 'Benchmarks', 'Bends',\r\n    'Beneficiaries', 'Benefits', 'Bests', 'Bets', 'Betters', 'Biases',\r\n    'Bicycles', 'Bids', 'Bikes', 'Bills', 'Bins', 'Biographies',\r\n    'Biologies', 'Birds', 'Birthdays', 'Births', 'Biscuits', 'Bishops',\r\n    'Bites', 'Bits', 'Blades', 'Blames', 'Blankets', 'Blanks',\r\n    'Blasts', 'Blends', 'Blessings', 'Blocks', 'Blogs', 'Bloods', 'Blows',\r\n    'Blues', 'Boards', 'Boats', 'Bonds',\r\n    'Bones', 'Bonus', 'Bookings', 'Books', 'Booms', 'Boosts', 'Boots',\r\n    'Borders', 'Bosses', 'Bottles', 'Boundaries', 'Bowls',\r\n    'Bows', 'Boxes', 'Brains', 'Branches', 'Brands',\r\n    'Breaches', 'Breads', 'Breakdowns', 'Breakfasts', 'Breaks',\r\n    'Breakthroughs', 'Breathings', 'Breaths', 'Breeds',\r\n    'Brethren', 'Bricks', 'Brides', 'Bridges', 'Broadbands', 'Broadcasters',\r\n    'Broadcasts', 'Browsers', 'Brushes', 'Bubbles', 'Bucks',\r\n    'Buddies', 'Budgets', 'Buffers', 'Bugs', 'Buildings', 'Bulks',\r\n    'Bullets', 'Bunches', 'Burdens', 'Bureaucracies', 'Burials', 'Burns',\r\n    'Buses', 'Bushes', 'Businesses', 'Businessmen', 'Butters', 'Buttons',\r\n    'Cabinets', 'Cabins', 'Cables', 'Cafes', 'Cakes', 'Calculations',\r\n    'Calls', 'Calms', 'Cameras', 'Campaigns', 'Campings', 'Camps', 'Campus',\r\n    'Canals', 'Candidates', 'Candles', 'Cans', 'Canvas',\r\n    'Capabilities', 'Capacities', 'Capitalisms', 'Capitals', 'Caps',\r\n    'Captains', 'Captures', 'Carbons', 'Cards', 'Careers', 'Cares',\r\n    'Cargoes', 'Carpets', 'Carriages', 'Carrots', 'Cars', 'Cartoons',\r\n    'Cases', 'Cashes', 'Casinos', 'Castles', 'Casts',\r\n    'Catalogues', 'Catches', 'Categories', 'Cats', 'Cattle', 'Causes',\r\n    'Cautions', 'Caves', 'Cds', 'Ceilings', 'Celebrations', 'Celebrities',\r\n    'Cells', 'Cemeteries', 'Centres', 'Cents', 'Centuries', 'Ceremonies',\r\n    'Certainties', 'Certificates', 'Chains', 'Chairmen', 'Chairs',\r\n    'Challenges', 'Chambers', 'Champions', 'Championships', 'Chances',\r\n    'Changes', 'Channels', 'Chaos', 'Chapters', 'Characteristics',\r\n    'Characters', 'Charges', 'Charities', 'Charms', 'Charters', 'Charts',\r\n    'Chases', 'Chats', 'Cheats', 'Checks', 'Cheeks', 'Cheers', 'Cheeses',\r\n    'Chefs', 'Chemicals', 'Chemistries', 'Chests', 'Chickens', 'Chiefs',\r\n    'Childhoods', 'Chips', 'Chocolates', 'Choices', 'Choirs', 'Chunks',\r\n    'Churches', 'Cigarettes', 'Cinemas', 'Circles', 'Circuits',\r\n    'Circulations', 'Circumstances', 'Cities', 'Citizens', 'Citizenships',\r\n    'Civilians', 'Civilizations', 'Claims', 'Clarities', 'Clashes',\r\n    'Classes', 'Classics', 'Classifications', 'Classrooms', 'Clauses',\r\n    'Clerks', 'Clicks', 'Clients', 'Cliffs', 'Climates', 'Climbs',\r\n    'Clinics', 'Clips', 'Clocks', 'Closes', 'Closures', 'Clothes',\r\n    'Clothings', 'Cloths', 'Clouds', 'Clubs', 'Clues', 'Clusters',\r\n    'Coaches', 'Coalitions', 'Coals', 'Coasts', 'Coats', 'Cocktails',\r\n    'Codes', 'Coffees', 'Coincidences', 'Coins', 'Colds', 'Collaborations',\r\n    'Collapses', 'Colleagues', 'Collections', 'Collectors', 'Colleges',\r\n    'Collisions', 'Colonies', 'Colours', 'Columnists', 'Columns', 'Combats',\r\n    'Combinations', 'Comedies', 'Comforts', 'Comics', 'Commanders',\r\n    'Commands', 'Commentaries', 'Commentators', 'Comments', 'Commerces',\r\n    'Commercials', 'Commissioners', 'Commissions', 'Commitments',\r\n    'Committees', 'Commodities', 'Communications', 'Communities',\r\n    'Companies', 'Companions', 'Comparisons', 'Compassions',\r\n    'Compensations', 'Competences', 'Competitions', 'Competitors',\r\n    'Complaints', 'Completions', 'Complexes', 'Complexities', 'Compliances',\r\n    'Complications', 'Components', 'Composers', 'Compositions', 'Compounds',\r\n    'Compromises', 'Computers', 'Concentrations', 'Conceptions', 'Concepts',\r\n    'Concerns', 'Concerts', 'Concessions', 'Conclusions', 'Concretes',\r\n    'Conditions', 'Conducts', 'Conferences', 'Confessions', 'Confidences',\r\n    'Configurations', 'Confirmations', 'Conflicts', 'Confrontations',\r\n    'Confusions', 'Congregations', 'Connections', 'Consciences',\r\n    'Consciousnesses', 'Consensus', 'Consents', 'Consequences',\r\n    'Conservations', 'Conservatives', 'Considerations', 'Consistencies',\r\n    'Conspiracies', 'Constituencies', 'Constitutions', 'Constraints',\r\n    'Constructions', 'Consultants', 'Consultations', 'Consumers',\r\n    'Consumptions', 'Contacts', 'Containers', 'Contempts', 'Contenders',\r\n    'Contentions', 'Contents', 'Contests', 'Contexts', 'Continents',\r\n    'Contractors', 'Contracts', 'Contradictions', 'Contraries', 'Contrasts',\r\n    'Contributions', 'Contributors', 'Controls', 'Controversies',\r\n    'Conveniences', 'Conventions', 'Conversations', 'Conversions',\r\n    'Convictions', 'Cookers', 'Cookings', 'Cooks', 'Coordinations',\r\n    'Coordinators', 'Copies', 'Coppers', 'Cops', 'Copyrights', 'Cores',\r\n    'Corners', 'Corporations', 'Corrections', 'Correlations',\r\n    'Correspondences', 'Correspondents', 'Corridors', 'Corruptions',\r\n    'Costs', 'Costumes', 'Cottages', 'Cottons', 'Councillors', 'Councils',\r\n    'Counsellings', 'Counsellors', 'Counterparts', 'Counters', 'Counties',\r\n    'Countries', 'Countrysides', 'Counts', 'Couples', 'Coups', 'Courages',\r\n    'Courses', 'Courtesies', 'Courts', 'Cousins', 'Coverages', 'Covers',\r\n    'Cows', 'Cracks', 'Crafts', 'Crashes', 'Creams', 'Creations',\r\n    'Creativities', 'Creators', 'Creatures', 'Credibilities', 'Credits',\r\n    'Crews', 'Cries', 'Crises', 'Criteria',\r\n    'Criticisms', 'Critics', 'Critiques', 'Crops', 'Crosses', 'Crowds',\r\n    'Crowns', 'Cruises', 'Crystals', 'Cues', 'Cults', 'Cultures',\r\n    'Cupboards', 'Cups', 'Cures', 'Curiosities', 'Currencies', 'Currents',\r\n    'Curricula', 'Curtains', 'Custodies', 'Customers', 'Customs',\r\n    'Cuts', 'Cuttings', 'Cycles', 'Dads', 'Dairies', 'Damages', 'Dams',\r\n    'Dancers', 'Dances', 'Dancings', 'Dangers', 'Darknesses', 'Darks',\r\n    'Databases', 'Dates', 'Daughters', 'Dawns', 'Days',\r\n    'Deadlines', 'Dealers', 'Deals', 'Debates', 'Debris', 'Debts',\r\n    'Debuts', 'Decades', 'Decembers', 'DecisionMakings', 'Decisions',\r\n    'Decks', 'Declarations', 'Declines', 'Decorations', 'Decreases',\r\n    'Dedications', 'Deeds', 'Defaults', 'Defeats', 'Defects', 'Defences',\r\n    'Defenders', 'Deficiencies', 'Deficits', 'Definitions', 'Degrees',\r\n    'Delays', 'Delegates', 'Delegations', 'Delights', 'Deliveries',\r\n    'Demands', 'Democracies', 'Demons', 'Demonstrations', 'Denials',\r\n    'Densities', 'Dentists', 'Departments', 'Departures', 'Dependences',\r\n    'Deployments', 'Deposits', 'Depressions', 'Depths', 'Deputies',\r\n    'Descents', 'Descriptions', 'Deserts', 'Designers', 'Designs',\r\n    'Desires', 'Desks', 'Desktops', 'Destinations', 'Destructions',\r\n    'Details', 'Detections', 'Detectives', 'Detentions', 'Determinations',\r\n    'Developments', 'Devices', 'Devils', 'Diagnoses', 'Diagrams',\r\n    'Dialogues', 'Diamonds', 'Diaries', 'Dictators', 'Dictionaries',\r\n    'Diets', 'Differences', 'Difficulties', 'Dignities', 'Dilemmas',\r\n    'Dimensions', 'Dinners', 'Diplomats', 'Directions', 'Directories',\r\n    'Directors', 'Dirts', 'Disabilities', 'Disadvantages', 'Disagreements',\r\n    'Disappointments', 'Disciplines', 'Disclosures',\r\n    'Discounts', 'Discourses', 'Discoveries', 'Discretions',\r\n    'Discs', 'Discussions', 'Dishes',\r\n    'Disks', 'Dislikes', 'Dismissals', 'Disorders', 'Displays', 'Disposals',\r\n    'Disputes', 'Disruptions', 'Distances', 'Distinctions', 'Distresses',\r\n    'Distributions', 'Districts', 'Diversities', 'Dives', 'Divides',\r\n    'Divisions', 'Divorces', 'Doctors', 'Doctrines', 'Documentaries',\r\n    'Documentations', 'Documents', 'Dogs', 'Dollars', 'Domains',\r\n    'Dominances', 'Donations', 'Donors', 'Doors', 'Doses', 'Dots', 'Doubts',\r\n    'Downloads', 'Downtowns', 'Dozens', 'Drafts', 'Dramas', 'Drawings',\r\n    'Dreams', 'Dresses', 'Drinks', 'Drivers', 'Drives', 'Drivings', 'Drops',\r\n    'Droughts', 'Drums', 'Duos', 'Durations', 'Dusts', 'Duties',\r\n    'Dvds', 'Dynamics', 'Earnings', 'Ears', 'Earthquakes', 'Earths',\r\n    'Eases', 'Easts', 'Echoes', 'Economics', 'Economies', 'Economists',\r\n    'Edges', 'Editions', 'Editors', 'Educations', 'Educators',\r\n    'Effectivenesses', 'Effects', 'Efficiencies', 'Efforts', 'Eggs', 'Egos',\r\n    'Elbows', 'Elections', 'Electricities', 'Electronics', 'Elements',\r\n    'Elephants', 'Elites', 'Emails', 'Embarrassments', 'Embassies',\r\n    'Emergences', 'Emergencies', 'Emissions', 'Emotions', 'Emphases',\r\n    'Empires', 'Employees', 'Employers', 'Employments', 'Encounters',\r\n    'Encouragements', 'Endeavours', 'Endings', 'Endorsements', 'Ends',\r\n    'Enemies', 'Energies', 'Enforcements', 'Engagements', 'Engineerings',\r\n    'Engineers', 'Engines', 'Enquiries', 'Enterprises', 'Entertainments',\r\n    'Enthusiasms', 'Enthusiasts', 'Entities', 'Entrances', 'Entrepreneurs',\r\n    'Entries', 'Envelopes', 'Environments', 'Epidemics', 'Episodes',\r\n    'Equalities', 'Equals', 'Equations', 'Equipment', 'Equivalents', 'Eras',\r\n    'Errors', 'Escapes', 'Essays', 'Essences', 'Establishments', 'Estates',\r\n    'Estimates', 'Ethics', 'Euros', 'Evaluations', 'Evenings', 'Events',\r\n    'Evidence', 'Evils', 'Evolutions', 'Examinations', 'Examples', 'Exams',\r\n    'Excellences', 'Exceptions', 'Excesses', 'Exchanges', 'Excitements',\r\n    'Exclusions', 'Excuses', 'Executives', 'Exercises',\r\n    'Exhibitions', 'Exhibits', 'Exiles', 'Existences', 'Exits',\r\n    'Expansions', 'Expectations', 'Expeditions', 'Expenditures', 'Expenses',\r\n    'Experiences', 'Experiments', 'Expertises', 'Experts', 'Explanations',\r\n    'Exploitations', 'Explorations', 'Explosions', 'Explosives', 'Exports',\r\n    'Exposures', 'Expressions', 'Extensions', 'Extents', 'Extracts',\r\n    'Extras', 'Extremes', 'Eyes', 'Fabrics', 'Faces',\r\n    'Facilities', 'Factions', 'Factories', 'Factors', 'Facts', 'Faculties',\r\n    'Failures', 'Fairnesses', 'Faiths', 'Falls', 'Fames', 'Families',\r\n    'Fans', 'Fantasies', 'Fares', 'Farmers', 'Farmings', 'Farms',\r\n    'Fashions', 'Fates', 'Fats', 'Faults', 'Favourites', 'Favours', 'Fears',\r\n    'Feathers', 'Feats', 'Features', 'Februaries', 'Feedbacks', 'Feeds',\r\n    'Feelings', 'Feels', 'Fees', 'Feet', 'Feminists', 'Fences',\r\n    'Festivals', 'Fevers', 'Fibres', 'Fictions', 'Fields', 'Fightings',\r\n    'Fights', 'Figures', 'Files', 'FilmMakers', 'Films', 'Filters',\r\n    'Finals', 'Finances', 'Findings', 'Fines', 'Fingers', 'Finishes',\r\n    'Firefighters', 'Fires', 'Fireworks', 'Firms', 'Firsts',\r\n    'Fish', 'Fishings', 'Fitnesses', 'Fits', 'Fixes', 'Fixtures', 'Flags',\r\n    'Flames', 'Flashes', 'Flats', 'Flavours', 'Flaws', 'Fleets', 'Fleshes',\r\n    'Flexibilities', 'Flies', 'Flights', 'Floods', 'Floors', 'Flours',\r\n    'Flowers', 'Flows', 'Fluids', 'Flus', 'Flyings', 'Foci', 'Folds',\r\n    'Folks', 'Followings', 'Foods', 'Fools', 'Footages', 'Footballs',\r\n    'Forces', 'Forecasts', 'Foreigners', 'Forests', 'Forks', 'Formations',\r\n    'Formats', 'Forms', 'Formulae', 'Fortunes', 'Forums', 'Fossils',\r\n    'Foundations', 'Founders', 'Fractions', 'Fragments', 'Frames',\r\n    'Frameworks', 'Franchises', 'Frauds', 'Freedoms', 'Frequencies',\r\n    'Fridays', 'Fridges', 'Friends', 'Friendships', 'Frogs', 'Fronts',\r\n    'Fruits', 'Frustrations', 'Fuels', 'Functions', 'Fundings',\r\n    'Fundraisings', 'Funds', 'Funerals', 'Funs', 'Furnitures', 'Furs',\r\n    'Futures', 'Gains', 'Galleries', 'Gallons', 'Gamblings', 'Games',\r\n    'Gamings', 'Gaps', 'Garages', 'Gardens', 'Gases', 'Gates',\r\n    'Gatherings', 'Gazes', 'Gears', 'Genders', 'Generations', 'Genes',\r\n    'Genius', 'Genres', 'Gentlemen', 'Geographies', 'Gestures',\r\n    'Ghosts', 'Giants', 'Gifts', 'Gigs', 'Glances', 'Glasses', 'Glimpses',\r\n    'Globalizations', 'Globes', 'Glories', 'Gloves', 'Goals', 'Gods',\r\n    'Goes', 'Gold', 'Golfs', 'Goodbyes', 'Goodnesses', 'Goods',\r\n    'Governances', 'Governments', 'Governors', 'Graces', 'Grades',\r\n    'Graduates', 'Grains', 'Grandfathers', 'Grandmothers', 'Grandparents',\r\n    'Grants', 'Graphics', 'Grasps', 'Grasses', 'Graves', 'Gravities',\r\n    'Greenhouses', 'Greens', 'Greys', 'Grids', 'Griefs', 'Grins', 'Grips',\r\n    'Groceries', 'Grounds', 'Groups', 'Growths', 'Guarantees', 'Guards',\r\n    'Guerrillas', 'Guesses', 'Guests', 'Guidances', 'Guidelines', 'Guides',\r\n    'Guilts', 'Guitars', 'Guts', 'Guys', 'Gyms', 'Habitats',\r\n    'Habits', 'Hairs', 'Halls', 'Halts', 'Halves', 'Handfuls', 'Handles',\r\n    'Handlings', 'Hands', 'Happinesses', 'Harassments', 'Harbours',\r\n    'Hardwares', 'Harmonies', 'Harms', 'Harvests',\r\n    'Hats', 'Hazards', 'Headaches', 'Headlines', 'Headquarters', 'Heads',\r\n    'Healthcares', 'Healths', 'Hearings', 'Hearts', 'Heatings', 'Heats',\r\n    'Heavens', 'Heels', 'Heights', 'Helicopters', 'Hellos', 'Hells',\r\n    'Helmets', 'Helps', 'Herbs', 'Heritages', 'Heroes', 'Hierarchies',\r\n    'Highlights', 'Highs', 'Highways', 'Hills', 'Hints', 'Hips', 'Hires',\r\n    'Historians', 'Histories', 'Hits', 'Hobbies', 'Hockeys', 'Holds',\r\n    'Holes', 'Holidays', 'Homelands', 'Homes', 'Homework', 'Honesties',\r\n    'Honours', 'Hooks', 'Hopes', 'Horizons', 'Horns', 'Horrors', 'Horses',\r\n    'Hospitals', 'Hosts', 'Hotels', 'Hours',\r\n    'Households', 'Houses', 'Housings', 'Humanities', 'Humans', 'Humours',\r\n    'Hungers', 'Huntings', 'Hunts', 'Hurricanes', 'Hurries', 'Hurts',\r\n    'Hydrogens', 'Hypotheses', 'Ices', 'Icons', 'Ideals', 'Ideas',\r\n    'Identifications', 'Identities', 'Ideologies', 'Ids',\r\n    'Ignorances', 'Illusions', 'Illustrations', 'Imageries',\r\n    'Images', 'Imaginations', 'Immigrations', 'Impacts',\r\n    'Implementations', 'Implications', 'Importances', 'Imports',\r\n    'Impressions', 'Imprisonments', 'Improvements', 'Inabilities',\r\n    'Incentives', 'Inches', 'Incidences', 'Incidents', 'Inclusions',\r\n    'Incomes', 'Increases', 'Independences', 'Indications', 'Indicators',\r\n    'Indices', 'Indictments', 'Individuals', 'Industries', 'Inequalities',\r\n    'Infections', 'Inflations', 'Influences', 'Information',\r\n    'Infos', 'Infrastructures', 'Ingredients', 'Inhabitants', 'Initiatives',\r\n    'Injections', 'Injuries', 'Injustices', 'Inks',\r\n    'Innovations', 'Inputs', 'Inquiries', 'Insects', 'Insertions',\r\n    'Insiders', 'Insides', 'Insights', 'Inspections', 'Inspectors',\r\n    'Inspirations', 'Installations', 'Instances', 'Instincts', 'Institutes',\r\n    'Institutions', 'Instructions', 'Instructors', 'Instruments', 'Insults',\r\n    'Insurances', 'Intakes', 'Integrations', 'Integrities', 'Intellectuals',\r\n    'Intelligences', 'Intensities', 'Intentions', 'Intents', 'Interactions',\r\n    'Interests', 'Interfaces', 'Interferences', 'Interiors',\r\n    'Interpretations', 'Intervals', 'Interventions', 'Interviews',\r\n    'Introductions', 'Invasions', 'Inventions', 'Investigations',\r\n    'Investigators', 'Investments', 'Investors', 'Invitations',\r\n    'Involvements', 'Ironies', 'Irons', 'Islands', 'Isolations', 'Issues',\r\n    'Items', 'Its', 'Jackets', 'Jails', 'Jams', 'Januaries', 'Jazzes',\r\n    'Jeans', 'Jets', 'Jewelleries', 'Jobs', 'Joints', 'Jokes',\r\n    'Journalisms', 'Journalists', 'Journals', 'Journeys', 'Joys',\r\n    'Judgements', 'Judges', 'Juices', 'Julies', 'Jumps', 'Junctions',\r\n    'Junes', 'Juries', 'Jurisdictions', 'Justices', 'Justifications',\r\n    'Keyboards', 'Keys', 'Kicks', 'Kidneys', 'Kilometres',\r\n    'Kinds', 'Kingdoms', 'Kings', 'Kisses', 'Kitchens', 'Kits', 'Knees',\r\n    'Knives', 'Knocks', 'Knowledges', 'Labels', 'Laboratories', 'Labours',\r\n    'Labs', 'Lacks', 'Ladders', 'Lakes', 'Lamps',\r\n    'Landings', 'Landlords', 'Landmarks', 'Lands', 'Landscapes', 'Lanes',\r\n    'Languages', 'Laps', 'Laptops', 'Lasers', 'Lasts', 'Latests', 'Laughs',\r\n    'Laughters', 'Launches', 'Lawns', 'Laws', 'Lawsuits', 'Lawyers',\r\n    'Layers', 'Layouts', 'Leaders', 'Leaderships', 'Leads', 'Leaflets',\r\n    'Leagues', 'Leaks', 'Leaps', 'Learnings', 'Leathers',\r\n    'Leaves', 'Lectures', 'Lefts', 'Legacies', 'Legends', 'Legislations',\r\n    'Legislatures', 'Legs', 'Leisures', 'Lemons', 'Lengths', 'Lens',\r\n    'Lessons', 'Letters', 'Levels', 'Liberals', 'Liberations', 'Liberties',\r\n    'Libraries', 'Licences', 'Lies', 'Lifestyles', 'Lifetimes', 'Lifts',\r\n    'Lightings', 'Lights', 'Likelihoods', 'Likes', 'Limbs', 'Limitations',\r\n    'Limits', 'LineUps', 'Lines', 'Links', 'Lions', 'Lips', 'Liquids',\r\n    'Listeners', 'Listings', 'Lists', 'Literacies', 'Literatures', 'Litres',\r\n    'Litters', 'Livers', 'Lives', 'Livings', 'Loads', 'Loans', 'Lobbies',\r\n    'Locals', 'Locations', 'Locks', 'Logics', 'Logos', 'Logs', 'Looks',\r\n    'Loops', 'Lords', 'Lorries', 'Losses', 'Lotteries', 'Loves', 'Lows',\r\n    'Loyalties', 'Luck', 'Lunches', 'Lungs', 'Luxuries', 'Lyrics',\r\n    'Machineries', 'Machines', 'Magazines', 'Magics', 'Magistrates',\r\n    'Magnitudes', 'Mails', 'Mainlands', 'Mainstreams', 'Maintenances',\r\n    'Majorities', 'MakeUps', 'Makes', 'Makings', 'Malls',\r\n    'Managements', 'Managers', 'Mandates', 'Manipulations', 'Manners',\r\n    'Manufacturings', 'Manuscripts', 'Maps', 'Marathons',\r\n    'Marches', 'Margins', 'Markers', 'Marketings', 'Marketplaces',\r\n    'Markets', 'Marks', 'Marriages', 'Masks', 'Masses',\r\n    'Masters', 'Matches', 'Materials', 'Mates', 'Mathematics', 'Maths',\r\n    'Matters', 'Maximums', 'Mayors', 'Mays', 'Meals', 'Meanings', 'Means',\r\n    'Meantimes', 'Measurements', 'Measures', 'Meats', 'Mechanics',\r\n    'Mechanisms', 'Medals', 'Media', 'Medications', 'Medicines',\r\n    'Meditations', 'Meetings', 'Melodies', 'Members', 'Memberships',\r\n    'Memoirs', 'Memorials', 'Memories', 'Memos', 'Mentions',\r\n    'Mentors', 'Menus', 'Merchants', 'Mercies', 'Mergers', 'Merits',\r\n    'Messages', 'Messes', 'Metals', 'Metaphors', 'Methodologies', 'Methods',\r\n    'Metres', 'Mice', 'Middles', 'Midnights', 'Midsts', 'Migrations',\r\n    'Miles', 'Milks', 'Mills',\r\n    'Minds', 'Minerals', 'Miners', 'Mines', 'Minimums', 'Minings',\r\n    'Ministers', 'Ministries', 'Minutes', 'Miracles',\r\n    'Mirrors', 'Miseries', 'Missiles', 'Missions', 'Mistakes', 'Mixes',\r\n    'Mixtures', 'Mobiles', 'Mobilities', 'Mobs', 'Modes',\r\n    'Modifications', 'Momenta', 'Moments', 'Mondays', 'Moneys', 'Monitors',\r\n    'Monkeys', 'Monks', 'Monopolies', 'Monsters', 'Months', 'Monuments',\r\n    'Moods', 'Moons', 'Moralities', 'Morals', 'Mornings', 'Mortgages',\r\n    'Mothers', 'Motions', 'Motivations', 'Motives',\r\n    'Motorcycles', 'Motorists', 'Motors', 'Mountains', 'Mouths',\r\n    'Movements', 'Moves', 'Movies', 'Muds', 'Mums', 'Muscles',\r\n    'Museums', 'Music', 'Musicals', 'Musicians', 'Mysteries', 'Myths',\r\n    'Nails', 'Names', 'Narratives', 'Nationals', 'Nations',\r\n    'Natures', 'Navigations', 'Necessities', 'Necks', 'Needles', 'Needs',\r\n    'Negatives', 'Neglects', 'Negotiations', 'Neighbourhoods', 'Neighbours',\r\n    'Nerves', 'Nests', 'Nets', 'Networks', 'News', 'Newsletters',\r\n    'Newspapers', 'Niches', 'Nightmares', 'Nights', 'Noises', 'Nominations',\r\n    'Nominees', 'Nonsenses', 'Noons', 'Normals', 'Norms', 'Norths', 'Noses',\r\n    'Notebooks', 'Notes', 'Notices', 'Notions', 'Novelists', 'Novels',\r\n    'Novembers', 'Numbers', 'Nurseries', 'Nurses', 'Nursings', 'Nutritions',\r\n    'Nuts', 'Obesities', 'Objections', 'Objectives', 'Objects',\r\n    'Obligations', 'Observations', 'Observers', 'Obsessions', 'Obstacles',\r\n    'Occasions', 'Occupations', 'Occurrences', 'Oceans', 'Octobers', 'Odds',\r\n    'Offences', 'Offerings', 'Offers', 'Officers', 'Offices',\r\n    'Officials', 'Offspring', 'Oils', 'Onions', 'Openings', 'Operas',\r\n    'Operations', 'Operators', 'Opinions', 'Opponents', 'Opportunities',\r\n    'Opposites', 'Oppositions', 'Optimisms', 'Options', 'Oranges',\r\n    'Orchestras', 'Orders', 'Organizations', 'Organizers', 'Organs',\r\n    'Orientations', 'Originals', 'Origins', 'Outbreaks', 'Outcomes',\r\n    'Outfits', 'Outings', 'Outlets', 'Outlines', 'Outlooks', 'Outputs',\r\n    'Outrages', 'Outsiders', 'Outsides', 'Ovens', 'Owners', 'Ownerships',\r\n    'Oxygens', 'Paces', 'Packages', 'Packets', 'Packs', 'Pads', 'Pages',\r\n    'Pains', 'Painters', 'Paintings', 'Paints', 'Pairs', 'Palaces', 'Palms',\r\n    'Panels', 'Panics', 'Pans', 'Pants', 'Papers', 'Parades', 'Paragraphs',\r\n    'Parallels', 'Parameters', 'Parents', 'Parishes', 'Parkings', 'Parks',\r\n    'Parliaments', 'Participants', 'Participations', 'Parties', 'Partners',\r\n    'Partnerships', 'Parts', 'Passages', 'Passengers', 'Passes', 'Passings',\r\n    'Passions', 'Passports', 'Passwords', 'Pastors', 'Pasts', 'Patches',\r\n    'Patents', 'Paths', 'Pathways', 'Patiences', 'Patients', 'Patrols',\r\n    'Patrons', 'Patterns', 'Pauses', 'Payments', 'Pays', 'Peaces', 'Peaks',\r\n    'Peasants', 'Peers', 'Penalties', 'Pencils', 'Pennies', 'Pens',\r\n    'Pensions', 'People', 'Peoples', 'Peppers', 'Percentages',\r\n    'Perceptions', 'Performances', 'Periods', 'Permissions', 'Permits',\r\n    'Personalities', 'Personnels', 'Perspectives', 'Petitions', 'Petrols',\r\n    'Pets', 'Phases', 'Phenomena', 'Philosophers', 'Philosophies', 'Phones',\r\n    'Photographers', 'Photographies', 'Photographs', 'Photos', 'Phrases',\r\n    'Physicians', 'Physics', 'Pianos', 'Picks', 'Pictures', 'Pieces',\r\n    'Pigs', 'Piles', 'Pills', 'Pilots', 'Pinks', 'Pins', 'Pioneers',\r\n    'Pipelines', 'Pipes', 'Pirates', 'Pitches', 'Pities', 'Pits',\r\n    'Placements', 'Places', 'Planes', 'Planets', 'Plannings', 'Plans',\r\n    'Plants', 'Plastics', 'Plates', 'Platforms', 'Players', 'Plays',\r\n    'Pleas', 'Pleasures', 'Pledges', 'Plots', 'Plugs', 'Plus', 'Pockets',\r\n    'Poems', 'Poetries', 'Poets', 'Points', 'Poisons', 'Poles', 'Police',\r\n    'Policemen', 'Policies', 'Politicians', 'Politics', 'Polls',\r\n    'Pollutions', 'Ponds', 'Pools', 'Pops', 'Popularities', 'Populations',\r\n    'Portfolios', 'Portions', 'Portraits', 'Ports', 'Positions',\r\n    'Positives', 'Possessions', 'Possibilities', 'Posters', 'Posts',\r\n    'Potatoes', 'Potentials', 'Pots', 'Pounds', 'Poverties', 'Powders',\r\n    'Powers', 'Practices', 'Practitioners', 'Praises', 'Prayers',\r\n    'Precedents', 'Precisions', 'Predators', 'Predecessors', 'Predictions',\r\n    'Preferences', 'Pregnancies', 'Prejudices', 'Premises', 'Premiums',\r\n    'Preparations', 'Prescriptions', 'Presences', 'Presentations',\r\n    'Presents', 'Preservations', 'Presidencies', 'Presidents', 'Presses',\r\n    'Pressures', 'Prevalences', 'Preventions', 'Preys', 'Prices', 'Prides',\r\n    'Priests', 'Princes', 'Princesses', 'Principals', 'Principles',\r\n    'Printers', 'Printings', 'Prints', 'Priorities', 'Prisons',\r\n    'Privacies', 'Privatizations', 'Privileges', 'Prizes', 'Probabilities',\r\n    'Probes', 'Problems', 'Procedures', 'Proceedings', 'Proceeds',\r\n    'Processes', 'Processings', 'Processors', 'Producers', 'Produces',\r\n    'Productions', 'Productivities', 'Products', 'Professionals',\r\n    'Professions', 'Professors', 'Profiles', 'Profits', 'Programmes',\r\n    'Programmings', 'Programs', 'Progresses', 'Projections', 'Projects',\r\n    'Promises', 'Promotions', 'Proofs', 'Propagandas', 'Properties',\r\n    'Proportions', 'Proposals', 'Propositions', 'Prosecutions',\r\n    'Prosecutors', 'Prospects', 'Prosperities', 'Protections', 'Proteins',\r\n    'Protesters', 'Protests', 'Protocols', 'Provinces', 'Provisions',\r\n    'Psychologies', 'Psychologists', 'Publications', 'Publicities',\r\n    'Publics', 'Publishings', 'Pubs', 'Pulls', 'Pulses', 'Pumps', 'Punches',\r\n    'Punishments', 'Punks', 'Pupils', 'Purchases', 'Purples', 'Purposes',\r\n    'Pursuits', 'Pushes', 'Puzzles', 'Qualifications', 'Qualities',\r\n    'Quantities', 'Quarters', 'Queens', 'Queries', 'Questionnaires',\r\n    'Questions', 'Quests', 'Queues', 'Quotas', 'Quotations', 'Quotes',\r\n    'Races', 'Racings', 'Radars', 'Radiations',\r\n    'Radios', 'Rages', 'Raids', 'Rails', 'Railways', 'Rains', 'Rallies',\r\n    'Ranges', 'Rankings', 'Ranks', 'Rates', 'Ratings', 'Ratios',\r\n    'Rats', 'Rays', 'Reaches', 'Reactions', 'Readers', 'Readings',\r\n    'Realities', 'Realizations', 'Realms', 'Rears', 'Reasonings', 'Reasons',\r\n    'Rebellions', 'Rebels', 'Receipts', 'Receivers', 'Receptions',\r\n    'Recessions', 'Recipes', 'Recipients', 'Recognitions',\r\n    'Recommendations', 'Reconstructions', 'Recordings', 'Records',\r\n    'Recoveries', 'Recruitments', 'Recruits', 'Reductions',\r\n    'Referees', 'References', 'Referendums', 'Reflections', 'Reforms',\r\n    'Refusals', 'Regards', 'Regimes', 'Regions',\r\n    'Registers', 'Registrations', 'Regrets', 'Regulations', 'Regulators',\r\n    'Rehabilitations', 'Reigns', 'Rejections', 'Relations', 'Relationships',\r\n    'Relatives', 'Releases', 'Relevances', 'Reliabilities', 'Reliefs',\r\n    'Religions', 'Remainders', 'Remains', 'Remarks', 'Remedies',\r\n    'Reminders', 'Removals', 'Rentals', 'Rents', 'Repairs', 'Repeats',\r\n    'Replacements', 'Replies', 'Reporters', 'Reportings', 'Reports',\r\n    'Representations', 'Representatives', 'Reproductions', 'Republics',\r\n    'Reputations', 'Requests', 'Requirements', 'Rescues', 'Researchers',\r\n    'Researches', 'Reservations', 'Reserves', 'Residences', 'Residents',\r\n    'Residues', 'Resignations', 'Resistances', 'Resolutions', 'Resorts',\r\n    'Resources', 'Respects', 'Responses', 'Responsibilities', 'Restaurants',\r\n    'Restorations', 'Restraints', 'Restrictions', 'Rests', 'Results',\r\n    'Retails', 'Retirements', 'Retreats', 'Returns', 'Revelations',\r\n    'Revenges', 'Revenues', 'Reverses', 'Reviews', 'Revisions', 'Revivals',\r\n    'Revolutions', 'Rewards', 'Rhetorics', 'Rhythms', 'Rices', 'Rides',\r\n    'Rifles', 'Rights', 'Rings', 'Riots', 'Rises', 'Risks', 'Rituals',\r\n    'Rivals', 'Rivers', 'Roads', 'Robberies', 'Robots', 'Rockets', 'Rocks',\r\n    'Rods', 'Roles', 'Rolls', 'Romances', 'Roofs', 'Rooms', 'Roots',\r\n    'Ropes', 'Roses', 'Rotations', 'Rounds', 'Routes', 'Routines', 'Rows',\r\n    'Rubbers', 'Rubbishes', 'Rugbies', 'Ruins', 'Rules', 'Rulings',\r\n    'Rumours', 'Runners', 'Runnings', 'Runs', 'Rushes', 'Sacrifices',\r\n    'Safeties', 'Sailings', 'Sailors', 'Sails', 'Saints', 'Sakes', 'Salads',\r\n    'Salaries', 'Sales', 'Salts', 'Samples', 'Sanctions', 'Sands',\r\n    'Sandwiches', 'Satellites', 'Satisfactions', 'Saturdays', 'Sauces',\r\n    'Savings', 'Says', 'Scales', 'Scandals', 'Scares', 'Scenarios',\r\n    'Scenes', 'Schedules', 'Schemes', 'Scholars', 'Scholarships', 'Schools',\r\n    'Sciences', 'Scientists', 'Scopes', 'Scores', 'Scratches', 'Screams',\r\n    'Screenings', 'Screens', 'Screws', 'Scripts', 'Scrutinies',\r\n    'Sculptures', 'Seals', 'Searches', 'Seas', 'Seasons', 'Seats',\r\n    'Seconds', 'Secretaries', 'Secrets', 'Sections', 'Sectors',\r\n    'Securities', 'Seeds', 'Seekers', 'Segments', 'Selections', 'Selves',\r\n    'Seminars', 'Senators', 'Sensations', 'Senses', 'Sensitivities',\r\n    'Sentences', 'Sentiments', 'Separations', 'Septembers', 'Sequences',\r\n    'Series', 'Servants', 'Services', 'Sessions', 'SetUps', 'Sets',\r\n    'Settings', 'Settlements', 'Settlers', 'Shades',\r\n    'Shadows', 'Shakes', 'Shames', 'Shapes', 'Shareholders', 'Shares',\r\n    'Sheep', 'Sheets', 'Shells', 'Shelters', 'Shelves', 'Shifts',\r\n    'Shippings', 'Ships', 'Shirts', 'Shocks', 'Shoes', 'Shootings',\r\n    'Shoots', 'Shoppings', 'Shops', 'Shores', 'Shortages', 'Shots',\r\n    'Shoulders', 'Shouts', 'Showers', 'Shows', 'Siblings', 'Sides', 'Sighs',\r\n    'Sights', 'Signals', 'Signatures', 'Significances', 'Signs', 'Silences',\r\n    'Silks', 'Silver', 'Similarities', 'Simulations', 'Singers', 'Singings',\r\n    'Singles', 'Sins', 'Sirs', 'Sites', 'Situations', 'Sizes',\r\n    'Sketches', 'Skies', 'Skiings', 'Skills', 'Skins', 'Skirts', 'Skis',\r\n    'Skulls', 'Sleeps', 'Slices', 'Slides',\r\n    'Slogans', 'Slopes', 'Slots', 'Smartphones', 'Smells', 'Smiles',\r\n    'Smokes', 'Smokings', 'Snakes', 'Snows', 'Soaps', 'Soccers',\r\n    'Societies', 'Socks', 'Softwares', 'Soils', 'Soldiers', 'Solicitors',\r\n    'Solidarities', 'Solids', 'Solos', 'Solutions', 'Songs', 'Sons',\r\n    'Sorts', 'Souls', 'Sounds', 'Soups', 'Sources',\r\n    'Sovereignties', 'Spaces', 'Spams', 'Spans', 'Speakers', 'Specialists',\r\n    'Species', 'Specifications', 'Specimens', 'Spectacles', 'Spectators',\r\n    'Spectra', 'Speculations', 'Speeches', 'Speeds', 'Spellings', 'Spells',\r\n    'Spendings', 'Spheres', 'Spices', 'Spiders', 'Spies', 'Spines', 'Spins',\r\n    'Spirits', 'Spites', 'Splits', 'Spokesmen', 'Spokespeople', 'Sponsors',\r\n    'Sponsorships', 'Spoons', 'Sports', 'Spotlights', 'Spots', 'Spouses',\r\n    'Spreads', 'Springs', 'Squads', 'Squares', 'Stabilities', 'Stadiums',\r\n    'Staffs', 'Stages', 'Stairs', 'Stakes', 'Stalls', 'Stamps', 'Stances',\r\n    'Standards', 'Stands', 'Stars', 'Starts', 'Statements', 'States',\r\n    'Stations', 'Statistics', 'Statues', 'Status', 'Stays', 'Steams',\r\n    'Steels', 'Stems', 'Steps', 'Stereotypes', 'Sticks', 'Stimuli',\r\n    'Stocks', 'Stomachs', 'Stones', 'Stops', 'Storages', 'Stores',\r\n    'Stories', 'Storms', 'Strains', 'Strands', 'Strangers', 'Strategies',\r\n    'Streams', 'Streets', 'Strengths', 'Stresses', 'Stretches', 'Strikes',\r\n    'Strings', 'Strips', 'Strokes', 'Structures', 'Struggles', 'Students',\r\n    'Studies', 'Studios', 'Stuffs', 'Styles', 'Subjects', 'Submissions',\r\n    'Subscribers', 'Subscriptions', 'Subsidies', 'Substances',\r\n    'Substitutes', 'Substitutions', 'Suburbs', 'Successes', 'Successions',\r\n    'Successors', 'Sufferings', 'Sugars', 'Suggestions',\r\n    'Suites', 'Suits', 'Summaries', 'Summers', 'Summits', 'Sums', 'Sundays',\r\n    'Suns', 'Supermarkets', 'Supervisions', 'Supervisors', 'Supplements',\r\n    'Supplies', 'Supporters', 'Supports', 'Surfaces', 'Surgeons',\r\n    'Surgeries', 'Surges', 'Surplus', 'Surprises', 'Surveillances',\r\n    'Surveys', 'Survivals', 'Survivors', 'Suspects', 'Suspensions',\r\n    'Suspicions', 'Sweaters', 'Sweets', 'Swimmings', 'Swims', 'Swings',\r\n    'Switches', 'Swords', 'Symbols', 'Sympathies', 'Symptoms', 'Syndromes',\r\n    'Syntheses', 'Systems', 'TShirts', 'Tables', 'Tablets', 'Tackles',\r\n    'Tactics', 'Tags', 'Tails', 'Talents', 'Tales', 'Talks', 'Tanks',\r\n    'Tapes', 'Taps', 'Targets', 'Tasks', 'Tastes', 'Taxes', 'Taxis',\r\n    'Taxpayers', 'Teachers', 'Teachings', 'Teams', 'Tears', 'Teas',\r\n    'Techniques', 'Technologies', 'Teenagers', 'Teens', 'Teeth',\r\n    'Telephones', 'Televisions', 'Temperatures', 'Temples', 'Tenants',\r\n    'Tendencies', 'Tennis', 'Tensions', 'Tents', 'Tenures', 'Terminals',\r\n    'Terms', 'Terrains', 'Territories',\r\n    'Testimonies', 'Testings', 'Tests', 'Textbooks', 'Texts',\r\n    'Textures', 'Thanks', 'Theatres', 'Thefts', 'Themes', 'Theologies',\r\n    'Theories', 'Therapies', 'Therapists', 'Theses', 'Thieves', 'Things',\r\n    'Thinkings', 'Thirds', 'Thoughts', 'Threads', 'Threats', 'Thresholds',\r\n    'Throats', 'Thumbs', 'Thursdays', 'Tickets', 'Tides', 'Ties', 'Timbers',\r\n    'Times', 'Timings', 'Tins', 'Tips', 'Tissues', 'Titles', 'Tobaccos',\r\n    'Todays', 'Toes', 'Toilets', 'Tolerances', 'Tolls', 'Tomatoes',\r\n    'Tomorrows', 'Tones', 'Tongues', 'Tonights', 'Tonnes', 'Tons', 'Tools',\r\n    'Topics', 'Tops', 'Tortoises', 'Totals', 'Touches', 'Tourisms',\r\n    'Tourists', 'Tournaments', 'Tours', 'Towels', 'Towers', 'Towns', 'Toys',\r\n    'Traces', 'Tracks', 'Trademarks', 'Trades', 'Tradings', 'Traditions',\r\n    'Traffics', 'Tragedies', 'Trailers', 'Trails', 'Trainers', 'Trainings',\r\n    'Trains', 'Traits', 'Transactions', 'Transcripts', 'Transfers',\r\n    'Transformations', 'Transitions', 'Transits', 'Translations',\r\n    'Transmissions', 'Transparencies', 'Transportations', 'Transports',\r\n    'Traps', 'Traumas', 'Travellers', 'Travels', 'Treasures', 'Treaties',\r\n    'Treatments', 'Trees', 'Trends', 'Trials', 'Tribes', 'Tribunals',\r\n    'Tributes', 'Tricks', 'Tries', 'Triggers', 'Trios', 'Trips', 'Triumphs',\r\n    'Troops', 'Trophies', 'Troubles', 'Trousers', 'Trucks', 'Trustees',\r\n    'Trusts', 'Truths', 'Tsunamis', 'Tubes', 'Tuesdays', 'Tuitions',\r\n    'Tunes', 'Tunnels', 'Turnouts', 'Turnovers', 'Turns', 'Tvs',\r\n    'Twists', 'Types', 'Tyres', 'Umbrellas', 'Uncertainties', 'Uncles',\r\n    'Undergraduates', 'Understandings', 'Underwears', 'Unemployments',\r\n    'Uniforms', 'Unions', 'Unities', 'Units', 'Universes', 'Universities',\r\n    'Updates', 'Upgrades', 'Usages', 'Users', 'Uses', 'Utilities',\r\n    'Vacations', 'Vacuums', 'Validities', 'Valleys', 'Values', 'Vans',\r\n    'Variables', 'Variations', 'Varieties', 'Vegetables', 'Vehicles',\r\n    'Veins', 'Ventures', 'Venues', 'Verdicts', 'Verses', 'Versions',\r\n    'Vessels', 'Veterans', 'Vices', 'Victories', 'Videos',\r\n    'Viewers', 'Viewpoints', 'Views', 'Villagers', 'Villages', 'Violations',\r\n    'Violences', 'Virtues', 'Viruses', 'Visas', 'Visions', 'Visitors',\r\n    'Visits', 'Vitamins', 'Voices', 'Volumes', 'Volunteers', 'Votes',\r\n    'Votings', 'Vulnerabilities', 'Wages', 'Waiters', 'Waits', 'Walks',\r\n    'Walls', 'Wards', 'Warehouses', 'Warfares', 'Warmings', 'Warnings',\r\n    'Warrants', 'Warriors', 'Washes', 'Washings', 'Wastes',\r\n    'Watches', 'Waters', 'Waves', 'Ways', 'Weaknesses', 'Wealths',\r\n    'Weathers', 'Webs', 'Websites', 'Weddings', 'Wednesdays',\r\n    'Weeds', 'Weekends', 'Weeks', 'Weights', 'Welcomes', 'Welfares',\r\n    'WellBeings', 'Wells', 'Wests', 'Wheat', 'Wheels', 'Whispers',\r\n    'Wholes', 'Widows', 'Widths', 'Wildlives', 'Willingnesses',\r\n    'Wills', 'Windows', 'Winds', 'Wines', 'Wings', 'Winners', 'Wins',\r\n    'Winters', 'Wires', 'Wisdoms', 'Wishes', 'Withdrawals', 'Witnesses',\r\n    'Wits', 'Wonders', 'Woods', 'Wools', 'Words', 'Workers', 'Workforces',\r\n    'Workouts', 'Workplaces', 'Works', 'Workshops', 'Worlds', 'Worms',\r\n    'Worries', 'Worses', 'Worships', 'Worsts', 'Worths', 'Wounds', 'Wrists',\r\n    'Writers', 'Writings', 'Wrongs', 'Yards', 'Years', 'Yellows',\r\n    'Yesterdays', 'Yields', 'Zones'\r\n];\r\n\r\n/*\r\nconst _PLACE_ = [\r\n    'Pub', 'University', 'Airport', 'Library', 'Mall', 'Theater', 'Stadium',\r\n    'Office', 'Show', 'Gallows', 'Beach', 'Cemetery', 'Hospital', 'Reception',\r\n    'Restaurant', 'Bar', 'Church', 'House', 'School', 'Square', 'Village',\r\n    'Cinema', 'Movies', 'Party', 'Restroom', 'End', 'Jail', 'PostOffice',\r\n    'Station', 'Circus', 'Gates', 'Entrance', 'Bridge'\r\n];\r\n*/\r\n\r\n/**\r\n * The list of verbs.\r\n * @const\r\n */\r\n/* const _VERB_ = [\r\n    'Abolish', 'Absorb', 'Accelerate', 'Accept',\r\n    'Access', 'Accommodate', 'Accompany', 'Accomplish', 'Account',\r\n    'Accumulate', 'Accuse', 'Achieve', 'Acknowledge', 'Acquire', 'Act',\r\n    'Activate', 'Adapt', 'Add', 'Address', 'Adhere', 'Adjust', 'Administer',\r\n    'Admire', 'Admit', 'Adopt', 'Advance', 'Advertise', 'Advise',\r\n    'Advocate', 'Affect', 'Afford', 'Age', 'Agree', 'Aid', 'Aim', 'Alarm',\r\n    'Alert', 'Align', 'Allege', 'Allocate', 'Allow', 'Alter', 'Amend',\r\n    'Amount', 'Analyse', 'Announce', 'Annoy', 'Answer', 'Anticipate',\r\n    'Apologize', 'Appeal', 'Appear', 'Applaud', 'Apply', 'Appoint',\r\n    'Appreciate', 'Approach', 'Approve', 'Argue', 'Arise', 'Arm', 'Arrange',\r\n    'Arrest', 'Arrive', 'Articulate', 'Ask', 'Aspire',\r\n    'Assemble', 'Assert', 'Assess', 'Assign', 'Assist', 'Associate',\r\n    'Assume', 'Assure', 'Attach', 'Attain', 'Attempt', 'Attend',\r\n    'Attract', 'Attribute', 'Authorize', 'Average', 'Avoid', 'Await',\r\n    'Award', 'Back', 'Bake', 'Balance', 'Ban', 'Bar', 'Base', 'Bat',\r\n    'Battle', 'Be', 'Bear', 'Beat', 'Become', 'Beg', 'Begin', 'Behave',\r\n    'Believe', 'Belong', 'Bend', 'Benefit', 'Bet', 'Betray', 'Bid', 'Bill',\r\n    'Bind', 'Bite', 'Blame', 'Blast', 'Blend', 'Bless', 'Block',\r\n    'Blow', 'Board', 'Boast', 'Boil', 'Book', 'Boost', 'Border',\r\n    'Borrow', 'Bother', 'Bounce', 'Bow', 'Brand', 'Breach', 'Break',\r\n    'Breathe', 'Breed', 'Bring', 'Broadcast', 'Brush', 'Build', 'Burn',\r\n    'Burst', 'Bury', 'Buy', 'Calculate', 'Call', 'Calm', 'Camp', 'Campaign',\r\n    'Cancel', 'Capture', 'Care', 'Carry', 'Carve', 'Cast', 'Catch', 'Cater',\r\n    'Cause', 'Cease', 'Celebrate', 'Centre', 'Chain', 'Chair', 'Challenge',\r\n    'Change', 'Characterize', 'Charge', 'Chart', 'Chase', 'Chat', 'Cheat',\r\n    'Check', 'Cheer', 'Choose', 'Chop', 'Circle', 'Circulate', 'Cite',\r\n    'Claim', 'Clarify', 'Classify', 'Clean', 'Clear', 'Click', 'Climb',\r\n    'Cling', 'Close', 'Coach', 'Coincide', 'Collaborate', 'Collapse',\r\n    'Collect', 'Combat', 'Combine', 'Come', 'Comfort', 'Command',\r\n    'Commence', 'Comment', 'Commission', 'Commit', 'Communicate', 'Compare',\r\n    'Compel', 'Compensate', 'Compete', 'Compile', 'Complain', 'Complement',\r\n    'Complete', 'Comply', 'Compose', 'Comprise', 'Compromise', 'Compute',\r\n    'Conceal', 'Concede', 'Conceive', 'Concentrate', 'Concern', 'Conclude',\r\n    'Condemn', 'Conduct', 'Confer', 'Confess', 'Confine', 'Confirm',\r\n    'Conflict', 'Confront', 'Confuse', 'Congratulate', 'Connect', 'Conquer',\r\n    'Consent', 'Conserve', 'Consider', 'Consist', 'Consolidate',\r\n    'Constitute', 'Construct', 'Consult', 'Consume', 'Contact', 'Contain',\r\n    'Contemplate', 'Contend', 'Contest', 'Continue', 'Contract', 'Contrast',\r\n    'Contribute', 'Control', 'Convert', 'Convey', 'Convict', 'Convince',\r\n    'Cook', 'Cool', 'Cooperate', 'Coordinate', 'Cope', 'Copy', 'Correct',\r\n    'Correlate', 'Correspond', 'Cost', 'Count', 'Counter', 'Cover', 'Crack',\r\n    'Craft', 'Crash', 'Crawl', 'Create', 'Credit', 'Creep', 'Criticize',\r\n    'Cross', 'Cruise', 'Crush', 'Cry', 'Cultivate', 'Cure', 'Curve', 'Cut',\r\n    'Cycle', 'Damage', 'Dance', 'Dare', 'Date', 'Deal', 'Debate', 'Decide',\r\n    'Declare', 'Decline', 'Decorate', 'Decrease', 'Deem', 'Defeat',\r\n    'Defend', 'Define', 'Defy', 'Delay', 'Delete', 'Delight', 'Deliver',\r\n    'Demand', 'Demonstrate', 'Denounce', 'Deny', 'Depart', 'Depend',\r\n    'Depict', 'Deploy', 'Deposit', 'Deprive', 'Derive', 'Descend',\r\n    'Describe', 'Desert', 'Deserve', 'Design', 'Designate', 'Desire',\r\n    'Destroy', 'Detail', 'Detain', 'Detect', 'Deteriorate', 'Determine',\r\n    'Devastate', 'Develop', 'Devise', 'Devote', 'Diagnose', 'Dictate',\r\n    'Differ', 'Differentiate', 'Dig', 'Diminish', 'Dip', 'Direct',\r\n    'Disagree', 'Disappear', 'Disappoint', 'Discard', 'Discharge',\r\n    'Disclose', 'Discount', 'Discourage', 'Discover', 'Discuss', 'Dislike',\r\n    'Dismiss', 'Displace', 'Display', 'Dispose', 'Dispute', 'Disrupt',\r\n    'Dissolve', 'Distinguish', 'Distort', 'Distract', 'Distress',\r\n    'Distribute', 'Disturb', 'Dive', 'Divert', 'Divide', 'Divorce', 'Do',\r\n    'Document', 'Dominate', 'Donate', 'Double', 'Doubt', 'Download',\r\n    'Draft', 'Drag', 'Drain', 'Draw', 'Dream', 'Dress', 'Drift', 'Drink',\r\n    'Drive', 'Drop', 'Dry', 'Dub', 'Dump', 'Earn', 'Ease', 'Eat',\r\n    'Echo', 'Edit', 'Educate', 'Elect', 'Elevate', 'Eliminate', 'Email',\r\n    'Embark', 'Embed', 'Embody', 'Embrace', 'Emerge', 'Emphasize', 'Employ',\r\n    'Empower', 'Empty', 'Enable', 'Enact', 'Encompass', 'Encounter',\r\n    'Encourage', 'End', 'Endorse', 'Endure', 'Enforce', 'Engage', 'Enhance',\r\n    'Enjoy', 'Enquire', 'Enrich', 'Enrol', 'Ensue', 'Ensure', 'Enter',\r\n    'Entertain', 'Entitle', 'Equal', 'Equip', 'Erect', 'Erupt', 'Escalate',\r\n    'Escape', 'Establish', 'Estimate', 'Evacuate', 'Evaluate', 'Evoke',\r\n    'Evolve', 'Exaggerate', 'Examine', 'Exceed', 'Exchange', 'Exclude',\r\n    'Excuse', 'Execute', 'Exercise', 'Exert', 'Exhibit', 'Exist', 'Exit',\r\n    'Expand', 'Expect', 'Experience', 'Experiment', 'Expire', 'Explain',\r\n    'Explode', 'Exploit', 'Explore', 'Export', 'Expose', 'Express',\r\n    'Extend', 'Extract', 'Face', 'Facilitate', 'Fade', 'Fail', 'Fall',\r\n    'Fancy', 'Farm', 'Fasten', 'Favour', 'Fear', 'Feature', 'Feed', 'Feel',\r\n    'Fight', 'Figure', 'File', 'Fill', 'Film', 'Filter', 'Finance', 'Find',\r\n    'Fine', 'Finish', 'Fire', 'Fish', 'Fit', 'Fix', 'Flash', 'Flee',\r\n    'Float', 'Flood', 'Flourish', 'Flow', 'Fly', 'Focus', 'Fold', 'Follow',\r\n    'Forbid', 'Force', 'Forecast', 'Forge', 'Forget', 'Forgive', 'Form',\r\n    'Formulate', 'Foster', 'Found', 'Frame', 'Free', 'Freeze', 'Frighten',\r\n    'Fry', 'Fuel', 'Fulfil', 'Function', 'Fund', 'Gain', 'Gather', 'Gaze',\r\n    'Generate', 'Get', 'Give', 'Glance', 'Go', 'Govern', 'Grab', 'Grade',\r\n    'Graduate', 'Grant', 'Grasp', 'Greet', 'Grin', 'Grind', 'Grip', 'Grow',\r\n    'Guarantee', 'Guard', 'Guess', 'Guide', 'Hail', 'Halt', 'Hand',\r\n    'Handle', 'Hang', 'Happen', 'Harvest', 'Haunt', 'Have',\r\n    'Head', 'Heal', 'Hear', 'Heat', 'Heighten', 'Help', 'Hesitate', 'Hide',\r\n    'Highlight', 'Hint', 'Hire', 'Hit', 'Hold', 'Honour', 'Hook', 'Hope',\r\n    'Host', 'House', 'Hunt', 'Hurry', 'Identify', 'Ignore',\r\n    'Illustrate', 'Imagine', 'Impact', 'Implement', 'Imply', 'Import',\r\n    'Impose', 'Impress', 'Improve', 'Include', 'Incorporate',\r\n    'Increase', 'Incur', 'Indicate', 'Induce', 'Indulge', 'Infect', 'Infer',\r\n    'Inflict', 'Influence', 'Inform', 'Inherit', 'Inhibit', 'Initiate',\r\n    'Inject', 'Injure', 'Insert', 'Insist', 'Inspect', 'Inspire', 'Install',\r\n    'Instruct', 'Insult', 'Integrate', 'Intend', 'Intensify', 'Interact',\r\n    'Interest', 'Interfere', 'Interpret', 'Interrupt', 'Intervene',\r\n    'Interview', 'Introduce', 'Invade', 'Invent', 'Invest', 'Investigate',\r\n    'Invite', 'Invoke', 'Involve', 'Iron', 'Isolate', 'Issue',\r\n    'Join', 'Joke', 'Judge', 'Jump', 'Justify', 'Keep', 'Key', 'Kick',\r\n    'Kiss', 'Knock', 'Know', 'Label', 'Lack', 'Land',\r\n    'Last', 'Laugh', 'Launch', 'Lay', 'Lead', 'Leak', 'Lean', 'Leap',\r\n    'Learn', 'Leave', 'Lecture', 'Lend', 'Let', 'Level', 'License', 'Lift',\r\n    'Light', 'Like', 'Limit', 'Line', 'Linger', 'Link', 'List', 'Listen',\r\n    'Live', 'Load', 'Lobby', 'Locate', 'Lock', 'Log', 'Look', 'Loom',\r\n    'Lose', 'Love', 'Lower', 'Mail', 'Maintain', 'Make', 'Manage',\r\n    'Manifest', 'Manipulate', 'Manufacture', 'Map', 'March', 'Mark',\r\n    'Market', 'Marry', 'Master', 'Match', 'Mate', 'Matter', 'Mature',\r\n    'Maximize', 'Mean', 'Measure', 'Meet', 'Melt', 'Mention', 'Merge',\r\n    'Mind', 'Minimize', 'Miss', 'Mistake', 'Mix', 'Mobilize', 'Model',\r\n    'Modify', 'Monitor', 'Motivate', 'Mount', 'Move', 'Multiply',\r\n    'Name', 'Narrow', 'Need', 'Neglect', 'Negotiate', 'Nod', 'Nominate',\r\n    'Note', 'Notice', 'Notify', 'Number', 'Obey', 'Object', 'Oblige',\r\n    'Observe', 'Obsess', 'Obtain', 'Occupy', 'Occur', 'Offend', 'Offer',\r\n    'Open', 'Operate', 'Oppose', 'Opt', 'Order', 'Organize', 'Originate',\r\n    'Outline', 'Outrage', 'Overcome', 'Overlook', 'Oversee', 'Overturn',\r\n    'Overwhelm', 'Owe', 'Own', 'Pace', 'Pack', 'Package', 'Paint', 'Park',\r\n    'Participate', 'Pass', 'Patrol', 'Pause', 'Pay', 'Perceive', 'Perform',\r\n    'Permit', 'Persist', 'Persuade', 'Phone', 'Photograph', 'Pick',\r\n    'Picture', 'Pile', 'Pin', 'Pioneer', 'Place', 'Plan', 'Plant', 'Play',\r\n    'Plead', 'Please', 'Pledge', 'Plot', 'Plug', 'Plunge', 'Point',\r\n    'Pop', 'Portray', 'Pose', 'Position', 'Possess', 'Post',\r\n    'Postpone', 'Pour', 'Power', 'Practise', 'Praise', 'Pray', 'Preach',\r\n    'Precede', 'Predict', 'Prefer', 'Prepare', 'Prescribe', 'Present',\r\n    'Preserve', 'Preside', 'Press', 'Presume', 'Pretend', 'Prevail',\r\n    'Prevent', 'Price', 'Print', 'Probe', 'Proceed', 'Process', 'Proclaim',\r\n    'Produce', 'Program', 'Progress', 'Prohibit', 'Project', 'Promise',\r\n    'Promote', 'Prompt', 'Pronounce', 'Propose', 'Prosecute', 'Protect',\r\n    'Protest', 'Prove', 'Provide', 'Provoke', 'Publish', 'Pull', 'Pump',\r\n    'Punch', 'Punish', 'Purchase', 'Pursue', 'Push', 'Put', 'Qualify',\r\n    'Question', 'Queue', 'Quit', 'Quote', 'Race', 'Raid', 'Rain', 'Raise',\r\n    'Rally', 'Range', 'Rank', 'Rate', 'Reach', 'React', 'Read',\r\n    'Realize', 'Reassure', 'Rebuild', 'Recall', 'Receive', 'Reckon',\r\n    'Recognize', 'Recommend', 'Record', 'Recount', 'Recover', 'Recruit',\r\n    'Recycle', 'Reduce', 'Refer', 'Reflect', 'Reform', 'Refuse', 'Regain',\r\n    'Regard', 'Register', 'Regret', 'Regulate', 'Reign', 'Reinforce',\r\n    'Reject', 'Relate', 'Relax', 'Release', 'Relieve', 'Rely', 'Remain',\r\n    'Remark', 'Remember', 'Remind', 'Remove', 'Render', 'Renew', 'Rent',\r\n    'Repair', 'Repeat', 'Replace', 'Reply', 'Report', 'Represent',\r\n    'Reproduce', 'Request', 'Require', 'Rescue', 'Research', 'Resemble',\r\n    'Reserve', 'Reside', 'Resign', 'Resist', 'Resolve', 'Respect',\r\n    'Respond', 'Rest', 'Restore', 'Restrict', 'Result', 'Resume', 'Retain',\r\n    'Retire', 'Retreat', 'Retrieve', 'Return', 'Reveal', 'Reverse',\r\n    'Review', 'Revise', 'Revive', 'Reward', 'Rid', 'Ride', 'Ring', 'Rip',\r\n    'Rise', 'Risk', 'Rob', 'Rock', 'Roll', 'Rotate', 'Rub', 'Ruin', 'Rule',\r\n    'Run', 'Rush', 'Sack', 'Sacrifice', 'Sail', 'Sample', 'Satisfy', 'Save',\r\n    'Say', 'Scan', 'Scare', 'Schedule', 'Score', 'Scratch', 'Scream',\r\n    'Screen', 'Screw', 'Seal', 'Search', 'Seat', 'Secure', 'See', 'Seek',\r\n    'Seize', 'Select', 'Sell', 'Send', 'Sense', 'Sentence', 'Separate',\r\n    'Serve', 'Set', 'Settle', 'Shake', 'Shape', 'Share', 'Shatter', 'Shed',\r\n    'Shelter', 'Shift', 'Shine', 'Ship', 'Shock', 'Shoot', 'Shop', 'Shout',\r\n    'Show', 'Shrink', 'Shrug', 'Shut', 'Sigh', 'Sign', 'Signal', 'Simulate',\r\n    'Sing', 'Sink', 'Sit', 'Ski', 'Skip', 'Slam', 'Slap', 'Slash', 'Sleep',\r\n    'Slice', 'Slide', 'Slip', 'Slope', 'Slow', 'Smash', 'Smell', 'Smile',\r\n    'Smoke', 'Snap', 'Snow', 'Soak', 'Soar', 'Solve', 'Sort', 'Sound',\r\n    'Span', 'Spare', 'Spark', 'Speak', 'Specialize', 'Specify', 'Speculate',\r\n    'Speed', 'Spell', 'Spend', 'Spill', 'Spin', 'Split', 'Spoil', 'Sponsor',\r\n    'Spot', 'Spread', 'Spring', 'Spy', 'Squeeze', 'Stab', 'Stabilize',\r\n    'Stage', 'Stand', 'Star', 'Stare', 'Start', 'Starve', 'State', 'Stay',\r\n    'Steal', 'Steer', 'Stem', 'Step', 'Stick', 'Stimulate', 'Stir', 'Stop',\r\n    'Store', 'Strengthen', 'Stress', 'Stretch', 'Strike', 'Strip', 'Strive',\r\n    'Structure', 'Struggle', 'Study', 'Stuff', 'Stumble', 'Stun', 'Submit',\r\n    'Substitute', 'Succeed', 'Sue', 'Suffer', 'Suggest', 'Suit',\r\n    'Sum', 'Summarize', 'Supervise', 'Supplement', 'Supply', 'Support',\r\n    'Suppose', 'Suppress', 'Surge', 'Surprise', 'Surrender', 'Surround',\r\n    'Survey', 'Survive', 'Suspect', 'Suspend', 'Sustain', 'Swallow',\r\n    'Swear', 'Sweep', 'Swim', 'Swing', 'Switch', 'Tackle', 'Tag', 'Take',\r\n    'Talk', 'Tap', 'Target', 'Taste', 'Tax', 'Teach', 'Tear', 'Telephone',\r\n    'Tell', 'Tempt', 'Tend', 'Term', 'Terminate', 'Terrify', 'Test',\r\n    'Testify', 'Text', 'Thank', 'Think', 'Thrive', 'Throw',\r\n    'Tidy', 'Tie', 'Tighten', 'Time', 'Tip', 'Title', 'Tolerate', 'Top',\r\n    'Toss', 'Total', 'Touch', 'Tour', 'Trace', 'Track', 'Trade',\r\n    'Trail', 'Train', 'Transfer', 'Transform', 'Translate', 'Transmit',\r\n    'Transport', 'Trap', 'Travel', 'Treat', 'Trick', 'Trigger', 'Trip',\r\n    'Trouble', 'Trust', 'Try', 'Turn', 'Twist', 'Type', 'Undergo',\r\n    'Undermine', 'Understand', 'Undertake', 'Unfold', 'Unify', 'Unite',\r\n    'Unveil', 'Update', 'Upgrade', 'Uphold', 'Upset', 'Urge', 'Use',\r\n    'Utilize', 'Value', 'Vanish', 'Vary', 'Venture', 'Verify', 'View',\r\n    'Visit', 'Volunteer', 'Vote', 'Vow', 'Wait', 'Wake', 'Walk',\r\n    'Wander', 'Want', 'Warm', 'Warn', 'Warrant', 'Wash', 'Waste', 'Watch',\r\n    'Water', 'Wave', 'Weaken', 'Wear', 'Weave', 'Weigh', 'Welcome', 'Whip',\r\n    'Whisper', 'Widen', 'Win', 'Wind', 'Wipe', 'Wish', 'Withdraw',\r\n    'Witness', 'Wonder', 'Work', 'Worry', 'Worship', 'Wound', 'Wrap',\r\n    'Write', 'Yell', 'Yield'\r\n]; */\r\n\r\n/**\r\n * The list of adverbs.\r\n * @const\r\n */\r\nconst _ADVERB_ = [\r\n    'About', 'Above', 'Abroad', 'Absently', 'Absolutely', 'Accidentally',\r\n    'Accordingly', 'Accurately', 'Accusingly', 'Across', 'Actually',\r\n    'Additionally', 'Adequately', 'Adorably', 'After', 'Afterwards',\r\n    'Again', 'Ago', 'Ahead', 'Alike', 'All', 'Allegedly', 'AllTheTime',\r\n    'Almost', 'Alone', 'Along', 'Already', 'Also', 'Altogether', 'Always',\r\n    'Amazingly', 'Angrily', 'Annually', 'Anxiously', 'Any', 'Anyway',\r\n    'Anywhere', 'Apart', 'Appallingly', 'Apparently', 'Appropriately',\r\n    'Approximately', 'Arguably', 'Around', 'Articulately', 'As', 'Aside',\r\n    'Astonishingly', 'Automatically', 'Away', 'Back', 'Backwards', 'Badly',\r\n    'Barely', 'Basically', 'Beautifully', 'Before', 'Behind', 'Below',\r\n    'Besides', 'Best', 'Better', 'Between', 'Beyond', 'Blindly', 'Bravely',\r\n    'Briefly', 'Brightly', 'Briskly', 'Broadly', 'By', 'Calmly',\r\n    'Carefully', 'Casually', 'Cautiously', 'Certainly', 'Cheaply', 'Clearly',\r\n    'Cleverly', 'Close', 'Closely', 'Commonly', 'Completely',\r\n    'Consequently', 'Considerably', 'Consistently', 'Constantly',\r\n    'Continually', 'Correctly', 'Crazily', 'Critically', 'Curiously',\r\n    'Currently', 'Cynically', 'Daily', 'Dangerously', 'Deeply',\r\n    'Definitely', 'Deliberately', 'Delicately', 'Desperately',\r\n    'Differently', 'Directly', 'Discreetly', 'Double', 'Down',\r\n    'Downstairs', 'Downtown', 'Downwards', 'Dramatically', 'Each',\r\n    'Eagerly', 'Early', 'Easily', 'East', 'Effectively', 'Efficiently',\r\n    'Either', 'Else', 'Elsewhere', 'Emotionally', 'Enough', 'Entirely',\r\n    'Equally', 'Especially', 'Essentially', 'Euphoricly', 'Even', 'Evenly',\r\n    'Eventually', 'Ever', 'Everywhere', 'Exactly', 'Exclusively',\r\n    'Expectantly', 'Explicitly', 'Extensively', 'Extra', 'Extremely',\r\n    'Fairly', 'Far', 'Fast', 'Ferociously', 'Fiercely', 'Finally', 'Finely',\r\n    'Firmly', 'First', 'Firstly', 'Flatly', 'Forever', 'Formerly', 'Forth',\r\n    'Fortunately', 'Forward', 'Frankly', 'Free', 'Freely', 'Frequently',\r\n    'Frighteningly', 'FullTime', 'Fully', 'Fundamentally', 'Further',\r\n    'Furthermore', 'Generally', 'Gently', 'Genuinely', 'Gloriously',\r\n    'Gradually', 'Greatly', 'Grimly', 'Guiltily', 'Half', 'Halfway',\r\n    'Happily', 'Hard', 'Hardly', 'Hastily', 'Heavily', 'Hence', 'Here',\r\n    'Heroically', 'High', 'Highly', 'Home', 'Hopefully', 'Hourly', 'How',\r\n    'However', 'Humbly', 'Hysterically', 'Immediately', 'Immensely',\r\n    'Impartially', 'Impolitely', 'In', 'Increasingly', 'Incredibly',\r\n    'Indeed', 'Indifferently', 'Indoors', 'Inevitably', 'Initially',\r\n    'Inside', 'Instantly', 'Instead', 'Intensely', 'Ironically',\r\n    'Jealously', 'Jovially', 'Just', 'Kindly', 'Largely', 'Last', 'Late',\r\n    'Lately', 'Later', 'Lazily', 'Least', 'Left', 'Less', 'Lightly',\r\n    'Likewise', 'Literally', 'Little', 'Live', 'Long', 'LongTerm', 'Lot',\r\n    'Loud', 'Loudly', 'Lovingly', 'Low', 'Loyally', 'Magnificently',\r\n    'Mainly', 'Maybe', 'Meanwhile', 'Merely', 'Merrily',\r\n    'Mightily', 'Miserably', 'More', 'Moreover', 'Most', 'Mostly', 'Much',\r\n    'Mysteriously', 'Namely', 'Naturally', 'Near', 'Nearby', 'Nearly',\r\n    'Necessarily', 'Neither', 'Nervously', 'Never', 'Nevertheless', 'Newly',\r\n    'Next', 'Nicely', 'Nonetheless', 'Nor', 'Normally', 'North', 'Not',\r\n    'NOT', 'Notably', 'Now', 'Nowadays', 'Nowhere',\r\n    'Objectively', 'Obnoxiously', 'Obsessively', 'Obviously',\r\n    'Occasionally', 'Off', 'Often', 'Ok', 'On', 'Once', 'Online', 'Only',\r\n    'Openly', 'Opposite', 'Originally', 'Otherwise', 'Out', 'Outdoors',\r\n    'Outside', 'Over', 'Overall', 'Overly', 'Overnight', 'Overseas',\r\n    'Painfully', 'Partially', 'Particularly', 'Partly', 'Past', 'Patiently',\r\n    'Perfectly', 'Perhaps', 'Permanently', 'Personally', 'Playfully',\r\n    'Politely', 'Poorly', 'Possibly', 'Potentially', 'Precisely',\r\n    'Predominantly', 'Presently', 'Presumably', 'Pretty', 'Previously',\r\n    'Primarily', 'Probably', 'Promptly', 'Properly', 'Purely', 'Quickly',\r\n    'Quietly', 'Quite', 'Randomly', 'Rapidly', 'Rarely', 'Rather',\r\n    'Readily', 'Really', 'Reasonably', 'Recently', 'Recklessly',\r\n    'Regardless', 'Regularly', 'Relatively', 'Remarkably', 'Remorsefully',\r\n    'Reportedly', 'Respectively', 'Responsibly', 'Right', 'Roughly',\r\n    'Round', 'Rudely', 'Ruthlessly', 'Sadly', 'Same', 'Scornfully',\r\n    'Seamlessly', 'Second', 'Secondly', 'Seemingly', 'Seldom', 'Selfishly',\r\n    'Seriously', 'Severely', 'Shakily', 'Sharply', 'Shortly', 'Sideways',\r\n    'Significantly', 'Silently', 'Similarly', 'Simply', 'Simultaneously',\r\n    'Since', 'Sleepily', 'Slightly', 'Slowly', 'Slyly', 'Smoothly', 'So',\r\n    'Softly', 'Solely', 'Solemnly', 'Somehow', 'Sometime', 'Sometimes',\r\n    'Somewhat', 'Somewhere', 'Soon', 'South', 'Specifically', 'Steadily',\r\n    'Sternly', 'Still', 'Straight', 'Strangely', 'Strictly', 'Strongly',\r\n    'Stunningly', 'Subsequently', 'Substantially', 'Successfully',\r\n    'Suddenly', 'Sufficiently', 'Supposedly', 'Sure', 'Surely',\r\n    'Temporarily', 'Tenderly', 'Terribly', 'Thankfully', 'That', 'Then',\r\n    'There', 'Thereafter', 'Thereby', 'Therefore', 'This', 'Thoroughly',\r\n    'Though', 'Thoughtfully', 'Through', 'Throughout', 'Thus', 'Tightly',\r\n    'Today', 'Together', 'Tomorrow', 'Tonight', 'Too', 'Totally', 'Truly',\r\n    'Twice', 'Typically', 'Ultimately', 'Under', 'Underground',\r\n    'Undoubtedly', 'Uneasily', 'Unfortunately', 'Up', 'Upstairs', 'Upwards',\r\n    'Usually', 'Utterly', 'Vanishingly', 'Very', 'Warmly',\r\n    'Way', 'Weakly', 'Wearily', 'Weekly', 'Weirdly', 'Well', 'West',\r\n    'Whatever', 'Whatsoever', 'When', 'Where', 'Whereby', 'Wholly', 'Why',\r\n    'Wickedly', 'Widely', 'Wildly', 'Wisely', 'Wonderfully', 'Worldwide',\r\n    'Worse', 'Worst', 'Wrong', 'Yearly', 'Yesterday', 'Yet'\r\n];\r\n\r\n/**\r\n * The list of adjectives.\r\n * @const\r\n */\r\nconst _ADJECTIVE_ = [\r\n    'Able', 'Absent', 'Absolute', 'Abstract', 'Absurd', 'Academic',\r\n    'Acceptable', 'Accessible', 'Accountable', 'Accurate', 'Acid', 'Active',\r\n    'Actual', 'Acute', 'Additional', 'Adequate', 'Adjacent',\r\n    'Administrative', 'Adult', 'Advance', 'Advanced', 'Adverse',\r\n    'Aesthetic', 'Affordable', 'Afraid', 'Aged',\r\n    'Agricultural', 'Alert', 'Alien', 'Alike', 'Alive',\r\n    'Alone', 'Alternative', 'Amateur', 'Amazed', 'Amazing', 'Ambitious',\r\n    'Amusing', 'Ancient', 'Angry', 'Annoyed', 'Annoying', 'Annual',\r\n    'Anonymous', 'Anxious', 'Apparent', 'Appealing', 'Applicable',\r\n    'Appropriate', 'Arbitrary', 'Architectural', 'Artificial',\r\n    'Artistic', 'Ashamed', 'Asleep', 'Assistant', 'Associated',\r\n    'Astonishing', 'Attractive', 'Audio', 'Authentic', 'Automatic',\r\n    'Available', 'Average', 'Aware', 'Awful', 'Awkward', 'Back', 'Bad',\r\n    'Balanced', 'Bare', 'Based', 'Basic', 'Beautiful', 'Beloved',\r\n    'Beneficial', 'Bent', 'Best', 'Better', 'Big', 'Biological', 'Bitter',\r\n    'Bizarre', 'Blank', 'Blind', 'Blonde', 'Blue', 'Bold', 'Bored',\r\n    'Boring', 'Bottom', 'Bound', 'Brave', 'Brief', 'Bright', 'Brilliant',\r\n    'Broad', 'Broken', 'Brown', 'Busy', 'Calm', 'Capable',\r\n    'Capital', 'Capitalist', 'Careful', 'Careless', 'Casual', 'Cautious',\r\n    'Central', 'Certain', 'Challenging', 'Characteristic', 'Charming',\r\n    'Cheap', 'Cheerful', 'Chemical', 'Chief', 'Chronic', 'Civic', 'Civil',\r\n    'Civilian', 'Classic', 'Classical', 'Clean', 'Clear', 'Clever',\r\n    'Clinical', 'Close', 'Closed', 'Coastal', 'Cognitive', 'Cold',\r\n    'Collective', 'Colonial', 'Coloured', 'Colourful', 'Comfortable',\r\n    'Comic', 'Commercial', 'Common', 'Communist', 'Comparable',\r\n    'Comparative', 'Compelling', 'Competent', 'Competitive', 'Complete',\r\n    'Complex', 'Complicated', 'Comprehensive', 'Compulsory', 'Concerned',\r\n    'Concrete', 'Confident', 'Confused', 'Confusing', 'Congressional',\r\n    'Connected', 'Conscious', 'Consecutive', 'Conservative', 'Considerable',\r\n    'Consistent', 'Constant', 'Constitutional', 'Contemporary', 'Content',\r\n    'Continuous', 'Contrary', 'Controversial', 'Convenient', 'Conventional',\r\n    'Convinced', 'Convincing', 'Cool', 'Cooperative', 'Core', 'Corporate',\r\n    'Correct', 'Corresponding', 'Costly', 'Countless', 'Covered',\r\n    'Cream', 'Creative', 'Credible', 'Critical',\r\n    'Crowded', 'Crucial', 'Crude', 'Cruel', 'Cult', 'Cultural', 'Curious',\r\n    'Curly', 'Current', 'Curved', 'Cute', 'Cynical', 'Daily', 'Dairy',\r\n    'Damaging', 'Dangerous', 'Dark', 'Dead', 'Dear', 'Decent',\r\n    'Decisive', 'Dedicated', 'Deep', 'Defensive', 'Definite', 'Deliberate',\r\n    'Delicate', 'Delicious', 'Delighted', 'Democratic', 'Dense',\r\n    'Dependent', 'Depressed', 'Depressing', 'Desirable', 'Desperate',\r\n    'Destructive', 'Detailed', 'Determined', 'Different', 'Difficult',\r\n    'Digital', 'Diplomatic', 'Direct', 'Dirty', 'Disabled', 'Disappointed',\r\n    'Disappointing', 'Disastrous', 'Dishonest', 'Distant', 'Distinct',\r\n    'Distinctive', 'Disturbing', 'Diverse', 'Divine', 'Divorced',\r\n    'Domestic', 'Dominant', 'Double', 'Downstairs', 'Downtown', 'Dramatic',\r\n    'Dressed', 'Driving', 'Dry', 'Dual', 'Due', 'Dull', 'Dumb',\r\n    'Dynamic', 'Eager', 'Early', 'East', 'Eastern', 'Easy', 'Ecological',\r\n    'Economic', 'Editorial', 'Educated', 'Educational', 'Effective',\r\n    'Efficient', 'Elaborate', 'Elderly', 'Electoral', 'Electric',\r\n    'Electrical', 'Electronic', 'Elegant', 'Elementary', 'Eligible',\r\n    'Embarrassed', 'Embarrassing', 'Emotional', 'Empirical', 'Empty',\r\n    'Encouraging', 'Endless', 'Engaged', 'Engaging', 'Enjoyable',\r\n    'Enormous', 'Entertaining', 'Enthusiastic', 'Entire', 'Environmental',\r\n    'Equal', 'Equivalent', 'Essential', 'Eternal', 'Ethical', 'Ethnic',\r\n    'Even', 'Everyday', 'Evident', 'Evil', 'Evolutionary', 'Exact',\r\n    'Excellent', 'Exceptional', 'Excess', 'Excessive', 'Excited',\r\n    'Exciting', 'Exclusive', 'Executive', 'Exotic', 'Expected', 'Expensive',\r\n    'Experienced', 'Experimental', 'Expert', 'Explicit', 'Explosive',\r\n    'Extensive', 'External', 'Extra', 'Extraordinary', 'Extreme',\r\n    'Fabulous', 'Failed', 'Fair', 'Fake', 'False', 'Familiar', 'Family',\r\n    'Famous', 'Fancy', 'Fantastic', 'Far', 'Fascinating', 'Fashionable',\r\n    'Fast', 'Fat', 'Fatal', 'Favourable', 'Favourite', 'Federal', 'Fellow',\r\n    'Feminist', 'Few', 'Fierce', 'Final', 'Financial', 'Fine',\r\n    'Firm', 'Fit', 'Fixed', 'Flat', 'Flawed', 'Flexible', 'Flying',\r\n    'Folding', 'Folk', 'Following', 'Fond', 'Foreign', 'Formal', 'Former',\r\n    'Forthcoming', 'Fortunate', 'Forward', 'Fragile', 'Free', 'Frequent',\r\n    'Fresh', 'Friendly', 'Frightened', 'Frightening', 'Front', 'Frozen',\r\n    'Frustrated', 'Frustrating', 'Full', 'FullTime', 'Fun', 'Functional',\r\n    'Fundamental', 'Funny', 'Furious', 'Further', 'Future',\r\n    'General', 'Generic', 'Generous', 'Genetic', 'Gentle', 'Genuine',\r\n    'Giant', 'Glad', 'Global', 'Glorious', 'Gold', 'Golden', 'Good',\r\n    'Gorgeous', 'Grand', 'Graphic', 'Grateful', 'Grave', 'Great', 'Green',\r\n    'Grey', 'Gross', 'Guilty', 'Handy', 'Happy', 'Hard', 'Harmful', 'Harsh',\r\n    'Healthy', 'Heavy', 'Helpful', 'Hidden', 'High', 'HighProfile',\r\n    'Hilarious', 'Historic', 'Historical', 'Hollow', 'Holy', 'Home',\r\n    'Homeless', 'Honest', 'Hopeful', 'Horrible', 'Hot', 'Huge',\r\n    'Human', 'Humanitarian', 'Humble', 'Humorous', 'Hungry', 'Hurt',\r\n    'Ideal', 'Identical', 'Ideological', 'Ill', 'Illegal', 'Imaginary',\r\n    'Immediate', 'Immense', 'Imminent', 'Immune', 'Impatient', 'Important',\r\n    'Impossible', 'Impressed', 'Impressive', 'Inadequate', 'Inappropriate',\r\n    'Inclined', 'Included', 'Incorrect', 'Incredible', 'Independent',\r\n    'Indigenous', 'Indirect', 'Individual', 'Indoor', 'Industrial',\r\n    'Inevitable', 'Infamous', 'Influential', 'Informal', 'Inherent',\r\n    'Initial', 'Injured', 'Inner', 'Innocent', 'Innovative', 'Inside',\r\n    'Instant', 'Institutional', 'Instrumental', 'Insufficient', 'Intact',\r\n    'Integral', 'Integrated', 'Intellectual', 'Intelligent', 'Intended',\r\n    'Intense', 'Intensive', 'Interactive', 'Interested', 'Interesting',\r\n    'Interim', 'Interior', 'Intermediate', 'Internal', 'International',\r\n    'Intimate', 'Intriguing', 'Invisible', 'Involved', 'Ironic',\r\n    'Irrelevant', 'Isolated', 'Joint', 'Judicial', 'Junior', 'Just', 'Keen',\r\n    'Key', 'Kind', 'Large', 'LargeScale', 'Late', 'Later', 'Latest',\r\n    'Latter', 'Lazy', 'Leading', 'Left', 'Legal', 'Legendary',\r\n    'Legislative', 'Legitimate', 'Lengthy', 'Lesser',\r\n    'Level', 'Liable', 'Liberal', 'Lifelong', 'Light', 'Likely', 'Limited',\r\n    'Linear', 'Liquid', 'Literary', 'Little', 'Live', 'Lively', 'Living',\r\n    'Local', 'Located', 'Logical', 'Lonely', 'Long', 'LongStanding',\r\n    'LongTerm', 'LongTime', 'Loose', 'Lost', 'Loud', 'Lovely', 'Low',\r\n    'Loyal', 'Lucky', 'Luxury', 'Mad', 'Magic', 'Magical', 'Magnetic',\r\n    'Magnificent', 'Main', 'Mainstream', 'Major', 'Mandatory',\r\n    'Marginal', 'Marine', 'Married', 'Martial', 'Mass', 'Massive',\r\n    'Matching', 'Material', 'Mathematical', 'Mature', 'Maximum',\r\n    'Meaningful', 'Mechanical', 'Medical', 'Medieval', 'Medium',\r\n    'Memorable', 'Mental', 'Mere', 'Middle', 'Mild',\r\n    'Minimal', 'Minimum', 'Minute', 'Miserable', 'Misleading',\r\n    'Missing', 'Mixed', 'Mobile', 'Moderate', 'Modern', 'Modest', 'Monthly',\r\n    'Moral', 'Motor', 'Moving', 'Multiple', 'Municipal', 'Musical',\r\n    'Mutual', 'Mysterious', 'Narrative', 'Narrow',\r\n    'National', 'Nationwide', 'Native', 'Natural', 'Naval', 'Near',\r\n    'Nearby', 'Neat', 'Necessary', 'Negative', 'Neighbouring', 'Nervous',\r\n    'Net', 'Neutral', 'New', 'Next', 'Nice', 'Noble', 'Noisy', 'NonProfit',\r\n    'Normal', 'North', 'Northern', 'Notable', 'Notorious', 'Novel',\r\n    'Nuclear', 'Numerous', 'Objective', 'Obvious', 'Occasional', 'Odd',\r\n    'Offensive', 'Official', 'Ok', 'Old', 'OldFashioned', 'Ongoing',\r\n    'Online', 'Only', 'Open', 'Operational', 'Opposed', 'Opposite',\r\n    'Optical', 'Optimistic', 'Orange', 'Ordinary', 'Organic',\r\n    'Organizational', 'Organized', 'Original', 'Other', 'Outdoor', 'Outer',\r\n    'Outside', 'Outstanding', 'Overall', 'Overseas', 'Overwhelming', 'Own',\r\n    'Painful', 'Pale', 'Parallel', 'Parental', 'Parliamentary', 'PartTime',\r\n    'Partial', 'Particular', 'Passionate', 'Passive', 'Past', 'Patient',\r\n    'Peaceful', 'Peculiar', 'Perfect', 'Permanent', 'Persistent',\r\n    'Personal', 'Philosophical', 'Physical', 'Pink', 'Plain', 'Plastic',\r\n    'Pleasant', 'Pleased', 'Plus', 'Pointed', 'Poisonous', 'Polite',\r\n    'Political', 'Poor', 'Pop', 'Popular', 'Positive', 'Possible',\r\n    'PostWar', 'Potential', 'Powerful', 'Practical', 'Precious', 'Precise',\r\n    'Predictable', 'Preliminary', 'Premier', 'Prepared',\r\n    'Present', 'Presidential', 'Prestigious', 'Pretty', 'Previous',\r\n    'Primary', 'Prime', 'Principal', 'Prior', 'Private', 'Probable',\r\n    'Problematic', 'Productive', 'Professional', 'Profitable', 'Profound',\r\n    'Progressive', 'Prominent', 'Promising', 'Pronounced', 'Proper',\r\n    'Prospective', 'Protective', 'Proud', 'Provincial', 'Psychiatric',\r\n    'Psychological', 'Public', 'Pure', 'Purple', 'Qualified', 'Quick',\r\n    'Quiet', 'Radical', 'Random', 'Rapid', 'Rare',\r\n    'Rational', 'Raw', 'Ready', 'Real', 'Realistic', 'Rear', 'Reasonable',\r\n    'Recent', 'Red', 'Regional', 'Regular', 'Regulatory', 'Related',\r\n    'Relative', 'Relaxed', 'Relaxing', 'Relevant', 'Reliable', 'Relieved',\r\n    'Religious', 'Reluctant', 'Remarkable', 'Remote', 'Renowned',\r\n    'Repeated', 'Representative', 'Resident', 'Residential', 'Respective',\r\n    'Responsible', 'Retired', 'Reverse', 'Revolutionary', 'Rich',\r\n    'Ridiculous', 'Right', 'Risky', 'Rival', 'Robust', 'Romantic', 'Rough',\r\n    'Round', 'Routine', 'Royal', 'Rubber', 'Rude', 'Rural', 'Sacred', 'Sad',\r\n    'Safe', 'Same', 'Satisfied', 'Scary', 'Scattered',\r\n    'Sceptical', 'Scientific', 'Secondary', 'Secret', 'Secular', 'Secure',\r\n    'Selective', 'Senior', 'Sensible', 'Sensitive', 'Separate', 'Serial',\r\n    'Serious', 'Severe', 'Shallow', 'Shaped', 'Sharp',\r\n    'Sheer', 'Shiny', 'Shocked', 'Shocking', 'Short', 'ShortTerm', 'Shut',\r\n    'Shy', 'Significant', 'Silent', 'Silly', 'Silver', 'Similar',\r\n    'Simple', 'Sincere', 'Single', 'Situated', 'Ski', 'Skilled', 'Slight',\r\n    'Slow', 'Small', 'Smart', 'Smooth', 'SoCalled', 'Social', 'Socialist',\r\n    'Soft', 'Solar', 'Sole', 'Solid', 'Solo', 'Sophisticated',\r\n    'Sound', 'South', 'Spare', 'Special', 'Specialist',\r\n    'Specialized', 'Specific', 'Spectacular', 'Spicy', 'Spiritual',\r\n    'Spoken', 'Sporting', 'Square', 'Stable', 'Standard', 'Standing',\r\n    'Stark', 'State', 'Statistical', 'Steady', 'Steep', 'Sticky', 'Stiff',\r\n    'Still', 'Straight', 'Straightforward', 'Strange', 'Strategic',\r\n    'Strict', 'Striking', 'Strong', 'Structural', 'Stunning',\r\n    'Subject', 'Subsequent', 'Substantial', 'Subtle', 'Suburban',\r\n    'Successful', 'Successive', 'Sudden', 'Sufficient', 'Suitable', 'Super',\r\n    'Superb', 'Superior', 'Supportive', 'Supreme', 'Sure', 'Surgical',\r\n    'Surprised', 'Surprising', 'Surrounding', 'Suspicious', 'Sustainable',\r\n    'Sweet', 'Symbolic', 'Sympathetic', 'Systematic', 'Tactical',\r\n    'Talented', 'Tall', 'Technical', 'Technological',\r\n    'Temporary', 'Tender', 'Terminal', 'Terrible', 'Terrific', 'Theatrical',\r\n    'Theoretical', 'Thick', 'Thin', 'Thirsty', 'Thorough',\r\n    'ThoughtProvoking', 'Thoughtful', 'Thrilled', 'Tidy', 'Tight',\r\n    'Timely', 'Tiny', 'Tired', 'Top', 'Total', 'Tough', 'Toxic', 'Toy',\r\n    'Traditional', 'Transparent', 'Tremendous', 'Tribal',\r\n    'Tropical', 'True', 'Twin', 'Typical', 'Ultimate',\r\n    'Unable', 'Unacceptable', 'Uncomfortable', 'Underground',\r\n    'Underlying', 'Unemployed', 'Unexpected', 'Unfair', 'Unfortunate',\r\n    'Unique', 'United', 'Universal', 'Unknown', 'Unlikely',\r\n    'Unnecessary', 'Unpleasant', 'Unprecedented', 'Unusual', 'Upcoming',\r\n    'Upper', 'Upset', 'Upstairs', 'Urban', 'Urgent', 'Used', 'Useful',\r\n    'Useless', 'Usual', 'Vague', 'Valid', 'Valuable', 'Variable', 'Varied',\r\n    'Various', 'Vast', 'Verbal', 'Vertical', 'Very', 'Viable', 'Vibrant',\r\n    'Virtual', 'Visible', 'Visual', 'Vital', 'Vocal',\r\n    'Voluntary', 'Vulnerable', 'Warm', 'Waste', 'Weak', 'Wealthy', 'Weekly',\r\n    'Weird', 'Welcome', 'Well', 'West', 'Western', 'Wet', 'White', 'Whole',\r\n    'Wide', 'Widespread', 'Wild', 'Willing', 'Wise', 'Wonderful', 'Wooden',\r\n    'Working', 'Worldwide', 'Worried', 'Worse', 'Worst', 'Worth',\r\n    'Worthwhile', 'Worthy', 'Written', 'Wrong', 'Yellow'\r\n];\r\n\r\n/*\r\nconst _PRONOUN_ = [\r\n];\r\n*/\r\n\r\n/*\r\nconst _CONJUNCTION_ = [\r\n    'And', 'Or', 'For', 'Above', 'Before', 'Against', 'Between'\r\n];\r\n*/\r\n\r\n/**\r\n * Maps a string (category name) to the array of words from that category.\r\n * @const\r\n */\r\nconst CATEGORIES = [\r\n    _ADJECTIVE_,\r\n    _ADVERB_,\r\n    _PLURALNOUN_\r\n   // _VERB_\r\n\r\n//    _CONJUNCTION_,\r\n//    _NOUN_,\r\n//    _PLACE_,\r\n//    _PRONOUN_,\r\n];\r\n\r\n/**\r\n * The list of room name patterns.\r\n * @const\r\n */\r\n/* const PATTERNS = [\r\n    //'_ADJECTIVE__PLURALNOUN__VERB__ADVERB_'\r\n    '_ADJECTIVE__PLURALNOUN__ADVERB_'\r\n]; */\r\n\r\n/**\r\n * Generates a new room name.\r\n *\r\n * @returns {string} A newly-generated room name.\r\n */\r\n\r\nexport function generateRoomWithoutSeparator() {\r\n    // XXX Note that if more than one pattern is available, the choice of 'name'\r\n    // won't have a uniform distribution amongst all patterns (names from\r\n    // patterns with fewer options will have higher probability of being chosen\r\n    // that names from patterns with more options).\r\n\r\n    //let name = randomElement(PATTERNS);\r\n    //console.log(name, \" name\")\r\n\r\n    let roomName = '';\r\n\r\n    /* console.log(_hasTemplate(name))\r\n    for (const template in CATEGORIES) {\r\n        console.log(CATEGORIES[template], \" temp\")\r\n    } */\r\n\r\n    //while (_hasTemplate(name)) {\r\n        for (const template in CATEGORIES) { // eslint-disable-line guard-for-in\r\n            const word = randomElement(CATEGORIES[template]);\r\n\r\n            //console.log(template, \" temp\")\r\n\r\n            //name = name.replace(template, word);\r\n\r\n            //console.log(name, \" aName\")\r\n            roomName += word\r\n        }\r\n    //}\r\n    return roomName;\r\n}\r\n\r\n//generateRoomWithoutSeparator()\r\n\r\n/**\r\n * Generates random int within the range [min, max]\r\n * @param min the minimum value for the generated number\r\n * @param max the maximum value for the generated number\r\n * @returns random int number\r\n */\r\nfunction randomInt(min:number, max:number) {\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n}\r\n\r\n\r\n\r\n/**\r\n * Get random element from array or string.\r\n * @param {Array|string} arr source\r\n * @returns array element or string character\r\n */\r\nfunction randomElement(arr:string[]) {\r\n    return arr[randomInt(0, arr.length - 1)];\r\n}\r\n\r\n/**\r\n * Determines whether a specific string contains at least one of the\r\n * templates/categories.\r\n *\r\n * @param {string} s - String containing categories.\r\n * @private\r\n * @returns {boolean} True if the specified string contains at least one of the\r\n * templates/categories; otherwise, false.\r\n */\r\n/* function _hasTemplate(s:string) {\r\n    for (const template in CATEGORIES) {\r\n        if (s.indexOf(template) >= 0) {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n} */\r\n","/* import {BMProps} from '@components/utils'\r\nimport Box from '@material-ui/core/Box'\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport {t} from '@models/locales'\r\nimport errorInfo, {ErrorType} from '@stores/ErrorInfo'\r\nimport {Observer} from 'mobx-react-lite'\r\nimport React from 'react'\r\nimport {AfkDialog} from './AfkDialog'\r\nimport {TheEntrance} from './TheEntrance'\r\n\r\nexport const dialogs = new Map<ErrorType, (props:BMProps)=>JSX.Element>()\r\ndialogs.set('entrance', (props: BMProps) => <TheEntrance {...props}/>)\r\ndialogs.set('afk', (props: BMProps) => <AfkDialog />)\r\n\r\nexport const ErrorDialogFrame: React.FC<{onClose:(event:{}, reason:string)=>void}> = (props) => {\r\n  return <Dialog {...props} open={errorInfo.show()}\r\n    onClose={props.onClose} maxWidth=\"md\" fullWidth={false} >\r\n  {errorInfo.title ?\r\n    <DialogTitle id=\"simple-dialog-title\">{errorInfo.title}</DialogTitle>\r\n    : undefined }\r\n  {props.children}\r\n</Dialog>\r\n}\r\n\r\n\r\nexport const ErrorDialog: React.FC<BMProps> = (props) => {\r\n  function close(){\r\n    if (errorInfo.type !== 'retry'){\r\n      errorInfo.clear()\r\n    }\r\n  }\r\n\r\n  return <Observer>{\r\n    () => {\r\n      if (errorInfo.type){\r\n        if (dialogs.has(errorInfo.type)) {\r\n          return dialogs.get(errorInfo.type)!(props)\r\n        }else{\r\n          return <ErrorDialogFrame onClose={() => { close() }}>\r\n            <DialogContent>{errorInfo.message}</DialogContent>\r\n            {errorInfo.type !== 'retry' ?\r\n              <Box mt={2} mb={2} ml={4}>\r\n              <Button variant=\"contained\" color=\"primary\" style={{textTransform:'none'}}\r\n                onClick={() => { close() }} >\r\n                {t('emClose')}\r\n              </Button>&nbsp;\r\n              <Button variant=\"contained\" color=\"secondary\" style={{textTransform:'none'}}\r\n                onClick={() => {\r\n                  errorInfo.supressedTypes.add(errorInfo.type)\r\n                  close()\r\n                }}>\r\n                {t('emNeverShow')}\r\n              </Button>\r\n              </Box>\r\n            : undefined}\r\n          </ErrorDialogFrame>\r\n        }\r\n      }\r\n\r\n      return <></>\r\n    }\r\n  }</Observer>\r\n}\r\nErrorDialog.displayName = 'ErrorDialog'\r\n */\r\n\r\nimport {BMProps} from '@components/utils'\r\nimport Box from '@material-ui/core/Box'\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport {t} from '@models/locales'\r\nimport errorInfo, {ErrorType} from '@stores/ErrorInfo'\r\nimport {Observer} from 'mobx-react-lite'\r\nimport React from 'react'\r\nimport {AfkDialog} from './AfkDialog'\r\nimport {TheEntrance} from './TheEntrance'\r\nimport {generateRoomWithoutSeparator} from '@components/utils/roomNameGenerator'\r\nimport {isSmartphone} from '@models/utils'\r\n\r\n// Setting default room animated names\r\nconst defaultRoom = {\r\n  room: generateRoomWithoutSeparator()\r\n}\r\n\r\n\r\n\r\nexport const dialogs = new Map<ErrorType, (props:BMProps)=>JSX.Element>()\r\ndialogs.set('entrance', (props: BMProps) => <TheEntrance {...props} {...defaultRoom} />)\r\ndialogs.set('afk', (props: BMProps) => <AfkDialog />)\r\n\r\nexport const ErrorDialogFrame: React.FC<{onClose:(event:{}, reason:string)=>void}> = (props) => {\r\n  return <Dialog {...props} open={errorInfo.show()}\r\n    onClose={props.onClose} maxWidth=\"xl\" fullWidth={false} fullScreen={true} >\r\n  {errorInfo.title ?\r\n    <DialogTitle id=\"simple-dialog-title\" disableTypography={true} style={{fontSize:isSmartphone() ? '4em' : '1em'}}>{errorInfo.title}</DialogTitle>\r\n    : undefined }\r\n  {props.children}\r\n</Dialog>\r\n}\r\n\r\nexport const ErrorDialog: React.FC<BMProps> = (props) => {\r\n  function close(){\r\n    if (errorInfo.type !== 'retry'){\r\n      errorInfo.clear()\r\n    }\r\n  }\r\n\r\n  return <Observer>{\r\n    () => {\r\n      if (errorInfo.type){\r\n        if (dialogs.has(errorInfo.type)) {\r\n          return dialogs.get(errorInfo.type)!(props)\r\n        }else{\r\n          return <ErrorDialogFrame onClose={() => { close() }}>\r\n            <DialogContent style={{fontSize:isSmartphone() ? '3em' : '1em'}}>{errorInfo.message}</DialogContent>\r\n            {errorInfo.type !== 'retry' ?\r\n              <Box mt={2} mb={2} ml={4}>\r\n              <Button variant=\"contained\" color=\"primary\" style={{textTransform:'none', fontSize:isSmartphone() ? '2.5em' : '1em'}}\r\n                onClick={() => { close() }} >\r\n                {t('emClose')}\r\n              </Button>&nbsp;\r\n              <Button variant=\"contained\" color=\"secondary\" style={{textTransform:'none', fontSize:isSmartphone() ? '2.5em' : '1em'}}\r\n                onClick={() => {\r\n                  errorInfo.supressedTypes.add(errorInfo.type)\r\n                  close()\r\n                }}>\r\n                {t('emNeverShow')}\r\n              </Button>\r\n              </Box>\r\n            : undefined}\r\n          </ErrorDialogFrame>\r\n        }\r\n      }\r\n\r\n      return <></>\r\n    }\r\n  }</Observer>\r\n}\r\nErrorDialog.displayName = 'ErrorDialog'\r\n","/* import { BMProps } from \"@components/utils\";\r\nimport usageEn from \"@images/usage.en.png\";\r\nimport usageJa from \"@images/usage.ja.png\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport TranslateIcon from \"@material-ui/icons/Translate\";\r\nimport { i18nSupportedLngs, useTranslation } from \"@models/locales\";\r\nimport { urlParameters } from \"@models/url\";\r\nimport { isSmartphone } from \"@models/utils\";\r\nimport errorInfo from \"@stores/ErrorInfo\";\r\nimport React, { useState } from \"react\";\r\nimport { ErrorDialogFrame } from \"./ErrorDialog\";\r\n\r\nexport const TheEntrance: React.FC<BMProps> = (props) => {\r\n  const { participants } = props.stores;\r\n  const [name, setName] = useState(participants.local.information.name);\r\n  const savedRoom = sessionStorage.getItem(\"room\");\r\n  const [room, setRoom] = useState(\r\n    urlParameters.room ? urlParameters.room : savedRoom ? savedRoom : \"\"\r\n  );\r\n\r\n  const onClose = (save: boolean) => {\r\n    if (name.length !== 0 || participants.local.information.name.length !== 0){\r\n      if (save || participants.local.information.name.length === 0) {\r\n        if (name.length && participants.local.information.name !== name) {\r\n          participants.local.information.name = name\r\n          participants.local.sendInformation()\r\n          participants.local.saveInformationToStorage(true)\r\n        }\r\n      }\r\n      if (save){\r\n        urlParameters.room = room;\r\n        sessionStorage.setItem(\"room\", room)\r\n      }\r\n      errorInfo.clear()\r\n    }\r\n  };\r\n  const onKeyPress = (ev: React.KeyboardEvent) => {\r\n    if (ev.key === \"Enter\") {\r\n      onClose(true);\r\n    } else if (ev.key === \"Esc\" || ev.key === \"Escape\") {\r\n      onClose(false);\r\n    }\r\n  };\r\n\r\n  const { t, i18n } = useTranslation();\r\n\r\n  const tfIStyle = {\r\n    fontSize: isSmartphone() ? \"2em\" : \"1em\",\r\n    height: isSmartphone() ? \"2em\" : \"1.5em\",\r\n  };\r\n  const tfLStyle = { fontSize: isSmartphone() ? \"1em\" : \"1em\" };\r\n  const tfDivStyle = { height: isSmartphone() ? \"4em\" : \"3em\" };\r\n\r\n  return (\r\n    <ErrorDialogFrame\r\n      onClose={() => { onClose(false) }}\r\n    >\r\n      <DialogContent style={{ fontSize: isSmartphone() ? \"2em\" : \"1em\" }}>\r\n        <Button\r\n          style={{ position: \"absolute\", top: 30, right: 20 }}\r\n          onClick={() => {\r\n            const idx =\r\n              (i18nSupportedLngs.findIndex((l:any) => l === i18n.language) + 1) %\r\n              i18nSupportedLngs.length;\r\n            i18n.changeLanguage(i18nSupportedLngs[idx]);\r\n          }}\r\n        >\r\n          <TranslateIcon />\r\n        </Button>\r\n        <h2>Earshot Chat</h2>\r\n        <p>\r\n          <img\r\n            style={{ float: \"right\", width: \"28em\" }}\r\n            src={i18n.language === \"ja\" ? usageJa : usageEn}\r\n            alt=\"usage\"\r\n          />\r\n          {t(\"enAbout\")}&nbsp;\r\n          <a href={t(\"enTopPageUrl\")}>{t(\"enMoreInfo\")}</a>\r\n        </p>\r\n        <br />\r\n        <TextField\r\n          label={t(\"YourName\")}\r\n          multiline={false}\r\n          value={name}\r\n          style={tfDivStyle}\r\n          inputProps={{ style: tfIStyle, autoFocus: true }}\r\n          InputLabelProps={{ style: tfLStyle }}\r\n          onChange={(event) => setName(event.target.value)}\r\n          onKeyPress={onKeyPress}\r\n          fullWidth={true}\r\n        />\r\n        <Box mt={4}>\r\n          <TextField\r\n            label={t(\"Venue\")}\r\n            multiline={false}\r\n            value={room}\r\n            style={tfDivStyle}\r\n            inputProps={{ style: tfIStyle, autoFocus: false }}\r\n            InputLabelProps={{ style: tfLStyle }}\r\n            onChange={(event) => setRoom(event.target.value)}\r\n            onKeyPress={onKeyPress}\r\n            fullWidth={true}\r\n          />\r\n        </Box>\r\n        <Box mt={4}>\r\n          <Button\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            disabled={name.length===0}\r\n            onClick={() => onClose(true)}\r\n            style={{ fontSize: isSmartphone() ? \"1.25em\" : \"1em\" }}\r\n          >\r\n            {t(\"EnterTheVenue\")}\r\n          </Button>\r\n        </Box>\r\n      </DialogContent>\r\n    </ErrorDialogFrame>\r\n  );\r\n};\r\nTheEntrance.displayName = \"TheEntrance\";\r\n */\r\nimport {BMProps} from '@components/utils'\r\nimport bgCircle from '@images/whoo-screen_chat.png'\r\nimport peopleLogin from '@images/people_login.png'\r\nimport btnGo from '@images/go.png'\r\nimport logo_es from '@images/logo.png'\r\n\r\nimport Box from '@material-ui/core/Box'\r\nimport Button from '@material-ui/core/Button'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport Input from '@material-ui/core/Input'\r\nimport InputLabel from '@material-ui/core/InputLabel'\r\nimport TranslateIcon from '@material-ui/icons/Translate'\r\nimport {i18nSupportedLngs, useTranslation} from '@models/locales'\r\nimport {urlParameters} from '@models/url'\r\nimport {isSmartphone} from '@models/utils'\r\nimport errorInfo from '@stores/ErrorInfo'\r\nimport React, {useState, useEffect} from 'react'\r\nimport {ErrorDialogFrame} from './ErrorDialog'\r\nimport {generateRoomWithoutSeparator} from '@components/utils/roomNameGenerator'\r\n\r\nlet nameStr:string = ''\r\nlet loginClick:boolean = false\r\nlet _roomName:string = ''\r\nlet userType:string = ''\r\n\r\nexport function userName(): string {\r\n  return nameStr\r\n}\r\nexport function getLoginClick(): boolean {\r\n  return loginClick\r\n}\r\nexport function getRoomName(): string {\r\n  return _roomName\r\n}\r\n\r\nexport function getUserType(): string {\r\n  return userType\r\n}\r\n\r\n\r\nexport const TheEntrance: React.FC<BMProps> = (props) => {\r\n  const {participants} = props.stores\r\n  const [name, setName] = useState(participants.local.information.name)\r\n  const savedRoom = sessionStorage.getItem('room')\r\n  const [active, setActive] = useState(false)\r\n\r\n  const mapData = props.stores.map\r\n  let roomURL = String(urlParameters.room).split(\"_\");\r\n  let num = (Number(roomURL?.length) - 1)\r\n  let concatURL = ''\r\n\r\n  if(Number(roomURL?.length) > 1) {\r\n    concatURL = String(urlParameters.room).split(\"_\")[0]\r\n  }\r\n\r\n  const [room, setRoom] = useState(urlParameters.room ? roomURL[num] : '')\r\n\r\n  const [nameArr, setNameArr] = useState([String(Object(props).room)])\r\n  const passedPlaceholder = nameArr[0]\r\n  const [placeholder, setPlaceholder] = useState(passedPlaceholder.slice(0, 0));\r\n  const [placeholderIndex, setPlaceholderIndex] = useState(0);\r\n\r\n  /**\r\n   *\r\n   * @param _name\r\n   */\r\n  function setUserNameFromWeb(_name:string) {\r\n    setName(_name)\r\n    let roomNameIndex = window.location.href.indexOf('&room=')\r\n    if(roomNameIndex !== -1) {\r\n      onErrorClose()\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    // New Changes for Website\r\n    // User\r\n    let userNameIndex = window.location.href.indexOf('?u=')\r\n    if(userNameIndex !== -1) {\r\n      let uName = window.location.href.split('?')[1].split(\"&\")[0].split('=')[1]\r\n      setUserNameFromWeb(uName)\r\n    }\r\n    const onKeyDown = (e: KeyboardEvent) => {\r\n      if(e.ctrlKey) {return}\r\n      if(e.key === \"Enter\") {\r\n        window.removeEventListener('keydown', onKeyDown)\r\n        onErrorClose()\r\n      }\r\n    }\r\n    window.addEventListener('keydown', onKeyDown)\r\n    if(room !== \"\") {\r\n      return\r\n    }\r\n    const intr = setTimeout(() => {\r\n        clearTimeout(intr)\r\n        setPlaceholder(passedPlaceholder.slice(0, placeholderIndex));\r\n        if (placeholderIndex + 1 > passedPlaceholder.length) {\r\n          clearTimeout(intr)\r\n            const inner = setTimeout(() => {\r\n              clearTimeout(inner)\r\n              setPlaceholderIndex(0)\r\n             setNameArr([generateRoomWithoutSeparator()])\r\n            },4000)\r\n        } else {\r\n            setPlaceholderIndex(placeholderIndex + 1)\r\n        }\r\n    }, 30);\r\n    return () => {\r\n      window.removeEventListener('keydown', onKeyDown)\r\n      clearTimeout(intr)\r\n    }\r\n  },);\r\n\r\n  /**\r\n   *\r\n   * @param save\r\n   */\r\n  const onClose = (save: boolean) => {\r\n    // get the value\r\n    if (save) {\r\n        if (participants.local.information.name !== name || participants.local.information.name === \"Anonymous\") {\r\n          userType = \"N\"\r\n          nameStr = name\r\n          participants.local.information.name = name\r\n          participants.local.information.randomAvatar = []\r\n          participants.local.sendInformation()\r\n          participants.local.saveInformationToStorage(true)\r\n        } else {\r\n          userType = \"O\"\r\n        }\r\n        if( room === \"\") {\r\n          urlParameters.room = nameArr[0]\r\n          if(savedRoom !== room) {\r\n            sessionStorage.setItem('room', nameArr[0])\r\n          }\r\n          setRoom(nameArr[0])\r\n        } else {\r\n          urlParameters.room = room\r\n          if(savedRoom !== room) {\r\n            sessionStorage.setItem('room', room)\r\n          }\r\n          setRoom(room)\r\n        }\r\n      }\r\n\r\n    //console.log(room, \" --- \", nameArr[0])\r\n\r\n    if(room !== \"\") {\r\n      if(concatURL === '') {\r\n        window.history.replaceState({}, \"null\", (\"/?room=\" + room))\r\n      } else {\r\n        window.history.replaceState({}, \"null\", (\"/\" + concatURL + \"/?room=\" + room))\r\n      }\r\n    } else {\r\n      if(concatURL === '') {\r\n        window.history.replaceState({}, \"null\", (\"/?room=\" + nameArr[0]))\r\n      } else {\r\n        window.history.replaceState({}, \"null\", (\"/\" + concatURL + \"/?room=\" + nameArr[0]))\r\n      }\r\n    }\r\n\r\n    // setTimer to clear\r\n    //errorInfo.clear()\r\n    const endScreen = setTimeout(() => {\r\n      clearTimeout(endScreen)\r\n      _roomName = room\r\n      loginClick = true\r\n      errorInfo.clear()\r\n    },10)\r\n  }\r\n\r\n  const onErrorClose = () => {\r\n    setActive(true)\r\n    const cTimer = setTimeout(function() {\r\n    //window.setTimeout(function() {\r\n      clearTimeout(cTimer)\r\n\r\n      // Here\r\n      let scaleVal = isSmartphone() ? [2,2,2] : [1,1,1]\r\n      const changeMatrix = (new DOMMatrix()).scaleSelf(scaleVal[0], scaleVal[1], scaleVal[2])\r\n      mapData.setMatrix(changeMatrix)\r\n      mapData.setCommittedMatrix(changeMatrix)\r\n      const _timerUserPlace = setTimeout(() =>{\r\n        clearTimeout(_timerUserPlace)\r\n        placeUserAtBlank()\r\n      }, 3000)\r\n      onClose(true)\r\n    },100)\r\n  }\r\n  function placeUserAtBlank() {\r\n    let found:boolean = false\r\n    let randX:number = 0\r\n    let randY:number = 0\r\n    const remotes = Array.from(participants.remote.keys()).filter(key => key !== participants.localId)\r\n    if(remotes.length > 0) {\r\n      for (const [i] of remotes.entries()) {\r\n        let remoteX = Number(participants.remote.get(remotes[i])?.pose.position[0])\r\n        let remoteY = Number(participants.remote.get(remotes[i])?.pose.position[1])\r\n        randX = Number(Math.random() * mapData.screenSize[0]) + 60\r\n        randY = Number(Math.random() * mapData.screenSize[1]) + 60\r\n        if(randX >= (remoteX-60) && randX <= (remoteX+60) && randY >= (remoteY-60) && randY <= (remoteY+60)) {\r\n          placeUserAtBlank()\r\n          return\r\n        } else {\r\n          if(remoteX >= -60 && remoteX <=60 && remoteY >= -60 && remoteY <= 60) {\r\n            found = true\r\n          } else {\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      mapData.setMouse([mapData.screenSize[0]/2, mapData.screenSize[1]/2])\r\n      participants.local.pose.position = Object.assign({}, mapData.mouseOnMap)\r\n    }\r\n\r\n    if(found) {\r\n      mapData.setMouse([randX, randY])\r\n      participants.local.pose.position = Object.assign({}, mapData.mouseOnMap)\r\n\r\n      // Place user at the center Location of their own canvas\r\n      mapData.focusOn(participants.local)\r\n\r\n\r\n    } else {\r\n      mapData.setMouse([mapData.screenSize[0]/2, mapData.screenSize[1]/2])\r\n      participants.local.pose.position = Object.assign({}, mapData.mouseOnMap)\r\n    }\r\n\r\n  }\r\n\r\n  const {t, i18n} = useTranslation()\r\n  const tfIStyle = {fontSize: isSmartphone() ? '2.5em' : '1em',\r\n    height: isSmartphone() ? '2em' : '1.5em', color: 'black', backgroundColor: 'white', padding: '3px', width: isSmartphone() ? '14.5em' : '15em'}\r\n  const tfLStyle = {fontSize: isSmartphone() ? '1.2em' : '1em',color: 'white', padding:'0.5em 0 0.2em 0', marginLeft:'-7em'}\r\n  const tfLNStyle = {fontSize: isSmartphone() ? '1.2em' : '1em',color: 'white', padding:'0.2em 0 0.2em 0', marginLeft:'-10.5em'}\r\n\r\n  return <ErrorDialogFrame onClose={()=>{errorInfo.clear()}}>\r\n    <DialogContent onClick={() => active ? errorInfo.clear() : ''} style={active ? {overflowY: 'hidden', overflowX:'hidden', backgroundColor: '#5f7ca0', fontSize: isSmartphone() ? '2em' : '1em', transition: '0.3s ease-out'} : {overflowY: 'hidden', overflowX:'hidden', backgroundColor: '#5f7ca0', fontSize: isSmartphone() ? '2em' : '1em', transition: '0s ease-out'}}>\r\n      <p style={{textAlign:'right', color: 'white', fontSize: isSmartphone() ? '1.2em' : '1em'}}>Version 2.0.6</p>\r\n      <Button style={{position:'absolute', top:30, right:20, display:'none'}} onClick = {() => {\r\n        const idx = (i18nSupportedLngs.findIndex(l => l === i18n.language) + 1) % i18nSupportedLngs.length\r\n        i18n.changeLanguage(i18nSupportedLngs[idx])\r\n      }}>\r\n        <TranslateIcon />\r\n      </Button>\r\n      <p>\r\n      </p>\r\n      <div style={active ? {position: 'relative', width:'100em', display:'none'} : {position: 'relative', width:'100em', display:'block'}}/>\r\n      <div style={active ? {position: 'relative', top: '3em' /* '2em' */, width: '100%', textAlign:'center', opacity:'0', transform: \"scale(0.10)\", transition: '0.3s ease-out', left: isSmartphone() ? \"-0.5em\" : '0em'} : {position: 'relative', top: '4em', width: '100%', textAlign:'center', left: isSmartphone() ? \"-0.5em\" : '0em'}}>\r\n        <img style={{width:'30em', userSelect:'none'}} draggable={false} src={bgCircle}\r\n        alt=\"\" />\r\n      </div>\r\n\r\n      <div style={active ? {position: 'relative', top: '-25em', width: '100%', textAlign:'center', display:'none'} : {position: 'relative', top: '-25em', width: '100%', textAlign:'center'}}>\r\n        <img style={{width:'10em', userSelect:'none'}} src={peopleLogin} draggable={false} alt=\"\" />\r\n      </div>\r\n      <br />\r\n      <Box mt={1}>\r\n      <div style={active ? {position: 'relative', top: '-26em', width: '100%', textAlign:'center', display:'none'} : {position: 'relative', top: '-26em', width: '100%', textAlign:'center'}}>\r\n        <InputLabel style={tfLNStyle}> {t('YourName')} </InputLabel>\r\n        <Input value={name} autoFocus={true} disableUnderline={true} inputProps={{style: tfIStyle}} onChange={event => (setName(event.target.value))} />\r\n      </div>\r\n      </Box>\r\n      <Box mt={2}>\r\n      <div style={active ? {position: 'relative', top: '-26em', width: '100%', textAlign:'center', display:'none'} : {position: 'relative', top: '-26em', width: '100%', textAlign:'center'}}>\r\n        <InputLabel style={tfLStyle}> {t('Venue')} </InputLabel>\r\n        <Input value={room} autoFocus={false} disableUnderline={true} placeholder={placeholder} inputProps={{style: tfIStyle}} onChange={event => (setRoom(event.target.value))} /* onKeyPress={onKeyPress} */ />\r\n      </div>\r\n      </Box>\r\n      <Box mt={2}>\r\n      <div style={active ? {position: 'relative', top: isSmartphone() ? '-25.5em' : '-25em', width: '100%', textAlign:'center', display:'none'} : {position: 'relative', top:isSmartphone() ? '-25.5em' : '-25em', width: '100%', textAlign:'center'}}>\r\n        <img style={{width:'4em', userSelect:'none'}} src={btnGo} draggable={false} onClick={() => onErrorClose()} alt=\"\" />\r\n      </div>\r\n      </Box>\r\n      <Box mt={7}>\r\n      <div style={active ? {position: 'relative', top: isSmartphone() ? '8.6em' : '8.5em', width: '100%', height: '100%', textAlign:'center', display:'block'} : {position: 'relative', top: isSmartphone() ? '-23em' : '-24em', width: '100%', textAlign:'center'}}>\r\n        <img style={{width:isSmartphone() ? '9.5em' : '8em', userSelect:'none'}} src={logo_es} draggable={false} alt=\"\" />\r\n      </div>\r\n      </Box>\r\n    </DialogContent>\r\n  </ErrorDialogFrame>\r\n}\r\nTheEntrance.displayName = 'TheEntrance'\r\n","import {Stores} from '@components/utils'\r\nimport Button from '@material-ui/core/Button'\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport Slider from '@material-ui/core/Slider'\r\nimport {conference} from '@models/conference'\r\nimport {t} from '@models/locales'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React from 'react'\r\n\r\ninterface MySliderProps{\r\n  value:number, setValue(v:number):void\r\n}\r\n\r\nconst MAX = 30\r\nconst MySlider: React.FC<MySliderProps> = (props) => {\r\n  return <Grid container={true} spacing={2}><Slider value={props.value} min={0} max={MAX}\r\n  track={false} valueLabelDisplay=\"auto\" aria-labelledby=\"continuous-slider\" style={{width:200}}\r\n  onChange={(ev, val) => props.setValue(val as number)} valueLabelFormat={v => v === MAX ? '∞' : v.toString()}\r\n  /></Grid>\r\n}\r\n\r\nexport const RemoteTrackLimitControl: React.FC<Stores> = (props:Stores) => {\r\n  const roomInfo = props.roomInfo\r\n  const local = props.participants.local\r\n  const videoLimit = useObserver(() => local.remoteVideoLimit)\r\n  const audioLimit = useObserver(() => local.remoteAudioLimit)\r\n  const videoSlider = <MySlider value={videoLimit >= 0 ? videoLimit : MAX}\r\n    setValue={(v) => {\r\n      local.remoteVideoLimit = v === MAX ? -1 : v\r\n    } } />\r\n  const audioSlider = <MySlider value={audioLimit >= 0 ? audioLimit : MAX}\r\n    setValue={(v) => {\r\n      local.remoteAudioLimit = v === MAX ? -1 : v\r\n    } } />\r\n\r\n  return <>\r\n  <FormControlLabel\r\n    control={videoSlider}\r\n    label={t('videoLimit')}\r\n  />\r\n  <FormControlLabel\r\n    control={audioSlider}\r\n    label={t('audioLimit')}\r\n  /><br />\r\n  <Button variant=\"contained\" color={roomInfo.passMatched ? 'primary' : 'default'}\r\n      style={{textTransform:'none'}} disabled={!roomInfo.passMatched}\r\n      onClick = { () => {\r\n        if (roomInfo.passMatched){\r\n          conference.dataConnection.sync.sendTrackLimits('', [local.remoteVideoLimit, local.remoteAudioLimit])\r\n        }\r\n      }}\r\n  >Sync limits</Button>\r\n  </>\r\n}\r\nRemoteTrackLimitControl.displayName = 'RemoteTrackLimitControl'\r\n","import {Stores} from '@components/utils'\r\nimport Box from '@material-ui/core/Box'\r\nimport Button from '@material-ui/core/Button'\r\nimport Popover from '@material-ui/core/Popover'\r\nimport TextField from '@material-ui/core/TextField'\r\nimport {conference} from '@models/conference'\r\nimport {MessageType} from '@models/conference/DataMessageType'\r\nimport {isDarkColor, rgb2Color} from '@models/utils'\r\nimport {RoomInfo} from '@stores/RoomInfo'\r\nimport contents from '@stores/sharedContents/SharedContents'\r\nimport {Observer} from 'mobx-react-lite'\r\nimport React from 'react'\r\nimport {SketchPicker} from 'react-color'\r\nimport {RemoteTrackLimitControl} from './RemoteTrackLimitControl'\r\n\r\n\r\nexport interface AdminConfigFormProps{\r\n  close?: () => void,\r\n  stores: Stores,\r\n}\r\nfunction onKeyPress(ev:React.KeyboardEvent, roomInfo: RoomInfo){\r\n  if (ev.key === 'Enter') {\r\n    let pass = roomInfo.roomProps.get('password')\r\n    roomInfo.passMatched = roomInfo.password === (pass ? pass : '')\r\n  }\r\n}\r\nexport const AdminConfigForm: React.FC<AdminConfigFormProps> = (props: AdminConfigFormProps) => {\r\n  const [clearName, setClearName] = React.useState('')\r\n  const [showFillPicker, setShowFillPicker] = React.useState(false)\r\n  const [showColorPicker, setShowColorPicker] = React.useState(false)\r\n  const fillButton = React.useRef<HTMLButtonElement>(null)\r\n  const colorButton = React.useRef<HTMLButtonElement>(null)\r\n  const {roomInfo} = props.stores\r\n\r\n  return <Observer>{()=>{\r\n    const textForFill = isDarkColor(roomInfo.backgroundFill) ? 'white' : 'black'\r\n    const textForColor = isDarkColor(roomInfo.backgroundColor) ? 'white' : 'black'\r\n    const btnColor = roomInfo.passMatched ? 'primary' : 'default'\r\n\r\n    return  <Box m={2}>\r\n      <Box m={2}>\r\n        <RemoteTrackLimitControl key=\"remotelimitcontrol\" {...props.stores}/>\r\n      </Box>\r\n      <Box mt={2} mb={2}>\r\n        <TextField autoFocus label=\"Admin password\" type=\"password\" style={{marginTop:-12}}\r\n          value={roomInfo?.password} onChange={(ev)=>{ roomInfo.password=ev.currentTarget.value}}\r\n          onKeyPress={(ev)=>onKeyPress(ev, roomInfo)}/>\r\n        &emsp;\r\n        <Button variant=\"contained\" color=\"primary\" style={{textTransform:'none'}} onClick={() => {\r\n          let pass = roomInfo.roomProps.get('password')\r\n          if (!pass){ pass = '' }\r\n          roomInfo.passMatched = roomInfo?.password === pass\r\n        }}> Check </Button>&emsp;\r\n        {roomInfo.passMatched ? 'OK': 'Not matched'}\r\n      </Box>\r\n      <Box mt={2} mb={2}>\r\n        <TextField label=\"New password to update\" type=\"text\" style={{marginTop:-12}}\r\n          value={roomInfo?.newPassword} onChange={(ev)=>{roomInfo.newPassword=ev.currentTarget.value}}\r\n        />&emsp;\r\n        <Button variant=\"contained\" color={btnColor} disabled={!roomInfo.passMatched} style={{textTransform:'none'}}\r\n          onClick={() => {\r\n            if (roomInfo.passMatched){\r\n              conference.dataConnection.setRoomProp('password', roomInfo.newPassword)\r\n            }\r\n          }}> Update password </Button>&emsp;\r\n      </Box>\r\n      <Box mt={2}>\r\n        <Button variant=\"contained\" color={btnColor} style={{textTransform:'none'}}\r\n          disabled={!roomInfo.passMatched} onClick={() => {\r\n          if (roomInfo.passMatched) { conference.dataConnection.sendMessage(MessageType.MUTE_VIDEO, true) }\r\n        }}> Mute all videos </Button> &nbsp;\r\n        <Button variant=\"contained\" color={btnColor} style={{textTransform:'none'}}\r\n          disabled={!roomInfo.passMatched} onClick={() => {\r\n          if (roomInfo.passMatched) { conference.dataConnection.sendMessage(MessageType.MUTE_VIDEO, false) }\r\n        }}> Show all videos </Button>&emsp;\r\n        <Button variant=\"contained\" color={btnColor} style={{textTransform:'none'}}\r\n          disabled={!roomInfo.passMatched} onClick={() => {\r\n          if (roomInfo.passMatched) { conference.dataConnection.sendMessage(MessageType.MUTE_AUDIO, true) }\r\n        }}> Mute all mics </Button>&nbsp;\r\n        <Button variant=\"contained\" color={btnColor} style={{textTransform:'none'}}\r\n          disabled={!roomInfo.passMatched} onClick={() => {\r\n          if (roomInfo.passMatched) { conference.dataConnection.sendMessage(MessageType.MUTE_AUDIO, false) }\r\n        }}> Switch on all mics </Button>\r\n      </Box>\r\n      <Box mt={2}>\r\n        <Button variant=\"contained\" color={btnColor} style={{textTransform:'none'}}\r\n          disabled={!roomInfo.passMatched} onClick={() => {\r\n          if (roomInfo.passMatched) {\r\n            contents.removeAllContents()\r\n          }\r\n        }}> Remove all Contents </Button>&emsp;\r\n        <Button variant=\"contained\" color={btnColor} style={{textTransform:'none'}}\r\n          disabled={!roomInfo.passMatched} onClick={() => {\r\n            if (roomInfo.passMatched){\r\n              const ids = new Set(contents.roomContentsInfo.keys())\r\n              contents.all.forEach(c => ids.add(c.id))\r\n              contents.all.filter(c => c.ownerName === clearName).forEach(c => contents.removeByLocal(c.id))\r\n            }\r\n        }}> Clear contents by user name </Button> &thinsp;\r\n        <TextField label=\"name\" type=\"text\" style={{marginTop:-12}}\r\n            value={clearName} onChange={(ev)=>{setClearName(ev.currentTarget.value)}} />\r\n      </Box>\r\n      <Box mt={2}>\r\n        <Button variant=\"contained\" color={btnColor} style={{textTransform:'none'}}\r\n          disabled={!roomInfo.passMatched} onClick={() => {\r\n          if (roomInfo.passMatched) {\r\n            if (conference.isDataConnected()){\r\n              conference.dataConnection.pushOrUpdateMessageViaRelay(MessageType.RELOAD_BROWSER, {})\r\n            }\r\n          }\r\n        }}> Reload </Button>&emsp;\r\n\r\n        <Button variant=\"contained\" disabled={!roomInfo.passMatched}\r\n          style={roomInfo.passMatched ?\r\n            {backgroundColor:rgb2Color(roomInfo.backgroundFill), color:textForFill, textTransform:'none'}\r\n            : {textTransform:'none'} }\r\n          onClick={()=>{if (roomInfo.passMatched){ setShowFillPicker(true) }}} ref={fillButton}>\r\n          Back color</Button>\r\n        <Popover open={showFillPicker}\r\n          onClose={()=>{\r\n            setShowFillPicker(false)\r\n            conference.dataConnection.setRoomProp('backgroundFill', JSON.stringify(roomInfo.backgroundFill))\r\n          }}\r\n          anchorEl={fillButton.current} anchorOrigin={{vertical:'bottom', horizontal:'right'}}>\r\n          <SketchPicker color = {{r:roomInfo.backgroundFill[0], g:roomInfo.backgroundFill[1],\r\n            b:roomInfo.backgroundFill[2]}} disableAlpha\r\n            onChange={(color, event)=>{\r\n              event.preventDefault()\r\n              roomInfo.backgroundFill = [color.rgb.r, color.rgb.g, color.rgb.b]\r\n            }}\r\n          />\r\n        </Popover>\r\n        &nbsp;\r\n        <Button variant=\"contained\" disabled={!roomInfo.passMatched}\r\n          style={roomInfo.passMatched ?\r\n            {backgroundColor:rgb2Color(roomInfo.backgroundColor), color:textForColor, textTransform:'none'}\r\n            : {textTransform:'none'} }\r\n          onClick={()=>{if (roomInfo.passMatched){ setShowColorPicker(true)} }} ref={colorButton}>\r\n          Pattern color</Button>\r\n        <Popover open={showColorPicker}\r\n          onClose={()=>{\r\n            setShowColorPicker(false)\r\n            conference.dataConnection.setRoomProp('backgroundColor', JSON.stringify(roomInfo.backgroundColor))\r\n          }}\r\n          anchorEl={colorButton.current} anchorOrigin={{vertical:'bottom', horizontal:'right'}}>\r\n          <SketchPicker color = {{r:roomInfo.backgroundColor[0], g:roomInfo.backgroundColor[1],\r\n            b:roomInfo.backgroundColor[2]}} disableAlpha\r\n            onChange={(color, event)=>{\r\n              event.preventDefault()\r\n              roomInfo.backgroundColor = [color.rgb.r, color.rgb.g, color.rgb.b]\r\n            }}\r\n          />\r\n        </Popover>&nbsp;\r\n        <Button variant=\"contained\" color={btnColor} style={{textTransform:'none'}}\r\n          disabled={!roomInfo.passMatched} onClick={() => {\r\n          if (roomInfo.passMatched) {\r\n            roomInfo.backgroundFill = roomInfo.defaultBackgroundFill\r\n            roomInfo.backgroundColor = roomInfo.defaultBackgroundColor\r\n            conference.dataConnection.setRoomProp('backgroundFill', JSON.stringify(roomInfo.backgroundFill))\r\n            conference.dataConnection.setRoomProp('backgroundColor', JSON.stringify(roomInfo.backgroundColor))\r\n          }\r\n        }}> Default </Button>&emsp;\r\n      </Box>\r\n\r\n    </Box>}\r\n  }</Observer>\r\n}\r\n","import {BMProps} from '@components/utils'\r\nimport Container from '@material-ui/core/Container'\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\r\n//import Switch from '@material-ui/core/Switch'\r\nimport Checkbox from '@material-ui/core/Checkbox'\r\nimport {useTranslation} from '@models/locales'\r\nimport {Observer} from 'mobx-react-lite'\r\nimport React from 'react'\r\nimport CheckBoxIcon from '@material-ui/icons/Done';\r\nimport CheckBoxOutlineBlankIcon from '@material-ui/icons/CheckBoxOutlineBlank';\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport { isSmartphone } from '@models/utils'\r\nimport { Typography } from '@material-ui/core'\r\n\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    padding: 2,\r\n  },\r\n  formControlLabel: {\r\n    fontSize: isSmartphone() ? '2.5em' : \"1em\"\r\n  }\r\n})\r\n\r\nexport const BroadcastControl: React.FC<BMProps> = (props: BMProps) => {\r\n  const local = props.stores.participants.local\r\n  const classes = useStyles()\r\n  const audioBroadcastSwitch = <Observer>{ () =>\r\n    <Checkbox\r\n      icon={<CheckBoxOutlineBlankIcon  htmlColor=\"transparent\"/>}\r\n      checkedIcon={<CheckBoxIcon style={{fontSize:isSmartphone() ? '2em' : '1em'}} htmlColor=\"black\" />}\r\n      className={classes.root}\r\n      checked={local.physics.onStage} name=\"broadcast\"\r\n      onChange={event => local.setPhysics({onStage: event.target.checked})} />\r\n  }</Observer>\r\n  const {t} = useTranslation()\r\n\r\n  return <Container>\r\n    <div style={{width:'130%', height:'1.5px', backgroundColor:'#bcbec0', marginLeft:'-40px'}}></div>\r\n    <FormControlLabel style={{position:'relative', top:'5px', left: '-25px', fontSize:isSmartphone() ? '2em' : '1em'}}\r\n      control={audioBroadcastSwitch}\r\n      label={<Typography className={classes.formControlLabel}>{t('broadcastMyVoice')}</Typography>}\r\n    />\r\n  </Container>\r\n}\r\nBroadcastControl.displayName = 'BroadcastControl'\r\n","import IconButton from '@material-ui/core/IconButton'\r\nimport Zoom from '@material-ui/core/Zoom'\r\n/* import MoreVertIcon from '@material-ui/icons/MoreVert' */\r\nimport React, {CSSProperties} from 'react'\r\nimport MoreIcon from '@images/earshot_icon_submenu.png'\r\nimport { isSmartphone } from '@models/utils'\r\n\r\n//  utility to control more button\r\nexport interface MoreButtonMember{\r\n  timeout:NodeJS.Timeout|undefined\r\n}\r\nexport function moreButtonControl(setShowMore:(show:boolean) => void, member:MoreButtonMember) {\r\n  return {\r\n    onMouseOver(ev:React.MouseEvent) {\r\n      //  console.log('over')\r\n      if (! (ev.nativeEvent as any).sourceCapabilities?.firesTouchEvents) {\r\n        if (member.timeout) {\r\n          clearTimeout(member.timeout)\r\n          member.timeout = undefined\r\n        }\r\n        setShowMore(true)\r\n      }\r\n    },\r\n    onMouseOut(ev:React.MouseEvent) {\r\n      //  console.log('out')\r\n      if (member.timeout) {\r\n        clearTimeout(member.timeout)\r\n      }\r\n      member.timeout = setTimeout(() => {\r\n        setShowMore(false)\r\n        member.timeout = undefined\r\n      },                          500)\r\n    },\r\n  }\r\n}\r\n\r\n\r\nexport type IconColor = 'inherit' | 'disabled' | 'primary' | 'secondary' | 'action' | 'error' | undefined\r\nexport type FabColor = 'inherit' | 'default' | 'primary' | 'secondary' | undefined\r\nexport interface MoreButtonProps{\r\n  show: boolean\r\n  htmlColor?: string\r\n  iconColor?: IconColor\r\n  color?: FabColor\r\n  className?: string\r\n  style?: CSSProperties\r\n  onClickMore?(ev:React.PointerEvent|React.MouseEvent|React.TouchEvent): void\r\n  buttonRef?: React.RefObject<HTMLButtonElement>\r\n}\r\n\r\nexport const MoreButton: React.FC<MoreButtonProps> = (props) => {\r\n  const handleClick = (event: React.PointerEvent<HTMLButtonElement>) => {\r\n    if (props.onClickMore) { props.onClickMore(event) }\r\n  }\r\n\r\n  return <Zoom in={props.show} style={props.style} >\r\n    <IconButton className={props.className} color={props.color} onClick={handleClick}\r\n      size={'small'} ref={props.buttonRef}\r\n    >\r\n     {/*  <MoreVertIcon color={props.iconColor} htmlColor={props.htmlColor} fontSize=\"large\" /> */}\r\n     <img src={MoreIcon} width={isSmartphone() ? 90 : 45} height={isSmartphone() ? 60 : 30} draggable={false} alt='' />\r\n    </IconButton>\r\n  </Zoom>\r\n}\r\n","export default \"data:image/png;base64,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\"","import {FabColor, IconColor, MoreButton, moreButtonControl, MoreButtonMember} from '@components/utils/MoreButton'\r\nimport {Tooltip} from '@material-ui/core'\r\nimport Fab from '@material-ui/core/Fab'\r\nimport {makeStyles} from '@material-ui/core/styles'\r\nimport React, {useRef, useState} from 'react'\r\nimport { isSmartphone } from '@models/utils'\r\n\r\nconst useStyles = makeStyles((theme) => {\r\n  return ({\r\n    container: {\r\n      display:'inline-block',\r\n      marginLeft: theme.spacing(2),\r\n      marginRight: theme.spacing(2),\r\n      marginTop: theme.spacing(1),\r\n      marginBottom: theme.spacing(1),\r\n      pointerEvents: 'auto',\r\n    },\r\n  })\r\n})\r\n\r\n/* interface MyFabProps{\r\n  children: React.ReactElement,\r\n  onClick?: (e: React.MouseEvent<HTMLButtonElement, MouseEvent>|React.TouchEvent<HTMLButtonElement>) => void,\r\n  onClickMore?: (e: React.PointerEvent<HTMLButtonElement>\r\n    |React.MouseEvent<HTMLButtonElement, MouseEvent>|React.TouchEvent<HTMLButtonElement>) => void,\r\n  color?: FabColor\r\n  iconColor?: IconColor\r\n  htmlColor?: string\r\n  className?: string\r\n  style?: React.CSSProperties\r\n  title?: string | React.ReactElement,\r\n  size?: number,\r\n  divRef?: React.RefObject<HTMLDivElement>\r\n}\r\n\r\n\r\nexport const FabMain: React.FC<MyFabProps> = (props) => {\r\n  const classes = useStyles()\r\n  const [showMore, setShowMore] = useState<boolean>(false)\r\n  const memberRef = useRef<MoreButtonMember>({timeout:undefined})\r\n  const member = memberRef.current\r\n\r\n  return <div className={classes.container + (props.className ? ` ${props.className}` : '')}\r\n    style={props.style} ref={props.divRef}\r\n    {...moreButtonControl(setShowMore, member)}\r\n  >\r\n    <Fab style={{height:props.size, width:props.size}}\r\n      onClick = {(ev) => { if (props.onClick) { props.onClick(ev) } } }\r\n      onContextMenu={(ev) => {\r\n        ev.preventDefault()\r\n        if (props.onClickMore) { props.onClickMore(ev) }\r\n      }}\r\n      color = {props.color} onFocus = {(e) => { (e.target as HTMLElement)?.blur() }}>\r\n      {props.children}\r\n    </Fab>\r\n    {props.onClickMore ? <MoreButton style={{position:'relative', top:-35, left:-15, marginRight:-41}}\r\n    show={showMore} color={props.color} htmlColor={props.htmlColor} iconColor={props.iconColor}\r\n    onClickMore = {props.onClickMore}\r\n    /> : undefined}\r\n  </div>\r\n}\r\n\r\nexport const FabWithTooltip: React.FC<MyFabProps> = (props) => {\r\n  if (props.title) {\r\n    return <Tooltip placement=\"top-start\" arrow={true}\r\n    title={props.title}>\r\n    <span style={{paddingTop:20}} >\r\n      <FabMain {...props} />\r\n    </span>\r\n    </Tooltip>\r\n  }\r\n\r\n  return <FabMain {...props} />\r\n} */\r\n\r\ninterface MyFabProps{\r\n  children: React.ReactElement,\r\n  onDown?: (e: React.MouseEvent<HTMLButtonElement, MouseEvent>|React.TouchEvent<HTMLButtonElement>) => void,\r\n  onClick?: (e: React.MouseEvent<HTMLButtonElement, MouseEvent>|React.TouchEvent<HTMLButtonElement>) => void,\r\n  onClickMore?: (e: React.PointerEvent<HTMLButtonElement>\r\n    |React.MouseEvent<HTMLButtonElement, MouseEvent>|React.TouchEvent<HTMLButtonElement>) => void,\r\n  color?: FabColor\r\n  iconColor?: IconColor\r\n  htmlColor?: string\r\n  className?: string\r\n  style?: React.CSSProperties\r\n  title?: string | React.ReactElement,\r\n  size?: number,\r\n  divRef?: React.RefObject<HTMLDivElement>\r\n  isOpen?: boolean,\r\n  index?: number,\r\n}\r\n\r\n\r\nexport const FabMain: React.FC<MyFabProps> = (props) => {\r\n  const classes = useStyles()\r\n  const [showMore, setShowMore] = useState<boolean>(false)\r\n  const memberRef = useRef<MoreButtonMember>({timeout:undefined})\r\n  const member = memberRef.current\r\n\r\n  let tDelay = ''\r\n\r\n  if(props.index !== undefined && props.isOpen === true) {\r\n    tDelay = ((props.index/2 * 0.3) + 0.5) + 's'\r\n  }\r\n\r\n  // Dummy\r\n  if(showMore){}\r\n\r\n  return <div className={classes.container + (props.className ? ` ${props.className}` : '')}\r\n    style={props.style} ref={props.divRef}\r\n    {...moreButtonControl(setShowMore, member)}\r\n  >\r\n    <Fab style={{height:props.size, width:props.size}}\r\n      onClick = {(ev) => { if (props.onClick) { props.onClick(ev) } } }\r\n      onMouseDown = {(ev) => { if (props.onDown) { props.onDown(ev) } } }\r\n      onTouchStart = {(ev) => { if (props.onDown) { props.onDown(ev) } } }\r\n      onContextMenu={(ev) => {\r\n        ev.preventDefault()\r\n        if (props.onClickMore) { props.onClickMore(ev) }\r\n      }}\r\n      color = {props.color} onFocus = {(e) => { (e.target as HTMLElement)?.blur() }}>\r\n      {props.children}\r\n    </Fab>\r\n    {props.onClickMore ? <MoreButton style={isSmartphone() ? props.isOpen ? {position:'relative', top:-103/* top:-35 */, left:-95 /* left:-15 */, marginRight:-81/* , display:'none' */, opacity: 0.8, transition: '0.3s ease-out', transitionDelay:(tDelay)} : {position:'relative', top:-10/* top:-35 */, left:-95 /* left:-15 */, marginRight:-81/* , display:'none' */, opacity: 0, transition: '0.1s ease-out', transitionDelay:'0s'} : props.isOpen ? {position:'relative', top:-53/* top:-35 */, left:-52 /* left:-15 */, marginRight:-41/* , display:'none' */, opacity:0.8, transition: '0.3s ease-out', transitionDelay:(tDelay)}: {position:'relative', top:-10/* top:-35 */, left:-52 /* left:-15 */, marginRight:-41/* , display:'none' */, opacity:0, transition: '0.1s ease-out', transitionDelay:'0s'}}\r\n    /* show={showMore} */ show={true} color={props.color} htmlColor={props.htmlColor} iconColor={props.iconColor}\r\n    onClickMore = {props.onClickMore}\r\n    /> : undefined}\r\n  </div>\r\n}\r\n\r\nexport const FabWithTooltip: React.FC<MyFabProps> = (props) => {\r\n  if (props.title) {\r\n    return <Tooltip placement=\"top-start\" arrow={true}\r\n    title={props.title}>\r\n    <span style={{paddingTop:20}} >\r\n      <FabMain {...props} />\r\n    </span>\r\n    </Tooltip>\r\n  }\r\n  return <FabMain {...props} />\r\n}\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAACtElEQVR4nO3d8U3bQBhA8a9V/ycblE7QdANGyAhhg4zACN2g6QTNBoUJSjeADZIJrrJ0kVDpGftsH7zq/aSoFeCPqx+uExvBu5RSiOm93biMB2Y8MOOBGQ/MeGDGAzMemPHAjAdmPDDjgRkPzHhgxgMzHpjxwIwHZjww44EZD8x4YMYDMx6Y8cCMB2Y8MOOBGQ/MeGDGAzMemPHAjAdmPDDjgRkPzHhgxgMzHpjxwIwHZjww44EZD+zDG1j6Vf7zPiKOM85dRcQ6//12xrlLzx6u+5GNjR+rlNJNSukhPfeQ37eqXFPf7PuU0m7C7MuU0r5n9rb1vmwdbpNSOv7jH/+3Y/7YMbO3A2d3O389cvZuwNxzxLGzEfG2A3fAU0O/msfOPo7YyfsFZ096tPpJt9354Vfltl/y+bCkO2f+rJh7yut66PmYTUT8qJj9mGfPeQ5/ptWzza8LbruvHH0RETc9719NmP0xInaV2w7W4sibctSdlY6+2iPjqU+Fo28bEd8mzD3lL4DFtDjyNgvOuCq8fYzSjKnrvphpfUUt4l3OMGM98u1jlNY3x7qNt/R/PwWfX+FzjtIiXt+zuaEWfdZW8PsVPucolHillwp9LyGGKq1vjnUveumsRbzDgjPm2DmlGVPXffof4nVHx92E7e96jrBDfkFc63vPEXbIAWpNeW07iFdYvMLyom7nX1dsdz3gvHZbMfuUo790Xjvko3Ps7E2TJ1kNL0yHdxXmfbSOF97P491V6HO+CkG62/0m7qT7yw/B/AYkMOOBGQ/MeGDGAzMemPHAjAdmPDDjgRkPzHhgxgMzHpjxwIwHZjww44EZD8x4YMYDMx6Y8cCMB2Y8MOOBGQ/MeGDGAzMemPHAjAdmPDDjgRkPzHhgxgMzHpjxwIwHZjww44EZD8x4YMajiog/21dcxOr72+UAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAADU0lEQVR4nO3cMWsTYRzH8W9FrIKDCCKClU4OIjSb4tSX0JdQxaEqODgKooivQBCdtIObS9+BcRGdjOLkVHARF7u1dYnDpSaRJJecvfs/vye/LwR6pMnzlA93l1zvbqHb7eI0OxI9AVc94wlnPOGMJ5zxhDOecMYTznjCGU844wlnPOGMJ5zxhDOecMYTznjCGU844wlnPOGMJ5zxhDOecMYTznjCGU844wlnPOGMJ5zxhDsaPYFDahV4ApxvcMw94D1wD9hpcNy/LWRwidcq8DZw/O/AhYiBc9hsPgwefwlYixg4B7yl6AkArYhBc8DLZb89c7n+4e+Adk3vvQGcrem9ZypXvDbwqKb3XiMRvBw2m3Ob8YQznnDGE854wql82jwF3Or9/JygY4mppYDXAj4Ai73lB8AlYLu3vDfiNXOBm/pmswV8pA8HcAJYH1j+OuJ17fqmlE4p4x3AHSv5vZvA597P+8B9oFPjvJIp1c3mJLh9YHNgeYegA8PRpbjmla1xG/T3d3NdanhlcNcZXuvmupTwDDdjqeAZrkIp4BmuYtF4hvuPIvGWKY6cTPoe9wroBjw6FIfkki4S7zXDR05SaoX+sdRki8Rr8gTZKl2OnkBZkXhfAseepjfREygrEu8usBs4/rh+Uexrt6InUlYk3jZwjcmAd4CFhh+ngRuH9UfWWfRXhQ6TAZ8Bt5ubjlbReNAH3B/zvAHHlAIeFIBXgd9jnjfgiFLBgwLwCgacupTwYDrA9cZmk3ip4UE54AuKQ2v/1kLgkNZhliIeTAZcZHjtWwZ+Ap8ovqO9rHluyZQqHpSvgQc9Bc4MLF9nTs5pSRkP+oCD52buMvxvoosjXhdymXHTpXr22GAd4Bx9kC2GT6o93viMEkkBDwqszehJpFbqm003IeMJZzzhjCec8YRT+bQ5a2sUR172gB8zvrZd8vzJCvOppVzxVnqPKkXfy2zqcthsjroydi7KAe9b9AQIupgzh/ttTnsFbV2F3W8zBzwoAB9T3Gigqf2473TrqpfDPm9uM55wxhPOeMIZTzjjCWc84YwnnPGEM55wxhPOeMIZTzjjCWc84YwnnPGEM55wxhPOeMIZTzjjCWc84YwnnPGEM55wxhPOeMIZT7g/q2qRvKQQJk8AAAAASUVORK5CYII=\"","import {assert} from '@models/utils'\r\nimport React from 'react'\r\n\r\nexport function acceleratorText2El(text:string) {\r\n  const texts = text.split('_')\r\n  assert(texts.length <= 2)\r\n\r\n  return <>{texts[0]}{texts[1] ?\r\n    <><strong>{texts[1].substr(0, 1)}</strong>{texts[1].substr(1)}</> : undefined}</>\r\n}\r\n","import {loadFaceLandmarkTinyModel, loadTinyFaceDetectorModel, detectSingleFace,\r\n  TinyFaceDetectorOptions, Point, WithFaceLandmarks, FaceLandmarks68, FaceDetection} from 'face-api.js'\r\nimport {rgba} from '@models/utils/color'\r\nimport participants from '@stores/participants/Participants'\r\nimport {addV2, MSTrack, mulV2, rotateVector2DByDegree, subV2} from '@models/utils'\r\n\r\n// config.js\r\ndeclare const config:any                  //  from ../../config.js included from index.html\r\n\r\n//  camera device selection\r\nvar interval:NodeJS.Timeout|undefined\r\nvar videoEl: HTMLVideoElement|undefined\r\nvar imageEl: HTMLImageElement|undefined\r\nvar canvasBufEl: HTMLCanvasElement|undefined\r\nvar lms: Point[] = []\r\nconst FACE_FPS = 15\r\nvar imageLoaded = false\r\nfunction drawFace(width:number, height:number,\r\n  canvasEl: HTMLCanvasElement, face?: WithFaceLandmarks<{detection:FaceDetection}, FaceLandmarks68>){\r\n  if (!width) width = 100\r\n  if (!height) height = 100\r\n  //  canvas element's size\r\n  canvasEl.style.width = `${width}px`\r\n  canvasEl.style.height = `${height}px`\r\n  //  canvas viewport size\r\n  canvasEl.width = width\r\n  canvasEl.height = height\r\n  if (!canvasBufEl){\r\n    canvasBufEl = window.document.createElement('canvas') as HTMLCanvasElement\r\n  }\r\n  canvasBufEl.width = width\r\n  canvasBufEl.height = height\r\n  const ctx = canvasBufEl.getContext('2d')\r\n  if (!ctx) return\r\n  ctx.strokeStyle = participants.local.getColor()[2]\r\n  ctx.lineWidth = 6\r\n  ctx.lineCap = 'round'\r\n  ctx.fillRect(0, 0, width, height)\r\n  if (participants.local.information.avatarSrc && !imageEl){\r\n    imageEl = new Image()\r\n    imageEl.onload = () => {\r\n      imageLoaded = true\r\n    }\r\n    imageEl.crossOrigin = 'anonymous'\r\n    imageEl.src = participants.local.information.avatarSrc\r\n  }\r\n  if (!participants.local.information.avatarSrc && imageEl){\r\n    imageEl.remove()\r\n    imageLoaded = false\r\n    imageEl = undefined\r\n  }\r\n  if (imageLoaded && imageEl){\r\n      ctx.drawImage(imageEl, 0, 0, imageEl.width, imageEl.height, 0,0, width, height)\r\n  }else{\r\n    const nameArray = participants.local.information.name.split(' ')\r\n    let initial = ''\r\n    nameArray.forEach(s => initial += s ? s.substring(0,1) : '')\r\n    initial = initial.substring(0,2)\r\n    ctx.fillStyle = rgba(participants.local.getTextColorRGB(), 0.5)\r\n    ctx.font = `${0.3 * height}px Sans`\r\n    ctx.textAlign = 'center'\r\n    ctx.textBaseline = 'middle'\r\n    ctx.fillText(initial, 0.5*width, 0.5*height, 0.8*width)\r\n    ctx.fillStyle = participants.local.getColor()[0]\r\n  }\r\n  /*\r\n    ctx.drawImage(videoEl, 0,0)\r\n    const box = face?.detection.box\r\n    ctx.strokeRect(box.left, box.top, box.width, box.height)  */\r\n  if (face) lms = face.landmarks.positions\r\n  const paths = [lms.slice(0, 17), lms.slice(17, 22), lms.slice(22, 27),\r\n    lms.slice(27, 31), lms.slice(31, 36) ]\r\n  const eyes = [lms.slice(36, 42), lms.slice(42, 48)]\r\n  const mouse = [/*lms.slice(48,60), */ lms.slice(60,68)]\r\n  function drawStrokes(ctx: CanvasRenderingContext2D, paths: Point[][], close: boolean){\r\n    for (const path of paths){\r\n      ctx.beginPath()\r\n      for(const pos of path){\r\n        if (pos === path[0]) ctx.moveTo(pos.x, pos.y)\r\n        else ctx.lineTo(pos.x, pos.y)\r\n      }\r\n      if (close) ctx.closePath()\r\n      ctx.stroke()\r\n    }\r\n  }\r\n  drawStrokes(ctx, paths, false)\r\n  drawStrokes(ctx, eyes, true)\r\n  drawStrokes(ctx, mouse, true)\r\n\r\n  const ctx2 = canvasEl.getContext('2d')\r\n  ctx2?.drawImage(canvasBufEl, 0, 0)\r\n}\r\n\r\nvar lastPos:number[] = []\r\nvar lastWidth:number = -1\r\nvar lastNose:number[] = []\r\nvar filteredPos:number[] = []\r\nvar filteredWidth:number = -1\r\nvar filteredNose:number[] = []\r\nfunction moveAvatar(face?: WithFaceLandmarks<{detection:FaceDetection}, FaceLandmarks68>){\r\n  if (face){\r\n    const currentPos = [face.detection.relativeBox.x, face.detection.relativeBox.y]\r\n    const currentWidth = face.detection.relativeBox.width\r\n    const nosePos = [face.landmarks.positions[30].x, face.landmarks.positions[30].y]\r\n    const currentNose = subV2(nosePos, [face.detection.box.left, face.detection.box.top])\r\n    currentNose[0] = currentNose[0] / face.detection.box.width\r\n    currentNose[1] = currentNose[1] / face.detection.box.height\r\n    //  console.log(`nose: ${currentNose[0]}, ${currentNose[1]}`)\r\n\r\n    if (filteredPos.length){\r\n      const alpha = 0.2\r\n      filteredPos = addV2(mulV2(alpha, currentPos), mulV2(1-alpha, lastPos))\r\n      filteredWidth = alpha * currentWidth + (1-alpha) * lastWidth\r\n      const alphaNose = 0.4\r\n      filteredNose = addV2(mulV2(alphaNose, currentNose), mulV2(1-alphaNose, lastNose))\r\n    }else{\r\n      filteredPos = currentPos\r\n      filteredWidth = currentWidth\r\n      filteredNose = currentNose\r\n    }\r\n    if (lastPos.length){\r\n      const diffWorldPos = subV2(filteredPos, lastPos)\r\n      const diffWidth = filteredWidth - lastWidth\r\n      const diffAvatarPos = rotateVector2DByDegree(participants.local.pose.orientation, [diffWorldPos[0], diffWidth])\r\n      participants.local.pose.position = addV2(participants.local.pose.position, mulV2(-100, diffAvatarPos))\r\n    }\r\n    if (lastNose.length){\r\n      const diffNose = subV2(filteredNose, lastNose)\r\n      participants.local.pose.orientation += -100 * diffNose[0]\r\n      const newNodding = participants.local.viewpoint.nodding ? participants.local.viewpoint.nodding + diffNose[1] : diffNose[1]\r\n      participants.local.viewpoint.nodding = 0.99 * newNodding\r\n    }\r\n    lastPos = filteredPos\r\n    lastWidth = filteredWidth\r\n    lastNose = filteredNose\r\n  }\r\n}\r\n\r\nvar canvasEl: HTMLCanvasElement|undefined\r\nvar loaded = false\r\nexport function stopFaceTrack(){\r\n  if (interval){\r\n    clearInterval(interval)\r\n    interval = undefined\r\n  }\r\n  if (videoEl) videoEl.srcObject = null\r\n  participants.local.viewpoint.nodding = undefined\r\n}\r\nexport function createLocalCamera(faceTrack: boolean, did?:string) {\r\n  const promise = new Promise<MSTrack>((resolutionFunc, rejectionFunc) => {\r\n    if (!did){\r\n      did = participants.local.devicePreference.videoInputDevice\r\n    }\r\n    navigator.mediaDevices.getUserMedia(\r\n      {video:{\r\n        deviceId:did,\r\n        ...config.rtc.video\r\n      }}\r\n    ).then((ms)=>{\r\n      if (faceTrack){\r\n        if (!videoEl){\r\n          //  face-api\r\n          loadTinyFaceDetectorModel('/faceApiModels').then(()=>{\r\n            loadFaceLandmarkTinyModel('/faceApiModels').then(()=>{\r\n              loaded = true\r\n            })\r\n          })\r\n          videoEl = window.document.createElement('video') as HTMLVideoElement\r\n          videoEl.autoplay = true\r\n        }\r\n        if (!canvasEl) canvasEl = window.document.createElement('canvas') as HTMLCanvasElement\r\n        videoEl.srcObject = ms\r\n        if (interval){ clearInterval(interval) }\r\n        const ops = new TinyFaceDetectorOptions({inputSize: 160, scoreThreshold: 0.5})\r\n        interval = setInterval(()=>{\r\n          if (interval === null) return\r\n          if (loaded){\r\n            detectSingleFace(videoEl!, ops).withFaceLandmarks(true).then((face) => {\r\n              drawFace(videoEl!.videoWidth, videoEl!.videoHeight, canvasEl!, face)\r\n              moveAvatar(face)\r\n              return face\r\n            }).catch(()=>{\r\n              drawFace(videoEl!.videoWidth, videoEl!.videoHeight, canvasEl!)\r\n            })\r\n          }else{\r\n            drawFace(videoEl!.videoWidth, videoEl!.videoHeight, canvasEl!)\r\n          }\r\n        }, 1000.0 / FACE_FPS)\r\n        const mediaStream = canvasEl.captureStream(FACE_FPS)\r\n        const track:MSTrack = {\r\n          track: mediaStream.getVideoTracks()[0],\r\n          peer: participants.local.id,\r\n          role: 'avatar'\r\n        }\r\n        resolutionFunc(track)\r\n      }else{\r\n        stopFaceTrack()\r\n        const track:MSTrack = {\r\n          track: ms.getVideoTracks()[0],\r\n          peer: participants.local.id,\r\n          role: 'avatar'\r\n        }\r\n        resolutionFunc(track)\r\n      }\r\n    }).catch(rejectionFunc)\r\n  })\r\n\r\n  return promise\r\n}\r\n","import {acceleratorText2El} from '@components/utils/formatter'\r\nimport {Tooltip} from '@material-ui/core'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar'\r\nimport {isSmartphone} from '@models/utils'\r\nimport React from 'react'\r\n\r\ninterface DialogIconItemProps {\r\n  icon?: JSX.Element\r\n  text?: string\r\n  plain?: string | JSX.Element\r\n  secondEl?: JSX.Element\r\n  tip?:JSX.Element | string\r\n  dense?: boolean\r\n  onClick?: () => void\r\n}\r\n\r\nexport const DialogIconItem: React.FC<DialogIconItemProps> = (props) => {\r\n  const {\r\n    icon,\r\n    text,\r\n    plain,\r\n    secondEl,\r\n    tip,\r\n    dense,\r\n    onClick,\r\n  } = props\r\n  const textEl = text ? acceleratorText2El(text) : undefined\r\n  const fontSize = isSmartphone() ? '2.5em' : '1em'\r\n\r\n  const item = <ListItem button={true} dense={dense} onClick={onClick} style={{alignItems:'start'}}>\r\n    {icon ? <ListItemAvatar style={{fontSize: fontSize, height:fontSize}}>{icon}</ListItemAvatar>\r\n     : undefined }\r\n    <div style={{fontSize: isSmartphone() ? '2.5em' : '1.2em', verticalAlign: 'middle'}}>\r\n      {textEl ? textEl : plain}\r\n      {secondEl ? <><br/>{secondEl}</> : undefined}\r\n    </div>\r\n  </ListItem>\r\n\r\n  return tip ? <Tooltip title={tip} placement=\"top-end\" enterDelay={1000}>{item}</Tooltip> : item\r\n}\r\n\r\ninterface DialogItemProps {\r\n  icon?: JSX.Element\r\n  text?: string\r\n  plain?: string | JSX.Element\r\n  secondEl?: JSX.Element\r\n  tip?:JSX.Element | string\r\n  dense?: boolean\r\n}\r\nexport const DialogItem: React.FC<DialogItemProps> = (props) => {\r\n  const {\r\n    icon,\r\n    text,\r\n    plain,\r\n    secondEl,\r\n    tip,\r\n    dense,\r\n  } = props\r\n  const fontSize = isSmartphone() ? '2.5em' : '1em'\r\n  const textEl = text ? acceleratorText2El(text) : undefined\r\n  const item = <ListItem dense={dense} button={false} style={{alignItems:'start'}}>\r\n    {icon ? <ListItemAvatar style={{fontSize: fontSize, height:fontSize}}>\r\n      {icon}\r\n    </ListItemAvatar> : undefined }\r\n    <div style={{fontSize: isSmartphone() ? '2.5em' : '1em', verticalAlign: 'middle'}}>\r\n      {textEl ? textEl : plain}\r\n      {secondEl ? <><br/>{secondEl}</> : undefined}\r\n    </div>\r\n  </ListItem>\r\n\r\n  return tip ? <Tooltip title={tip} placement=\"top-end\" enterDelay={1000}>{item}</Tooltip> : item\r\n}\r\n","import MenuItem from '@material-ui/core/MenuItem'\r\nimport {createContentOfVideo} from '@stores/sharedContents/SharedContentCreator'\r\nimport {makeObservable, observable} from 'mobx'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React, {useEffect} from 'react'\r\nimport {DialogPageProps} from './Step'\r\nimport {createLocalCamera} from '@models/conference/faceCamera'\r\nimport {conference} from '@models/conference'\r\n\r\nexport class CameraSelectorMember{\r\n  @observable.shallow videos: MediaDeviceInfo[] = []\r\n  constructor(){\r\n    makeObservable(this)\r\n  }\r\n}\r\ninterface CameraSelectorProps extends DialogPageProps{\r\n  cameras: CameraSelectorMember\r\n  xCord:number\r\n  yCord:number\r\n  from:string\r\n}\r\n\r\nexport const CameraSelector: React.FC<CameraSelectorProps> = (props) => {\r\n  const {setStep} = props\r\n  const {contents, map, participants} = props.stores\r\n  const videoMenuItems = useObserver(() =>\r\n    props.cameras.videos.map((info, idx) => makeMenuItem(info, closeVideoMenu, idx)))\r\n  function makeMenuItem(info: MediaDeviceInfo, close:(did:string) => void, key:number):JSX.Element {\r\n    let selected = false\r\n    selected = info.deviceId === participants.local.devicePreference.videoInputDevice\r\n    const keyStr = String.fromCharCode(65 + key)\r\n\r\n    return <MenuItem key={info.deviceId} onClick={() => { close(info.deviceId) }} >\r\n        { `${keyStr}\\u00A0${(selected ? '🙂\\u00A0' : '\\u00A0\\u00A0\\u2003')}${info.label}` }\r\n      </MenuItem>  //  \\u00A0: NBSP, u2003: EM space.\r\n  }\r\n  function closeVideoMenu(did:string) {\r\n    setStep('none')\r\n    if (did) {\r\n      createLocalCamera(false, did).then((msTrack)=>{\r\n        const content = createContentOfVideo([msTrack.track], map, 'screen', Object(props).xCord, Object(props).yCord, Object(props).from)\r\n        contents.assignId(content)\r\n        msTrack.role = content.id\r\n        contents.getOrCreateContentTracks(conference.rtcConnection.peer, content.id)\r\n        contents.shareContent(content)\r\n        conference.addOrReplaceLocalTrack(msTrack)\r\n      })\r\n    }\r\n  }\r\n\r\n  //  keyboard shortcut\r\n  useEffect(() => {\r\n    const onKeyPress = (e: KeyboardEvent) => {\r\n      if (e.code.substring(0, 3) === 'Key') {\r\n        const keyNum = e.code.charCodeAt(3) - 65\r\n        closeVideoMenu(props.cameras.videos[keyNum]?.deviceId)\r\n      }\r\n    }\r\n    window.addEventListener('keypress', onKeyPress)\r\n\r\n    return () => {\r\n      window.removeEventListener('keypress', onKeyPress)\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  },        [])\r\n\r\n\r\n  return <>\r\n    {videoMenuItems}\r\n  </>\r\n}\r\nCameraSelector.displayName = 'CameraSelector'\r\n","import React, { useEffect } from 'react'\r\nimport {DialogPageProps} from './Step'\r\n\r\n\r\n\r\n\r\ninterface GoogleDriveImportProps extends DialogPageProps{\r\n  onSelectedFile: (text: string) => void\r\n}\r\n\r\nexport const GoogleDriveImport: React.FC<GoogleDriveImportProps> = ({ onSelectedFile }) => {\r\n  // The Browser API key obtained from the Google API Console.\r\n  // Replace with your own Browser API key, or your own key.\r\n  const developerKey = 'AIzaSyAADCXxUujmh0VqXIzJofwl03MA5O8v8EQ'\r\n\r\n  // The Client ID obtained from the Google API Console. Replace with your own Client ID.\r\n  //const clientId = \"858773398697-vki2lito392c5dlss9s31ap077nn0qbd.apps.googleusercontent.com\"\r\n  /* const clientId = \"188672642721-3f8u1671ecugbl2ukhjmb18nv283upm0.apps.googleusercontent.com\" */\r\n\r\n  // Replace with your own project number from console.developers.google.com.\r\n  // See \"Project number\" under \"IAM & Admin\" > \"Settings\"\r\n  //const appId = \"binarual-meet\"\r\n  const appId = \"188672642721\"\r\n\r\n  // Scope to use to access user's Drive items.\r\n  /* const scope = ['https://www.googleapis.com/auth/drive.file'] */\r\n\r\n  let pickerApiLoaded = false\r\n  /* let oauthToken: undefined | string */\r\n\r\n  // Create and render a Picker object for searching images.\r\n  function createPicker(oauthToken:string) {\r\n    if (pickerApiLoaded && oauthToken) {\r\n      const view = new google.picker.DocsView(google.picker.ViewId.DOCS) // LIMIT CONTENT TYPE RESULT\r\n      //view.setMimeTypes(\"image/png,image/jpeg,image/jpg\"); // LIMIT BY MIME TYPE\r\n      const picker = new google.picker.PickerBuilder()\r\n          .enableFeature(google.picker.Feature.NAV_HIDDEN)\r\n          // .enableFeature(google.picker.Feature.MULTISELECT_ENABLED)\r\n          .setAppId(appId)\r\n          .setOAuthToken(oauthToken)\r\n          .addView(view)\r\n          .addView(new google.picker.DocsUploadView())\r\n          .setDeveloperKey(developerKey)\r\n          .setCallback(pickerCallback)\r\n          .build()\r\n        picker.setVisible(true)\r\n    }\r\n  }\r\n\r\n  // A simple callback implementation.\r\n  function pickerCallback(data: google.picker.ResponseObject) {\r\n    if (data.action === google.picker.Action.PICKED) {\r\n      /* const fileId = data.docs[0].id */\r\n      //TODO: if wanted change permissiosn to public but his could be a security issue\r\n      //insertPermission(fileId,undefined,'anyone', 'reader')\r\n      onSelectedFile(data.docs[0].embedUrl)\r\n    }\r\n  }\r\n\r\n    /**\r\n   * Insert a new permission.\r\n   *\r\n   * @param {String} fileId ID of the file to insert permission for.\r\n   * @param {String} value User or group e-mail address, domain name or\r\n   *                       {@code null} \"default\" type.\r\n   * @param {String} type The value \"user\", \"group\", \"domain\" or \"default\".\r\n   * @param {String} role The value \"owner\", \"writer\" or \"reader\".\r\n   */\r\n  /* function insertPermission(fileId:string, value:string | undefined, type:string, role:'owner' | 'writer' | 'reader') {\r\n    var body = { value, type, role}\r\n    if(gapi.client.drive){\r\n      var request = gapi.client.drive.permissions.create({\r\n        fileId,\r\n        'resource': body\r\n      })\r\n      request.execute(function(resp) { console.log({resp}) })\r\n    }else{\r\n      gapi.client.load('drive','v3').then(()=>insertPermission(fileId,value,type,role))\r\n    }\r\n  } */\r\n\r\n\r\n  useEffect(() => {\r\n    if(gapi && window.gapiPickerReady ){\r\n      const token = sessionStorage.getItem('gdriveToken')\r\n      if(token)\r\n      createPicker(token)\r\n    }\r\n  }, /* [gapi,window.gapiPickerReady] */)\r\n\r\n  return <>{'loading...'}</>\r\n}\r\nGoogleDriveImport.displayName = 'GoogleDriveImport'\r\n\r\n\r\n","import Button from '@material-ui/core/Button'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport {DialogPageProps} from './Step'\r\nimport React, {useEffect, useState } from 'react'\r\nimport { MuiThemeProvider, createTheme } from '@material-ui/core/styles'\r\nimport {makeStyles} from '@material-ui/styles'\r\nimport { isSmartphone } from '@models/utils'\r\n\r\nconst theme = createTheme({\r\n  palette: {\r\n    primary: { main: '#7ececc' },\r\n    secondary: { main: '#ef4623' },\r\n  },\r\n});\r\n\r\ninterface InputProps<T> extends DialogPageProps{\r\n  inputField: JSX.Element\r\n  value: T\r\n  type: string\r\n  onFinishInput: (text: T) => void\r\n}\r\n\r\nconst useStyles = makeStyles({\r\n  mainContainer: {\r\n    display: 'flex',\r\n    height: '100%',\r\n    width:'100%',\r\n  },\r\n  menuContainer: {\r\n    position:'relative',\r\n    top:'12px',\r\n    width:'100px',\r\n    height:'100px'\r\n  },\r\n  galleryMain : {\r\n    width:'100%',\r\n    height:'100%',\r\n    minWidth: '440px',\r\n    minHeight:'245px',\r\n    border:'2px dashed #00000030',\r\n    left:'5px'\r\n  },\r\n  gallery: {\r\n    display:'grid',\r\n    gridTemplateColumns: 'repeat(3, 1fr)',\r\n    gap:10,\r\n    overflowY:'scroll',\r\n    overflowX: 'hidden',\r\n    height:'300px',\r\n    alignContent:'flex-start'\r\n  },\r\n  deavticeButtons: {\r\n    position:'relative',\r\n    padding:'10px',\r\n    fontSize:isSmartphone() ? '1.5em' : '1em',\r\n    fontWeight:'bold',\r\n    borderBottom: '2px solid #7ececc',\r\n    color:'#000000',\r\n    cursor: 'pointer',\r\n  },\r\n\r\n  avticeButtons: {\r\n    position:'relative',\r\n    padding:'10px',\r\n    fontSize:isSmartphone() ? '1.5em' : '1em',\r\n    fontWeight:'bold',\r\n    borderBottom:'2px solid #7ececc',\r\n    color:'#ef4623',\r\n    cursor: 'default',\r\n  }\r\n\r\n})\r\n\r\nlet selectedImage:string = ''\r\nexport function getSelectedImage() : string {\r\n  return selectedImage\r\n}\r\n\r\nexport function ResetSelectedImage() {\r\n  selectedImage = ''\r\n}\r\n\r\nexport function Input<T>(props: InputProps<T>) {  // tslint: disable-line\r\n  const {\r\n    setStep,\r\n    value,\r\n    onFinishInput,\r\n    inputField,\r\n  } = props\r\n\r\n\r\n\r\n  /* return (\r\n    <List>\r\n      <ListItem>\r\n        {inputField}\r\n      </ListItem>\r\n      <ListItem>\r\n        <Button\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          onClick={() => {\r\n            onFinishInput(value)\r\n            setStep('none')\r\n          }}\r\n        >\r\n          Done\r\n        </Button>\r\n      </ListItem>\r\n    </List>\r\n  ) */\r\n\r\n  ///////////////////////////\r\n\r\n  const classes = useStyles()\r\n  const [pageIndex, setPageIndex] = useState(0)\r\n\r\n  const [active, setActive] = useState(-1)\r\n\r\n  //console.log(props.type, \" props\")\r\n\r\n\r\n  ///////////////////////////////////////////////////////////\r\n  const [data,setData]=useState('');\r\n  const getData=()=>{\r\n    fetch('folderlist.php?folder=zones/*/*.png')\r\n      .then((response) => response.text())\r\n      .then((response) => setData(response));\r\n    /* let dataStr = \"zones/Floors/Bear Rug - Cyan.png,zones/Floors/Bear Rug - Pink.png,zones/Floors/Rectangle - Yellow.png,zones/Floors/Rug - Cyan.png,zones/Floors/Rug - Pink.png,zones/Floors/Rug - Purple.png,zones/Misc/Plant 1.png,zones/Misc/Plant 2.png,zones/Misc/Plant 3.png,zones/Seats/1 Desk Green.png,zones/Seats/2 Chairs Green.png,zones/Seats/2 Couch with Bear Rug Pink.png,zones/Seats/2 Seats Pink.png,zones/Seats/3 Couch with Bear Rug Cyan.png,zones/Seats/3 Couches Green.png,zones/Seats/4 Conference Table Green.png,zones/Seats/4 Couches Orange.png,zones/Seats/5 Couches Orange.png,zones/Seats/6 Conference Table Green.png,zones/Seats/6 Conference Table Pink.png,zones/Seats/8 Conference Table Green.png,\"\r\n    setData(dataStr) */\r\n  }\r\n  useEffect(()=>{\r\n    getData()\r\n  },[])\r\n\r\n\r\n  //console.log(data, \" data\")\r\n  // format accordingly to folder name\r\n  const folders : Array<string> = []\r\n  const images : Array<string> = []\r\n  let tempArr : string = ''\r\n  let dataFolderWise = data.split(',')\r\n\r\n  for (let i=0; i<dataFolderWise.length-1; i++) {\r\n    //console.log(dataFolderWise[0].split('./')[1].split('/')[1], \" Fname\")\r\n    if(folders.indexOf(dataFolderWise[i].split('/')[1]) === -1) {\r\n      folders.push(dataFolderWise[i].split('/')[1])\r\n      //console.log(dataFolderWise[0].split('./')[1].split('/')[1])\r\n    }\r\n    /* for (var j=0; j < folders.length; j++) {\r\n      if(folders[j] === dataFolderWise[i].split('./')[1].split('/')[1]) {\r\n        //console.log(folders[j], \" >>>>>>>> \", dataFolderWise[i].split('./')[1])\r\n        tempArr.push(dataFolderWise[i].split('./')[1])\r\n      }\r\n      images.push(tempArr)\r\n      console.log(tempArr, \" >>>>>\")\r\n      tempArr.splice(0)\r\n    } */\r\n  }\r\n\r\n\r\n  for (var j=0; j < folders.length; j++) {\r\n    for (let i=0; i<dataFolderWise.length-1; i++) {\r\n    if(folders[j] === dataFolderWise[i].split('/')[1]) {\r\n      tempArr += (dataFolderWise[i]) + ','\r\n      //tempArr.push(dataFolderWise[i].split('./')[1])\r\n    }\r\n  }\r\n  // console.log(tempArr, \" AAAAA\")\r\n  images.push(tempArr)\r\n  tempArr = ''\r\n  }\r\n\r\n\r\n\r\n  //console.log(folders[0], \" Folder \", images[0].split(','))\r\n\r\n  ///////////////////////////////////////////////////////////\r\n  /* const [data,setData]=useState('');\r\n  const getData=()=>{\r\n\r\n    fetch('zones/directory.json',\r\n    {\r\n      headers : {\r\n        'Content-Type': 'application/json',\r\n        'Accept': 'application/json'\r\n       }\r\n    }\r\n    )\r\n      .then(function(response){\r\n        //console.log(response)\r\n        return response.text()\r\n      })\r\n      .then(function(myJson) {\r\n        let d = JSON.parse(myJson)\r\n        let titleArr = []\r\n        for (var i:number=0; i < d.length; i++) {\r\n          let bool = false\r\n          //if(titleArr.length === 0) {\r\n            //titleArr.push(d[i].folder)\r\n          //}\r\n          for (var j:number=0; j < titleArr.length; j++) {\r\n            if(titleArr[j] === d[i].folder) {\r\n              bool = true\r\n            }\r\n          }\r\n          if(bool === false) {\r\n            //titleArr.push(d[i].folder)\r\n            titleArr.push(d[i])\r\n          }\r\n        }\r\n        setData(d)\r\n\r\n        //////////////////////////////////////////////////////////////////////////\r\n        //imgData.push(titleArr)\r\n        //setArrayValue(titleArr)\r\n        //console.log(imgData[0][0].folder)\r\n        //console.log(titleArr[0].folder, \"---\", titleArr[0].url)\r\n        //console.log(d[0].url)\r\n        //console.log(d[0].folder);\r\n        //let d = myJson.replace(/folder/g, '\"folder\"');\r\n        //d = d.replace(/url/g, '\"url\"');\r\n        //d = JSON.parse(d);\r\n        //console.log(d[0].folder)\r\n        //setData(d);\r\n        //setData(myJson)\r\n        /////////////////////////////////////////////////////////////////////\r\n      });\r\n  }\r\n  useEffect(()=>{\r\n    getData()\r\n  },[]) */\r\n  ///////////////////////////////////////////////////////////\r\n\r\n\r\n\r\n\r\n  //let mValue = JSON.parse(data)\r\n  /* if(data !== undefined) {\r\n    console.log(Object(data[0]).folder, \" Array Data\")\r\n  } */\r\n  //console.log(Object(data).length, \" Array Data\")\r\n  //console.log(imgData[0].length)\r\n\r\n\r\n\r\n  /* if(Object(data).length > 0) {\r\n    console.log(Object(data).length, \" Array Data\")\r\n  } */\r\n\r\n\r\n\r\n/*\r\n\r\n  // For Table\r\n  let _TABLES = ['zones/Floors/Bear Rug - Cyan.png', 'zones/Floors/Bear Rug - Pink.png', 'zones/Floors/Rug - Cyan.png', 'zones/Floors/Rectangle - Yellow.png', 'zones/Floors/Rug - Pink.png', 'zones/Floors/Rug - Purple.png']\r\n\r\n  const tableItems = []\r\n  for (let i:number = 0; i < _TABLES.length; i++) {\r\n    tableItems.push(<div onClick = {() => {ActiveThis(i)}}><img src={encodeURIComponent(_TABLES[i])} style={{width:'130px', minHeight:'130px', height:'130px', objectFit:'contain', padding:'2px', border:active === i ? '3px solid #ef4623' : '3px solid #00000020'}} alt='' /><div style={{textAlign:'center', position:'relative', fontWeight:'bold', marginTop:'-5px'}}>{_TABLES[i].split('/')[2].split('.')[0]}</div></div>)\r\n  }\r\n\r\n  // For Chairs\r\n  let _CHAIRS = ['zones/Seats/1 Desk Green.png','zones/Seats/2 Chairs Green.png', 'zones/Seats/2 Couch with Bear Rug Pink.png', 'zones/Seats/2 Seats Pink.png', 'zones/Seats/3 Couch with Bear Rug Cyan.png', 'zones/Seats/3 Couches Green.png', 'zones/Seats/4 Conference Table Green.png', 'zones/Seats/4 Couches Orange.png', 'zones/Seats/5 Couches Orange.png', 'zones/Seats/6 Conference Table Green.png', 'zones/Seats/6 Conference Table Pink.png', 'zones/Seats/8 Conference Table Green.png']\r\n  const chairsItems = []\r\n  for (let i:number = 0; i < _CHAIRS.length; i++) {\r\n    chairsItems.push(<div onClick = {() => {ActiveThis(i)}}><img src={encodeURIComponent(_CHAIRS[i])} style={{width:'130px', minHeight:'130px', height:'130px', objectFit:'contain', flex:1, padding:'2px', border:active === i ? '3px solid #ef4623' : '3px dotted #00000020'}} alt='' /><div style={{textAlign:'center', position:'relative', fontWeight:'bold', marginTop:'-5px'}}>{_CHAIRS[i].split('/')[2].split('.')[0]}</div></div>)\r\n  }\r\n\r\n  // For Carpets\r\n  let _CARPETS = ['zones/Misc/Plant 1.png', 'zones/Misc/Plant 2.png', 'zones/Misc/Plant 3.png']\r\n  const carpetsItems = []\r\n  for (let i:number = 0; i < _CARPETS.length; i++) {\r\n    carpetsItems.push(<div onClick = {() => {ActiveThis(i)}}><img src={encodeURIComponent(_CARPETS[i])} style={{width:'130px', minHeight:'130px', height:'130px', objectFit:'contain', padding:'2px', border:active === i ? '3px solid #ef4623' : '3px dotted #00000020'}} alt='' /><div style={{textAlign:'center', position:'relative', fontWeight:'bold', marginTop:'-5px'}}>{_CARPETS[i].split('/')[2].split('.')[0]}</div></div>)\r\n  }\r\n */\r\n\r\n\r\n  /////////////////////////////////////////////////////////////////////////////\r\n\r\n  //console.log(images, \" images \")\r\n  const _ITEMS = []\r\n  if(images.length > 0 && pageIndex > 0) {\r\n    let imgArr = images[pageIndex-1].split(',')\r\n    for (let i:number = 0; i < imgArr.length-1; i++) {\r\n      _ITEMS.push(<div onClick = {() => {ActiveThis(i)}}><img src={encodeURIComponent(imgArr[i])} style={{width:'130px', minHeight:'130px', height:'130px', objectFit:'contain', padding:'2px', border:active === i ? '3px solid #ef4623' : '3px dotted #00000020'}} alt='' /><div style={{textAlign:'center', position:'relative', fontWeight:'bold', marginTop:'-5px'}}>{imgArr[i].split('/')[2].split('.')[0]}</div></div>)\r\n    }\r\n  }\r\n\r\n  // For All\r\n  /* let _IMGS = []\r\n  const _ITEMS = []\r\n  //console.log(pageIndex, \" pageIndex \", images[0].split(','))\r\n  //for (let i:number = 0; i < images.length; i++) {\r\n  let imgArr = images[pageIndex]\r\n\r\n  console.log(imgArr, \" ARR\")\r\n\r\n  for (let i:number = 0; i < imgArr.length; i++) {\r\n    _ITEMS.push(<div onClick = {() => {ActiveThis(i)}}><img src={encodeURIComponent(imgArr[pageIndex])} style={{width:'130px', minHeight:'130px', height:'130px', objectFit:'contain', padding:'2px', border:active === i ? '3px solid #ef4623' : '3px dotted #00000020'}} alt='' /><div style={{textAlign:'center', position:'relative', fontWeight:'bold', marginTop:'-5px'}}>{imgArr[i].split('/')[2].split('.')[0]}</div></div>)\r\n  } */\r\n\r\n  /////////////////////////////////////////////////////////////////////////////////////\r\n\r\n  // Holding the Images of the menu Items\r\n  /* let _IMAGELIST = []\r\n\r\n  for (var ii:number=0; ii < Object(data).length; ii++) {\r\n    _IMAGELIST.push(Object(data)[ii].url)\r\n  } */\r\n\r\n  /* let menuListImages = []\r\n  for (var k:number=0; k < Object(data).length; k++) {\r\n    for (var l:number=0; l<_IMAGELIST.length; l++) {\r\n      menuListImages.push(<ListItem style={{minWidth:'470px'}}>\r\n      <div className={classes.galleryMain}>\r\n      <div className={classes.gallery}><div id={\"menuImg_\" + l} onClick = {(evt) => {ActiveThis(Number(evt.currentTarget.id.split(\"_\")[1]))}}><img src={encodeURIComponent(_IMAGELIST[l])} style={{width:'130px', minHeight:'130px', height:'130px', objectFit:'contain', padding:'2px', border:active === l ? '3px solid #ef4623' : '3px dotted #00000020'}} alt='' /><div style={{textAlign:'center', position:'relative', fontWeight:'bold', marginTop:'-5px'}}>{_IMAGELIST[l].split('/')[2].split('.')[0]}</div></div></div></div></ListItem>)\r\n    }\r\n  } */\r\n\r\n\r\n\r\n  function EnableThis(_pageIndex:number) {\r\n    //console.log(_pageIndex, \" pageIndex\")\r\n    selectedImage = ''\r\n    setActive(-1)\r\n    setPageIndex(_pageIndex)\r\n  }\r\n\r\n  function ActiveThis(_itemIndex:number) {\r\n    /* if(pageIndex === 1) {\r\n      selectedImage = _TABLES[_itemIndex]\r\n    } else if(pageIndex === 2) {\r\n      selectedImage = _CHAIRS[_itemIndex]\r\n    } else if(pageIndex === 3) {\r\n      selectedImage = _CARPETS[_itemIndex]\r\n    } */\r\n\r\n    let imgArr = images[pageIndex-1].split(',')\r\n    selectedImage = imgArr[_itemIndex]\r\n    setActive(_itemIndex)\r\n  }\r\n\r\n  //const menuList = []\r\n  //for (var i:number=0; i < Object(data).length; i++) {\r\n    //console.log(Object(data[i]).id)\r\n    /* menuList.push(<div className={pageIndex === Object(data[menuId]).id ? classes.avticeButtons : classes.deavticeButtons} onClick = {() => {EnableThis(Object(data[menuId]).id)}}>{Object(data[menuId]).folder}</div>) */\r\n    //menuList.push(<div id={'menu_'+(i+1)} data-div_id={i+1} className={pageIndex === Object(data[i]).id ? classes.//avticeButtons : classes.deavticeButtons} onClick = {(evt) => {EnableThis(Number(evt.currentTarget.id.split(\"_\")[1]))/* EnableThis(Object(data[i]).id) */}}>{Object(data[i]).folder}</div>)\r\n  //}\r\n\r\n\r\n  return (\r\n    <div className={classes.mainContainer} /* style={{display: 'flex', height: '100%', width:'100%'}} */>\r\n      {props.type === 'zoneimage' ?\r\n      <div className={classes.menuContainer} /* style={{position:'relative', top:'12px', width:'100px', height:'100px'}} */>\r\n         <div className={pageIndex === 0 ? classes.avticeButtons : classes.deavticeButtons} onClick = {() => {EnableThis(0)}}>Upoad</div>\r\n       {/* <div className={pageIndex === 1 ? classes.avticeButtons : classes.deavticeButtons} onClick = {() => {EnableThis(1)}}>Floor</div>\r\n        <div className={pageIndex === 2 ? classes.avticeButtons : classes.deavticeButtons} onClick = {() => {EnableThis(2)}}>Seats</div>\r\n        <div className={pageIndex === 3 ? classes.avticeButtons : classes.deavticeButtons} onClick = {() => {EnableThis(3)}}>Misc</div> */}\r\n\r\n      {folders.map((items, index) => {\r\n        return (\r\n          <div className={pageIndex === index+1 ? classes.avticeButtons : classes.deavticeButtons} onClick = {() => {EnableThis(index+1)}}>{items}</div>\r\n        );\r\n      })}\r\n\r\n        {/* <div className={pageIndex === 0 ? classes.avticeButtons : classes.deavticeButtons} onClick = {() => {EnableThis(0)}}>Upoad</div>\r\n        {menuList} */}\r\n      </div> : ''}\r\n\r\n    <List>\r\n\r\n    {pageIndex === 0 ?\r\n      <ListItem style={props.type === 'zoneimage' ? {minWidth:'470px', height:'320px'} : {minWidth:'540px', height:'320px'} }>\r\n        {inputField}\r\n      </ListItem>\r\n      : pageIndex >= 1 && props.type === 'zoneimage' ?\r\n      <ListItem style={{minWidth:'470px'}}>\r\n        <div className={classes.galleryMain}>\r\n        <div className={classes.gallery}>\r\n          {_ITEMS}\r\n        </div>\r\n      </div>\r\n      </ListItem>\r\n      /* : pageIndex === 2 && props.type === 'zoneimage' ?\r\n      <ListItem style={{minWidth:'470px'}}>\r\n        <div className={classes.galleryMain}>\r\n        <div className={classes.gallery}>\r\n          {chairsItems}\r\n        </div>\r\n      </div>\r\n      </ListItem>  : pageIndex === 3 && props.type === 'zoneimage' ?\r\n      <ListItem style={{minWidth:'470px'}}>\r\n        <div className={classes.galleryMain}>\r\n        <div className={classes.gallery}>\r\n          {carpetsItems}\r\n        </div>\r\n      </div>\r\n      </ListItem> */ : ''}\r\n\r\n      <ListItem>\r\n      <MuiThemeProvider theme={theme}>\r\n        <Button\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          style={{fontSize: isSmartphone() ? '1.5em' : '1em'}}\r\n          onClick={() => {\r\n            //if(pageIndex === 0) {\r\n              onFinishInput(value)\r\n            //} else {\r\n              //addInlineGraphics()\r\n            //}\r\n            setStep('none')\r\n          }}\r\n        >\r\n          Done\r\n        </Button>\r\n        </MuiThemeProvider>\r\n      </ListItem>\r\n    </List>\r\n    </div>\r\n  )\r\n\r\n  ///////////////////////////\r\n\r\n}\r\nInput.displayName = 'Input'\r\n","import {useTranslation} from '@models/locales'\r\nimport {createContentOfImage, createContentOfImageUrl} from '@stores/sharedContents/SharedContentCreator'\r\nimport sharedContents from '@stores/sharedContents/SharedContents'\r\nimport {DropzoneArea} from 'material-ui-dropzone'\r\nimport React, {useState, useEffect} from 'react'\r\nimport {DialogPageProps} from './Step'\r\nimport {Input} from './Input'\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Radio from \"@material-ui/core/Radio\";\r\nimport RadioGroup from \"@material-ui/core/RadioGroup\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport FormLabel from \"@material-ui/core/FormLabel\";\r\n\r\nimport {Step} from './Step'\r\nimport {makeStyles} from '@material-ui/styles'\r\nimport { getSelectedImage } from './Input'\r\nimport { ResetSelectedImage } from './Input'\r\n\r\nconst useStyles = makeStyles({\r\n  preview: {\r\n    width: '100%',\r\n    height: '100%',\r\n  },\r\n  dZoneStyle : {\r\n    minHeight: '300px',\r\n  },\r\n  dZoneTextStyle: {\r\n    minHeight: '90px',\r\n  },\r\n})\r\n\r\n\r\ninterface ImageInputProps extends DialogPageProps{\r\n  type:Step\r\n  xCord:number\r\n  yCord:number\r\n  from:string\r\n}\r\n\r\nexport const ImageInput: React.FC<ImageInputProps> = (props) => {\r\n  const {\r\n    setStep,\r\n  } = props\r\n\r\n  const classes = useStyles()\r\n  const [files, setFiles] = useState<File[]>([])\r\n  const [uploadType, setUploadType] = useState<\"gyazo\" | \"gdrive\">(sessionStorage.getItem(\"uploadTypePreferences\") as \"gyazo\" | \"gdrive\" || \"gyazo\")\r\n\r\n  const {t} = useTranslation()\r\n  const field = (\r\n    <DropzoneArea\r\n      /* acceptedFiles={['image/*']}\r\n      dropzoneText={t('imageDropzoneText')}\r\n      onChange={setFiles} */\r\n      acceptedFiles={['image/*']}\r\n      dropzoneText={t('imageDropzoneText')}\r\n      dropzoneClass = {classes.dZoneStyle}\r\n      dropzoneParagraphClass = {classes.dZoneTextStyle}\r\n      onChange={setFiles}\r\n      previewGridProps={{container: { spacing: 1, direction: 'row' }}}\r\n      previewChipProps={{classes: { root: classes.preview } }}\r\n    />\r\n  )\r\n\r\n  /* const authGoogleDrive = ()=>{\r\n    window.authorizeGdrive && window.authorizeGdrive((authResult: GoogleApiOAuth2TokenObject)=>{\r\n      console.log(authResult);\r\n      if (authResult && !authResult.error) {\r\n        const oauthToken = authResult.access_token\r\n        sessionStorage.setItem('gdriveToken',oauthToken)\r\n      }\r\n      else {\r\n        setUploadType('gyazo')\r\n        alert('Error authenticating Google Drive')\r\n      }\r\n    })\r\n  } */\r\n\r\n  useEffect(() => {\r\n    sessionStorage.setItem(\"uploadTypePreferences\", uploadType);\r\n  }, [uploadType]);\r\n\r\n\r\n  const map = props.stores.map\r\n\r\n  return (\r\n    <>\r\n      <Box mt={0}>\r\n        <FormControl component=\"fieldset\">\r\n          <FormLabel component=\"legend\">File storage type:</FormLabel>\r\n          <RadioGroup style={{display:\"flex\", flexDirection:\"row\"}}\r\n            aria-label=\"upload-files-to\"\r\n            defaultValue=\"gyazo\"\r\n            value={uploadType}\r\n            name=\"upload-files-to\"\r\n            onChange={(e) => {\r\n              setUploadType(e.target.value as typeof uploadType);\r\n              //e.target.value === \"gdrve\" && authGoogleDrive();\r\n            }}\r\n          >\r\n            <FormControlLabel value=\"gyazo\" control={<Radio />} label=\"Gyazo\" />\r\n            <FormControlLabel\r\n              value=\"gdrve\"\r\n              control={<Radio />}\r\n              label=\"Google Drive\"\r\n            />\r\n          </RadioGroup>\r\n        </FormControl>\r\n      </Box>\r\n\r\n      <Input\r\n        stores={props.stores}\r\n        setStep={setStep}\r\n        onFinishInput={(files) => {\r\n          // TODO modify store\r\n          if(getSelectedImage() === '') {\r\n            files.forEach(async (file, i) => {\r\n              const IMAGE_OFFSET_X = 30;\r\n              const IMAGE_OFFSET_Y = -20;\r\n              createContentOfImage(file, map, [\r\n                IMAGE_OFFSET_X * i,\r\n                IMAGE_OFFSET_Y * i\r\n              ], uploadType, props.type, props.xCord, props.yCord, props.from, ''\r\n              ).then((imageContent) =>\r\n                sharedContents.shareContent(imageContent)\r\n              );\r\n            });\r\n          } else {\r\n            createContentOfImageUrl(getSelectedImage(), map, [0, 0], props.type, props.xCord, props.yCord, props.from, '').then(\r\n              imageContent => sharedContents.shareContent(imageContent))\r\n            ResetSelectedImage()\r\n          }\r\n        }}\r\n        value={files}\r\n        inputField={field}\r\n        type={props.type}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import Button from '@material-ui/core/Button'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport React from 'react'\r\n/* import {DialogPageProps} from './DialogPage' */\r\nimport {DialogPageProps} from './Step'\r\nimport { MuiThemeProvider, createTheme } from '@material-ui/core/styles'\r\nimport { isSmartphone } from '@models/utils'\r\n\r\nconst theme = createTheme({\r\n  palette: {\r\n    primary: { main: '#7ececc' },\r\n    secondary: { main: '#ef4623' }\r\n  }\r\n});\r\n\r\ninterface SettingInputProps<T> extends DialogPageProps{\r\n  inputField: JSX.Element\r\n  value: T\r\n  onFinishInput: (text: T) => void\r\n}\r\n\r\nexport function SettingInput<T>(props: SettingInputProps<T>) {  // tslint: disable-line\r\n  const {\r\n    setStep,\r\n    value,\r\n    onFinishInput,\r\n    inputField,\r\n  } = props\r\n\r\n  return (\r\n    <List>\r\n      <ListItem>\r\n        {inputField}\r\n      </ListItem>\r\n      <ListItem>\r\n      <MuiThemeProvider theme={theme}>\r\n        <Button\r\n        style={{fontSize:isSmartphone() ? '2em' : '1em'}}\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          onClick={() => {\r\n            onFinishInput(value)\r\n            setStep('none')\r\n          }}\r\n        >\r\n          Done\r\n        </Button>\r\n        </MuiThemeProvider>\r\n      </ListItem>\r\n    </List>\r\n  )\r\n}\r\nSettingInput.displayName = 'SettingInput'\r\n","import {useTranslation} from '@models/locales'\r\nimport {createContentOfImage} from '@stores/sharedContents/SharedContentCreator' // createRoomImageDesc,\r\nimport sharedContents from '@stores/sharedContents/SharedContents'\r\nimport {DropzoneArea} from 'material-ui-dropzone'\r\nimport React, {useEffect, useState} from 'react'\r\n/* import {DialogPageProps} from './DialogPage' */\r\nimport {DialogPageProps} from './Step'\r\nimport {SettingInput} from './SettingInput'\r\nimport {Step} from './Step'\r\nimport {makeStyles} from '@material-ui/styles'\r\nimport TextField from '@material-ui/core/TextField'\r\nimport contents from '@stores/sharedContents/SharedContents'\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\nimport { isSmartphone } from '@models/utils'\r\n\r\nconst useStyles = makeStyles({\r\n  preview: {\r\n    width: '100%',\r\n    height: '100%',\r\n    top: '-20em',\r\n  },\r\n  dropZoneTitle: {\r\n    fontSize:isSmartphone() ? '2em' : '1em'\r\n  }\r\n})\r\n\r\ninterface SettingImageInputProps extends DialogPageProps{\r\n  type:Step\r\n  xCord:number\r\n  yCord:number\r\n  from:string\r\n}\r\n\r\n\r\nexport const SettingImageInput: React.FC<SettingImageInputProps> = (props) => {\r\n  const {\r\n    setStep,\r\n  } = props\r\n\r\n  const classes = useStyles()\r\n  const [files, setFiles] = useState<File[]>([])\r\n  const [desc, setDesc] = useState<string>('')\r\n  const [reset, setReset] = useState(false)\r\n\r\n  const [uploadType/* , setUploadType */] = useState<\"gyazo\" | \"gdrive\">(sessionStorage.getItem(\"uploadTypePreferences\") as \"gyazo\" | \"gdrive\" || \"gyazo\")\r\n\r\n  // Filtering the imagepath\r\n  //console.log(contents.all)\r\n  let uploadedPath:string = ''\r\n  let descText:string = ''\r\n\r\n  contents.all.filter(item => item.shareType===\"roomimg\").map(content => (\r\n    uploadedPath = content.url\r\n  ))\r\n  contents.all.filter(item => item.shareType===\"roomimg\").map(content => (\r\n    descText = content.contentDesc\r\n  ))\r\n\r\n  if(reset) {}\r\n\r\n  //console.log(uploadedPath.toString(), \" path\")\r\n\r\n  const {t} = useTranslation()\r\n  const field = (\r\n    <DropzoneArea\r\n      acceptedFiles={['image/*']}\r\n      initialFiles={[\r\n        //uploadedPath\r\n      ]}\r\n      clearOnUnmount={false}\r\n      dropzoneText={t('imageDropzoneText')}\r\n      dropzoneParagraphClass={classes.dropZoneTitle}\r\n      onChange={setFiles}\r\n      filesLimit = {1}\r\n      previewGridProps={{container: { spacing: 1, direction: 'row' }}}\r\n      previewChipProps={{classes: { root: classes.preview } }}\r\n    />\r\n  )\r\n\r\n  useEffect(() => {\r\n    sessionStorage.setItem(\"uploadTypePreferences\", uploadType);\r\n  }, [uploadType]);\r\n\r\n  const map = props.stores.map\r\n\r\n\r\n  function onDeleteClick() {\r\n    //console.log(\"Delete Click\")\r\n    contents.all.filter(item => item.shareType===\"roomimg\").map(content => (\r\n      contents.removeByLocal(content.id)\r\n    ))\r\n    setDesc('')\r\n    setReset(true)\r\n  }\r\n\r\n  return (\r\n    <div>\r\n    <TextField label={t('meetingDesc')} multiline={true} rowsMax={4} defaultValue={descText}\r\n    InputProps={{ style: { fontSize:isSmartphone() ? '2.2em' : '1em' } }}\r\n    InputLabelProps={{ style: { fontSize:isSmartphone() ? '2.2em' : '1em' } }}\r\n    style={{position:'relative', marginLeft:15, width:'94%', marginTop:'-10px', fontWeight:'bold'}}\r\n    onChange={event => {\r\n      setDesc(event.target.value)\r\n      event.preventDefault()\r\n    }}/>\r\n    <div style={uploadedPath !== '' ? {position:'absolute', height:'90px', top:'20px', right:'20px', overflow:'hidden', display:'block'} : {display:'none'}}>\r\n      <img style={{height:'60px', position:'relative'}} src={uploadedPath} alt=''/>\r\n        <DeleteIcon style={{position:'relative', left:isSmartphone() ? '10px' : '0px', width:isSmartphone() ? '60' : '35', height:isSmartphone() ? '60' : '35'}} color='secondary' onClick={onDeleteClick}/>\r\n    </div>\r\n    <div>\r\n\r\n    </div>\r\n    <SettingInput stores={props.stores}\r\n      setStep={setStep}\r\n      onFinishInput={(files) => {\r\n        // TODO modify store\r\n        files.forEach(async (file, i) => {\r\n\r\n          //console.log(\"done\", desc)\r\n          const IMAGE_OFFSET_X = 30\r\n          const IMAGE_OFFSET_Y = -20\r\n\r\n          // Set desc and image for the room\r\n          //createRoomImageDesc(file, desc)\r\n          //console.log(\"DESC in upload - \", desc)\r\n          //setReset(false)\r\n\r\n          createContentOfImage(file, map, [IMAGE_OFFSET_X * i, IMAGE_OFFSET_Y * i], uploadType, props.type, props.xCord, props.yCord, props.from, desc).then(\r\n            imageContent => sharedContents.shareContent(imageContent))\r\n        })\r\n      }}\r\n      value={files}\r\n      inputField={field}\r\n      />\r\n      </div>\r\n  )\r\n}\r\n","import {BMProps} from '@components/utils'\r\n/* import bxWindowClose from '@iconify-icons/bx/bx-window-close'\r\nimport clipboardPaste from '@iconify/icons-fluent/clipboard-arrow-right-24-regular'\r\nimport whiteboard24Regular from '@iconify/icons-fluent/whiteboard-24-regular'\r\nimport cursorDefaultOutline from '@iconify/icons-mdi/cursor-default-outline'\r\nimport {Icon} from '@iconify/react'\r\nimport Collapse from '@material-ui/core/Collapse' */\r\nimport Divider from '@material-ui/core/Divider'\r\nimport FormControl from '@material-ui/core/FormControl'\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\r\nimport List from '@material-ui/core/List'\r\n/* import ListItem from '@material-ui/core/ListItem' */\r\nimport Radio from '@material-ui/core/Radio'\r\nimport RadioGroup from '@material-ui/core/RadioGroup'\r\n/* import CameraAltIcon from '@material-ui/icons/CameraAlt'\r\nimport ExpandLess from '@material-ui/icons/ExpandLess'\r\nimport ExpandMore from '@material-ui/icons/ExpandMore'\r\nimport DownloadIcon from '@material-ui/icons/GetApp'\r\nimport HttpIcon from '@material-ui/icons/Http' */\r\nimport ImageIcon from '@material-ui/icons/Image'\r\n/* import InsertDriveFileTwoTone from '@material-ui/icons/InsertDriveFileTwoTone';\r\nimport UploadIcon from '@material-ui/icons/Publish' */\r\nimport ScreenShareIcon from '@material-ui/icons/ScreenShare'\r\n/* import StopScreenShareIcon from '@material-ui/icons/StopScreenShare' */\r\nimport SubjectIcon from '@material-ui/icons/Subject'\r\n/* import {contentsToSave, loadToContents} from '@models/ISharedContent' */\r\nimport {useTranslation} from '@models/locales'\r\nimport {isSmartphone, MSTrack} from '@models/utils'\r\nimport {/* createContent,  */createContentFromText, createContentOfIframe, createContentOfText,\r\n  createContentOfVideo} from '@stores/sharedContents/SharedContentCreator'\r\n/* import {SharedContents} from '@stores/sharedContents/SharedContents' */\r\n/* import {isArray} from 'lodash' */\r\nimport {Observer, useObserver} from 'mobx-react-lite'\r\nimport React, {useEffect/* , useRef */} from 'react'\r\nimport {CameraSelectorMember} from './CameraSelector'\r\nimport {DialogIconItem} from '@components/utils/DialogIconItem'\r\nimport {Step} from './Step'\r\nimport {conference} from '@models/conference'\r\n/* import { dateTimeString } from '@models/utils/date' */\r\n\r\nfunction startCapture(props:BMProps) {\r\n  const fps = props.stores.contents.screenFps\r\n  return new Promise<MediaStream>((resolve, reject) => {\r\n    navigator.mediaDevices.getDisplayMedia({\r\n      audio:true,\r\n      video:{\r\n        frameRate:{\r\n          ideal: fps\r\n        }\r\n      }\r\n    }).then(resolve).catch(reject)\r\n  })\r\n}\r\n\r\n/* function downloadItems(contents:SharedContents) {\r\n  const content = JSON.stringify(contentsToSave(contents.all))\r\n  const blob = new Blob([content], {type: 'text/plain'})\r\n\r\n  const a = document.createElement('a')\r\n  const url = URL.createObjectURL(blob)\r\n  a.href = url\r\n  a.download = `BMC_${conference.room}_${dateTimeString()}.json`\r\n  document.body.appendChild(a)\r\n  a.click()\r\n  setTimeout(() => {\r\n    document.body.removeChild(a)\r\n    window.URL.revokeObjectURL(url)\r\n  },         0)\r\n} */\r\n\r\n/* function importItems(ev: React.ChangeEvent<HTMLInputElement>, contents: SharedContents) {\r\n  const files = ev.currentTarget?.files\r\n  if (files && files.length) {\r\n    files[0].text().then((text) => {\r\n      const itemsRecv = JSON.parse(text)\r\n      if (isArray(itemsRecv)) {\r\n        const items = loadToContents(itemsRecv)\r\n        items.forEach(content => {\r\n          if (content.type === 'screen' || content.type === 'camera') { return }\r\n          const newContent = createContent()\r\n          Object.assign(newContent, content)\r\n          contents.addLocalContent(newContent)\r\n        })\r\n      }\r\n    })\r\n  }\r\n} */\r\n\r\ninterface ShareMenuProps extends DialogPageProps, BMProps {\r\n  cameras: CameraSelectorMember\r\n}\r\n\r\nexport interface DialogPageProps extends BMProps {\r\n  setStep: (step: Step) => void\r\n}\r\n\r\nexport const ShareMenu: React.FC<ShareMenuProps> = (props) => {\r\n  const {t} = useTranslation()\r\n  const {contents, participants, map} = props.stores\r\n  /* const mainScreen = useObserver(() => (\r\n    {stream: contents.mainScreenStream, owner: contents.mainScreenOwner})) */\r\n  const showMouse = useObserver(() => participants.local.mouse.show)\r\n  /* const fileInput = useRef<HTMLInputElement>(null) */\r\n  /* const [openMore, setOpenMore] = React.useState(false) */\r\n\r\n  //  for CameraSelector\r\n  function updateDevices() {\r\n    navigator.mediaDevices.enumerateDevices().then((infos) => {\r\n      props.cameras.videos = infos.filter(info => info.kind === 'videoinput')\r\n    })\r\n    .catch(() => { console.warn('Device enumeration error') })\r\n  }\r\n  function setStep(step: Step) {\r\n    if (step === 'camera'){\r\n      updateDevices()\r\n    }\r\n    props.setStep(step)\r\n  }\r\n\r\n  //  menu handlers\r\n  /* const importFile = () => {\r\n    fileInput.current?.click()\r\n  } */\r\n  /* const downloadFile = () => {\r\n    setStep('none')\r\n    downloadItems(contents)\r\n  } */\r\n  const createText = () => {\r\n    //  setStep('text')\r\n    setStep('none')\r\n    const tc = createContentOfText('', map, Object(props).cordX, Object(props).cordY, Object(props).origin)\r\n    contents.shareContent(tc)\r\n    contents.setEditing(tc.id)\r\n  }\r\n  const createFromClipboard = () => {\r\n    setStep('none')\r\n    navigator.clipboard.readText().then(str => {\r\n      createContentFromText(str, map, Object(props).cordX, Object(props).cordY, Object(props).origin).then(c => {\r\n        contents.shareContent(c)\r\n      })\r\n    })\r\n  }\r\n  const createWhiteboard = () => {\r\n    setStep('none')\r\n    let rand = new Uint32Array(4)\r\n    rand = window.crypto.getRandomValues(rand)\r\n    let randStr = ''\r\n    rand.forEach(i => randStr += i.toString(16))\r\n    createContentOfIframe(\r\n      `https://wbo.ophir.dev/boards/BinauralMeet_${conference.room}_${randStr}`, map, Object(props).cordX, Object(props).cordY, Object(props).origin).then((c) => {\r\n      contents.shareContent(c)\r\n       contents.setEditing(c.id)\r\n    })\r\n  }\r\n  const createScreen = () => {\r\n    startCapture(props).then((ms) => {\r\n      if (ms.getTracks().length) {\r\n        const content = createContentOfVideo(ms.getTracks(), map, 'screen', Object(props).cordX, Object(props).cordY, Object(props).origin)\r\n        contents.assignId(content)\r\n        contents.getOrCreateContentTracks(conference.rtcConnection.peer, content.id)\r\n        contents.shareContent(content)\r\n        ms.getTracks().forEach((track) => {\r\n          const msTrack:MSTrack = {\r\n            track,\r\n            peer: conference.rtcConnection.peer,\r\n            role: content.id\r\n          }\r\n          conference.addOrReplaceLocalTrack(msTrack)\r\n        })\r\n      }\r\n    })\r\n    setStep('none')\r\n  }\r\n  const startMouse = () => {\r\n    participants.local.mouse.show = !showMouse\r\n    setStep('none')\r\n  }\r\n  const closeAllScreens = () => {\r\n    const cids = contents.getLocalRtcContentIds()\r\n    cids.forEach(cid => contents.removeByLocal(cid))\r\n    setStep('none')\r\n  }\r\n  /* const screenAsBackgrouond = () => {\r\n    if (contents.mainScreenOwner === participants.localId){\r\n      conference.removeLocalTrackByRole('mainScreen')\r\n    } else {\r\n      startCapture(props).then((ms) => {\r\n        if (ms.getTracks().length) {\r\n          ms.getTracks().forEach((track) => {\r\n            const msTrack:MSTrack = {\r\n              track,\r\n              peer: conference.rtcConnection.peer,\r\n              role: 'mainScreen'\r\n            }\r\n            conference.addOrReplaceLocalTrack(msTrack)\r\n            contents.mainScreenOwner = participants.localId\r\n            contents.mainScreenStream = ms\r\n          })\r\n        }\r\n      })\r\n    }\r\n    setStep('none')\r\n  } */\r\n\r\n  //  keyboard shortcut\r\n  useEffect(() => {\r\n    const onKeyPress = (e: KeyboardEvent) => {\r\n      if (map.keyInputUsers.has('shareDialog')) {\r\n        if (e.code === 'KeyI') {\r\n         /*  importFile() */\r\n        }else if (e.code === 'KeyD') {\r\n         /*  downloadFile() */\r\n        }else if (e.code === 'KeyV') {\r\n          createFromClipboard()\r\n        }else if (e.code === 'KeyF') {\r\n          e.preventDefault()\r\n          setStep('iframe')\r\n        }else if (e.code === 'KeyT') {\r\n          e.preventDefault()\r\n          createText()\r\n        }else if (e.code === 'KeyG') {\r\n          e.preventDefault()\r\n          setStep('image')\r\n        }else if (e.code === 'KeyW') {\r\n          e.preventDefault()\r\n          createWhiteboard()\r\n        }else if (e.code === 'KeyB') {\r\n          /* screenAsBackgrouond() */\r\n        }else if (e.code === 'KeyS') {\r\n          createScreen()\r\n        }else if (e.code === 'KeyM') {\r\n          startMouse()\r\n        }else if (e.code === 'KeyC') {\r\n          setStep('camera')\r\n        }else if (e.code === 'KeyL') {\r\n          closeAllScreens()\r\n        }\r\n      }\r\n    }\r\n    window.addEventListener('keypress', onKeyPress)\r\n\r\n    return () => {\r\n      window.removeEventListener('keypress', onKeyPress)\r\n    }\r\n    //  eslint-disable-next-line react-hooks/exhaustive-deps\r\n  },        [])\r\n\r\n\r\n  return (\r\n    <List>{/*\r\n      <DialogIconItem\r\n        tip = {t('sharePasteTip')}\r\n        key=\"paste\" text={t('sharePaste')} icon={<Icon icon={clipboardPaste} style={{fontSize:'1.5rem'}} />}\r\n         onClick={createFromClipboard}\r\n      />\r\n      <DialogIconItem\r\n        tip = {t('shareImageTip')}\r\n        key=\"shareImage\" text={t('shareImage')} icon={<ImageIcon />} onClick={() => setStep('image')}\r\n      />\r\n      <DialogIconItem\r\n        key=\"shareText\" text={t('shareText')} icon={<SubjectIcon />} onClick={createText}\r\n      />\r\n      <DialogIconItem\r\n        tip = {t('shareWhiteboardTip')}\r\n        key=\"shareWhiteboard\" text={t('shareWhiteboard')} icon={<Icon icon={whiteboard24Regular} style={{fontSize:'1.5rem'}} />}\r\n         onClick={createWhiteboard}\r\n      />\r\n\r\n      <Divider />\r\n      <DialogIconItem\r\n        tip = {t('shareMouseTip')}\r\n        key=\"shareMouse\"\r\n        icon={<Icon icon={cursorDefaultOutline} style={{fontSize:'1.5rem'}}/>}\r\n        text={showMouse ?  t('stopMouse') : t('shareMouse')}\r\n        onClick={() => {\r\n          participants.local.mouse.show = !showMouse\r\n          setStep('none')\r\n        }}\r\n      />\r\n      <DialogIconItem key=\"shareCamera\" text={t('shareCamera')} icon={<CameraAltIcon />}\r\n        onClick={() => setStep('camera')}\r\n      />\r\n      <DialogIconItem\r\n        tip = {t('shareScreenContentTip')}\r\n        key=\"shareScreenContent\"\r\n        icon={<ScreenShareIcon />}\r\n        text={t('shareScreenContent')}\r\n        onClick={createScreen}\r\n        secondEl = {<FormControl component=\"fieldset\">\r\n          <Observer>{\r\n            ()=> <RadioGroup row aria-label=\"screen-fps\" name=\"FPS\" value={props.stores.contents.screenFps}\r\n              onChange={(ev)=>{ props.stores.contents.setScreenFps(Number(ev.target.value)) }}\r\n              onClick={(ev)=>{\r\n                ev.stopPropagation()\r\n                setTimeout(createScreen, 100)\r\n              }}\r\n            >\r\n              <FormControlLabel value={1} control={<Radio />} label=\"1\" />\r\n              <FormControlLabel value={5} control={<Radio />} label=\"5\" />\r\n              <FormControlLabel value={15} control={<Radio />} label=\"15\" />\r\n              <FormControlLabel value={30} control={<Radio />} label=\"30\" />\r\n              <FormControlLabel value={60} control={<Radio />}\r\n                label={<span>60&nbsp;&nbsp;&nbsp;&nbsp;{t('fps')}</span>} />\r\n            </RadioGroup>\r\n          }</Observer>\r\n        </FormControl>}\r\n      />\r\n      {contents.getLocalRtcContentIds().length ?\r\n        <div style={{paddingLeft:'1em'}}><DialogIconItem dense key = \"stopScreen\"\r\n          icon={<Icon icon={bxWindowClose} style={{fontSize:'1.5rem'}}/>}\r\n          text={t('stopScreen')}\r\n          onClick={closeAllScreens}\r\n          /></div> : undefined}\r\n      <Divider />\r\n      <ListItem button dense onClick={()=>{ setOpenMore(!openMore) }}>\r\n        {openMore ? <ExpandLess /> : <ExpandMore />}\r\n      </ListItem>\r\n      <input type=\"file\" accept=\"application/json\" ref={fileInput} style={{display:'none'}}\r\n        onChange={\r\n          (ev) => {\r\n            setStep('none')\r\n            importItems(ev, contents)\r\n          }\r\n        }\r\n      />\r\n      <Collapse in={openMore} timeout=\"auto\" unmountOnExit>\r\n        <div style={{paddingLeft:'1em'}}>\r\n          <DialogIconItem\r\n            tip = {t('shareIframeTip')}\r\n            key=\"shareIframe\" text={t('shareIframe')} icon={<HttpIcon />} onClick={() => setStep('iframe')}\r\n          />\r\n          <DialogIconItem\r\n            key=\"shareScreenBackground\"\r\n            icon={mainScreen.owner === participants.localId ? <StopScreenShareIcon /> : <ScreenShareIcon />}\r\n            text={mainScreen.owner === participants.localId ? t('stopScreenBackground') : t('shareScreenBackground')}\r\n            onClick={screenAsBackgrouond}\r\n          />\r\n          <Divider />\r\n          <DialogIconItem\r\n            key=\"shareImport\" text={t('shareImport')} icon={<UploadIcon />} onClick={importFile}\r\n            tip = {t('shareImportTip')}\r\n          />\r\n          <DialogIconItem\r\n            key=\"shareDownload\" text={t('shareDownload')} icon={<DownloadIcon />} onClick={downloadFile}\r\n          />\r\n\r\n        </div>\r\n      </Collapse> */}\r\n      <DialogIconItem\r\n        tip = {t('shareImageTip')}\r\n        key=\"shareImage\" text={t('shareImage')} icon={<ImageIcon style={isSmartphone() ? {width:'2em', height:'2em'} : {width:'1em', height:'1em'}} />} onClick={() => setStep('image')}\r\n      />\r\n      {/* <ShareDialogItem\r\n        tip = {t('shareGDriveTip')}\r\n        key=\"shareGDrive\" text={t('shareGDrive')} icon={<InsertDriveFileTwoTone />} onClick={() => setStep('Gdrive')}\r\n      /> */}\r\n      <DialogIconItem\r\n        key=\"shareText\" text={t('shareText')} icon={<SubjectIcon  style={isSmartphone() ? {width:'2em', height:'2em'} : {width:'1em', height:'1em'}} />} onClick={createText}\r\n      />\r\n      <DialogIconItem\r\n        tip = {t('shareScreenContentTip')}\r\n        key=\"shareScreenContent\"\r\n        icon={<ScreenShareIcon  style={isSmartphone() ? {width:'2em', height:'2em'} : {width:'1em', height:'1em'}} />}\r\n        text={t('shareScreenContent')}\r\n        onClick={createScreen}\r\n        secondEl = {<FormControl style={isSmartphone() ? {transform:'scale(1.5)', marginLeft:'2em'} : {transform:'scale(1)', marginLeft:'0em'}} component=\"fieldset\">\r\n          <Observer>{\r\n            ()=> <RadioGroup row aria-label=\"screen-fps\" name=\"FPS\" value={props.stores.contents.screenFps}\r\n              onChange={(ev)=>{ props.stores.contents.setScreenFps(Number(ev.target.value)) }}\r\n              onClick={(ev)=>{\r\n                ev.stopPropagation()\r\n                setTimeout(createScreen, 100)\r\n              }}\r\n            >\r\n              <FormControlLabel value={1} control={<Radio />} label=\"1\" />\r\n              <FormControlLabel value={5} control={<Radio />} label=\"5\" />\r\n              <FormControlLabel value={15} control={<Radio />} label=\"15\" />\r\n              <FormControlLabel value={30} control={<Radio />} label=\"30\" />\r\n              <FormControlLabel value={60} control={<Radio />}\r\n                label={<span>60&nbsp;&nbsp;&nbsp;&nbsp;{t('fps')}</span>} />\r\n            </RadioGroup>\r\n          }</Observer>\r\n        </FormControl>}\r\n      />\r\n      <Divider />\r\n      <DialogIconItem\r\n        tip = {t('shareImageTip')}\r\n        key=\"shareZoneImage\" text={t('shareZoneImage')} icon={<ImageIcon  style={isSmartphone() ? {width:'2em', height:'2em'} : {width:'1em', height:'1em'}} />} onClick={() => setStep('zoneimage')}\r\n      />\r\n       <Divider />\r\n    </List>\r\n  )\r\n}\r\nShareMenu.displayName = 'ShareMenu'\r\n","import TextField from '@material-ui/core/TextField'\r\nimport React, {useState} from 'react'\r\nimport {DialogPageProps} from './Step'\r\nimport {Input} from './Input'\r\n\r\ninterface TextInputProps extends DialogPageProps{\r\n  onFinishInput: (text: string) => void\r\n  textLabel?: string\r\n  defaultValue?: string\r\n  multiline?: boolean\r\n  type: string\r\n}\r\n\r\nexport const TextInput: React.FC<TextInputProps> = (props) => {\r\n  const {\r\n    textLabel,\r\n    defaultValue,\r\n    type,\r\n    ...remainProps\r\n  } = props\r\n  const {setStep, onFinishInput} = props\r\n  const [value, setValue] = useState<string>(defaultValue === undefined ? '' : defaultValue)\r\n  const field = (\r\n    <TextField  label={textLabel} multiline={props.multiline} value={value}\r\n        onChange={event => setValue(event.target.value)}\r\n        fullWidth={true} inputProps={{autoFocus:true}}\r\n        onKeyPress={(ev)=>{\r\n          if (!props.multiline && ev.key === 'Enter'){\r\n            onFinishInput(value)\r\n            setStep('none')\r\n          }\r\n        }}\r\n    />\r\n  )\r\n\r\n  return (\r\n    <Input value={value} inputField={field} {...remainProps} type={type}/>\r\n  )\r\n}\r\nTextInput.displayName = 'TextInput'\r\n","import {/* acceleratorText2El,  */BMProps} from '@components/utils'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport {useTranslation} from '@models/locales'\r\nimport {isSmartphone} from '@models/utils'\r\nimport {createContentOfIframe, createContentOfText} from '@stores/sharedContents/SharedContentCreator'\r\nimport sharedContents from '@stores/sharedContents/SharedContents'\r\nimport React, {useRef, useState} from 'react'\r\nimport {CameraSelector} from './CameraSelector'\r\nimport {CameraSelectorMember} from './CameraSelector'\r\nimport { GoogleDriveImport } from './GoogleDrive'\r\nimport {ImageInput} from './ImageInput'\r\nimport { SettingImageInput } from './SettingImageInput'\r\nimport {ShareMenu} from './ShareMenu'\r\nimport {Step} from './Step'\r\nimport {TextInput} from './TextInput'\r\n\r\ninterface ShareDialogProps extends BMProps{\r\n  _type: string\r\n  cordX: number\r\n  cordY:number\r\n  origin:string\r\n  open: boolean\r\n  onClose: () => void\r\n}\r\n\r\nlet isOpen:boolean = false\r\nexport function isDialogOpen():boolean {\r\n  return isOpen\r\n}\r\n\r\nexport const ShareDialog: React.FC<ShareDialogProps> = (props:ShareDialogProps) => {\r\n  const {open, onClose, cordX, cordY, origin, _type} = props\r\n  const {map} = props.stores\r\n\r\n  const cameras = useRef(new CameraSelectorMember())\r\n  //const [step, setStep] = useState<Step>('menu')\r\n\r\n  let assignType:Step\r\n  if(_type === \"roomImage\") {\r\n    assignType = 'roomImage'\r\n  } else {\r\n    assignType = 'menu'\r\n  }\r\n  const [step, setStep] = useState<Step>(assignType)\r\n\r\n  const wrappedSetStep = (step: Step) => {\r\n    if (step === 'none') {\r\n      onClose()\r\n    } else {\r\n      setStep(step)\r\n    }\r\n  }\r\n  function getPage(step: Step, setStep: (step: Step) => void): JSX.Element | undefined {\r\n    switch (step) {\r\n      case 'menu':\r\n        return <ShareMenu {...props} setStep={setStep} cameras={cameras.current} />\r\n      case 'text':\r\n        return <TextInput stores={props.stores}\r\n            setStep={setStep}\r\n            onFinishInput={(value) => {\r\n              sharedContents.shareContent(createContentOfText(value, map, cordX, cordY, origin))\r\n              //  console.debug(`share text: ${value}`)\r\n            }}\r\n            textLabel = \"Text\"\r\n            multiline = {true}\r\n            type={step}\r\n          />\r\n      case 'iframe':\r\n        return <TextInput stores={props.stores}\r\n            setStep={setStep}\r\n            onFinishInput={(value) => {\r\n              createContentOfIframe(value, map, cordX, cordY, origin).then((c) => {\r\n                sharedContents.shareContent(c)\r\n              })\r\n            }}\r\n            textLabel = \"URL\"\r\n            multiline = {false}\r\n            type={step}\r\n          />\r\n      case 'image':\r\n        return <ImageInput setStep={setStep} stores={props.stores} type={step} xCord={cordX} yCord={cordY} from={origin}/>\r\n      case 'zoneimage':\r\n        return <ImageInput setStep={setStep} stores={props.stores} type={step} xCord={cordX} yCord={cordY} from={origin} />\r\n      case 'roomImage':\r\n        return <SettingImageInput setStep={setStep} stores={props.stores} type={step} xCord={cordX} yCord={cordY} from={origin} />\r\n      case 'camera':\r\n        return <CameraSelector setStep={setStep} stores={props.stores} cameras={cameras.current} xCord={cordX} yCord={cordY} from={origin}/>\r\n      case 'Gdrive':\r\n        return <GoogleDriveImport\r\n        stores={props.stores}\r\n        setStep={setStep} onSelectedFile={(value) => {\r\n          createContentOfIframe(value, map, cordX, cordY, origin).then((c) => {\r\n            sharedContents.shareContent(c)\r\n          })\r\n        }} />\r\n      default:\r\n        throw new Error(`Unknown step: ${step}`)\r\n    }\r\n  }\r\n\r\n  //  console.debug(`step=${step}, pasteEnabled=${sharedContents.pasteEnabled}`)\r\n  sharedContents.pasteEnabled = step === 'none' || step === 'menu'\r\n\r\n  isOpen = open\r\n\r\n  const {t} = useTranslation()\r\n  const stepTitle: {\r\n    [key: string]: string|JSX.Element,\r\n  } = {\r\n    /* menu: acceleratorText2El(t('createAndShareTitle')),\r\n    text: t('Share Text'),\r\n    iframe: t('Share iframe'),\r\n    image: t('Share image'),\r\n    none: 'None',\r\n    camera: t('Select video camera to share'), */\r\n    menu: t('Create and Share'),\r\n    text: t('Share Text'),\r\n    iframe: t('Share iframe'),\r\n    image: t('Share image'),\r\n    zoneimage: t('Share zone image'),\r\n    roomImage: t('Meeting Space'),\r\n    none: 'None',\r\n    camera: t('Select video camera to share'),\r\n  }\r\n  const title = stepTitle[step]\r\n  const page: JSX.Element | undefined = getPage(step, wrappedSetStep)\r\n\r\n  /* return  <Dialog open={open} onClose={onClose} TransitionProps={{onExited:() => setStep('menu')}} maxWidth=\"sm\"\r\n      onPointerMove = {(ev) => {\r\n        map.setMouse([ev.clientX, ev.clientY])\r\n      }}\r\n    >\r\n    <DialogTitle id=\"simple-dialog-title\" style={{fontSize: isSmartphone() ? '2.5em' : '1em'}}>\r\n      {title}</DialogTitle>\r\n    <DialogContent>{page}</DialogContent>\r\n  </Dialog> */\r\n  return  <Dialog open={open} onClose={onClose} onExited={() => setStep(assignType)} maxWidth=\"sm\" fullWidth={true}\r\n      onPointerMove = {(ev) => {\r\n        map.setMouse([ev.clientX, ev.clientY])\r\n      }}\r\n      PaperProps={{\r\n        style: {\r\n          transform: isSmartphone() ? 'scale(1.5)' : 'scale(1)',\r\n        },\r\n      }}\r\n    >\r\n    <DialogTitle id=\"simple-dialog-title\" disableTypography={true} style={{fontSize: isSmartphone() ? '2.5em' : '1.2em'}}>\r\n      {title}</DialogTitle>\r\n    <DialogContent>{page}</DialogContent>\r\n  </Dialog>\r\n}\r\n\r\nShareDialog.displayName = 'ShareDialog'\r\n","import {BMProps} from '@components/utils'\r\nimport Container from '@material-ui/core/Container'\r\n//import FormControlLabel from '@material-ui/core/FormControlLabel'\r\n//import Switch from '@material-ui/core/Switch'\r\n//import Checkbox from '@material-ui/core/Checkbox'\r\nimport {useTranslation} from '@models/locales'\r\n//import {Observer} from 'mobx-react-lite'\r\n//import {useObserver} from 'mobx-react-lite'\r\n// useEffect,\r\nimport React, {useRef, useState} from 'react'\r\n//import UploadIcon from '@material-ui/icons/Publish'\r\n//import DownloadIcon from '@material-ui/icons/GetApp'\r\n//import RoomPreferencesIcon from '@material-ui/icons/Settings'\r\n\r\n/* import {ShareDialogItem} from './share/SharedDialogItem' */\r\nimport {DialogIconItem} from '@components/utils/DialogIconItem'\r\n\r\n/* import {ISharedContent} from '@models/ISharedContent' */\r\nimport {SharedContents} from '@stores/sharedContents/SharedContents'\r\nimport {createContent/* , extractContentData */} from '@stores/sharedContents/SharedContentCreator'\r\nimport {contentsToSave, loadToContents} from '@models/ISharedContent'\r\n//createContentFromText, createContentOfIframe, createContentOfText, createContentOfVideo,\r\nimport {isArray} from 'lodash'\r\n/* import {SettingImageInput} from '@components/footer/share/SettingImageInput'\r\nimport {Step} from '@components/footer/share/Step'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport {isSmartphone} from '@models/utils'\r\nimport sharedContents from '@stores/sharedContents/SharedContents' */\r\nimport {ShareDialog} from '@components/footer/share/ShareDialog'\r\n\r\n\r\nexport const SettingsControl: React.FC<BMProps> = (props: BMProps) => {\r\n  //const local = props.stores.participants.local\r\n  // , map\r\n  const {contents, participants} = props.stores\r\n  const fileInput = useRef<HTMLInputElement>(null)\r\n\r\n // const [step, setStep] = useState<Step>('image')\r\n  const [show, setShow] = useState<boolean>(false)\r\n\r\n\r\n  function openImport() {\r\n    console.log(\"open Import \", fileInput.current?.clientHeight)\r\n    fileInput.current?.click()\r\n  }\r\n\r\n  function openDownload() {\r\n    console.log(\"open download\")\r\n    downloadItems(contents)\r\n  }\r\n\r\n  function openMeetingSpaceDialog() {\r\n    //console.log(props.stores.roomInfo, \" stores\")\r\n    setShow(true)\r\n  }\r\n\r\n  function importItems(ev: React.ChangeEvent<HTMLInputElement>, contents: SharedContents, name:string, url:string) {\r\n    const files = ev.currentTarget?.files\r\n    if (files && files.length) {\r\n      files[0].text().then((text) => {\r\n        const itemsRecv = JSON.parse(text)\r\n        if(itemsRecv[0].ResetRoomElements !== undefined && itemsRecv[0].ResetRoomElements[0].status === \"true\") {\r\n          contents.removeAllContents()\r\n        }\r\n        if (isArray(itemsRecv)) {\r\n          itemsRecv[0].RoomElements.forEach((item:any) => {\r\n            item.ownerName = name\r\n            item.ownerURL = url\r\n            const items = loadToContents(itemsRecv[0].RoomElements)\r\n            items.forEach(content => {\r\n              if (content.type === 'screen' || content.type === 'camera') { return }\r\n              const newContent = createContent()\r\n              Object.assign(newContent, content)\r\n              contents.addLocalContent(newContent)\r\n            })\r\n          })\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  /* function importItems1(ev: React.ChangeEvent<HTMLInputElement>, contents: SharedContents, name:string, url:string) {\r\n    const files = ev.currentTarget?.files\r\n\r\n    // Remove All previous loaded contents\r\n    //contents.removeAllContents()\r\n\r\n    if (files && files.length) {\r\n      files[0].text().then((text) => {\r\n        const items = JSON.parse(text)\r\n\r\n        // For Checking whether to Reset the contents or not\r\n        //console.log(items[0].Reset, \" ----- \")\r\n        if(items[0].ResetRoomElements !== undefined && items[0].ResetRoomElements[0].status === \"true\") {\r\n          contents.removeAllContents()\r\n        }\r\n\r\n        // For Elements\r\n        //console.log(items[0].Elements, \" Elements\")\r\n\r\n        ////////////////////////////////////////////////////////////\r\n        if (isArray(items)) {\r\n          items[0].RoomElements.forEach((item:any) => {\r\n            //console.log(\"Loading -- \", name)\r\n            //console.log(item, \" --- item\")\r\n            item.ownerName = name\r\n            item.ownerURL = url\r\n            const content = extractContentData(item as ISharedContent)\r\n            if (content.type === 'screen' || content.type === 'camera') { return }\r\n            const newContent = createContent()\r\n            Object.assign(newContent, content)\r\n            contents.addLocalContent(newContent)\r\n          })\r\n        }\r\n        ////////////////////////////////////////////////////////////\r\n\r\n      })\r\n    }\r\n  } */\r\n\r\n  function downloadItems(contents:SharedContents) {\r\n\r\n    let contentAll = contentsToSave(contents.all)\r\n    for(var i:number=0; i < contentAll.length; i++) {\r\n      contentAll[i].ownerName = \"\"\r\n      contentAll[i].ownerURL = \"\"\r\n    }\r\n\r\n    //const content = JSON.stringify(contentsToSave(contents.all))\r\n\r\n    const content = JSON.stringify(contentAll)\r\n\r\n     // Added Reset Flag to JSON\r\n     let ResetFlag = {status: \"true\"}\r\n     const Reset = JSON.stringify(ResetFlag)\r\n     let contentElement = '[{\"ResetRoomElements\" : [' + Reset + '],\"RoomElements\" : ' + content + '}]'\r\n\r\n\r\n    /* const blob = new Blob([content], {type: 'text/plain'}) */\r\n    const blob = new Blob([contentElement], {type: 'text/plain'})\r\n    const a = document.createElement('a')\r\n    const url = URL.createObjectURL(blob)\r\n    a.href = url\r\n    //a.download = `BMC_${conference.room}_${dateTimeString()}.json`\r\n    let roomName = sessionStorage.getItem('room')\r\n    a.download = String(roomName) + \".json\"\r\n    document.body.appendChild(a)\r\n    a.click()\r\n    setTimeout(() => {\r\n      document.body.removeChild(a)\r\n      window.URL.revokeObjectURL(url)\r\n    },         0)\r\n  }\r\n\r\n  /* function downloadItems(contents:SharedContents) {\r\n\r\n    console.log(\"download\")\r\n\r\n    //console.log(props.stores.roomInfo.roomDetails)\r\n\r\n    let contentAll = contents.all\r\n    for(var i:number=0; i < contentAll.length; i++) {\r\n      contentAll[i].ownerName = \"\"\r\n      contentAll[i].ownerURL = \"\"\r\n    }\r\n    const content = JSON.stringify(contentAll)\r\n    //////////////////////////////////////////////////////////////////////////\r\n    // Added Reset Flag to JSON\r\n    let ResetFlag = {status: \"true\"}\r\n    const Reset = JSON.stringify(ResetFlag)\r\n    let contentElement = '[{\"ResetRoomElements\" : [' + Reset + '],\"RoomElements\" : ' + content + '}]'\r\n    //////////////////////////////////////////////////////////////////////////\r\n    const blob = new Blob([contentElement], {type: 'text/plain'}) // new Blob([content], {type: 'text/plain'})\r\n    const a = document.createElement('a')\r\n    const url = URL.createObjectURL(blob)\r\n    a.href = url\r\n    //a.download = 'BinauralMeetSharedItems.json'\r\n    let roomName = sessionStorage.getItem('room')\r\n    a.download = String(roomName) + \".json\"\r\n    //a.download = String(saveJsonRoom) + \".json\"\r\n    document.body.appendChild(a)\r\n    a.click()\r\n    setTimeout(() => {\r\n      document.body.removeChild(a)\r\n      window.URL.revokeObjectURL(url)\r\n    },         0)\r\n  } */\r\n\r\n  const {t} = useTranslation()\r\n\r\n /*  icon={<UploadIcon/>}\r\n  icon={<DownloadIcon />} */\r\n\r\n  return <Container>\r\n  <DialogIconItem\r\n      key=\"meetingSpace\" onClick={()=>openMeetingSpaceDialog()} text={t('meetingSpace')}\r\n    />\r\n    <div style={{width:'140%', height:'1.5px', backgroundColor:'#bcbec0', marginLeft:'-40px'}}></div>\r\n\r\n    <DialogIconItem\r\n    key=\"shareDownload\" onClick={()=>openDownload()} text={t('shareDownload')}\r\n  />\r\n  <DialogIconItem\r\n      key=\"shareImport\" onClick={()=>openImport()} text={t('shareImport')}\r\n    />\r\n    <input type=\"file\" accept=\"application/json\" ref={fileInput} style={{display:'none'}}\r\n      onChange={\r\n        (ev) => {\r\n          importItems(ev, contents, participants.local.information.name, participants.local.information.avatarSrc)\r\n        }\r\n      }\r\n    />\r\n\r\n  <div style={{width:'140%', height:'1.5px', backgroundColor:'#bcbec0', marginLeft:'-40px'}}></div>\r\n  <ShareDialog {...props} open={show} onClose={() => setShow(false)} cordX={0} cordY={0} origin={''} _type={'roomImage'} />\r\n  </Container>\r\n}\r\nSettingsControl.displayName = 'SettingsControl'\r\n","import {BMProps} from '@components/utils'\r\nimport Container from '@material-ui/core/Container'\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\r\n//import Switch from '@material-ui/core/Switch'\r\nimport Checkbox from '@material-ui/core/Checkbox'\r\nimport {useTranslation} from '@models/locales'\r\nimport {Observer} from 'mobx-react-lite'\r\nimport React from 'react'\r\nimport CheckBoxIcon from '@material-ui/icons/Done';\r\nimport CheckBoxOutlineBlankIcon from '@material-ui/icons/CheckBoxOutlineBlank';\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport { isSmartphone } from '@models/utils'\r\nimport { Typography } from '@material-ui/core'\r\n\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    padding: 2,\r\n  },\r\n  formControlLabel: {\r\n    fontSize: isSmartphone() ? '2.5em' : \"1em\"\r\n  }\r\n})\r\n\r\nexport const BroadcastVideoControl: React.FC<BMProps> = (props: BMProps) => {\r\n  const local = props.stores.participants.local\r\n  const muteVideo = useObserver(() => local.muteVideo)\r\n  const classes = useStyles()\r\n\r\n  const videoBroadcastSwitch = <Observer>{ () =>\r\n    <Checkbox\r\n      icon={<CheckBoxOutlineBlankIcon  htmlColor=\"transparent\" />}\r\n      checkedIcon={<CheckBoxIcon style={{fontSize:isSmartphone() ? '2em' : '1em'}}  htmlColor=\"black\" />}\r\n      className={classes.root}\r\n      checked={!local.muteVideo} name=\"broadcastVideo\"\r\n      onChange={() => {\r\n        local.muteVideo = muteVideo === true ? false : true\r\n        //local.muteVideo = muteVideo\r\n        local.saveMediaSettingsToStorage()\r\n      }} />\r\n  }</Observer>\r\n  const videoBroadcastSpeakSwitch = <Observer>{ () =>\r\n    <Checkbox\r\n      icon={<CheckBoxOutlineBlankIcon  htmlColor=\"transparent\" />}\r\n      checkedIcon={<CheckBoxIcon style={{fontSize:isSmartphone() ? '2em' : '1em'}}  htmlColor=\"black\" />}\r\n      className={classes.root}\r\n      checked={false} name=\"broadcastSpeakVideo\"\r\n      onChange={() => {\r\n        //local.muteVideo = muteVideo === true ? false : true\r\n        //local.muteVideo = muteVideo\r\n        //local.saveMediaSettingsToStorage()\r\n      }} />\r\n  }</Observer>\r\n  const {t} = useTranslation()\r\n\r\n  return <Container>\r\n    <div style={{width:'150%', height:'1.5px', backgroundColor:'#bcbec0', marginLeft:'-40px'}}></div>\r\n    <FormControlLabel style={{position:'relative', top:'5px', left: '-25px'}}\r\n      control={videoBroadcastSwitch}\r\n      label={<Typography className={classes.formControlLabel}>{t('broadcastMyVideo')}</Typography>}\r\n    />\r\n    <div style={{width:'130%', height:'1.5px', backgroundColor:'#ffffff', marginLeft:'-40px'}}></div>\r\n    <FormControlLabel style={{position:'relative', top:'5px', left: '-25px'}}\r\n      control={videoBroadcastSpeakSwitch}\r\n      label={<Typography className={classes.formControlLabel}>{t('broadcastMySpeakVideo')}</Typography>}\r\n    />\r\n\r\n  </Container>\r\n}\r\nBroadcastVideoControl.displayName = 'BroadcastVideoControl'\r\n","import {BMProps} from '@components/utils'\r\nimport Container from '@material-ui/core/Container'\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\r\n//import Switch from '@material-ui/core/Switch'\r\nimport Checkbox from '@material-ui/core/Checkbox'\r\n\r\n\r\nimport {useTranslation} from '@models/locales'\r\nimport {Observer} from 'mobx-react-lite'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React from 'react'\r\n\r\nimport CheckBoxIcon from '@material-ui/icons/Done';\r\nimport CheckBoxOutlineBlankIcon from '@material-ui/icons/CheckBoxOutlineBlank';\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport { isSmartphone } from '@models/utils'\r\nimport { Typography } from '@material-ui/core'\r\n\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    padding: 2,\r\n  },\r\n  formControlLabel: {\r\n    fontSize: isSmartphone() ? '2.5em' : \"1em\"\r\n  }\r\n})\r\n\r\nexport const StereoSwitchControl: React.FC<BMProps> = (props: BMProps) => {\r\n  const local = props.stores.participants.local\r\n  const soundLocalizationBase = useObserver(() => local.soundLocalizationBase)\r\n  const stereo = useObserver(() => local.useStereoAudio)\r\n  const classes = useStyles()\r\n\r\n  //console.log(soundLocalizationBase)\r\n\r\n  const switchStereo = () => {\r\n    local.useStereoAudio = !stereo\r\n    local.saveMediaSettingsToStorage()\r\n\r\n  }\r\n\r\n  const headsetBroadcastSwitch = <Observer>{ () =>\r\n    <Checkbox\r\n      icon={<CheckBoxOutlineBlankIcon  htmlColor=\"transparent\" />}\r\n      checkedIcon={<CheckBoxIcon style={{fontSize:isSmartphone() ? '2em' : '1em'}}  htmlColor=\"black\" />}\r\n      className={classes.root} checked={local.useStereoAudio} onChange={() => {\r\n      local.soundLocalizationBase = soundLocalizationBase === 'avatar' ? 'user' : 'avatar'\r\n      switchStereo()\r\n    }} name=\"settingLoc\" />\r\n  }</Observer>\r\n  const {t} = useTranslation()\r\n\r\n  return <Container>\r\n    <div style={{width:'130%', height:'1.5px', backgroundColor:'#bcbec0', marginLeft:'-40px'}}></div>\r\n    <FormControlLabel style={{position:'relative', top:'5px', left: '-25px', fontSize:'3em'}}\r\n      control={headsetBroadcastSwitch}\r\n      label={<Typography className={classes.formControlLabel}>{t('stereoswitch')}</Typography>}\r\n    />\r\n  </Container>\r\n}\r\nStereoSwitchControl.displayName = 'StereoSwitchControl'\r\n","import {ErrorDialog} from '@components/error/ErrorDialog'\r\nimport {BMProps} from '@components/utils'\r\n/* import {acceleratorText2El} from '@components/utils/formatter' */\r\nimport megaphoneIcon from '@iconify/icons-mdi/megaphone'\r\nimport {Icon} from '@iconify/react'\r\nimport {Collapse} from '@material-ui/core'\r\nimport Menu from '@material-ui/core/Menu'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport Popover from '@material-ui/core/Popover'\r\nimport {makeStyles} from '@material-ui/core/styles'\r\nimport MicIcon from '@material-ui/icons/Mic'\r\nimport MicOffIcon from '@material-ui/icons/MicOff'\r\n/* import SettingsIcon from '@material-ui/icons/Settings' */\r\nimport VideoIcon from '@material-ui/icons/Videocam'\r\nimport VideoOffIcon from '@material-ui/icons/VideocamOff'\r\nimport SpeakerOffIcon from '@material-ui/icons/VolumeOff'\r\nimport SpeakerOnIcon from '@material-ui/icons/VolumeUp'\r\nimport {useTranslation} from '@models/locales'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React, {useEffect, useRef} from 'react'\r\nimport {AdminConfigForm} from './adminConfig/AdminConfigForm'\r\nimport {BroadcastControl} from './BroadcastControl'\r\n/* import {FaceControl} from './FaceControl' */\r\nimport {FabMain, FabWithTooltip} from '@components/utils/FabEx'\r\n/* import {ShareButton} from './share/ShareButton'\r\nimport {RecorderButton} from './recorder/RecorderButton'\r\nimport {StereoAudioSwitch} from './StereoAudioSwitch'\r\nimport { player, recorder } from '@models/conference/Recorder' */\r\nimport { MuiThemeProvider, createTheme } from '@material-ui/core/styles'\r\nimport { isSmartphone } from '@models/utils'\r\n\r\nimport MoreIcon from '@images/whoo-screen_btn-more.png'\r\nimport ExitAppIcon from '@images/earshot_icon_btn-kick.png'\r\nimport ShareAppIcon from '@images/earshot_icon_btn-share.png'\r\nimport SettingsIcon from '@material-ui/icons/Settings'\r\nimport Container from '@material-ui/core/Container'\r\nimport CheckBoxIcon from '@material-ui/icons/Done'\r\n\r\nimport {DialogIconItem} from '@components/utils/DialogIconItem'\r\nimport { SettingsControl } from './SettingsControl'\r\nimport { BroadcastVideoControl } from './BroadcastVideoControl'\r\nimport { StereoSwitchControl } from './StereoSwitchControl'\r\nimport { conference } from '@models/conference'\r\nimport { MessageType } from '@models/conference/DataMessageType'\r\n\r\nconst theme = createTheme({\r\n  palette: {\r\n    primary: { main: '#7ececc' },\r\n    secondary: { main: '#ef4623' }\r\n  }\r\n});\r\n\r\nconst buttonStyle = {\r\n  '&': {\r\n    margin: '5px',\r\n    borderRadius: '50%',\r\n    width: isSmartphone() ? '90px' : '57px',\r\n    height: isSmartphone() ? '90px' : '57px',\r\n    textAlign: 'center',\r\n  },\r\n}\r\n\r\nconst useStyles = makeStyles({\r\n  /* root:{\r\n    position: 'absolute',\r\n    width: '100%',\r\n    bottom: 0,\r\n    padding: 0,\r\n    outline: 'none',\r\n    pointerEvents: 'none',\r\n  }, */\r\n\r\n  menu:{\r\n    position: 'absolute',\r\n    width: '100%',\r\n    left: '-100%',\r\n    opacity: 0,\r\n    transition: '0.5s ease-out',\r\n  },\r\n  menuActive:{\r\n    position: 'absolute',\r\n    width: '100%',\r\n    opacity: 1,\r\n    left: 0,\r\n    transition: '0.5s ease-out',\r\n  },\r\n\r\n  menuTop:{\r\n    position: 'absolute',\r\n    width: '100%',\r\n    left: -200,\r\n    opacity: 0,\r\n    top: 0,\r\n    transition: '0.5s ease-out',\r\n  },\r\n  menuActiveTop:{\r\n    position: 'absolute',\r\n    width: '100%',\r\n    opacity: 1,\r\n    left: 0,\r\n    top:0,\r\n    transition: '0.5s ease-out',\r\n  },\r\n\r\n  topMenu:{\r\n    position: 'absolute',\r\n    width: '100%',\r\n    top: -200,\r\n    opacity: 0,\r\n    transition: '0.5s ease-out',\r\n  },\r\n  topMenuActive:{\r\n    position: 'absolute',\r\n    width: '100%',\r\n    opacity: 1,\r\n    top: 0,\r\n    transition: '0.5s ease-out',\r\n  },\r\n\r\n  more:{\r\n    display: 'inline-block',\r\n    height: 50,\r\n    width: 50,\r\n    position:'relative',\r\n    cursor: 'pointer',\r\n    backgroundColor: '#bcbec0', //  '#ef4623' : '#9e886c', bcbec0\r\n    right: 0,\r\n    left: 0,\r\n    bottom:0,\r\n    ...buttonStyle,\r\n  },\r\n  moreActive:{\r\n    display: 'inline-block',\r\n    height: 50,\r\n    position:'relative',\r\n    cursor: 'pointer',\r\n    backgroundColor: '#ef4623', //  '#ef4623' : '#9e886c',\r\n    right: 0,\r\n    left:0,\r\n    bottom:0,\r\n    ...buttonStyle,\r\n  },\r\n  container:{\r\n    position: 'absolute',\r\n    width: '100%',\r\n    bottom: 5,\r\n    padding: 0,\r\n    left: 60,\r\n    outline: 'none',\r\n    minWidth : 530,\r\n    pointerEvents: 'none',\r\n  },\r\n\r\n  topContainer:{\r\n    position: 'absolute',\r\n    width: '100%',\r\n    top: 10,\r\n    padding: 0,\r\n    left: -50,\r\n    outline: 'none',\r\n    minWidth : 530,\r\n    pointerEvents: 'none',\r\n  },\r\n\r\n  wrapper:{width:'100%'},\r\n  wrapperInner:{width:'100%', display:'flex', alignItems:'flex-end'},\r\n})\r\n\r\nclass Member{\r\n  timeoutOut:NodeJS.Timeout|undefined = undefined\r\n  touched = false\r\n\r\n  // For canvas context menu\r\n  downTime = 0\r\n  upTime = 0\r\n}\r\n\r\nlet buttonClickStatus:boolean = false\r\nexport function getVideoButtonStatus():boolean {\r\n  return buttonClickStatus\r\n}\r\n\r\nexport const Footer: React.FC<BMProps&{height?:number}> = (props) => {\r\n  const {map, participants} = props.stores\r\n  //  show or not\r\n  const [show, setShow] = React.useState<boolean>(false)\r\n  const [showPop, setShowPop] = React.useState<boolean>(false)\r\n  /* const [showFooter, setShowFooterRaw] = React.useState<boolean>(true) */\r\n  const [showAdmin, setShowAdmin] = React.useState<boolean>(false)\r\n  /* const [showShare, setShowShareRaw] = React.useState<boolean>(false) */\r\n  const [openSettiong, setOpenSettiong] = React.useState<boolean>(false)\r\n\r\n  function openAdmin(){\r\n    map.keyInputUsers.add('adminForm')\r\n    setShowAdmin(true)\r\n  }\r\n  function closeAdmin(){\r\n    map.keyInputUsers.delete('adminForm')\r\n    setShowAdmin(false)\r\n  }\r\n  /* function setShowShare(flag: boolean) {\r\n    if (flag) {\r\n      map.keyInputUsers.add('shareDialog')\r\n    }else {\r\n      map.keyInputUsers.delete('shareDialog')\r\n    }\r\n    setShowShareRaw(flag)\r\n  } */\r\n  /* const [showRecorder, setShowRecorderRaw] = React.useState<boolean>(false)\r\n  function setShowRecorder(flag: boolean) {\r\n    if (flag) {\r\n      map.keyInputUsers.add('recorderDialog')\r\n    }else {\r\n      map.keyInputUsers.delete('recorderDialog')\r\n    }\r\n    setShowRecorderRaw(flag)\r\n  } */\r\n\r\n  const memberRef = useRef<Member>(new Member())\r\n  const member = memberRef.current\r\n  const containerRef = useRef<HTMLDivElement>(null)\r\n  const adminButton = useRef<HTMLDivElement>(null)\r\n\r\n  //  Fab state and menu\r\n  const [deviceInfos, setDeviceInfos] = React.useState<MediaDeviceInfo[]>([])\r\n  const [micMenuEl, setMicMenuEl] = React.useState<Element|null>(null)\r\n  const [speakerMenuEl, setSpeakerMenuEl] = React.useState<Element|null>(null)\r\n  const [videoMenuEl, setVideoMenuEl] = React.useState<Element|null>(null)\r\n  const [settingsMenuEl, setSettingsMenuEl] = React.useState<Element|null>(null)\r\n\r\n  const {t} = useTranslation()\r\n  const classes = useStyles()\r\n\r\n  function showSharePopMenu() {\r\n    //console.log(showPop, \" >>> showPop\")\r\n    if(showPop) {\r\n      setShowPop(false)\r\n    } else {\r\n      setShowPop(true)\r\n    }\r\n  }\r\n\r\n  function showMainMenu() {\r\n    if(show) {\r\n      setShow(false)\r\n    } else {\r\n      setShow(true)\r\n    }\r\n  }\r\n\r\n  //  Footer collapse conrtrol\r\n  function checkMouseOnBottom() {\r\n    return map.screenSize[1] - (map.mouse[1] - map.offset[1]) < 90\r\n  }\r\n  const mouseOnBottom = useObserver(checkMouseOnBottom)\r\n  useEffect(() => {\r\n    /* if (checkMouseOnBottom()) { member.touched = true }\r\n    setShowFooter(mouseOnBottom || !member.touched) */\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  },        [mouseOnBottom, member.touched])\r\n\r\n  /* function setShowFooter(showFooter: boolean) {\r\n    if (showFooter) {\r\n      setShowFooterRaw(true)\r\n      if (member.timeoutOut) {\r\n        clearTimeout(member.timeoutOut)\r\n        member.timeoutOut = undefined\r\n      }\r\n      containerRef.current?.focus()\r\n    }else {\r\n      if (!member.timeoutOut) {\r\n        member.timeoutOut = setTimeout(() => {\r\n          setShowFooterRaw(false)\r\n          member.timeoutOut = undefined\r\n        },                             500)\r\n      }\r\n    }\r\n  } */\r\n\r\n  //  keyboard shortcut\r\n  useEffect(() => {\r\n    const onKeyDown = (e: KeyboardEvent) => {\r\n      //  console.log(`onKeyDown: code: ${e.code}`)\r\n      if (map.keyInputUsers.size === 0) {\r\n        if (!e.ctrlKey && !e.metaKey && !e.altKey){\r\n          /* if (e.code === 'KeyM') {  //  mute/unmute audio\r\n            participants.local.muteAudio = !participants.local.muteAudio\r\n            setShowFooter(true)\r\n          } */\r\n          /* if (e.code === 'KeyC') {  //  Create share dialog\r\n            setShowFooter(true)\r\n            setShowShare(true)\r\n            e.preventDefault()\r\n            e.stopPropagation()\r\n          }\r\n          if (e.code === 'KeyR') {  //  Recorder dialog\r\n            setShowFooter(true)\r\n            setShowRecorder(true)\r\n            if (recorder.recording) recorder.stop()\r\n            if (player.playing) player.stop()\r\n            e.preventDefault()\r\n            e.stopPropagation()\r\n          }\r\n          if (e.code === 'KeyL' || e.code === 'Escape') {  //  Leave from keyboard\r\n            participants.local.physics.awayFromKeyboard = true\r\n          } */\r\n        }\r\n      }\r\n    }\r\n    window.addEventListener('keydown', onKeyDown)\r\n\r\n    return () => {\r\n      window.removeEventListener('keydown', onKeyDown)\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  },        [])\r\n\r\n  //  Create menu list for device selection\r\n  function makeMenuItem(info: MediaDeviceInfo, close:(did:string) => void):JSX.Element {\r\n    let selected = false\r\n    if (info.kind === 'audioinput') {\r\n      selected = info.deviceId === participants.local.devicePreference.audioInputDevice\r\n    }else if (info.kind === 'audiooutput') {\r\n      selected = info.deviceId === participants.local.devicePreference.audioOutputDevice\r\n    }else if (info.kind === 'videoinput') {\r\n      selected = info.deviceId === participants.local.devicePreference.videoInputDevice\r\n    }\r\n\r\n    /* return <MenuItem key={info.deviceId}\r\n      onClick={() => { close(info.deviceId) }}\r\n      > { (selected ? '✔\\u00A0' : '\\u2003') + info.label }</MenuItem>  //  \\u00A0: NBSP, u2003: EM space. */\r\n      return <div style={{position:'relative', display:'flex', alignItems:'center', marginLeft:'15px'}}> {selected ? <CheckBoxIcon style={{opacity:'1', position:'absolute', marginLeft:'-10px', fontSize:isSmartphone() ? '3em' : '1.5em'}} /> : <CheckBoxIcon style={{opacity:'0', position:'absolute', marginLeft:'-10px', fontSize:isSmartphone() ? '3em' : '1.5em'}} />}\r\n      <MenuItem key={info.deviceId} style={{fontSize:isSmartphone() ? '2.5em' : '1em', marginLeft:isSmartphone() ? '0.5em' : '0em'}}\r\n        onClick={() => { close(info.deviceId) }}\r\n        > {info.label }\r\n        </MenuItem></div>  //  \\u00A0: NBSP, u2003: EM space.\r\n  }\r\n\r\n\r\n  const settingsMenuItems:JSX.Element[] = [<MenuItem style={{display:'flex', flexDirection:'column', textAlign:'center', marginLeft:'-35px'}} key = {'settingLoc'} ><SettingsControl {...props} /><Container><DialogIconItem\r\n  key=\"settingPreference\" text={t('settingPreference')} onClick={openAdmin}\r\n/></Container></MenuItem>]\r\n\r\n  function getMenuItems(kind:'audioinput' | 'audiooutput' | 'videoinput'){\r\n    const rv = []\r\n    let closeMenu\r\n    let bottomItem\r\n    if (kind === 'audioinput'){\r\n      closeMenu = closeMicMenu\r\n      bottomItem = <MenuItem  key = {'broadcast'} style={{fontSize:isSmartphone() ? '2.5em' : '1em'}} ><BroadcastControl {...props} /></MenuItem>\r\n    }else if (kind === 'audiooutput'){\r\n      closeMenu = closeSpeakerMenu\r\n      bottomItem = <MenuItem  key = {'soundLoc'} style={{fontSize:isSmartphone() ? '2.5em' : '1em'}} ><StereoSwitchControl {...props} /></MenuItem>\r\n    }else{\r\n      closeMenu = closeVideoMenu\r\n      /* bottomItem = <MenuItem  key = {'faceTrack'} style={{fontSize:isSmartphone() ? '2.5em' : '1em'}} ><FaceControl {...props} /></MenuItem> */\r\n      bottomItem = <MenuItem  key = {'broadcastVideo'} style={{fontSize:isSmartphone() ? '2.5em' : '1em'}} ><BroadcastVideoControl {...props} /></MenuItem>\r\n    }\r\n    for (const info of deviceInfos){\r\n      if (info.kind === kind) {\r\n        rv.push(makeMenuItem(info, closeMenu))\r\n      }\r\n    }\r\n    if (bottomItem) rv.push(bottomItem)\r\n    return rv\r\n  }\r\n  function closeMicMenu(did:string) {\r\n    if (did) {\r\n      participants.local.devicePreference.audioInputDevice = did\r\n      participants.local.saveMediaSettingsToStorage()\r\n    }\r\n    setMicMenuEl(null)\r\n  }\r\n  function closeSpeakerMenu(did:string) {\r\n    if (did) {\r\n      participants.local.devicePreference.audioOutputDevice = did\r\n      participants.local.saveMediaSettingsToStorage()\r\n    }\r\n    setSpeakerMenuEl(null)\r\n  }\r\n  function closeVideoMenu(did:string) {\r\n    if (did) {\r\n      participants.local.devicePreference.videoInputDevice = did\r\n      participants.local.saveMediaSettingsToStorage()\r\n    }\r\n    setVideoMenuEl(null)\r\n  }\r\n\r\n  function closeSettingsMenu(did:string) {\r\n    setSettingsMenuEl(null)\r\n  }\r\n\r\n  //  Device list update when the user clicks to showFooter the menu\r\n  function updateDevices(ev:React.PointerEvent | React.MouseEvent | React.TouchEvent) {\r\n    navigator.mediaDevices.enumerateDevices()\r\n    .then(setDeviceInfos)\r\n    .catch(() => { console.log('Device enumeration error') })\r\n  }\r\n\r\n  //  observer\r\n  const mute = useObserver(() => ({\r\n    muteA: participants.local.muteAudio,  //  mic\r\n    muteS: participants.local.muteSpeaker,  //  speaker\r\n    muteV: participants.local.muteVideo,  //  camera\r\n    onStage: participants.local.physics.onStage\r\n  }))\r\n  const fabSize = props.height\r\n  const iconSize = props.height ? props.height * 0.7 : 36\r\n\r\n  return <div>\r\n  <div className={classes.topContainer}>\r\n    <Collapse in={true} classes={classes}>\r\n      <div className={show ? classes.menuActiveTop : classes.menuTop}>\r\n        <FabMain size={fabSize} style={{width: '43%', float: 'left'}}\r\n          onClick = { () => {\r\n            //window.open('https://www.earshot.chat/meet/', '_self')\r\n            window.open('/', '_self')\r\n          }}>\r\n            <div className={classes.more}>\r\n              <img src={ExitAppIcon} style={{width:60, height:60, position:'relative', top:isSmartphone() ? '17px' : '0px', left:'-5px', transform: isSmartphone() ? 'scale(2)' : 'scale(1)'}} alt=\"\"/>\r\n            </div>\r\n        </FabMain>\r\n        </div>\r\n        <div className={show ? classes.topMenuActive : classes.topMenu}>\r\n        <FabMain size={fabSize} style={{width: '52%', float: 'right'}}\r\n          onClick = { () => {\r\n            navigator.clipboard.writeText(window.location.href)\r\n            showSharePopMenu()\r\n          }}>\r\n          <div className={classes.more}>\r\n            <img src={ShareAppIcon} style={{width:60, height:60, position:'relative', top:isSmartphone() ? '10px' : '-3px', left:isSmartphone() ? '1px' : '-1px', transform: isSmartphone() ? 'scale(2)' : 'scale(1)'}}  alt=\"\"/>\r\n          </div>\r\n        </FabMain>\r\n      </div>\r\n    </Collapse>\r\n  </div>\r\n\r\n\r\n  <div ref={containerRef} className={classes.container}>\r\n      <div style={{position:'relative', left:'-50px', top:'0px'}}>\r\n        <FabMain size={fabSize}\r\n          onClick = { () => {\r\n            showMainMenu()\r\n          }}\r\n        >\r\n          {show ? <div className={show ? classes.moreActive : classes.more}>\r\n            <img src={MoreIcon} style={{width:55, height:55, position:'relative', top:isSmartphone() ? '17px' : '2px', left:'-0.5px', transform: isSmartphone() ? 'scale(2)' : 'scale(1)'}} alt=\"\"/></div>\r\n            : <div className={show ? classes.moreActive : classes.more}>\r\n            <img src={MoreIcon} style={{width:55, height:55, position:'relative', top:isSmartphone() ? '17px' : '2px', left:'-0.5px', transform: isSmartphone() ? 'scale(2)' : 'scale(1)'}} alt=\"\"/></div> }\r\n        </FabMain>\r\n        </div>\r\n\r\n     {/*  <div ref={containerRef} className={classes.root}>\r\n\r\n    <MuiThemeProvider theme={theme}> */}\r\n    <Collapse in={true/* showFooter */} classes={classes}>\r\n    <div className={show ? classes.menuActive : classes.menu}>\r\n      <MuiThemeProvider theme={theme}>\r\n      {/* <StereoAudioSwitch size={fabSize} iconSize={iconSize} {...props}/> */}\r\n      <FabWithTooltip isOpen={show} index={0} size={fabSize} color={mute.muteS ? 'primary' : 'secondary' }\r\n        aria-label=\"speaker\" onClick={() => {\r\n          participants.local.muteSpeaker = !mute.muteS\r\n          if (participants.local.muteSpeaker) {\r\n            participants.local.muteAudio = true\r\n          }\r\n          participants.local.saveMediaSettingsToStorage()\r\n        }}\r\n        onClickMore = { (ev) => {\r\n          updateDevices(ev)\r\n          setSpeakerMenuEl(ev.currentTarget)\r\n        }}\r\n        >\r\n        {mute.muteS ? <SpeakerOffIcon style={{width:iconSize, height:iconSize, color:'white'}} />\r\n          : <SpeakerOnIcon style={{width:iconSize, height:iconSize, color:'white'}} /> }\r\n      </FabWithTooltip>\r\n      {speakerMenuEl ? <Menu anchorEl={speakerMenuEl} keepMounted={true} style={{marginTop:-70}}\r\n        open={Boolean(speakerMenuEl)} onClose={() => { closeSpeakerMenu('') }}>\r\n        {getMenuItems('audiooutput')}\r\n      </Menu> : undefined}\r\n\r\n      <FabWithTooltip isOpen={show} index={1} size={fabSize} color={mute.muteA ? 'primary' : 'secondary' } aria-label=\"mic\"\r\n        /* title = {acceleratorText2El(t('ttMicMute'))} */\r\n        onClick = { () => {\r\n          participants.local.muteAudio = !mute.muteA\r\n          if (!participants.local.muteAudio) {\r\n            participants.local.muteSpeaker = false\r\n          }\r\n          participants.local.saveMediaSettingsToStorage()\r\n        }}\r\n        onClickMore = { (ev) => {\r\n          updateDevices(ev)\r\n          setMicMenuEl(ev.currentTarget)\r\n        } }\r\n        >\r\n        {mute.muteA ? <MicOffIcon style={{width:iconSize, height:iconSize, color:'white'}} /> :\r\n          mute.onStage ?\r\n            <Icon icon={megaphoneIcon} style={{width:iconSize, height:iconSize, color:'white'}} color=\"white\" />\r\n            : <MicIcon style={{width:iconSize, height:iconSize, color:'white'}} /> }\r\n      </FabWithTooltip>\r\n      {micMenuEl ? <Menu anchorEl={micMenuEl} keepMounted={true} style={{marginTop:-70}}\r\n        open={Boolean(micMenuEl)} onClose={() => { closeMicMenu('') }}>\r\n        {getMenuItems('audioinput')}\r\n      </Menu> : undefined}\r\n\r\n      <FabWithTooltip isOpen={show} index={2} size={fabSize} color={mute.muteV ? 'primary' : 'secondary'} aria-label=\"camera\"\r\n        onClick = { () => {\r\n\r\n          conference.dataConnection.sendMessage(MessageType.MUTE_VIDEO, true)\r\n\r\n          participants.local.muteVideo = !mute.muteV\r\n          participants.local.saveMediaSettingsToStorage()\r\n\r\n          buttonClickStatus = true\r\n        }}\r\n        onClickMore = { (ev) => {\r\n          updateDevices(ev)\r\n          setVideoMenuEl(ev.currentTarget)\r\n        } }\r\n      >\r\n        {mute.muteV ? <VideoOffIcon style={{width:iconSize, height:iconSize, color:'white'}} />\r\n          : <VideoIcon style={{width:iconSize, height:iconSize, color:'white'}} /> }\r\n      </FabWithTooltip>\r\n      {videoMenuEl ? <Menu anchorEl={videoMenuEl} keepMounted={true} style={{marginTop:-35}}\r\n        open={Boolean(videoMenuEl)} onClose={() => { closeVideoMenu('') }}>\r\n        {getMenuItems('videoinput')}\r\n      </Menu> : undefined}\r\n\r\n     {/*  <ShareButton {...props} size={fabSize} iconSize={iconSize} showDialog={showShare}\r\n        setShowDialog={setShowShare} /> */}\r\n\r\n      <ErrorDialog {...props}/>\r\n\r\n     {/*  <div style={{marginLeft:'auto', marginRight:0, whiteSpace:'nowrap'}}>\r\n      <RecorderButton {...props} size={fabSize} iconSize={iconSize} showDialog={showRecorder}\r\n        setShowDialog={setShowRecorder} />\r\n\r\n      <FabMain size={fabSize} onClick={openAdmin} divRef={adminButton}\r\n        style={{marginRight:10, opacity:0.1}}>\r\n        <SettingsIcon style={{width:iconSize, height:iconSize, color:'white'}} />\r\n      </FabMain>\r\n      </div> */}\r\n\r\n\r\n        <FabWithTooltip isOpen={show} index={3} size={fabSize} color={'primary'}\r\n          aria-label=\"settings\" onClick={(ev) => {\r\n            member.upTime = new Date().getSeconds()\r\n           /*  let timeDiff = member.upTime - member.downTime;\r\n            if(timeDiff > 1) {\r\n            } else { */\r\n              //setSettingsMenuEl(ev.currentTarget)\r\n              openAdmin()\r\n           /*  } */\r\n\r\n          }}\r\n          /* onDown={(ev) => {\r\n            member.downTime = new Date().getSeconds()\r\n            //let _ev = ev\r\n            let _target = ev.currentTarget\r\n            const _timer = setTimeout(()=> {\r\n              clearTimeout(_timer)\r\n              let timeDiff = member.upTime - member.downTime;\r\n              if(timeDiff >= 0) return\r\n                setSettingsMenuEl(_target)\r\n                setOpenSettiong(true)\r\n            }, 500)\r\n          }} */\r\n          onClickMore = { (ev) => {\r\n            setSettingsMenuEl(ev.currentTarget)\r\n            setOpenSettiong(true)\r\n          } }\r\n          >\r\n            <SettingsIcon style={{width:iconSize, height:iconSize, color:'white'}} />\r\n        </FabWithTooltip>\r\n        <Menu anchorEl={settingsMenuEl} keepMounted={false} style={openSettiong ? {marginTop:-70, display:'block'} : {marginTop:-70, display:'none'}}\r\n          open={Boolean(settingsMenuEl)} onClick={() => { setTimeout(()=>{setOpenSettiong(false)},100)}} onClose={() => { closeSettingsMenu('') }}>\r\n          {settingsMenuItems}\r\n        </Menu>\r\n\r\n      </MuiThemeProvider>\r\n      {showAdmin ? <Popover open={showAdmin} onClose={closeAdmin}\r\n        anchorEl={adminButton.current} anchorOrigin={{vertical:'top', horizontal:'left'}}\r\n        anchorReference = \"anchorEl\" >\r\n        <AdminConfigForm close={closeAdmin} stores={props.stores}/>\r\n      </Popover> : undefined}\r\n      </div>\r\n    </Collapse>\r\n    </div>\r\n  </div>\r\n}\r\nFooter.displayName = 'Footer'\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAADAUlEQVR4nO3c4XESQRyG8RfH72IHsQOsQKxAO8imA0vQDuwgpAM6EDuIFYgdQAX44e4GsgPIcsD/nvX9zdyYy2TYxSd3c4FjR5vNRsb0KnoCdj7HA3M8MMcDczwwxwNzPDDHA3M8MMcDczwwxwNzPDDHA3M8MMcDczwwxwNzPDDHA3M8sJrjJUnfoydxTa+jJ3AlSdJj+/W43a9OjUde0jacJN1LmoXM5Mpqi5f0MlynyoA1xUvaH65TXcBa4iUdD9epKmAN8ZJOC9epJiA9XtJp4dbZfhUByfGS9od7OPCzv7Lv4QNS4yUdDjfb8/2VpKkqC0iMl1QWrlNdQFq8pPPCdaoKSIqX1C9c51hA1GuhpHj7lIbr7Au4lrToPaMbIsWb6eWV5LnhOrsB1+3X8x6Pd3Mj4IICk3abHfmZ/El91OGjatz+u+o1qwDEt4Se2+1ScNE6pNOmZRwPbGinzbt2k2BXfhGGcOSN1Vx8rCT9lvSj3TYF27RgvGnhY+fbvHC8q4mON5G0VPMH8pvYqZzsk5pfrhQ8j9B4YzWnRkq03KOCj8DIeEnccJ0UOXhkvM/Z/pOkt5JGZ2yLgnEXZ44xkvTtH8/hpiJfYckHfq/L/fFd8gpL38ceXehxi0VfsOy65Ksm/4UhxbNCjgfmeGCOB+Z4YI4H5nhgjgcWGe9P4NhViIy3DBy7Cj5tgjkemOOBOR6Y44E5HtjQ7tu8lLB3t2/JRx6Y44E5HpjjgTke2JDu26RcIQ5m3j7ywBwPzPHAHA/M8cAcD8zxwBwPzPHAHK+/SdTAkfHyRbvD/hN6CvtEb2S8/El/0XYFvqH6mu3nv4A3FXkbxFzSh539+3YjCV2fM/JdhbGaW97Ja7G8U+Bt+5GnzW6l2dBTTw8PCv68RfTV5rOaC5Wn4HmU+KlmzZhZ8DwGtUzxnbbLNQ7VUgP6dNOQ4lmh6NOm9eB4YI4H5nhgjgfmeGCOB+Z4YI4H5nhgjgfmeGCOB+Z4YI4H5nhgjgfmeGCOB+Z4YI4H9hdGXJJYtFSqXQAAAABJRU5ErkJggg==\"","\r\nimport {makeStyles} from '@material-ui/core/styles'\r\n\r\nconst buttonStyle = {\r\n  '&': {\r\n    color:'lightgrey',\r\n  },\r\n  '&:hover': {\r\n    color:'lightgreen',\r\n  },\r\n  '&:active': {\r\n    color:'lightgreen',\r\n  },\r\n}\r\n\r\nexport const styleCommon = makeStyles({\r\n  back:{\r\n    position: 'absolute',\r\n    width: '100%',\r\n    height: '100%',\r\n    top: 0,\r\n    left: 0,\r\n    backgroundColor: '#DFDBE5',\r\n  },\r\n  fill:{\r\n    position: 'absolute',\r\n    width: '100%',\r\n    height: '100%',\r\n    top: 0,\r\n    left: 0,\r\n  },\r\n  previous : {\r\n    width:'50px',\r\n    height:'50px',\r\n    position:'absolute',\r\n    left:'0px',\r\n    color:'lightgrey',\r\n    cursor:'default',\r\n    ...buttonStyle,\r\n  },\r\n\r\n  next : {\r\n    width:'50px',\r\n    height:'50px',\r\n    position:'absolute',\r\n    right:'-12px',\r\n    color:'lightgrey',\r\n    ...buttonStyle,\r\n  },\r\n\r\n  activeSlide : {\r\n    opacity: 1,\r\n    transition: 'opacity 1000ms',\r\n  },\r\n\r\n  slide: {\r\n    opacity: 0,\r\n    transition: 'opacity1000ms',\r\n  }\r\n})\r\n\r\nexport const styleForSplit = makeStyles({\r\n  /* resizerVertical: {\r\n    background: '#000',\r\n    zIndex: 1,\r\n    boxSizing: 'border-box',\r\n    backgroundClip: 'padding-box',\r\n    width: 11,\r\n    margin: '0 -10px 0 0',\r\n    borderLeft: '1px solid gray',\r\n    borderRight: 'transparent 10px solid',\r\n    cursor: 'col-resize',\r\n  },\r\n  resizerHorizontal: {\r\n    background: 'gray',\r\n    zIndex: 1,\r\n    boxSizing: 'border-box',\r\n    backgroundClip: 'padding-box',\r\n    height: 10.5,\r\n    margin: '-5px 0 -5px 0',\r\n    borderTop: '5px transparent solid',\r\n    borderBottom: '5px transparent solid',\r\n    cursor: 'row-resize',\r\n  }, */\r\n  resizerVertical: {\r\n    background: '#0f5c81',\r\n    zIndex: 1,\r\n    boxSizing: 'border-box',\r\n    backgroundClip: 'padding-box',\r\n    width: 11,\r\n    margin: '0 -10px 0 0',\r\n    borderLeft: '0px solid white'/* '1px solid gray' */,\r\n    borderRight: 'transparent 10px solid',\r\n    cursor: 'col-resize',\r\n  },\r\n  resizerHorizontal: {\r\n    background: '#85AEE060'/* 'gray' */,\r\n    zIndex: 1,\r\n    boxSizing: 'border-box',\r\n    backgroundClip: 'padding-box',\r\n    height: 10.5,\r\n    width: '80%',\r\n    marginLeft: '10%',\r\n    margin: '-5px 0 -5px 0',\r\n    borderTop: '5px transparent solid',\r\n    borderBottom: '5px transparent solid',\r\n    cursor: 'row-resize',\r\n    textAlign: 'center',\r\n  },\r\n})\r\n\r\nexport interface ListLineProps{\r\n  height:number\r\n  fontSize:number\r\n}\r\n\r\nexport const styleForList = makeStyles({\r\n  container: {\r\n    width:'100%',\r\n  },\r\n  title: (props: ListLineProps) => ({\r\n    //fontSize: props.fontSize, // * 0.8,\r\n    justifyContent: 'start',\r\n    justifyItems: 'start',\r\n    alignItems: 'center',\r\n    userSelect: 'none',\r\n    userDrag: 'none',\r\n    whiteSpace: 'nowrap',\r\n    width: '100%',\r\n  }),\r\n  outer: {\r\n    display: 'flex',\r\n    whiteSpace: 'nowrap',\r\n    padding: 0,\r\n    margin: 0,\r\n    width: '100%',\r\n  },\r\n  line: (props: ListLineProps) => ({\r\n    display: 'flex',\r\n    justifyContent: 'start',\r\n    justifyItems: 'start',\r\n    alignItems: 'center',\r\n    userSelect: 'none',\r\n    userDrag: 'none',\r\n    whiteSpace: 'nowrap',\r\n    fontSize: props.fontSize,\r\n    height: props.height,\r\n    width: '100%',\r\n    padding: 0,\r\n  }),\r\n})\r\n","import Avatar from '@material-ui/core/Avatar'\r\nimport {makeStyles} from '@material-ui/core/styles'\r\nimport {Property} from 'csstype'\r\nimport { Observer } from 'mobx-react-lite'\r\nimport React from 'react'\r\n\r\nexport interface ImageAvatarProps {\r\n  name: string\r\n  avatarSrc: string\r\n  colors: string[]\r\n  size: number\r\n  style?: any\r\n  border?: boolean\r\n}\r\n\r\nfunction avatarCommon(props: ImageAvatarProps){\r\n  const style = {\r\n    width: props.size,\r\n    height: props.size,\r\n    color:'', //props.colors[1],\r\n    backgroundColor:'', //props.colors[0],\r\n    pointerEvents: 'none' as Property.PointerEvents,\r\n    userDrag: 'none',\r\n    fontSize: props.size * 0.3,\r\n    display:'inline-block',\r\n  }\r\n\r\n  return style\r\n}\r\nconst BORDER_WIDTH = 0 // 0.04\r\nconst BORDER_CONTENT = 1 - BORDER_WIDTH*2\r\n\r\nfunction addBoarder(style:Object, props:ImageAvatarProps){\r\n  const border = {\r\n    width: props.size, // * BORDER_CONTENT,\r\n    height: props.size, // * BORDER_CONTENT,\r\n    borderStyle: 'solid',\r\n    borderWidth: 0, //props.size * BORDER_WIDTH,\r\n    borderColor: '', //props.colors[0],\r\n  }\r\n\r\n  return Object.assign(style, border)\r\n}\r\n\r\nconst useStyles = makeStyles({\r\n  imageAvatar: (props: ImageAvatarProps) => {\r\n    const style = avatarCommon(props)\r\n    Object.assign(style, {textAlign:'right' as Property.TextAlign,\r\n      verticalAlign: 'top' as Property.VerticalAlign})\r\n    if (props.border){ addBoarder(style, props) }\r\n\r\n    return style\r\n  },\r\n  textAvatar: (props: ImageAvatarProps) => {\r\n    const style = avatarCommon(props)\r\n    if (props.border){ addBoarder(style, props) }\r\n\r\n    return style\r\n  }\r\n})\r\n\r\n\r\nexport const RawImageAvatar: React.FC<ImageAvatarProps> = (props: ImageAvatarProps) => {\r\n  const classes = useStyles(props)\r\n\r\n  return <Observer>{()=>{\r\n    //console.log(`render ImageAvatar src=${props.avatarSrc}`)\r\n\r\n    let initial = ''\r\n    const isImage = props.avatarSrc && props.avatarSrc.slice(-4) !== '.vrm'\r\n    if (!isImage){\r\n      const nameArray = props.name.split(' ')\r\n      nameArray.forEach(s => initial += s ? s.substring(0,1) : '')\r\n      initial = initial.substring(0,2)\r\n    }\r\n    const size = props.border ? props.size * BORDER_CONTENT : props.size\r\n\r\n    return isImage ?\r\n      <Avatar src={props.avatarSrc} className={classes.imageAvatar} /> :\r\n      <Avatar className={classes.textAvatar} >\r\n        <div style={{height:size, width:size, textAlign:'center',\r\n          verticalAlign:'middle', display:'table-cell', whiteSpace:'nowrap'}}>\r\n        {initial}</div></Avatar>\r\n    }\r\n  }</Observer>\r\n}\r\nRawImageAvatar.displayName = 'RawImageAvatar'\r\n\r\nexport const ImageAvatar = (props: ImageAvatarProps) =>\r\n  React.useMemo(() => <RawImageAvatar {...props} />,\r\n  //  eslint-disable-next-line react-hooks/exhaustive-deps\r\n  [props.avatarSrc, props.border, props.colors, props.name, props.size, props.style])\r\nImageAvatar.displayName = 'ImageAvatar'\r\n","import {Chat} from '@stores/Chat'\r\nimport {MapData} from '@stores/Map'\r\nimport {Participants} from '@stores/participants/Participants'\r\nimport {RoomInfo} from '@stores/RoomInfo'\r\nimport {SharedContents} from '@stores/sharedContents/SharedContents'\r\nexport interface Stores {\r\n  map: MapData\r\n  participants: Participants\r\n  contents: SharedContents\r\n  chat: Chat\r\n  roomInfo: RoomInfo\r\n}\r\n\r\nexport interface BMProps {\r\n  stores: Stores\r\n}\r\n\r\nexport interface MapProps extends BMProps {\r\n  transparent?: boolean\r\n}\r\n\r\nexport function formatTimestamp(stamp: number){\r\n  const textDate = new Date(stamp)\r\n  const now = new Date()\r\n  const year = now.getFullYear() !== textDate.getFullYear() ? textDate.getFullYear() : undefined\r\n  const month = year || now.getMonth() !== textDate.getMonth() ? textDate.getMonth() + 1 : undefined\r\n  const date = (year || month || now.getDate() !== textDate.getDate()) ? textDate.getDate() : undefined\r\n  const time = `${textDate.getHours()}:${textDate.getMinutes()}:${textDate.getSeconds()}`\r\n  const timestamp = `${year ? `${year}.` : ''}${month ? `${month}.` : ''}${date ? `${date} ` : ''}${time}`\r\n\r\n  return timestamp\r\n}\r\n\r\nexport * from './formatter'\r\n","import { isSelfUrl } from '@models/utils'\r\n\r\nexport function makeLink(key:number, regResult: string[]){\r\n  //console.log('reg:', regResult)\r\n  let href='', target='', disp=''\r\n  if (regResult[1]) { disp=href=regResult[1]; target='_blank' }\r\n  else if (regResult[2]) {\r\n    href = regResult[2]\r\n    disp = regResult[6] ? regResult[6] : regResult[2]\r\n    target = regResult[3] ? '_self' : '_blank'\r\n  }\r\n  else {\r\n    disp = regResult[7]\r\n    href = regResult[11]\r\n    target = (regResult[9]||regResult[10]) ? '_self' : '_blank'\r\n  }\r\n  if (isSelfUrl(new URL(href))){\r\n    target = '_self'\r\n  }\r\n\r\n  return <a key={key} href={href} target={target} rel=\"noreferrer\">{disp}</a>\r\n}\r\nexport function textToLinkedText(text: string){\r\n  const textToShow:JSX.Element[] = []\r\n  //  add link to URL strings\r\n  const urlReg = 'https?:\\\\/\\\\/[-_.!~*\\'()a-zA-Z0-9;/?:@&=+$,%#]+'\r\n  const urlRegExp = new RegExp(`(${urlReg})|` +\r\n    `\\\\[(${urlReg})(( *>)|( +move))?\\\\s*(\\\\S+)\\\\]` +\r\n    `|\\\\[(\\\\S+)((\\\\s*>)|(\\\\s+move)|\\\\s)\\\\s*(${urlReg})\\\\]`)\r\n  let regResult:RegExpExecArray | null\r\n  let start = 0\r\n  while ((regResult = urlRegExp.exec(text.slice(start))) !== null) {\r\n    const before = text.slice(start, start + regResult.index)\r\n    if (before) {\r\n      textToShow.push(<span key={start}>{before}</span>)\r\n    }\r\n    textToShow.push(makeLink(start + before.length, regResult))\r\n    start += before.length + regResult[0].length\r\n  }\r\n  textToShow.push(<span key={start}>{text.slice(start)}</span>)\r\n\r\n  return textToShow\r\n}","import { ImageAvatar } from '@components/avatar/ImageAvatar'\r\nimport {formatTimestamp} from '@components/utils'\r\nimport { textToLinkedText } from '@components/utils/Text'\r\nimport {Tooltip} from '@material-ui/core'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport TextField from '@material-ui/core/TextField'\r\n/* import SendIcon from '@material-ui/icons/Send' */\r\nimport {MessageType} from '@models/conference/DataMessageType'\r\nimport {t} from '@models/locales'\r\nimport {isDarkColor, isSmartphone} from '@models/utils'\r\nimport chat, {ChatMessage, ChatMessageToSend, ChatMessageType} from '@stores/Chat'\r\nimport {Observer} from 'mobx-react-lite'\r\nimport React from 'react'\r\nimport {BMProps} from '../utils'\r\nimport {styleForList} from '../utils/styles'\r\nimport {TextLineStyle} from './LeftBar'\r\nimport {conference} from '@models/conference'\r\n\r\nimport btnGo from '@images/go.png'\r\n\r\nconst colorMapBlack: { [key in ChatMessageType]: string } = {\r\n  text: 'black',\r\n  called: 'red',\r\n  callTo: 'black',\r\n  log: 'black',\r\n  private: 'purple',\r\n}\r\nconst colorMapWhite: { [key in ChatMessageType]: string } = {\r\n  text: 'white',\r\n  called: 'red',\r\n  callTo: 'white',\r\n  log: 'white',\r\n  private: 'purple',\r\n}\r\n\r\n\r\nexport const ChatLine: React.FC<BMProps & TextLineStyle &{message: ChatMessage}> = (props) => {\r\n  //const scale = props.message.type === 'log' || props.message.type === 'callTo' ? 0.6 : 1\r\n  const scale = props.message.type === 'log' || props.message.type === 'callTo' ? 1 : 1\r\n  const lineHeight = props.lineHeight * scale\r\n  const fontSize = props.fontSize * scale\r\n  const {roomInfo, participants, map} = props.stores\r\n\r\n  const textColor = (props.message.text.split(\" \")[1] === 'joined.' ? 'green' : (props.message.text.split(\" \")[1] === 'Left.' ? 'red' : 'black'))\r\n\r\n  return <Observer>{() => {\r\n    const timestamp = formatTimestamp(props.message.timestamp)    //  make formated timestamp for tooltip\r\n    const colorMap = isDarkColor(roomInfo.backgroundFill) ? colorMapWhite : colorMapBlack\r\n    //const backColor = isDarkColor(roomInfo.backgroundFill) ? 'rgba(0, 0, 0, 0.3)' : 'rgba(255, 255, 255, 0.3)'\r\n\r\n    const backColor = isDarkColor(roomInfo.backgroundFill) ? 'rgba(0, 0, 0, 1)' : 'rgba(255, 255, 255, 1)'\r\n    const localUser = props.message.pid === participants.localId\r\n\r\n    return <Tooltip title={\r\n      props.message.type==='private' ?\r\n      <>{t(props.message.pid===participants.localId ? 'cmPrivateTo' : 'cmPrivateFrom',\r\n        {name:props.message.name})}<br/>{timestamp}</>\r\n        : <>{props.message.name}<br/>{timestamp}</>\r\n      } placement=\"right\">\r\n\r\n      {localUser ?\r\n      <div style={{display:'flex', overflowY:'auto', overflowX:'hidden', wordWrap:'break-word', marginTop:2, marginLeft:10, fontSize, padding:'5px',/*  backgroundColor:backColor */alignItems:'flex-end', justifyContent:'flex-start'}}>\r\n        <span style={{marginRight:'0.3rem'}} onClick={()=>{\r\n          const from = participants.find(props.message.pid)\r\n          if (from) { map.focusOn(from) }\r\n        }}>\r\n          <ImageAvatar name={props.message.name} colors={props.message.colors}\r\n            avatarSrc={props.message.avatarUrl} size={isSmartphone() ? (lineHeight*3.5) : (lineHeight*1.7)} border={true}\r\n          />\r\n        </span>\r\n        <span style={{/* color:colorMap[props.message.type] */color:textColor, backgroundColor:backColor, border:'1px solid #ffffff', padding:'10px', marginTop:'-5px', marginLeft:'15px', borderRadius:'15px', minWidth:'10%', maxWidth:isSmartphone() ? '60%' : '62%', userSelect:'none', fontSize:isSmartphone() ? '2.5rem' : '1rem', fontWeight:'normal'}}>\r\n          {textToLinkedText(props.message.text)}\r\n          <div style={{color:colorMap[props.message.type], backgroundColor:backColor, border:'1px solid #ffff00', padding:'5px', marginTop:'-17px', marginLeft:'-17px', borderRadius:'1px', borderTop:'0px solid #ffffff', borderRight:'0px solid #ffffff', borderBottom:'1px solid #ffffff', borderLeft:'1px solid #ffffff', width:'5px', height:'5px', content:'', transform:'rotate(45deg)'}}>\r\n          </div>\r\n        </span>\r\n      </div>\r\n      : <div style={{display:'flex', overflowY:'auto', overflowX:'hidden', wordWrap:'break-word', marginTop:2, marginLeft:10, marginRight:0, fontSize, padding:'5px', /* backgroundColor:backColor,  */alignItems:'flex-end', justifyContent:'flex-end'}}>\r\n      <span style={{/* color:colorMap[props.message.type] */color:textColor, backgroundColor:'#B3E1EA', border:'1px solid #B3E1EA', padding:'10px', marginTop:'-5px', marginLeft:'15px', marginRight:'15px', borderRadius:'12px', minWidth:'10%', maxWidth:isSmartphone() ? '60%' : '62%', userSelect:'none', fontSize:isSmartphone() ? '2.5em' : '1em', fontWeight:'normal'}}>\r\n        {textToLinkedText(props.message.text)}\r\n        <div style={{color:colorMap[props.message.type], backgroundColor:'#B3E1EA', border:'1px solid #B3E1EA', padding:'5px', marginTop:'-17px', marginLeft:'101%', /* marginRight:'15px', */ borderRadius:'1px', borderTop:'0px solid #B3E1EA', borderRight:'0px solid #B3E1EA', borderBottom:'1px solid #B3E1EA', borderLeft:'1px solid #B3E1EA', width:'5px', height:'5px', content:'', transform:'rotate(45deg)'}}>\r\n        </div>\r\n      </span>\r\n      <span style={{marginRight:'0.3rem'}} onClick={()=>{\r\n        const from = participants.find(props.message.pid)\r\n        if (from) { map.focusOn(from) }\r\n      }}>\r\n\r\n        <ImageAvatar name={props.message.name} colors={props.message.colors}\r\n          avatarSrc={props.message.avatarUrl} size={isSmartphone() ? (lineHeight*3.5) : (lineHeight*1.7)} border={true}\r\n        />\r\n      </span>\r\n  </div> }\r\n   </Tooltip>\r\n  }}</Observer>\r\n}\r\n\r\nfunction sendChatMessage(text: string, sendTo: string, props: BMProps){\r\n  const msg:ChatMessageToSend = {msg:text, ts: Date.now(), to: sendTo}\r\n  conference.dataConnection.sendMessage(MessageType.CHAT_MESSAGE, msg, sendTo)\r\n  const local = props.stores.participants.local\r\n  if (sendTo) {\r\n    const remote = props.stores.participants.remote.get(sendTo)\r\n    if (remote){\r\n      chat.addMessage(new ChatMessage(text, local.id, remote.information.name,\r\n        local.information.avatarSrc, local.getColor(), Date.now(), 'private'))\r\n    }\r\n  }else{\r\n    chat.addMessage(new ChatMessage(text, local.id, local.information.name,\r\n      local.information.avatarSrc, local.getColor(), Date.now(), 'text'))\r\n  }\r\n}\r\n\r\nexport const ChatInBar: React.FC<BMProps&TextLineStyle>  = (props) => {\r\n  //  console.log('Render RawContentList')\r\n  const {chat, roomInfo, participants, map} = props.stores\r\n  const classes = styleForList({height:props.lineHeight, fontSize:props.fontSize})\r\n  const [text, setText] = React.useState('')\r\n\r\n  return <div className={classes.container}\r\n    style={{height:'100%', display:'flex', flexDirection: 'column-reverse',\r\n    overflowY:'auto', overflowX:'hidden' /* overflowX:'clip' */, whiteSpace: 'pre-line', resize:'horizontal', minWidth:'290px'}} >\r\n    <form noValidate autoComplete=\"off\">\r\n      <Tooltip title={t('cmSend')} placement=\"right\">\r\n        <div style={{position:'relative', top:15/* 26 */, /* marginTop:-26, */ textAlign:'right', zIndex:1000}}>\r\n          <IconButton size={'small'} onClick={()=>{\r\n            const nameTo = chat.sendTo ?\r\n              participants?.find(chat.sendTo)?.information?.name : undefined\r\n            sendChatMessage(text, nameTo ? chat.sendTo : '', props)\r\n            setText('')\r\n          }}>\r\n            {/* <SendIcon color=\"primary\" /> */}\r\n            <img style={{width:isSmartphone() ? '4.2rem' : '2.9rem', /* position:'relative',  */bottom:'1px'/* , right:'3px' */, position:'relative' , left:'1px'}} src={btnGo} draggable={false} alt=\"\" />\r\n          </IconButton>\r\n        </div>\r\n      </Tooltip>\r\n      <Observer>{()=>{\r\n        const nameTo = chat.sendTo ? participants?.find(chat.sendTo)?.information?.name : undefined\r\n        const textColor = isDarkColor(roomInfo.backgroundFill) ? 'white' : 'black'\r\n\r\n        return <TextField variant='outlined' label=''/* {nameTo ? t('cmToName', {name: nameTo}) : t('cmToAll')} */ multiline={true} value={text} rowsMax={2}\r\n          /* style={{width:'100%', userSelect:'none'}} size={props.lineHeight > 20 ? 'medium' : 'small'} */\r\n          style={{width:'77%', minWidth:'30%', userSelect:'none', marginTop:isSmartphone() ? '-55px' : '-38px', marginLeft:'15px', right:'3px'/* , border:'1px solid yellow', bottom:'20px' */, resize:'horizontal'}}\r\n          InputProps={{style:{color:textColor, backgroundColor: 'white', borderRadius:'8px', height:isSmartphone() ? '70px' :'50px', fontSize:isSmartphone() ? '2.5rem' : '1rem', zIndex:9999}}}\r\n          InputLabelProps={{style:{color:'black'/* textColor */}}}\r\n          onFocus={()=>{map.keyInputUsers.add('chat')}}\r\n          onBlur={()=>{map.keyInputUsers.delete('chat')}}\r\n          onKeyDown={(ev)=>{\r\n            //  console.log(`key = ${ev.key}`, ev)\r\n            if (ev.key === 'Escape' || ev.key === 'Esc'){ //  Esc key\r\n              chat.sendTo = ''\r\n            }\r\n          }}\r\n          onKeyPress={(ev)=>{\r\n            //  if (ev.key === 'Enter'){  }\r\n            /* if (ev.key === '\\n'){ //  CTRL + Enter\r\n              sendChatMessage(text, nameTo ? chat.sendTo : '', props)\r\n              setText('')\r\n            } */\r\n            if(ev.ctrlKey && (ev.keyCode === 0 || ev.keyCode === 76)) {\r\n              sendChatMessage(text, nameTo ? chat.sendTo : '', props)\r\n              setText('')\r\n            }\r\n          }}\r\n          onChange={(ev)=>{ setText(ev.target.value) }}\r\n        />\r\n      }}</Observer>\r\n    </form>\r\n    <div>{  /* for indent: style={{marginLeft: '0.5em', textIndent: '-0.5em'}} */}\r\n      <Observer>{()=><>{\r\n        chat.messages.map((m, idx) =>\r\n          <ChatLine key={idx} message={m} {...props} /> )\r\n        }</>}</Observer>\r\n    </div>\r\n  </div>\r\n}\r\nChatInBar.displayName = 'Chat'\r\n\r\n","export class Settings{\r\n  useTransparent = true\r\n}\r\nexport const settings = new Settings()\r\nexport default settings\r\n","import {makeStyles} from '@material-ui/core/styles'\r\nimport {t} from '@models/locales'\r\nimport {assert} from '@models/utils'\r\nimport {getGDriveUrl, getInformationOfGDriveContent, getParamsFromUrl,\r\n  getStringFromParams, isGDrivePreviewScrollable} from '@stores/sharedContents/SharedContentCreator'\r\nimport _ from 'lodash'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React, {useEffect, useRef} from 'react'\r\nimport {ContentProps} from './Content'\r\n\r\nconst useStyles = makeStyles({\r\n  iframe: {\r\n    width: '100%',\r\n    height: '100%',\r\n    pointerEvents: 'none',\r\n  },\r\n  iframeEdit: {\r\n    width: '100%',\r\n    height: '100%',\r\n  },\r\n  iframeVScrool: (props: ContentProps) => ({\r\n    width:props.content.size[0] + 13 + 10,\r\n    height: props.content.size[0] * 100,\r\n    pointerEvents: 'none',\r\n  }),\r\n  divScroll:(props:ContentProps) => ({\r\n    width:props.content.size[0] + 100,\r\n    height: '100%',\r\n    position:'relative',\r\n    left:-15,\r\n    overflow:'scroll',\r\n  }),\r\n  divClip:{\r\n    width: '100%',\r\n    height: '100%',\r\n    overflow: 'hidden',\r\n  },\r\n  divError:{\r\n    width: '100%',\r\n    height: '100%',\r\n    overflow: 'hidden',\r\n    backgroundColor: 'white',\r\n  },\r\n})\r\n\r\ninterface Member{\r\n  props: ContentProps\r\n  params: Map<string, string>\r\n  scrolling: boolean\r\n  onscroll:()=>void\r\n}\r\n\r\nfunction updateUrl(member: Member) {\r\n  const url = getStringFromParams(member.params)\r\n\r\n  if (url !== member.props.content.url && member.props.updateAndSend) {\r\n    member.props.content.url = url\r\n    member.props.updateAndSend(member.props.content)\r\n  }\r\n}\r\n\r\nexport const GDrive: React.FC<ContentProps> = (props:ContentProps) => {\r\n  assert(props.content.type === 'gdrive')\r\n  const divScroll = useRef<HTMLDivElement>(null)\r\n  const contents = props.stores.contents\r\n  const params = getParamsFromUrl(props.content.url)\r\n  const fileId = params.get('id')\r\n  const mimeType = params.get('mimeType')\r\n  const memberRef = useRef<Member>({props, params, scrolling:false, onscroll:()=>{}})\r\n  const member = memberRef.current\r\n  member.props = props\r\n  member.params = params\r\n  if (!mimeType && fileId) {\r\n    getInformationOfGDriveContent(fileId).then((res)=>{\r\n      if ((res.name && props.content.name !== res.name) || res.mimeType){\r\n        member.params.set('mimeType', res.mimeType)\r\n        console.log(`mime: ${res.mimeType}`, res)\r\n        if (res.name){ props.content.name = res.name }\r\n        updateUrl(member)\r\n      }\r\n    }).catch(reason=>{\r\n      console.log(`GDrive failed ${reason.body}`)\r\n      if (reason.status === 404){\r\n        console.log('404 may be video')\r\n        member.params.set('mimeType', 'video')\r\n        updateUrl(member)\r\n      }\r\n    })\r\n  }\r\n  //  console.log(`Name:${props.content.name} mime: ${mimeType}`)\r\n  const classes = useStyles(props)\r\n  const editing = useObserver(() => props.stores.contents.editing === props.content.id)\r\n  const url = getGDriveUrl(editing, member.params)\r\n\r\n  //  scroll to given 'top' param\r\n  useEffect(() => {\r\n    const top = Number(member.params.get('top'))\r\n    if (!editing && !member.scrolling && divScroll.current\r\n      && !isNaN(top) && top !== divScroll.current.scrollTop) {\r\n      divScroll.current.onscroll = () => {}\r\n      divScroll.current.scrollTop = top\r\n      setTimeout(()=>{\r\n        if (divScroll.current){ divScroll.current.onscroll = member.onscroll }\r\n      }, 100)\r\n      //  console.log(`scrool to top=${top}`)\r\n    }\r\n  })\r\n\r\n  //  Set onscroll handler setting 'top' param\r\n  useEffect(() => {\r\n    function doSendScroll() {\r\n      const top = Number(member.params.get('top'))\r\n      if (divScroll.current && divScroll.current.scrollTop !== top) {\r\n        //  console.log(`doSendScrool top=${divScroll.current.scrollTop}`)\r\n        member.params.set('top', divScroll.current.scrollTop.toString())\r\n        updateUrl(member)\r\n      }\r\n    }\r\n    if (divScroll.current) {\r\n      const INTERVAL = 100\r\n      const sendScroll = _.throttle(() => setTimeout(doSendScroll, INTERVAL), INTERVAL)\r\n      const endScroll = _.debounce(() => {\r\n        member.scrolling = false\r\n        //  console.log(`scrolling: ${member.current.scrolling}`)\r\n      },                           INTERVAL)\r\n      member.onscroll = () => {\r\n        member.scrolling = true\r\n        //  console.log(`scrolling: ${member.current.scrolling}`)\r\n        sendScroll()\r\n        endScroll()\r\n      }\r\n\r\n      divScroll.current.onscroll = member.onscroll\r\n    }\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [contents.roomContents])\r\n\r\n  const vscroll = isGDrivePreviewScrollable(mimeType)\r\n\r\n  return <div className={mimeType ? classes.divClip : classes.divError} >\r\n    {mimeType ?\r\n      <div className={(editing || !vscroll) ? classes.divClip : classes.divScroll} ref={divScroll}\r\n        onWheel = {ev => ev.ctrlKey || ev.stopPropagation() } >\r\n        <iframe src={url} title={props.content.url}\r\n          className={editing ? classes.iframeEdit : vscroll ? classes.iframeVScrool : classes.iframe}\r\n        />\r\n    </div> :\r\n    !editing ? <div style={{margin:'1em', whiteSpace:'pre-wrap'}}>{t('gdFailed')}</div> :\r\n      <div className={classes.divClip} onWheel = {ev => ev.ctrlKey || ev.stopPropagation() } >\r\n      <iframe src={url} title={props.content.url}\r\n        className={classes.iframeEdit}\r\n      />\r\n      </div>\r\n    }\r\n  </div>\r\n}\r\n","import {Collapse, Grid, TextField} from '@material-ui/core'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport NavigateBeforeIcon from '@material-ui/icons/NavigateBefore'\r\nimport NavigateNextIcon from '@material-ui/icons/NavigateNext'\r\nimport {getProxiedUrl} from '@models/api/CORS'\r\nimport {assert} from '@models/utils'\r\nimport {makeObservable, observable} from 'mobx'\r\nimport {Observer, useObserver} from 'mobx-react-lite'\r\nimport {getDocument, GlobalWorkerOptions, renderTextLayer} from 'pdfjs-dist'\r\nimport {PDFDocumentProxy, PDFPageProxy} from 'pdfjs-dist/types/display/api'\r\nimport React, {useEffect, useRef} from 'react'\r\nimport {ContentProps} from './Content'\r\n\r\n////GlobalWorkerOptions.workerSrc = 'https://cdn.jsdelivr.net/npm/pdfjs-dist@2.7.570/es5/build/pdf.worker.js'\r\nGlobalWorkerOptions.workerSrc = 'https://cdn.jsdelivr.net/npm/pdfjs-dist@2.7.570/build/pdf.worker.js'\r\nconst CANVAS_SCALE = 3\r\n\r\nexport declare class RenderTask {\r\n  constructor(internalRenderTask: any);\r\n  _internalRenderTask: any\r\n  /**\r\n   * Callback for incremental rendering -- a function that will be called\r\n   * each time the rendering is paused.  To continue rendering call the\r\n   * function that is the first argument to the callback.\r\n   * @type {function}\r\n   */\r\n  onContinue: Function\r\n  /**\r\n   * Promise for rendering task completion.\r\n   * @type {Promise<void>}\r\n   */\r\n  get promise(): Promise<void>;\r\n  /**\r\n   * Cancels the rendering task. If the task is currently rendering it will\r\n   * not be cancelled until graphics pauses with a timeout. The promise that\r\n   * this object extends will be rejected when cancelled.\r\n   */\r\n  cancel(): void\r\n}\r\n\r\n\r\nclass Member{\r\n  newProps!: ContentProps\r\n  props!: ContentProps\r\n  mainUrl!: string\r\n  document?: PDFDocumentProxy = undefined\r\n  pages: PDFPageProxy[] = []\r\n  renderTask?: RenderTask = undefined\r\n  canvas: HTMLCanvasElement|null = null\r\n  textDiv: HTMLDivElement|null = null\r\n  annotationDiv: HTMLDivElement|null = null\r\n  prevSize = [0,0]\r\n  pageNum = 0\r\n  @observable numPages = 0\r\n  @observable showTop = true\r\n  @observable pageText = ''\r\n  constructor(){\r\n    makeObservable(this)\r\n  }\r\n  render(){\r\n    const page = this.pages[this.pageNum]\r\n    if (this.canvas && page){\r\n      const viewport1 = page.getViewport({scale:1})\r\n      const c = this.props.content\r\n      if (c.originalSize[0] !== viewport1.width || c.originalSize[1] !== viewport1.height) {\r\n        c.originalSize = [viewport1.width, viewport1.height]\r\n        c.size = [c.size[0], c.size[0] * c.originalSize[1] / c.originalSize[0]]\r\n        this.props.updateOnly(this.props.content)\r\n\r\n        return false\r\n      }\r\n      const scale = CANVAS_SCALE * this.props.content.size[0] / viewport1.width\r\n      const viewport = page.getViewport({scale})\r\n      this.canvas.width = viewport.width\r\n      this.canvas.height = viewport.height\r\n      const ctx = this.canvas.getContext('2d')\r\n      if (ctx){\r\n        if (this.renderTask){\r\n          this.renderTask.cancel()\r\n        }\r\n        this.renderTask = page.render({canvasContext: ctx, viewport})\r\n        this.renderTask.promise.then(()=>{\r\n          page.getTextContent().then((textContent)=>{\r\n            // Pass the data to the method for rendering of text over the pdf canvas.\r\n            if (this.textDiv) {\r\n              const children = this.textDiv.childNodes\r\n              Array.from(children.values()).forEach(c => c.remove())\r\n              const texts: HTMLElement[] = []\r\n              renderTextLayer({\r\n                textContent: textContent,\r\n                container: this.textDiv,\r\n                viewport,\r\n                textDivs: texts\r\n              })\r\n              texts.forEach(text => {\r\n                text.style.position='absolute'\r\n                text.style.color='transparent'\r\n                text.style.whiteSpace='pre'\r\n                text.style.transformOrigin='0% 0%'\r\n                text.style.whiteSpace='nowrap'\r\n                text.style.verticalAlign='top'\r\n              })\r\n            }\r\n          })\r\n          this.renderTask = undefined\r\n        }).catch(reason => {\r\n          //  console.log(`Rendering canceled reason:${reason}`)\r\n        })\r\n      }\r\n\r\n      return true\r\n    }\r\n\r\n    return false\r\n  }\r\n  updateProps(){\r\n    if (this.newProps === this.props) {\r\n      //  console.log('PDF c:', this.newProps === this.props, this.newProps.content.url, this.props?.content?.url)\r\n\r\n      return\r\n    }\r\n\r\n    this.props = this.newProps\r\n\r\n    const url = new URL(this.props.content.url)\r\n    this.mainUrl = url.hash ? url.href.substring(0, url.href.length - url.hash.length) : url.href\r\n    let pageNum = this.pageNum\r\n    if (url.hash.substr(0,6) === '#page='){\r\n      pageNum = Number(url.hash.substr(6)) - 1 ?? 0\r\n      if (pageNum < 0){ pageNum = 0 }\r\n      if (this.numPages && pageNum >= this.numPages){ pageNum = this.numPages-1 }\r\n    }\r\n    if (!this.document || pageNum !== this.pageNum){\r\n      //  console.log(`doc${this.document}  page=${this.pageNum} -> ${pageNum}`)\r\n      this.getPage(pageNum).then(()=>{\r\n        this.render()\r\n      })\r\n      this.pageNum = pageNum\r\n      this.pageText = String(pageNum + 1)\r\n    }else if(this.prevSize[0] !== this.props.content.size[0] || this.prevSize[1] !== this.props.content.size[1]){\r\n      if (this.render()){\r\n        this.prevSize = Array.from(this.props.content.size)\r\n      }\r\n    }\r\n  }\r\n  getDocument(){\r\n    const rv = new Promise<PDFDocumentProxy>((resolve, reject)=>{\r\n      if (this.document){\r\n        resolve(this.document)\r\n      }else{\r\n        const task = getDocument({\r\n          url: getProxiedUrl(this.mainUrl),\r\n          cMapUrl: 'https://cdn.jsdelivr.net/npm/pdfjs-dist@2.7.570/cmaps/',\r\n          cMapPacked: true,\r\n        })\r\n        task.promise.then((doc) => {\r\n          this.document = doc\r\n          this.numPages = doc.numPages\r\n          resolve(this.document)\r\n        }).catch(reason => {\r\n          const task = getDocument({\r\n            url: this.mainUrl,\r\n            cMapUrl: 'https://cdn.jsdelivr.net/npm/pdfjs-dist@2.7.570/cmaps/',\r\n            cMapPacked: true,\r\n          })\r\n          task.promise.then((doc) => {\r\n            this.document = doc\r\n            this.numPages = doc.numPages\r\n            resolve(this.document)\r\n          }).catch(reason => {\r\n            console.error(`PDF: failed to load ${this.mainUrl}`)\r\n            reject(reason)\r\n          })\r\n        })\r\n//        task.onProgress = (progress:{loaded: number, total: number}) => {\r\n//          console.log(`PDF progress ${progress.loaded}/${progress.total}`)\r\n//        }\r\n      }\r\n    })\r\n\r\n    return rv\r\n  }\r\n  getPage(pageNum:number) {\r\n    const rv = new Promise<PDFPageProxy>((resolve, reject) => {\r\n      if (this.pages[pageNum]){\r\n        resolve(this.pages[pageNum])\r\n      }else{\r\n        this.getDocument().then((doc)=>{\r\n          doc.getPage(pageNum+1).then((page)=>{\r\n            this.pages[pageNum] = page\r\n            resolve(this.pages[pageNum])\r\n          }).catch((reason)=> {\r\n            reject(reason)\r\n          })\r\n        }).catch((reason)=> {\r\n          reject(reason)\r\n        })\r\n      }\r\n    })\r\n\r\n    return rv\r\n  }\r\n  updateUrl(pageNum?: number){\r\n    if (pageNum === undefined || !Number.isFinite(pageNum)) {pageNum = this.pageNum}\r\n    if (pageNum < 0) {pageNum = 0}\r\n    if (pageNum >= this.numPages) {pageNum = this.numPages-1}\r\n    const url = `${this.mainUrl}#page=${pageNum+1}`\r\n    if (url !== this.props.content.url) {\r\n      const c = Object.assign({}, this.props.content)\r\n      c.url = url\r\n      this.props.updateAndSend(c)\r\n    }\r\n  }\r\n}\r\n\r\nconst stopper = {\r\n  onMouseDown: (ev:React.MouseEvent) => {ev.stopPropagation()},\r\n  onMouseUp: (ev:React.MouseEvent) => {ev.stopPropagation()},\r\n  onPointerDown: (ev:React.MouseEvent) => {ev.stopPropagation()},\r\n  onPointerUp: (ev:React.MouseEvent) => {ev.stopPropagation()},\r\n}\r\n\r\nexport const PDF: React.FC<ContentProps> = (props:ContentProps) => {\r\n  assert(props.content.type === 'pdf')\r\n  const memberRef = useRef<Member>(new Member())\r\n  const member = memberRef.current\r\n  member.newProps = props\r\n  const refCanvas = useRef<HTMLCanvasElement>(null)\r\n  const refTextDiv = useRef<HTMLDivElement>(null)\r\n  const refAnnotationDiv = useRef<HTMLDivElement>(null)\r\n  const editing = useObserver(() => props.stores.contents.editing === props.content.id)\r\n\r\n  useEffect(()=>{\r\n    member.canvas = refCanvas.current\r\n    member.textDiv = refTextDiv.current\r\n    member.annotationDiv = refAnnotationDiv.current\r\n  // eslint-disable-next-line  react-hooks/exhaustive-deps\r\n  }, [refCanvas.current])\r\n\r\n  useEffect(()=>{\r\n    member.updateProps()\r\n  })\r\n\r\n  return <div style={{overflow: 'hidden', pointerEvents: 'auto', userSelect: editing? 'text':'none'}}\r\n    onDoubleClick = {(ev) => { if (!editing) {\r\n      ev.stopPropagation()\r\n      ev.preventDefault()\r\n      props.stores.contents.setEditing(props.content.id)\r\n    } }} >\r\n    <canvas style={{ width:`${CANVAS_SCALE*100}%`, height:`${CANVAS_SCALE*100}%`,\r\n      transformOrigin:'top left', transform:`scale(${1/CANVAS_SCALE})`}} ref={refCanvas} />\r\n    <div ref={refTextDiv} style={{position:'absolute', left:0, top:0,\r\n      width:`${CANVAS_SCALE*100}%`, height:`${CANVAS_SCALE*100}%`,\r\n      transformOrigin:'top left', transform:`scale(${1/CANVAS_SCALE})`, lineHeight: 1,\r\n      overflow:'hidden'}} />\r\n    <div ref={refAnnotationDiv} />\r\n    <div style={{position:'absolute', top:0, left:0, width:'100%', height:40}}\r\n      onPointerEnter={()=>{member.showTop = true}} onPointerLeave={()=>{member.showTop = false}}>\r\n      <Observer>{()=>\r\n        <Collapse in={member.showTop} style={{position:'absolute', top:0, left:0, width:'100%'}}>\r\n          <Grid container alignItems=\"center\">\r\n            <Grid item >\r\n              <IconButton size=\"small\" color={member.pageNum>0?'primary':'default'} {...stopper}\r\n                onClick={(ev) => { ev.stopPropagation(); member.updateUrl(member.pageNum - 1) }}\r\n                onDoubleClick={(ev) => {ev.stopPropagation() }} >\r\n              <NavigateBeforeIcon />\r\n              </IconButton>\r\n            </Grid>\r\n            <Grid item xs={1}>\r\n              <TextField value={member.pageText} {...stopper}\r\n                inputProps={{min: 0, style: { textAlign: 'center' }}}\r\n                onChange={(ev)=> { member.pageText = ev.target.value}}\r\n                onBlur={(ev) => {\r\n                  const num = Number(member.pageText)\r\n                  if (num > 0) { member.updateUrl(num-1) }\r\n                }}\r\n                onKeyPress={(ev)=>{\r\n                  if (ev.key === 'Enter'){\r\n                    const num = Number(member.pageText)\r\n                    if (num > 0) { member.updateUrl(num-1) }\r\n                  }\r\n                }}\r\n              />\r\n            </Grid>\r\n            <Grid item style={{fontSize:15}}>/ {member.numPages}</Grid>\r\n            <Grid item >\r\n              <IconButton size=\"small\" color={member.pageNum<member.numPages-1?'primary':'default'} {...stopper}\r\n                onClick={(ev) => { ev.stopPropagation(); member.updateUrl(member.pageNum + 1) }}\r\n                onDoubleClick={(ev) => {ev.stopPropagation() }} >\r\n              <NavigateNextIcon />\r\n              </IconButton>\r\n            </Grid>\r\n          </Grid>\r\n        </Collapse>\r\n      }</Observer>\r\n    </div>\r\n  </div>\r\n}\r\n","import {makeStyles} from '@material-ui/core/styles'\r\nimport {assert} from '@models/utils'\r\nimport React, {useEffect, useRef} from 'react'\r\nimport {ContentProps} from './Content'\r\n\r\nconst useStyles = makeStyles({\r\n  video: {\r\n    width: '100%',\r\n    height: '100%',\r\n  },\r\n})\r\n\r\nexport const PlaybackScreenContent: React.FC<ContentProps> = (props:ContentProps) => {\r\n  assert(props.content.type === 'playbackScreen' || props.content.type === 'playbackCamera')\r\n  const classes = useStyles()\r\n  const ref = useRef<HTMLVideoElement>(null)\r\n\r\n  function setTrack() {\r\n    if (ref.current) {\r\n      ref.current.src = props.content.url\r\n      ref.current.autoplay = true\r\n    }\r\n  }\r\n  useEffect(() => {\r\n    setTrack()\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  },        [ref.current])\r\n\r\n  return <video className={classes.video} ref={ref} />\r\n}\r\n","import {makeStyles} from '@material-ui/core/styles'\r\nimport {ISharedContent} from '@models/ISharedContent'\r\nimport {assert, mulV2} from '@models/utils'\r\nimport contents from '@stores/sharedContents/SharedContents'\r\nimport { autorun } from 'mobx'\r\nimport React, {useEffect, useRef} from 'react'\r\nimport {ContentProps} from './Content'\r\n\r\nconst useStyles = makeStyles({\r\n  video: {\r\n    width: '100%',\r\n    height: '100%',\r\n  },\r\n})\r\n\r\ninterface ScreenContentMember{\r\n  tracks: MediaStreamTrack[]\r\n  content: ISharedContent\r\n}\r\n\r\nexport const ScreenContent: React.FC<ContentProps> = (props:ContentProps) => {\r\n  assert(props.content.type === 'screen' || props.content.type === 'camera')\r\n  const classes = useStyles()\r\n  const ref = useRef<HTMLVideoElement>(null)\r\n  const [muted, setMuted] = React.useState(false)\r\n  const member = useRef<ScreenContentMember>({} as ScreenContentMember)\r\n\r\n  const simulcastRatios = [0.25, 0.5, 0.75, 4.0 / 3, 2, 4]\r\n  //const simulcastRatios:number[] = []\r\n  useEffect(() => {\r\n    //  Create tracks.\r\n    if (!member.current?.tracks){\r\n      member.current = {\r\n        tracks: contents.getOrCreateContentTracks('', props.content.id).tracks,\r\n        content: props.content,\r\n      }\r\n      if (member.current.tracks.length > 2) {\r\n        console.error(`content ${props.content.id} has ${member.current.tracks.length} tracks`, member.current.tracks)\r\n      }\r\n    }\r\n    //  Observe tracks and update\r\n    const disposer = autorun(()=>{\r\n      if (ref.current) {\r\n        const track = member.current.tracks.find(t => t.kind === 'video')\r\n        if (track){\r\n          const oldTrack = ref.current.srcObject instanceof MediaStream ? ref.current.srcObject.getVideoTracks()[0] : undefined\r\n          if (oldTrack !== track) {\r\n            const ms = new MediaStream()\r\n            ms.addTrack(track)\r\n            let timer = 0\r\n            track.onmute = () => {\r\n              timer = window.setTimeout(()=>{setMuted(true)}, 5000)\r\n              //console.log('video muted.')\r\n            }\r\n            track.onunmute = () => {\r\n              if (timer){\r\n                window.clearTimeout(timer)\r\n                timer = 0\r\n              }\r\n              setMuted(false)\r\n              //console.log('video unmuted.')\r\n            }\r\n            ref.current.srcObject = ms\r\n            ref.current.autoplay = true\r\n          }\r\n        }\r\n      }\r\n    })\r\n    return ()=>{\r\n      disposer()\r\n    }\r\n  //  eslint-disable-next-line  react-hooks/exhaustive-deps\r\n  }, [])\r\n  useEffect(() => {\r\n    function checkVideoSize() {\r\n      if (member.current.tracks.length && ref.current) {\r\n        const tracks = ref.current.srcObject instanceof MediaStream && ref.current.srcObject.getTracks()\r\n        if (tracks && tracks.length) {\r\n          const video = tracks.find(track => track.kind === 'video')\r\n          const settings = video?.getSettings()\r\n          const newSize = [settings?.width || 0, settings?.height || 0] as [number, number]\r\n          if (newSize[0] && member.current.content.originalSize.toString() !== newSize.toString()) {\r\n            if (member.current.content.originalSize[0]){\r\n              const sx = member.current.content.originalSize[0] / newSize[0]\r\n              const sy = member.current.content.originalSize[1] / newSize[1]\r\n              if (sx === sy && simulcastRatios.find(s => s === sx)) { return }\r\n            }\r\n            const scale = member.current.content.size[0] /\r\n              (member.current.content.originalSize[0] ? member.current.content.originalSize[0] : newSize[0])\r\n            member.current.content.originalSize = newSize\r\n            member.current.content.size = mulV2(scale, newSize)\r\n            props.updateAndSend(member.current.content)\r\n          }\r\n        }\r\n      }\r\n    }\r\n    const interval = setInterval(checkVideoSize, 333)   //  Notification of exact video size may take time.\r\n    return () => clearInterval(interval)\r\n  //  eslint-disable-next-line  react-hooks/exhaustive-deps\r\n  }, [])\r\n\r\n  return <video className={classes.video} style={muted ? {filter: 'brightness(80%) sepia(25%)'} : {}} ref={ref} />\r\n}\r\n","import {formatTimestamp} from '@components/utils'\r\nimport {textToLinkedText} from '@components/utils/Text'\r\nimport {Tooltip} from '@material-ui/core'\r\nimport {makeStyles} from '@material-ui/core/styles'\r\nimport {CSSProperties} from '@material-ui/styles'\r\nimport settings from '@components/Settings'\r\nimport {compTextMessage, TextMessage, TextMessages} from '@models/ISharedContent'\r\nimport {assert, findTextColorRGB} from '@models/utils'\r\nimport {getRandomColorRGB, rgba} from '@models/utils'\r\nimport _ from 'lodash'\r\nimport {Observer, useObserver} from 'mobx-react-lite'\r\nimport React, {useEffect, useRef} from 'react'\r\nimport {ContentProps} from './Content'\r\n\r\nclass TextMember{\r\n  messages: TextMessage[] = []\r\n  isStatic = false\r\n  abortScroll = false\r\n  editing = false\r\n}\r\n//  Update (send) the content if needed\r\nfunction onUpdateTexts(messages: TextMessage[], div:HTMLDivElement, props: ContentProps) {\r\n  const newTexts: TextMessages = {messages, scroll:[div.scrollLeft, div.scrollTop]}\r\n  const newUrl = JSON.stringify(newTexts)\r\n  if (props.content.url !== newUrl && props.updateAndSend) {\r\n    props.content.url = newUrl\r\n    props.updateAndSend(props.content)\r\n  }\r\n}\r\n\r\n\r\ninterface TextDivProps extends ContentProps{\r\n  text: TextMessage\r\n  textEditing: boolean\r\n  textToShow: JSX.Element[]\r\n  member: TextMember\r\n  div: HTMLDivElement | null\r\n  autoFocus: boolean\r\n}\r\ninterface TextEditProps extends TextDivProps{\r\n  css: React.CSSProperties\r\n}\r\n\r\nfunction sendText(text: string, props: TextEditProps){\r\n  //  console.log(`send text ${text}`)\r\n  props.text.message = text\r\n  const messagesToSend = props.member.messages.filter(text => text.message.length)\r\n  if (props.div){\r\n    onUpdateTexts(messagesToSend, props.div, props)\r\n  }\r\n}\r\n\r\n\r\nexport const TextEdit: React.FC<TextEditProps> = (props:TextEditProps) => {\r\n  const [text, setText] = React.useState(props.text.message)\r\n  const sendTextLaterRef = useRef<any>(undefined)\r\n  useEffect(() => {\r\n    sendTextLaterRef.current = _.throttle(sendText, 1000, {leading: false})\r\n  }, [])\r\n  const sendTextLater = sendTextLaterRef.current\r\n\r\n  return <Observer>{() =>\r\n  <div style={{...props.css, position:'relative', margin:0, border:0, padding:0, backgroundColor:'none'}}>\r\n    <div style={{...props.css, color:'red', position:'relative', width:'100%',\r\n      overflow: 'hidden', visibility:'hidden'}}>{text+'\\u200b'}</div>\r\n    <textarea value={text} autoFocus={props.autoFocus}\r\n      style={{...props.css, font: 'inherit', verticalAlign:'baseline', resize:'none',\r\n      position:'absolute', top:0, left:0, width:'100%', height:'100%', border:'none',\r\n      letterSpacing: 'inherit', overflow: 'hidden'\r\n    }}\r\n      onChange={(ev) => {\r\n        setText(ev.currentTarget.value)\r\n        if (sendTextLater){\r\n          sendTextLater(ev.currentTarget.value, props)\r\n        }\r\n      }}\r\n      onBlur={()=>{\r\n        if (sendTextLater){ sendTextLater.cancel() }\r\n        sendText(text, props)\r\n      }}\r\n      onFocus={()=>{\r\n\r\n      }}\r\n      onKeyDown={(ev) => {\r\n        if (ev.key === 'Escape' || ev.key === 'Esc') {\r\n          ev.stopPropagation()\r\n          ev.preventDefault()\r\n          if (sendTextLater){ sendTextLater.cancel() }\r\n          sendText(text, props)\r\n          props.stores.contents.setEditing('')\r\n        }\r\n      }}\r\n    />\r\n  </div>}</Observer>\r\n}\r\n\r\nexport const TextDiv: React.FC<TextDivProps> = (props:TextDivProps) => {\r\n  const timestamp = formatTimestamp(props.text.time)    //  make formated timestamp for tooltip\r\n  const rgb = props.text.color?.length ? props.text.color : getRandomColorRGB(props.text.name)\r\n  const textColor = props.text.textColor?.length ? props.text.textColor : findTextColorRGB(rgb)\r\n  const css:CSSProperties = {\r\n    color: rgba(textColor, 1),\r\n    backgroundColor:settings.useTransparent ? rgba(rgb, 0.5) : rgba(rgb, 1),\r\n    padding:'0.1em',\r\n    fontSize: 16,\r\n    lineHeight: 1.2,\r\n    width:'100%',\r\n    overflow: 'clip',\r\n    boxSizing: 'border-box',\r\n    whiteSpace: 'pre-wrap',\r\n    wordWrap: 'break-word',\r\n    overflowWrap: 'break-word',\r\n  }\r\n  const {backgroundColor, ...cssEdit} = css\r\n  cssEdit.backgroundColor = rgba(rgb, 1)\r\n\r\n  return <Tooltip title={<React.Fragment>{props.text.name} <br /> {timestamp}</React.Fragment>}\r\n  placement=\"left\" arrow={true} suppressContentEditableWarning={true}><div>\r\n  {props.textEditing ? <TextEdit {...props} css={cssEdit} /> :\r\n  <div style={css}\r\n    //  Select text by static click\r\n    onPointerDown={()=>{ props.member.isStatic = true }}\r\n    onPointerMove={()=>{ props.member.isStatic = false }}\r\n    onPointerUp={(ev)=>{\r\n      if (!props.member.isStatic){ return }\r\n      const target = ev.target\r\n      if (target instanceof Node){\r\n        ev.preventDefault()\r\n        const selection = window.getSelection()\r\n        if (selection){\r\n          if (selection.rangeCount && selection.getRangeAt(0).toString()){\r\n            selection.removeAllRanges()\r\n          }else{\r\n            const range = document.createRange()\r\n            range.selectNode(target)\r\n            selection.removeAllRanges()\r\n            selection.addRange(range)\r\n          }\r\n        }\r\n      }\r\n    }}\r\n  >\r\n    {props.textToShow}\r\n  </div>}\r\n  </div></Tooltip>\r\n}\r\n\r\nconst cssText: CSSProperties = {\r\n  height: '100%',\r\n  width: '100%',\r\n  whiteSpace: 'pre-line',\r\n  pointerEvents: 'auto',\r\n  overflowY: 'auto',\r\n  overflowX: 'visible',\r\n  wordWrap: 'break-word',\r\n}\r\nconst useStyles = makeStyles({\r\n  text: cssText,\r\n  textEdit: {\r\n    ...cssText,\r\n    cursor: 'default',\r\n    userSelect: 'text',\r\n  },\r\n})\r\n\r\nexport const Text: React.FC<ContentProps> = (props:ContentProps) => {\r\n  assert(props.content.type === 'text')\r\n  const {contents, participants} = props.stores\r\n  const memberRef = React.useRef<TextMember>(new TextMember())\r\n  const member = memberRef.current\r\n  const classes = useStyles()\r\n  const ref = useRef<HTMLDivElement>(null)\r\n  const url = props.content.url\r\n  const newTexts = JSON.parse(url) as TextMessages\r\n  //const refEdit = useRef<HTMLDivElement>(null)\r\n  const editing = useObserver(() => contents.editing === props.content.id)\r\n  if (editing){\r\n    contents.setBeforeChangeEditing((cur, next) => {\r\n      if (cur === props.content.id && next === ''){\r\n        if (ref.current){\r\n          member.messages = member.messages.filter(text => text.message.length)\r\n          onUpdateTexts(member.messages, ref.current, props)\r\n        }\r\n        contents.setBeforeChangeEditing() //  clear me\r\n      }\r\n    })\r\n  }\r\n  useEffect(() => {\r\n    if (!editing && ref.current) {\r\n      if (ref.current.scrollLeft!==newTexts.scroll[0] || ref.current.scrollTop!==newTexts.scroll[1]){\r\n        member.abortScroll = true\r\n        ref.current?.scroll(newTexts.scroll[0], newTexts.scroll[1])\r\n      }\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  },        [newTexts.scroll[0], newTexts.scroll[1], editing])\r\n\r\n  //  Update remote messages\r\n  const indices = new Set<number>()\r\n  newTexts.messages.forEach((newMessage) => {\r\n    const index = member.messages.findIndex(msg => msg.pid === newMessage.pid && msg.time === newMessage.time)\r\n    if (index === -1) {\r\n      indices.add(member.messages.length)\r\n      member.messages.push(newMessage)       //  Add new messages\r\n    }else if (newMessage.pid !== participants.localId){\r\n      indices.add(index)\r\n      member.messages[index] = newMessage  //  Update remote messages\r\n    }\r\n  })\r\n  //  remove removed messages\r\n  member.messages = member.messages.filter((msg, idx) =>\r\n    msg.pid === participants.localId || indices.has(idx))\r\n  member.messages.sort(compTextMessage)\r\n\r\n  let focusToEdit:undefined|TextMessage = undefined\r\n  if (editing) {\r\n    //  Make a new message to edit if needed.\r\n    const last = member.messages.pop()\r\n    if (last) {\r\n      member.messages.push(last)\r\n    }\r\n    if (last?.pid !== participants.localId) {\r\n      member.messages.push({message:'', pid:participants.localId,\r\n        name:participants.local.information.name,\r\n        color: participants.local.information.color,\r\n        textColor: participants.local.information.textColor,\r\n        time:Date.now()})\r\n    }\r\n    if (!member.editing) {  //  Find the message to focus to edit, i.e. my last message.\r\n      member.messages.reverse()\r\n      focusToEdit = member.messages.find(message => message.pid === participants.localId)\r\n      member.messages.reverse()\r\n    }\r\n  }\r\n\r\n  //  Makeing text (JSX element) to show\r\n  const textDivs = member.messages.map((text, idx) => {\r\n    const textEditing = (editing &&\r\n      (text.pid === participants.localId || !participants.remote.has(text.pid)))\r\n\r\n    let textToShow:JSX.Element[] = []\r\n    if (!textEditing){ textToShow = textToLinkedText(text.message) }\r\n\r\n    return <TextDiv {...props} key={idx} text={text} div={ref.current} textToShow={textToShow}\r\n      member={member} textEditing={textEditing} autoFocus = {text === focusToEdit} />\r\n  })\r\n  const INTERVAL = 200\r\n  const handleScroll = _.debounce((ev:React.UIEvent<HTMLDivElement, UIEvent>) => {\r\n    if (ref.current){\r\n      if (member.abortScroll) {\r\n        member.abortScroll = false\r\n      }else{\r\n        //\tconsole.log('sendScroll')\r\n        onUpdateTexts(member.messages, ref.current, props)\r\n      }\r\n    }\r\n  }, INTERVAL)\r\n  member.editing = editing\r\n\r\n  return  <div ref={ref} className = {editing ? classes.textEdit : classes.text}\r\n    onWheel = {ev => ev.ctrlKey || ev.stopPropagation() }\r\n    onScroll = {(ev) => { if (!editing) {  handleScroll(ev) } }}\r\n    >\r\n    {textDivs}\r\n  </div>\r\n}\r\n","import {PARTICIPANT_SIZE} from '@models/Participant'\r\nimport {Pose3DAudio} from '@models/utils'\r\nimport {mulV3, normV} from '@models/utils/coordinates'\r\nimport errorInfo from '@stores/ErrorInfo'\r\nimport {ConfigurableParams, ConfigurableProp} from './StereoParameters'\r\n\r\nexport function setAudioOutputDevice(audio: HTMLAudioElement, deviceId: string) {\r\n  const audioEx:any = audio\r\n  if (audioEx.setSinkId) {\r\n    audioEx.setSinkId(deviceId).then(\r\n      () => {\r\n        //  console.debug('audio.setSinkId:', deviceId, ' success')\r\n      },\r\n    ).catch(\r\n      () => { console.warn('audio.setSinkId:', deviceId, ' failed') },\r\n    )\r\n  }\r\n}\r\n\r\n\r\n// NOTE Set default value will change nothing. Because value will be overwrite by store in ConnectedGroup\r\n/*\r\nconst DEFAULT_PANNER_NODE_CONFIG: Partial<PannerNode> & {refDistance: number} = {\r\n  panningModel: 'HRTF',\r\n  distanceModel: 'inverse',\r\n  refDistance: PARTICIPANT_SIZE,\r\n  maxDistance: 10000,\r\n  rolloffFactor: 1,\r\n  coneInnerAngle: 45,\r\n  coneOuterAngle: 360,\r\n  coneOuterGain: 0,\r\n}\r\n*/\r\nexport const BROADCAST_DISTANCE = 100000\r\n\r\nexport type PlayMode = 'Context' | 'Element' | 'Pause'\r\n\r\nexport class NodeGroup {\r\n  protected sourceNode: MediaStreamAudioSourceNode | MediaElementAudioSourceNode | undefined = undefined\r\n  protected audioElement: HTMLAudioElement | undefined = undefined\r\n\r\n  protected readonly gainNode: GainNode\r\n  protected readonly pannerNode: PannerNode\r\n  protected readonly destination: MediaStreamAudioDestinationNode\r\n\r\n  protected readonly context: AudioContext\r\n  protected playMode: PlayMode|undefined\r\n  protected audibility = false\r\n\r\n  private audioDeviceId = ''\r\n  private distance = 1\r\n\r\n  constructor(context: AudioContext, destination: MediaStreamAudioDestinationNode,\r\n              playMode: PlayMode|undefined, audibility: boolean) {\r\n    this.context = context\r\n    this.destination = destination\r\n\r\n    this.gainNode = this.createGainNode(context)\r\n    this.pannerNode = this.createPannerNode(context)\r\n\r\n    this.gainNode.connect(this.pannerNode)\r\n    this.pannerNode.connect(this.destination)\r\n\r\n    this.playMode = playMode\r\n    this.updateAudibility(audibility)\r\n  }\r\n\r\n  interval:NodeJS.Timeout|undefined = undefined\r\n  setPlayMode(playMode: PlayMode|undefined) {\r\n    this.playMode = playMode\r\n\r\n    switch (playMode) {\r\n      case 'Pause': {\r\n        this.sourceNode?.disconnect()\r\n        /*try {\r\n          this.pannerNode.disconnect(this.destination)\r\n        }catch (e) {}*/\r\n\r\n        if (this.interval) {\r\n          clearInterval(this.interval)\r\n          this.interval = undefined\r\n        }\r\n        if (this.audioElement) {\r\n          this.audioElement.pause() //  Do not pause when this is for playback.\r\n        }\r\n        break\r\n      }\r\n      case 'Context': {\r\n        this.sourceNode?.connect(this.gainNode)\r\n        //  this.pannerNode.connect(this.destination)\r\n        if (this.interval) {\r\n          clearInterval(this.interval)\r\n          this.interval = undefined\r\n        }\r\n        if (this.audioElement) {\r\n          this.audioElement.pause()\r\n        }\r\n        break\r\n      }\r\n      case 'Element': {\r\n        this.sourceNode?.disconnect()\r\n        /*try {\r\n          this.pannerNode.disconnect(this.destination)\r\n        }catch (e) {}*/\r\n\r\n        if (!this.audioElement) {\r\n          this.audioElement = this.createAudioElement()\r\n        }\r\n        this.audioElement.muted = false\r\n        if (!this.interval) {\r\n          this.interval = setInterval(\r\n            () => {\r\n              if (!errorInfo.type) {\r\n                this?.audioElement?.play().then(() => {\r\n                  //  console.warn(`Succeed to play in NodeGroup`)\r\n                  if (this.interval) {\r\n                    clearInterval(this.interval)\r\n                    this.interval = undefined\r\n                  }\r\n                }).catch(reason => {\r\n                  //  console.warn(`Failed to play in NodeGroup reason:${reason}`)\r\n                })\r\n              }\r\n            },\r\n            500,\r\n          )\r\n        }\r\n        break\r\n      }\r\n      default:\r\n        console.error(`Unknown output: ${playMode}`)\r\n        break\r\n    }\r\n\r\n    this.updateAudibility(this.audibility)\r\n    this.updateVolume()\r\n  }\r\n\r\n  setAudioOutput(id: string) {\r\n    if (this.audioDeviceId !== id) {\r\n      this.audioDeviceId = id\r\n      if (this.audioElement) {\r\n        setAudioOutputDevice(this.audioElement, this.audioDeviceId)\r\n      }\r\n    }\r\n  }\r\n\r\n  updateStream(stream: MediaStream | undefined) {\r\n    this.updateSourceStream(stream)\r\n    this.setPlayMode(this.playMode)\r\n  }\r\n\r\n  updatePose(pose: Pose3DAudio) {\r\n    const dist = normV(pose.position)\r\n    const mul = ((dist * dist) / (this.pannerNode.refDistance * this.pannerNode.refDistance)\r\n      + this.pannerNode.refDistance - 1) / (dist ? dist : 1)\r\n    this.distance = mul * dist\r\n\r\n    if (this.pannerNode.positionX && this.pannerNode.orientationX) {\r\n      this.pannerNode.positionX.setValueAtTime(mul * pose.position[0], this.context.currentTime)\r\n      this.pannerNode.positionY.setValueAtTime(mul * pose.position[1], this.context.currentTime)\r\n      this.pannerNode.positionZ.setValueAtTime(mul * pose.position[2], this.context.currentTime)\r\n      this.pannerNode.orientationX.setValueAtTime(pose.orientation[0], this.context.currentTime)\r\n      this.pannerNode.orientationY.setValueAtTime(pose.orientation[1], this.context.currentTime)\r\n      this.pannerNode.orientationZ.setValueAtTime(pose.orientation[2], this.context.currentTime)\r\n    }else {\r\n      this.pannerNode.setPosition(...mulV3(mul, pose.position))\r\n      this.pannerNode.setOrientation(...pose.orientation)\r\n    }\r\n    this.updateVolume()\r\n  }\r\n  protected updateVolume() {\r\n    let volume = 0\r\n    if (this.playMode === 'Element') {\r\n      volume = Math.pow(Math.max(this.distance, this.pannerNode.refDistance) / this.pannerNode.refDistance,\r\n                        - this.pannerNode.rolloffFactor)\r\n    }\r\n    if (this.audioElement) {\r\n      this.audioElement.volume = volume\r\n    }\r\n  }\r\n\r\n  private _defaultPannerRefDistance = PARTICIPANT_SIZE\r\n  private get defaultPannerRefDistance () { return this._defaultPannerRefDistance }\r\n  private set defaultPannerRefDistance(val: number) {\r\n    this._defaultPannerRefDistance = val\r\n    if (this.pannerNode.refDistance !== BROADCAST_DISTANCE) { // not in broadcast mode\r\n      this.pannerNode.refDistance = this._defaultPannerRefDistance\r\n    }\r\n  }\r\n  updateBroadcast(broadcast: boolean) {\r\n    if (!broadcast) {\r\n      this.pannerNode.refDistance = this.defaultPannerRefDistance\r\n    } else {\r\n      this.pannerNode.refDistance = BROADCAST_DISTANCE\r\n    }\r\n  }\r\n\r\n  updatePannerConfig(config: ConfigurableParams) {\r\n    const observedPannerKeys: ConfigurableProp[] =\r\n      ['coneInnerAngle', 'coneOuterAngle', 'coneOuterGain', 'distanceModel', 'maxDistance', 'distanceModel', 'panningModel', 'refDistance', 'rolloffFactor']\r\n    observedPannerKeys.forEach((key) => {\r\n      if (key === 'refDistance') {\r\n        this.defaultPannerRefDistance = config['refDistance']\r\n      } else {\r\n        (this.pannerNode[key] as any) = config[key]\r\n      }\r\n    })\r\n  }\r\n\r\n  updateAudibility(audibility: boolean) {\r\n    if (audibility) {\r\n      this.gainNode.connect(this.pannerNode)\r\n    } else {\r\n      this.gainNode.disconnect()\r\n    }\r\n\r\n    if (this.audioElement) {\r\n      this.audioElement.muted = !audibility\r\n    }\r\n\r\n    this.audibility = audibility\r\n  }\r\n\r\n  disconnect() {\r\n    if (this.sourceNode) {\r\n      this.sourceNode.disconnect()\r\n    }\r\n\r\n    this.gainNode.disconnect()\r\n    this.pannerNode.disconnect()\r\n    if (this.audioElement) {\r\n      this.audioElement.volume = 0\r\n      this.audioElement.pause()\r\n      this.audioElement.remove()\r\n    }\r\n  }\r\n\r\n  get isBroadcast(): boolean {\r\n    return this.pannerNode.refDistance === BROADCAST_DISTANCE\r\n  }\r\n\r\n  private createGainNode(context: AudioContext) {\r\n    const gain = context.createGain()\r\n\r\n    gain.gain.value = 1\r\n\r\n    return gain\r\n  }\r\n\r\n  private createPannerNode(context: AudioContext) {\r\n    const panner = context.createPanner()\r\n\r\n    return panner\r\n  }\r\n\r\n  private updateSourceStream(stream: MediaStream | undefined) {\r\n    if (this.sourceNode) {\r\n      this.sourceNode.disconnect()\r\n    }\r\n\r\n    if (stream === undefined) {\r\n      this.sourceNode = undefined\r\n\r\n      return\r\n    }\r\n\r\n    this.sourceNode = this.context.createMediaStreamSource(stream)\r\n\r\n    //  Anyway, soruce must be connected audioElement, for the case of Element mode.\r\n    //    if (isChrome) { // NOTE Chorme would not work if not connect stream to audio tag\r\n    if (this.audioElement === undefined) {\r\n      this.audioElement = this.createAudioElement()\r\n    }\r\n\r\n    this.audioElement.srcObject = stream\r\n    //    }\r\n  }\r\n\r\n\r\n  createAudioElement() {\r\n    const audio = new Audio()\r\n    setAudioOutputDevice(audio, this.audioDeviceId)\r\n\r\n    return audio\r\n  }\r\n}\r\n\r\n\r\nexport class NodeGroupForPlayback extends NodeGroup {\r\n  private audioElementForBlob?: HTMLAudioElement\r\n\r\n  playBlob(blob: Blob | undefined){\r\n    this.playSourceBlob(blob)\r\n    this.setPlayMode(this.playMode)\r\n  }\r\n\r\n  private playSourceBlob(blob: Blob | undefined) {\r\n    if (this.sourceNode) {\r\n      this.sourceNode.disconnect()\r\n    }\r\n    if (blob === undefined) {\r\n      this.sourceNode = undefined\r\n\r\n      return\r\n    }\r\n    const url = URL.createObjectURL(blob)\r\n    //  console.log(`playSourceBlob t:${blob.type} sz:${blob.size} ${url}`)\r\n\r\n    //  For the context mode\r\n    if (this.audioElementForBlob){ this.audioElementForBlob.remove() }\r\n    this.audioElementForBlob = this.createAudioElement()\r\n    this.audioElementForBlob.src = url\r\n    this.sourceNode = this.context.createMediaElementSource(this.audioElementForBlob)\r\n    this.sourceNode.connect(this.gainNode)\r\n    this.audioElementForBlob.muted = false\r\n    function playAgain(group: NodeGroupForPlayback){\r\n      group.audioElementForBlob?.play().catch(()=>{\r\n        setTimeout(()=>playAgain(group), 500)\r\n      })\r\n    }\r\n    playAgain(this)\r\n\r\n    //  For the element mode\r\n    if (this.audioElement === undefined) {\r\n      this.audioElement = this.createAudioElement()\r\n      this.audioElement.muted = false\r\n    }\r\n    this.audioElement.src = URL.createObjectURL(blob)\r\n    function playAgain2(group: NodeGroupForPlayback){\r\n      group.audioElement?.play().catch(()=>{\r\n        setTimeout(()=>playAgain2(group), 500)\r\n      })\r\n    }\r\n    playAgain2(this)\r\n  }\r\n\r\n  setPlayMode(playMode: PlayMode|undefined) {\r\n    this.playMode = playMode\r\n    this.updateVolume()\r\n  }\r\n}\r\n","import {BROADCAST_DISTANCE} from '@models/audio/NodeGroup'\r\nimport {ConfigurableParams} from '@models/audio/StereoParameters'\r\nimport {PARTICIPANT_SIZE} from '@models/Participant'\r\nimport participants from '@stores/participants/Participants'\r\nimport {action, autorun, computed, makeObservable, observable} from 'mobx'\r\n\r\nconst PERCENT = 100\r\nconst REFDISTANCE_MAX = 12 * PARTICIPANT_SIZE  // max of no attenuation range\r\n\r\n// Doc of panner node parameters: https://developer.mozilla.org/en-US/docs/Web/API/PannerNode\r\nexport class StereoParameters implements ConfigurableParams {\r\n  @observable coneInnerAngle = 0\r\n  @observable coneOuterAngle = 180\r\n  @observable coneOuterGain = 1\r\n  @observable maxDistance = 10000\r\n  @observable panningModel: PanningModelType = 'HRTF'\r\n  @observable distanceModel: DistanceModelType = 'exponential'\r\n  @observable refDistance = PARTICIPANT_SIZE * 1.5\r\n  @observable rolloffFactor = 38 // 36\r\n  refDistanceNormal:number = this.refDistance\r\n\r\n  constructor(){\r\n    makeObservable(this)\r\n  }\r\n\r\n  //  0 to 100, 0 has strongest attenuation\r\n  @computed\r\n  get hearableRange() {\r\n    return this.refDistance * PERCENT / REFDISTANCE_MAX\r\n  }\r\n\r\n  @action\r\n  setHearableRange(range:number) {\r\n    this.refDistanceNormal = range / PERCENT * REFDISTANCE_MAX\r\n    const onStage = participants.local.physics.onStage\r\n    this.setBroadcast(onStage)\r\n  }\r\n\r\n  // make all participants hearable\r\n  @action\r\n  setBroadcast(bcast:boolean) {\r\n    //  ---------------------------------------------------\r\n    //  Do not hear all even when broadcast\r\n    bcast = false\r\n\r\n    this.refDistance = bcast ? BROADCAST_DISTANCE - 1 : this.refDistanceNormal\r\n    //  console.log(`setBroadcast is called bcast=${bcast}  distance=${this.refDistanceNormal}`)\r\n  }\r\n\r\n  @action\r\n  updateParameters(params: Partial<ConfigurableParams>) {\r\n    Object.assign(this, params)\r\n  }\r\n}\r\n\r\nconst stereoParameters = new StereoParameters()\r\nexport default stereoParameters\r\n\r\nautorun(() => {\r\n  const bcast = participants.local.physics.onStage\r\n  stereoParameters.setBroadcast(bcast)\r\n})\r\n\r\nexport function calcVolume(dist: number){\r\n  const mul = ((dist * dist) / (stereoParameters.refDistance * stereoParameters.refDistance)\r\n  + stereoParameters.refDistance - 1) / (dist ? dist : 1)\r\n  const distance = mul * dist\r\n  const volume = Math.pow(Math.max(distance, stereoParameters.refDistance) / stereoParameters.refDistance,\r\n  - stereoParameters.rolloffFactor)\r\n\r\n  return volume\r\n}\r\n","import {makeStyles} from '@material-ui/core/styles'\r\nimport {PARTICIPANT_SIZE} from '@models/Participant'\r\nimport {assert, normV, shallowEqualsForMap, subV2} from '@models/utils'\r\nimport {calcVolume} from '@stores/AudioParameters/StereoParameters'\r\nimport {contentLog} from '@stores/sharedContents/SharedContents'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React, {useEffect, useRef} from 'react'\r\nimport YouTubePlayer from 'yt-player'\r\nimport {ContentProps} from './Content'\r\n\r\nconst PLAYTIME_TOLERANCE = 0.1\r\n//const contentLog = console.log\r\nconst CHECK_INTERVAL = 333\r\nconst VOLUME_INTERVAL = 200\r\n\r\nfunction getCurrentTimestamp() {\r\n\r\n  return Date.now() * 0.001\r\n}\r\n\r\nconst useStyles = makeStyles({\r\n  iframe: {\r\n    width: '100%',\r\n    height: '100%',\r\n  },\r\n})\r\ntype YTState = 'paused' | 'playing' | 'ended'\r\ntype YTParam = YTState | 'rate' | 'index' | 'list' | 'v'\r\n\r\nclass YTMember{\r\n  player?:YouTubePlayer\r\n  goal: YTState|'' = ''\r\n  skipOnPlaying = 0\r\n  pauseIntervalTimer = 0\r\n  lastCurrentTimePaused = 0\r\n  playTimeout = 0\r\n  pauseTimeout = 0\r\n  params: Map<YTParam, string|undefined> = new Map()\r\n  editing = false\r\n  prevRelPos:[number, number] = [0, 0]\r\n  volumeUI = 0.5          //  volume set by user\r\n  volumeDist = 0          //  volume by distance\r\n  prevVolumeDist = 0      //  previous volume by distance\r\n  volumeIntervalTimer = 0 //  interval timer to check and update volume\r\n  props!: ContentProps\r\n}\r\n\r\nexport function paramArray2map(paramArray: string[]):Map<YTParam, string|undefined> {\r\n  return new Map<YTParam, string|undefined>(\r\n    paramArray.map(param => param.split('=') as [YTParam, string]))\r\n}\r\nexport function paramStr2map(paramStr: string):Map<YTParam, string|undefined> {\r\n  const paramArray = paramStr.split('&')\r\n\r\n  return paramArray2map(paramArray)\r\n}\r\nexport function paramMap2Str(params:Map<string, string|undefined>) {\r\n  let str = ''\r\n  let sep = ''\r\n  for (const param of params) {\r\n    str += `${sep}${param[0]}=${param[1]}`\r\n    sep = '&'\r\n  }\r\n\r\n  return str\r\n}\r\nfunction clearAllTimer(member: YTMember){\r\n  if (member.playTimeout){\r\n    clearTimeout(member.playTimeout)\r\n    member.playTimeout = 0\r\n  }\r\n  if (member.pauseTimeout){\r\n    clearTimeout(member.pauseTimeout)\r\n    member.pauseTimeout = 0\r\n  }\r\n}\r\n\r\nfunction ytSeekAndPlay(start:number, index: number, member: YTMember) {\r\n  assert(member.player)\r\n  member.goal = 'playing'\r\n  clearAllTimer(member)\r\n  const now = getCurrentTimestamp()\r\n  let seekTo = (now - start) * member.player.getPlaybackRate()\r\n  if (member.player.getState() === 'playing' &&\r\n    (member.player.getPlaylist().length === 0 || member.player.getPlaylistIndex() === index) &&\r\n    Math.abs(member.player.getCurrentTime() - seekTo) < PLAYTIME_TOLERANCE) {\r\n\r\n    return  //  already playing and position is good.\r\n  }\r\n\r\n  //  seek and play\r\n  let seekTarget = -1000\r\n  const onTime:TimerHandler = () => {\r\n    if (!member.player) { return }\r\n    const cur = member.player.getCurrentTime()\r\n    //  In case we can start to play now\r\n    if (member.player.getState() === 'paused' && Math.abs(seekTarget - cur) < PLAYTIME_TOLERANCE){\r\n      member.player.play()\r\n      contentLog(`ytSeekAndPlay: ${member.player.getState()}  ` +\r\n      `cur:${member.player.getCurrentTime()}  toSeek:${seekTo}`, member.params)\r\n\r\n      return\r\n    }\r\n\r\n    //  Otherwise, seek, pause and wait again.\r\n    const now = getCurrentTimestamp()\r\n    seekTo = (now - start) * member.player.getPlaybackRate()\r\n    const TIMETOSEEK = 1\r\n    seekTarget = seekTo + TIMETOSEEK * member.player.getPlaybackRate()\r\n    let duration = member.player.getDuration()\r\n    if (member.player.getState() === 'unstarted' || !duration){\r\n      member.skipOnPlaying = 1\r\n      member.player.play()\r\n      duration = member.player.getDuration()\r\n    }\r\n    if (index >= 0 && index !== member.player.getPlaylistIndex()) {\r\n      member.skipOnPlaying = 1\r\n      member.player.playVideoAt(index)\r\n      duration = member.player.getDuration()\r\n    }\r\n    if (duration){\r\n      member.player.pause()\r\n      if (seekTarget > duration) {\r\n        seekTarget = seekTarget % duration\r\n        start = now + TIMETOSEEK - seekTarget / member.player.getPlaybackRate()\r\n      }\r\n      member.player.seek(seekTarget)\r\n    }\r\n    member.playTimeout = setTimeout(onTime, TIMETOSEEK * 1000)\r\n  }\r\n  onTime()\r\n}\r\nfunction ytSeekAndPause(time:number, member: YTMember) {\r\n  assert(member.player)\r\n  member.goal = 'paused'\r\n  clearAllTimer(member)\r\n  const pauseCheck:TimerHandler = () => {\r\n    if (!member.player) { return }\r\n    const indexStr = member.params.get('index')\r\n    const index = Number(indexStr ? indexStr : -1)\r\n    //  make it paused state.\r\n    if (member.player.getState() !== 'paused' ||\r\n      (index >= 0 && index !== member.player.getPlaylistIndex())) {\r\n      if (member.player.getState() === 'unstarted') { member.player.play() }\r\n      if (index >= 0 && index !== member.player.getPlaylistIndex()) {\r\n        member.player.playVideoAt(index)\r\n      }\r\n      member.player.pause()\r\n      member.pauseTimeout = setTimeout(pauseCheck, CHECK_INTERVAL)\r\n\r\n      return\r\n    }\r\n    //  Check if the seek time achieves goal\r\n    if (member.player.getCurrentTime() !== time) {\r\n      member.player.seek(time)\r\n      contentLog(`ytSeekAndPause seek to ${time}`, member.params)\r\n    }\r\n    member.lastCurrentTimePaused = member.player.getCurrentTime()\r\n  }\r\n  pauseCheck()\r\n}\r\nfunction deleteState(params: Map<string, string|undefined>){\r\n  params.delete('playing')\r\n  params.delete('paused')\r\n  params.delete('ended')\r\n}\r\n\r\nfunction ytUpdateState(newState: YTState, time:number, member: YTMember) {\r\n  deleteState(member.params)\r\n  member.params.set(newState, String(time))\r\n  member.params.set('rate', String(member.player?.getPlaybackRate()))\r\n  const idx = member.player?.getPlaylistIndex()\r\n  member.params.set('index', String(idx ? idx : -1))\r\n  member.props.content.url = paramMap2Str(member.params)\r\n  member.props.updateAndSend(member.props.content)\r\n  contentLog(`YT SEND state ${newState} t=${time}`, member.params)\r\n}\r\n\r\nfunction ytPauseInterval(member: YTMember) {  //  Seeked by user duruing paused.\r\n  if (!member.player) { return }\r\n  const state = member.player.getState()\r\n  if (!member.editing && member.goal==='' && state === 'paused') {\r\n    //  when local and remote state is paused (already sent paused).\r\n    const currentTime = member.player.getCurrentTime()\r\n    contentLog(`YT ytPauseInterval cur:${currentTime}, last:${member.lastCurrentTimePaused} param${member.params.get('paused')}`)\r\n    if (Math.abs(currentTime - member.lastCurrentTimePaused) > PLAYTIME_TOLERANCE) {\r\n      member.lastCurrentTimePaused = currentTime\r\n      const paramTime = Number(member.params.get('paused'))\r\n      if (currentTime !== paramTime){\r\n        ytUpdateState('paused', currentTime, member)\r\n      }\r\n    }\r\n  }else {\r\n    if (member.pauseIntervalTimer) {\r\n      clearInterval(member.pauseIntervalTimer)\r\n      member.pauseIntervalTimer = 0\r\n    }\r\n  }\r\n\r\n  return undefined\r\n}\r\n\r\nfunction updateUIVolume(member:YTMember){\r\n  if (!member.player){ return }\r\n  if (member.volumeDist === 1 && member.prevVolumeDist === 1){\r\n    const curVolume = member.player.getVolume() / 100\r\n    if (curVolume !== member.volumeUI){\r\n      member.volumeUI = curVolume\r\n      //  console.log(`volumeUI Changed:${member.volumeUI} cur:${curVolume}`)\r\n    }\r\n  }else{\r\n    member.player.setVolume(member.volumeUI * member.volumeDist * 100)\r\n  }\r\n  member.prevVolumeDist = member.volumeDist\r\n}\r\nfunction updateVolume(distance:number, member: YTMember){\r\n  if (member.player){\r\n    member.volumeDist = calcVolume(distance)\r\n    member.player.setVolume(member.volumeUI * member.volumeDist * 100)\r\n    //  console.log(`updateVolume(${distance}) UI:${member.volumeUI} D:${member.volumeDist}`)\r\n  }\r\n}\r\nfunction checkPositionsForVolume(member:YTMember){\r\n  if (!member.props.stores.participants) { return }\r\n  updateUIVolume(member)\r\n  const relPos = subV2(member.props.content.pose.position, member.props.stores.participants.local.pose.position)\r\n  const diff = subV2(relPos, member.prevRelPos)\r\n  if (normV(diff) > PARTICIPANT_SIZE * 0.1){\r\n    member.prevRelPos = [relPos[0], relPos[1]]\r\n    for(let i=0; i<2; i++){\r\n      if (relPos[i] < 0){\r\n        relPos[i] += member.props.content.size[i]\r\n        if (relPos[i] > 0) { relPos[i] = 0 }\r\n      }\r\n    }\r\n    const dist = normV(relPos)\r\n    updateVolume(dist, member)\r\n  }\r\n}\r\n\r\n\r\n/* Memo about youtube state\r\n *  played=time time=start time stamp  in ms\r\n *  paused=time time=current time in the clip.\r\n*/\r\n\r\nexport const YouTube: React.FC<ContentProps> = (props:ContentProps) => {\r\n  assert(props.content.type === 'youtube')\r\n  const classes = useStyles()\r\n  const memberRef = useRef<YTMember>(new YTMember())\r\n  const member = memberRef.current\r\n  member.props = props\r\n\r\n  //  Editing (No sync) ?\r\n  const editing = useObserver(() => props.stores.contents.editing === props.content.id)\r\n\r\n  //  Check params and reflect them to ytPlayer\r\n  const oldParams = member.params\r\n  member.params = paramStr2map(props.content.url)\r\n  if (!editing && (member.editing || !shallowEqualsForMap(member.params, oldParams))) {\r\n    if (member.player) {\r\n      if (member.params.get('rate') !== oldParams.get('rate')){ //  set playback rate\r\n        member.player.setPlaybackRate(Number(member.params.get('rate')))\r\n      }\r\n      //  set state\r\n      const newPlaying = member.params.get('playing')\r\n      const moveToPlay = newPlaying!==undefined && newPlaying !== oldParams.get('playing')\r\n      const newPaused = member.params.get('paused')\r\n      const moveToPause = newPaused!==undefined && newPaused !== oldParams.get('paused')\r\n      if (moveToPlay) {\r\n        contentLog(`YT render move to play=${newPlaying} state`)\r\n        ytSeekAndPlay(Number(member.params.get('playing')), Number(member.params.get('index')), member)\r\n      }else if (moveToPause) {\r\n        contentLog(`YT render move to pause=${newPaused} state`)\r\n        ytSeekAndPause(Number(member.params.get('paused')), member)\r\n      }\r\n    }\r\n  }\r\n  member.editing = editing\r\n\r\n  //  Create player when the component is created.\r\n  useEffect(\r\n    () => {\r\n      assert(props.content.id)\r\n      let selfPlayed = false\r\n      if (!member.player) {\r\n        const id = `#YT${props.content.id}`\r\n        const player = new YouTubePlayer(id)\r\n        if (!member.params.has('playing') && !member.params.has('paused') && !member.params.has('ended')){\r\n          //member.skipOnPlaying = 1\r\n          selfPlayed = true\r\n          member.params.set('playing', String(-1))\r\n          player.play()\r\n        }\r\n        member.player = player\r\n        contentLog(`YTPlayer for ${id} created`)\r\n        //  set initial parameters\r\n        if (member.params.has('rate')){\r\n          player.setPlaybackRate(Number(member.params.get('rate')))\r\n        }\r\n        if (!member.editing){\r\n          if (member.params.has('paused')) {\r\n            ytSeekAndPause(Number(member.params.get('paused')), member)\r\n          }else if (!selfPlayed && member.params.has('playing')){\r\n            ytSeekAndPlay(Number(member.params.get('playing')), Number(member.params.get('index')), member)\r\n          }\r\n        }\r\n\r\n        ///*\r\n        player.on('error', (err:any) => contentLog('YT on error ', err))\r\n        player.on('buffering', () => contentLog('YT on buffering'))\r\n        player.on('cued', () => contentLog('YT on cued'))     //  */\r\n\r\n        player.on('unstarted', () => {\r\n          contentLog('YT on unstarted')\r\n          player.unMute()\r\n        })\r\n        player.on('ended', () => {\r\n          contentLog('YT on ended')\r\n          if (member.player){\r\n            const now = getCurrentTimestamp()\r\n            ytSeekAndPlay(now, 0, member)\r\n          }\r\n          //ytUpdateState('ended', 0, member)\r\n        })\r\n        player.on('paused', () => {\r\n          contentLog(`YT on paused at ${player.getCurrentTime()} goal:${member.goal}`, member.params)\r\n          if (member.goal === 'paused') { //  paused by remote\r\n            member.goal = ''\r\n          }else if(member.goal === ''){   //  paused by user's operation\r\n            if (!member.params.has('paused')) {\r\n              setTimeout(()=>{\r\n                if (!member.params.has('paused') && !member.params.has('playing') && player.getState() === 'paused'){\r\n                  ytUpdateState('paused', player.getCurrentTime(), member)\r\n                }\r\n              }, 1000)\r\n            }\r\n          }else{\r\n            contentLog(`paused for goal ${member.goal}`)\r\n          }\r\n          //  Add interval timer to check seek when paused is acheived.\r\n          if (member.goal === '' && !member.pauseIntervalTimer) {\r\n            member.pauseIntervalTimer\r\n              = setInterval(ytPauseInterval, CHECK_INTERVAL, member)\r\n          }\r\n        })\r\n        player.on('playing', () => {\r\n          contentLog(`YT on playing goal=${member.goal} skip=${member.skipOnPlaying}`, member.params)\r\n          let indexUpdated = false\r\n          if (player.getPlaylist().length > 0) {\r\n            if (player.getPlaylistIndex() !== Number(member.params.get('index'))) {\r\n              member.params.set('index', String(player.getPlaylistIndex()))\r\n              indexUpdated = true\r\n            }\r\n          }\r\n          if (member.goal === 'playing'){ //  play by remote\r\n            if (member.skipOnPlaying){\r\n              member.skipOnPlaying = 0\r\n            }else{\r\n              member.goal = ''\r\n            }\r\n          }else if (member.goal === ''){\r\n            const now = getCurrentTimestamp()\r\n            const elasp = player.getCurrentTime() / player.getPlaybackRate()\r\n            const start = now - elasp\r\n            let started = Number(member.params.get('playing'))\r\n            if (started === -1){ started = start }\r\n            const diff = start - started\r\n            if (!member.params.has('playing') || indexUpdated || Math.abs(diff) > PLAYTIME_TOLERANCE) {\r\n              //  play by user or index in play list changed or seeked.\r\n              ytUpdateState('playing', start, member)\r\n            }\r\n          }\r\n        })\r\n        player.on('playbackRateChange', () => {\r\n          contentLog(`YT on playbackRateChange`)\r\n          const now = getCurrentTimestamp()\r\n          const elasp = player.getCurrentTime() / player.getPlaybackRate()\r\n          const start = now - elasp\r\n          const state = player.getState()\r\n          const ytState:YTState = state === 'paused' ? 'paused' : state === 'playing' ? 'playing' : 'ended'\r\n          ytUpdateState(ytState, start, member)\r\n        })\r\n      }\r\n\r\n      //  set video clip id\r\n      const player = member.player\r\n      if (player) {\r\n        if (member.params.has('list')) {\r\n          player.loadList({\r\n            listType:'playlist',\r\n            list:member.params.get('list') as string,\r\n          })\r\n          contentLog(`YT loadList: ${member.params.get('list')}`)\r\n        }else if (member.params.has('v')) {\r\n          player.load(member.params.get('v') as string)\r\n          contentLog(`YT load: ${member.params.get('v')}`)\r\n        }\r\n      }\r\n\r\n      if (!member.volumeIntervalTimer){\r\n        member.volumeIntervalTimer = setInterval(checkPositionsForVolume, VOLUME_INTERVAL, member)\r\n      }\r\n\r\n      return () => {\r\n        if (member.player) {\r\n          member.player.destroy()\r\n        }\r\n        member.player = undefined\r\n        if (member.volumeIntervalTimer){\r\n          clearInterval(member.volumeIntervalTimer)\r\n        }\r\n      }\r\n    },\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    [],\r\n  )\r\n\r\n  return <div id={`YT${props.content.id}`} className={classes.iframe} />\r\n}\r\n","import {BMProps} from '@components/utils'\r\nimport whiteboard24Regular from '@iconify/icons-fluent/whiteboard-24-regular'\r\nimport filePdfBox from '@iconify/icons-mdi/file-pdf-box'\r\nimport GoogleDriveIcon from '@iconify/icons-mdi/google-drive'\r\nimport {Icon} from '@iconify/react'\r\nimport {makeStyles} from '@material-ui/core/styles'\r\nimport CameraAltIcon from '@material-ui/icons/CameraAlt'\r\nimport HttpIcon from '@material-ui/icons/Http'\r\nimport PhotoIcon from '@material-ui/icons/Photo'\r\nimport ScreenShareIcon from '@material-ui/icons/ScreenShare'\r\nimport SubjectIcon from '@material-ui/icons/Subject'\r\nimport YouTubeIcon from '@material-ui/icons/YouTube'\r\nimport {ContentType, ISharedContent} from '@models/ISharedContent'\r\nimport {t} from '@models/locales'\r\nimport { isSmartphone } from '@models/utils'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React from 'react'\r\nimport {GDrive} from './GDrive'\r\nimport {PDF} from './PDF'\r\nimport {PlaybackScreenContent} from './PlaybackScreenContent'\r\nimport {ScreenContent} from './ScreenContent'\r\nimport {Text} from './Text'\r\nimport {YouTube} from './YouTube'\r\n\r\nexport function contentTypeIcons(type: ContentType, size = 12, width = -1) {\r\n  if (width < 0) { width = size }\r\n  /* const icons = {\r\n    img: <PhotoIcon style={{fontSize:size, width}} />,\r\n    text:<SubjectIcon style={{fontSize:size, width}} />,\r\n    iframe: <HttpIcon style={{fontSize:size, width}} />,\r\n    youtube: <YouTubeIcon style={{fontSize:size, width}} />,\r\n    screen: <ScreenShareIcon style={{fontSize:size, width}} />,\r\n    gdrive: <span style={{width, height:size}}><Icon icon={GoogleDriveIcon} height={size} /></span>,\r\n    whiteboard: <span style={{width, height:size}}><Icon icon={whiteboard24Regular} height={size} /></span>,\r\n    camera: <CameraAltIcon style={{fontSize:size, width}} />,\r\n    pdf : <span style={{width, height:size}}><Icon icon={filePdfBox} height={size} /></span>,\r\n    playbackScreen: <ScreenShareIcon style={{fontSize:size, width}} />,\r\n    playbackCamera: <CameraAltIcon style={{fontSize:size, width}} />,\r\n    '': undefined,\r\n  } */\r\n  const icons = {\r\n    img: <PhotoIcon style={isSmartphone() ? {fontSize:size, width: '70px', height:'70px'} : {fontSize:size, width: '40px', height:'40px'}} />,\r\n    text:<SubjectIcon /* style={{fontSize:size, width: '40px', height:'40px'}} */ style={isSmartphone() ? {fontSize:size, width: '70px', height:'70px'} : {fontSize:size, width: '40px', height:'40px'}} />,\r\n    iframe: <HttpIcon style={{fontSize:size, width}} />,\r\n    youtube: <YouTubeIcon style={{fontSize:size, width}} />,\r\n    screen: <ScreenShareIcon /* style={{fontSize:size, width: '40px', height:'40px'}} */ style={isSmartphone() ? {fontSize:size, width: '70px', height:'70px'} : {fontSize:size, width: '40px', height:'40px'}} />,\r\n    gdrive: <span style={{width, height:size}}><Icon icon={GoogleDriveIcon} height={size} /></span>,\r\n    whiteboard: <span style={{width, height:size}}><Icon icon={whiteboard24Regular} height={size} /></span>,\r\n    camera: <CameraAltIcon style={{fontSize:size, width}} />,\r\n    pdf : <span style={{width, height:size}}><Icon icon={filePdfBox} height={size} /></span>,\r\n    playbackScreen: <ScreenShareIcon style={{fontSize:size, width}} />,\r\n    playbackCamera: <CameraAltIcon style={{fontSize:size, width}} />,\r\n    chat: <></>,\r\n    content: <></>,\r\n    '': undefined,\r\n  }\r\n\r\n  return icons[type]\r\n}\r\nexport function editButtonTip(editing: boolean, c?: ISharedContent){\r\n  const type = c ? c.type : ''\r\n  if (type === 'whiteboard'){\r\n    return editing ? t('ctEndEditWhiteboard') : t('ctEditWhiteboard')\r\n  }else if (type === 'gdrive'){\r\n    return editing ? t('ctEndEditGDrive') : t('ctEditGDrive')\r\n  }else if (type === 'youtube'){\r\n    return editing ? t('ctEndEditYoutube') : t('ctEditYoutube')\r\n  }else if (type === 'iframe'){\r\n    return editing ? t('ctEndEditIframe') : t('ctEditIframe')\r\n  }else if (type === 'text'){\r\n    return editing ? t('ctEndEditText') : t('ctEditText')\r\n  }\r\n\r\n  return ''\r\n}\r\n\r\n\r\nconst useStyles = makeStyles({\r\n  img: {\r\n    width: '100%',\r\n    height: '100%',\r\n    verticalAlign: 'bottom',\r\n    userDrag: 'none',\r\n    pointerEvents: 'none',\r\n  },\r\n  iframe: {\r\n    width: '100%',\r\n    height: '100%',\r\n    pointerEvents: 'none',\r\n    border: 'none',\r\n  },\r\n  iframeEdit: {\r\n    width: '100%',\r\n    height: '100%',\r\n    border: 'none',\r\n  },\r\n  div:{\r\n    width: '100%',\r\n    height: '100%',\r\n  },\r\n})\r\nexport interface ContentProps extends BMProps{\r\n  content:ISharedContent\r\n  updateAndSend: (c: ISharedContent) => void\r\n  updateOnly: (c:ISharedContent) => void\r\n}\r\nexport const RawContent: React.FC<ContentProps> = (props:ContentProps) => {\r\n  const classes = useStyles()\r\n  const editing = useObserver(() => props.stores.contents.editing === props.content.id)\r\n\r\n  let rv\r\n  if (props.content.type === 'img') {\r\n    rv = <img className={classes.img} src={props.content.url} alt={props.content.name}/>\r\n  }else if (props.content.type === 'iframe' || props.content.type === 'whiteboard') {\r\n    rv = <div className={classes.div}>\r\n      <iframe className={editing ? classes.iframeEdit : classes.iframe}\r\n        style={props.content.type==='whiteboard'?{backgroundColor: props.content.noFrame?'rgba(0,0,0,0)':'white'}:{}}\r\n        src={props.content.url} key={props.content.name} title={props.content.name}/>\r\n      </div>\r\n  }else if (props.content.type === 'youtube') {\r\n    rv = <YouTube {...props} />\r\n  }else if (props.content.type === 'gdrive') {\r\n    rv = <GDrive {...props} />\r\n  }else if (props.content.type === 'pdf') {\r\n    rv = <PDF {...props} />\r\n  }else if (props.content.type === 'text') {\r\n    rv = <Text {...props} />\r\n  }else if (props.content.type === 'screen' || props.content.type === 'camera') {\r\n    rv = <ScreenContent {...props} />\r\n  }else if (props.content.type === 'playbackScreen' || props.content.type === 'playbackCamera') {\r\n    rv = <PlaybackScreenContent {...props} />\r\n  }else {\r\n    rv = <div>Unknown type:{props.content.type} for {props.content.url}</div>\r\n  }\r\n\r\n  return rv\r\n}\r\n\r\nexport const Content = (props: ContentProps) =>\r\n  React.useMemo(() => <RawContent {...props} />,\r\n  //  eslint-disable-next-line react-hooks/exhaustive-deps\r\n  [props.content.url, props.content.id, props.content.type, props.stores.contents.editing === props.content.id,\r\n   props.content.pose, props.content.size, props.content.originalSize])\r\nContent.displayName = 'Content'\r\n","import imageLine from '@iconify-icons/clarity/image-line'\r\nimport imageOutlineBadged from '@iconify-icons/clarity/image-outline-badged'\r\nimport hiMeeting from '@iconify-icons/healthicons/group-discussion-meetingx3'\r\nimport roomClosed from '@iconify-icons/healthicons/square-medium-negative'\r\nimport clipboardCopy from '@iconify-icons/heroicons-outline/clipboard-copy'\r\nimport biDashCircleDotted from '@iconify/icons-bi/dash-circle-dotted'\r\nimport biImage from '@iconify/icons-bi/image'\r\nimport biImageNoFrame from '@iconify/icons-bi/image-alt'\r\nimport roomOpen from '@iconify/icons-fluent/square-hint-24-regular'\r\n\r\nimport biPlusCircleFill from '@iconify/icons-bi/plus-circle-fill'\r\n\r\n/* import pinIcon from '@iconify/icons-mdi/pin'\r\nimport pinOffIcon from '@iconify/icons-mdi/pin-off' */\r\n\r\nimport {Icon} from '@iconify/react'\r\nimport Box from '@material-ui/core/Box'\r\nimport Button from '@material-ui/core/Button'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Popover, { PopoverProps } from '@material-ui/core/Popover'\r\nimport Slider from '@material-ui/core/Slider'\r\nimport Switch from '@material-ui/core/Switch'\r\nimport Table from '@material-ui/core/Table'\r\nimport TableBody from '@material-ui/core/TableBody'\r\nimport TableCell from '@material-ui/core/TableCell'\r\nimport TableRow from '@material-ui/core/TableRow'\r\nimport TextField from '@material-ui/core/TextField'\r\nimport CloseRoundedIcon from '@material-ui/icons/CloseRounded'\r\nimport DoneIcon from '@material-ui/icons/Done'\r\nimport EditIcon from '@material-ui/icons/Edit'\r\nimport FlipToBackIcon from '@material-ui/icons/FlipToBack'\r\nimport FlipToFrontIcon from '@material-ui/icons/FlipToFront'\r\nimport {ISharedContent} from '@models/ISharedContent'\r\nimport {canContentBeAWallpaper, isContentEditable, isContentWallpaper} from '@models/ISharedContent'\r\nimport {t} from '@models/locales'\r\nimport {isSmartphone, Pose2DMap} from '@models/utils'\r\nimport {copyContentToClipboard,  makeContentWallpaper,\r\n   moveContentToBottom, moveContentToTop} from '@stores/sharedContents/SharedContentCreator'\r\nimport {TITLE_HEIGHT} from '@stores/sharedContents/SharedContents'\r\nimport {Observer} from 'mobx-react-lite'\r\nimport React, {Fragment} from 'react'\r\nimport {contentTypeIcons, editButtonTip} from './Content'\r\nimport {RndContentProps} from './RndContent'\r\nimport { MuiThemeProvider, createTheme } from '@material-ui/core/styles'\r\n\r\n\r\nconst theme = createTheme({\r\n  palette: {\r\n    primary: { main: '#7ececc' },\r\n    secondary: { main: '#ef4623' }\r\n  }\r\n});\r\n\r\ntype PopoverPropsNoOnClose = Omit<PopoverProps, 'onClose'>\r\nexport interface SharedContentFormProps extends Omit<RndContentProps, 'content'>, PopoverPropsNoOnClose{\r\n  close: () => void,\r\n  content?: ISharedContent\r\n  open: boolean\r\n}\r\n\r\ntype ContentType = JSX.Element | string\r\n\r\nfunction Row(left1: ContentType, left2: ContentType, center: ContentType,\r\n  right2: ContentType, right1: ContentType, key?: string|number){\r\n  const cellstyle = {\r\n    margin:0,\r\n    padding:2,\r\n    border:'none',\r\n  }\r\n\r\n  const centerCellstyle = {\r\n    margin:0,\r\n    padding:2,\r\n    border:'none',\r\n    transform: isSmartphone() ? 'scale(1.5)' : 'scale(1)'\r\n  }\r\n\r\n  /* return <TableRow key={key}>\r\n    <TableCell align=\"right\" style={cellstyle}>{left1}</TableCell>\r\n    <TableCell align=\"right\" style={cellstyle}>{left2}</TableCell>\r\n    <TableCell align=\"center\" style={cellstyle}>{center}</TableCell>\r\n    <TableCell style={cellstyle}>{right2}</TableCell>\r\n    <TableCell style={cellstyle}>{right1}</TableCell>\r\n  </TableRow> */\r\n  return <TableRow key={key}>\r\n    <TableCell align=\"right\" style={cellstyle}>{left1}</TableCell>\r\n    <TableCell align=\"right\" style={cellstyle}>{left2}</TableCell>\r\n    <TableCell align=\"center\" style={centerCellstyle}>{center}</TableCell>\r\n    <TableCell style={cellstyle}>{right2}</TableCell>\r\n    <TableCell style={cellstyle}>{right1}</TableCell>\r\n  </TableRow>\r\n}\r\n\r\nclass SharedContentFormMember{\r\n  zorder!: number\r\n  pinned!: boolean\r\n  editing!: string\r\n  showTitle!: boolean\r\n  name!: string\r\n  pose!: Pose2DMap\r\n  constructor(props: SharedContentFormProps){\r\n    this.save(props)\r\n  }\r\n  save(props: SharedContentFormProps){\r\n    if (!props.content) { return }\r\n    this.zorder = props.content.zorder\r\n    this.pinned = props.content.pinned\r\n    this.name = props.content.name\r\n    this.pose = props.content.pose\r\n    this.editing = props.stores.contents.editing\r\n    this.showTitle = props.content.showTitle\r\n  }\r\n  restore(props: SharedContentFormProps){\r\n    if (!props.content) { return }\r\n    props.content.zorder = this.zorder\r\n    props.content.pinned = this.pinned\r\n    props.content.name = this.name\r\n    props.content.pose = this.pose\r\n    props.stores.contents.setEditing(this.editing)\r\n    this.showTitle = props.content.showTitle\r\n  }\r\n}\r\nexport const SharedContentForm: React.FC<SharedContentFormProps> = (props: SharedContentFormProps) => {\r\n  const memberRef = React.useRef(new SharedContentFormMember(props))\r\n  const member = memberRef.current\r\n\r\n  const tfLStyle = {fontSize: isSmartphone() ? '2em' : '1em'}\r\n\r\n\r\n  function closeForm(ev:Object, reason:string) {\r\n    if (reason === 'enter' || reason==='backdropClick'){\r\n      member.save(props)\r\n      if (props.content){\r\n        props.updateAndSend(props.content)\r\n      }\r\n    }\r\n    props.close()\r\n  }\r\n  const onKeyPress = (ev:React.KeyboardEvent) => {\r\n    if (ev.key === 'Enter') {\r\n      closeForm(ev, 'enter')\r\n    }\r\n  }\r\n\r\n  const extractPopoverProps = ({onClose, autoHideTitle, updateAndSend, updateOnly, close, ...reminder}\r\n    : SharedContentFormProps) => reminder\r\n    const {contents, map} = props.stores\r\n    const popoverProps:PopoverPropsNoOnClose = extractPopoverProps(props)\r\n\r\n  return <Popover onClose={closeForm} {...popoverProps} onMouseDown={(ev)=>{\r\n    ev.stopPropagation()\r\n  }}>\r\n    <Observer>{()=>\r\n      <DialogContent>\r\n        <table><tbody><tr><td>\r\n       {contentTypeIcons(props.content ? props.content.type : '', TITLE_HEIGHT)}\r\n       </td><td>\r\n        <TextField label={t('ctName')} multiline={false} value={props.content ? props.content.name : ''}\r\n          inputProps={{autoFocus:true, style:tfLStyle}}\r\n          style={{marginLeft:20, width:'100%'}}\r\n          InputLabelProps={{style:tfLStyle}}\r\n          onChange={event => {\r\n            //setName(event.target.value)\r\n            if (!props.content) { return }\r\n            props.content.name = event.target.value\r\n            props.updateOnly(props.content)\r\n          }}\r\n          onKeyPress={onKeyPress} fullWidth={true}\r\n        />\r\n        </td></tr></tbody></table>\r\n        <MuiThemeProvider theme={theme}>\r\n        <Box mt={2} mb={2}>\r\n          <Button variant=\"contained\" style={{textTransform:'none', fontSize:isSmartphone() ? '2em' : '1em'}}\r\n            onClick={()=>{\r\n              if (!props.content) { return }\r\n              moveContentToTop(props.content)\r\n              props.updateOnly(props.content)\r\n            }}><FlipToFrontIcon style={tfLStyle}  />&nbsp; {t('ctMoveTop')}</Button> &nbsp;\r\n          <Button variant=\"contained\" style={{textTransform:'none', fontSize:isSmartphone() ? '2em' : '1em'}}\r\n            onClick={()=>{\r\n              if (!props.content) { return }\r\n              moveContentToBottom(props.content)\r\n              props.updateOnly(props.content)\r\n            }}><FlipToBackIcon style={tfLStyle} />&nbsp; {t('ctMoveBottom')}</Button> &nbsp;\r\n        </Box>\r\n        <Box mt={2} mb={2}>\r\n          <Button variant=\"contained\" style={{textTransform:'none', fontSize:isSmartphone() ? '2em' : '1em'}}\r\n            onClick={()=>{\r\n              if (!props.content) { return }\r\n              copyContentToClipboard(props.content)\r\n            }}><Icon style={tfLStyle} icon={clipboardCopy} height={TITLE_HEIGHT}/>&nbsp; {t('ctCopyToClipboard')}</Button> &nbsp;\r\n          <Button variant=\"contained\" style={{textTransform:'none', fontSize:isSmartphone() ? '2em' : '1em'}}\r\n            onClick={()=>{\r\n              if (!props.content) { return }\r\n              map.focusOn(props.content)\r\n            }}>{t('ctFocus')}</Button>\r\n        </Box>\r\n        <Table size=\"small\" ><TableBody>{[\r\n          /* Row(t('ctUnpin'),<Icon icon={pinOffIcon} height={TITLE_HEIGHT} />,\r\n            <Switch color=\"primary\" checked={props.content?.pinned} onChange={(ev, checked)=>{\r\n              if (!props.content) { return }\r\n              props.content.pinned = checked\r\n              props.updateOnly(props.content)\r\n            }}/>, <Icon icon={pinIcon} height={TITLE_HEIGHT} />, t('ctPin'), 'pin'), */\r\n            Row(<span style={{fontSize:isSmartphone() ? '2em' : '1em'}}>{t('ctUnTitle')}</span>,<Icon icon={biImage} height={isSmartphone() ? (TITLE_HEIGHT * 1.2) : TITLE_HEIGHT} />,\r\n           <Switch color=\"secondary\" checked={props.content?.showTitle} onChange={(ev, checked)=>{\r\n             if (!props.content) { return }\r\n             props.content.showTitle = checked\r\n             props.updateOnly(props.content)\r\n           }}/>, <Icon icon={biImage} height={isSmartphone() ? (TITLE_HEIGHT * 1.2) : TITLE_HEIGHT} />, <span style={{fontSize:isSmartphone() ? '2em' : '1em'}}>{t('ctTitle')}</span>, 'title'),\r\n\r\n          <Fragment key=\"edit\">{isContentEditable(props.content) ?\r\n            Row(editButtonTip(true, props.content),<DoneIcon />,\r\n            <Switch color=\"secondary\" checked={props.content?.id === contents.editing} onChange={(ev, checked)=>{\r\n              if (!props.content) { return }\r\n              contents.setEditing(checked ? props.content.id : '')\r\n            }}/>, <EditIcon />, editButtonTip(false, props.content)) : undefined}</Fragment>,\r\n          <Fragment key=\"wall\">{canContentBeAWallpaper(props.content) ?\r\n            Row(<span style={{fontSize:isSmartphone() ? '2em' : '1em'}}>{t('ctUnWallpaper')}</span>, <Icon icon={imageLine} height={isSmartphone() ? (TITLE_HEIGHT * 1.2) : TITLE_HEIGHT}/>,\r\n            <Switch color=\"secondary\" checked={isContentWallpaper(props.content)} onChange={(ev, checked)=>{\r\n              if (!props.content) { return }\r\n              makeContentWallpaper(props.content, checked)\r\n              props.updateOnly(props.content)\r\n            }}/>, <Icon icon={imageOutlineBadged} height={isSmartphone() ? (TITLE_HEIGHT*1.2) : TITLE_HEIGHT}/>, <span style={{fontSize:isSmartphone() ? '2em' : '1em'}}>{t('ctWallpaper')}</span>) : undefined}</Fragment>,\r\n          <Fragment key=\"noFrame\">{\r\n            Row(<span style={{fontSize:isSmartphone() ? '2em' : '1em'}}>{t('ctFrameVisible')}</span>, <Icon icon={biImage} height={isSmartphone() ? (TITLE_HEIGHT * 1.2) : TITLE_HEIGHT}/>,\r\n            <Switch color=\"secondary\" checked={props.content?.noFrame ? true : false} onChange={(ev, checked)=>{\r\n              if (!props.content) { return }\r\n              props.content.noFrame = checked ? true : undefined\r\n              props.updateOnly(props.content)\r\n            }}/>, <Icon icon={biImageNoFrame} height={isSmartphone() ? (TITLE_HEIGHT * 1.2) : TITLE_HEIGHT}/>, <span style={{fontSize:isSmartphone() ? '2em' : '1em'}}>{t('ctFrameInvisible')}</span>) }</Fragment>,\r\n          <Fragment key=\"zone\">{\r\n            props.content?.type === 'img' ?\r\n            Row(<span style={{fontSize:isSmartphone() ? '2em' : '1em'}}>{t('ctNotAudioZone')}</span>, <Icon icon={imageLine} height={isSmartphone() ? (TITLE_HEIGHT * 1.2) : TITLE_HEIGHT}/>,\r\n              <Switch color=\"secondary\" checked={props.content?.zone!==undefined} onChange={(ev, checked)=>{\r\n                if (!props.content) { return }\r\n                props.content.zone = checked ? (props.content.zone ? props.content.zone : 'open') : undefined\r\n                props.updateOnly(props.content)\r\n                }}/>, <Icon icon={hiMeeting} height={TITLE_HEIGHT}/>,\r\n              <>\r\n                { props.content.zone ? <IconButton size={'small'} onClick={()=>{\r\n                  if (!props.content){ return }\r\n                  props.content.zone = props.content.zone === 'close' ? 'open' : 'close'\r\n                  props.updateOnly(props.content)}}>\r\n                  <Icon icon={props.content.zone==='close' ? roomClosed : roomOpen} height={isSmartphone() ? (TITLE_HEIGHT * 1.2) : TITLE_HEIGHT}/>\r\n                </IconButton> : undefined}\r\n                {props.content.zone === 'close' ? <span style={{fontSize:isSmartphone() ? '2em' : '1em'}}>{t('ctClosedAudioZone')}</span> : <span style={{fontSize:isSmartphone() ? '2em' : '1em'}}>{t('ctOpenAudioZone')}</span>}\r\n              </>) : undefined }</Fragment>,\r\n          <Fragment key=\"opacity\">{\r\n            Row(<span style={{fontSize:isSmartphone() ? '2em' : '1em'}}>{t('ctTransparent')}</span>, <Icon icon={biDashCircleDotted} height={isSmartphone() ? (TITLE_HEIGHT * 1.2) : TITLE_HEIGHT}/>,\r\n            <Slider color=\"secondary\" value={props.content?.opacity===undefined ? 1000 : props.content.opacity*1000}\r\n              min={0} max={1000}\r\n              /* style={{width:'6em', marginLeft:'0.4em', marginRight:'0.4em'}} */\r\n              style={{width:isSmartphone() ? '2em' : '6em', marginLeft:isSmartphone() ? '4em' : '0.4em', marginRight:isSmartphone() ? '4em' : '0.4em', transform:isSmartphone() ? 'scale(2)' : 'scale(1'}}\r\n              onChange={(ev, value) => {\r\n                if (!props.content) { return }\r\n                props.content.opacity = value === 1000 ? undefined : (value as number) / 1000\r\n                props.updateOnly(props.content)\r\n            }} />, <Icon icon={biPlusCircleFill} height={isSmartphone() ? (TITLE_HEIGHT * 1.2) : TITLE_HEIGHT}/>, <span style={{fontSize:isSmartphone() ? '2em' : '1em'}}>{t('ctOpaque')}</span>) }</Fragment>,\r\n            ]}</TableBody></Table>\r\n        <Box mt={2} mb={2}>\r\n          <Button variant=\"contained\" color=\"primary\" style={{textTransform:'none', fontSize:isSmartphone() ? '2em' : '1em'}}\r\n            onClick={()=>{\r\n              closeForm({}, 'enter')\r\n            }}>{t('btSave')}</Button>\r\n          <Button variant=\"contained\" color=\"secondary\" style={{textTransform:'none', marginLeft:15, fontSize:isSmartphone() ? '2em' : '1em'}}\r\n            onClick={()=>{\r\n              if (!props.content) { return }\r\n              member.restore(props)\r\n              props.updateOnly(props.content)\r\n            }}>{t('btCancel')}</Button>\r\n          <Button variant=\"contained\" color=\"secondary\" style={{textTransform:'none', marginLeft:60, fontSize:isSmartphone() ? '2em' : '1em'}}\r\n           /*  disabled={props.content?.pinned || isContentWallpaper(props.content)} */\r\n            onClick={(ev)=>{\r\n              props.onClose(ev)\r\n            }}><CloseRoundedIcon /> &nbsp; {t('ctDelete')}</Button> &nbsp;&nbsp;\r\n        </Box>\r\n        </MuiThemeProvider>\r\n      </DialogContent>}\r\n    </Observer>\r\n  </Popover>\r\n}\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAABkUlEQVR4nO3cwU3DMBiAURcxWJmErsAGHYVRYIOOwAhsEA5cOZBgyfrKe1Jv7u9In+RD0+S0bdug6WH1BXCceGHihYkXJl6YeGHihYkXJl6YeGHihYkXJl6YeGHihYkXJl6YeGHihYkXJl6YeGHihYkXJl6YeGHihYkXJl6YeGH3Eu86xth2fM4rLnK2e4n3L4kXJl6YeGHihYkXJl6YeGHihYkXJl6YeGHihYkXJl6YeGHihT0u3v86ac555/rLge/85GOM8TphziGnxW+6rb9m930s/EuFYzNMvDDxwsQLEy9MvDDxwsQLEy9MvLDVv20+TZpzGWM871j/Msa4Tdj3c8KMw1bHe5s057xz/W3i3ss4NsPECxMvTLww8cLECxMvTLww8cLECxMvTLww8cLECxMvTLyw1TdjZ/kY3w99/NbSO+CzrH5KiD9wbIaJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJF/YFuDIiwrkDZeQAAAAASUVORK5CYII=\"","import Button from '@material-ui/core/Button'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Popover from '@material-ui/core/Popover'\r\nimport SignalCellular0BarIcon from '@material-ui/icons/SignalCellular0Bar'\r\nimport SignalCellular1BarIcon from '@material-ui/icons/SignalCellular1Bar'\r\nimport SignalCellular2BarIcon from '@material-ui/icons/SignalCellular2Bar'\r\nimport SignalCellular3BarIcon from '@material-ui/icons/SignalCellular3Bar'\r\nimport SignalCellular4BarIcon from '@material-ui/icons/SignalCellular4Bar'\r\nimport {useTranslation} from '@models/locales'\r\nimport React from 'react'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport { StreamStat, TransportStat } from '@models/conference/RtcConnection'\r\n\r\n\r\nexport interface ConnectionStatProps{\r\n  stat?: TransportStat\r\n  streams?: StreamStat[]\r\n}\r\nexport const ConnectionStat: React.FC<ConnectionStatProps> = (props:ConnectionStatProps) => {\r\n  const stat = props.stat\r\n  const streams = props.streams\r\n  return <>\r\n    {stat?.turn ? <div>RTC via {stat.turn}</div> : undefined}\r\n    {stat?.remoteServer ? <div>RTC⇓:{stat.remoteServer}</div> : undefined}\r\n    <div>⇑{((stat?.sentBytePerSec || 0)/1000).toFixed(1)}k&nbsp;\r\n      ⇓{((stat?.receivedBytePerSec || 0)/1000).toFixed(1)}k&nbsp;\r\n      {stat?.quality!==undefined ? <>Quality:{stat.quality.toFixed(0)}%&nbsp;</> : undefined}\r\n      {stat?.roundTripTime ? <>RTT:{(stat.roundTripTime*1000).toFixed(0)}ms&nbsp;</> : undefined}\r\n      {stat?.fractionLost!==undefined ? <>Lost:{(stat?.fractionLost*100).toFixed(2)}%</> : undefined}\r\n    </div>\r\n    <div>Streams:</div>\r\n    {streams?.map(s => {\r\n      return <div key={s.id}>&nbsp;\r\n        {s.dir==='send' ? '⇑' : '⇓'}\r\n        {s.codec && <>{s.codec}&nbsp;</>}\r\n        {((s.bytesPerSec ? s.bytesPerSec : 0)/1000).toFixed(1)}k\r\n        {s.roundTripTime ? <>&nbsp; RTT:{(s.roundTripTime*1000).toFixed(0)}ms</> : undefined}\r\n        {s.fractionLost!==undefined ? <>&nbsp; Lost:{(s.fractionLost*100).toFixed(2)}%</> : undefined}\r\n        {s.jitter!==undefined ? <>&nbsp; Jitter:{(s.jitter*1000).toFixed(0)}ms</> : undefined}\r\n      </div>\r\n    })}\r\n  </>\r\n}\r\n\r\nexport interface ConnectionQualityDialogProps{\r\n  open: boolean\r\n  stat?: TransportStat\r\n  isLocal?: boolean\r\n  anchorEl: null | HTMLElement\r\n  onClose?: ()=>void\r\n}\r\nexport const ConnectionQualityDialog: React.FC<ConnectionQualityDialogProps>\r\n  = (props: ConnectionQualityDialogProps) => {\r\n  const {t} = useTranslation()\r\n  const stat = useObserver<TransportStat|undefined>(()=> (props.stat ? {...props.stat} : undefined))\r\n\r\n  return <Popover open={props.open} anchorEl={props.anchorEl} >\r\n    <DialogTitle>\r\n      {t('connectionStatus')}\r\n    </DialogTitle>\r\n    <DialogContent>\r\n      <ConnectionStat stat={stat} streams={stat?.streams} />\r\n      <Button variant=\"contained\" color=\"primary\" style={{textTransform:'none', marginTop:'0.4em'}}\r\n        onClick={(ev) => {\r\n          ev.stopPropagation()\r\n          if (props.onClose){props.onClose()}\r\n        }}\r\n        >{t('emClose')}\r\n      </Button>\r\n    </DialogContent>\r\n    <br />\r\n  </Popover>\r\n}\r\n\r\n\r\nexport interface SignalIconProps{\r\n  quality?: number\r\n  className?: string\r\n}\r\nexport const SignalQualityIcon: React.FC<SignalIconProps> = (props) => {\r\n  let qualityIcon: JSX.Element|undefined = undefined\r\n  const quality = props.quality\r\n  if (quality !== undefined){\r\n    qualityIcon = <SignalCellular0BarIcon className={props.className} style={{color:'red'}} />\r\n    if(quality > 30) { qualityIcon =\r\n      <SignalCellular1BarIcon className={props.className} style={{color:'orange'}} /> }\r\n    if(quality > 50) { qualityIcon =\r\n      <SignalCellular2BarIcon className={props.className} style={{color:'gold'}} /> }\r\n    if(quality > 70) { qualityIcon =\r\n      <SignalCellular3BarIcon className={props.className} style={{color:'yellow'}} /> }\r\n    if(quality > 90) { qualityIcon =\r\n      <SignalCellular4BarIcon className={props.className} style={{color:'green'}} /> }\r\n  }\r\n\r\n  return <>{qualityIcon}</>\r\n}\r\n\r\nexport interface SignalQualityButtonProps{\r\n  open: boolean\r\n  anchorEl?: HTMLElement |  null\r\n  isLocal?:boolean\r\n  stat?: TransportStat\r\n}\r\nexport const SignalQualityButton: React.FC<SignalQualityButtonProps> = (props:SignalQualityButtonProps) => {\r\n  const [open, setOpen] = React.useState(false)\r\n\r\n  const ref = React.useRef<HTMLButtonElement>(null)\r\n\r\n  return <IconButton ref={ref} onClick={()=>{ setOpen(true) }}>\r\n    <SignalQualityIcon quality={props.stat?.quality} />\r\n    <ConnectionQualityDialog stat={props.stat} open={open}\r\n      anchorEl={ref.current} onClose={()=>{\r\n        setOpen(false)\r\n    }}/>\r\n  </IconButton>\r\n}\r\n\r\n","import { BMProps } from '@components/utils'\r\nimport Box from '@material-ui/core/Box'\r\nimport Button from '@material-ui/core/Button'\r\nimport Checkbox from '@material-ui/core/Checkbox'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\r\nimport Popover, { PopoverOrigin, PopoverReference } from '@material-ui/core/Popover'\r\nimport TextField from '@material-ui/core/TextField'\r\nimport {uploadToGyazo} from '@models/api/Gyazo'\r\nimport { conference } from '@models/conference'\r\nimport {useTranslation} from '@models/locales'\r\nimport {isDarkColor, rgb2Color} from '@models/utils'\r\nimport {isSmartphone} from '@models/utils/utils'\r\nimport {Observer} from 'mobx-react-lite'\r\nimport React, {useState} from 'react'\r\nimport {SketchPicker} from 'react-color'\r\nimport {SignalQualityButton} from './SignalQuality'\r\nimport { MuiThemeProvider, createTheme } from '@material-ui/core/styles'\r\n\r\nconst theme = createTheme({\r\n  palette: {\r\n    primary: { main: '#7ececc' },\r\n    secondary: { main: '#ef4623' }\r\n  }\r\n});\r\n\r\nexport interface LocalParticipantFormProps extends BMProps{\r\n  open: boolean\r\n  anchorEl: HTMLElement | null\r\n  anchorOrigin: PopoverOrigin\r\n  close: () => void,\r\n  anchorReference?: PopoverReference\r\n}\r\n\r\nconst tfIStyle = {fontSize: isSmartphone() ? '2em' : '1em',\r\nheight: isSmartphone() ? '2em' : '1.5em'}\r\nconst tfDivStyle = {height: isSmartphone() ? '4em' : '3em'}\r\nconst tfLStyle = {fontSize: isSmartphone() ? '1em' : '1em'}\r\nconst iStyle = {fontSize: isSmartphone() ? '2.5rem' : '1rem'}\r\n\r\nexport const LocalParticipantForm: React.FC<LocalParticipantFormProps> = (props: LocalParticipantFormProps) => {\r\n  const {participants, map} = props.stores\r\n  const local = participants.local\r\n  const [file, setFile] = useState<File|null>()\r\n  const [showColorPicker, setShowColorPicker] = useState(false)\r\n  const [showTextColorPicker, setShowTextColorPicker] = useState(false)\r\n  const {t} = useTranslation()\r\n\r\n  function closeConfig(ev:Object, reason:string) {\r\n    if (reason === 'enter' || reason==='backdropClick'){\r\n      local.sendInformation()\r\n      local.saveInformationToStorage(true)\r\n    }\r\n    props.close()\r\n  }\r\n\r\n\r\n  const onKeyPress = (ev:React.KeyboardEvent) => {\r\n    if (ev.key === 'Enter') {\r\n      closeConfig(ev, 'enter')\r\n    }else if (ev.key === 'Esc' || ev.key === 'Escape') {\r\n      local.loadInformationFromStorage()\r\n    }\r\n  }\r\n  function clearAvatarSrc(ev: React.FormEvent) {\r\n    ev.preventDefault()\r\n    setFile(null)\r\n    local.information.avatarSrc = ''\r\n  }\r\n  function uploadAvatarSrc(ev: React.FormEvent) {\r\n    ev.preventDefault()\r\n    if (file) {\r\n      uploadToGyazo(file).then((url) => {\r\n        local.information.avatarSrc = url\r\n      })\r\n    }\r\n  }\r\n\r\n  const colorButton = React.useRef<HTMLButtonElement>(null)\r\n  const textColorButton = React.useRef<HTMLButtonElement>(null)\r\n  const {close, ...popoverProps} = props\r\n\r\n  return <Popover {...popoverProps} onClose={closeConfig}>\r\n    <DialogTitle>\r\n      <span  style={{fontSize: isSmartphone() ? '2.5em' : '1em'}}>\r\n        {t('lsTitle')}\r\n      </span>\r\n      <span style={{float:'right'}}>\r\n        <SignalQualityButton open={props.open} stat={conference.sendTransportStat}/></span>\r\n    </DialogTitle>\r\n    <DialogContent>\r\n      <Observer>{ ()=> {\r\n        const rgb = local.getColorRGB()\r\n        const textRgb = local.getTextColorRGB()\r\n        const textColor = isDarkColor(rgb) ? 'white' : 'black'\r\n        const backColor = isDarkColor(textRgb) ? 'lightgray' : 'gray'\r\n        //  console.log('render color picker', rgb)\r\n\r\n        return  <>\r\n          <TextField label={t('YourName')} multiline={false} value={local.information.name} style={tfDivStyle}\r\n            inputProps={{style: tfIStyle, autoFocus:true}} InputLabelProps={{style: tfLStyle}}\r\n            onChange={event => {local.information.name = event.target.value}}\r\n            onKeyPress={onKeyPress} fullWidth={true}\r\n          />\r\n          <Box mt={3}>\r\n            <div style={{fontSize:isSmartphone() ? '2em' : 12}}>{t('lsColor')}</div>\r\n            <Box ml={2}>\r\n              <Button variant=\"contained\"\r\n                style={{backgroundColor:rgb2Color(rgb), color:textColor, textTransform:'none', fontSize:isSmartphone() ? '2em' : '1em'}}\r\n                onClick={()=>{setShowColorPicker(true)}} ref={colorButton}>\r\n                {t('lsColorAvatar')}</Button>\r\n              <Popover open={showColorPicker} onClose={()=>{setShowColorPicker(false)}}\r\n                anchorEl={colorButton.current} anchorOrigin={{vertical:'bottom', horizontal:'right'}}>\r\n                <SketchPicker color = {{r:rgb[0], g:rgb[1], b:rgb[2]}} disableAlpha\r\n                  onChange={(color, event)=>{\r\n                    event.preventDefault()\r\n                    local.information.color = [color.rgb.r, color.rgb.g, color.rgb.b]\r\n                  }}\r\n                  />\r\n              </Popover>\r\n              <Button variant=\"contained\"\r\n                style={{color:rgb2Color(textRgb), backgroundColor:backColor, marginLeft:15, textTransform:'none', fontSize:isSmartphone() ? '2em' : '1em'}}\r\n                onClick={()=>{setShowTextColorPicker(true)}} ref={textColorButton}>\r\n                {t('lsColorText')}</Button>\r\n              <Popover open={showTextColorPicker} anchorOrigin={{vertical:'bottom', horizontal:'right'}}\r\n                onClose={()=>{setShowTextColorPicker(false)}} anchorEl={textColorButton.current}>\r\n                <SketchPicker color = {{r:textRgb[0], g:textRgb[1], b:textRgb[2]}}\r\n                  onChange={(color, event)=>{\r\n                    event.preventDefault()\r\n                    local.information.textColor = [color.rgb.r, color.rgb.g, color.rgb.b]\r\n                  }}\r\n                />\r\n              </Popover>\r\n              <Button variant=\"contained\" style={{marginLeft:15, textTransform:'none', fontSize:isSmartphone() ? '2em' : '1em'}}\r\n                onClick={()=>{local.information.color=[]; local.information.textColor=[]}} >\r\n                {t('lsAutoColor')}</Button>\r\n            </Box>\r\n          </Box>\r\n          <Box mt={3}>\r\n            <div style={{fontSize:isSmartphone() ? '2em' : '1em'}}>{t('lsImage')}</div>\r\n            <Box mt={-1} ml={2}>\r\n              <form key=\"information\" onSubmit = {uploadAvatarSrc}\r\n                style={{lineHeight:'2em', fontSize: isSmartphone() ? '2.5em' : '1em'}}>\r\n                <div style={{fontSize:isSmartphone() ? '1em' : 12, marginTop:8}}>{t('lsImageFile')}</div>\r\n                {local.information.avatarSrc ? <>\r\n                  <img src={local.information.avatarSrc} style={{height:'1.5em', verticalAlign:'middle'}} alt=\"avatar\"/>\r\n                  <input style={iStyle} type=\"submit\" onClick={clearAvatarSrc} value=\"✕\" /> &nbsp;\r\n                </> : undefined}\r\n                <input style={iStyle} type=\"file\" onChange={(ev) => {\r\n                  setFile(ev.target.files?.item(0))\r\n                }} />\r\n                <input style={iStyle} type=\"submit\" value=\"Upload\" />\r\n              </form>\r\n              <TextField label={t('lsEmail')} multiline={false} value={local.information.email}\r\n                style={{...tfDivStyle, marginTop:8}}\r\n                inputProps={{style: tfIStyle, autoFocus:true}} InputLabelProps={{style: tfLStyle}}\r\n                onChange={event => local.information.email = event.target.value}\r\n                onKeyPress={onKeyPress} fullWidth={true}\r\n              />\r\n            </Box>\r\n          </Box>\r\n          <MuiThemeProvider theme={theme}>\r\n          <Box mt={3}>\r\n            <div style={{fontSize:isSmartphone() ? '2em' : 12}}>{t('lsNotification')}</div>\r\n            <Box mt={isSmartphone() ? 1 : -1} ml={isSmartphone() ? 37 : 2} style={{transform:isSmartphone() ? 'scale(2)' : 'scale(1)'}}>\r\n            <FormControlLabel control={\r\n              <Checkbox color=\"secondary\" style={{fontSize:isSmartphone() ? '2em' : '1em'}} checked={local.information.notifyCall}\r\n              onChange={(ev)=>{local.information.notifyCall = ev.target.checked}} />\r\n              } label={t('lsNotifyCall')} />\r\n            <FormControlLabel control={\r\n              <Checkbox color=\"secondary\" checked={local.information.notifyTouch}\r\n                onChange={(ev)=>{local.information.notifyTouch = ev.target.checked}} />\r\n              } label={t('lsNotifyTouch')} />\r\n            <FormControlLabel control={\r\n              <Checkbox color=\"secondary\" checked={local.information.notifyNear}\r\n                onChange={(ev)=>{local.information.notifyNear = ev.target.checked}} />\r\n              } label={t('lsNotifyNear')} />\r\n            <FormControlLabel control={\r\n              <Checkbox color=\"secondary\" checked={local.information.notifyYarn}\r\n                onChange={(ev)=>{local.information.notifyYarn = ev.target.checked}} />\r\n              } label={t('lsNotifyYarn')} />\r\n            </Box>\r\n          </Box>\r\n          </MuiThemeProvider>\r\n        </>}}\r\n      </Observer>\r\n      <MuiThemeProvider theme={theme}>\r\n      <Box mt={4} mb={3}>\r\n        <Button variant=\"contained\" color=\"primary\" style={{textTransform:'none', fontSize:isSmartphone() ? '2em' : '1em'}}\r\n          onClick={()=>{\r\n            closeConfig({}, 'enter')\r\n          }}>{t('btSave')}</Button>\r\n        <Button variant=\"contained\" color=\"secondary\" style={{marginLeft:15, textTransform:'none', fontSize:isSmartphone() ? '2em' : '1em'}}\r\n          onClick={()=>{ local.loadInformationFromStorage()}}>{t('btCancel')}</Button>\r\n        <Button variant=\"contained\" style={{marginLeft:15, textTransform:'none', fontSize:isSmartphone() ? '2em' : '1em'}}\r\n          onClick={()=>{\r\n            map.focusOn(local)\r\n          }}>{t('ctFocus')}</Button>\r\n      </Box>\r\n      </MuiThemeProvider>\r\n    </DialogContent>\r\n  </Popover>\r\n}\r\n","import {makeStyles} from '@material-ui/core/styles'\r\nimport React, {useEffect, useRef} from 'react'\r\n\r\nconst CENTER = 0.5\r\nconst useStyles = makeStyles({\r\n  root: (props: StreamAvatarProps) => ({\r\n    display: 'flex',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    width: props.size,\r\n    height: props.size,\r\n//    borderRadius: (props.size || 0) / 2,\r\n    clipPath: `circle(${(props.size || 0) * CENTER}px  at center)`,\r\n    overflow: 'hidden',\r\n  }),\r\n  videoLargerWidth: (props: StreamAvatarProps) => ({\r\n    height: '100%',\r\n    transform: `scale(${props.mirror ? -1 : 1}, 1)`,\r\n  }),\r\n  videoLargerHeight: (props: StreamAvatarProps) => ({\r\n    width: '100%',\r\n    transform: `scale(${props.mirror ? -1 : 1}, 1)`,\r\n  }),\r\n})\r\n\r\nexport interface StreamAvatarProps {\r\n  stream?: MediaStream\r\n  blob?: Blob\r\n  size?: number\r\n  style?: any\r\n  mirror?: boolean\r\n}\r\n\r\nfunction setStream(video: HTMLVideoElement, stream: MediaStream|undefined, blob: Blob|undefined,\r\n  videoLargerWidthClass: string, videoLargerHeightClass: string){\r\n  if (stream) {video.srcObject = stream}\r\n  else if (blob && blob.size){\r\n    const url = URL.createObjectURL(blob)\r\n    video.src = url\r\n  }\r\n  video.autoplay = true\r\n\r\n  video.onloadedmetadata = () => {\r\n    const settings = {\r\n      width: video.width,\r\n      height: video.height,\r\n    }\r\n\r\n    if (settings.width !== undefined && settings.height !== undefined) {\r\n      video.className = settings.width >= settings.height ? videoLargerWidthClass : videoLargerHeightClass\r\n    } else {\r\n      console.error('video stream width || height is undefined')\r\n      video.className = videoLargerWidthClass\r\n    }\r\n  }\r\n}\r\n\r\nexport const StreamAvatar: React.FC<StreamAvatarProps> = (props: StreamAvatarProps) => {\r\n  const classes = useStyles(props)\r\n  const videoRef = useRef<HTMLVideoElement>(null)\r\n\r\n  useEffect(\r\n    () => {\r\n      if (videoRef?.current !== null) {\r\n        setStream(videoRef.current, props.stream, props.blob,\r\n                  classes.videoLargerWidth, classes.videoLargerHeight)\r\n      }\r\n    },\r\n    [videoRef, classes.videoLargerWidth, classes.videoLargerHeight, props.stream, props.blob],\r\n  )\r\n\r\n  return <div className={classes.root} style={props.style}>\r\n    <video ref={videoRef} style={props.style} />\r\n  </div>\r\n}\r\n\r\nStreamAvatar.defaultProps = {\r\n  size: 100,\r\n}\r\nStreamAvatar.displayName = 'StreamAvatar'\r\n","import React from 'react'\r\nimport {ImageAvatar, ImageAvatarProps} from './ImageAvatar'\r\nimport {/* StreamAvatar, */ StreamAvatarProps} from './StreamAvatar'\r\n\r\ntype ComposedAvatarProps = ImageAvatarProps & Partial<StreamAvatarProps>\r\n\r\nexport const ComposedAvatar: React.FC<ComposedAvatarProps> = (props: ComposedAvatarProps) => {\r\n  const {\r\n    name,\r\n    avatarSrc,\r\n    colors,\r\n    stream,\r\n    blob,\r\n    ...remainProps\r\n  } = props\r\n\r\n  //if (!stream && !blob) {\r\n    return <ImageAvatar name={name} colors={colors}\r\n    avatarSrc={avatarSrc} {...remainProps} />\r\n  //}\r\n\r\n  //return <StreamAvatar stream={stream} blob={blob} {...remainProps} />\r\n}\r\nComposedAvatar.displayName = 'ComposedAvatar'\r\n","import {LocalParticipant} from '@stores/participants/LocalParticipant'\r\nimport {PlaybackParticipant} from '@stores/participants/PlaybackParticipant'\r\nimport {RemoteParticipant} from '@stores/participants/RemoteParticipant'\r\nimport {Observer} from 'mobx-react-lite'\r\nimport React from 'react'\r\nimport {AvatarProps} from '.'\r\nimport {ComposedAvatar} from './ComposedAvatar'\r\n\r\nexport interface ConnectedAvatarProps {\r\n  participant: LocalParticipant | RemoteParticipant | PlaybackParticipant\r\n  size: number\r\n  isLocal: boolean\r\n}\r\n\r\nconst ConnectedAvatar: React.FC<ConnectedAvatarProps> = (props) => {\r\n  const participant = props.participant\r\n  //  console.log('ConnectedAvatar is rendered.')\r\n\r\n  return <Observer>{() => {\r\n    const colors = participant.getColor()\r\n    const {avatarSrc, name} = participant.information\r\n    const args = {colors, avatarSrc, name}\r\n\r\n    return <ComposedAvatar {...args}\r\n      stream={participant.showVideo && !(participant instanceof PlaybackParticipant) ?\r\n        participant.tracks.avatarStream : undefined}\r\n      blob={participant.showVideo && (participant instanceof PlaybackParticipant) ?\r\n        participant.videoBlob: undefined}\r\n      colors={colors} size={props.size} style={{pointerEvents:'none'}}\r\n      mirror={props.isLocal}\r\n    />\r\n  }}</Observer>\r\n}\r\n\r\nexport const MemoedAvatar = (props: AvatarProps) =>\r\n  React.useMemo(() => <ConnectedAvatar {...props} />,\r\n  //  eslint-disable-next-line react-hooks/exhaustive-deps\r\n  [props.size,\r\n    props.participant.information.avatarSrc,\r\n    props.participant.information.color,\r\n    props.participant.information.name,\r\n    props.participant.information.textColor,\r\n    //  eslint-disable-next-line react-hooks/exhaustive-deps\r\n    (props.participant as RemoteParticipant).tracks?.avatar,\r\n  ])\r\nMemoedAvatar.displayName = 'MemorizedAvatar'\r\n","import * as THREE from 'three'\r\nimport {GLTF, GLTFLoader} from 'three/examples/jsm/loaders/GLTFLoader'\r\nimport {VRM, VRMSchema, VRMUtils} from '@pixiv/three-vrm'\r\nimport React from 'react'\r\nimport { ParticipantBase, PARTICIPANT_SIZE, VRMRigs } from '@models/Participant'\r\nimport { autorun, IReactionDisposer } from 'mobx'\r\nimport * as Kalidokit from 'kalidokit'\r\nimport { throttle } from 'lodash'\r\nimport Euler from 'kalidokit/dist/utils/euler'\r\n\r\n\r\nclass PromiseGLTFLoader extends GLTFLoader {\r\n  promiseLoad(\r\n    url: string,\r\n    onProgress?: ((event: ProgressEvent<EventTarget>) => void) | undefined,\r\n  ) {\r\n    return new Promise<GLTF>((resolve, reject) => {\r\n      super.load(url, resolve, onProgress, reject)\r\n    })\r\n  }\r\n}\r\ninterface Member{\r\n  clock: THREE.Clock\r\n  renderer: THREE.WebGLRenderer\r\n  scene: THREE.Scene\r\n  camera: THREE.Camera\r\n  vrm?:VRM\r\n}\r\n\r\nconst size = [150,300]\r\n\r\n\r\nexport const VRMAvatar: React.FC<{participant:ParticipantBase}> = (props: {participant:ParticipantBase}) => {\r\n  const ref = React.useRef<HTMLCanvasElement>(null)\r\n  const memberRef = React.useRef<Member|null>(null)\r\n\r\n  React.useEffect(()=>{\r\n    if (!ref.current) return\r\n    memberRef.current = {\r\n      clock:new THREE.Clock(),\r\n      renderer : new THREE.WebGLRenderer({\r\n        antialias: true,\r\n        alpha: true,\r\n        canvas: ref.current\r\n      }),\r\n      camera: new THREE.PerspectiveCamera(\r\n        35,\r\n        size[0]/size[1],\r\n        0.1,\r\n        1000,\r\n      ),\r\n      scene: new THREE.Scene(),\r\n    }\r\n    const mem = memberRef.current!\r\n    mem.renderer.setSize(size[0], size[1])\r\n    mem.renderer.setPixelRatio(window.devicePixelRatio * 4)\r\n\r\n    const light = new THREE.DirectionalLight(0xffffff)\r\n    light.position.set(1, 1, 1).normalize()\r\n    mem.scene.add(light)\r\n\r\n    /*  //  show grid\r\n    const gridHelper = new THREE.GridHelper(10, 10)\r\n    scene.add(gridHelper)\r\n    gridHelper.visible = true\r\n\r\n    let geometry = new THREE.BoxGeometry(0.1, 0.1, 0.1);// 立方体\r\n    let material = new THREE.MeshLambertMaterial({color: 0x00ddff});// 影が表示される\r\n    const cube = new THREE.Mesh(geometry, material);// それらをまとめて3Dオブジェクトにします\r\n    scene.add(cube);\r\n\r\n    // show axis\r\n    const axesHelper = new THREE.AxesHelper(0.5)\r\n    scene.add(axesHelper)\r\n    //  */\r\n    const loader = new PromiseGLTFLoader()\r\n    const dispo: IReactionDisposer[] = []\r\n\r\n    //  load VRM from avatarSrc\r\n    dispo.push(autorun(()=>{\r\n      const mem = memberRef.current!\r\n      loader.promiseLoad(\r\n          props.participant.information.avatarSrc,\r\n      ).then(gltf => {\r\n        if (mem.vrm){\r\n          mem.scene?.remove(mem.vrm.scene)\r\n        }\r\n        VRMUtils.removeUnnecessaryJoints(gltf.scene);\r\n        VRM.from(gltf).then(vrmGot => {\r\n          mem.scene?.add(vrmGot.scene)\r\n          vrmGot.scene.rotation.y = Math.PI\r\n          if (mem){\r\n            mem.vrm = vrmGot\r\n            render3d(props.participant.pose.orientation, props.participant.vrmRigs)\r\n          }\r\n        })\r\n      }).catch((e)=>{\r\n        console.log('Failed to load VRM', e)\r\n      })\r\n    }))\r\n\r\n    //  render when updated\r\n    const render3d = throttle((ori, rig)=>{\r\n      if (mem?.vrm) {\r\n        vrmSetPose(mem.vrm, rig)                //  apply rig\r\n        mem.vrm.update(mem.clock.getDelta());   //  Update model to render physics\r\n        const rad = ori / 180 * Math.PI\r\n        mem.camera?.position.set(-Math.sin(rad)*3, 2, -Math.cos(rad)*3)\r\n        mem.camera?.lookAt(0,0.93,0)\r\n        mem.renderer?.render(mem.scene!, mem.camera!)\r\n      }\r\n    }, 1000/20)\r\n    dispo.push(autorun(()=>{\r\n      render3d(props.participant.pose.orientation, props.participant.vrmRigs)\r\n    }))\r\n\r\n    return ()=>{\r\n      for(const d of dispo) d()\r\n    }\r\n  })\r\n\r\n  return <>\r\n    <canvas style={{\r\n      pointerEvents:'none',\r\n      position:'relative',\r\n      width:size[0], height:size[1],\r\n      left: -size[0]/2, top:-(size[1] - PARTICIPANT_SIZE/4)\r\n      }} ref={ref}/>\r\n  </>\r\n}\r\n\r\n\r\n\r\n\r\nconst clamp = Kalidokit.Utils.clamp;\r\nconst lerp = Kalidokit.Vector.lerp;\r\n\r\ntype HumanoidBoneName = 'Chest'|'Head'|'Hips'|'Jaw'|'LeftEye'|'LeftFoot'|'LeftHand'\r\n  |'LeftIndexDistal'|'LeftIndexIntermediate'|'LeftIndexProximal'|'LeftLittleDistal'\r\n  |'LeftLittleIntermediate'|'LeftLittleProximal'|'LeftLowerArm'|'LeftLowerLeg'\r\n  |'LeftMiddleDistal'|'LeftMiddleIntermediate'|'LeftMiddleProximal'|'LeftRingDistal'\r\n  |'LeftRingIntermediate'|'LeftRingProximal'|'LeftShoulder'|'LeftThumbDistal'\r\n  |'LeftThumbIntermediate'|'LeftThumbProximal'|'LeftToes'|'LeftUpperArm'|'LeftUpperLeg'\r\n  |'Neck'|'RightEye'|'RightFoot'|'RightHand'|'RightIndexDistal'|'RightIndexIntermediate'\r\n  |'RightIndexProximal'|'RightLittleDistal'|'RightLittleIntermediate'|'RightLittleProximal'\r\n  |'RightLowerArm'|'RightLowerLeg'|'RightMiddleDistal'|'RightMiddleIntermediate'\r\n  |'RightMiddleProximal'|'RightRingDistal'|'RightRingIntermediate'|'RightRingProximal'\r\n  |'RightShoulder'|'RightThumbDistal'|'RightThumbIntermediate'|'RightThumbProximal'\r\n  |'RightToes'|'RightUpperArm'|'RightUpperLeg'|'Spine'|'UpperChest'\r\n\r\n// Animate Rotation Helper function\r\nconst rigRotation = (\r\n  vrm: VRM,\r\n  name: HumanoidBoneName,\r\n  rotation = { x: 0, y: 0, z: 0 },\r\n  dampener = 1,\r\n  lerpAmount = 0.3\r\n) => {\r\n  if (!vrm) {return}\r\n  const Part = vrm.humanoid?.getBoneNode(\r\n    VRMSchema.HumanoidBoneName[name]\r\n  );\r\n  if (!Part) {return}\r\n\r\n  let euler = new THREE.Euler(\r\n    rotation.x * dampener,\r\n    rotation.y * dampener,\r\n    rotation.z * dampener\r\n  );\r\n  let quaternion = new THREE.Quaternion().setFromEuler(euler);\r\n  Part.quaternion.slerp(quaternion, lerpAmount); // interpolate\r\n};\r\n\r\n// Animate Position Helper Function\r\n/* const rigPosition = (vrm: VRM,\r\n  name:HumanoidBoneName,\r\n  position = { x: 0, y: 0, z: 0 },\r\n  dampener = 1,\r\n  lerpAmount = 0.3\r\n) => {\r\n  if (!vrm) {return}\r\n  const Part = vrm.humanoid?.getBoneNode(\r\n    VRMSchema.HumanoidBoneName[name]\r\n  );\r\n  if (!Part) {return}\r\n  let vector = new THREE.Vector3(\r\n    position.x * dampener,\r\n    position.y * dampener,\r\n    position.z * dampener\r\n  );\r\n  Part.position.lerp(vector, lerpAmount); // interpolate\r\n}; */\r\n\r\nlet oldLookTarget = new THREE.Euler()\r\nfunction rigFace(vrm:VRM, riggedFace:Kalidokit.TFace){\r\n    if(!vrm){return}\r\n    const rot = {x:riggedFace.head.x-0.1, y:riggedFace.head.y, z:riggedFace.head.z}\r\n    rigRotation(vrm, \"Neck\", rot, 0.7);\r\n\r\n    // Blendshapes and Preset Name Schema\r\n    const Blendshape = vrm.blendShapeProxy!\r\n    const PresetName = VRMSchema.BlendShapePresetName;\r\n\r\n    // Simple example without winking. Interpolate based on old blendshape, then stabilize blink with `Kalidokit` helper function.\r\n    // for VRM, 1 is closed, 0 is open.\r\n    //console.log(`face eye:${riggedFace.eye.l},${riggedFace.eye.r}`)\r\n    const eyeL = clamp(1-riggedFace.eye.l, 0, 1)\r\n    const eyeR = clamp(1-riggedFace.eye.r, 0, 1)\r\n    // riggedFace.eye = Kalidokit.Face.stabilizeBlink(riggedFace.eye, riggedFace.head.y)\r\n    Blendshape.setValue(PresetName.BlinkL, eyeL);\r\n    Blendshape.setValue(PresetName.BlinkR, eyeR);\r\n\r\n    // Interpolate and set mouth blendshapes\r\n    Blendshape.setValue(PresetName.I, lerp(riggedFace.mouth.shape.I,Blendshape.getValue(PresetName.I)!, .5));\r\n    Blendshape.setValue(PresetName.A, lerp(riggedFace.mouth.shape.A,Blendshape.getValue(PresetName.A)!, .5));\r\n    Blendshape.setValue(PresetName.E, lerp(riggedFace.mouth.shape.E,Blendshape.getValue(PresetName.E)!, .5));\r\n    Blendshape.setValue(PresetName.O, lerp(riggedFace.mouth.shape.O,Blendshape.getValue(PresetName.O)!, .5));\r\n    Blendshape.setValue(PresetName.U, lerp(riggedFace.mouth.shape.U,Blendshape.getValue(PresetName.U)!, .5));\r\n\r\n    //PUPILS\r\n    //interpolate pupil and keep a copy of the value\r\n    let lookTarget =\r\n      new THREE.Euler(\r\n        lerp(oldLookTarget.x , riggedFace.pupil.y, .4),\r\n        lerp(oldLookTarget.y, riggedFace.pupil.x, .4),\r\n        0,\r\n        \"XYZ\"\r\n      )\r\n    oldLookTarget.copy(lookTarget)\r\n    vrm.lookAt?.applyer?.lookAt(lookTarget);\r\n}\r\n\r\n/* VRM Character Animator */\r\nfunction vrmSetPose (vrm:VRM, rigs?:VRMRigs){\r\n  if (!vrm) return\r\n  if (!rigs) {\r\n    rigRotation(vrm, \"RightUpperArm\", new Euler(0,0,-Math.PI/2*0.8), 1, 1);\r\n    rigRotation(vrm, \"LeftUpperArm\", new Euler(0,0,Math.PI/2*0.8), 1, 1);\r\n    return;\r\n  }\r\n\r\n  if (rigs.face) rigFace(vrm, rigs.face)\r\n\r\n  // Animate Pose\r\n  if (rigs.pose){\r\n    rigRotation(vrm, \"Hips\", rigs.pose.Hips.rotation, 0.7);\r\n/*    rigPosition(vrm,\r\n      \"Hips\",\r\n      {\r\n        x: -rigs.pose.Hips.position.x, // Reverse direction\r\n        y: rigs.pose.Hips.position.y + 1, // Add a bit of height\r\n        z: -rigs.pose.Hips.position.z // Reverse direction\r\n      },\r\n      1,\r\n      0.07\r\n    );\r\n*/\r\n    rigRotation(vrm, \"Chest\", rigs.pose.Spine, 0.25, .3);\r\n    rigRotation(vrm, \"Spine\", rigs.pose.Spine, 0.45, .3);\r\n\r\n    rigRotation(vrm, \"RightUpperArm\", rigs.pose.RightUpperArm, 1, .3);\r\n    rigRotation(vrm, \"RightLowerArm\", rigs.pose.RightLowerArm, 1, .3);\r\n    rigRotation(vrm, \"LeftUpperArm\", rigs.pose.LeftUpperArm, 1, .3);\r\n    rigRotation(vrm, \"LeftLowerArm\", rigs.pose.LeftLowerArm, 1, .3);\r\n\r\n    rigRotation(vrm, \"LeftUpperLeg\", rigs.pose.LeftUpperLeg, 1, .3);\r\n    rigRotation(vrm, \"LeftLowerLeg\", rigs.pose.LeftLowerLeg, 1, .3);\r\n    rigRotation(vrm, \"RightUpperLeg\", rigs.pose.RightUpperLeg, 1, .3);\r\n    rigRotation(vrm, \"RightLowerLeg\", rigs.pose.RightLowerLeg, 1, .3);\r\n  }else{\r\n    if (rigs.face){\r\n      //console.log(`head: ${JSON.stringify(rigs.face.head)}`)\r\n      const rot = {x:rigs.face.head.x/3-0.3, y:rigs.face.head.y/2, z:rigs.face.head.z/2}\r\n      rigRotation(vrm, \"Chest\", rot, 0.25, .3);\r\n      rigRotation(vrm, \"Spine\", rot, 0.45, .3);\r\n      rigRotation(vrm, \"RightUpperArm\", {x:-rot.x/4-0.2, y:-rot.y/4, z: -rot.z/4-Math.PI/2*0.8}, 1, 1);\r\n      rigRotation(vrm, \"LeftUpperArm\", {x:-rot.x/4-0.2, y:-rot.y/4, z: -rot.z/4+Math.PI/2*0.8}, 1, 1);\r\n      rigRotation(vrm, \"RightLowerArm\", new Euler(0,1.8,-0.3), 1, 1);\r\n      rigRotation(vrm, \"LeftLowerArm\", new Euler(0,-1.8,0.3), 1, 1);\r\n      rigRotation(vrm, \"RightHand\", new Euler(-0.4,0.3,-0.3), 1, 1);\r\n      rigRotation(vrm, \"LeftHand\", new Euler(-0.4,-0.3,0.3), 1, 1);\r\n      }\r\n  }\r\n\r\n  // Animate Hands\r\n  if (rigs.pose && rigs.leftHand){\r\n    rigRotation(vrm, \"LeftHand\", {\r\n      // Combine pose rotation Z and hand rotation X Y\r\n      z: rigs.pose.LeftHand.z,\r\n      y: rigs.leftHand.LeftWrist.y,\r\n      x: rigs.leftHand.LeftWrist.x\r\n    })\r\n  }\r\n  if (rigs?.leftHand){\r\n    rigRotation(vrm, \"LeftRingProximal\", rigs.leftHand.LeftRingProximal);\r\n    rigRotation(vrm, \"LeftRingIntermediate\", rigs.leftHand.LeftRingIntermediate);\r\n    rigRotation(vrm, \"LeftRingDistal\", rigs.leftHand.LeftRingDistal);\r\n    rigRotation(vrm, \"LeftIndexProximal\", rigs.leftHand.LeftIndexProximal);\r\n    rigRotation(vrm, \"LeftIndexIntermediate\", rigs.leftHand.LeftIndexIntermediate);\r\n    rigRotation(vrm, \"LeftIndexDistal\", rigs.leftHand.LeftIndexDistal);\r\n    rigRotation(vrm, \"LeftMiddleProximal\", rigs.leftHand.LeftMiddleProximal);\r\n    rigRotation(vrm, \"LeftMiddleIntermediate\", rigs.leftHand.LeftMiddleIntermediate);\r\n    rigRotation(vrm, \"LeftMiddleDistal\", rigs.leftHand.LeftMiddleDistal);\r\n    rigRotation(vrm, \"LeftThumbProximal\", rigs.leftHand.LeftThumbProximal);\r\n    rigRotation(vrm, \"LeftThumbIntermediate\", rigs.leftHand.LeftThumbIntermediate);\r\n    rigRotation(vrm, \"LeftThumbDistal\", rigs.leftHand.LeftThumbDistal);\r\n    rigRotation(vrm, \"LeftLittleProximal\", rigs.leftHand.LeftLittleProximal);\r\n    rigRotation(vrm, \"LeftLittleIntermediate\", rigs.leftHand.LeftLittleIntermediate);\r\n    rigRotation(vrm, \"LeftLittleDistal\", rigs.leftHand.LeftLittleDistal);\r\n  }\r\n  if (rigs.pose && rigs.rightHand){\r\n    rigRotation(vrm, \"RightHand\", {\r\n      // Combine Z axis from pose hand and X/Y axis from hand wrist rotation\r\n      z: rigs.pose.RightHand.z,\r\n      y: rigs.rightHand.RightWrist.y,\r\n      x: rigs.rightHand.RightWrist.x\r\n    })\r\n  }\r\n  if (rigs.rightHand){\r\n    rigRotation(vrm, \"RightRingProximal\", rigs.rightHand.RightRingProximal);\r\n    rigRotation(vrm, \"RightRingIntermediate\", rigs.rightHand.RightRingIntermediate);\r\n    rigRotation(vrm, \"RightRingDistal\", rigs.rightHand.RightRingDistal);\r\n    rigRotation(vrm, \"RightIndexProximal\", rigs.rightHand.RightIndexProximal);\r\n    rigRotation(vrm, \"RightIndexIntermediate\",rigs.rightHand.RightIndexIntermediate);\r\n    rigRotation(vrm, \"RightIndexDistal\", rigs.rightHand.RightIndexDistal);\r\n    rigRotation(vrm, \"RightMiddleProximal\", rigs.rightHand.RightMiddleProximal);\r\n    rigRotation(vrm, \"RightMiddleIntermediate\", rigs.rightHand.RightMiddleIntermediate);\r\n    rigRotation(vrm, \"RightMiddleDistal\", rigs.rightHand.RightMiddleDistal);\r\n    rigRotation(vrm, \"RightThumbProximal\", rigs.rightHand.RightThumbProximal);\r\n    rigRotation(vrm, \"RightThumbIntermediate\", rigs.rightHand.RightThumbIntermediate);\r\n    rigRotation(vrm, \"RightThumbDistal\", rigs.rightHand.RightThumbDistal);\r\n    rigRotation(vrm, \"RightLittleProximal\", rigs.rightHand.RightLittleProximal);\r\n    rigRotation(vrm, \"RightLittleIntermediate\", rigs.rightHand.RightLittleIntermediate);\r\n    rigRotation(vrm, \"RightLittleDistal\", rigs.rightHand.RightLittleDistal);\r\n  }\r\n  vrm.blendShapeProxy?.update()\r\n};\r\n","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/earshot_icon_avatar_glow.1b7acac1.png\";","import {Avatar} from '@components/avatar'\r\nimport {Stores} from '@components/utils'\r\nimport megaphoneIcon from '@iconify/icons-mdi/megaphone'\r\nimport {Icon} from '@iconify/react'\r\nimport {Tooltip} from '@material-ui/core'\r\nimport {makeStyles} from '@material-ui/core/styles'\r\nimport HeadsetIcon from '@material-ui/icons/HeadsetMic'\r\nimport MicOffIcon from '@material-ui/icons/MicOff'\r\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow'\r\nimport SpeakerOffIcon from '@material-ui/icons/VolumeOff'\r\nimport {/* addV2, mulV2,  */normV, /* rotateVector2DByDegree, subV2, */ getRelativePose} from '@models/utils'\r\nimport {LocalParticipant} from '@stores/participants/LocalParticipant'\r\nimport {PlaybackParticipant} from '@stores/participants/PlaybackParticipant'\r\nimport {RemoteParticipant} from '@stores/participants/RemoteParticipant'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React, { useState } from 'react'\r\nimport {SignalQualityIcon} from './SignalQuality'\r\nimport {VRMAvatar} from '../../avatar/VRMAvatar'\r\n\r\n// Image\r\nimport proximityVolumeIcon from '@images/whoo-emoticons_voice.png'\r\n\r\n// Animated Emoticons\r\nimport symSmileIcon from '@images/whoo-screen_sym-smile.png'\r\nimport symClapIcon from '@images/whoo-screen_sym-clap.png'\r\nimport symHandIcon from '@images/whoo-screen_sym-hand.png'\r\nimport badConnIcon from '@images/whoo-screen_sym-slow.png'\r\n\r\nimport zoneGlowIcon from '@images/earshot_icon_avatar_glow.png'\r\n\r\nimport PingIcon from '@images/whoo-screen_pointer.png'\r\nimport {TITLE_HEIGHT} from '@stores/sharedContents/SharedContents'\r\nimport { rgb2Color} from '@models/utils'\r\n\r\ndeclare const config:any             //  from ../../config.js included from index.html\r\n\r\ninterface StyleProps {\r\n  position: [number, number],\r\n  orientation: number,\r\n  size: number,\r\n}\r\n\r\n// const SVG_RATIO = 18\r\nconst SVG_RATIO = 12\r\nconst HALF = 0.5\r\n\r\n\r\nlet animCount = 0\r\n\r\nconst useStyles = makeStyles({\r\n  root: (props: StyleProps) => ({\r\n    position: 'absolute',\r\n    left: props.position[0],\r\n    top: props.position[1],\r\n    width:0,\r\n    height:0,\r\n  }),\r\n  pointerRotate: (props: StyleProps) => ({\r\n    transformOrigin: `top left`,\r\n    transform: `rotate(${props.orientation}deg)`,\r\n  }),\r\n  pointer: (props: StyleProps) => ({\r\n    position: 'absolute',\r\n    width: `${SVG_RATIO * props.size}`,\r\n    left: `-${SVG_RATIO * props.size * HALF}px`,\r\n    top: `-${SVG_RATIO * props.size * HALF}px`,\r\n    pointerEvents: 'none',\r\n  }),\r\n  avatar: (props: StyleProps) => ({\r\n    position: 'absolute',\r\n    left: `-${props.size * HALF}px`,\r\n    top: `-${props.size * HALF}px`,\r\n    transformOrigin: `top left`,\r\n    transform: `translate(${props.size * HALF}px, ${props.size * HALF}px) `\r\n      +`rotate(${-props.orientation}deg) translate(${-props.size * HALF}px, ${-props.size * HALF}px)`,\r\n  }),\r\n  avatarGlow: (props: StyleProps) => ({\r\n    position: 'absolute',\r\n    width: props.size * 3 ,\r\n    height: props.size * 3,\r\n    left: props.size * -1,\r\n    top: props.size * -1,\r\n    opacity: 0,\r\n    pointerEvents: 'none',\r\n    transform: \"scale(0.5)\",\r\n    transition: '0.5s ease-out'\r\n  }),\r\n  avatarGlowEffect: (props: StyleProps) => ({\r\n    position: 'absolute',\r\n    width: props.size * 3 ,\r\n    height: props.size * 3,\r\n    left: props.size * -1,\r\n    top: props.size * -1,\r\n    opacity: 1,\r\n    pointerEvents: 'none',\r\n    transform: \"scale(0.9)\",\r\n    transition: '0.5s ease-out'\r\n  }),\r\n  icon: (props: StyleProps) => ({\r\n    position: 'absolute',\r\n    width: props.size * 0.4 ,\r\n    height: props.size * 0.4,\r\n    left: props.size * 0.6,\r\n    top: props.size * 0.6,\r\n    pointerEvents: 'none',\r\n  }),\r\n  signalIcon: (props: StyleProps) => ({\r\n    position: 'absolute',\r\n    width: props.size * 0.25 ,\r\n    height: props.size * 0.25,\r\n    left: props.size * 0.8,\r\n    top: props.size * 0.8,\r\n    display: 'none',\r\n    pointerEvents: 'none',\r\n  }),\r\n  iconProximity: (props: StyleProps) => ({\r\n    position: 'absolute',\r\n    width: props.size * 0.6 ,\r\n    height: props.size * 0.6,\r\n    left: props.size * 0.7,\r\n    top: props.size * 0.4,\r\n    pointerEvents: 'none',\r\n  }),\r\n  iconEmoticon: (props: StyleProps) => ({\r\n    position: 'absolute',\r\n    width: props.size * 0.6 ,\r\n    height: props.size * 0.6,\r\n    left: props.size * -0.2,\r\n    top: props.size * -0.2,\r\n    pointerEvents: 'none',\r\n    transform: 'scale(1)',\r\n    transition: '0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55)',\r\n  }),\r\n  iconEmoticonNone: (props: StyleProps) => ({\r\n    position: 'absolute',\r\n    width: props.size * 0.6 ,\r\n    height: props.size * 0.6,\r\n    left: props.size * 0.1,\r\n    top: props.size * 0,\r\n    pointerEvents: 'none',\r\n    transform: 'scale(0)',\r\n    transition: '0s ease-out',\r\n  }),\r\n  conIcon: (props: StyleProps) => ({\r\n    position: 'absolute',\r\n    width: props.size * 0.85 ,\r\n    height: props.size * 0.85,\r\n    left: props.size * 0.5,\r\n    top: props.size * -0.3,\r\n    pointerEvents: 'none',\r\n  }),\r\n  more: (props: StyleProps) => ({\r\n    position: 'absolute',\r\n    width: props.size * 0.4 ,\r\n    height: props.size * 0.4,\r\n    left: props.size * 0.9,\r\n    top: -props.size * 0.3,\r\n  }),\r\n  pingLocIcon: (props:StyleProps) => ({\r\n    position: 'absolute',\r\n    transform: `rotate(${props.orientation}deg)`,\r\n    width: '200px',\r\n    height: '200px'\r\n  }),\r\n})\r\n\r\nexport interface ParticipantProps{\r\n  participant: LocalParticipant | RemoteParticipant | PlaybackParticipant\r\n  size: number\r\n  onContextMenu?:(ev:React.MouseEvent<HTMLDivElement, MouseEvent>) => void\r\n  stores: Stores\r\n}\r\nexport interface RawParticipantProps extends ParticipantProps{\r\n  isLocal: boolean\r\n  isPlayback?: boolean\r\n}\r\n\r\nconst RawParticipant: React.ForwardRefRenderFunction<HTMLDivElement , RawParticipantProps> = (props, ref) => {\r\n  /* const mapData = props.stores.map */\r\n\r\n  const participant = props.participant\r\n\r\n  const rgb = participant.getColorRGB()\r\n  const participantProps = useObserver(() => ({\r\n    position: participant.pose.position,\r\n    orientation: participant.pose.orientation,\r\n    mousePosition: participant.mouse.position,\r\n    awayFromKeyboard: participant.physics.awayFromKeyboard,\r\n  }))\r\n\r\n  const name = useObserver(() => participant!.information.name)\r\n  const audioLevel = useObserver(() =>\r\n    participant!.trackStates.micMuted ? 0 : Math.pow(participant!.audioLevel, 0.5))\r\n  const micMuted = useObserver(() => participant.trackStates.micMuted)\r\n  const speakerMuted = useObserver(() => participant.trackStates.speakerMuted)\r\n  const headphone = useObserver(() => participant.trackStates.headphone)\r\n  const onStage = useObserver(() => participant.physics.onStage)\r\n  /* const viewpoint = useObserver(() => ({center:participant.viewpoint.center, height:participant.viewpoint.height, nodding: participant.viewpoint.nodding})) */\r\n\r\n  const inZone = useObserver(() => props.stores.participants.local.zone?.zone)\r\n  const _icons = useObserver(() => participant.trackStates.emoticon)\r\n  const _connQuality = useObserver(() => participant.quality)\r\n\r\n  // For Chat Zone only\r\n  const zoneId = useObserver(() => {\r\n    let remotes = Array.from(props.stores.participants.remote.keys()).filter(key => key !== props.stores.participants.localId)\r\n    for(let [i] of remotes.entries()) {\r\n      if(props.stores.participants.remote.get(remotes[i])?.closedZone !== undefined) {\r\n        if(props.stores.participants.remote.get(remotes[i])?.id === participant.id && props.stores.participants.remote.get(remotes[i])?.closedZone?.id !== '') {\r\n          return props.stores.participants.remote.get(remotes[i])?.closedZone?.id\r\n        }\r\n      } else {\r\n        return undefined\r\n      }\r\n    }\r\n  })\r\n\r\n   // For Chat Zone only\r\n   const localZoneId = useObserver(() => (props.stores.participants.local.zone?.id !== undefined && props.stores.participants.local.zone?.id !== '') ? props.stores.participants.local.zone?.id : undefined)\r\n\r\n   // For Proximity Zone only\r\n\r\n  const proxCords = useObserver(() => {\r\n    let remotes = Array.from(props.stores.participants.remote.keys()).filter(key => key !== props.stores.participants.localId)\r\n    let remoteDist:number = 0\r\n    const localPos = props.stores.participants.local.pose\r\n    for(let [i] of remotes.entries()) {\r\n\r\n      if(props.stores.participants.remote.get(remotes[i])?.id === participant.id && props.stores.participants.remote.get(remotes[i])?.closedZone?.id === undefined) {\r\n        if(Object(props.stores.participants.remote.get(remotes[i])).pose.position !== undefined) {\r\n          let posDiff = getRelativePose(localPos, Object(props.stores.participants.remote.get(remotes[i])).pose)\r\n          remoteDist = normV(posDiff.position)\r\n        }\r\n        return remoteDist\r\n      }\r\n    }\r\n  })\r\n\r\n  const _pingIcon = useObserver(() => participant.trackStates.pingIcon)\r\n  const _pingX = useObserver(() => participant.trackStates.pingX)\r\n  const _pingY = useObserver(() => participant.trackStates.pingY)\r\n\r\n\r\n  const [togglePingSound, setTogglePingSound] = useState(false)\r\n  const [pingXY, setPingXY] = useState([0,0])\r\n\r\n  const [anim, setAnim] = useState(false)\r\n\r\n  if(_pingIcon && (pingXY[0] !== _pingX || pingXY[1] !== _pingY)) {\r\n    setTogglePingSound(false)\r\n  }\r\n\r\n  let xPos = ((_pingX) + 14)\r\n  let yPos = ((_pingY) - 55)\r\n\r\n  if(_pingIcon && togglePingSound === false) {\r\n    playToggleIcon()\r\n    //let audio = new Audio(\"sound/beep.mp3\")\r\n    //audio.play()\r\n    setPingXY([_pingX, _pingY])\r\n    setTogglePingSound(true)\r\n  } else if(_pingIcon === false && togglePingSound) {\r\n    setTogglePingSound(false)\r\n  }\r\n\r\n\r\n  if(localZoneId === undefined) {\r\n    animCount = 0\r\n  } else {\r\n    if(zoneId === localZoneId) {\r\n      const _timer = setTimeout(() => {\r\n        if(animCount >= 2) {return}\r\n        clearTimeout(_timer)\r\n        if(anim === false) {\r\n          setAnim(true)\r\n          animCount++\r\n        } else {\r\n          setAnim(false)\r\n          //animCount = 0\r\n        }\r\n      }, 500)\r\n    }\r\n  }\r\n\r\n  function playToggleIcon() {\r\n    let xClick = participantProps.mousePosition[0]\r\n    let xAvatar = props.stores.participants.local.pose.position[0]\r\n    //console.log(xClick, \" ----- \", xAvatar)\r\n    const URL = 'sound/beep.mp3';\r\n    const context = new AudioContext();\r\n    window.fetch(URL)\r\n    .then(response => response.arrayBuffer())\r\n    .then(arrayBuffer => context.decodeAudioData(arrayBuffer))\r\n    .then(audioBuffer => {\r\n      const source = context.createBufferSource();\r\n      source.buffer = audioBuffer;\r\n      let panNode = context.createStereoPanner();\r\n      if(xClick > (xAvatar + 10) /* && soundLocalBase === \"avatar\" */) {\r\n        //console.log(\"RIGHT\")\r\n        panNode.pan.value = 1\r\n      } else if(xClick < (xAvatar - 10) /* && soundLocalBase === \"avatar\" */) {\r\n        //console.log(\"LEFT\")\r\n        panNode.pan.value = -1\r\n      } else {\r\n        //console.log(\"NORMAL\")\r\n        panNode.pan.value = 0\r\n      }\r\n      source.connect(panNode);\r\n      panNode.connect(context.destination);\r\n      source.start();\r\n    });\r\n }\r\n\r\n\r\n\r\n  const classes = useStyles({\r\n    ...participantProps,\r\n    size: props.size,\r\n  })\r\n\r\n  const [color, textColor] = participant ? participant.getColor() : ['white', 'black']\r\n  const outerRadius = props.size / 2 + 2\r\n  const isLocal = props.isLocal\r\n  const AUDIOLEVELSCALE = props.size * SVG_RATIO * HALF\r\n  const svgCenter = SVG_RATIO * props.size * HALF\r\n\r\n  /* const shadowOffset = Math.sqrt(viewpoint.height) / 2.5 - 4\r\n  const shadowScale = 1 + (shadowOffset/200)\r\n  const eyeOffsetMul = normV(viewpoint.center)/500 * 0.16 + 0.85\r\n\r\n  const dir = subV2(participantProps.mousePosition, participantProps.position)\r\n  const eyeDist = 0.45\r\n\r\n  const nodding = viewpoint.nodding\r\n  const isNoseUp = nodding ? nodding < -0.01 : false\r\n  const noseWidth = 0.45\r\n  const noseStart = 0.9 * (nodding ? Math.cos(nodding * 4) : 1)\r\n  const noseLength = 0.6 * noseStart\r\n  //const tailStart = noseStart\r\n  //const tailLength = tailStart * 0.9\r\n  //const tailWidth = 0.36\r\n  const eyeOffsets:[[number, number], [number, number]]\r\n    = [[eyeDist * outerRadius, - eyeOffsetMul*outerRadius],\r\n      [-eyeDist * outerRadius, - eyeOffsetMul*outerRadius]]\r\n  const dirs = eyeOffsets.map(offset => subV2(dir, rotateVector2DByDegree(participantProps.orientation, offset)))\r\n  const eyeballsGlobal = dirs.map((dir) => {\r\n    const norm = normV(dir)\r\n    const dist = Math.log(norm < 1 ? 1 : norm) * 0.3\r\n    const limit = 0.1 * outerRadius\r\n    const offset = dist > limit ? limit : dist\r\n\r\n    return mulV2(offset / norm, dir)\r\n  })\r\n  const eyeballs = eyeballsGlobal.map(g => addV2([0, -0.04 * outerRadius],\r\n                                                 rotateVector2DByDegree(-participantProps.orientation, g)))\r\n  function onClickEye(ev: React.MouseEvent | React.TouchEvent | React.PointerEvent){\r\n    if (props.participant.id === props.stores.participants.localId){\r\n      ev.stopPropagation()\r\n      ev.preventDefault()\r\n      props.stores.participants.local.physics.awayFromKeyboard = true\r\n    }\r\n  }\r\n  const eyeClick = {\r\n    onMouseDown: onClickEye,\r\n    onTouchStart: onClickEye,\r\n    onPointerDown: onClickEye,\r\n  } */\r\n\r\n  const shadow = <svg className={classes.pointer} width={props.size * SVG_RATIO} height={props.size * SVG_RATIO}\r\n    xmlns=\"http://www.w3.org/2000/svg\">{/* Cast shadow to show the height */}\r\n    {/* <defs>\r\n      <radialGradient id=\"grad\">\r\n        <stop offset=\"0%\" stopColor=\"rgb(0,0,0,0.4)\"/>\r\n        <stop offset=\"70%\" stopColor=\"rgb(0,0,0,0.4)\"/>\r\n        <stop offset=\"100%\" stopColor=\"rgb(0,0,0,0)\"/>\r\n      </radialGradient>\r\n    </defs>\r\n    <circle r={outerRadius * shadowScale} cy={svgCenter-shadowOffset} cx={svgCenter-shadowOffset}\r\n      stroke=\"none\" fill={'url(#grad)'} /> */}\r\n  </svg>\r\n\r\n  const audioMeterSteps = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6]\r\n  const audioMeter = audioMeterSteps.map(step => (audioLevel > step && inZone !== 'close') ?\r\n    <React.Fragment key={step}>\r\n      <circle r={props.size * HALF + step * AUDIOLEVELSCALE} cy={svgCenter} cx={svgCenter}\r\n        stroke={color} fill=\"none\" opacity={0.4 * (1 - step)} strokeDasharray=\"4 4 4 24\" />\r\n      <circle r={props.size * HALF + step * AUDIOLEVELSCALE} cy={svgCenter} cx={svgCenter}\r\n      stroke=\"black\" fill=\"none\" opacity={0.4 * (1 - step)} strokeDasharray=\"4 32\" strokeDashoffset=\"-4\" />\r\n    </React.Fragment>\r\n    : undefined)\r\n\r\n  const iconMeter = audioMeterSteps.map(step => audioLevel > step ?\r\n    <React.Fragment key={step}>\r\n      <img src={proximityVolumeIcon} className={classes.iconProximity} alt=\"\"/>\r\n    </React.Fragment>\r\n    : undefined)\r\n\r\n  /* const arrow = <g transform={`translate(${svgCenter} ${svgCenter}) rotate(-135) `}>\r\n    <rect style={{pointerEvents: 'fill'}}\r\n      height={outerRadius} width={outerRadius} fill={color} />\r\n    {isLocal ?\r\n      <path  d={`M 0 ${outerRadius} h ${outerRadius} v ${-outerRadius}` +\r\n        `a ${outerRadius} ${outerRadius} 0 1 0 ${-outerRadius} ${outerRadius}`}\r\n        fill=\"none\" stroke={textColor} />\r\n    : undefined}\r\n  </g> */\r\n\r\n  /* const flog = <g style={{pointerEvents: 'fill'}} >\r\n    <circle {...eyeClick} r={0.35 * outerRadius} cy={svgCenter + eyeOffsets[0][1]}\r\n      cx={svgCenter + eyeOffsets[0][0]} fill={color} />\r\n    <circle {...eyeClick} r={0.35 * outerRadius} cy={svgCenter + eyeOffsets[1][1]}\r\n      cx={svgCenter + eyeOffsets[1][0]} fill={color} />\r\n    {participantProps.awayFromKeyboard === true ?\r\n      undefined\r\n      :<>\r\n      <circle {...eyeClick} r={0.25 * outerRadius} cy={svgCenter + eyeOffsets[0][1]}\r\n        cx={svgCenter + eyeOffsets[0][0]} fill=\"white\" />\r\n      <circle {...eyeClick} r={0.25 * outerRadius} cy={svgCenter + eyeOffsets[1][1]}\r\n        cx={svgCenter + eyeOffsets[1][0]} fill=\"white\" />\r\n      <circle {...eyeClick} r={0.14 * outerRadius} cy={svgCenter + eyeOffsets[0][1] + eyeballs[0][1]}\r\n        cx={svgCenter + eyeOffsets[0][0] +  eyeballs[0][0]} fill=\"black\" />\r\n      <circle {...eyeClick} r={0.14 * outerRadius} cy={svgCenter + eyeOffsets[1][1] + eyeballs[1][1]}\r\n        cx={svgCenter + eyeOffsets[1][0] +  eyeballs[1][0]} fill=\"black\" />\r\n    </>}\r\n  </g>\r\n  const nose = <path d={`M ${svgCenter-noseWidth*outerRadius/2} ${svgCenter-outerRadius*noseStart} `+\r\n    `Q ${svgCenter} ${svgCenter-outerRadius*(noseStart+noseLength)}` +\r\n    ` ${svgCenter+noseWidth*outerRadius/2} ${svgCenter-outerRadius*noseStart}`} stroke={textColor} fill={color} /> */\r\n\r\n\r\n  //const tail = <path d={`M ${svgCenter-tailWidth*outerRadius} ${svgCenter+outerRadius*tailStart}` +\r\n  //  ` Q ${svgCenter} ${svgCenter+outerRadius*(tailStart+tailLength)}`+\r\n  //  `  ${svgCenter+tailWidth*outerRadius} ${svgCenter+outerRadius*tailStart}`} stroke={textColor} fill={color} />\r\n\r\n  /* const tail = undefined */\r\n\r\n  /* const avatarOuter = config.avatar === 'arrow' ?  //  arrow (circle with a corner) type avatar\r\n    arrow : '' // Frog type (two eyes) avatar */\r\n\r\n  const outerUnder = <svg\r\n    className={classes.pointer} width={props.size * SVG_RATIO} height={props.size * SVG_RATIO} xmlns=\"http://www.w3.org/2000/svg\">\r\n    {/* {nodding ? (isNoseUp ? tail : nose) : undefined}\r\n    <circle r={outerRadius} cy={svgCenter} cx={svgCenter} stroke={isLocal ? textColor : 'none'} fill={color} />\r\n    {audioMeter}\r\n    {(!nodding || !isNoseUp) ? avatarOuter : undefined} */}\r\n    { (inZone === 'close' && (participant.id !== props.stores.participants.localId) && zoneId === localZoneId) ?\r\n    <circle r={outerRadius} cy={svgCenter} cx={svgCenter} stroke=\"#ff4500\" stroke-width=\"4\" fill={'#00000020'} /* fill={color} */ />\r\n    :  (proxCords !== undefined && proxCords < 360 &&\r\n      ((participant.id !== props.stores.participants.localId)) && localZoneId === undefined)\r\n      ? <circle r={outerRadius} cy={svgCenter} cx={svgCenter} stroke=\"#ff4500\" stroke-width=\"4\" fill={'#00000020'} />\r\n      : <circle r={outerRadius} cy={svgCenter} cx={svgCenter} stroke=\"none\" fill={'#00000020'} />\r\n    }\r\n    {audioMeter}\r\n    {config.avatar === 'arrow' ?  //  arrow (circle with a corner) type avatar\r\n      <g transform={`translate(${svgCenter} ${svgCenter}) rotate(-135) `}>\r\n        <rect style={{pointerEvents: 'fill'}}\r\n          height={outerRadius} width={outerRadius} fill={color} />\r\n        {isLocal ?\r\n          <path  d={`M 0 ${outerRadius} h ${outerRadius} v ${-outerRadius}` +\r\n            `a ${outerRadius} ${outerRadius} 0 1 0 ${-outerRadius} ${outerRadius}`}\r\n            fill=\"none\" stroke={textColor} />\r\n          : undefined}\r\n      </g>\r\n      : // Frog type (two eyes) avatar\r\n      <g style={{pointerEvents: 'fill'}} >\r\n      </g>}\r\n  </svg>\r\n\r\n  /* const outerOver = <svg\r\n    className={classes.pointer} width={props.size * SVG_RATIO} height={props.size * SVG_RATIO} xmlns=\"http://www.w3.org/2000/svg\">\r\n    {isNoseUp ? avatarOuter: undefined}\r\n    {nodding ? (isNoseUp ? nose : tail) : undefined}\r\n  </svg> */\r\n\r\n  const useVrm = participant.information.avatarSrc && participant.information.avatarSrc.slice(-4) === '.vrm'\r\n\r\n  return <>\r\n    <div className={classes.root} style={{zIndex:isLocal ? 5000 : participant.zIndex}}>\r\n      {shadow}\r\n      <div className={classes.pointerRotate}>\r\n        {outerUnder}\r\n        <div className={classes.avatar + ' dragHandle'} onContextMenu={props.onContextMenu}>\r\n          <Tooltip title={name}>\r\n            <div>\r\n            { (inZone === 'close' && (participant.id !== props.stores.participants.localId) && zoneId === localZoneId) ?\r\n            <img src={zoneGlowIcon} className={anim ? classes.avatarGlow : classes.avatarGlowEffect} draggable={false} alt='' />\r\n             :  (proxCords !== undefined && proxCords < 360 &&\r\n            ((participant.id !== props.stores.participants.localId)) && localZoneId === undefined)\r\n            ?  '' : ''}\r\n              <Avatar {...props} />\r\n              {iconMeter}\r\n              <img src={_icons === 'smile' ? symSmileIcon : (_icons === \"hand\" ? symHandIcon : (_icons === \"clap\" ? symClapIcon : undefined))} className={_icons === '' ? classes.iconEmoticonNone : classes.iconEmoticon}  alt='' />\r\n              <SignalQualityIcon className={classes.signalIcon} quality={props.participant.quality} />\r\n              {(_connQuality !== undefined && _connQuality < 70) ? <img src={badConnIcon} className={classes.conIcon}  alt='' /> : undefined}\r\n              {headphone ? <HeadsetIcon className={classes.icon} htmlColor=\"rgba(0, 0, 0, 0.3)\" /> : undefined}\r\n              {speakerMuted ? <SpeakerOffIcon className={classes.icon} color=\"secondary\" /> :\r\n                (micMuted ? <MicOffIcon className={classes.icon} color=\"secondary\" /> : undefined)}\r\n              {!micMuted && onStage ? <Icon className={classes.icon} icon={megaphoneIcon} color=\"gold\" /> : undefined }\r\n              {props.isPlayback ? <PlayArrowIcon className={classes.icon} htmlColor=\"#0C0\" /> : undefined}\r\n            </div>\r\n          </Tooltip>\r\n          <div>\r\n            <img src={_pingIcon !== false ? PingIcon : undefined} style={_pingIcon !== false ? {display: 'block', width: TITLE_HEIGHT,position:'relative', textAlign: 'center', top: (yPos), left: (xPos), whiteSpace: 'pre'} : {display:'none'}} alt='' />\r\n            <img style={_pingIcon !== false ? {backgroundColor:rgb2Color(rgb), borderRadius: '50%', position:'relative', display: 'block', width: (TITLE_HEIGHT - 4), textAlign: 'center', top: (yPos - 48), left: (xPos+1.5), whiteSpace: 'pre'}  : {display:'none'}} src={_pingIcon !== false ? participant.information.avatarSrc : undefined} alt='' />\r\n        </div>\r\n        </div>\r\n       {/*  {outerOver} */}\r\n      </div>\r\n    </div>\r\n    {useVrm ? <div className={classes.root} style={{zIndex:participant.zIndex + 5000}}>\r\n      <VRMAvatar participant={participant} /></div> : undefined}\r\n  </>\r\n}\r\nRawParticipant.displayName = 'RawParticipant'\r\n\r\n//export const Participant = forwardRef(RawParticipant)\r\n//Participant.displayName = 'Participant'\r\n\r\nexport const Participant = (props: RawParticipantProps) =>\r\n  React.useMemo(() => <RawParticipant {...props} />,\r\n  //  eslint-disable-next-line react-hooks/exhaustive-deps\r\n  [props.size, props.participant.id,\r\n    props.participant.information.avatarSrc,\r\n    props.participant.information.color,\r\n    props.participant.information.name,\r\n    props.participant.information.textColor,\r\n  ])\r\nParticipant.displayName = 'MemorizedParticipant'\r\n","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGkAAACXCAYAAAAWGnVTAAAACXBIWXMAAC4jAAAuIwF4pT92AAAQr0lEQVR4nO2df2wT5xnHv3f2mUgRxhFsYVkGgQ4oMywJ0I103TDrikQ7CkXR2o6VGmnqOoE0WlVs8EeX9g8iVVNHpSK1+2eGinaaaBVatZXSbThbRelWmiCgG6WjCWOs0YpwYEghTu72x2snd+89r3227947B38ki/i9870v/vp53+f99byKYRioEWzCfhegRBIAWrgXcv/OJ+4/CSCT+3sg93cawGDuVRUoAbakFjBREgDaALS6/PwRMOHSplcgCZpIbQCSADaBtgwvGQETqif3yhS8WyJBEKkFwE74I4yIETChUgiAhfkpUgJAF4A1JX9yKA3jxjUYl/8OADBu/A/65bOWW5TITKhzFrM3kSjUObfCmDUPSmxhqbmdBLAPTDBf8EOkJJg4jqzGGO6HcfF96Jc+gH75I+jXL1ZcgNDcDqizl0Btug2Y920odTEnHxsCK3eq4gKUiEyREmD/wYLiGKMZGJ+8CePSCYwP9sLIXvW8YGpDHOElG6Hcss6JpQ2BVc89nhcshwyRWsDEKVitGR+/AX3wKLLnDntdnoKE5nYgtOReqMu2FLu1D0ysAa/L5LVIXQB+KbpojGZgnPkdxk8ddKUacxNFi0JbvhVK+yPFqsOnwP6f3pXFI5HawKyH7NsYoxkY/b9B9tRBKdVZJTgU6yRYW+uJVXkhUhLMG5pFXdRPvIDsiecDLw5PXiy1Y5folhGw6i/let4ui5QC8DB5ZSiNsaN7AletlYpa34zI2r3A/ITolgNgP1TXcEukGFinz1a9GaMZ6MefRfZMyo18AoO2qBPqd54UVYEnwbxZV0Yt3BBJLNBwP7Jvb6966xGh1jdDW78fSmM7ddm1dqpSkdrABLK1P/qJFzB2fG8lz64aIqv3QF35KHVpBMyiKhKqEpGEAk30Pu57f0c22qJOhNY9S12qWKhyRYrlMrWMHhijGYy/+RNMfPZeueWpatSGOLTNr1DtVEVClSMS2QYZoxlkX3sQ+pUz5ZRj2lBAqLKdCbWMcvSgJpAQ/coZZF97EMaoTYtWsB+3o9FcM6WKtA/cGFxNIDtFhNpX6vNKEWkTgJ/xiRPvPFETiKCAUA+DjUw4xqlILSCGOybST2L8Qm8p+d1U6FfOQP/z09SlX4N5x45wKlIKnKutnz407UYRvCB77jD0956hLvXAYfvkRKSd4Nuh4X5kj3U7eX4NAGMfPg8Mpfnk+XA4xVHMBY+BrU+zWNHYy+tr7VCJKFoUka3vUq75WhRZ7FLMkmxTDvp7z9QEKgMjexUT7zxBXSrq7RUSKQFu2sEY7memW6Msxi/0wvj4DT65FUW8vULVXRpcW5R99f6bdsjHLQTV3giYB02ORogsKQFOIP30ocAKpGhRtoDE9FLrm/0uFomRvQr9uG0gdhYKWJPIktLgRBpL3R6YeaHwvHVQm1ZBnXNroRlSALl1e//9SOoSMSfM2JLml48JrYkSqQ1AvzlBP30IY3273S1liaj1zQiv2g7lq/c4XcxIop8+hImzr/teKwimNsiVR5RIKXAOg59WpGhRaLfvdrIOrjQCsOZCYE22XyDfJsXACaSfPuTbf0Rb1InI1nfdFwgA5icQSR5DZMUO95/tEP2vNk95FohFLLxIm/gbJs6+7lqhnKJoUUTWdCO07tlCVdsQ2MqcbWAdwgYAium1Nnftudy9JGrHLtR9/yAULeri/8AZ2XOHYWTO88lJPoGv7noAbMy/MTLnceNQwoPiiVG0KCIbXxIt7gCAI2AdwHSJj24D86DIJWfGcD/Gjjwk3bGIrNhBreVbANNORLMlxWASCAD0gZRHRaMpIlAfmHVsQnl7hgbAfqULcs+y5t3YzvKWbFHjZ8l1/0nzG7NI9qpu8A/ulqgIkUS3SKCnwPpuaReyGcw96zH+Ql4omejXL1KjEEnzG7NICfMFY7hfqsOgxZNQFm+gLm2DNwvi94FZ5og5UWlsR2T1Hg+yE6MPHuWT5mNq03YBkS6+71WZbKj1zQglyMmxbfB201Ya3P8bANSVjyI0t8PDbK2MD5ITp5M1W16kFnDLs/RLH3hWKJ7IWnIR5WOQs6tuAOzHYCF8xy8kZM0wslep+aZE/o+8SLap3In/HPesUGZCczuooZ28ByeLVC7PSZTGdmiLOqUVYOLTP/FJk04cKZIx3C/NFdVW/ZRPym8hkU0SXPuktj4kLfOJS3+jktuAKZESlksjchwGtb6ZsqIU/IlWkgFnvUpjO9SGuJTMBROpCWBKJEu3Pr/13mtCLd+jkmVWc0XzDi/ZSN3nDfZ2yWJJlhWp+ucfe18gAKEF3+WTjsDfmD8Z8G1T8zelZa5//g8+qQUQTPoZY9c8Lk4Oe1WXlpNxQSxDAEpju7RRCOOyzTjWAEykhO3ma//yvECCuj7tecbFSfMJ6mxJ7dK1f1PJMdKSZIw0KDPIX6fnMREcMMgnqDO/LCVjgXG0lbOrwhVCTSv5JOF0gg9YBmCVmXOlZCoyDt9EIhj0uwBBgFjg3xIkkWoAUIZtNX5NpKBhNNo3W/gmknHtMz6p9Lh33tHiR6ZqQ5xaLpD2TSSRuym7HAIsMwITl05IyTQ0ZymV7J9IAnczIbkYFAk+wbghZ7BZsXu8fQCr7mzuhIwluvr1i9RKmYTnGRfHsozAGM1I20WifOFrfNIAwESyuRPKzK9IKBJgXLStIrWts/ABaxku/EVKpooWpdZ3pAGf+0n6p+TcflJ+SSZJgJ+htq8/8ATB0NOkJQFcb58YDfCE8Qu9VOfNjwm/PF3mN8ZoRrT+wHWI73wEuQ5+XqRBy+WIvLVnRv9v+KRW+GNNm8DvDf7kTWkz1Mpsm2c32QypfAIAtqVEEtlTBylr2ge5fZUYiEUv4x/sl1eCL9qqu3T+j7xIlm+J6vV6hZG9SlnTLJSwhd4FekDtDZa07lDRolSo63T+D5VPAAClLiZ1ue3Yh8/DGO7nk1shR6gU+Goucx7ZUwc9znaK0JdWU8mFqztA3kRXnuwf91DV3hqUGTTJATGwH4FtAX/2re1SF+5PHtcwxRBMtZu5uvPFw8tTIMRLK9iPKOFidoncM22rTCZ6H5ceAkFt+gafZPURhBfsH/Sc7LnDmOh9nLo0H8BRsF9+SwVZtIBVb0dBHMfgV8RLwgdIm98IRZLpPJgpIBTAfvmfgomVhLNqMJa7tyf3WXJ/kl8CCUa+LVqYN5ElwH5hk/gZnkZtiEO7e7+TAz5OgvXz+Ha1DcxyCp5g5ndIUsEGZ8X8xnymX5q/M9R0m28i6VfOYOz390JbuUMUKThPa+5V8ipG/fQhZI91+xo2QDTybYYfu7PcQCxelIqRvYqx43sx9vJ6aqNV+QylkX31foz17fY9roPSbNtiYx/w5vbM7gQLmDfJ6P55rhesXNT6ZoSXb3V6zpEFI3Mexj97A3XCjFrfjEjyGJ98H/gFmpxItkAb42/8OJDRIdX6ZoSaVkOZORfK7KVQZsy0XM8fJ2dc+wwTl44HRhgzgvaoAdwIEH/O7ABYf2nSPVWbVgEBFEm/fhF6lQeIJ9oj87m4k1DzSWnLg25Z51qhalgh2qM0dR8lkrU+jC2UtkfnZkJtiBccVLXcS6TZbgwvWFtxoWpYCTXdRiWTQR0okex7dBbeVXmpalhQl97HJx2h7gPEaxxse3SCGuSvGlHrm4WLTsj7Bek2sxNsnaxRBoLvkqzqALFItipPbUuWXagaVoiqLj/+SN9f4Fk1L88DBFVdquBnClyzmZ/UndjTlPDyrVSysKoDCotk9/JqHduKIb7Dojvui61gTVkyiC1EeF5NqHIJzyMHhgtaEVBcpB7woVxqHduyCdmbixE4CHLlZC24RWl12RZf4pVWO2p9MxXPL+Xosw7usYdyWbzZybNrmAgvITeMOArR40SkATA/fupDtT5TyShLbWHZ+uBwx73TrS/W6FWxhVIjK1Y72qJOymFIOf28U5FsDkR4+Y+c5nHTE1pyL5/kyGHI41SkDPgRiMUbaoOuDlAb4lSgq5LCxZWy06+LTxD0nmuYCH+drHFSpTyjFJEGwcfciT9Qc8cLoGhR6pyNAygxRE85JzZPFaIuVnPHC6DRNU2q1OeUKlIPuN0XNXecRtGiUNof4ZP7UEZMv3J2n3dZChNbKDU0c7UQXryZWoifKudZxc6ZFZGBafuiH6fDBB3iAKshlLltp9w4DrbObc2aphB0XrvKfV65lmQ7yblmTVO4aUVA+ZZkD3ResyYAlQ8BUZRrSUDNmkhKOZrUKZXEFqpZE4fAivahAoGAyiwJqFmTBS+sCKg8ShdtTfFkhY+tPiIrdnhiRUDllgRQ1jSawdjBO3zf6igLwaHzQ2Cb8ioWyY14dxlw4c+Uupho3Gpaoi3fSo0udMEFgQB3LCnPILgAFkE61N4r1PpmaA+8RVlRi2t5uPUgEMEEw6u2u/j4YBJetV1kRa7hpkg94Oab1GVbpvVaCLUhTs0X9cHlAyPdjsHaxSfIPGVSNpFv/ZxK7nI7H7dFSoPNPE6iNLZPS5dcW9QpOtUz7XZebjoOeaa9S65oUUR+8DrVcW2DB6fXeBFyOgN+YrAuBu323R5k5Q/a8q2ijuugF/l5YUl5BsBFyMq+er9v0bDcQm2II/LDt/lk1zquZJ5ePDSH3SW/s7vqVxcJnIWd8EggwFuR0uCdiNjCqh6J0OJJylnog4M9RpXgZXUHEE4E4G+ww3IRjM955iyY8fqsigyIaPnanXs9ztZ9IoluamTBM2fBjIwDRXrA771tbEdkxQ4JWbtDeN46agPYSXjQcaXwurrL0wLm7VVdtSeo5gCgHZLOxZV1NM8giF+ddufewHt7gmruOUg8uFjm+Un7QFR72srgVnuCam4Ikqq5PLKquzyktxfETq5gnggA1kLyGe2yTyIjvb3wPS8GrtqLrN1LCfQUJAsE+HNcXA/4Tm5dDJFEtw9FoYms2EF1WqV5czx+nem3E9wWGmXxhkBMaagNcagdu6hLSclFmcQvkTIgTsIMJZ72NRKYokWh3U2ePvYYJHpzPH6ejjkAVsdb0O7e71v7FEl0U1MQfShxI7Lb+H1AfRf4fbixhb60T1o8SbnbIwjA2bd+iwSwL8ESI0JZvEHqsJHaEEcoQR6wtQkeTkE4JQgike2T2rFLykojRYtC2/wKdckXd5siCCIB7MuwtU/he170PKBHZONLVH+oDz652xRBEQlgX4p12KguBm29d45EZE03FQ91CAFoh8wESSSA9UWs/afGdk8WsWiLOqmFjUBA2iEzQRMp3z5Zo1Uu2+JqR1dtiFNH4gDANvjYHxIRNJEA9iXZFrGEEk+7Ev9VbYiLHIUDcHl5sFsEUSSAfVk2RyJ0168qGpFQtCibw6IdhWTZD/YY2VMVpdID7kDFSlbDzug8InIUPFsz5wZBtaQ8SXChRZW6GHObS/T4BJ5cfkQhsAIBwReJdCSUxvaSho4ia7oLeXKBcxR4gi4SwGZyE6CGjtYUF6qAq70NARlRKEY1iAQIPL5irrng9EmAOSUpl8rmOUF3HHiSAH7LJ1LnlhcQ6AAC7MlRVJtIALMA2yHz5iOyIyt2iGZXq04goDpFAgRCGZnzACA6zfkkWNsWaE+OolpFAgRCCahagYDqcRwokuBWHQk4gCoWCKhukQAm1H3gRs5zjIC52UlUsUBAdVd3PIncC2D9n7RP5XCd6STStOX/HDtis2XStq0AAAAASUVORK5CYII=\"","import {MAP_SIZE} from '@components/Constants'\r\nimport {MoreButton, moreButtonControl, MoreButtonMember} from '@components/utils/MoreButton'\r\nimport {makeStyles} from '@material-ui/core/styles'\r\nimport {addV2, assert, isSmartphone, mulV2, /* rotateVector2DByDegree,  */subV2, /* transformPoint2D, transfromAt,  */rgb2Color} from '@models/utils'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React, {useEffect, useRef, useState} from 'react'\r\nimport {DragHandler, DragState} from '../../utils/DragHandler'\r\n/* import {KeyHandlerPlain} from '../../utils/KeyHandler' */\r\nimport {LocalParticipantForm} from './LocalParticipantForm'\r\nimport {Participant, ParticipantProps} from './Participant'\r\n\r\nimport { MuiThemeProvider, createTheme } from '@material-ui/core/styles'\r\nimport { TITLE_HEIGHT } from '@stores/sharedContents/SharedContents'\r\nimport { MouseOrTouch } from '../Share/RndContent'\r\nimport html2canvas from 'html2canvas'\r\nimport { Button, Dialog, DialogContent, DialogTitle, List, ListItem, Tooltip, Zoom } from '@material-ui/core'\r\nimport MoreIcon from '@images/whoo-screen_btn-more.png'\r\nimport AvatarGenIcon from '@images/earshot_icon_edit_avatar.png'\r\nimport { useGesture } from 'react-use-gesture'\r\nimport {useTranslation} from '@models/locales'\r\n\r\n\r\nconst theme = createTheme({\r\n  palette: {\r\n    primary: { main: '#7ececc' },\r\n    secondary: { main: '#ef4623' },\r\n  },\r\n});\r\n\r\nconst AVATAR_SPEED_LIMIT = 50\r\nconst MAP_SPEED_LIMIT = 600\r\nconst MAP_SPEED_MIN = 100\r\nconst HALF_DEGREE = 180\r\nconst WHOLE_DEGREE = 360\r\n//const HALF = 0.5\r\n\r\n\r\ntype LocalParticipantProps = ParticipantProps\r\n\r\ninterface StyleProps {\r\n  position: [number, number],\r\n  size: number,\r\n  mem:LocalMember,\r\n}\r\n\r\nconst useStyles = makeStyles({\r\n  more: (props: StyleProps) => ({\r\n    position: 'absolute',\r\n    width: props.size * 0.5 ,\r\n    height: props.size * 0.5,\r\n    left: props.position[0] + props.size * 0.4,\r\n    top: props.position[1] - props.size * 0.8,\r\n  }),\r\n  hideMenuContainer: (props:StyleProps) => ({\r\n    display: 'flex',\r\n    position: 'absolute',\r\n    width: 350,\r\n    height: 250,\r\n    overflow: 'hidden',\r\n    userSelect: 'none',\r\n    userDrag: 'none',\r\n    bottom: 'auto',\r\n    /* transform: 'scale(0)', */\r\n    backgroundColor: 'transparent',\r\n    transition: '0s ease-out',\r\n    cursor: 'default',\r\n  }),\r\n  showMenuContainer: (props:StyleProps) => ({\r\n    display: 'flex',\r\n    position: 'absolute',\r\n    width: 350,\r\n    height: 250,\r\n    overflow: 'hidden',\r\n    userSelect: 'none',\r\n    userDrag: 'none',\r\n    //top: (props.position[1]) - 130,\r\n    //left: isSmartphone() ? (props.position[0]) - 160 : (props.position[0]) - 170,\r\n    top: 0,\r\n    left: 0,\r\n    bottom: 'auto',\r\n   /*  transform: isSmartphone() ? 'scale(2.8)' : 'scale(1.2)', */\r\n    backgroundColor: 'transparent',\r\n    transition: '0.3s ease-out',\r\n    transitionDelay: '0.1s',\r\n    cursor: 'default',\r\n  }),\r\n\r\n  dashedCircle: (props: StyleProps) => ({\r\n    position: 'relative',\r\n    width:200,\r\n    height:200,\r\n    borderWidth:2,\r\n    borderStyle: 'solid',\r\n    borderColor:'#9e886c',\r\n    borderRadius:'50%',\r\n    opacity: 0.4,\r\n    top: 25,\r\n    left: 65,\r\n    background: 'radial-gradient(#ffffff, #ffffff, #ffffff, #9e886c, #9e886c)',\r\n    zIndex: -9999,\r\n  }),\r\n\r\n  moreIcon: (props:StyleProps) => ({\r\n    display: 'block',\r\n    height: TITLE_HEIGHT,\r\n    position:'absolute',\r\n    textAlign: 'center',\r\n    top: 180,\r\n    left: 145,\r\n    whiteSpace: 'pre',\r\n    cursor: 'default',\r\n    background: '#9e886c',\r\n    ...buttonStyle\r\n  }),\r\n\r\n  avatarTool: (props:StyleProps) => ({\r\n    display: 'block',\r\n    height: TITLE_HEIGHT,\r\n    position:'absolute',\r\n    textAlign: 'center',\r\n    top: 25,\r\n    left: 140,\r\n    whiteSpace: 'pre',\r\n    cursor: 'default',\r\n    background: '#9e886c',\r\n    /* opacity: 0.2, */\r\n    ...buttonStyle\r\n  }),\r\n\r\n  moreInfo: (props:StyleProps) => ({\r\n    display: 'block',\r\n    height: TITLE_HEIGHT,\r\n    position:'absolute',\r\n    textAlign: 'center',\r\n    top: 180,\r\n    left: 145,\r\n    whiteSpace: 'pre',\r\n    cursor: 'default',\r\n    background: '#9e886c',\r\n    ...buttonStyle\r\n  }),\r\n\r\n  mainContainer: {\r\n    display: 'flex',\r\n    height: '100%',\r\n    width:'100%',\r\n\r\n  },\r\n  menuContainer: {\r\n    position:'relative',\r\n    top:'12px',\r\n    left: '15px',\r\n    width:'100px',\r\n    height:'100px',\r\n  },\r\n  galleryMain : {\r\n    width:'91%',\r\n    height:'100%',\r\n    minWidth: '440px',\r\n    minHeight: '400px', //'245px',\r\n    border:'2px dashed #00000030',\r\n    left:'45px',\r\n    position:'relative'\r\n  },\r\n  gallery: {\r\n    display:'grid',\r\n    position: 'relative',\r\n    marginLeft: '10px',\r\n    gridTemplateColumns: 'repeat(7, 0.1fr)',\r\n    gap:-10,\r\n    overflowY:'auto',\r\n    overflowX: 'hidden',\r\n    height:'334px',\r\n    alignContent:'flex-start',\r\n  },\r\n  galleryList: {\r\n    display:'grid',\r\n    position: 'relative',\r\n    marginLeft: '10px',\r\n    gridTemplateColumns: 'repeat(7, 0.1fr)',\r\n    gap:-10,\r\n    overflowY:'hidden',\r\n    overflowX: 'hidden',\r\n    height:isSmartphone() ? '110px' : '90px',\r\n    alignContent:'flex-start',\r\n  },\r\n  deavticeButtons: {\r\n    position:'relative',\r\n    padding:'10px',\r\n    fontSize:isSmartphone() ? '1.5em' : '1em',\r\n    fontWeight:'bold',\r\n    borderBottom: '2px solid #7ececc',\r\n    color:'#000000',\r\n    cursor: 'pointer',\r\n  },\r\n\r\n  avticeButtons: {\r\n    position:'relative',\r\n    padding:'10px',\r\n    fontSize:isSmartphone() ? '1.5em' : '1em',\r\n    fontWeight:'bold',\r\n    borderBottom:'2px solid #7ececc',\r\n    color:'#ef4623',\r\n    cursor: 'default',\r\n  }\r\n})\r\n\r\nconst buttonStyle = {\r\n  '&': {\r\n    margin: '5px',\r\n    borderRadius: '50%',\r\n    width: '35px',\r\n    height: '35px',\r\n    padding: '3px',\r\n\r\n    //border: '2px solid #9e886c',\r\n    //backgroundColor: 'white',\r\n  },\r\n\r\n  '&:hover': {\r\n    backgroundColor: 'black', //'rosybrown',\r\n    margin: '5px',\r\n    padding: '3px',\r\n    borderRadius: '50%',\r\n  },\r\n  '&:active': {\r\n    //backgroundColor: 'firebrick',\r\n    margin: '5px',\r\n    padding: '3px',\r\n    borderRadius: '50%',\r\n  },\r\n}\r\n\r\nclass LocalMember{\r\n  prebThirdPersonView = false\r\n  mouseDown = false\r\n  dragging = false\r\n\r\n  // New values\r\n  upTime = 0\r\n  downTime = 0\r\n  downXpos = 0\r\n  downYpos = 0\r\n  upXpos = 0\r\n  upYpos = 0\r\n  contentX = 0\r\n  contentY = 0\r\n  zoomX = 0\r\n  zoomY = 0\r\n  moveX = 0\r\n  moveY = 0\r\n\r\n  clickStatus = ''\r\n  userAngle = 0\r\n  clickEnter = false\r\n  pingX = 0\r\n  pingY = 0\r\n  hidePinIcon = 0\r\n\r\n  // moveLoc\r\n  cursorX = 0\r\n  cursorY = 0\r\n}\r\n\r\ninterface LocalParticipantMember extends MoreButtonMember{\r\n  smoothedDelta: [number, number]\r\n  scrollAgain: boolean\r\n}\r\n\r\nlet onLocalUser:boolean = false\r\nexport function getOnLocalUser() : boolean {\r\n  return onLocalUser;\r\n}\r\n\r\nlet isConteMenuOpen:boolean = false\r\nexport function getUserContextMenu() : boolean {\r\n  return isConteMenuOpen;\r\n}\r\n\r\n\r\nlet selectedImage:string = ''\r\nlet selectedGroup = ''\r\nlet selectedSkin = ''\r\nlet selectedHairColor = ''\r\nlet selectedHair = ''\r\nlet selectedHairBack = ''\r\nlet selectedOutfits = ''\r\nlet selectedSpecs = ''\r\nexport function getSelectedImage() : string {\r\n  return selectedImage\r\n}\r\n\r\nexport function ResetSelectedImage() {\r\n  selectedImage = ''\r\n}\r\n\r\n// Different Avatar Item\r\nlet isAvatarToolOpen: boolean = false\r\nexport function getAvatarToolStatus() : boolean {\r\n  return isAvatarToolOpen\r\n}\r\nconst LocalParticipant: React.FC<LocalParticipantProps> = (props) => {\r\n  const map = props.stores.map\r\n  const participants = props.stores.participants\r\n  const participant = participants.local\r\n\r\n\r\n  const memRef = useRef<LocalMember>(new LocalMember())\r\n  const mem = memRef.current\r\n\r\n  // Showing default Avatar\r\n  if(participant.information.avatarSrc === '') {\r\n    /* var _rnd = Math.ceil(Math.random() * (AVATARS.length-1))\r\n    participant.information.avatarSrc = AVATARS[_rnd]\r\n    participant.sendInformation()\r\n    participant.saveInformationToStorage(true) */\r\n  }\r\n\r\n  function updateUserAvatar(_path:string) {\r\n    if(participant.information.avatarSrc === _path) {return}\r\n    if(activeSkin === -1) {return}\r\n    participant.information.avatarSrc = _path\r\n    // Storing values to localstorage\r\n    participant.information.randomAvatar = [selectedSkin, selectedHairColor, selectedGroup, selectedHair, selectedOutfits, selectedSpecs]\r\n    participant.sendInformation()\r\n    participant.saveInformationToStorage(true)\r\n    onCloseDialog()\r\n  }\r\n\r\n\r\n  assert(props.participant.id === participant.id)\r\n  const member = useRef<LocalParticipantMember>({} as LocalParticipantMember).current\r\n\r\n\r\n  const moveParticipant = (state: DragState<HTMLDivElement>) => {\r\n    //  move local participant\r\n    let delta = subV2(state.xy, map.toWindow(participant!.pose.position))\r\n    const norm = Math.sqrt(delta[0] * delta[0] + delta[1] * delta[1])\r\n    if (norm > AVATAR_SPEED_LIMIT) {\r\n      delta = mulV2(AVATAR_SPEED_LIMIT / norm, delta)\r\n    }\r\n\r\n    if (participants.local.thirdPersonView) {\r\n      const localDelta = map.rotateFromWindow(delta)  // transform.rotateG2L(delta)\r\n      participant!.pose.position = addV2(participant!.pose.position, localDelta)\r\n      const SMOOTHRATIO = 0.8\r\n      if (!member.smoothedDelta) { member.smoothedDelta = [delta[0], delta[1]] }\r\n      member.smoothedDelta = addV2(mulV2(1 - SMOOTHRATIO, localDelta), mulV2(SMOOTHRATIO, member.smoothedDelta))\r\n      const dir = Math.atan2(member.smoothedDelta[0], -member.smoothedDelta[1]) * HALF_DEGREE / Math.PI\r\n      let diff = dir - participant!.pose.orientation\r\n      if (diff < -HALF_DEGREE) { diff += WHOLE_DEGREE }\r\n      if (diff > HALF_DEGREE) { diff -= WHOLE_DEGREE }\r\n      const ROTATION_SPEED = 0.2\r\n      participant!.pose.orientation += diff * ROTATION_SPEED\r\n    } else {\r\n      participant!.pose.position = addV2(map.rotateFromWindow(delta), //    transform.rotateG2L(delta),\r\n                                         participant!.pose.position)\r\n    }\r\n    participant.savePhysicsToStorage(false)\r\n  }\r\n  /* const moveParticipantByKey = (keys:Set<string>) => {\r\n    let deltaF = 0\r\n    let deltaA = 0\r\n    const VEL = 10\r\n    const ANGVEL = 5\r\n    let relatedKeyPressed = false\r\n    if (keys.has('ArrowUp') || keys.has('KeyW')) {\r\n      deltaF = VEL\r\n      relatedKeyPressed = true\r\n    }\r\n    if (keys.has('ArrowDown') || keys.has('KeyS')) {\r\n      deltaF = -VEL * HALF\r\n      relatedKeyPressed = true\r\n    }\r\n    if (keys.has('ArrowLeft') || keys.has('KeyA') || keys.has('KeyQ')) {\r\n      deltaA = -ANGVEL\r\n      relatedKeyPressed = true\r\n    }\r\n    if (keys.has('ArrowRight') || keys.has('KeyD') || keys.has('KeyE')) {\r\n      deltaA = ANGVEL\r\n      relatedKeyPressed = true\r\n    }\r\n    if (keys.has('ShiftLeft') || keys.has('ShiftRight')) {\r\n      deltaA *= 2\r\n      deltaF *= 2\r\n    }\r\n    let newA = participant!.pose.orientation + deltaA\r\n    if (newA > HALF_DEGREE) { newA -= WHOLE_DEGREE }\r\n    if (newA < -HALF_DEGREE) { newA += WHOLE_DEGREE }\r\n    participant.pose.orientation = newA\r\n    if (!participants.local.thirdPersonView) {\r\n      const center = transformPoint2D(map.matrix, participants.local.pose.position)\r\n      const changeMatrix = (new DOMMatrix()).rotateSelf(0, 0, -deltaA)\r\n      const newMatrix = transfromAt(center, changeMatrix, map.matrix)\r\n      map.setMatrix(newMatrix)\r\n      map.setCommittedMatrix(newMatrix)\r\n    }\r\n    const delta = rotateVector2DByDegree(participant!.pose.orientation, [0, -deltaF])\r\n    //  console.log(participant!.pose.position, delta)\r\n    const newPos = addV2(participant!.pose.position, delta)\r\n    if (newPos[0] < -MAP_SIZE * HALF) { newPos[0] = -MAP_SIZE * HALF }\r\n    if (newPos[0] > MAP_SIZE * HALF) { newPos[0] = MAP_SIZE * HALF }\r\n    if (newPos[1] < -MAP_SIZE * HALF) { newPos[1] = -MAP_SIZE * HALF }\r\n    if (newPos[1] > MAP_SIZE * HALF) { newPos[1] = MAP_SIZE * HALF }\r\n    participant.pose.position = newPos\r\n    participant.savePhysicsToStorage(false)\r\n\r\n    return relatedKeyPressed\r\n  } */\r\n\r\n  const scrollMap = (ratio: number) => {\r\n    const posOnScreen = map.toWindow(participant!.pose.position)\r\n    const target = [posOnScreen[0], posOnScreen[1]]\r\n    const left = map.left + map.screenSize[0] * ratio\r\n    const right = map.left + map.screenSize[0] * (1 - ratio)\r\n    const bottom = map.screenSize[1] * (1 - ratio)\r\n    const top = participants.local.thirdPersonView ? map.screenSize[1] * ratio : bottom\r\n    if (target[0] < left) { target[0] = left }\r\n    if (target[0] > right) { target[0] = right }\r\n    if (target[1] < top) { target[1] = top }\r\n    if (target[1] > bottom) { target[1] = bottom }\r\n    let diff = subV2(posOnScreen, target) as [number, number]\r\n    const norm = Math.sqrt(diff[0] * diff[0] + diff[1] * diff[1])\r\n    if (norm > MAP_SPEED_LIMIT) {\r\n      diff = mulV2(MAP_SPEED_LIMIT / norm, diff) as [number, number]\r\n    }else if (norm < MAP_SPEED_MIN){\r\n      diff = mulV2(MAP_SPEED_MIN / norm, diff) as [number, number]\r\n    }\r\n    const SCROOL_SPEED = 0.1\r\n    const mapMove = mulV2(SCROOL_SPEED, map.rotateFromWindow(diff) as [number, number])\r\n    const EPSILON = 0.2\r\n    if (Math.abs(mapMove[0]) + Math.abs(mapMove[1]) > EPSILON) {\r\n      const newMat = map.matrix.translate(-mapMove[0], -mapMove[1])\r\n      const trans = map.rotateFromWindow([newMat.e, newMat.f])\r\n      const HALF = 0.5\r\n      let changed = false\r\n      if (trans[0] < -MAP_SIZE * HALF) { trans[0] = -MAP_SIZE * HALF; changed = true }\r\n      if (trans[0] > MAP_SIZE * HALF) { trans[0] = MAP_SIZE * HALF; changed = true }\r\n      if (trans[1] < -MAP_SIZE * HALF) { trans[1] = -MAP_SIZE * HALF; changed = true }\r\n      if (trans[1] > MAP_SIZE * HALF) { trans[1] = MAP_SIZE * HALF; changed = true }\r\n      const transMap = map.rotateToWindow(trans);\r\n      [newMat.e, newMat.f] = transMap\r\n      map.setMatrix(newMat)\r\n      map.setCommittedMatrix(newMat)\r\n      member.scrollAgain = !changed\r\n\r\n      return !changed\r\n    }\r\n    member.scrollAgain = false\r\n\r\n    return false\r\n  }\r\n  const onTimer = (state:DragState<HTMLDivElement>) => {\r\n    if (state.dragging) {\r\n      onDrag(state)\r\n    }\r\n    const rv = scrollMap(0.2)\r\n    //  console.log(`onTimer: drag:${state.dragging} again:${rv}`)\r\n\r\n    return rv\r\n  }\r\n  const onDrag = (state:DragState<HTMLDivElement>) => {\r\n    //console.log(`participant onDrag s:${state.start} xy:${state.xy} b:${state.buttons} d:${state.dragging}`)\r\n    moveParticipant(state)\r\n  }\r\n  /* const onKeyTimer = (keys:Set<string>) => {\r\n    //   console.log('onKeyTimer()', keys)\r\n    const participantMoved = moveParticipantByKey(keys)\r\n\r\n    if (member.scrollAgain || participantMoved) {\r\n      return scrollMap(0.2)\r\n    }\r\n\r\n    return false\r\n  } */\r\n  const TIMER_INTERVAL = 33\r\n  /* const keycodesUse = new Set(['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight',\r\n    'KeyQ', 'KeyW', 'KeyE', 'KeyA', 'KeyS', 'KeyD'])\r\n  KeyHandlerPlain(onKeyTimer, TIMER_INTERVAL, keycodesUse, keycodesUse, () => (map.keyInputUsers.size === 0)) */\r\n\r\n  //  pointer drag\r\n  const drag = DragHandler<HTMLDivElement>(onDrag, 'dragHandle',\r\n                                               onTimer, TIMER_INTERVAL, () => { setShowConfig(true) })\r\n  useEffect(() => {\r\n    drag.target.current?.focus({preventScroll:true})\r\n  })\r\n\r\n/*  //  always forcus on my avatar.\r\n  useEffect(()=>{\r\n    const dispo = autorun(()=>{\r\n      const mat = map.committedMatrix\r\n      if (!member.scrollAgain && !drag.memo.timerId){\r\n        const scroll = ()=>{\r\n          if (scrollMap(0.01)){\r\n            setTimeout(scroll, TIMER_INTERVAL)\r\n          }\r\n        }\r\n        scroll()\r\n      }\r\n    })\r\n    return dispo\r\n  }, [])\r\n*/\r\n\r\n\r\n/*  rotation changes sound localization and frequent changes are not good to hear.\r\n  //  Rotate participant to look at the pointer\r\n  useEffect(() => {\r\n    const cleanup = reaction(() => mapData.mouse, (mouse) => {\r\n      //  look at mouse\r\n      if (participant.thirdPersonView && !drag.memo?.state?.dragging) {\r\n        const dir = subV2(mapData.mouseOnMap, participant.pose.position)\r\n        const norm = normV(dir)\r\n        if (norm > PARTICIPANT_SIZE / 2) {\r\n          participant.pose.orientation = Math.atan2(dir[0], -dir[1]) * HALF_DEGREE / Math.PI\r\n        }\r\n      }\r\n    })\r\n\r\n    return cleanup\r\n  },\r\n            [])\r\n*/\r\n  const styleProps = useObserver(() => ({\r\n    position: participant.pose.position,\r\n    size: props.size,\r\n    mem: mem,\r\n  }))\r\n  const [color] = participant ? participant.getColor() : ['white', 'black']\r\n  const classes = useStyles(styleProps)\r\n  const {t} = useTranslation()\r\n  const [/* showMore,  */,setShowMore] = React.useState(false)\r\n  const [showConfig, setShowConfig] = React.useState(false)\r\n  const moreControl = moreButtonControl(setShowMore, member)\r\n\r\n  const [showMenu, setShowMenu] = React.useState(false)\r\n  const [showTool, setShowTool] = React.useState(false)\r\n  const rgb = props.participant.getColorRGB()\r\n  isAvatarToolOpen = showTool\r\n\r\n  const [pageIndex, setPageIndex] = useState(0)\r\n\r\n  const [activeOutfit, setActiveOutfit] = useState(-1)\r\n  const [activeSpecs, setActiveSpecs] = useState(-1)\r\n\r\n  const [activeSkin, setActiveSkin] = useState(-1)\r\n  const [activeHair, setActiveHair] = useState(-1)\r\n  const [activeGroup, setActiveGroup] = useState(-1)\r\n\r\n  const [activeFrontHair, setActiveFrontHair] = useState(-1)\r\n  const [activeBackHair, setActiveBackHair] = useState(-1)\r\n\r\n\r\n  // For Saving data\r\n  const refAvatar = useRef<HTMLDivElement>(null)\r\n\r\n  function onClose() {\r\n    setShowConfig(false)\r\n    map.keyInputUsers.delete('LocalParticipantConfig')\r\n  }\r\n  function openConfig() {\r\n    setShowConfig(true)\r\n    map.keyInputUsers.add('LocalParticipantConfig')\r\n  }\r\n\r\n  isConteMenuOpen = showConfig\r\n\r\n\r\n\r\n  function openAvatarTool(ev:MouseOrTouch) {\r\n    //console.log(participant.information.randomAvatar.length)\r\n    if(data.length > 0 && participant.information.randomAvatar.length > 0) {\r\n      getNewUserAvatarData()\r\n    }\r\n    setShowTool(true)\r\n  }\r\n\r\n  function EnableThis(_pageIndex:number) {\r\n    //console.log(_pageIndex, \" pageIndex\")\r\n    selectedImage = ''\r\n    //setActive(-1)\r\n    setPageIndex(_pageIndex)\r\n  }\r\n\r\n  function ActiveThis(_itemIndex:number) {\r\n    let imgArr = images[pageIndex].split(',')\r\n    selectedImage = imgArr[_itemIndex]\r\n\r\n    //console.log(_itemIndex, \" itemsIndex\")\r\n\r\n    if(pageIndex === 0) {\r\n      if(_itemIndex < 7) {\r\n        selectedGroup = imgArr[_itemIndex]\r\n        if(activeGroup !== _itemIndex) {\r\n          setActiveGroup(_itemIndex)\r\n        } /* else {\r\n          selectedGroup = ''\r\n          setActiveGroup(-1)\r\n        } */\r\n      }\r\n      if(_itemIndex >= 7 && _itemIndex < 15) {\r\n        selectedHairColor = imgArr[_itemIndex].split('/')[2].split('.')[0].split('co_')[1]\r\n        //console.log(selectedHairColor, \" Hair\")\r\n\r\n        if(selectedHair !== '' || selectedHairBack !== '') {\r\n          //console.log(selectedHair.split('/')[2].split('_')[2], \" ---- \", selectedHair.split('/')[2].split('_')[3])\r\n\r\n          let swatchNum = selectedHair.split('/')[2].split('_')[2]\r\n          //let colorSwatchNum = selectedHair.split('/')[2].split('_')[3]\r\n          let selectedHairIndex = selectedHairColor.split(\"_\")[1]\r\n          //console.log(swatchNum, \" ---- \", colorSwatchNum, \" >>>> \", selectedHairIndex)\r\n          let filterHairsWithSelectedSwatch = swatchNum + \"_\" + selectedHairIndex\r\n          //console.log(filterHairsWithSelectedSwatch, \" FS\")\r\n          // Update applied hair style based on swatch selected\r\n          let hairImgArray = images[1].split(',')\r\n          for(let i = 0; i<hairImgArray.length; i++) {\r\n            //console.log(hairImgArray[i], \" IMG ARR\")\r\n            if(hairImgArray[i].indexOf(filterHairsWithSelectedSwatch) !== -1) {\r\n              //console.log(hairImgArray[i])\r\n              let hairType = hairImgArray[i].split('/')[2].split('.')[0].split('_')[4]\r\n              if(hairType === 'f') {\r\n                selectedHair = hairImgArray[i]\r\n                if(activeFrontHair !== i) {\r\n                  setActiveFrontHair(i)\r\n                } /* else {\r\n                  selectedHair = ''\r\n                  setActiveFrontHair(-1)\r\n                } */\r\n              } else if(hairType === 'b') {\r\n                selectedHairBack = hairImgArray[i]\r\n                if(activeBackHair !== i) {\r\n                  setActiveBackHair(i)\r\n                } /* else {\r\n                  selectedHairBack = ''\r\n                  setActiveBackHair(-1)\r\n                } */\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n        if(activeHair !== _itemIndex) {\r\n          setActiveHair(_itemIndex)\r\n        } /* else {\r\n          selectedHairColor = ''\r\n          setActiveHair(-1)\r\n        } */\r\n      }\r\n      if(_itemIndex >= 15 && _itemIndex < 22) {\r\n        selectedSkin = imgArr[_itemIndex]\r\n        if(activeSkin !== _itemIndex) {\r\n          setActiveSkin(_itemIndex)\r\n        } /* else {\r\n          selectedSkin = ''\r\n          setActiveSkin(-1)\r\n        } */\r\n      }\r\n    } else if(pageIndex === 1) {\r\n      //console.log(imgArr[_itemIndex].split('/')[2].split('.')[0].split('_')[4], \"  >>> hair\")\r\n      let hairType = imgArr[_itemIndex].split('/')[2].split('.')[0].split('_')[4]\r\n\r\n      /* console.log(images.indexOf(imgArr[_itemIndex].split('/')[2].split('_f.')[0] + \"_f.png\"), \" ---- \", images.indexOf(imgArr[_itemIndex].split('/')[2].split('_f.')[0] + \"_b.png\")) */\r\n\r\n      //console.log(imgArr[_itemIndex].split('/')[2].split('_f.')[0], \" IMG\")\r\n      //console.log(imgArr.indexOf(String(imgArr[_itemIndex].split('_f.png')[0] + '_b.png')), \" Array\")\r\n\r\n      if(hairType === 'f') {\r\n        let findBack = imgArr.indexOf(String(imgArr[_itemIndex].split('_f.png')[0] + '_b.png'))\r\n        selectedHair = imgArr[_itemIndex]\r\n        if(activeFrontHair !== _itemIndex) {\r\n          setActiveFrontHair(_itemIndex)\r\n        } /* else {\r\n          selectedHair = ''\r\n          setActiveFrontHair(-1)\r\n        } */\r\n        if(findBack !== -1) {\r\n          selectedHairBack = imgArr[findBack]\r\n          if(activeBackHair !== findBack) {\r\n            setActiveBackHair(findBack)\r\n          } /* else {\r\n            selectedHairBack = ''\r\n            setActiveBackHair(-1)\r\n          } */\r\n        } else {\r\n          selectedHairBack = ''\r\n          setActiveBackHair(-1)\r\n        }\r\n      } else if(hairType === 'b') {\r\n        let findFront = imgArr.indexOf(String(imgArr[_itemIndex].split('_b.png')[0] + '_f.png'))\r\n        selectedHairBack = imgArr[_itemIndex]\r\n        if(activeBackHair !== _itemIndex) {\r\n          setActiveBackHair(_itemIndex)\r\n        } /* else {\r\n          selectedHairBack = ''\r\n          setActiveBackHair(-1)\r\n        } */\r\n        if(findFront !== -1) {\r\n          selectedHair = imgArr[findFront]\r\n          if(activeFrontHair !== findFront) {\r\n            setActiveFrontHair(findFront)\r\n          } /* else {\r\n            selectedHair = ''\r\n            setActiveFrontHair(-1)\r\n          } */\r\n        } else {\r\n          selectedHair = ''\r\n          setActiveFrontHair(-1)\r\n        }\r\n      }\r\n\r\n      /* if(active !== _itemIndex) {\r\n        setActive(_itemIndex)\r\n      } else {\r\n        if(hairType === 'f') {\r\n          selectedHair = ''\r\n        } else if(hairType === 'b') {\r\n          selectedHairBack = ''\r\n        }\r\n        setActive(-1)\r\n      } */\r\n\r\n    } else if(pageIndex === 2) {\r\n      selectedOutfits = imgArr[_itemIndex]\r\n      if(activeOutfit !== _itemIndex) {\r\n        setActiveOutfit(_itemIndex)\r\n      } /* else {\r\n        selectedOutfits = ''\r\n        setActiveOutfit(-1)\r\n      } */\r\n    } else if(pageIndex === 3) {\r\n      selectedSpecs = imgArr[_itemIndex]\r\n      if(activeSpecs !== _itemIndex) {\r\n        setActiveSpecs(_itemIndex)\r\n      } /* else {\r\n        selectedSpecs = ''\r\n        setActiveSpecs(-1)\r\n      } */\r\n    }\r\n    //setActive(_itemIndex)\r\n  }\r\n\r\n  const [data,setData] = useState('');\r\n  const getData=()=>{\r\n    fetch('folderlist.php?folder=avatar_tool/*/*.png')\r\n      .then((response) => response.text())\r\n      .then((response) => setData(response));\r\n\r\n    /* let dataStr = \"avatar_tool/Colors/es_co_group_0.png,avatar_tool/Colors/es_co_group_1.png,avatar_tool/Colors/es_co_group_2.png,avatar_tool/Colors/es_co_group_3.png,avatar_tool/Colors/es_co_group_4.png,avatar_tool/Colors/es_co_group_5.png,avatar_tool/Colors/es_co_group_6.png,avatar_tool/Colors/es_co_hair_0.png,avatar_tool/Colors/es_co_hair_1.png,avatar_tool/Colors/es_co_hair_2.png,avatar_tool/Colors/es_co_hair_3.png,avatar_tool/Colors/es_co_hair_4.png,avatar_tool/Colors/es_co_hair_5.png,avatar_tool/Colors/es_co_hair_6.png,avatar_tool/Colors/es_co_skin_0.png,avatar_tool/Colors/es_co_skin_1.png,avatar_tool/Colors/es_co_skin_2.png,avatar_tool/Colors/es_co_skin_3.png,avatar_tool/Colors/es_co_skin_4.png,avatar_tool/Colors/es_co_skin_5.png,avatar_tool/Colors/es_co_skin_6.png,avatar_tool/Hair/es_hair_0_0_f.png,avatar_toolavatar_toolavatar_tool/Hair/es_hair_0_1_f.png,avatar_tool/Hair/es_hair_0_2_f.png,avatar_tool/Hair/es_hair_0_3_f.png,avatar_tool/Hair/es_hair_0_4_f.png,avatar_tool/Hair/es_hair_0_5_f.png,avatar_tool/Hair/es_hair_0_6_f.png,avatar_tool/Hair/es_hair_1_0_b.png,avatar_tool/Hair/es_hair_1_0_f.png,avatar_tool/Hair/es_hair_1_1_b.png,avatar_tool/Hair/es_hair_1_1_f.png,avatar_tool/Hair/es_hair_1_2_b.png,avatar_tool/Hair/es_hair_1_2_f.png,avatar_tool/Hair/es_hair_1_3_b.png,avatar_tool/Hair/es_hair_1_4_b.png,avatar_tool/Hair/es_hair_1_4_f.png,avatar_tool/Hair/es_hair_1_5_b.png,avatar_tool/Hair/es_hair_1_5_f.png,avatar_tool/Hair/es_hair_1_6_b.png,avatar_tool/Hair/es_hair_1_6_f.png,avatar_tool/Hair/es_hair_3_0_f.png,avatar_tool/Outfits/es_outfit_0.png,avatar_tool/Outfits/es_outfit_1.png,avatar_tool/Outfits/es_outfit_2.png,avatar_tool/Outfits/es_outfit_3.png,avatar_tool/Outfits/es_outfit_4.png,avatar_tool/Outfits/es_outfit_5.png,avatar_tool/Outfits/es_outfit_6.png,avatar_tool/Specs/es_specs_0.png,avatar_tool/Specs/es_specs_1.png,\"\r\n    setData(dataStr) */\r\n    /* let dataStr = \"avatar_tool/Colors/es_co_group_0.png,avatar_tool/Colors/es_co_group_1.png,avatar_tool/Colors/es_co_group_2.png,avatar_tool/Colors/es_co_group_3.png,avatar_tool/Colors/es_co_group_4.png,avatar_tool/Colors/es_co_group_5.png,avatar_tool/Colors/es_co_group_6.png,avatar_tool/Colors/es_co_group_x.png,avatar_tool/Colors/es_co_hair_0.png,avatar_tool/Colors/es_co_hair_1.png,avatar_tool/Colors/es_co_hair_2.png,avatar_tool/Colors/es_co_hair_3.png,avatar_tool/Colors/es_co_hair_4.png,avatar_tool/Colors/es_co_hair_5.png,avatar_tool/Colors/es_co_hair_6.png,avatar_tool/Colors/es_co_skin_0.png,avatar_tool/Colors/es_co_skin_1.png,avatar_tool/Colors/es_co_skin_2.png,avatar_tool/Colors/es_co_skin_3.png,avatar_tool/Colors/es_co_skin_4.png,avatar_tool/Colors/es_co_skin_5_x.png,avatar_tool/Colors/es_co_skin_6_x.png,avatar_tool/Hair/es_hair_0_0_f.png,avatar_tool/Hair/es_hair_0_1_f.png,avatar_tool/Hair/es_hair_0_2_f.png,avatar_tool/Hair/es_hair_0_3_f.png,avatar_tool/Hair/es_hair_0_4_f.png,avatar_tool/Hair/es_hair_0_5_f.png,avatar_tool/Hair/es_hair_0_6_f.png,avatar_tool/Hair/es_hair_0_b.png,avatar_tool/Hair/es_hair_0_x.png,avatar_tool/Hair/es_hair_1_0_b.png,avatar_tool/Hair/es_hair_1_0_f.png,avatar_tool/Hair/es_hair_1_1_b.png,avatar_tool/Hair/es_hair_1_1_f.png,avatar_tool/Hair/es_hair_1_2_b.png,avatar_tool/Hair/es_hair_1_2_f.png,avatar_tool/Hair/es_hair_1_3_b.png,avatar_tool/Hair/es_hair_1_3_f.png,avatar_tool/Hair/es_hair_1_4_b.png,avatar_tool/Hair/es_hair_1_4_f.png,avatar_tool/Hair/es_hair_1_5_b.png,avatar_tool/Hair/es_hair_1_5_f.png,avatar_tool/Hair/es_hair_1_6_b.png,avatar_tool/Hair/es_hair_1_6_f.png,avatar_tool/Hair/es_hair_2_0_f.png,avatar_tool/Hair/es_hair_2_1_f.png,avatar_tool/Hair/es_hair_2_2_f.png,avatar_tool/Hair/es_hair_2_3_f.png,avatar_tool/Hair/es_hair_2_4_f.png,avatar_tool/Hair/es_hair_2_5_f.png,avatar_tool/Hair/es_hair_2_6_f.png,avatar_tool/Hair/es_hair_3_0_f.png,avatar_tool/Hair/es_hair_3_1_f.png,avatar_tool/Hair/es_hair_3_2_f.png,avatar_tool/Hair/es_hair_3_3_f.png,avatar_tool/Hair/es_hair_3_4_f.png,avatar_tool/Hair/es_hair_3_5_f.png,avatar_tool/Hair/es_hair_3_6_f.png,avatar_tool/Hair/es_hair_4_0_f.png,avatar_tool/Hair/es_hair_4_1_f.png,avatar_tool/Hair/es_hair_4_2_f.png,avatar_tool/Hair/es_hair_4_3_f.png,avatar_tool/Hair/es_hair_4_4_f.png,avatar_tool/Hair/es_hair_4_5_f.png,avatar_tool/Hair/es_hair_4_6_f.png,avatar_tool/Outfits/es_outfit_0.png,avatar_tool/Outfits/es_outfit_1.png,avatar_tool/Outfits/es_outfit_2.png,avatar_tool/Outfits/es_outfit_3.png,avatar_tool/Outfits/es_outfit_4.png,avatar_tool/Outfits/es_outfit_5.png,avatar_tool/Outfits/es_outfit_6.png,avatar_tool/Specs/es_specs_0.png,avatar_tool/Specs/es_specs_1.png,\" */\r\n    /* let dataStr = \"avatar_tool/Colors/es_co_group_0.png,avatar_tool/Colors/es_co_group_1.png,avatar_tool/Colors/es_co_group_2.png,avatar_tool/Colors/es_co_group_3.png,avatar_tool/Colors/es_co_group_4.png,avatar_tool/Colors/es_co_group_5.png,avatar_tool/Colors/es_co_group_6.png,avatar_tool/Colors/es_co_group_x.png,avatar_tool/Colors/es_co_hair_0.png,avatar_tool/Colors/es_co_hair_1.png,avatar_tool/Colors/es_co_hair_2.png,avatar_tool/Colors/es_co_hair_3.png,avatar_tool/Colors/es_co_hair_4.png,avatar_tool/Colors/es_co_hair_5.png,avatar_tool/Colors/es_co_hair_6.png,avatar_tool/Colors/es_co_skin_0.png,avatar_tool/Colors/es_co_skin_1.png,avatar_tool/Colors/es_co_skin_2.png,avatar_tool/Colors/es_co_skin_3.png,avatar_tool/Colors/es_co_skin_4.png,avatar_tool/Colors/es_co_skin_5_x.png,avatar_tool/Colors/es_co_skin_6_x.png,avatar_tool/Hair/avatars_hair_5_0_f.png,avatar_tool/Hair/avatars_hair_5_1_f.png,avatar_tool/Hair/avatars_hair_5_2_f.png,avatar_tool/Hair/avatars_hair_5_3_f.png,avatar_tool/Hair/avatars_hair_5_4_f.png,avatar_tool/Hair/avatars_hair_5_5_f.png,avatar_tool/Hair/avatars_hair_5_6_f.png,avatar_tool/Hair/es_hair_0_0_f.png,avatar_tool/Hair/es_hair_0_1_f.png,avatar_tool/Hair/es_hair_0_2_f.png,avatar_tool/Hair/es_hair_0_3_f.png,avatar_tool/Hair/es_hair_0_4_f.png,avatar_tool/Hair/es_hair_0_5_f.png,avatar_tool/Hair/es_hair_0_6_f.png,avatar_tool/Hair/es_hair_0_x_b.png,avatar_tool/Hair/es_hair_0_x_f.png,avatar_tool/Hair/es_hair_1_0_b.png,avatar_tool/Hair/es_hair_1_0_f.png,avatar_tool/Hair/es_hair_1_1_b.png,avatar_tool/Hair/es_hair_1_1_f.png,avatar_tool/Hair/es_hair_1_2_b.png,avatar_tool/Hair/es_hair_1_2_f.png,avatar_tool/Hair/es_hair_1_3_b.png,avatar_tool/Hair/es_hair_1_3_f.png,avatar_tool/Hair/es_hair_1_4_b.png,avatar_tool/Hair/es_hair_1_4_f.png,avatar_tool/Hair/es_hair_1_5_b.png,avatar_tool/Hair/es_hair_1_5_f.png,avatar_tool/Hair/es_hair_1_6_b.png,avatar_tool/Hair/es_hair_1_6_f.png,avatar_tool/Hair/es_hair_2_0_f.png,avatar_tool/Hair/es_hair_2_1_f.png,avatar_tool/Hair/es_hair_2_2_f.png,avatar_tool/Hair/es_hair_2_3_f.png,avatar_tool/Hair/es_hair_2_4_f.png,avatar_tool/Hair/es_hair_2_5_f.png,avatar_tool/Hair/es_hair_2_6_f.png,avatar_tool/Hair/es_hair_3_0_f.png,avatar_tool/Hair/es_hair_3_1_f.png,avatar_tool/Hair/es_hair_3_2_f.png,avatar_tool/Hair/es_hair_3_3_f.png,avatar_tool/Hair/es_hair_3_4_f.png,avatar_tool/Hair/es_hair_3_5_f.png,avatar_tool/Hair/es_hair_3_6_f.png,avatar_tool/Hair/es_hair_4_0_f.png,avatar_tool/Hair/es_hair_4_1_f.png,avatar_tool/Hair/es_hair_4_2_f.png,avatar_tool/Hair/es_hair_4_3_f.png,avatar_tool/Hair/es_hair_4_4_f.png,avatar_tool/Hair/es_hair_4_5_f.png,avatar_tool/Hair/es_hair_4_6_f.png,avatar_tool/Outfits/es_outfit_0.png,avatar_tool/Outfits/es_outfit_1.png,avatar_tool/Outfits/es_outfit_2.png,avatar_tool/Outfits/es_outfit_3.png,avatar_tool/Outfits/es_outfit_4.png,avatar_tool/Outfits/es_outfit_5.png,avatar_tool/Outfits/es_outfit_6.png,avatar_tool/Specs/es_specs_0.png,avatar_tool/Specs/es_specs_1.png,avatar_tool/Specs/es_specs_2.png,\"\r\n    setData(dataStr) */\r\n  }\r\n\r\n  useEffect(()=>{\r\n    getData()\r\n  },[])\r\n\r\n  function ElementShift(arr:any, old_index:number, new_index:number) {\r\n    if (new_index >= arr.length) {\r\n        var k = new_index - arr.length + 1;\r\n        while (k--) {\r\n            arr.push(undefined);\r\n        }\r\n    }\r\n    arr.splice(new_index, 0, arr.splice(0, 1)[0]);\r\n    return arr;\r\n  };\r\n\r\n\r\n  const folders : Array<string> = []\r\n  const images : Array<string> = []\r\n  let tempArr : string = ''\r\n  let dataFolderWise = data.split(',')\r\n\r\n  for (let i=0; i<dataFolderWise.length-1; i++) {\r\n    //if(folders.indexOf(dataFolderWise[i].split('./')[1].split('/')[1]) === -1 && dataFolderWise[i].split('./')[1].split('/')[1] !== undefined) {\r\n      if(folders.indexOf(dataFolderWise[i].split('/')[1]) === -1 && dataFolderWise[i].split('/')[1] !== undefined) {\r\n      folders.push(dataFolderWise[i].split('/')[1])\r\n    }\r\n\r\n  }\r\n  for (var j=0; j < folders.length; j++) {\r\n    for (let i=0; i<dataFolderWise.length-1; i++) {\r\n    if(folders[j] === dataFolderWise[i].split('/')[1]) {\r\n      tempArr += (dataFolderWise[i]) + ','\r\n      //tempArr.push(dataFolderWise[i].split('./')[1])\r\n    }\r\n  }\r\n  // console.log(tempArr, \" AAAAA\")\r\n  images.push(tempArr)\r\n  tempArr = ''\r\n  }\r\n\r\n  const randomAvatarDetails = useObserver(() => props.participant.information.randomAvatar)\r\n\r\n  function getNewUserAvatarData() {\r\n    //console.log(data, \" details >>> data\")\r\n    // Showing selected item from list\r\n      let imgArr = images[0].split(',')\r\n      let randSkinIndex = imgArr.indexOf(randomAvatarDetails[0])\r\n      let randHairColorIndex = imgArr.indexOf('avatar_tool/Colors/es_co_' + randomAvatarDetails[1] + '.png')\r\n      let randGroupIndex = imgArr.indexOf(randomAvatarDetails[2])\r\n      let imgArrHairs = images[1].split(',')\r\n      let imgArrOutFit = images[2].split(',')\r\n      let randomOutfitIndex = imgArrOutFit.indexOf(randomAvatarDetails[4])\r\n      let imgArrSpecs = images[3].split(',')\r\n      let randomSpecsIndex = imgArrSpecs.indexOf(randomAvatarDetails[5])\r\n      selectedSkin = imgArr[randSkinIndex]\r\n      if(activeSkin !== randSkinIndex) {\r\n        setActiveSkin(randSkinIndex)\r\n      }\r\n      selectedHairColor = imgArr[randHairColorIndex].split('/')[2].split('.')[0].split('co_')[1]\r\n      if(activeHair !== randHairColorIndex) {\r\n        setActiveHair(randHairColorIndex)\r\n      }\r\n      selectedGroup = imgArr[randGroupIndex]\r\n      if(activeGroup !== randGroupIndex) {\r\n        setActiveGroup(randGroupIndex)\r\n      }\r\n      ///////////////////////////////////////////////////////////\r\n      let frontHairs : Array<string> = []\r\n      let frontHairIndex : Array<number> = []\r\n      let backHairs : Array<string> = []\r\n      let backHairIndex : Array<number> = []\r\n      frontHairs.splice(0)\r\n      frontHairIndex.splice(0)\r\n      backHairs.splice(0)\r\n      backHairIndex.splice(0)\r\n      for (let i:number = 0; i < imgArrHairs.length - 1; i++) {\r\n          if(imgArrHairs.indexOf(selectedHairColor.split('_')[1] + '_' + imgArrHairs[i].split(\"_\")[4]) === -1) {\r\n          if((selectedHairColor.split(\"_\")[1] === imgArrHairs[i].split(\"_\")[4]) || imgArrHairs[i].split(\"_\")[4] === \"x\" ) {\r\n            let hairType = imgArrHairs[i].split('/')[2].split('.')[0].split('_')[4]\r\n            if(hairType === 'f') {\r\n              frontHairs.push(imgArrHairs[i])\r\n              frontHairIndex.push(i)\r\n            } else if(hairType === 'b') {\r\n              backHairs.push(imgArrHairs[i])\r\n              backHairIndex.push(i)\r\n            }\r\n          }\r\n        }\r\n      }\r\n      if(frontHairs.length > 0) {\r\n        let randomHairIndex = frontHairs.indexOf(randomAvatarDetails[3])\r\n        selectedHair = frontHairs[randomHairIndex]\r\n        setActiveFrontHair(frontHairIndex[randomHairIndex])\r\n        let findBack = imgArrHairs.indexOf(String(frontHairs[randomHairIndex].split('_f.png')[0] + '_b.png'))\r\n        if(findBack !== -1) {\r\n          selectedHairBack = imgArrHairs[findBack]\r\n          if(activeBackHair !== findBack) {\r\n            setActiveBackHair(findBack)\r\n          } else {\r\n            selectedHairBack = ''\r\n            setActiveBackHair(-1)\r\n          }\r\n        } else {\r\n          selectedHairBack = ''\r\n          setActiveBackHair(-1)\r\n        }\r\n      } else {\r\n        selectedHair = ''\r\n        setActiveFrontHair(-1)\r\n\r\n        selectedHairBack = ''\r\n        setActiveBackHair(-1)\r\n      }\r\n      ///////////////////////////////////////////////////////////\r\n\r\n      selectedOutfits = imgArrOutFit[randomOutfitIndex]\r\n      if(activeOutfit !== randomOutfitIndex) {\r\n        setActiveOutfit(randomOutfitIndex)\r\n      }\r\n\r\n      selectedSpecs = imgArrSpecs[randomSpecsIndex]\r\n      if(activeSpecs !== randomSpecsIndex) {\r\n        setActiveSpecs(randomSpecsIndex)\r\n      }\r\n  }\r\n\r\n  const _ITEMS = []\r\n  if(images.length > 0 && pageIndex >= 0) {\r\n    let imgArr = images[pageIndex].split(',')\r\n    for (let i:number = 0; i < imgArr.length - 1; i++) {\r\n      if(pageIndex === 1) {\r\n        //console.log(selectedHairColor.split(\"_\")[1], \" --- \", imgArr[i].split(\"_\")[4], \" ---- \", imgArr[i])\r\n        //if(imgArr[i].indexOf(selectedHairColor) !== -1 && (selectedHairColor.split(\"_\")[1] === imgArr[i].split(\"_\")[4])) {\r\n\r\n        //console.log(selectedOutfits, \" selectedoutfit\")\r\n        //console.log(imgArr[i].split(\"_\")[4], \" hait cat\")\r\n\r\n        if((selectedHairColor.split(\"_\")[1] === imgArr[i].split(\"_\")[4]) || imgArr[i].split(\"_\")[4] === \"x\") {\r\n          let hairType = imgArr[i].split('/')[2].split('.')[0].split('_')[4]\r\n          if(hairType === 'f') {\r\n\r\n            let findBack = imgArr.indexOf(String(imgArr[i].split('_f.png')[0] + '_b.png'))\r\n\r\n            _ITEMS.push(<div onClick = {() => {ActiveThis(i)}}><img src={encodeURIComponent(imgArr[i])} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', borderRadius:'50%', padding:'0px', border:activeFrontHair === i ? '5px solid #ef4623' : '5px dotted #00000000'/* , borderLeft: activeFrontHair === i ? '0px dotted #00000000' : '3px dotted #00000000' */, position:'relative', top:'3px'}} draggable={false} alt='' />\r\n\r\n            {/* <div style={{position:'relative', top:'-68px', left:'3px', zIndex:-1, display:findBack !== -1 ?'block' : 'none'}}><img src={findBack !== -1 ? String(imgArr[i].split('_f.png')[0] + '_b.png') : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n            <div style={{position:'relative', top:findBack !== -1 ? '-136px' : '-68px', left:'3px', zIndex:-1, display:selectedSkin !== '' ?'block' : 'none'}}><img src={selectedSkin !== '' ? String(selectedSkin) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n            <div style={{position:'relative', top:findBack !== -1 ? '-204px' : '-136px', left:'3px', zIndex:0, display:selectedOutfits !== '' ?'block' : 'none'}}><img src={selectedOutfits !== '' ? String(selectedOutfits) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px', position:'relative', top:'-2px'}} alt='' /></div>\r\n\r\n            <div style={{position:'relative', top:findBack !== -1 ? '-272px' : '-204px', left:'3px', zIndex:1, display:selectedSpecs !== '' ?'block' : 'none'}}><img src={selectedSpecs !== '' ? String(selectedSpecs) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div> */}\r\n\r\n            <div style={{position:'absolute', top:'6px', marginLeft:'3px', zIndex:-1, display:findBack !== -1 ?'block' : 'none'}}><img src={findBack !== -1 ? String(imgArr[i].split('_f.png')[0] + '_b.png') : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n            <div style={{position:'absolute', top:'6px', marginLeft:'3px', zIndex:-1, display:selectedSkin !== '' ?'block' : 'none'}}><img src={selectedSkin !== '' ? String(selectedSkin) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n            <div style={{position:'absolute', top:'6px', marginLeft:'3px', zIndex:0, display:selectedOutfits !== '' ?'block' : 'none'}}><img src={selectedOutfits !== '' ? String(selectedOutfits) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px', position:'relative', top:'-2px'}} alt='' /></div>\r\n\r\n            <div style={{position:'absolute', top:'6px', marginLeft:'3px', zIndex:1, display:selectedSpecs !== '' ?'block' : 'none'}}><img src={selectedSpecs !== '' ? String(selectedSpecs) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n\r\n            {/* <div style={{position:'relative', top:(findBack !== -1 && selectedOutfits === \"\" && selectedSpecs === \"\") ? '-204px' : (findBack !== -1 && selectedOutfits !== \"\" && selectedSpecs === \"\") ? '-204px' : (findBack !== -1 && selectedOutfits !== \"\" && selectedSpecs !== \"\") ? '-274px' : (findBack === -1 && selectedOutfits !== \"\") ? '-204px' : (findBack !== -1 && selectedOutfits !== \"\") ? '-272px' : '-136px', left:'3px', zIndex:-4, display:selectedGroup !== '' ?'block' : 'none'}}><img src={selectedGroup !== '' ? String(selectedGroup) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div> */}\r\n\r\n            <div style={{position:'absolute', top:'6px', marginLeft:'3px', zIndex:-4, display:selectedGroup !== '' ?'block' : 'none'}}><img src={selectedGroup !== '' ? String(selectedGroup) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n            </div>)\r\n          }\r\n          //console.log(_ITEMS)\r\n          //else if(hairType === 'bb') {\r\n          //  _ITEMS.push(<div onClick = {() => {ActiveThis(i)}}><img src={encodeURIComponent(imgArr[i])} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px', border:activeBackHair === i ? '3px solid #ef4623' : '3px dotted #00000000'/* , borderRight: activeBackHair === i ? '0px dotted #00000000' : '3px dotted #00000000' */ /* '3px dotted #00000020' */}} draggable={false} alt='' />{/* <div style={{textAlign:'center', position:'relative', fontWeight:'bold', marginTop:'-5px'}}>{imgArr[i].split('/')[2].split('.')[0]}</div> */}<div style={{position:'relative', width:'20px', height:'64px', backgroundColor:'white', top:'-71px', left:'63px', display: activeBackHair === i ? 'block' : 'none'}}></div></div>)\r\n          //}\r\n\r\n          // Sort the hair list to make bald option at the end of the hair list\r\n          ElementShift(_ITEMS, 0, _ITEMS.length)\r\n        }\r\n      } else if(pageIndex === 2) {\r\n        _ITEMS.push(<div onClick = {() => {ActiveThis(i)}}><img src={encodeURIComponent(imgArr[i])} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'0px', border:activeOutfit === i ? '5px solid #ef462300' : '5px dotted #00000000', borderRadius:'50%' /* '3px dotted #00000020' */, position:'relative', top:'1px'}} draggable={false} alt='' />{/* <div style={{textAlign:'center', position:'relative', fontWeight:'bold', marginTop:'-5px'}}>{imgArr[i].split('/')[2].split('.')[0]}</div> */}\r\n\r\n\r\n\r\n        {/* <div style={{position:'relative', top:'-68px', left:'3px', zIndex:1, display:selectedHair !== '' ?'block' : 'none'}}><img src={selectedHair !== '' ? String(selectedHair) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n        <div style={{position:'relative', top:'-136px', left:'3px', zIndex:-1, display:selectedHairBack !== '' ?'block' : 'none'}}><img src={selectedHairBack !== '' ? String(selectedHairBack) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n        <div style={{position:'relative', top:selectedHairBack ? '-204px' : '-136px', left:'3px', zIndex:-1, display:selectedSkin !== '' ?'block' : 'none'}}><img src={selectedSkin !== '' ? String(selectedSkin) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n        <div style={{position:'relative', top:selectedHairBack ? '-272px' : '-204px', left:'3px', zIndex:1, display:selectedSpecs !== '' ?'block' : 'none'}}><img src={selectedSpecs !== '' ? String(selectedSpecs) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n        <div style={{position:'relative', top:selectedHairBack !== \"\" ? '-272px' : '-204px', left:'3px', zIndex:-2, display:selectedGroup !== '' ?'block' : 'none'}}><img src={selectedGroup !== '' ? String(selectedGroup) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div> */}\r\n\r\n        <div style={{position:'absolute', top:'6px', marginLeft:'3px', zIndex:1, display:selectedHair !== '' ?'block' : 'none'}}><img src={selectedHair !== '' ? String(selectedHair) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n        <div style={{position:'absolute', top:'6px', marginLeft:'3px', zIndex:-1, display:selectedHairBack !== '' ?'block' : 'none'}}><img src={selectedHairBack !== '' ? String(selectedHairBack) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n        <div style={{position:'absolute', top:'6px', marginLeft:'3px', zIndex:-1, display:selectedSkin !== '' ?'block' : 'none'}}><img src={selectedSkin !== '' ? String(selectedSkin) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'0px', border:activeOutfit === i ? '5px solid #ef4623' : '5px dotted #00000000', borderRadius:'50%', position:'relative', top:'-3px', left:'-3px'}} alt='' /></div>\r\n\r\n        <div style={{position:'absolute', top:'6px', marginLeft:'3px', zIndex:1, display:selectedSpecs !== '' ?'block' : 'none'}}><img src={selectedSpecs !== '' ? String(selectedSpecs) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n        <div style={{position:'absolute', top:'6px', marginLeft:'3px', zIndex:-2, display:selectedGroup !== '' ?'block' : 'none'}}><img src={selectedGroup !== '' ? String(selectedGroup) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n        </div>)\r\n      } else if(pageIndex === 3) {\r\n        _ITEMS.push(<div onClick = {() => {ActiveThis(i)}}><img src={encodeURIComponent(imgArr[i])} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'0px', border:activeSpecs === i ? '5px solid #ef4623' : '5px dotted #00000000', borderRadius:'50%'/* '3px dotted #00000020' */, position:'relative', top:'3px'}} draggable={false} alt='' />{/* <div style={{textAlign:'center', position:'relative', fontWeight:'bold', marginTop:'-5px'}}>{imgArr[i].split('/')[2].split('.')[0]}</div> */}\r\n\r\n        {/* <div style={{position:'relative', top:'-68px', left:'3px', zIndex:1, display:selectedHair !== '' ?'block' : 'none'}}><img src={selectedHair !== '' ? String(selectedHair) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n        <div style={{position:'relative', top:'-136px', left:'3px', zIndex:-1, display:selectedHairBack !== '' ?'block' : 'none'}}><img src={selectedHairBack !== '' ? String(selectedHairBack) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n        <div style={{position:'relative', top:selectedHairBack ? '-204px' : '-136px', left:'3px', zIndex:-1, display:selectedSkin !== '' ?'block' : 'none'}}><img src={selectedSkin !== '' ? String(selectedSkin) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n        <div style={{position:'relative', top:selectedHairBack ? '-272px' : '-204px', left:'3px', zIndex:1, display:selectedOutfits !== '' ?'block' : 'none'}}><img src={selectedOutfits !== '' ? String(selectedOutfits) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n        <div style={{position:'relative', top:selectedHairBack !== \"\" ? '-340px' : '-272px', left:'3px', zIndex:-2, display:selectedGroup !== '' ?'block' : 'none'}}><img src={selectedGroup !== '' ? String(selectedGroup) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div> */}\r\n\r\n        <div style={{position:'absolute', top:'6px', marginLeft:'3px', zIndex:1, display:selectedHair !== '' ?'block' : 'none'}}><img src={selectedHair !== '' ? String(selectedHair) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n        <div style={{position:'absolute', top:'6px', marginLeft:'3px', zIndex:-1, display:selectedHairBack !== '' ?'block' : 'none'}}><img src={selectedHairBack !== '' ? String(selectedHairBack) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n        <div style={{position:'absolute', top:'6px', marginLeft:'3px', zIndex:-1, display:selectedSkin !== '' ?'block' : 'none'}}><img src={selectedSkin !== '' ? String(selectedSkin) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n        <div style={{position:'absolute', top:'6px', marginLeft:'3px', zIndex:1, display:selectedOutfits !== '' ?'block' : 'none'}}><img src={selectedOutfits !== '' ? String(selectedOutfits) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px', position:'relative', top:'-2px'}} alt='' /></div>\r\n\r\n        <div style={{position:'absolute', top:'6px', marginLeft:'3px', zIndex:-2, display:selectedGroup !== '' ?'block' : 'none'}}><img src={selectedGroup !== '' ? String(selectedGroup) : ''} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'2px'}} alt='' /></div>\r\n\r\n        </div>)\r\n      }\r\n    }\r\n  }\r\n\r\n  const _ITEMS_SKIN = []\r\n  const _ITEMS_GROUP = []\r\n  const _ITEMS_HAIR = []\r\n  if(images.length > 0 && pageIndex >= 0) {\r\n    let imgArr = images[pageIndex].split(',')\r\n    for (let i:number = 0; i < imgArr.length - 1; i++) {\r\n      //console.log(imgArr[i].indexOf('skin'), \" ------ \", imgArr[i])\r\n      if(imgArr[i].indexOf('skin') !== -1) {\r\n        //if(imgArr[i].indexOf(\"_x\") === -1) {\r\n          _ITEMS_SKIN.push(<div onClick = {() => {ActiveThis(i)}}><img src={encodeURIComponent(imgArr[i])} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'0px', border:activeSkin === i ? '5px solid #ef4623' : '5px dotted #00000000', borderRadius:'50%' /* '3px dotted #00000020' */}} draggable={false} alt='' />{/* <div style={{textAlign:'center', position:'relative', fontWeight:'bold', marginTop:'-5px'}}>{imgArr[i].split('/')[2].split('.')[0]}</div> */}</div>)\r\n        //}\r\n      }\r\n      if(imgArr[i].indexOf('group') !== -1) {\r\n        if(imgArr[i].indexOf('_x') === -1) {\r\n          _ITEMS_GROUP.push(<div onClick = {() => {ActiveThis(i)}}><img src={encodeURIComponent(imgArr[i])} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'0px', border:activeGroup === i ? '5px solid #ef4623' : '5px dotted #00000000', borderRadius:'50%'  /* '3px dotted #00000020' */}} draggable={false} alt='' />{/* <div style={{textAlign:'center', position:'relative', fontWeight:'bold', marginTop:'-5px'}}>{imgArr[i].split('/')[2].split('.')[0]}</div> */}</div>)\r\n        }\r\n      }\r\n      if(imgArr[i].indexOf('hair') !== -1) {\r\n        _ITEMS_HAIR.push(<div onClick = {() => {ActiveThis(i)}}><img src={encodeURIComponent(imgArr[i])} style={{width:'60px', minHeight:'60px', height:'60px', objectFit:'contain', padding:'0px', border:activeHair === i ? '5px solid #ef4623' : '5px dotted #00000000', borderRadius:'50%' /* '3px dotted #00000020' */}} draggable={false} alt='' />{/* <div style={{textAlign:'center', position:'relative', fontWeight:'bold', marginTop:'-5px'}}>{imgArr[i].split('/')[2].split('.')[0]}</div> */}</div>)\r\n      }\r\n    }\r\n  }\r\n\r\n  const ref = useRef<HTMLButtonElement>(null)\r\n\r\n  function stop(ev:MouseOrTouch|React.PointerEvent) {\r\n    ev.stopPropagation()\r\n    ev.preventDefault()\r\n  }\r\n\r\n  function onCloseDialog() {\r\n    selectedGroup = ''\r\n    selectedSkin = ''\r\n    selectedHairColor = ''\r\n    selectedHair = ''\r\n    selectedHairBack = ''\r\n    selectedOutfits = ''\r\n    selectedSpecs = ''\r\n\r\n    setShowTool(false)\r\n    setActiveGroup(-1)\r\n    setActiveHair(-1)\r\n    setActiveSkin(-1)\r\n    setPageIndex(0)\r\n    //setActive(-1)\r\n    setActiveBackHair(-1)\r\n    setActiveFrontHair(-1)\r\n    setActiveOutfit(-1)\r\n    setActiveSpecs(-1)\r\n  }\r\n\r\n  function onApplyChanges() {\r\n    /* html2canvas(window.document.getElementById('userAvatar')).then(canvas => {\r\n        document.body.appendChild(canvas)\r\n    }); */\r\n\r\n    //console.log(userContent, \" userContent\")\r\n\r\n    if (refAvatar.current === null) {\r\n      return\r\n    }\r\n\r\n    /* toPng(refAvatar.current, { cacheBust: true, })\r\n      .then((dataUrl) => {\r\n        ////////////////////////////////////////////////////\r\n        var formData = new FormData();\r\n        formData.append('imgData', dataUrl);\r\n        fetch('saveAvatarImage.php',\r\n          {\r\n            method: 'POST',\r\n            body: formData\r\n          }\r\n        )\r\n          .then((response) => response.text())\r\n          .then((response) => updateUserAvatar(response));\r\n        ////////////////////////////////////////////////////\r\n      })\r\n      .catch((err) => {\r\n        console.log(err)\r\n      }) */\r\n\r\n      html2canvas(refAvatar.current, { allowTaint: true }).then(function(canvas:any) {\r\n        var formData = new FormData();\r\n        formData.append('imgData', canvas.toDataURL());\r\n        fetch('saveAvatarImage.php',\r\n          {\r\n            method: 'POST',\r\n            body: formData\r\n          }\r\n        )\r\n          .then((response) => response.text())\r\n          .then((response) => updateUserAvatar(response));\r\n        ////////////////////////////////////////////////////\r\n      })\r\n      .catch((err) => {\r\n        console.log(err)\r\n      })\r\n\r\n    //html2canvas(document.body, { allowTaint: true }).then(function(canvas) {\r\n      //html2canvas(userContent, { allowTaint: true }).then(function(canvas) {\r\n      //let dataImg = canvas.toDataURL('image/png');\r\n      //console.log(dataImg, \" >>base64\")\r\n      /* $.ajax({\r\n       type: \"POST\",\r\n       url: 'http://localhost/earshot/saveImage.php',\r\n       dataType: 'text',\r\n       cache: false,\r\n       data: {vals : dataImg},\r\n       success: function(result) {\r\n         if (result) {\r\n             alert(result)\r\n         }\r\n       },\r\n       error: function(error) {\r\n           alert(error);\r\n       }\r\n      }); */\r\n    //})\r\n  }\r\n\r\n  function generateRandomNumber(min:number, max:number) {\r\n    return Math.floor(Math.random() * (max - min + 1) + min)\r\n  }\r\n\r\n\r\n  function onGenerateRandomAvatar() {\r\n    // For Group, Skin and Hair Color setting\r\n    //let randGroupIndex = generateRandomNumber(0,6)\r\n\r\n    let randSkinIndex = generateRandomNumber(15, 20)\r\n    let randHairColorIndex = generateRandomNumber(8, 14)\r\n    let imgArr = images[0].split(',')\r\n\r\n    //console.log(randHairColorIndex)\r\n\r\n    //if(pageIndex === 0) {\r\n\r\n/////////////////////////////////\r\n      /* if(randGroupIndex < 7) {\r\n        selectedGroup = imgArr[randGroupIndex]\r\n        if(activeGroup !== randGroupIndex) {\r\n          setActiveGroup(randGroupIndex)\r\n        }\r\n      } */\r\n/////////////////////////////////////\r\n\r\n    //}\r\n    if(randHairColorIndex >= 7 && randHairColorIndex < 15) {\r\n      selectedHairColor = imgArr[randHairColorIndex].split('/')[2].split('.')[0].split('co_')[1]\r\n      if(activeHair !== randHairColorIndex) {\r\n        setActiveHair(randHairColorIndex)\r\n      }\r\n    }\r\n    if(randSkinIndex >= 15 && randSkinIndex < 20) {\r\n      selectedSkin = imgArr[randSkinIndex]\r\n      if(activeSkin !== randSkinIndex) {\r\n        setActiveSkin(randSkinIndex)\r\n      }\r\n    }\r\n  //}\r\n\r\n    // Setting Hairs [ Front , Back ]\r\n    let imgHairArr = images[1].split(',')\r\n    let frontHairs : Array<string> = []\r\n    let frontHairIndex : Array<number> = []\r\n    let backHairs : Array<string> = []\r\n    let backHairIndex : Array<number> = []\r\n    frontHairs.splice(0)\r\n    frontHairIndex.splice(0)\r\n    backHairs.splice(0)\r\n    backHairIndex.splice(0)\r\n    for (let i:number = 0; i < imgHairArr.length - 1; i++) {\r\n      //console.log(selectedHairColor.split('_')[1], \" ---- \", imgHairArr[i].split(\"_\")[4])\r\n      //if(imgHairArr[i].indexOf(selectedHairColor) !== -1) {\r\n\r\n        //console.log(selectedHairColor.split('_')[1], \" --- \", selectedHairColor)\r\n\r\n        if(imgHairArr.indexOf(selectedHairColor.split('_')[1] + '_' + imgHairArr[i].split(\"_\")[4]) === -1) {\r\n        if((selectedHairColor.split(\"_\")[1] === imgHairArr[i].split(\"_\")[4])) {\r\n          let hairType = imgHairArr[i].split('/')[2].split('.')[0].split('_')[4]\r\n          if(hairType === 'f') {\r\n            frontHairs.push(imgHairArr[i])\r\n            frontHairIndex.push(i)\r\n          } else if(hairType === 'b') {\r\n            backHairs.push(imgHairArr[i])\r\n            backHairIndex.push(i)\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if(frontHairs.length > 0) {\r\n      let randFrontHairIndex = generateRandomNumber(0, frontHairs.length-1)\r\n      selectedHair = frontHairs[randFrontHairIndex]\r\n      //console.log(frontHairs[randFrontHairIndex])\r\n      setActiveFrontHair(frontHairIndex[randFrontHairIndex])\r\n      //console.log(frontHairs[randFrontHairIndex].split('/')[2].split('.')[0], \" random front\")\r\n      let findBack = imgHairArr.indexOf(String(frontHairs[randFrontHairIndex].split('_f.png')[0] + '_b.png'))\r\n      //console.log(String(frontHairs[randFrontHairIndex].split('_f.png')[0] + '_b.png'), \" BackRandom \", findBack)\r\n      //console.log(findBack, \" findBack\")\r\n      if(findBack !== -1) {\r\n        selectedHairBack = imgHairArr[findBack]\r\n        if(activeBackHair !== findBack) {\r\n          setActiveBackHair(findBack)\r\n        } else {\r\n          selectedHairBack = ''\r\n          setActiveBackHair(-1)\r\n        }\r\n      } else {\r\n        selectedHairBack = ''\r\n        setActiveBackHair(-1)\r\n      }\r\n\r\n    } else {\r\n      selectedHair = ''\r\n      setActiveFrontHair(-1)\r\n\r\n      selectedHairBack = ''\r\n      setActiveBackHair(-1)\r\n    }\r\n    /* if(backHairs.length > 0) {\r\n      let randBackHairIndex = generateRandomNumber(0, backHairs.length-1)\r\n      selectedHairBack = backHairs[randBackHairIndex]\r\n      setActiveBackHair(backHairIndex[randBackHairIndex])\r\n    } else {\r\n      selectedHairBack = ''\r\n      setActiveBackHair(-1)\r\n    } */\r\n\r\n    // Setting OutFits\r\n    let imgOutfitArr = images[2].split(',')\r\n    let randOutfitIndex = generateRandomNumber(0, imgOutfitArr.length-2)\r\n    selectedOutfits = imgOutfitArr[randOutfitIndex]\r\n    setActiveOutfit(randOutfitIndex)\r\n\r\n    // Setting Specs\r\n    let imgSpecsArr = images[3].split(',')\r\n    let randSpecsIndex = generateRandomNumber(0, imgSpecsArr.length-2)\r\n    selectedSpecs = imgSpecsArr[randSpecsIndex]\r\n    setActiveSpecs(randSpecsIndex)\r\n  }\r\n\r\n  ////////////////////////////////////////////////////////////////////////\r\n  const MOUSE_LEFT = 1\r\n  //const MOUSE_RIGHT = 2\r\n  const bind = useGesture(\r\n    {\r\n      onDragStart: ({buttons, xy}) => {\r\n\r\n        document.body.focus()\r\n        mem.dragging = true\r\n        mem.mouseDown = true\r\n\r\n        onLocalUser = true\r\n\r\n        mem.downTime = new Date().getSeconds()\r\n        mem.moveX = map.mouseOnMap[0]\r\n        mem.moveY = map.mouseOnMap[1]\r\n\r\n        /* let itemLocked = getContentLocked()\r\n        let _onContent = isOnContentStatus()\r\n\r\n        let _onRemoteUser = getOnRemote()\r\n        let _dialogStatus:boolean = isDialogOpen()\r\n        let _contentDialogStatus:boolean = getContentDialogStatus()\r\n\r\n        let _avatarToolStatus = getAvatarToolStatus()\r\n\r\n        if(_contentDialogStatus) {return}\r\n        if(_dialogStatus) {return}\r\n\r\n        //console.log(_onRemoteUser, \" onRemoteUser\")\r\n\r\n        //if(showUploadOption) {return}\r\n        if(_onContent) {return}\r\n        if(_onRemoteUser) {return}\r\n\r\n        if(_avatarToolStatus) {return} */\r\n\r\n        //  console.log('Base StartDrag:')\r\n        if (buttons === MOUSE_LEFT || buttons === 0) {\r\n\r\n          mem.downTime = new Date().getSeconds()\r\n          mem.downXpos = xy[0]\r\n          mem.downYpos = xy[1]\r\n\r\n          ////////////////////////////////////////////////\r\n          //const local = participants.local\r\n          const remotes = Array.from(participants.remote.keys()).filter(key => key !== participants.localId)\r\n          for (const [i] of remotes.entries()) {\r\n            let remoteX = Number(participants.remote.get(remotes[i])?.pose.position[0])\r\n            let remoteY = Number(participants.remote.get(remotes[i])?.pose.position[1])\r\n            let mouseX = Number(map.mouseOnMap[0])\r\n            let mouseY = Number(map.mouseOnMap[1])\r\n            if(mouseX >= (remoteX-30) && mouseX <= (remoteX+30) && mouseY >= (remoteY-30) && mouseY <= (remoteY+30)) {\r\n              return\r\n            }\r\n          }\r\n          ////////////////////////////////////////////////\r\n          const downTimer = setTimeout(() => {\r\n            clearTimeout(downTimer)\r\n            //if(itemLocked) {return}\r\n\r\n            let diffX = mem.downXpos - mem.cursorX\r\n            let diffY = mem.downYpos - mem.cursorY\r\n\r\n            //console.log(diffX, \" ---- \", diffY)\r\n\r\n            if(mem.mouseDown && diffX === 0 && diffY === 0 /* && showUploadOption === false */) {\r\n              //console.log(\"Open Context Menu\")\r\n              mem.zoomX = xy[0]\r\n              mem.zoomY = xy[1]\r\n              mem.contentX = map.mouseOnMap[0]\r\n              mem.contentY = map.mouseOnMap[1]\r\n              //_menuCanvas = true\r\n              setShowMenu(true)\r\n            }\r\n          }, 500)\r\n        }\r\n      },\r\n      onDrag: ({down, delta, xy, buttons}) => {\r\n        //console.log('onDrag')\r\n        mem.cursorX = xy[0]\r\n        mem.cursorY = xy[1]\r\n      },\r\n      onDragEnd: ({event, xy}) => {\r\n        mem.upXpos = xy[0]\r\n        mem.upYpos = xy[1]\r\n        mem.upTime = new Date().getSeconds()\r\n        let timeDiff = mem.upTime - mem.downTime\r\n\r\n        /* let _dialogStatus:boolean = isDialogOpen()\r\n\r\n        //console.log()\r\n        let _contentDialogStatus:boolean = getContentDialogStatus()\r\n        if(_contentDialogStatus) {return}\r\n\r\n        if(_dialogStatus) {return}\r\n */\r\n\r\n        if((mem.upXpos >= (mem.downXpos-20) && mem.upXpos <= (mem.downXpos+20) && (mem.upYpos >= (mem.downYpos-20) && mem.upYpos <= (mem.downYpos+20))) && String(Object(event?.target).tagName) === \"DIV\" && timeDiff < 1) {\r\n          //const local = participants.local\r\n          const remotes = Array.from(participants.remote.keys()).filter(key => key !== participants.localId)\r\n          for (const [i] of remotes.entries()) {\r\n            let remoteX = Number(participants.remote.get(remotes[i])?.pose.position[0])\r\n            let remoteY = Number(participants.remote.get(remotes[i])?.pose.position[1])\r\n            let mouseX = Number(map.mouseOnMap[0])\r\n            let mouseY = Number(map.mouseOnMap[1])\r\n            if(mouseX >= (remoteX-30) && mouseX <= (remoteX+30) && mouseY >= (remoteY-30) && mouseY <= (remoteY+30)) {\r\n              return\r\n            }\r\n          }\r\n        }\r\n        mem.dragging = false\r\n        mem.mouseDown = false\r\n        onLocalUser = false\r\n        setShowMenu(false)\r\n      },\r\n\r\n      onMove:({xy}) => {\r\n        mem.zoomX = xy[0]\r\n        mem.zoomY = xy[1]\r\n        map.setMouse(xy)\r\n        if(showMenu) {return}\r\n        participants.local.mouse.position = Object.assign({}, map.mouseOnMap)\r\n      },\r\n\r\n      onTouchStart:(ev) => {\r\n        mem.zoomX = ev.touches[0].clientX\r\n        mem.zoomY = ev.touches[0].clientY\r\n        onLocalUser = true\r\n        map.setMouse([ev.touches[0].clientX, ev.touches[0].clientY])\r\n        participants.local.mouse.position = Object.assign({}, map.mouseOnMap)\r\n      },\r\n\r\n      onTouchEnd:(e) => {\r\n        //console.log(e.changedTouches)\r\n        var changedTouch = e.changedTouches[0];\r\n\r\n        var elem = document.elementFromPoint(changedTouch.clientX, changedTouch.clientY);\r\n\r\n        console.log(elem?.nodeName, \" ----- \", elem?.id)\r\n\r\n        if(elem?.nodeName === \"IMG\" && elem?.id === \"contextMore\") {\r\n          //setShowUploadOption(true)\r\n          //setShowMenu(false)\r\n          openConfig()\r\n        } else if(elem?.nodeName === \"IMG\" && elem?.id === \"avatarGen\") {\r\n          openAvatarTool(e)\r\n        }\r\n        onLocalUser = false\r\n      }\r\n    },\r\n    {\r\n      eventOptions:{passive:false}, //  This prevents default zoom by browser when pinch.\r\n    },\r\n  )\r\n\r\n  ///////////////////////////////////////////////////////////////////////\r\n\r\n\r\n  return (\r\n    <div ref={drag.target} /* {...drag} */ {...moreControl} {...bind()}>\r\n    <Participant {...props} isLocal={true}\r\n      /* onContextMenu={(ev) => {\r\n        ev.preventDefault()\r\n        openConfig()\r\n      }} */\r\n    />\r\n    <MoreButton show={false} className={classes.more} htmlColor={color} {...moreControl}\r\n      buttonRef = {ref}\r\n      onClickMore = {openConfig} />\r\n    <LocalParticipantForm stores={props.stores} open={showConfig} close={onClose}\r\n      anchorEl={ref.current} anchorOrigin={{vertical:'top', horizontal:'left'}}\r\n      anchorReference = \"anchorEl\"\r\n    />\r\n    <Dialog open={showMenu} onClose={() => setShowMenu(false)} onExited={() => setShowMenu(false)}\r\n        keepMounted\r\n        PaperProps={{\r\n          style: {\r\n            backgroundColor: 'transparent',\r\n            position:'absolute',\r\n            boxShadow: 'none',\r\n            overflow:'hidden',\r\n            width: 350,\r\n            height: 250,\r\n            left: Number(mem.downXpos) - 200,\r\n            top: Number(mem.downYpos) - 160,\r\n            zIndex: showMenu ? 999 : -999,\r\n            transform: isSmartphone() ? 'scale(2.5)' : 'scale(1)',\r\n          },\r\n        }}\r\n        BackdropProps={{ invisible: true }}\r\n        >\r\n        <DialogContent style={showMenu ? {transform:'scale(1.1)', transition:'0s ease-out'} : {transform:'scale(0)', transition:'0s ease-out'}}>\r\n        <Zoom in={showMenu} style={{ transition: showMenu ? '500ms' : '0ms' }}>\r\n          <div className={showMenu ? classes.showMenuContainer : classes.hideMenuContainer}>\r\n            {/* <Tooltip placement=\"bottom\" title={showMenu ? t('ctUploadZone') : ''}> */}\r\n                <div className={classes.moreIcon} onMouseUp={openConfig}\r\n                  onTouchStart={stop}>\r\n                    <img id='contextMore' src={MoreIcon} height={TITLE_HEIGHT} width={TITLE_HEIGHT} style={{transform:'scale(1.2)'}} alt=\"\"/>\r\n                </div>\r\n              {/* </Tooltip> */}\r\n              <Tooltip placement=\"top\" title={showMenu ? t('ctGenerateAvatar') : ''}>\r\n              <div className={classes.avatarTool} onMouseUp={openAvatarTool}\r\n                  onTouchStart={stop}>\r\n                    <img id='avatarGen' src={AvatarGenIcon} height={TITLE_HEIGHT} width={TITLE_HEIGHT} style={{transform:'scale(1)'}} alt=\"\"/>\r\n                </div>\r\n              </Tooltip>\r\n            <div className={classes.dashedCircle}></div>\r\n            </div>\r\n          </Zoom>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Avatar gen tool dialog */}\r\n      <Dialog open={showTool} onClose={() => onCloseDialog()/* setShowTool(false) */} onExited={() => onCloseDialog()/* setShowTool(false) */} maxWidth=\"sm\" fullWidth={true} fullScreen={false}\r\n        keepMounted\r\n        PaperProps={{\r\n          style: {\r\n            minWidth: 760,\r\n            transform: isSmartphone() ? 'scale(1.2)' : 'scale(1)',\r\n          },\r\n        }}\r\n      >\r\n      <DialogTitle id=\"simple-dialog-title\" disableTypography={true} style={{fontSize: isSmartphone() ? '2.5em' : '1.2em', fontWeight:'bold'}}>\r\n        {'Customize My Avatar'}</DialogTitle>\r\n        <DialogContent>\r\n          <div className={classes.mainContainer}>\r\n          <div className={classes.menuContainer} /* style={{position:'relative', top:'12px', width:'100px', height:'100px'}} */>\r\n            {folders.map((items, index) => {\r\n              return (\r\n                <div className={pageIndex === index ? classes.avticeButtons : classes.deavticeButtons} onClick = {() => {EnableThis(index)}}>{items}</div>\r\n              );\r\n            })}\r\n\r\n          <div style={{position:'relative', width:'130px', height:'130px', maxWidth:'130px', marginLeft:'-10px'/* , backgroundColor:'red' */, marginTop:'50px'}}>\r\n            {selectedGroup !== '' || selectedSkin !== '' ?\r\n            <div ref={refAvatar} style={{position:'relative', width:'130px', height:'130px', maxWidth:'130px'}}>\r\n            <div style={{position:'absolute', top:'0px', left:'0px'}}>\r\n              <img style={{display: selectedGroup !== '' ? 'block' : 'none'}} src={selectedGroup} width={'130px'} height={'130px'} draggable={false} alt='' />\r\n            </div>\r\n            <div style={{position:'absolute', top:'0px', left:'0px'}}>\r\n              <img style={{display: selectedHairBack !== '' ? 'block' : 'none'}} src={selectedHairBack} width={'130px'} height={'130px'} draggable={false} alt='' />\r\n            </div>\r\n            <div style={{position:'absolute', top:'0px', left:'0px'}}>\r\n              <img style={{display: selectedSkin !== '' ? 'block' : 'none'}} src={selectedSkin} width={'130px'} height={'130px'}  draggable={false} alt='' />\r\n            </div>\r\n            <div style={{position:'absolute', top:'0px', left:'0px'}}>\r\n              <img style={{display: selectedHair !== '' ? 'block' : 'none'}} src={selectedHair} width={'130px'} height={'130px'}  draggable={false}alt='' />\r\n            </div>\r\n            <div style={{position:'absolute', top:'-3px', left:'0px'}}>\r\n              <img style={{display: selectedOutfits !== '' ? 'block' : 'none'}} src={selectedOutfits} width={'130px'} height={'130px'} draggable={false} alt='' />\r\n            </div>\r\n            <div style={{position:'absolute', top:'0px', left:'0px'}}>\r\n              <img style={{display: selectedSpecs !== '' ? 'block' : 'none'}} src={selectedSpecs} width={'130px'} height={'130px'} draggable={false} alt='' />\r\n            </div>\r\n            </div>\r\n            :\r\n            <div>\r\n            <div style={{position:'absolute', top:'0px', left:'0px'}}>\r\n              <img style={{backgroundColor:rgb2Color(rgb), borderRadius: '50%'}} src={props.participant.information.avatarSrc} width={'130px'} height={'130px'} draggable={false} alt='' />\r\n            </div>\r\n            </div>\r\n            }\r\n          <div style={{position:'absolute', top:'145px', left:'0px', fontSize:isSmartphone() ? '2em' : '1em', fontWeight:'bold', color:'#2279BD', width:'100%', textAlign:'center'}}>\r\n           {props.participant.information.name}\r\n          </div>\r\n        </div>\r\n      </div>\r\n          <List>\r\n          {pageIndex === 0 ?\r\n              <ListItem style={{minWidth:'470px', minHeight:'250px'}}>\r\n                <div className={classes.galleryMain}>\r\n                  <div style={{position:'relative', marginTop:'5px', marginLeft:'5px', fontSize:isSmartphone() ? '1.5em' : '0.9em', fontWeight:'bold', color:'#2279BD'}}>SKIN</div>\r\n                  <div className={classes.galleryList}>\r\n                    {_ITEMS_SKIN}\r\n                  </div>\r\n                  <div style={{position:'relative', marginTop:'5px', marginLeft:'5px', fontSize:isSmartphone() ? '1.5em' : '0.9em', fontWeight:'bold', color:'#2279BD'}}>HAIR</div>\r\n                  <div className={classes.galleryList}>\r\n                    {_ITEMS_HAIR}\r\n                  </div>\r\n                  <div style={{position:'relative', marginTop:'5px', marginLeft:'5px', fontSize:isSmartphone() ? '1.5em' : '0.9em', fontWeight:'bold', color:'#2279BD'}}>GROUP</div>\r\n                  <div className={classes.galleryList}>\r\n                    {_ITEMS_GROUP}\r\n                  </div>\r\n\r\n                </div>\r\n              </ListItem>\r\n              : <ListItem style={{minWidth:'470px', minHeight:'250px'}}>\r\n              <div className={classes.galleryMain}>\r\n                <div className={classes.gallery}>\r\n                  {_ITEMS}\r\n                </div>\r\n              </div>\r\n            </ListItem>}\r\n              <ListItem style={{width:'100%'}}>\r\n              <MuiThemeProvider theme={theme}>\r\n              <Button\r\n                  variant=\"contained\"\r\n                  /* color=\"primary\" */\r\n                  style={{fontSize: isSmartphone() ? '1.5em' : '1em', backgroundColor:'orange', position:'relative', marginLeft:isSmartphone() ? '-130px' : '75px'}}\r\n                  onClick={() => {\r\n                    onCloseDialog()\r\n                  }}\r\n                >\r\n                  Revert\r\n                </Button>\r\n                <Button\r\n                  variant=\"contained\"\r\n                  color=\"primary\"\r\n                  style={{fontSize: isSmartphone() ? '1.5em' : '1em', position:'relative', marginLeft: '13px'}}\r\n                  onClick={() => {\r\n                    onGenerateRandomAvatar()\r\n                  }}\r\n                >\r\n                  Generate Random\r\n                </Button>\r\n                <Button\r\n                  variant=\"contained\"\r\n                  /* color=\"primary\" */\r\n                  style={{fontSize: isSmartphone() ? '1.5em' : '1em', backgroundColor:'orange', position:'relative', marginLeft: '13px'}}\r\n                  onClick={() => {\r\n                    onApplyChanges()\r\n                  }}\r\n                >\r\n                  Apply Changes\r\n                </Button>\r\n                </MuiThemeProvider>\r\n              </ListItem>\r\n            </List>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const MemoedLocalParticipant = (props: ParticipantProps) =>\r\n  React.useMemo(() => <LocalParticipant {...props} />,\r\n  //  eslint-disable-next-line react-hooks/exhaustive-deps\r\n  [props.size, props.participant.information.avatarSrc,\r\n    props.participant.information.color,\r\n    props.participant.information.name,\r\n    props.participant.information.textColor,\r\n  ])\r\n  MemoedLocalParticipant.displayName = 'MemorizedLocalParticipant'\r\n","import {normV, subV2} from '@models/utils'\r\nimport React, {useEffect, useRef} from 'react'\r\n\r\nfunction checkClass<ET extends Element>(el: Element, stop:ET, clsToFind: string):Element | null {\r\n  let cur = el\r\n  while (cur && cur !== stop) {\r\n    if (cur.attributes) {\r\n      const cls = cur.attributes.getNamedItem('class')\r\n      if (cls) {\r\n        if (cls.value.includes(clsToFind)) {\r\n          return cur\r\n        }\r\n        //  console.log(cls.value)\r\n      }\r\n    }\r\n    cur = cur.parentNode as Element\r\n  }\r\n\r\n  return null\r\n}\r\n\r\nexport interface DragState<ET extends Element>{\r\n  buttons: number\r\n  xy: [number, number]\r\n  start: [number, number]\r\n  startTime: number\r\n  dragging: boolean\r\n  event:React.PointerEvent<ET>|undefined\r\n}\r\ninterface DragMemo<ET extends Element>{\r\n  timerAgain:boolean\r\n  timerId: number\r\n  state: DragState<ET>\r\n}\r\n/*\r\nexport class DragHandler<ET extends Element>{  //  pointer drag\r\n  onDrag: (state:DragState<ET>) => void\r\n  onTimer?: (state:DragState<ET>) => boolean\r\n  onContextMenu?: (ev: React.TouchEvent<ET>) => void\r\n  interval?: number\r\n  handle?: string  //  class name of dragging handle\r\n  target: React.RefObject<ET>\r\n  memo: DragMemo<ET>\r\n*/\r\nexport function DragHandler<ET extends Element>(onDrag:(state:DragState<ET>) => void, handle?: string,\r\n              onTimer?:(state:DragState<ET>) => boolean, interval?: number,\r\n              onContextMenu?:(ev: React.TouchEvent<ET>) => void) {\r\n  const target = useRef<ET>(null)\r\n  const memo = useRef<DragMemo<ET>>({state:{}} as DragMemo<ET>).current\r\n\r\n  const timerFunc = () => {\r\n    if (!memo.state.dragging && !memo.timerAgain) {\r\n      clearInterval(memo.timerId)\r\n      memo.timerId = 0\r\n    }else if (onTimer) {\r\n      memo.timerAgain = onTimer(memo.state)\r\n    }\r\n  }\r\n\r\n  //  To prevent browser zoom, onTouchMove must call preventDefault() and need {passive:false}\r\n  function onTouchMove(ev: Event) {\r\n    ev.preventDefault()\r\n    ev.stopPropagation()\r\n  }\r\n\r\n  useEffect(() => {\r\n    const current = target.current\r\n    current?.addEventListener('touchmove', onTouchMove, {passive:false})\r\n\r\n    return () => {\r\n      current?.removeEventListener('touchmove', onTouchMove)\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  },        [target.current])\r\n  const bindObject = {\r\n    target: target,\r\n    memo: memo,\r\n    onMouseDown: (e: React.MouseEvent<ET>) => { e.stopPropagation() },\r\n    onTouchStart: (e: React.TouchEvent<ET>) => { e.stopPropagation() },\r\n    onPointerDown: (e: React.PointerEvent<ET>) => {\r\n      e.stopPropagation()\r\n      memo.state = {dragging:false, buttons:e.buttons, xy:[e.clientX, e.clientY],\r\n        start:[e.clientX, e.clientY], startTime:Date.now(), event:e}\r\n      if ((e.buttons & 1) && target.current &&\r\n        (!handle || checkClass(e.target as Element, target.current, handle))) {\r\n        (e.target as Element).setPointerCapture(e.pointerId)\r\n\r\n        if (!memo.timerId) {\r\n          memo.timerId = setInterval(timerFunc, interval)\r\n        }\r\n        memo.state.dragging = true\r\n      }\r\n      //  console.log(`onPointerDown: ${this.memo.state.dragging}`)\r\n    },\r\n    onPointerOut: (e: React.PointerEvent<ET>) => {\r\n      e.stopPropagation()\r\n      Object.assign(memo.state, {dragging:false, buttons:e.buttons, xy:[e.clientX, e.clientY], event:e})\r\n      //  console.log(`onPointerOut: ${this.memo.state.dragging}`)\r\n    },\r\n    onPointerUp: (e: React.PointerEvent<ET>) => {\r\n      (e.target as Element).releasePointerCapture(e.pointerId)\r\n      bindObject.onPointerOut(e)\r\n    },\r\n    onTouchEnd:(e: React.TouchEvent<ET>) => {\r\n      e.stopPropagation()\r\n      const delta = normV(subV2(memo.state.xy, memo.state.start))\r\n      const deltaT = Date.now() - memo.state.startTime\r\n      if (delta < 5 && deltaT > 0.5 && onContextMenu) {\r\n        onContextMenu(e)\r\n      }\r\n    },\r\n    onPointerMove: (e: React.PointerEvent<ET>) => {\r\n      e.stopPropagation()\r\n      Object.assign(memo.state, {dragging:memo.state?.dragging ? true :false,\r\n        buttons:e.buttons, xy:[e.clientX, e.clientY], event:e})\r\n      //  console.log(`onPointerMove xy:${e.clientX},${e.clientY} buttons:${e.buttons} drag:${this.dragging ? 1 : 0}`)\r\n\r\n      if (memo.state.dragging) {\r\n        if ((e.buttons & 1)) {\r\n          onDrag(memo.state)\r\n        }else {\r\n          memo.state.dragging = false\r\n        }\r\n      }\r\n    },\r\n  }\r\n\r\n  return bindObject\r\n}\r\n","export default \"data:image/png;base64,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\"","import {BMProps} from '@components/utils'\r\nimport {TextField} from '@material-ui/core'\r\nimport Box from '@material-ui/core/Box'\r\nimport Button from '@material-ui/core/Button'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport Popover, { PopoverProps } from '@material-ui/core/Popover'\r\nimport {conference, getStatFromRemotePeer} from '@models/conference'\r\nimport {MessageType} from '@models/conference/DataMessageType'\r\nimport {t} from '@models/locales'\r\nimport chat from '@stores/Chat'\r\nimport participants from '@stores/participants/Participants'\r\nimport {RemoteParticipant} from '@stores/participants/RemoteParticipant'\r\nimport contents from '@stores/sharedContents/SharedContents'\r\nimport React from 'react'\r\nimport {SignalQualityButton} from './SignalQuality'\r\n\r\nexport interface RemoteParticipantFormProps extends PopoverProps, BMProps{\r\n  close: () => void,\r\n  participant?: RemoteParticipant\r\n}\r\n\r\nexport const RemoteParticipantForm: React.FC<RemoteParticipantFormProps> = (props: RemoteParticipantFormProps) => {\r\n  const roomInfo = props.stores.roomInfo\r\n  const [kick, setKick] = React.useState<string>('')\r\n  const [clear, setClear] = React.useState<string>('')\r\n  function onKeyPressKick(ev:React.KeyboardEvent){\r\n    if (ev.key === 'Enter' && kick === 'kick') {\r\n      if (!props.participant) { return }\r\n      //TODO: when kicked\r\n      setTimeout(()=>{conference.dataConnection.sendMessage(\r\n        MessageType.KICK, 'Kicked by administrator.', props.participant!.id)}, 5000)\r\n      props.close()\r\n    }\r\n  }\r\n  function onKeyPressClear(ev:React.KeyboardEvent){\r\n    if (ev.key === 'Enter' && clear === 'clear') {\r\n      if (!props.participant) { return }\r\n      const remoteContents:string[] = []\r\n      contents.all.forEach(c => {\r\n        if (c.ownerName === props.participant?.information.name) remoteContents.push(c.id)\r\n      })\r\n      remoteContents.forEach(cid => contents.removeByLocal(cid))\r\n\r\n      props.close()\r\n    }\r\n  }\r\n  function closeConfig(ev:Object, reason:string) {\r\n    if (reason === 'enter' || reason==='backdropClick'){\r\n    }\r\n    props.close()\r\n  }\r\n\r\n  const popoverProps = Object.assign({}, props)\r\n  delete (popoverProps as Partial<RemoteParticipantFormProps>).close\r\n  const pid = props.participant ? props.participant.id : ''\r\n\r\n  return <Popover {...popoverProps} onClose={closeConfig}>\r\n    <DialogTitle>\r\n      {props.participant?.information.name}\r\n      <span style={{float:'right'}}>\r\n        <SignalQualityButton open={props.open} stat={getStatFromRemotePeer(conference.remotePeers.get(pid))} /></span>\r\n    </DialogTitle>\r\n    <DialogContent>\r\n      <Box mb={2}>\r\n      <Button variant=\"contained\" style={{textTransform:'none'}}\r\n          onClick={()=>{\r\n            closeConfig({}, 'enter')\r\n            props.participant?.call()\r\n          }}>{t('rsCall')}</Button>\r\n      </Box>\r\n      <Box mb={2}>\r\n      <Button variant=\"contained\" style={{textTransform:'none'}}\r\n        onClick={()=>{\r\n          if (!props.participant) { return }\r\n          if (participants.yarnPhones.has(props.participant.id)){\r\n            participants.yarnPhones.delete(props.participant.id)\r\n          }else{\r\n            participants.yarnPhones.add(props.participant.id)\r\n          }\r\n          closeConfig({}, 'enter')\r\n        }}>\r\n          {props.participant && participants.yarnPhones.has(props.participant.id) ?\r\n            t('rsCutYarnPhone') : t('rsConnectYarnPhone')}</Button>\r\n      </Box>\r\n      <Box mb={2}>\r\n      <Button variant=\"contained\" style={{textTransform:'none'}}\r\n        onClick={()=>{\r\n          if (!props.participant) { return }\r\n          chat.sendTo = props.participant.id\r\n          closeConfig({}, 'enter')\r\n        }}>\r\n          {t('rsChatTo', {name: props.participant?.information.name})}</Button>\r\n      </Box>\r\n      <Box mb={2}>\r\n      <Button variant=\"contained\" style={{textTransform:'none'}}\r\n      onClick={()=>{\r\n        if (!props.participant) { return }\r\n        props.stores.map.focusOn(props.participant)\r\n      }}>{t('ctFocus')}</Button>\r\n      </Box>\r\n      { roomInfo.passMatched && <>\r\n          <Box mb={2}>\r\n            To kick this user type 'kick' and enter. &thinsp;\r\n            <TextField label=\"kick\" type=\"text\" style={{marginTop:-22}}\r\n              value={kick} onChange={(ev)=>{setKick(ev.currentTarget.value)}} onKeyPress={onKeyPressKick}\r\n            />\r\n          </Box>\r\n          <Box mb={2}>\r\n            Clear this user's contents.&thinsp;\r\n            <TextField label=\"clear\" type=\"text\" style={{marginTop:-22}}\r\n              value={clear} onChange={(ev)=>{setClear(ev.currentTarget.value)}} onKeyPress={onKeyPressClear}\r\n            />\r\n         </Box>\r\n        </>\r\n      }\r\n    </DialogContent>\r\n  </Popover>\r\n}\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAAEhElEQVR4nO2c0XHaQBBAH5n8h1RguQLTQUgFdgfBHZAOcAVxKjDuAFcQXEGgA9yBqED5WGmEsZCEjNhdZ9+MxkaWuRs97Wp1dzDIsozAJ5+0OxB0J+Q5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ55rN2B3okAUb5VjAGVkCav97k2/JsvTohgw/2ydibne3Lkf+7BubAAhFqno8gbwhM8+1YYYd4BmYYj0jv8qbIST6VtH1MS/Qqb4ikt29nau83cqGYwqO8ERIJfUXbIdZIwZM2HHc2vD0q3KAjDuAqb3uo0HYlniJvBPzV7gSGItBL5CXYKRqukPutOl7kLdBJlYf4hlShqlhNm8V9JUWqvF+KfanjEsUHeouRN0aGsMaIxJliX5qYaTZuLfImwEP++1ekunw4eLQN1KLPUuTNKUU9UqZM69xoNWxF3hT4sfN6gaTMK53uHMV/LW/M24JkyeupnGO4Q1LuALgFtjXHroHv+bGX+etjOdcQ3VuyLNPchlmWpdlr0vxv0+x45hVtTGqOTyr6s+nQrsr50468qmmcVf6zyzDUvOU+kBmDzd6+FCMP4G3QlFfMw52SpOW+uv1mxi6b0JTXZba7iSlvT/7swLEXyKPJLiNeF06m0VzD0lSlbTq8ZzHyf0/5qFFXUDwgwhZ5fyYd2lRD8yG9ruEBdmYRmnjhcAruFe2C5RAJUrjUlflWWGo1bFVekVI9VH5qfbSaNtdI2hwDf87Sm26opUywG3lXlGtVnnW7UstMs3GrkQfwhKRPq4WLatSBbuS9NPz9mnJu76733hzPRLsDmvLa3OjnlBOyltLnTwysqdGUN29xzMXOcTd0G/U/NY/IIIA6mvJWtIuma0RgiqRRTYG/MZAuC7SrzVnL435QChwhJ/Hc/MTYzL6FNSwLJLra8IRc+SmSRu+R1No3WwzONmhHHoiMtqnwmnJl2QKJwjv6H0YzOdJjQV4RRW0FXCCjLnPKSjRB0lrT40dXkp7e911YSJsFCXKFH7vo6BERuMlfF8Nq4/z3U6XVrxj4fMIuluSBRNI93SZEi48lLymXUuy+7/6CpiES8W3buqXd483ZsCYP5KSueH/EFGtUNnv7N7yWMEIumKZVYM9INJvBojyQk9vHcoQ1UiDtRyb5/hn1F83g5D16BxYKlr7ZIvfF70iUVYkDuWASJD1WVb+WhucAu5G3pN1i1heq17qsKL9f5ZCsJhLKwidFojIKlhbUdWqLnEg335fSFxa/AaluVdkjMkRlKgK0sChvUrHvGZHWNQV+SCzKK8YQt0hqvCekVWLxnlc8UC+V+2Eei/KClvwPz3kflpDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmH/0ilgyg53pQQAAAABJRU5ErkJggg==\"","import {MoreButton, moreButtonControl, MoreButtonMember} from '@components/utils/MoreButton'\r\nimport {makeStyles} from '@material-ui/core/styles'\r\nimport participants from '@stores/participants/Participants'\r\nimport {RemoteParticipant as RemoteParticipantStore} from '@stores/participants/RemoteParticipant'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React, { useRef } from 'react'\r\nimport {Participant, ParticipantProps} from './Participant'\r\nimport {RemoteParticipantForm} from './RemoteParticipantForm'\r\n\r\n\r\nimport {isDialogOpen} from \"@components/footer/share/ShareDialog\"\r\nimport CallIcon from '@images/earshot_icon_mic.png'\r\nimport YarnPhoneIcon from '@images/earshot_icon_btn-earshot-2.png'\r\nimport ChatIcon from '@images/earshot_icon_btn-chat.png'\r\nimport FocusIcon from '@images/earshot_icon_btn-extract.png'\r\nimport KickIcon from '@images/earshot_icon_btn-kick.png'\r\nimport chat from '@stores/Chat'\r\nimport { TITLE_HEIGHT } from '@stores/sharedContents/SharedContents'\r\n\r\nimport { useTranslation } from '@models/locales'\r\nimport { getContentDialogStatus, getContentLocked, isOnContentStatus, MouseOrTouch } from '../Share/RndContent'\r\nimport { useGesture } from 'react-use-gesture'\r\nimport { Dialog, DialogContent, Tooltip, Zoom } from '@material-ui/core'\r\nimport { isSmartphone } from '@models/utils'\r\nimport { conference } from '@models/conference'\r\nimport { MessageType } from '@models/conference/DataMessageType'\r\n\r\n/* const AVATAR_SPEED_LIMIT = 50\r\nconst MAP_SPEED_LIMIT = 600\r\nconst MAP_SPEED_MIN = 100\r\nconst HALF_DEGREE = 180\r\nconst WHOLE_DEGREE = 360 */\r\n///////////////////////////////////////////////\r\n\r\n\r\ninterface RemoteParticipantMember extends MoreButtonMember{\r\n  timeout:NodeJS.Timeout|undefined\r\n\r\n  ///////////////////////////////////\r\n  smoothedDelta: [number, number]\r\n  scrollAgain: boolean\r\n  ///////////////////////////////////\r\n}\r\n\r\ninterface StyleProps {\r\n  position: [number, number],\r\n  size: number,\r\n}\r\nconst useStyles = makeStyles({\r\n  more: (props: StyleProps) => ({\r\n    position: 'absolute',\r\n    width: props.size * 0.5 ,\r\n    height: props.size * 0.5,\r\n    left: props.position[0] + props.size * 0.4,\r\n    top: props.position[1] - props.size * 0.8,\r\n    opacity: '0',\r\n  }),\r\n  hideMenuContainer: (props:StyleProps) => ({\r\n    display: 'flex',\r\n    position: 'absolute',\r\n    width: 350,\r\n    height: 250,\r\n    overflow: 'hidden',\r\n    userSelect: 'none',\r\n    userDrag: 'none',\r\n    bottom: 'auto',\r\n    /* transform: 'scale(0)', */\r\n    backgroundColor: 'transparent',\r\n    transition: '0s ease-out',\r\n    cursor: 'default',\r\n  }),\r\n  showMenuContainer: (props:StyleProps) => ({\r\n    display: 'flex',\r\n    position: 'absolute',\r\n    width: 350,\r\n    height: 250,\r\n    overflow: 'hidden',\r\n    userSelect: 'none',\r\n    userDrag: 'none',\r\n    //top: (props.position[1]) - 130,\r\n    //left: isSmartphone() ? (props.position[0]) - 160 : (props.position[0]) - 170,\r\n    top: 0,\r\n    left: 0,\r\n    bottom: 'auto',\r\n    /* transform: isSmartphone() ? 'scale(2.8)' : 'scale(1.2)', */\r\n    backgroundColor: 'transparent',\r\n    transition: '0.3s ease-out',\r\n    transitionDelay: '0.1s',\r\n    cursor: 'default',\r\n  }),\r\n\r\n  dashedCircle: (props: StyleProps) => ({\r\n    position: 'relative',\r\n    width:200,\r\n    height:200,\r\n    borderWidth:2,\r\n    borderStyle: 'solid',\r\n    borderColor:'#9e886c',\r\n    borderRadius:'50%',\r\n    opacity: 0.4,\r\n    top: 25,\r\n    left: 65,\r\n    background: 'radial-gradient(#ffffff, #ffffff, #ffffff, #9e886c, #9e886c)',\r\n    zIndex: -9999,\r\n  }),\r\n\r\n  callIcon: (props:StyleProps) => ({\r\n    display: 'block',\r\n    height: TITLE_HEIGHT,\r\n    position:'absolute',\r\n    textAlign: 'center',\r\n    top: 90,\r\n    left: 64,\r\n    whiteSpace: 'pre',\r\n    cursor: 'default',\r\n    background: '#9e886c',\r\n    opacity: 0.2,\r\n    ...buttonStyle\r\n  }),\r\n\r\n  yarnPhoneIcon: (props:StyleProps) => ({\r\n    display: 'block',\r\n    height: TITLE_HEIGHT,\r\n    position:'absolute',\r\n    textAlign: 'center',\r\n    top: 44,\r\n    left: 90,\r\n    whiteSpace: 'pre',\r\n    cursor: 'default',\r\n    //background: '#9e886c',\r\n    background: participants.yarnPhones.size ? '#ef4623' : '#9e886c',\r\n    //...buttonStyle\r\n    ...participants.yarnPhones.size > 0 ? buttonStyleActive : buttonStyle\r\n  }),\r\n\r\n  chatIcon: (props:StyleProps) => ({\r\n    display: 'block',\r\n    height: TITLE_HEIGHT,\r\n    position:'absolute',\r\n    textAlign: 'center',\r\n    top: 23,\r\n    left: 140,\r\n    whiteSpace: 'pre',\r\n    cursor: 'default',\r\n    background: '#9e886c',\r\n    ...buttonStyle\r\n  }),\r\n\r\n  focusIcon: (props:StyleProps) => ({\r\n    display: 'block',\r\n    height: TITLE_HEIGHT,\r\n    position:'absolute',\r\n    textAlign: 'center',\r\n    top: 40, //23, //40,\r\n    left: 190, //140, //190,\r\n    whiteSpace: 'pre',\r\n    cursor: 'default',\r\n    background: '#9e886c',\r\n    ...buttonStyle\r\n  }),\r\n\r\n  kickIcon: (props:StyleProps) => ({\r\n    display: 'block',\r\n    height: TITLE_HEIGHT,\r\n    position:'absolute',\r\n    textAlign: 'center',\r\n    top: 85, //40, //85,\r\n    left:217, //190, //217,\r\n    whiteSpace: 'pre',\r\n    cursor: 'default',\r\n    background: '#9e886c',\r\n    ...buttonStyle\r\n  }),\r\n})\r\n\r\nconst buttonStyle = {\r\n  '&': {\r\n    margin: '5px',\r\n    borderRadius: '50%',\r\n    width: '35px',\r\n    height: '35px',\r\n    padding: '3px',\r\n  },\r\n\r\n  '&:hover': {\r\n    backgroundColor: 'black',\r\n    margin: '5px',\r\n    padding: '3px',\r\n    borderRadius: '50%',\r\n  },\r\n  '&:active': {\r\n    margin: '5px',\r\n    padding: '3px',\r\n    borderRadius: '50%',\r\n  },\r\n}\r\n\r\nconst buttonStyleActive = {\r\n  '&': {\r\n    margin: '5px',\r\n    borderRadius: '50%',\r\n    width: '35px',\r\n    height: '35px',\r\n    padding: '3px',\r\n\r\n\r\n    //border: '2px solid #9e886c',\r\n    //backgroundColor: 'white',\r\n  },\r\n\r\n  '&:hover': {\r\n    backgroundColor: '#B34700', //'rosybrown',\r\n    margin: '5px',\r\n    padding: '3px',\r\n    borderRadius: '50%',\r\n  },\r\n  '&:active': {\r\n    //backgroundColor: 'firebrick',\r\n    margin: '5px',\r\n    padding: '3px',\r\n    borderRadius: '50%',\r\n  },\r\n}\r\n\r\nclass RemoteMember{\r\n  prebThirdPersonView = false\r\n  mouseDown = false\r\n  dragging = false\r\n\r\n  // New values\r\n  upTime = 0\r\n  downTime = 0\r\n  downXpos = 0\r\n  downYpos = 0\r\n  upXpos = 0\r\n  upYpos = 0\r\n  contentX = 0\r\n  contentY = 0\r\n  zoomX = 0\r\n  zoomY = 0\r\n  moveX = 0\r\n  moveY = 0\r\n\r\n  clickStatus = ''\r\n  userAngle = 0\r\n  clickEnter = false\r\n  pingX = 0\r\n  pingY = 0\r\n  hidePinIcon = 0\r\n\r\n  // moveLoc\r\n  cursorX = 0\r\n  cursorY = 0\r\n}\r\n\r\n\r\nlet isMoved:boolean = false\r\nexport function checkIsRemoteMoved():boolean {\r\n  return isMoved\r\n}\r\nexport function resetIsRemoteMoved() {\r\n  isMoved = false\r\n}\r\n\r\nlet onRemoteUser:boolean = false\r\nexport function getOnRemote():boolean {\r\n  return onRemoteUser\r\n}\r\n\r\nexport const RemoteParticipant: React.FC<ParticipantProps> = (props) => {\r\n  const member = React.useRef<RemoteParticipantMember>({} as RemoteParticipantMember).current\r\n  const [showMore, setShowMore] = React.useState(false)\r\n  const moreControl = moreButtonControl(setShowMore, member)\r\n  const [showForm, setShowForm] = React.useState(false)\r\n  const [color] = props.participant.getColor()\r\n\r\n  /////////////////////////////////////////////////\r\n\r\n  const memRef = useRef<RemoteMember>(new RemoteMember())\r\n  const mem = memRef.current\r\n  const [showMenu, setShowMenu] = React.useState(false)\r\n\r\n  ////////////////////////////////////////////////////////////////////\r\n  //console.log(connection.conference._jitsiConference?.isModerator(), \" isHost\")\r\n  /* const isHost = connection.conference._jitsiConference?.isModerator() */\r\n  const map = props.stores.map\r\n  //const participants = props.stores.participants\r\n  /* const participant = props.participant */\r\n //assert(props.participant.id === participant.id)\r\n\r\n///////////////////////////////\r\n\r\n  const styleProps = useObserver(() => ({\r\n    position: props.participant.pose.position,\r\n    size: props.size,\r\n  }))\r\n  const classes = useStyles(styleProps)\r\n\r\n  const {t} = useTranslation()\r\n\r\n  /* function switchYarnPhone(ev:React.MouseEvent<HTMLDivElement>, id:string){\r\n    if (showForm){ return }\r\n    if (participants.yarnPhones.has(id)) {\r\n      participants.yarnPhones.delete(id)\r\n    }else {\r\n      participants.yarnPhones.add(id)\r\n    }\r\n    participants.yarnPhoneUpdated = true\r\n  } */\r\n  function onClose() {\r\n    props.stores.map.keyInputUsers.delete('remoteForm')\r\n    setShowForm(false)\r\n  }\r\n  function openForm() {\r\n    props.stores.map.keyInputUsers.add('remoteForm')\r\n    setShowForm(true)\r\n  }\r\n  const buttonRef=React.useRef<HTMLButtonElement>(null)\r\n\r\n  function stop(ev:MouseOrTouch|React.PointerEvent) {\r\n    ev.stopPropagation()\r\n    ev.preventDefault()\r\n  }\r\n\r\n  ////////////////////////////////////////////////////////////////////////\r\n  const MOUSE_LEFT = 1\r\n  //const MOUSE_RIGHT = 2\r\n  const bind = useGesture(\r\n    {\r\n      onDragStart: ({buttons, xy}) => {\r\n\r\n        document.body.focus()\r\n        mem.dragging = true\r\n        mem.mouseDown = true\r\n\r\n        onRemoteUser = true\r\n\r\n        mem.downTime = new Date().getSeconds()\r\n        mem.moveX = map.mouseOnMap[0]\r\n        mem.moveY = map.mouseOnMap[1]\r\n\r\n\r\n        let itemLocked = getContentLocked()\r\n        let _onContent = isOnContentStatus()\r\n\r\n        //let _onRemoteUser = getOnRemote()\r\n        let _dialogStatus:boolean = isDialogOpen()\r\n\r\n        let _contentDialogStatus:boolean = getContentDialogStatus()\r\n        if(_contentDialogStatus) {return}\r\n        if(_dialogStatus) {return}\r\n\r\n        //console.log(_onRemoteUser, \" onRemoteUser\")\r\n\r\n        //if(showUploadOption) {return}\r\n        if(_onContent) {return}\r\n        //if(_onRemoteUser) {return}\r\n\r\n        //  console.log('Base StartDrag:')\r\n        if (buttons === MOUSE_LEFT || buttons === 0) {\r\n\r\n          mem.downTime = new Date().getSeconds()\r\n          mem.downXpos = xy[0]\r\n          mem.downYpos = xy[1]\r\n\r\n          ////////////////////////////////////////////////\r\n          //const local = participants.local\r\n          /* const remotes = Array.from(participants.remote.keys()).filter(key => key !== participants.localId)\r\n          for (const [i] of remotes.entries()) {\r\n            let remoteX = Number(participants.remote.get(remotes[i])?.pose.position[0])\r\n            let remoteY = Number(participants.remote.get(remotes[i])?.pose.position[1])\r\n            let mouseX = Number(map.mouseOnMap[0])\r\n            let mouseY = Number(map.mouseOnMap[1])\r\n            if(mouseX >= (remoteX-30) && mouseX <= (remoteX+30) && mouseY >= (remoteY-30) && mouseY <= (remoteY+30)) {\r\n              return\r\n            }\r\n          } */\r\n          ////////////////////////////////////////////////\r\n          const downTimer = setTimeout(() => {\r\n            clearTimeout(downTimer)\r\n            if(itemLocked) {return}\r\n\r\n            let diffX = mem.downXpos - mem.cursorX\r\n            let diffY = mem.downYpos - mem.cursorY\r\n\r\n            //console.log(diffX, \" ---- \", diffY)\r\n\r\n            if(mem.mouseDown && diffX === 0 && diffY === 0 /* && showUploadOption === false */) {\r\n              //console.log(\"Open Context Menu\")\r\n              mem.zoomX = xy[0]\r\n              mem.zoomY = xy[1]\r\n              mem.contentX = map.mouseOnMap[0]\r\n              mem.contentY = map.mouseOnMap[1]\r\n              //_menuCanvas = true\r\n              setShowMenu(true)\r\n            }\r\n          }, 500)\r\n        }\r\n      },\r\n      onDrag: ({down, delta, xy, buttons}) => {\r\n        //console.log('onDrag')\r\n        mem.cursorX = xy[0]\r\n        mem.cursorY = xy[1]\r\n      },\r\n      onDragEnd: ({event, xy}) => {\r\n        mem.upXpos = xy[0]\r\n        mem.upYpos = xy[1]\r\n        mem.upTime = new Date().getSeconds()\r\n        let timeDiff = mem.upTime - mem.downTime\r\n\r\n        let _dialogStatus:boolean = isDialogOpen()\r\n\r\n        //console.log()\r\n        let _contentDialogStatus:boolean = getContentDialogStatus()\r\n        if(_contentDialogStatus) {return}\r\n\r\n        if(_dialogStatus) {return}\r\n\r\n\r\n        /* if((mem.upXpos >= (mem.downXpos-20) && mem.upXpos <= (mem.downXpos+20) && (mem.upYpos >= (mem.downYpos-20) && mem.upYpos <= (mem.downYpos+20))) && String(Object(event?.target).tagName) === \"DIV\" && timeDiff < 1) {\r\n          //const local = participants.local\r\n          const remotes = Array.from(participants.remote.keys()).filter(key => key !== participants.localId)\r\n          for (const [i] of remotes.entries()) {\r\n            let remoteX = Number(participants.remote.get(remotes[i])?.pose.position[0])\r\n            let remoteY = Number(participants.remote.get(remotes[i])?.pose.position[1])\r\n            let mouseX = Number(map.mouseOnMap[0])\r\n            let mouseY = Number(map.mouseOnMap[1])\r\n            if(mouseX >= (remoteX-30) && mouseX <= (remoteX+30) && mouseY >= (remoteY-30) && mouseY <= (remoteY+30)) {\r\n              return\r\n            }\r\n          }\r\n        } */\r\n\r\n        if(timeDiff === 0) {\r\n          //switchYarnPhoneID(props.participant.id)\r\n        }\r\n\r\n        mem.dragging = false\r\n        mem.mouseDown = false\r\n        onRemoteUser = false\r\n        setShowMenu(false)\r\n      },\r\n\r\n      onMove:({xy}) => {\r\n        mem.zoomX = xy[0]\r\n        mem.zoomY = xy[1]\r\n        map.setMouse(xy)\r\n        if(showMenu) {return}\r\n        participants.local.mouse.position = Object.assign({}, map.mouseOnMap)\r\n      },\r\n\r\n      onTouchStart:(ev) => {\r\n        mem.zoomX = ev.touches[0].clientX\r\n        mem.zoomY = ev.touches[0].clientY\r\n        onRemoteUser = true\r\n        map.setMouse([ev.touches[0].clientX, ev.touches[0].clientY])\r\n        participants.local.mouse.position = Object.assign({}, map.mouseOnMap)\r\n      },\r\n\r\n      onTouchEnd:(e) => {\r\n        //console.log(e.changedTouches)\r\n        var changedTouch = e.changedTouches[0];\r\n\r\n        var elem = document.elementFromPoint(changedTouch.clientX, changedTouch.clientY);\r\n        if(elem?.nodeName === \"IMG\" && elem?.id === \"menuUpload\") {\r\n          //setShowUploadOption(true)\r\n          setShowMenu(false)\r\n        }\r\n        onRemoteUser = false\r\n      }\r\n    },\r\n    {\r\n      eventOptions:{passive:false}, //  This prevents default zoom by browser when pinch.\r\n    },\r\n  )\r\n\r\n  ///////////////////////////////////////\r\n  function onConnectYarnPhone(ev:MouseOrTouch) {\r\n    if (!props.participant) { return }\r\n    if (participants.yarnPhones.has(props.participant.id)){\r\n      participants.yarnPhones.delete(props.participant.id)\r\n    }else{\r\n      participants.yarnPhones.add(props.participant.id)\r\n    }\r\n  }\r\n\r\n  function onFocusCenter(ev:MouseOrTouch) {\r\n    if (!props.participant) { return }\r\n    props.stores.map.focusOn(props.participant)\r\n  }\r\n\r\n  function onUserKick(ev:MouseOrTouch) {\r\n    if (!props.participant) { return }\r\n    //conference.dataConnection.(props.participant.id)\r\n    setTimeout(()=>{conference.dataConnection.sendMessage(\r\n      MessageType.KICK, 'Kicked by Host.', props.participant!.id)}, 5000)\r\n  }\r\n\r\n  function onSendChatTo(ev:MouseOrTouch) {\r\n    if (!props.participant) { return }\r\n    chat.sendTo = props.participant.id\r\n  }\r\n  ///////////////////////////////////////\r\n\r\n  return (\r\n    <div {...moreControl} {...bind()}\r\n      /* onClick = {(ev)=>switchYarnPhone(ev, props.participant.id)} */\r\n\r\n      /* onContextMenu={(ev) => {ev.preventDefault(); openForm()}} */\r\n    >\r\n      <Participant {...props} isLocal={false}/>\r\n      <MoreButton show={showMore} className={classes.more} htmlColor={color} {...moreControl}\r\n      buttonRef={buttonRef}\r\n      onClickMore = {(ev)=>{\r\n        ev.stopPropagation()\r\n        openForm()\r\n      }} />\r\n      <RemoteParticipantForm open={showForm} close={onClose} stores={props.stores}\r\n        participant={props.participant as RemoteParticipantStore}\r\n        anchorEl={buttonRef.current} anchorOrigin={{vertical:'top', horizontal:'left'}}\r\n        anchorReference = \"anchorEl\"\r\n      />\r\n      {/* // Context Menu */}\r\n      <Dialog open={showMenu} onClose={() => setShowMenu(false)} onExited={() => setShowMenu(false)}\r\n        keepMounted\r\n        PaperProps={{\r\n          style: {\r\n            backgroundColor: 'transparent',\r\n            position:'absolute',\r\n            boxShadow: 'none',\r\n            overflow:'hidden',\r\n            width: 350,\r\n            height: 250,\r\n            left: Number(mem.downXpos) - 200,\r\n            top: Number(mem.downYpos) - 160,\r\n            zIndex: showMenu ? 999 : -999,\r\n            transform: isSmartphone() ? 'scale(2.5)' : 'scale(1)',\r\n          },\r\n        }}\r\n        BackdropProps={{ invisible: true }}\r\n        >\r\n        <DialogContent style={showMenu ? {transform:'scale(1.1)', transition:'0s ease-out'} : {transform:'scale(0)', transition:'0s ease-out'}}>\r\n          <Zoom in={showMenu} style={{ transition: showMenu ? '500ms' : '0ms' }}>\r\n            <div className={showMenu ? classes.showMenuContainer : classes.hideMenuContainer}>\r\n            <Tooltip placement=\"left\" title={showMenu ? t('rsCall') : ''}>\r\n                <div className={classes.callIcon}\r\n                  onTouchStart={stop}>\r\n                    <img id='rsCall' src={CallIcon} height={TITLE_HEIGHT} width={TITLE_HEIGHT} style={{transform:'scale(1.2)'}} alt=\"\"/>\r\n                </div>\r\n              </Tooltip>\r\n              <Tooltip placement=\"left\" title={showMenu ? t('rsConnectYarnPhone') : ''}>\r\n              <div className={classes.yarnPhoneIcon} onMouseUp={onConnectYarnPhone}\r\n                  onTouchStart={stop}>\r\n                    <img id='yarnPhone' src={YarnPhoneIcon} height={TITLE_HEIGHT} width={TITLE_HEIGHT} style={{transform:'scale(1.2)'}} alt=\"\"/>\r\n                </div>\r\n              </Tooltip>\r\n              <Tooltip placement=\"top\" title={showMenu ? t('rsChatTo') : ''}>\r\n              <div className={classes.chatIcon} onMouseUp={onSendChatTo}\r\n                  onTouchStart={stop}>\r\n                    <img id='yarnPhone' src={ChatIcon} height={TITLE_HEIGHT} width={TITLE_HEIGHT} style={{transform:'scale(1.2)'}} alt=\"\"/>\r\n                </div>\r\n              </Tooltip>\r\n              <Tooltip placement=\"right\" title={showMenu ? t('ctFocus') : ''}>\r\n              <div className={classes.focusIcon} onMouseUp={onFocusCenter}\r\n                  onTouchStart={stop}>\r\n                    <img id='yarnPhone' src={FocusIcon} height={TITLE_HEIGHT} width={TITLE_HEIGHT} style={{transform:'scale(1.2)'}} alt=\"\"/>\r\n                </div>\r\n              </Tooltip>\r\n              <Tooltip placement=\"right\" title={showMenu ? t('ctKick') : ''}>\r\n              <div className={classes.kickIcon} onMouseUp={onUserKick}\r\n                  onTouchStart={stop}>\r\n                    <img id='yarnPhone' src={KickIcon} height={TITLE_HEIGHT} width={TITLE_HEIGHT} style={{transform:'scale(1.2)'}} alt=\"\"/>\r\n                </div>\r\n              </Tooltip>\r\n            <div className={classes.dashedCircle}></div>\r\n            </div>\r\n          </Zoom>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  )\r\n}\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAAEBUlEQVR4nO2cvWsUQRiHn4iFsVIQVBDEDxArFSwUAhGsBS3kxEYxFtpFrPwLYqH/wVnYiFZqp12CESwEUwg2fgUEbSSpEsXgWswcWTeby9fu7fwuvweW292bfefNPZndnWVmB7Isw2iypekEzPqxPGEsTxjLE8byhLE8YSxPGMsTxvKEsTxhLE8YyxPG8oSxPGEsTxjLE8byhLE8YSxPGMsTxvKEsTxhLE8YyxPG8oSxPGG2Np1ADQwBJ4HzuX3PgLfAZCMZ1cRAH81VaAOXgcEuZeaBR8D1nmRUM/1w2hwF/gAjdBdH/H4klh+tOa/aUW95bYKM9fIA4Vao3PI2Ko54fLuCXBpBteW1gMcVxrsEPKkwXk9QlTfHyte3tTAPbK8wXk9QPG22qVYcMZ7c6VOx5X0H9tQQ9wewt4a4taEor86EB2qMXTlqp826+2ZSfT81eSaH5QljecJYnjCWJ4yavN1NJ5ASavJON51ASqjJMzksTxjLE8byhLE8YdTkPWs6gZRIWd5+wnCHJmnFPJIkVXljwFfCOJU5mvkB52L9X2I+yZGqvBu59UHgQo/rH2NxqMVAIZ9kSFVekeEe1yfxJEdF3s6mE0iRVOX9LGzvi59va673afw8UthfzCcJUpX3rbDduWGZBBZqqnMemI7ru1bIJwlSlVfsz20lTN0CeF1TnS/jZ4ulU9+S7F+mPPTvL/8PxZsCThBa4ReqHaaXAQcILe8jcKjwXZL/5EkmFflc2D5GaH3TwPOK63oe4w4BB1fIIxlSbnlDwKvCvvyo5qpGTn8CDneJmewklJRb3iThh82zh8U5BaeA2Q3WMQucjettloqbJVFxkLY8gKsl+0YII5unCf2/qXXGnorHTxNuUq6VlDm3zti9Icuy1JfxbCl/sywby5UZzbJspqRcGTOxfOfYsRivyIsE/vauS8rXvDwzwI6S/RPAmdz2EHCbcErdltv/C3gD3Of/N0KMU/7oTWLGkIq8/cAHyuflLQD3gDtriNcGrlD+KpN54CiLHfZkUZEH3QVCkPgeeEG4nuVvNFrAceAioSuwXB9RRhxoyevwjiCiavJdBglSv9ss4wRwi+qecS4AdxETB5otL89q3nq0HAvAQ4Tfw6Iur0MLuEl4hFZ2V9phljC84i4Jd75XS7/IK1J81UexS9EXKF7zVsPvphPoBf0qb1NgecJYnjCWJ4zlCWN5wqjLGycMECouxY768DLlxnuUZy2od9KrSF7qZXF51FvepkZd3kTDxzeK+mlzU6Pe8jY1lieM5QljecJYnjCWJ4zlCWN5wlieMJYnjOUJY3nCWJ4wlieM5QljecJYnjCWJ4zlCWN5wlieMJYnjOUJY3nCWJ4wlifMP99fG1KrceiIAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAACrElEQVR4nO3c4W3aQByG8TdVv6cblEzQjOARukE7QjZoM0mSDZoJ6hHoBmQDmMD9YE5UKYmxMf7fc/c+EopAEXfwk23gDFdd18kx+xA9ATc944EzHjjjgTMeOOOBMx4444EzHjjjgTMeOOOBMx4444EzHjjjgTMeOOOBMx4444EzHjjjgTMeOOOBMx4444EzHjjjgTMeOOOBywWvkfQoaSOpm3BpB+5/JWk78b7fuzSTH/EMfYwcfN93SQ8XHmOj/oluJV1feKzFit7ybnV5uNRaPeBuofEuXjTe3cLjFQUYjdcEjFkMYPQx7/OR217Uv3gZ02bk/yfAVuBjYDTesTaSfi4wDh4wercZHXoXWjueBAY0Hjjj9e81WwGPe7XjYeGkuvHQcFK9eENwfyTd7P9mW414p8A1OnyYnS1gbXinwm3317fKGLAmvLFwqWwBa8GbCpfKErAGvHPhUtkBlo43F1wqK8CS8YbgXjQOLpUNYI5LQnM0BLeT9FXj4VIJMLQS8U6Ba9SvJpzTVPjZKm23uRRcFpWG915FwUnl4b21sFocnFQenvQ/YJFwUpl40gEwvR0oDk4q89Vmaq3+OwrFVjLenK3Uf6fidY8af87obBnvtFaSfhy5vVUgXqnHvCoyHjjjgTMeOOOBMx4444EzHjjjgTMeOOOBy/GzzU/K4OSeV91GT+BYOeJ9kfQ7ehKEonebz8Hjn1voIm803q/g8c/pScGn/111XRc5vtQvaH6LnsTIdjr8kmBY0Vue1K9Q34vzUxpPygBOymPL+7cmegIDrZUBWio3PDeiHHabbmLGA2c8cMYDZzxwxgNnPHDGA2c8cMYDZzxwxgNnPHDGA2c8cMYDZzxwxgNnPHDGA2c8cMYDZzxwxgNnPHDGA2c8cMYDZzxwxgP3F01fmrDtI5K3AAAAAElFTkSuQmCC\"","import { ShareDialog } from '@components/footer/share/ShareDialog'\r\nimport {BMProps, MapProps as BP} from '@components/utils'\r\nimport { Tooltip } from '@material-ui/core'\r\nimport {makeStyles} from '@material-ui/core/styles'\r\nimport {PARTICIPANT_SIZE} from '@models/Participant'\r\nimport {\r\n  crossProduct, extractRotation, extractScaleX,\r\n  isSmartphone,\r\n  radian2Degree, rotate90ClockWise, rotateVector2D, transformPoint2D, transfromAt, vectorLength,\r\n} from '@models/utils'\r\nimport {addV2, mulV2, normV, subV2} from '@models/utils/coordinates'\r\nimport {SCALE_LIMIT} from '@stores/Map'\r\nimport { TITLE_HEIGHT } from '@stores/sharedContents/SharedContents'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React, {useEffect, useRef, useState} from 'react'\r\nimport ResizeObserver from 'react-resize-observer'\r\nimport {useGesture} from 'react-use-gesture'\r\n\r\nimport UploadShare from '@images/whoo-screen_btn-add-63.png'\r\nimport { getContentDeleteDialogStatus, getContentDialogStatus, getContentLocked, getContextMenuStatus, /* isContentHandlerOn, */ isOnContentStatus, MouseOrTouch } from '../Share/RndContent'\r\nimport {t} from '@models/locales'\r\nimport {isDialogOpen} from \"@components/footer/share/ShareDialog\"\r\nimport { getAvatarToolStatus, getOnLocalUser, getUserContextMenu } from '../Participant/LocalParticipant'\r\nimport { getOnRemote } from '../Participant/RemoteParticipant'\r\n\r\n//  utility\r\nfunction limitScale(currentScale: number, scale: number): number {\r\n  const targetScale = currentScale * scale\r\n\r\n  if (targetScale > SCALE_LIMIT.maxScale) {\r\n    return SCALE_LIMIT.maxScale / currentScale\r\n  }\r\n\r\n  if (targetScale < SCALE_LIMIT.minScale) {\r\n    return SCALE_LIMIT.minScale / currentScale\r\n  }\r\n\r\n  return scale\r\n}\r\n\r\ninterface StyleProps {\r\n  matrix: DOMMatrixReadOnly,\r\n  props: BMProps,\r\n  mem:BaseMember,\r\n}\r\n\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    position: 'absolute',\r\n    width: '100%',\r\n    height: '100%',\r\n    top: 0,\r\n    left: 0,\r\n    userDrag: 'none',\r\n    userSelect: 'none',\r\n    overflow: 'hidden',\r\n  },\r\n  center:{\r\n    position: 'absolute',\r\n    margin: 'auto',\r\n    left:0, right:0, top:0, bottom:0,\r\n    width:0, height:0,\r\n  },\r\n  transform: (props: StyleProps) => ({\r\n    position: 'absolute',\r\n    width:0, height:0,\r\n    transform: props.matrix.toString(),\r\n  }),\r\n  hideMenuContainer: (props:StyleProps) => ({\r\n    display: 'flex',\r\n    position: 'relative',\r\n    width: 350,\r\n    height: 250,\r\n    overflow: 'hidden',\r\n    userSelect: 'none',\r\n    userDrag: 'none',\r\n    //top: (props.mem.zoomY) - 125,\r\n    //left: (props.mem.zoomX) - 170,\r\n    bottom: 'auto',\r\n    transform: 'scale(0)',\r\n    backgroundColor: 'transparent',\r\n    transition: '0s ease-out',\r\n    cursor: 'default',\r\n  }),\r\n  showMenuContainer: (props:StyleProps) => ({\r\n    display: 'flex',\r\n    position: 'relative',\r\n    width: 350,\r\n    height: 250,\r\n    overflow: 'hidden',\r\n    userSelect: 'none',\r\n    userDrag: 'none',\r\n    top: (props.mem.zoomY) - 125,\r\n    left: isSmartphone() ? (props.mem.zoomX) - 160 : (props.mem.zoomX) - 170,\r\n    bottom: 'auto',\r\n    transform: isSmartphone() ? 'scale(2.8)' : 'scale(1.2)',\r\n    backgroundColor: 'transparent',\r\n    transition: '0.3s ease-out',\r\n    transitionDelay: '0.1s',\r\n    cursor: 'default',\r\n  }),\r\n\r\n  dashedCircle: (props: StyleProps) => ({\r\n    position: 'relative',\r\n    width:200,\r\n    height:200,\r\n    borderWidth:2,\r\n    borderStyle: 'solid',\r\n    borderColor:'#9e886c',\r\n    borderRadius:'50%',\r\n    opacity: 0.4,\r\n    /* top: 20,\r\n    left: -20, */\r\n    top: 25,\r\n    left: 65,\r\n    background: 'radial-gradient(#ffffff, #ffffff, #ffffff, #9e886c, #9e886c)',\r\n    zIndex: -9999,\r\n  }),\r\n\r\n  uploadZone: (props:StyleProps) => ({\r\n      display: 'block',\r\n      height: TITLE_HEIGHT,\r\n      position:'absolute',\r\n      textAlign: 'center',\r\n      top: 180,\r\n      left: 145,\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      background: '#9e886c',\r\n      ...buttonStyle\r\n    }),\r\n\r\n    PingLocation: (props:StyleProps) => ({\r\n      display: 'block',\r\n      height: TITLE_HEIGHT,\r\n      position:'absolute',\r\n      textAlign: 'center',\r\n      top: (props.mem.pingY - 25),\r\n      left: (props.mem.pingX - 17),\r\n      //transform: `rotate(${props.props.stores.map.rotation}deg)`,\r\n      whiteSpace: 'pre',\r\n    }),\r\n\r\n    PingLocationHide: (props:StyleProps) => ({\r\n      display: 'none',\r\n      height: TITLE_HEIGHT,\r\n      position:'absolute',\r\n      textAlign: 'center',\r\n      top: (props.mem.pingY - 25),\r\n      left: (props.mem.pingX - 17),\r\n      //transform: `rotate(${props.props.stores.map.rotation}deg)`,\r\n      whiteSpace: 'pre',\r\n    }),\r\n})\r\n\r\nconst buttonStyle = {\r\n  '&': {\r\n    margin: '5px',\r\n    borderRadius: '50%',\r\n    width: '35px',\r\n    height: '35px',\r\n    padding: '3px',\r\n  },\r\n\r\n  '&:hover': {\r\n    backgroundColor: 'black', //'rosybrown',\r\n    margin: '5px',\r\n    padding: '3px',\r\n    borderRadius: '50%',\r\n  },\r\n  '&:active': {\r\n    margin: '5px',\r\n    padding: '3px',\r\n    borderRadius: '50%',\r\n  },\r\n}\r\n\r\ntype MapProps = React.PropsWithChildren<BP>\r\n\r\nclass BaseMember{\r\n  prebThirdPersonView = false\r\n  mouseDown = false\r\n  dragging = false\r\n\r\n  // New values\r\n  upTime = 0\r\n  downTime = 0\r\n  downXpos = 0\r\n  downYpos = 0\r\n  upXpos = 0\r\n  upYpos = 0\r\n  contentX = 0\r\n  contentY = 0\r\n  zoomX = 0\r\n  zoomY = 0\r\n  moveX = 0\r\n  moveY = 0\r\n  clickStatus = ''\r\n  userAngle = 0\r\n  clickEnter = false\r\n  pingX = 0\r\n  pingY = 0\r\n  hidePinIcon = 0\r\n  touchStart = 0\r\n  touchEnd = 0\r\n}\r\n\r\nlet _menuCanvas = false\r\nexport function getMenuStatus():boolean {\r\n  return _menuCanvas\r\n}\r\n\r\nlet pingEnable:boolean = false\r\nexport function getBasePingStatus():boolean {\r\n  return pingEnable\r\n}\r\n\r\nlet canvasMoved = false\r\nexport function isCanvasMoved() : boolean {\r\n  return canvasMoved\r\n}\r\n\r\n// For Double Touch\r\n let dblTouchTapCount = 0\r\n\r\nexport const Base: React.FC<MapProps> = (props: MapProps) => {\r\n  const {map, participants} = props.stores\r\n  const matrix = useObserver(() => map.matrix)\r\n  const container = useRef<HTMLDivElement>(null)\r\n  const outer = useRef<HTMLDivElement>(null)\r\n  function offset():[number, number] {\r\n    return map.offset\r\n  }\r\n  const thirdPersonView = useObserver(() => participants.local.thirdPersonView)\r\n  const memRef = useRef<BaseMember>(new BaseMember())\r\n  const mem = memRef.current\r\n\r\n  // To checkout Content edit mode\r\n  //const isContentEdit = useObserver(() => isContentHandlerOn())\r\n\r\n  const center = transformPoint2D(matrix, participants.local.pose.position)\r\n  if (thirdPersonView !== mem.prebThirdPersonView) {\r\n    mem.prebThirdPersonView = thirdPersonView\r\n    if (thirdPersonView) {\r\n      const mapRot = radian2Degree(extractRotation(matrix))\r\n      if (mapRot) {\r\n        const newMatrix = rotateMap(-mapRot, center)\r\n        map.setCommittedMatrix(newMatrix)\r\n      }\r\n    }else {\r\n      const avatarRot = participants.local.pose.orientation\r\n      const mapRot = radian2Degree(extractRotation(matrix))\r\n      if (avatarRot + mapRot) {\r\n        const newMatrix = rotateMap(-(avatarRot + mapRot), center)\r\n        map.setCommittedMatrix(newMatrix)\r\n      }\r\n    }\r\n  }\r\n\r\n  //  utility\r\n  function rotateMap(degree:number, center:[number, number]) {\r\n    const changeMatrix = (new DOMMatrix()).rotateSelf(0, 0, degree)\r\n    const newMatrix = transfromAt(center, changeMatrix, matrix)\r\n    map.setMatrix(newMatrix)\r\n\r\n    return newMatrix\r\n  }\r\n\r\n  //  Mouse and touch operations ----------------------------------------------\r\n  const MOUSE_LEFT = 1\r\n  const MOUSE_RIGHT = 2\r\n\r\n  //  zoom by scrollwheel\r\n  function wheelHandler(event:React.WheelEvent) {\r\n    if (!event.ctrlKey) {\r\n      /*  //  translate map\r\n      const diff = mulV2(0.2, rotateVector2D(matrix.inverse(), [event.deltaX, event.deltaY]))\r\n      const newMatrix = matrix.translate(-diff[0], -diff[1])\r\n      map.setMatrix(newMatrix)*/\r\n\r\n      //  zoom map\r\n      let scale = Math.pow(1.2, event.deltaY / 100)\r\n      scale = limitScale(extractScaleX(map.matrix), scale)\r\n      //  console.log(`zoom scale:${scale}`)\r\n      if (scale === 1){\r\n        return\r\n      }\r\n\r\n      //  console.log(`Wheel: ${movement}  scale=${scale}`)\r\n      const newMatrix = map.matrix.scale(scale, scale, 1,\r\n        ...transformPoint2D(map.matrix.inverse(), map.mouse))\r\n      map.setMatrix(newMatrix)\r\n      map.setCommittedMatrix(newMatrix)\r\n    }\r\n  }\r\n\r\n  function checkContentsInEdit():boolean {\r\n    let isEdit:boolean = false\r\n    if(props.stores.contents.all.length > 0) {\r\n      for(let i:number=0; i<props.stores.contents.all.length; i++) {\r\n        if(props.stores.contents.all[i].scaleRotateToggle) {\r\n          isEdit = true\r\n        }\r\n      }\r\n    }\r\n    return isEdit\r\n  }\r\n\r\n  function ExitAllFromEditMode() {\r\n    if(props.stores.contents.all.length > 0) {\r\n      for(let i:number=0; i<props.stores.contents.all.length; i++) {\r\n        if(props.stores.contents.all[i].scaleRotateToggle) {\r\n          props.stores.contents.all[i].scaleRotateToggle = !props.stores.contents.all[i].scaleRotateToggle\r\n        }\r\n        if(props.stores.contents.all[i].pinned === false) {\r\n          props.stores.contents.all[i].pinned = true\r\n        }\r\n        props.stores.contents.updateByLocal(props.stores.contents.all[i])\r\n      }\r\n    }\r\n  }\r\n\r\n  function moveParticipant(move: boolean, givenTarget?:[number,number]) {\r\n    const local = participants.local\r\n    let target = givenTarget\r\n    if (!target){ target = map.mouseOnMap }\r\n    const diff = subV2(target, local.pose.position)\r\n    if (normV(diff) > (givenTarget ? PARTICIPANT_SIZE*2 : PARTICIPANT_SIZE / 2)) {\r\n      const dir = mulV2(20 / normV(diff), diff)\r\n      local.pose.orientation = Math.atan2(dir[0], -dir[1]) * 180 / Math.PI\r\n      if (move) {\r\n        local.pose.position = addV2(local.pose.position, dir)\r\n      }\r\n      local.savePhysicsToStorage(false)\r\n    }\r\n  }\r\n  /*\r\n  function moveParticipantPeriodically(move: boolean, target?:[number,number]) {\r\n    moveParticipant(move, target)\r\n    const TIMER_INTERVAL = move ? 33 : 300\r\n    setTimeout(() => {\r\n      if (mem.mouseDown) {\r\n        moveParticipantPeriodically(true)\r\n      }\r\n    }, TIMER_INTERVAL) //  move to mouse position\r\n  }*/\r\n\r\n  function hindleClickStatus() {\r\n    //console.log(mem.clickStatus, \" onClick\")\r\n\r\n    /* mem.clickStatus = ''\r\n    participants.local.pingIcon = false\r\n    participants.local.pingX = 0\r\n    participants.local.pingY = 0\r\n    //participants.local.cursorMove = false\r\n    pingEnable = false\r\n    setPingLocation(false) */\r\n\r\n\r\n\r\n\r\n    /* let _contentDialogStatus:boolean = getContentDialogStatus() */\r\n\r\n    //if(_contentDeleteStatus) {return}\r\n\r\n\r\n\r\n    /* if(_contentDialogStatus) {return}\r\n */\r\n    //let _contentDeleteDeleteDialogOpen = getContentDeleteDialogStatus()\r\n\r\n    //if(_contentDeleteDeleteDialogOpen) {return}\r\n\r\n\r\n\r\n\r\n\r\n\r\n    if(mem.clickStatus === 'single' || mem.clickStatus === '') {\r\n      if(mem.clickEnter) {return}\r\n      //if(pingLocation) {return}\r\n\r\n      if(participants.local.pingIcon) {return}\r\n\r\n\r\n      if(pingLocation) {}\r\n\r\n      // Removing all edit mode\r\n      let isEdit = checkContentsInEdit()\r\n      if(isEdit) {\r\n        //console.log(\"Exiting\")\r\n        ExitAllFromEditMode()\r\n        return\r\n      }\r\n\r\n\r\n      pingEnable = false\r\n\r\n      participants.local.pingIcon = false\r\n      participants.local.pingX = 0\r\n      participants.local.pingY = 0\r\n      //participants.local.cursorMove = false\r\n      setPingLocation(false)\r\n\r\n      const moveTimer = setTimeout(() => {\r\n        clearTimeout(moveTimer)\r\n        function moveParticipant(move: boolean) {\r\n          //const local = participants.local\r\n          //const diff = subV2(map.mouseOnMap, local.pose.position)\r\n          const diff = subV2([mem.moveX, mem.moveY], props.stores.participants.local.pose.position)\r\n          if (normV(diff) > PARTICIPANT_SIZE / 10) {\r\n            const dir = mulV2(normV(diff)/5 / normV(diff), diff)\r\n            props.stores.participants.local.pose.orientation = Math.atan2(dir[0], -dir[1]) * 180 / Math.PI\r\n            if (move) {\r\n              props.stores.participants.local.pose.position = addV2(props.stores.participants.local.pose.position, dir)\r\n            }\r\n            props.stores.participants.local.savePhysicsToStorage(false)\r\n            const TIMER_INTERVAL = move ? 0 : 0\r\n              setTimeout(() => { moveParticipant(true) }, TIMER_INTERVAL)\r\n          }\r\n        }\r\n        moveParticipant(false)\r\n      }, 0)\r\n    } else if(mem.clickStatus === 'double') {\r\n      //console.log('double click action goes here and play sound')\r\n      //mem.userAngle = props.stores.participants.loca\r\n\r\n      window.clearTimeout(mem.hidePinIcon)\r\n\r\n      /////////////////////////////\r\n      //if(pingLocation) {return}\r\n     // if(getRndPingStatus()) {return}\r\n      ////////////////////////////////\r\n      participants.local.pingX = mem.pingX\r\n      participants.local.pingY = mem.pingY\r\n      participants.local.pingIcon = true\r\n      //participants.local.cursorMove = true\r\n\r\n      //let audio = new Audio(\"sound/beep.mp3\")\r\n      //audio.play()\r\n\r\n      pingEnable = true\r\n      setPingLocation(true)\r\n      mem.hidePinIcon = window.setTimeout(() =>{\r\n        window.clearTimeout(mem.hidePinIcon)\r\n        //if(!pingLocation) {return}\r\n        mem.clickStatus = ''\r\n        participants.local.pingIcon = false\r\n        participants.local.pingX = 0\r\n        participants.local.pingY = 0\r\n        //participants.local.cursorMove = false\r\n        pingEnable = false\r\n        setPingLocation(false)\r\n      }, 3000)\r\n    }\r\n  }\r\n\r\n  const bind = useGesture(\r\n    {\r\n      onDragStart: ({buttons, xy}) => {\r\n        document.body.focus()\r\n        mem.dragging = true\r\n        mem.mouseDown = true\r\n\r\n        //console.log('Base StartDrag:')\r\n\r\n       mem.downTime = new Date().getSeconds()\r\n        mem.moveX = map.mouseOnMap[0]\r\n        mem.moveY = map.mouseOnMap[1]\r\n\r\n\r\n\r\n        let itemLocked = getContentLocked()\r\n        let _onContent = isOnContentStatus()\r\n        let _onRemoteUser = getOnRemote()\r\n        let _dialogStatus:boolean = isDialogOpen()\r\n        let _contentDialogStatus:boolean = getContentDialogStatus()\r\n        let _focusLocalUser:boolean = getOnLocalUser()\r\n        let _avatarToolStatus = getAvatarToolStatus()\r\n\r\n        let _contentDeleteDeleteDialogOpen = getContentDeleteDialogStatus()\r\n        if(_contentDeleteDeleteDialogOpen) {return}\r\n\r\n        if(_contentDialogStatus) {return}\r\n        if(_dialogStatus) {return}\r\n        if(showUploadOption) {return}\r\n        if(_onContent) {return}\r\n        if(_onRemoteUser) {return}\r\n        if(_focusLocalUser) {return}\r\n        if(_avatarToolStatus) {return}\r\n\r\n\r\n\r\n        /* let itemLocked = getContentLocked()\r\n        let _onContent = isOnContentStatus()\r\n        //let _onRemoteUser = getOnRemote()\r\n        //console.log(\"locked -- \", itemLocked)\r\n        let _contentDeleteDeleteDialogOpen = getContentDeleteDialogStatus()\r\n        //console.log(_onContent, \" >>> _onContent\")\r\n\r\n        let _dialogStatus:boolean = isDialogOpen()\r\n        let _contentDialogStatus:boolean = getContentDialogStatus()\r\n        let _focusLocalUser:boolean = getOnLocalUser()\r\n        let _avatarToolStatus = getAvatarToolStatus()\r\n\r\n        let isUserContentOpen = getUserContextMenu()\r\n        if(isUserContentOpen) {return}\r\n        if(_contentDialogStatus) {return}\r\n        if(_dialogStatus) {return}\r\n        if(showUploadOption) {return}\r\n        if(_onContent) {return}\r\n        //if(_onRemoteUser) {return}\r\n        if(_focusLocalUser) {return}\r\n        if(_avatarToolStatus) {return}\r\n\r\n        if(_contentDeleteDeleteDialogOpen) {return} */\r\n\r\n        /* let _avatarToolStatus = getAvatarToolStatus()\r\n        let _focusLocalUser:boolean = getOnLocalUser()\r\n        let _dialogStatus:boolean = isDialogOpen()\r\n\r\n        if(_dialogStatus) {return}\r\n        if(_focusLocalUser) {return}\r\n\r\n        if(showUploadOption) {return}\r\n        if(showMenu) {return}\r\n        if(_avatarToolStatus) {return} */\r\n\r\n        if (buttons === MOUSE_LEFT || buttons === 0) {\r\n          mem.downTime = new Date().getSeconds()\r\n          mem.downXpos = xy[0]\r\n          mem.downYpos = xy[1]\r\n\r\n          ////////////////////////////////////////////////\r\n          //const local = participants.local\r\n          const remotes = Array.from(participants.remote.keys()).filter(key => key !== participants.localId)\r\n          for (const [i] of remotes.entries()) {\r\n            let remoteX = Number(participants.remote.get(remotes[i])?.pose.position[0])\r\n            let remoteY = Number(participants.remote.get(remotes[i])?.pose.position[1])\r\n            let mouseX = Number(map.mouseOnMap[0])\r\n            let mouseY = Number(map.mouseOnMap[1])\r\n            if(mouseX >= (remoteX-30) && mouseX <= (remoteX+30) && mouseY >= (remoteY-30) && mouseY <= (remoteY+30)) {\r\n              return\r\n            }\r\n          }\r\n          ////////////////////////////////////////////////\r\n          const downTimer = setTimeout(() => {\r\n            clearTimeout(downTimer)\r\n            if(itemLocked) {return}\r\n\r\n            if(mem.mouseDown && showUploadOption === false && canvasMoved === false) {\r\n              //console.log(\"Open Context Menu\")\r\n              mem.zoomX = xy[0]\r\n              mem.zoomY = xy[1]\r\n              mem.contentX = map.mouseOnMap[0]\r\n              mem.contentY = map.mouseOnMap[1]\r\n              _menuCanvas = true\r\n              setShowMenu(true)\r\n              //setShowUploadOption(true)\r\n              setShowUploadOption(false)\r\n            }\r\n          }, 500)\r\n\r\n          //  move participant to mouse position\r\n          //moveParticipantPeriodically(false)  //  inital rotation.\r\n        }\r\n      },\r\n      onDrag: ({down, delta, xy, buttons}) => {\r\n        if (delta[0] || delta[1]) { mem.mouseDown = false }\r\n        if (delta[0] || delta[1]) {\r\n          mem.mouseDown = false\r\n          //if(showMenu || isContentEdit) {\r\n            //canvasMoved = false\r\n          //} else {\r\n            canvasMoved = true\r\n        //}\r\n        }\r\n\r\n        let _menuStatus:boolean = getContextMenuStatus()\r\n        let _dialogStatus:boolean = isDialogOpen()\r\n        let _contentDialogStatus:boolean = getContentDialogStatus()\r\n        let _focusLocalUser:boolean = getOnLocalUser()\r\n        let _onRemoteUser = getOnRemote()\r\n        let _avatarToolStatus = getAvatarToolStatus()\r\n        if(_contentDialogStatus) {return}\r\n        if(_dialogStatus) {return}\r\n        //let _contentDeleteDeleteDialogOpen = getContentDeleteDialogStatus()\r\n        if(_menuStatus) {return}\r\n        if(showMenu) {return}\r\n        if(_focusLocalUser) {return}\r\n        if(_onRemoteUser) {return}\r\n        if(_avatarToolStatus) {return}\r\n\r\n        /*\r\n        //let _menuStatus:boolean = getContextMenuStatus()\r\n        let _dialogStatus:boolean = isDialogOpen()\r\n        //let _contentDialogStatus:boolean = getContentDialogStatus()\r\n        let _focusLocalUser:boolean = getOnLocalUser()\r\n        //let _onRemoteUser = getOnRemote()\r\n        let _avatarToolStatus = getAvatarToolStatus()\r\n\r\n        //if(_contentDialogStatus) {return}\r\n        //let _contentDeleteDeleteDialogOpen = getContentDeleteDialogStatus()\r\n\r\n        let isUserContentOpen = getUserContextMenu()\r\n        if(isUserContentOpen) {return}\r\n\r\n        //if(_menuStatus) {return}\r\n        if(showMenu) {return}\r\n        if(_focusLocalUser) {return}\r\n        //if(_onRemoteUser) {return}\r\n        if(_avatarToolStatus) {return} */\r\n\r\n        /* let _avatarToolStatus = getAvatarToolStatus()\r\n        let _focusLocalUser:boolean = getOnLocalUser()\r\n        let _dialogStatus:boolean = isDialogOpen()\r\n\r\n        if(_dialogStatus) {return}\r\n        if(_focusLocalUser) {return}\r\n        if(showUploadOption) {return}\r\n        if(showMenu) {return}\r\n        if(_avatarToolStatus) {return} */\r\n\r\n        //  if (map.keyInputUsers.size) { return }\r\n        if (mem.dragging && down && outer.current) {\r\n          if (!thirdPersonView && buttons === MOUSE_RIGHT) {  // right mouse drag - rotate map\r\n            const center = transformPoint2D(matrix, participants.local.pose.position)\r\n            const target:[number, number] = addV2(xy, offset())\r\n            const radius1 = subV2(target, center)\r\n            const radius2 = subV2(radius1, delta)\r\n\r\n            const cosAngle = crossProduct(radius1, radius2) / (vectorLength(radius1) * vectorLength(radius2))\r\n            const flag = crossProduct(rotate90ClockWise(radius1), delta) > 0 ? -1 : 1\r\n            const angle = Math.acos(cosAngle) * flag\r\n            if (isNaN(angle)) {  // due to accuracy, angle might be NaN when cosAngle is larger than 1\r\n              return  // no need to update matrix\r\n            }\r\n\r\n            const newMatrix = rotateMap(radian2Degree(angle), center)\r\n            participants.local.pose.orientation = -radian2Degree(extractRotation(newMatrix))\r\n          } else {\r\n            // left mouse drag or touch screen drag - translate map\r\n            const diff = rotateVector2D(matrix.inverse(), delta)\r\n            const newMatrix = matrix.translate(...diff)\r\n            map.setMatrix(newMatrix)\r\n            //  rotate and direct participant to the mouse position.\r\n            if (delta[0] || delta[1]){\r\n              moveParticipant(false, map.centerOnMap)\r\n            }\r\n            //console.log('Base onDrag:', delta)\r\n          }\r\n        }\r\n      },\r\n      onDragEnd: ({event, xy}) => {\r\n        mem.upXpos = xy[0]\r\n        mem.upYpos = xy[1]\r\n\r\n        // setInitVars\r\n        /* if(showMenu || isContentEdit) {\r\n          canvasMoved = false\r\n        } else {\r\n          canvasMoved = true\r\n        } */\r\n\r\n        mem.upTime = new Date().getSeconds()\r\n        let timeDiff = mem.upTime - mem.downTime\r\n\r\n        let _dialogStatus:boolean = isDialogOpen()\r\n        let _contentDialogStatus:boolean = getContentDialogStatus()\r\n        let _avatarToolStatus = getAvatarToolStatus()\r\n        let contentContextMenu = getContextMenuStatus()\r\n        let isUserContentOpen = getUserContextMenu()\r\n        let _contentDeleteDeleteDialogOpen = getContentDeleteDialogStatus()\r\n        if(_contentDeleteDeleteDialogOpen) {return}\r\n        if(isUserContentOpen) {return}\r\n        //console.log('function called', _contentDialogStatus, \" --- \", showMenu, \" --- \", _avatarToolStatus)\r\n        if(_contentDialogStatus) {return}\r\n        if(contentContextMenu) {return}\r\n        if(_dialogStatus) {return}\r\n        if(_avatarToolStatus) {return}\r\n\r\n        /*\r\n        //let _contentDialogStatus:boolean = getContentDialogStatus()\r\n        let _dialogStatus:boolean = isDialogOpen()\r\n        //console.log(_dialogStatus, \" dStatus\")\r\n        let _avatarToolStatus = getAvatarToolStatus()\r\n        //let contentContextMenu = getContextMenuStatus()\r\n        //console.log('function called', _contentDialogStatus, \" --- \", showMenu, \" --- \", _avatarToolStatus)\r\n        //if(_contentDialogStatus) {return}\r\n        //if(contentContextMenu) {return}\r\n        let isUserContentOpen = getUserContextMenu()\r\n        if(isUserContentOpen) {return}\r\n        if(_dialogStatus) {return}\r\n        if(_avatarToolStatus) {return}\r\n */\r\n\r\n        /* let _avatarToolStatus = getAvatarToolStatus()\r\n        let _dialogStatus:boolean = isDialogOpen()\r\n        if(_dialogStatus) {return}\r\n        if(_avatarToolStatus) {return} */\r\n\r\n\r\n        if((mem.upXpos >= (mem.downXpos-20) && mem.upXpos <= (mem.downXpos+20) && (mem.upYpos >= (mem.downYpos-20) && mem.upYpos <= (mem.downYpos+20))) && String(Object(event?.target).tagName) === \"DIV\" && timeDiff < 1) {\r\n          //const local = participants.local\r\n          const remotes = Array.from(participants.remote.keys()).filter(key => key !== participants.localId)\r\n          for (const [i] of remotes.entries()) {\r\n            let remoteX = Number(participants.remote.get(remotes[i])?.pose.position[0])\r\n            let remoteY = Number(participants.remote.get(remotes[i])?.pose.position[1])\r\n            let mouseX = Number(map.mouseOnMap[0])\r\n            let mouseY = Number(map.mouseOnMap[1])\r\n            if(mouseX >= (remoteX-30) && mouseX <= (remoteX+30) && mouseY >= (remoteY-30) && mouseY <= (remoteY+30)) {\r\n              return\r\n            }\r\n          }\r\n        }\r\n\r\n        //console.log(event?.detail, \" DETAILS\")\r\n        //////////////////////////////////////////////////////////////\r\n\r\n\r\n        /* const diff = subV2(map.mouseOnMap, participants.local.pose.position)\r\n        const dir = mulV2(normV(diff) / normV(diff), diff)\r\n        console.log(addV2(props.stores.participants.local.pose.position, dir), \" Base \") */\r\n        //console.log(map.mouseOnMap[0], \" Base \", map.mouseOnMap[1])\r\n\r\n        //console.log(participants.local.mouse.position[0] - participants.local.pose.position[0], \" Base F \", participants.local.mouse.position[1]-participants.local.pose.position[1])\r\n\r\n\r\n\r\n        /* if(event?.type === 'touchend') {\r\n          mem.pingX = participants.local.mouse.position[0] - participants.local.pose.position[0]\r\n          mem.pingY = participants.local.mouse.position[1]-participants.local.pose.position[1]\r\n        } */\r\n\r\n        //if(event?.type !== 'touchend') {\r\n          //let _contentDeleteDialog = getContentDeleteDialogStatus()\r\n\r\n\r\n\r\n\r\n\r\n          if (event?.detail === 1) {\r\n            mem.clickStatus = 'single'\r\n          } else if (event?.detail === 2 ) {\r\n            //if(_contentDeleteDialog) {return}\r\n\r\n            mem.clickStatus = \"double\"\r\n            mem.pingX = participants.local.mouse.position[0] - participants.local.pose.position[0]\r\n            mem.pingY = participants.local.mouse.position[1]-participants.local.pose.position[1]\r\n            /* const diff = subV2(map.mouseOnMap, local.pose.position)\r\n            const dir = mulV2(normV(diff)/5 / normV(diff), diff)\r\n            props.stores.participants.local.pose.position = addV2(props.stores.participants.local.pose.position, dir) */\r\n          }\r\n\r\n          mem.clickEnter = true\r\n          const timer = setTimeout(() => {\r\n            clearTimeout(timer);\r\n            if(mem.clickEnter) {\r\n              mem.clickEnter = false\r\n              if(showMenu === false) {\r\n                if(canvasMoved === false) {\r\n                  hindleClickStatus()\r\n                }\r\n              }\r\n            }\r\n            canvasMoved = false\r\n          }, 220)\r\n\r\n        if (matrix.toString() !== map.committedMatrix.toString()) {\r\n          map.setCommittedMatrix(matrix)\r\n          moveParticipant(false, map.centerOnMap)\r\n          //console.log(`Base onDragEnd: (${map.centerOnMap})`)\r\n        }\r\n        mem.dragging = false\r\n        mem.mouseDown = false\r\n\r\n        _menuCanvas = false\r\n        setShowMenu(false)\r\n      },\r\n      onPinch: ({da: [d, a], origin, event, memo}) => {\r\n        if (memo === undefined) {\r\n          return [d, a]\r\n        }\r\n\r\n        const [md, ma] = memo\r\n\r\n        const center = addV2(origin as [number, number], offset())\r\n\r\n        const MIN_D = 10\r\n        let scale = d > MIN_D ? d / md : d <  -MIN_D ? md / d : (1 + (d - md) / MIN_D)\r\n        //console.log(`Pinch: da:${[d, a]} origin:${origin}  memo:${memo}  scale:${scale}`)\r\n\r\n        scale = limitScale(extractScaleX(matrix), scale)\r\n\r\n        const changeMatrix = thirdPersonView ?\r\n          (new DOMMatrix()).scaleSelf(scale, scale, 1) :\r\n          (new DOMMatrix()).scaleSelf(scale, scale, 1).rotateSelf(0, 0, a - ma)\r\n\r\n        const newMatrix = transfromAt(center, changeMatrix, matrix)\r\n        map.setMatrix(newMatrix)\r\n\r\n        if (!thirdPersonView) {\r\n          participants.local.pose.orientation = -radian2Degree(extractRotation(newMatrix))\r\n        }\r\n\r\n        return [d, a]\r\n      },\r\n      onPinchEnd: () => map.setCommittedMatrix(matrix),\r\n      onMove:({xy}) => {\r\n        map.setMouse(xy)\r\n        if (participants.local.mouse.position[0] !== map.mouseOnMap[0]\r\n          || participants.local.mouse.position[1] !== map.mouseOnMap[1]){\r\n          participants.local.mouse.position = Object.assign({}, map.mouseOnMap)\r\n        }\r\n      },\r\n\r\n      /*\r\n      onTouchStart:(ev) => {\r\n        map.setMouse([ev.touches[0].clientX, ev.touches[0].clientY])\r\n        participants.local.mouse.position = Object.assign({}, map.mouseOnMap)\r\n      },\r\n      */\r\n      onTouchStart:(ev) => {\r\n        mem.zoomX = ev.touches[0].clientX\r\n        mem.zoomY = ev.touches[0].clientY\r\n        map.setMouse([ev.touches[0].clientX, ev.touches[0].clientY])\r\n        participants.local.mouse.position = Object.assign({}, map.mouseOnMap)\r\n      },\r\n\r\n      onTouchEnd:(e) => {\r\n        var changedTouch = e.changedTouches[0];\r\n        var elem = document.elementFromPoint(changedTouch.clientX, changedTouch.clientY);\r\n        dblTouchTapCount ++\r\n        //if(_contentDeleteDialog) {return}\r\n        const dblClick = setTimeout(function () {\r\n          clearTimeout(dblClick)\r\n          if(dblTouchTapCount === 2) {\r\n              mem.clickStatus = \"double\"\r\n              mem.pingX = participants.local.mouse.position[0] - participants.local.pose.position[0]\r\n              mem.pingY = participants.local.mouse.position[1]-participants.local.pose.position[1]\r\n          } else if(dblTouchTapCount === 1) {\r\n          }\r\n          dblTouchTapCount = 0\r\n        }, 250)\r\n        if(elem?.nodeName === \"IMG\" && elem?.id === \"menuUpload\") {\r\n          setShowUploadOption(true)\r\n          setShowMenu(false)\r\n        }\r\n      }\r\n    },\r\n    {\r\n      eventOptions:{passive:false}, //  This prevents default zoom by browser when pinch.\r\n    },\r\n  )\r\n\r\n  //  setClientRect of the outer.\r\n  useEffect(\r\n    () => {\r\n      onResizeOuter()\r\n    },\r\n    // eslint-disable-next-line  react-hooks/exhaustive-deps\r\n    [],\r\n  )\r\n\r\n  // Prevent browser's zoom\r\n  useEffect(\r\n    () => {\r\n      function topWindowHandler(event:WheelEvent) {\r\n        //console.log(event)\r\n        if (event.ctrlKey) {\r\n          if (window.visualViewport && window.visualViewport.scale > 1){\r\n            if (event.deltaY < 0){\r\n              event.preventDefault()\r\n              //  console.log('prevent', event.deltaY)\r\n            }else{\r\n              //  console.log('through', event.deltaY)\r\n            }\r\n          }else{\r\n            event.preventDefault()\r\n          }\r\n          //  console.log('CTRL + mouse wheel = zoom prevented.', event)\r\n        }\r\n      }\r\n\r\n\r\n      window.document.body.addEventListener('wheel', topWindowHandler, {passive: false})\r\n\r\n      return () => {\r\n        window.document.body.removeEventListener('wheel', topWindowHandler)\r\n      }\r\n    },\r\n    [],\r\n  )\r\n  /*  //  This has no effect for iframe and other cases can be handled by onMove. So this is useless\r\n  //  preview mouse move on outer\r\n  useEffect(\r\n    () => {\r\n      function handler(ev:MouseEvent) {\r\n        map.setMouse([ev.clientX, ev.clientY])\r\n      }\r\n      if (outer.current) {\r\n        outer.current.addEventListener('mousemove', handler, {capture:true})\r\n      }\r\n\r\n      return () => {\r\n        if (outer.current) {\r\n          outer.current.removeEventListener('mousemove', handler)\r\n        }\r\n      }\r\n    },\r\n    [outer])\r\n  */\r\n  //  Event handlers when use scroll ----------------------------------------------\r\n  //  Move to center when root div is created.\r\n  /*\r\n  useEffect(\r\n    () => {\r\n      if (outer.current) {\r\n        const elem = outer.current\r\n        console.log('useEffect[outer] called')\r\n        elem.scrollTo((MAP_SIZE - elem.clientWidth) * HALF, (MAP_SIZE - elem.clientHeight) *  HALF)\r\n      }\r\n    },\r\n    [outer],\r\n  )\r\n  if (!showScrollbar) {\r\n    const elem = outer.current\r\n    if (elem) {\r\n      elem.scrollTo((MAP_SIZE - elem.clientWidth) * HALF, (MAP_SIZE - elem.clientHeight) *  HALF)\r\n    }\r\n  }\r\n  */\r\n  // scroll range\r\n  /*  useEffect(\r\n    () => {\r\n      const orgMat = new DOMMatrix(matrix.toString())\r\n      setMatrix(orgMat)\r\n    },\r\n    [outer],\r\n  )\r\n  */\r\n  //  update offset\r\n  const onResizeOuter = useRef(\r\n      () => {\r\n      if (outer.current) {\r\n        let cur = outer.current as HTMLElement\r\n        let offsetLeft = 0\r\n        while (cur) {\r\n          offsetLeft += cur.offsetLeft\r\n          cur = cur.offsetParent as HTMLElement\r\n        }\r\n        //  console.log(`sc:[${outer.current.clientWidth}, ${outer.current.clientHeight}] left:${offsetLeft}`)\r\n        map.setScreenSize([outer.current.clientWidth, outer.current.clientHeight])\r\n        map.setLeft(offsetLeft)\r\n        // map.setOffset([outer.current.scrollLeft, outer.current.scrollTop])  //  when use scroll\r\n      }\r\n    }\r\n  ).current\r\n\r\n  const styleProps: StyleProps = {\r\n    matrix,\r\n    props,\r\n    mem,\r\n  }\r\n\r\n\r\n  function stop(ev:MouseOrTouch|React.PointerEvent) {\r\n    ev.stopPropagation()\r\n    ev.preventDefault()\r\n  }\r\n  function onClickUploadZone(evt: MouseOrTouch) {\r\n    //onLeaveIcon()\r\n    setShowUploadOption(true)\r\n    setShowMenu(false)\r\n  }\r\n\r\n  // use State\r\n  const [showMenu, setShowMenu] = useState(false)\r\n  const [showUploadOption, setShowUploadOption] = useState(false)\r\n  const [pingLocation, setPingLocation] = useState(false)\r\n\r\n  const classes = useStyles(styleProps)\r\n\r\n  return (\r\n    <div className={classes.root} ref={outer} {...bind()}>\r\n      <ResizeObserver onResize = { onResizeOuter } />\r\n      <div className={classes.center} onWheel={wheelHandler}>\r\n        <div id=\"map-transform\" className={classes.transform} ref={container}>\r\n            {props.children}\r\n        </div>\r\n      </div>\r\n   {/* Add Context Menu */}\r\n   <div className={showMenu ? classes.showMenuContainer : classes.hideMenuContainer}>\r\n      <Tooltip placement=\"bottom\" title={showMenu ? t('ctUploadZone') : ''}>\r\n          <div className={classes.uploadZone} onMouseUp={onClickUploadZone} /* onTouchEnd={onClickUploadZone} */\r\n            onTouchStart={stop} /* onMouseLeave={() => setTimeout(()=>{setShowMenu(false)},100)} */>\r\n              <img id='menuUpload' src={UploadShare} height={TITLE_HEIGHT} width={TITLE_HEIGHT} alt=\"\"/>\r\n          </div>\r\n        </Tooltip>\r\n      <div className={classes.dashedCircle}></div>\r\n      </div>\r\n      {/* <div className={(pingLocation && _pingIcon) ? classes.PingLocation:classes.PingLocationHide}>\r\n        <img src={PingIcon} width={TITLE_HEIGHT} alt=\"\"/>\r\n      </div> */}\r\n      <ShareDialog {...props} open={showUploadOption} onClose={() => setShowUploadOption(false)} cordX={mem.contentX} cordY={mem.contentY} origin={'contextmenu'} _type={'menu'}/>\r\n    </div>\r\n\r\n  )\r\n}\r\nBase.displayName = 'MapBase'\r\n\r\n","export default \"data:image/png;base64,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\"","/* import clipboardCopy from '@iconify-icons/heroicons-outline/clipboard-copy'\r\nimport maximizeIcon from '@iconify-icons/tabler/arrows-maximize'\r\nimport minimizeIcon from '@iconify-icons/tabler/arrows-minimize'\r\nimport pinIcon from '@iconify/icons-mdi/pin'\r\nimport pinOffIcon from '@iconify/icons-mdi/pin-off' */\r\nimport {Icon} from '@iconify/react'\r\nimport {Button, Dialog, DialogActions, DialogContent, Tooltip, Zoom} from '@material-ui/core'\r\nimport {makeStyles} from '@material-ui/core/styles'\r\nimport {CreateCSSProperties} from '@material-ui/core/styles/withStyles'\r\n/* import DoneIcon from '@material-ui/icons/CheckCircle'\r\nimport CloseRoundedIcon from '@material-ui/icons/CloseRounded'\r\nimport EditIcon from '@material-ui/icons/Edit' */\r\n/* import FlipToBackIcon from '@material-ui/icons/FlipToBack'\r\nimport FlipToFrontIcon from '@material-ui/icons/FlipToFront' */\r\n/* import MoreHorizIcon from '@material-ui/icons/MoreHoriz'\r\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow' */\r\nimport settings from '@components/Settings'\r\nimport {doseContentEditingUseKeyinput, /* isContentWallpaper,  */isContentEditable, /* isContentMaximizable,  */ISharedContent} from '@models/ISharedContent'\r\nimport {t} from '@models/locales'\r\nimport {isSmartphone, mulV2, normV, Pose2DMap} from '@models/utils'\r\nimport {addV2, extractScaleX, extractScaleY, mulV, rotateVector2DByDegree, subV2} from '@models/utils'\r\nimport {/* copyContentToClipboard,  */moveContentToBottom, moveContentToTop} from '@stores/sharedContents/SharedContentCreator'\r\nimport {TITLE_HEIGHT} from '@stores/sharedContents/SharedContents'\r\nimport _ from 'lodash'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React, {useEffect, useLayoutEffect, useRef, useState} from 'react'\r\nimport {Rnd} from 'react-rnd'\r\nimport {useGesture} from 'react-use-gesture'\r\nimport { FullGestureState, UserHandlersPartial } from 'react-use-gesture/dist/types'\r\nimport {Content/* , contentTypeIcons, editButtonTip */} from './Content'\r\nimport {ISharedContentProps} from './SharedContent'\r\nimport {SharedContentForm} from './SharedContentForm'\r\n\r\n///////////////////////\r\nimport {ShareDialog} from '@components/footer/share/ShareDialog'\r\n/* import { getBasePingStatus } from '../Base' */\r\nimport crossIcon from '@iconify-icons/fa-solid/expand-arrows-alt'\r\nimport { isCanvasMoved } from '../Base'\r\n\r\nimport proximityIcon from '@images/whoo-screen_btn-earshot.png'\r\nimport proximityOffIcon from '@images/whoo-screen_btn-earshot.png'\r\nimport MoreIcon from '@images/whoo-screen_btn-more.png'\r\nimport CloseIcon from '@images/whoo-screen_btn-delete.png'\r\n\r\n/* import pinIcon from '@images/whoo-screen_btn-lock.png'\r\nimport pinOffIcon from '@images/whoo-screen_btn-lock.png' */\r\n\r\nimport FlipToBackIcon from '@images/whoo-screen_btn-back.png'\r\nimport FlipToFrontIcon from '@images/whoo-screen_btn-front.png'\r\nimport UploadShare from '@images/whoo-screen_btn-add-63.png'\r\n//import PingIcon from '@images/whoo-screen_pointer.png'\r\n\r\nimport StopWatchOnIcon from '@material-ui/icons/Timer'\r\nimport StopWatchOffIcon from '@material-ui/icons/Timer'\r\nimport RotateRightIcon from '@material-ui/icons/RotateRight'\r\nimport AspectRatioIcon from '@material-ui/icons/AspectRatio';\r\nimport { PARTICIPANT_SIZE } from '@models/Participant'\r\n\r\n///////////////////////\r\n\r\nconst MOUSE_RIGHT = 2\r\nconst BORDER_TIMER_DELAY = 1 * 1000 // For 1 secs\r\n\r\nexport type MouseOrTouch = React.MouseEvent | React.TouchEvent\r\nexport interface RndContentProps extends ISharedContentProps {\r\n  hideAll ?: boolean\r\n  autoHideTitle ?: boolean\r\n  onShare ?: (evt: MouseOrTouch) => void\r\n  onClose: (evt: MouseOrTouch) => void\r\n  updateAndSend: (c: ISharedContent) => void\r\n  updateOnly: (c: ISharedContent) => void\r\n}\r\ninterface StyleProps{\r\n  props: RndContentProps,\r\n  pose: Pose2DMap,\r\n  size: [number, number],\r\n  showTitle: boolean,\r\n  showBorder: boolean,\r\n  pinned: boolean,\r\n  dragging: boolean,\r\n  editing: boolean,\r\n\r\n  downPos: number,\r\n  downXPos: number,\r\n  _down: boolean,\r\n  _title:boolean,\r\n  pingX: number,\r\n  pingY: number,\r\n}\r\nclass RndContentMember{\r\n  buttons = 0\r\n  dragCanceled = false\r\n\r\n  _borderTimer = 0\r\n  _down = false\r\n  _item = ''\r\n  _timer = 0\r\n  downTime = 0\r\n  upTime = 0\r\n  downPos = 0\r\n  downXPos = 0\r\n  movePos = 0\r\n  moveXPos = 0\r\n  onContent = false\r\n  onContext = false\r\n  moveX = 0\r\n  moveY = 0\r\n  clickStatus = ''\r\n  userAngle = 0\r\n  clickEnter = false\r\n  pingX = 0\r\n  pingY = 0\r\n  isMoved = false\r\n  hidePinIcon = 0\r\n  // Stop watch\r\n  OnTimerClick = false\r\n  intervalStep = 0\r\n  // zIndex\r\n  _zIndex = 0\r\n  _clickX = 0\r\n  _clickY = 0\r\n  _checkForRotation = false\r\n  _onContentForEdit = false\r\n  touchStart = 0\r\n  touchEnd = 0\r\n}\r\n\r\nlet contextMenuStatus:boolean = false\r\nexport function getContextMenuStatus(): boolean {\r\n  return contextMenuStatus\r\n}\r\nlet isLocaked:boolean = false\r\nexport function getContentLocked(): boolean {\r\n  return isLocaked\r\n}\r\n\r\nlet pingEnable:boolean = false\r\nexport function getRndPingStatus():boolean {\r\n  return pingEnable\r\n}\r\n\r\nlet _contentDialogOpen = false\r\nexport function getContentDialogStatus() : boolean {\r\n  return _contentDialogOpen\r\n}\r\n\r\nlet _contentDeleteDialogOpen = false\r\nexport function getContentDeleteDialogStatus() : boolean {\r\n  return _contentDeleteDialogOpen\r\n}\r\n\r\nlet _isOnContent = false\r\nexport function isOnContentStatus() : boolean {\r\n  return _isOnContent\r\n}\r\n\r\nlet _contenHandler = false\r\nexport function isContentHandlerOn() : boolean {\r\n  return _contenHandler\r\n}\r\n\r\n// For Double Touch\r\nlet dblTouchTapCount = 0\r\n\r\n//  -----------------------------------------------------------------------------------\r\n//  The RnDContent component\r\nexport const RndContent: React.FC<RndContentProps> = (props:RndContentProps) => {\r\n  /*\r\n  function rotateG2C(gv: [number, number]) {\r\n    const lv = mapData.rotateFromWindow(gv)\r\n    const cv = rotateVector2DByDegree(-pose.orientation, lv)\r\n    //  console.log('rotateG2C called ori', pose.orientation, ' tran:', transform.rotation)\r\n\r\n    return cv\r\n  }*/\r\n  /*\r\n  function rotateG2L(gv: [number, number]) {\r\n    const lv = transform.rotateG2L(gv)\r\n\r\n    return lv\r\n  }\r\n  function rotateC2G(cv: [number, number]) {\r\n    const lv = rotateVector2DByDegree(pose.orientation, cv)\r\n    const gv = transform.rotateL2G(lv)\r\n\r\n    return gv\r\n  }*/\r\n\r\n  // states\r\n  const [pose, setPose] = useState(props.content.pose)  //  pose of content\r\n  const [size, setSize] = useState(props.content.size)  //  size of content\r\n  const [resizeBase, setResizeBase] = useState(size)    //  size when resize start\r\n  const [resizeBasePos, setResizeBasePos] = useState(pose.position)    //  position when resize start\r\n  //const [showTitle, setShowTitle] = useState(!props.autoHideTitle || !props.content.pinned)\r\n  const [showTitle, setShowTitle] = useState(false)\r\n  const [showForm, setShowForm] = useState(false)\r\n  const [preciseOrientation, setPreciseOrientation] = useState(pose.orientation)\r\n  const [dragging, setDragging] = useState(false)\r\n  const rnd = useRef<Rnd>(null)                         //  ref to rnd to update position and size\r\n  const {contents, map, participants} = props.stores\r\n  const editing = useObserver(() => contents.editing === props.content.id)\r\n  //const zoomed = useObserver(() => map.zoomed)\r\n  function setEditing(flag: boolean) { contents.setEditing(flag ? props.content.id : '') }\r\n  const memberRef = useRef<RndContentMember>(new RndContentMember())\r\n  const member = memberRef.current\r\n\r\n  const titleDisplay = useObserver(() => props.content.showTitle)\r\n  const [showUploadOption, setShowUploadOption] = useState(false)\r\n  const [showBorder, setShowBorder] = useState(false)\r\n\r\n  // For Delete confirm dialog\r\n  const [showDelete, setShowDelete] = useState(false)\r\n  //const [showHandler, setShowHandler] = useState(false)\r\n  const [showOnRotation, setShowOnRotation] = useState(false)\r\n\r\n  _contentDialogOpen = showUploadOption\r\n  const mDeleteTimer = setTimeout(function() {\r\n    clearTimeout(mDeleteTimer)\r\n   _contentDeleteDialogOpen = showDelete\r\n  }, 500)\r\n\r\n  // For Stop Watch\r\n  const stopWatchToggle = useObserver(() => props.content.stopWatchToggle)\r\n  const stopWatchReset = useObserver(() => props.content.stopWatchReset)\r\n  const showHandler = useObserver(() => props.content.scaleRotateToggle)\r\n  _contenHandler = showHandler\r\n  const [time, setTime] = useState(0);\r\n  // Delte Message\r\n  const _msgTitle = (props.content.shareType === 'img' ? ' Image?' : (props.content.shareType === 'zoneimg' ? ' Chat Zone?' : ' Text?'))\r\n  // For Ping Location\r\n  const [pingLocation, setPingLocation] = useState(false)\r\n\r\n  if(props.content.zone === undefined) {\r\n    if(props.content.shareType === \"zoneimg\") {\r\n      props.content.zone = \"close\"\r\n    } else {\r\n      props.content.zone = undefined\r\n    }\r\n  }\r\n\r\n\r\n\r\n\r\n  useEffect(  //  update pose\r\n    ()=> {\r\n      member.dragCanceled = true\r\n     /*  if (!_.isEqual(size, props.content.size)) {\r\n        setSize(_.cloneDeep(props.content.size))\r\n      }\r\n      if (!_.isEqual(pose, props.content.pose)) {\r\n        setPose(_.cloneDeep(props.content.pose))\r\n      }\r\n    },\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    [props.content], */\r\n    // Resizing the elments\r\n      ////////////////////////////////////////////////////////////////////////////\r\n        //console.log(props.content.size[0])\r\n        if(props.content.size[0] < 80 || props.content.size[1] < 80) {\r\n          setSize([props.content.size[0] + (150-props.content.size[0]), props.content.size[1] + (150 - props.content.size[1])])\r\n        }\r\n        updateHandler()\r\n        ////////////////////////////////////////////////////////////////////////////\r\n      // Working Code\r\n      if (props.content.showStopWatch && stopWatchToggle === false && stopWatchReset === false) {\r\n        // +global.setInterval()\r\n        member.intervalStep = window.setInterval(() => {\r\n          setTime((time) => time + 10);\r\n        }, 10);\r\n      } else if(stopWatchReset) {\r\n        setTime(0)\r\n        window.clearInterval(member.intervalStep);\r\n      } else {\r\n        window.clearInterval(member.intervalStep);\r\n      }\r\n      if(props.content.shareType !== \"img\") {\r\n        window.clearTimeout(member._timer)\r\n        //member._timer = window.setTimeout( function() {\r\n        const _mTimer = setTimeout( function() {\r\n          clearTimeout(_mTimer)\r\n          if(showTitle === true) return\r\n          contextMenuStatus = false\r\n           setShowTitle(false)\r\n        }, 2)\r\n      }\r\n      if (!_.isEqual(size, props.content.size)) {\r\n        setSize(_.cloneDeep(props.content.size))\r\n      }\r\n      if (!_.isEqual(pose, props.content.pose)) {\r\n        setPose(_.cloneDeep(props.content.pose))\r\n      }\r\n\r\n    return () => {\r\n      //clearInterval(member.intervalStep);\r\n      window.clearInterval(member.intervalStep)\r\n    };\r\n\r\n\r\n    },\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    [props.content, props.content.showStopWatch, props.content.stopWatchToggle],\r\n  )\r\n\r\n\r\n  function setPoseAndSizeToRnd(){\r\n    if (rnd.current) { rnd.current.resizable.orientation = pose.orientation + map.rotation }\r\n    const titleHeight = showTitle ? TITLE_HEIGHT : 0\r\n    rnd.current?.updatePosition({x:pose.position[0], y:pose.position[1] - titleHeight})\r\n    rnd.current?.updateSize({width:size[0], height:size[1] + titleHeight})\r\n  }\r\n  useLayoutEffect(  //  reflect pose etc. to rnd size\r\n    () => {\r\n      setPoseAndSizeToRnd()\r\n    },\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    [pose, size, showTitle, map.rotation],\r\n  )\r\n\r\n  //  handlers\r\n  function stop(ev:MouseOrTouch|React.PointerEvent) {\r\n    ev.stopPropagation()\r\n    ev.preventDefault()\r\n  }\r\n  /* function onClickShare(evt: MouseOrTouch) {\r\n    stop(evt)\r\n    props.onShare?.call(null, evt)\r\n  } */\r\n\r\n  /* function onClickClose(evt: MouseOrTouch) {\r\n    stop(evt)\r\n    props.onClose?.call(null, evt)\r\n  } */\r\n  function onClickClose(evt: MouseOrTouch) {\r\n    stop(evt)\r\n    //props.onClose?.call(null, evt)\r\n    onLeaveIcon()\r\n    setShowDelete(true)\r\n  }\r\n  /* function onClickEdit(evt: MouseOrTouch) {\r\n    stop(evt)\r\n    setEditing(!editing)\r\n  } */\r\n  /* function onClickMoveToTop(evt: MouseOrTouch) {\r\n    stop(evt)\r\n    moveContentToTop(props.content)\r\n    props.updateAndSend(props.content)\r\n  }\r\n  function onClickMoveToBottom(evt: MouseOrTouch) {\r\n    stop(evt)\r\n    moveContentToBottom(props.content)\r\n    props.updateAndSend(props.content)\r\n  } */\r\n  function onClickMoveToTop(evt: MouseOrTouch) {\r\n    stop(evt)\r\n    moveContentToTop(props.content)\r\n    props.updateAndSend(props.content)\r\n    onLeaveIcon()\r\n  }\r\n  function onClickMoveToBottom(evt: MouseOrTouch) {\r\n    stop(evt)\r\n    moveContentToBottom(props.content)\r\n    props.updateAndSend(props.content)\r\n    onLeaveIcon()\r\n  }\r\n  /* function onClickPin(evt: MouseOrTouch) {\r\n    stop(evt)\r\n    props.content.pinned = !props.content.pinned\r\n    props.updateAndSend(props.content)\r\n  } */\r\n  function onClickUploadZone(evt: MouseOrTouch) {\r\n    onLeaveIcon()\r\n    setShowUploadOption(true)\r\n  }\r\n  function onClickScaleRotate(evt: MouseOrTouch) {\r\n    stop(evt)\r\n\r\n    props.content.scaleRotateToggle = !props.content.scaleRotateToggle\r\n    props.content.pinned = !props.content.pinned\r\n    props.updateAndSend(props.content)\r\n    /* if(showOnRotation) {\r\n      setShowOnRotation(false)\r\n    } */\r\n    onLeaveIcon()\r\n  }\r\n\r\n  function onClickStopWatch(evt:MouseOrTouch) {\r\n    //console.log(\"On CLICK\")\r\n    /* if(showStopWatch) {\r\n      setTime(0)\r\n      setShowStopWatch(false)\r\n      setIsPaused(true)\r\n    } else {\r\n      setShowStopWatch(true)\r\n      setIsPaused(false)\r\n    } */\r\n    /* stop(evt)\r\n    props.content.showStopWatch = !props.content.showStopWatch\r\n    console.log(props.content.showStopWatch, \" props.content.showStopWatch\")\r\n    props.updateAndSend(props.content)\r\n    setIsPaused(!isPaused) */\r\n    stop(evt)\r\n    member._down = false\r\n    //props.content.zone = !props.content.zone\r\n    if(props.content.showStopWatch) {\r\n      props.content.showStopWatch = false\r\n      props.content.stopWatchToggle = true\r\n      props.content.stopWatchReset = true\r\n      //setTime(0)\r\n      //setIsPaused(true)\r\n    } else {\r\n      props.content.showStopWatch = true\r\n      props.content.stopWatchToggle = false\r\n      props.content.stopWatchReset = false\r\n      //setIsPaused(false)\r\n    }\r\n    props.updateAndSend(props.content)\r\n    onLeaveIcon()\r\n  }\r\n\r\n  function onClickZone(evt: MouseOrTouch) {\r\n    stop(evt)\r\n    member._down = false\r\n    //props.content.zone = !props.content.zone\r\n    if(props.content.zone === \"open\"){\r\n      props.content.zone = \"close\"\r\n    } else {\r\n      if(props.content.shareType === \"img\") {\r\n          if(props.content.zone === undefined) {\r\n            props.content.zone = \"close\"\r\n          } else {\r\n            props.content.zone = undefined\r\n          }\r\n        } else {\r\n          props.content.zone = \"open\"\r\n      }\r\n    }\r\n    props.updateAndSend(props.content)\r\n    onLeaveIcon()\r\n  }\r\n  /* function onClickCopy(evt: MouseOrTouch){\r\n    stop(evt)\r\n    copyContentToClipboard(props.content)\r\n  }\r\n  function onClickMaximize(evt: MouseOrTouch){\r\n    stop(evt)\r\n    if (map.zoomed){\r\n      map.restoreZoom()\r\n    }else{\r\n      map.zoomTo(props.content)\r\n    }\r\n  } */\r\n  /* function onClickMore(evt: MouseOrTouch){\r\n    stop(evt)\r\n    map.keyInputUsers.add('contentForm')\r\n    setShowForm(true)\r\n  }\r\n  function onCloseForm(){\r\n    setShowForm(false)\r\n    if (props.content.pinned){\r\n      setShowTitle(false)\r\n    }\r\n    map.keyInputUsers.delete('contentForm')\r\n    props.updateAndSend(props.content)\r\n  } */\r\n  function onClickMore(evt: MouseOrTouch){\r\n    stop(evt)\r\n    map.keyInputUsers.add('contentForm')\r\n    setShowForm(true)\r\n    onLeaveIcon()\r\n  }\r\n  function onCloseForm(){\r\n    setShowForm(false)\r\n    if (props.content.pinned){\r\n      contextMenuStatus = false\r\n      setShowTitle(false)\r\n    }\r\n    map.keyInputUsers.delete('contentForm')\r\n    props.updateAndSend(props.content)\r\n  }\r\n  function onLeaveIcon() {\r\n    if(member._down) return\r\n    member._down = false\r\n    member._item = \"DIV\"\r\n    window.clearTimeout(member._timer)\r\n\r\n    showHideTimer(1)\r\n  }\r\n\r\n  function updateHandler() {\r\n    if (JSON.stringify(pose) !== JSON.stringify(props.content.pose) ||\r\n      JSON.stringify(size) !== JSON.stringify(props.content.size)) {\r\n      props.content.size = [...size] //  Must be new object to compare the pose or size object.\r\n      props.content.pose = {...pose} //  Must be new object to compare the pose or size object.\r\n      props.updateAndSend(props.content)\r\n\r\n      setShowOnRotation(false)\r\n    }\r\n  }\r\n\r\n  //  drag for title area\r\n  function dragHandler(delta:[number, number], buttons:number, event:any) {\r\n    if (member.dragCanceled){ return }\r\n    const ROTATION_IN_DEGREE = 360\r\n    const ROTATION_STEP = 15\r\n    if (buttons === MOUSE_RIGHT) {\r\n      setPreciseOrientation((preciseOrientation + delta[0] + delta[1]) % ROTATION_IN_DEGREE)\r\n      let newOri\r\n      if (event?.shiftKey || event?.ctrlKey) {\r\n        newOri = preciseOrientation\r\n      }else {\r\n        newOri = preciseOrientation - preciseOrientation % ROTATION_STEP\r\n      }\r\n      //    mat.translateSelf(...addV2(props.pose.position, mulV(0.5, size)))\r\n      const CENTER_IN_RATIO = 0.5\r\n      const center = addV2(pose.position, mulV(CENTER_IN_RATIO, size))\r\n      pose.position = addV2(pose.position,\r\n                            subV2(rotateVector2DByDegree(pose.orientation - newOri, center), center))\r\n      pose.orientation = newOri\r\n      setPose(Object.assign({}, pose))\r\n    }else {\r\n      const lv = map.rotateFromWindow(delta)\r\n      const cv = rotateVector2DByDegree(-pose.orientation, lv)\r\n      pose.position = addV2(pose.position, cv)\r\n      setPose(Object.assign({}, pose))\r\n    }\r\n  }\r\n\r\n  function hindleClickStatus() {\r\n\r\n    console.log(member.clickStatus, \" STATUS\")\r\n\r\n    if(member.clickStatus === 'single') {\r\n      if(member.clickEnter) {return}\r\n     // if(pingLocation) {return}\r\n     //if(member.isMoved) {return}\r\n     if(isCanvasMoved()) {return}\r\n     if(showDelete) {return}\r\n     //if(member.OnTimerClick) {return}\r\n     //console.log(showOnRotation, \" onRota icon\")\r\n     if(showOnRotation) {return}\r\n     if(showHandler) {return}\r\n     if(pingLocation) {}\r\n      pingEnable = false\r\n      member.clickStatus = ''\r\n      participants.local.pingIcon = false\r\n      participants.local.pingX = 0\r\n      participants.local.pingY = 0\r\n      setPingLocation(false)\r\n      const moveTimer = setTimeout(() =>{\r\n        clearTimeout(moveTimer)\r\n        //console.log(member.isMoved)\r\n        if(member.isMoved) {return}\r\n        function moveParticipant(move:boolean) {\r\n          const local = participants.local\r\n          //const diff = subV2(map.mouseOnMap, local.pose.position)\r\n          const diff = subV2([member.moveX, member.moveY], local.pose.position)\r\n          if (normV(diff) > PARTICIPANT_SIZE / 10) {\r\n            const dir = mulV2(normV(diff)/5 / normV(diff), diff)\r\n            local.pose.orientation = Math.atan2(dir[0], -dir[1]) * 180 / Math.PI\r\n            if (move) {\r\n              local.pose.position = addV2(local.pose.position, dir)\r\n            } else {\r\n              setShowBorder(true)\r\n            // Start Timer to disable border\r\n            window.clearTimeout(member._borderTimer)\r\n            showHideBorder()\r\n            }\r\n            local.savePhysicsToStorage(false)\r\n            const TIMER_INTERVAL = move ? 0 : 0\r\n            setTimeout(() => { moveParticipant(true) }, TIMER_INTERVAL)\r\n          }\r\n        }\r\n        moveParticipant(false)\r\n      }, 0)\r\n    } else if(member.clickStatus === 'double') {\r\n      if(_contentDeleteDialogOpen) {return}\r\n      window.clearTimeout(member.hidePinIcon)\r\n      pingEnable = true\r\n      setPingLocation(true)\r\n      participants.local.pingX = member.pingX\r\n      participants.local.pingY = member.pingY\r\n      participants.local.pingIcon = true\r\n      member.hidePinIcon = window.setTimeout(() => {\r\n        window.clearTimeout(member.hidePinIcon)\r\n        member.clickStatus = ''\r\n        participants.local.pingIcon = false\r\n        participants.local.pingX = 0\r\n        participants.local.pingY = 0\r\n        pingEnable = false\r\n        setPingLocation(false)\r\n      }, 3000)\r\n    } else if(member.clickStatus === 'toggleTimer') {\r\n      //console.log(\"toggleTimer\")\r\n      member.clickStatus = ''\r\n      //if(isPaused) {\r\n      if(props.content.stopWatchToggle) {\r\n        props.content.stopWatchToggle = false\r\n        props.content.stopWatchReset = false\r\n        //setIsPaused(false)\r\n      } else {\r\n        props.content.stopWatchToggle = true\r\n        props.content.stopWatchReset = false\r\n        //setIsPaused(true)\r\n      }\r\n      props.updateAndSend(props.content)\r\n    } else if(member.clickStatus === \"resetTimer\") {\r\n      member.clickStatus = ''\r\n      //setIsPaused(true)\r\n      //setTime(0)\r\n      props.content.stopWatchToggle = true\r\n      props.content.stopWatchReset = true\r\n      props.updateAndSend(props.content)\r\n    }\r\n  }\r\n\r\n  //const isFixed = (props.autoHideTitle && props.content.pinned)\r\n  const isFixed = (props.content.pinned)\r\n\r\n  const stopTimeValue = (\"0\" + Math.floor((time / 60000) % 60)).slice(-2) + \":\" + (\"0\" + Math.floor((time / 1000) % 60)).slice(-2) + \":\" + (\"0\" + ((time / 10) % 100)).slice(-2)\r\n\r\n  const handlerForTitle:UserHandlersPartial = {\r\n    onWheel:(evt)=> {\r\n      if(member._down) {\r\n        if(showTitle) {\r\n          member._down = false\r\n          member._item = \"DIV\"\r\n          window.clearTimeout(member._timer)\r\n            showHideTimer(0)\r\n        }\r\n      }\r\n    },\r\n    onDoubleClick: (evt)=>{\r\n      if (isContentEditable(props.content)){\r\n        stop(evt)\r\n        setEditing(!editing)\r\n      }\r\n    },\r\n    onDrag: ({down, delta, event, xy, buttons}) => {\r\n      //  console.log('onDragTitle:', delta)\r\n      isLocaked = props.content.pinned\r\n      _isOnContent = true\r\n      member._down = false\r\n\r\n      if (isFixed) { return }\r\n      if(showTitle) {return}\r\n\r\n      event?.stopPropagation()\r\n      if (down) {\r\n        //  event?.preventDefault()\r\n        dragHandler(delta, buttons, event)\r\n      }\r\n    },\r\n    onDragStart: ({event, currentTarget, delta, buttons, xy}) => {   // to detect click\r\n      //  console.log(`dragStart delta=${delta}  buttons=${buttons}`)\r\n      if(event?.type === \"touchstart\") {return}\r\n      _isOnContent = true\r\n      if(showTitle) {return}\r\n\r\n      setDragging(true)\r\n      member.buttons = buttons\r\n      member.dragCanceled = false\r\n      if (currentTarget instanceof Element && event instanceof PointerEvent){\r\n        currentTarget.setPointerCapture(event?.pointerId)\r\n      }\r\n\r\n      member._checkForRotation = true\r\n      member.onContent = true\r\n      member._down = true\r\n      member.downTime = new Date().getSeconds()\r\n      member.moveX = map.mouseOnMap[0]\r\n      member.moveY = map.mouseOnMap[1]\r\n      window.clearTimeout(member._timer)\r\n      member._clickX = xy[0]\r\n      member._clickY = xy[1]\r\n      // Storing zIndex\r\n      member._zIndex = Number(props.content.zIndex)\r\n      //////////////////////////////////////////////\r\n      const mMenuTimer =  setTimeout(function() {\r\n        //console.log(\"MOVING -- \", member._down, \" --- \", _contentDeleteDialogOpen, \" IN DRAG \", dblTouchTapCount)\r\n        clearTimeout(mMenuTimer)\r\n        if(member._down && showTitle === false && showOnRotation === false && _contentDeleteDialogOpen === false && dblTouchTapCount === 0) {\r\n          const diff = subV2(map.mouseOnMap, pose.position)\r\n          member.downPos = Number(diff[1])\r\n          member.downXPos = Number(diff[0])\r\n          contextMenuStatus = true\r\n          setShowTitle(true)\r\n        }\r\n      }, 500)\r\n    },\r\n    onDragEnd: ({event, currentTarget, delta, buttons, xy}) => {\r\n      //  console.log(`dragEnd delta=${delta}  buttons=${buttons}`)\r\n      _isOnContent = false\r\n      isLocaked = false\r\n      member._down = false\r\n      member._item = \"DIV\"\r\n      window.clearTimeout(member._timer)\r\n      if(String(Object(event?.target).nodeName)===\"DIV\") {\r\n        showHideTimer(0)\r\n      } else {\r\n        showHideTimer(1)\r\n      }\r\n\r\n\r\n      console.log(showTitle, \" ---- \", checkContentsInEdit())\r\n\r\n\r\n      if(showTitle) {return}\r\n\r\n      let isEdit = checkContentsInEdit()\r\n      if(isEdit/*  && member._checkForRotation */) {\r\n        ExitAllFromEditMode()\r\n        return\r\n      }\r\n\r\n      setDragging(false)\r\n      if (!member.dragCanceled){ updateHandler() }\r\n      member.dragCanceled = false\r\n\r\n      if (currentTarget instanceof Element && event instanceof PointerEvent){\r\n        currentTarget.releasePointerCapture(event?.pointerId)\r\n      }\r\n      if (!map.keyInputUsers.size && member.buttons === MOUSE_RIGHT){ //  right click\r\n        //setShowForm(true)\r\n        //map.keyInputUsers.add('contentForm')\r\n      }\r\n      member.buttons = 0\r\n      if(props.content.scaleRotateToggle && member._checkForRotation) {\r\n        member._checkForRotation = false\r\n        RotateContent()\r\n        updateHandler()\r\n        return\r\n      }\r\n      let yCheck = props.content.size[1] - (map.mouseOnMap[1] - props.content.pose.position[1]) //participants.local.mouse.position[1]\r\n      let xCheck = props.content.size[0] - (props.content.size[0] - (map.mouseOnMap[0] - props.content.pose.position[0]))\r\n      if (event?.detail === 1) {\r\n        //console.log(member.OnTimerClick , \" onTimer\")\r\n        //console.log(member._down, \" down\")\r\n        //if(yCheck > -45 && yCheck < - 20) {\r\n        //if(yCheck > 5 && yCheck < 35 && xCheck > 7 && xCheck < 110) {\r\n        if(yCheck > 5 && yCheck < 35 && xCheck > (props.content.size[0]/2 - 55) && xCheck < props.content.size[0]/2 + 55) {\r\n        //if(diff[0] >= startXPos && diff[0] <= endXPos && diff[1] >= startYPos && diff[1] <= endYPos) {\r\n          member.clickStatus = 'toggleTimer'\r\n          //console.log(\"onTimer click\")\r\n        } else {\r\n          member.clickStatus = 'single'\r\n        }\r\n      } else if (event?.detail === 2) {\r\n        //if(yCheck > -45 && yCheck < - 20) {\r\n        //if(yCheck > 5 && yCheck < 35 && xCheck > 7 && xCheck < 110) {\r\n          if(yCheck > 5 && yCheck < 35 && xCheck > (props.content.size[0]/2 - 55) && xCheck < props.content.size[0]/2 + 55) {\r\n          //if(diff[0] >= startXPos && diff[0] <= endXPos && diff[1] >= startYPos && diff[1] <= endYPos) {\r\n          member.clickStatus = 'resetTimer'\r\n        } else {\r\n          member.clickStatus = \"double\"\r\n          /* member.pingX = map.mouseOnMap[0]\r\n          member.pingY = map.mouseOnMap[1] */\r\n          member.pingX = participants.local.mouse.position[0] - participants.local.pose.position[0]\r\n          member.pingY = participants.local.mouse.position[1]-participants.local.pose.position[1]\r\n        }\r\n      }\r\n      member.clickEnter = true\r\n      const timer = setTimeout(() => {\r\n        clearTimeout(timer);\r\n        //if(member.OnTimerClick) {return}\r\n        if(member.clickEnter) {\r\n          member.clickEnter = false\r\n            hindleClickStatus()\r\n        }\r\n      }, 220)\r\n    },\r\n    onMove:({event, xy}) => {\r\n      if(showTitle) {return}\r\n      if(event?.type === 'mousemove' && !isSmartphone() === true) {\r\n        member.isMoved = true\r\n      } else {\r\n        member.isMoved = false\r\n      }\r\n      //isLocaked = props.content.pinned\r\n      const diff = subV2([xy[0], xy[1]], pose.position)\r\n      member.downPos = Number(diff[1])\r\n      member.downXPos = Number(diff[0])\r\n      //if(participants.local.trackStates.pingIcon === false) {\r\n        map.setMouse(xy)\r\n      //}\r\n    },\r\n    onPointerUp: (arg) => { if(editing) {arg.stopPropagation()} },\r\n    onPointerDown: (arg) => { if(editing) {arg.stopPropagation()} },\r\n    onTouchMove :(e) => {\r\n      member.isMoved = true\r\n      member.movePos = Number(map.mouseOnMap[1])\r\n      member.moveXPos = Number(map.mouseOnMap[0])\r\n      //console.log(member.downXPos, \" --- \", member.moveXPos)\r\n      if((member.moveXPos >= (member.downXPos-20) && member.moveXPos <= (member.downXPos+20) && (member.movePos >= (member.downPos-20) && member.movePos <= (member.downPos+20)))) {\r\n        member._down = true\r\n        member._checkForRotation = true\r\n      } else {\r\n        member._down = false\r\n        member._checkForRotation = false\r\n      }\r\n    },\r\n    onMouseUp: (arg) => {\r\n      if(editing) {\r\n        arg.stopPropagation()\r\n      } else {\r\n        if(arg.button > 0) {return}\r\n\r\n        member.onContent = false\r\n\r\n        //_isOnContent = true\r\n\r\n        member.isMoved = false\r\n        member.upTime = new Date().getSeconds()\r\n        let diffTime = member.upTime - member.downTime\r\n        //console.log(diffTime, \" diffTi\")\r\n        if(diffTime < 2 && String(Object(arg.target).tagName) === \"DIV\" && showTitle === false) {\r\n          if(member._down === false || showTitle) return\r\n        } else {\r\n        }\r\n      }\r\n    },\r\n    onMouseMove: (arg) => {\r\n      //if(isSmartphone()) {return}\r\n      isLocaked = props.content.pinned\r\n      if(showTitle) {return}\r\n      member.movePos = Number(map.mouseOnMap[1])\r\n      member.moveXPos = Number(map.mouseOnMap[0])\r\n      //console.log(member.downXPos, \" --- \", member.moveXPos)\r\n      if((member.moveXPos >= (member.downXPos-20) && member.moveXPos <= (member.downXPos+20) && (member.movePos >= (member.downPos-20) && member.movePos <= (member.downPos+20)))) {\r\n        member._down = true\r\n        member._checkForRotation = true\r\n      } else {\r\n        member._down = false\r\n        member._checkForRotation = false\r\n      }\r\n    },\r\n    onMouseOver: (arg) => {\r\n      _isOnContent = true\r\n      // new props\r\n      member._onContentForEdit = true\r\n\r\n      member._item = String(Object(arg.target).tagName)\r\n      window.clearTimeout(member._timer)\r\n    },\r\n    onMouseOut: (arg) => {\r\n      if(showTitle) {return}\r\n      // use it\r\n      _isOnContent = false\r\n      // new props\r\n      member._onContentForEdit = false\r\n      member.onContent = false\r\n      isLocaked = false\r\n    },\r\n    /* onMouseDown: (arg) => { if(editing) {arg.stopPropagation()} }, */\r\n    onTouchStart: (arg) => {\r\n      if(editing) {arg.stopPropagation() }\r\n      //console.log(arg.type, \" onTYPE\")\r\n      var touch = arg.touches[0];\r\n      _isOnContent = true\r\n      if(showTitle) {return}\r\n      //if(dblTouchTapCount > 0) {return}\r\n      setDragging(true)\r\n      member.dragCanceled = false\r\n      /////////////////////////////////////////////\r\n      // SetMouse Pose with map canvas\r\n      member.isMoved = false\r\n      const diff = subV2([touch.clientX, touch.clientY], pose.position)\r\n      member.downPos = Number(diff[1])\r\n      member.downXPos = Number(diff[0])\r\n      map.setMouse([touch.clientX, touch.clientY])\r\n      //////////////////////////////////////////////\r\n      //member.touchStart = 0\r\n      //member.touchEnd = 0\r\n      //member.touchStart = new Date().getMilliseconds()\r\n      //////////////////////////////////////////////\r\n      member._checkForRotation = true\r\n      member.onContent = true\r\n      member._down = true\r\n      member.downTime = new Date().getSeconds()\r\n      member.moveX = map.mouseOnMap[0]\r\n      member.moveY = map.mouseOnMap[1]\r\n      window.clearTimeout(member._timer)\r\n      member._clickX = touch.clientX\r\n      member._clickY = touch.clientY\r\n      // Storing zIndex\r\n      member._zIndex = Number(props.content.zIndex)\r\n      //console.log(\"MOVING INIT -- \", member._down, \" --- \", _contentDeleteDialogOpen, \" --- \", member.touchEnd)\r\n      //////////////////////////////////////////////\r\n      const mMenuTimer =  setTimeout(function() {\r\n        //console.log(\"MOVING END -- \", member._down, \" --- \", _contentDeleteDialogOpen, \" >> \", member.touchEnd)\r\n        clearTimeout(mMenuTimer)\r\n        //if(dblTouchTapCount === 2) {return}\r\n        //alert(member._down)\r\n        //console.log(showHandler, \" showHandler\")\r\n        let canvasStat = isCanvasMoved()\r\n        if(showTitle === false && showHandler === false && _contentDeleteDialogOpen === false && dblTouchTapCount === 0) {\r\n          if(canvasStat) {return}\r\n          const diff = subV2(map.mouseOnMap, pose.position)\r\n          member.downPos = Number(diff[1])\r\n          member.downXPos = Number(diff[0])\r\n          contextMenuStatus = true\r\n          setShowTitle(true)\r\n        }\r\n      }, 500)\r\n    },\r\n    /* onTouchEnd: (arg) => { if(editing) {arg.stopPropagation()} }, */\r\n    onTouchEnd:(e) => {\r\n      member._down = false\r\n      _isOnContent = false\r\n      member.isMoved = false\r\n      var changedTouch = e.changedTouches[0];\r\n      var elem = document.elementFromPoint(changedTouch.clientX, changedTouch.clientY);\r\n        dblTouchTapCount ++\r\n        //console.log(dblTouchTapCount, \" checking DBLCLick\")\r\n        const dblClick = setTimeout(function () {\r\n          clearTimeout(dblClick)\r\n          if(dblTouchTapCount === 2) {\r\n            //console.log('doubleClick')\r\n            member.clickStatus = \"double\"\r\n            member.pingX = participants.local.mouse.position[0] - participants.local.pose.position[0]\r\n            member.pingY = participants.local.mouse.position[1]-participants.local.pose.position[1]\r\n          } else if(dblTouchTapCount === 1) {\r\n            //console.log(\"single click\")\r\n          }\r\n          const resetCounter = setTimeout(function() {\r\n            clearTimeout(resetCounter)\r\n            dblTouchTapCount = 0\r\n          }, 700)\r\n        }, 250)\r\n\r\n        ////////////////////////////////////////////////////////////////////\r\n        if(elem?.nodeName === \"IMG\" && elem?.id === \"contextUpload\") {\r\n          onLeaveIcon()\r\n          setShowUploadOption(true)\r\n        } else if(elem?.nodeName === \"IMG\" && elem?.id === \"contextDelete\") {\r\n          onLeaveIcon()\r\n          setShowDelete(true)\r\n        } else if(elem?.nodeName === \"IMG\" && elem?.id === \"contextMore\"){\r\n          onLeaveIcon()\r\n          map.keyInputUsers.add('contentForm')\r\n          setShowForm(true)\r\n\r\n        } else if(elem?.nodeName === \"IMG\" && elem?.id === \"contextProx\") {\r\n          member._down = false\r\n          //props.content.zone = !props.content.zone\r\n          if(props.content.zone === \"open\"){\r\n            props.content.zone = \"close\"\r\n          } else {\r\n            if(props.content.shareType === \"img\") {\r\n                if(props.content.zone === undefined) {\r\n                  props.content.zone = \"close\"\r\n                } else {\r\n                  props.content.zone = undefined\r\n                }\r\n              } else {\r\n                props.content.zone = \"open\"\r\n            }\r\n          }\r\n          props.updateAndSend(props.content)\r\n          onLeaveIcon()\r\n        } else if(elem?.nodeName === \"IMG\" && elem?.id === \"contextFlipBack\") {\r\n          moveContentToBottom(props.content)\r\n          props.updateAndSend(props.content)\r\n          onLeaveIcon()\r\n        } else if(elem?.nodeName === \"IMG\" && elem?.id === \"contextFlipFront\") {\r\n          moveContentToTop(props.content)\r\n          props.updateAndSend(props.content)\r\n          onLeaveIcon()\r\n        } else if(elem?.nodeName === \"svg\" && elem?.id === \"contextScaleRotate\") {\r\n          props.content.scaleRotateToggle = !props.content.scaleRotateToggle\r\n          props.content.pinned = !props.content.pinned\r\n          props.updateAndSend(props.content)\r\n          onLeaveIcon()\r\n        } else if((elem?.nodeName === \"svg\" || elem?.nodeName === \"path\" || elem?.nodeName === \"svg\" || elem?.nodeName === \"DIV\") && elem?.id === \"contextStopWatch\") {\r\n          member._down = false\r\n          if(props.content.showStopWatch) {\r\n            props.content.showStopWatch = false\r\n            props.content.stopWatchToggle = true\r\n            props.content.stopWatchReset = true\r\n          } else {\r\n            props.content.showStopWatch = true\r\n            props.content.stopWatchToggle = false\r\n            props.content.stopWatchReset = false\r\n          }\r\n          props.updateAndSend(props.content)\r\n          onLeaveIcon()\r\n        } else if(elem?.nodeName === \"DIV\") {\r\n            showHideTimer(0)\r\n        }\r\n      //}\r\n    },\r\n  }\r\n\r\n  function checkContentsInEdit():boolean {\r\n    let isEdit:boolean = false\r\n    if(props.stores.contents.all.length > 0) {\r\n      for(let i:number=0; i<props.stores.contents.all.length; i++) {\r\n        if(props.stores.contents.all[i].scaleRotateToggle && props.stores.contents.all[i].id !== props.content.id) {\r\n          isEdit = true\r\n        }\r\n      }\r\n    }\r\n    return isEdit\r\n  }\r\n\r\n  function ExitAllFromEditMode() {\r\n    if(props.stores.contents.all.length > 0) {\r\n      for(let i:number=0; i<props.stores.contents.all.length; i++) {\r\n        if(props.stores.contents.all[i].scaleRotateToggle && props.stores.contents.all[i].id !== props.content.id) {\r\n          props.stores.contents.all[i].scaleRotateToggle = !props.stores.contents.all[i].scaleRotateToggle\r\n        }\r\n        if(props.stores.contents.all[i].pinned === false && props.stores.contents.all[i].id !== props.content.id) {\r\n          props.stores.contents.all[i].pinned = true\r\n        }\r\n        props.stores.contents.updateByLocal(props.stores.contents.all[i])\r\n      }\r\n    }\r\n  }\r\n\r\n  function RotateContent() {\r\n    const ROTATION_IN_DEGREE = 360\r\n    const ROTATION_STEP = 90\r\n    setPreciseOrientation((preciseOrientation + 0 + 2) % ROTATION_IN_DEGREE)\r\n    //console.log(pose.orientation, \" preciseOrientation\")\r\n    let newOri = pose.orientation + ROTATION_STEP\r\n    //    mat.translateSelf(...addV2(props.pose.position, mulV(0.5, size)))\r\n    const CENTER_IN_RATIO = 0.5\r\n    const center = addV2(pose.position, mulV(CENTER_IN_RATIO, size))\r\n    pose.position = addV2(pose.position,\r\n                          subV2(rotateVector2DByDegree(pose.orientation - newOri, center), center))\r\n    pose.orientation = newOri\r\n    if(pose.orientation === 360) {\r\n      pose.orientation = 0\r\n    }\r\n    setPose(Object.assign({}, pose))\r\n  }\r\n\r\n  function showHideBorder() {\r\n    //member._borderTimer = window.setTimeout( function() {\r\n    const _bTimer = setTimeout( function() {\r\n      clearTimeout(_bTimer)\r\n      setShowBorder(false)\r\n     }, BORDER_TIMER_DELAY)\r\n  }\r\n  function showHideTimer(_delay:number) {\r\n    const _mTimer = setTimeout( function() {\r\n      //window.clearTimeout(member._timer)\r\n      clearTimeout(_mTimer)\r\n      contextMenuStatus = false\r\n      setShowTitle(false)\r\n    }, (_delay * 1000))\r\n  }\r\n\r\n  const handlerForContent:UserHandlersPartial = Object.assign({}, handlerForTitle)\r\n  handlerForContent.onDrag = (args: FullGestureState<'drag'>) => {\r\n    //  console.log('onDragBody:', args.delta)\r\n    if (isFixed || map.keyInputUsers.has(props.content.id)) { return }\r\n    handlerForTitle.onDrag?.call(this, args)\r\n  }\r\n\r\n  function onResizeStart(evt:React.MouseEvent<HTMLDivElement> | React.TouchEvent<HTMLDivElement>){\r\n    if(showTitle) {return}\r\n    member.dragCanceled = false\r\n    evt.stopPropagation(); evt.preventDefault()\r\n    setResizeBase(size)\r\n    setResizeBasePos(pose.position)\r\n  }\r\n  function onResizeStop(){\r\n    if(showTitle) {return}\r\n    if (!member.dragCanceled){ updateHandler() }\r\n    member.dragCanceled = false\r\n  }\r\n  function onResize(evt:MouseEvent | TouchEvent, dir: any, elem:HTMLDivElement, delta:any, pos:any) {\r\n    if(showTitle) {return}\r\n    evt.stopPropagation(); evt.preventDefault()\r\n    //  console.log(`dragcancel:${member.dragCanceled}`)\r\n    if (member.dragCanceled) {\r\n      setPoseAndSizeToRnd()\r\n      return\r\n    }\r\n\r\n    const scale = (extractScaleX(map.matrix) + extractScaleY(map.matrix)) / 2\r\n    const cd:[number, number] = [delta.width / scale, delta.height / scale]\r\n    // console.log('resize dir:', dir, ' delta:', delta, ' d:', d, ' pos:', pos)\r\n    /* if (dir === 'left' || dir === 'right') {\r\n      cd[1] = 0\r\n    }\r\n    if (dir === 'top' || dir === 'bottom') {\r\n      cd[0] = 0\r\n    } */\r\n    let posChange = false\r\n    const deltaPos: [number, number] = [0, 0]\r\n\r\n    /* if (dir === 'left' || dir === 'topLeft' || dir === 'bottomLeft') {\r\n      deltaPos[0] = -cd[0]\r\n      posChange = posChange || cd[0] !== 0\r\n    }\r\n    if (dir === 'top' || dir === 'topLeft' || dir === 'topRight') {\r\n      deltaPos[1] = -cd[1]\r\n      posChange = posChange || cd[1] !== 0\r\n    } */\r\n\r\n    if (dir === 'bottomLeft') {\r\n      deltaPos[0] = -cd[0]\r\n      posChange = posChange || cd[0] !== 0\r\n    } else\r\n    if (dir === 'topRight') {\r\n      deltaPos[1] = -cd[1]\r\n      posChange = posChange || cd[1] !== 0\r\n    }\r\n    if (dir === 'topLeft') {\r\n      deltaPos[1] = -cd[1]\r\n      posChange = posChange || cd[1] !== 0\r\n    }\r\n\r\n    if (posChange) {\r\n      pose.position = addV2(resizeBasePos, deltaPos)\r\n      setPose(Object.assign({}, pose))\r\n      //console.log(`setPose ${pose.position}`)\r\n    }\r\n    const newSize = addV2(resizeBase, cd)\r\n    if(newSize[0] > 80 && newSize[1] > 80) {\r\n      if (props.content.originalSize[0]) {\r\n        const ratio = props.content.originalSize[0] / props.content.originalSize[1]\r\n        if (newSize[0] > ratio * newSize[1]) { newSize[0] = ratio * newSize[1] }\r\n        if (newSize[0] < ratio * newSize[1]) { newSize[1] = newSize[0] / ratio }\r\n      }\r\n      setSize(newSize)\r\n    } else {\r\n      updateHandler()\r\n    }\r\n  }\r\n\r\n\r\n  //const classes = useStyles({props, pose, size, showTitle, pinned:props.content.pinned, dragging, editing})\r\n  const classes = useStyles({props, pose, size, showTitle, showBorder, pinned:props.content.pinned, dragging, editing, downPos:member.downPos, downXPos:member.downXPos, _down:member._down, _title:titleDisplay, pingX:member.pingX, pingY:member.pingY})\r\n  //  console.log('render: TITLE_HEIGHT:', TITLE_HEIGHT)\r\n  const contentRef = React.useRef<HTMLDivElement>(null)\r\n  const formRef = React.useRef<HTMLDivElement>(null)\r\n  const gestureForContent = useGesture(handlerForContent)\r\n  const gestureForTitle = useGesture(handlerForTitle)\r\n  /* const theContent =\r\n    <div className={classes.rndContainer} {...gestureForContent()}>\r\n      <div className={classes.titlePosition} {...gestureForTitle()}>\r\n        <div className={classes.titleContainer}\r\n            onMouseEnter = {() => { if (props.autoHideTitle) { setShowTitle(true) } }}\r\n            onMouseLeave = {() => {\r\n              if (props.autoHideTitle && !editing && props.content.pinned) { setShowTitle(false) } }}\r\n            onTouchStart = {() => {\r\n              if (props.autoHideTitle) {\r\n                if (!showTitle) {\r\n                  setShowTitle(true)\r\n                }else if (props.content.pinned) {\r\n                  setShowTitle(false)\r\n                }\r\n              }\r\n            }}\r\n            onContextMenu = {() => {\r\n              setShowForm(true)\r\n              map.keyInputUsers.add('contentForm')\r\n            }}\r\n            >\r\n          <div className={classes.type}>\r\n            {contentTypeIcons(props.content.type, TITLE_HEIGHT, TITLE_HEIGHT*1.1)}\r\n          </div>\r\n          <Tooltip placement=\"top\" title={props.content.pinned ? t('ctUnpin') : t('ctPin')} >\r\n          <div className={classes.pin} onClick={onClickPin} onTouchStart={stop}>\r\n            <Icon icon={props.content.pinned ? pinIcon : pinOffIcon} height={TITLE_HEIGHT} width={TITLE_HEIGHT*1.1} />\r\n          </div></Tooltip>\r\n          <Tooltip placement=\"top\" title={editButtonTip(editing, props.content)} >\r\n            <div className={classes.edit} onClick={onClickEdit} onTouchStart={stop}>\r\n             {\r\n              editing ? <DoneIcon style={{fontSize:TITLE_HEIGHT}} />\r\n                : <EditIcon style={{fontSize:TITLE_HEIGHT}} />}\r\n            </div>\r\n          </Tooltip>\r\n          {props.content.pinned ? undefined :\r\n            <Tooltip placement=\"top\" title={t('ctMoveTop')} >\r\n              <div className={classes.titleButton} onClick={onClickMoveToTop}\r\n                onTouchStart={stop}><FlipToFrontIcon /></div></Tooltip>}\r\n          {props.content.pinned ? undefined :\r\n            <Tooltip placement=\"top\" title={t('ctMoveBottom')} >\r\n              <div className={classes.titleButton} onClick={onClickMoveToBottom}\r\n                onTouchStart={stop}><FlipToBackIcon /></div></Tooltip>}\r\n\r\n\r\n          <Tooltip placement=\"top\" title={t('ctCopyToClipboard')} >\r\n            <div className={classes.titleButton} onClick={onClickCopy}\r\n              onTouchStart={stop}>\r\n                <Icon icon={clipboardCopy} height={TITLE_HEIGHT}/>\r\n            </div>\r\n          </Tooltip>\r\n          {isContentMaximizable(props.content) ?\r\n            <Tooltip placement=\"top\" title={zoomed ? t('ctUnMaximize') : t('ctMaximize')} >\r\n              <div className={classes.titleButton} onClick={onClickMaximize}\r\n                onTouchStart={stop}>\r\n                  <Icon icon={zoomed ? minimizeIcon: maximizeIcon} height={TITLE_HEIGHT}/>\r\n              </div>\r\n            </Tooltip> : undefined}\r\n          <div className={classes.titleButton} onClick={onClickMore} onTouchStart={stop} ref={formRef}>\r\n              <MoreHorizIcon />\r\n          </div>\r\n          <SharedContentForm open={showForm} {...props} close={onCloseForm}\r\n            anchorEl={contentRef.current} anchorOrigin={{vertical:'top', horizontal:'right'}}\r\n          />\r\n          <div className={classes.note} onClick={onClickShare} onTouchStart={stop}>Share</div>\r\n          {props.content.playback ? <div className={classes.close} ><PlayArrowIcon htmlColor=\"#0C0\" /></div> :\r\n            (props.content.pinned || isContentWallpaper(props.content)) ? undefined :\r\n              <div className={classes.close} onClick={onClickClose} onTouchStart={stop}>\r\n                <CloseRoundedIcon /></div>}\r\n        </div>\r\n      </div>\r\n      <div className={classes.content} ref={contentRef}\r\n        onFocus={()=>{\r\n          if (doseContentEditingUseKeyinput(props.content) && editing){\r\n            map.keyInputUsers.add(props.content.id)\r\n          }\r\n        }}\r\n        onBlur={()=>{\r\n          if (doseContentEditingUseKeyinput(props.content) && editing){\r\n            map.keyInputUsers.delete(props.content.id)\r\n          }\r\n        }}\r\n      >\r\n        <Content {...props}/>\r\n      </div>\r\n    </div> */\r\n  //  console.log('Rnd rendered.')\r\n\r\n  const theContent =\r\n    <div className={classes.rndContainer} {...gestureForContent()}>\r\n      <div className={classes.content} ref={contentRef}\r\n        onFocus={()=>{\r\n          if (doseContentEditingUseKeyinput(props.content) && editing){\r\n            map.keyInputUsers.add(props.content.id)\r\n          }\r\n        }}\r\n        onBlur={()=>{\r\n          if (doseContentEditingUseKeyinput(props.content) && editing){\r\n            map.keyInputUsers.delete(props.content.id)\r\n          }\r\n        }}\r\n      >\r\n        <Content {...props}\r\n        />\r\n        {/* {console.log(props.content.pose.orientation, \" ORIEN\")} */}\r\n        <div className={classes.nameContainerHolder}>\r\n          <div className={classes.nameContainer}>{props.content.name}</div>\r\n        </div>\r\n        <div className={classes.stopWatchTitleHolder}>\r\n          <div className={classes.stopWatchTitle}>{stopTimeValue}</div>\r\n        </div>\r\n        {/* <div className={showBorder ? classes.dashed : undefined}></div> */}\r\n        <div className={(showHandler && showTitle === false) ? classes.dashedInEdit : (showBorder && (props.content.zone === 'close') ? classes.dashed : undefined)}></div>\r\n{/* {showHandler ? */}\r\n<div style={{position:'absolute', width:size[0], height:size[1], top:0, left:0/* , backgroundColor:'green' */}}\r\n      >\r\n        { (showHandler && showTitle === false) ?\r\n        <div>\r\n        <div style={{width:'40px', height:'40px'/* , border:'2px dashed  #FF000050' */, position:'absolute', left:'-10px', top:'-10px', backgroundColor:'#9e886c', borderRadius:'50%'}}>\r\n          <Icon icon={crossIcon} style={{width:TITLE_HEIGHT/1.5, height:TITLE_HEIGHT/1.5, color:'white', position:'absolute', left:'9px', top:'9px'}} />\r\n        </div>\r\n        <div style={{width:'40px', height:'40px'/* , border:'2px dashed  #FF000050' */, position:'absolute', left:(size[0] - 30), top:'-10px', backgroundColor:'#9e886c', borderRadius:'50%'}}>\r\n        <Icon icon={crossIcon} style={{width:TITLE_HEIGHT/1.5, height:TITLE_HEIGHT/1.5, color:'white', position:'absolute', left:'8.5px', top:'8px'}} />\r\n        </div>\r\n        <div style={{width:'40px', height:'40px'/* , border:'2px dashed  #FF000050' */, position:'absolute', left:(size[0] - 30) + 'px', top:(size[1] - 30) + 'px', backgroundColor:'#9e886c', borderRadius:'50%'}}\r\n          /* onMouseOut={()=>{\r\n            console.log(\"still over\")\r\n          }} */\r\n          >\r\n          <Icon icon={crossIcon} style={{width:TITLE_HEIGHT/1.5, height:TITLE_HEIGHT/1.5, color:'white', position:'absolute', left:'8px', top:'9px'}} />\r\n        </div>\r\n        {/* <div style={{width:(size[0] + 40), height:(size[1] + 40), position:'absolute', left: '-20px', top:'-20px', backgroundColor:'#D4D4D480', alignItems:'center' }}>\r\n        </div> */}\r\n        <div style={{width:'40px', height:'40px'/* , border:'2px dashed  #FF000050' */, position:'absolute', left:'-10px', top:(size[1] - 30) + 'px', backgroundColor:'#9e886c', borderRadius:'50%'}}>\r\n          <Icon icon={crossIcon} style={{width:TITLE_HEIGHT/1.5, height:TITLE_HEIGHT/1.5, color:'white', position:'absolute', left:'9px', top:'9px'}} />\r\n        </div>\r\n\r\n        <div style={{width:'40px', height:'40px', /* border:'2px dashed  #FF000050', */ position:'absolute', left: (size[0]/2 - 20)/* (size[0]/2) - 15 */, top:(size[1]/2) - 20, backgroundColor:'#9e886c', borderRadius:'50%'}}\r\n        >\r\n        <RotateRightIcon style={{width:TITLE_HEIGHT, height:TITLE_HEIGHT, color:'white', position:'absolute', left:'2px', top:'3px'}} />\r\n        </div>\r\n        </div>\r\n        : ''}\r\n      </div>\r\n      </div>\r\n      <div className={classes.titlePosition} {...gestureForTitle() /* title can be placed out of Rnd */}>\r\n      <div className={classes.titleContainer}\r\n           onMouseLeave = {() => {\r\n          }}\r\n            onContextMenu = {() => {\r\n              setShowForm(true)\r\n              map.keyInputUsers.add('contentForm')\r\n            }}\r\n            >\r\n              <SharedContentForm open={showForm} {...props} close={onCloseForm}\r\n            anchorEl={contentRef.current} anchorOrigin={{vertical:'top', horizontal:'right'}}\r\n          />\r\n            </div>\r\n\r\n            {/* Dialog for deleting content confirmation */}\r\n        {/* {showDelete ? */}\r\n        <Dialog open={showDelete} onClose={() => setShowDelete(false)} onExited={() => setShowDelete(false)}\r\n        keepMounted\r\n        style={showDelete ? {zIndex:9999, transform:isSmartphone() ? 'scale(2)' : 'scale(1)'} : {zIndex:-9999, transform:isSmartphone() ? 'scale(2)' : 'scale(1)'}}\r\n        BackdropProps={{ invisible: true }}\r\n        >\r\n          <DialogContent style={{userSelect: 'none', fontSize:'25px', fontWeight:'bold'}}>\r\n            {\r\n            t('deleteMsg') + _msgTitle\r\n            }\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button variant=\"contained\" /* color=\"secondary\" */ style={{textTransform:'none', marginTop:'0.4em', backgroundColor:'orange', height:'40px', fontSize:'20px', fontWeight:'bold'}}\r\n            onClick={(ev) => {\r\n              setShowDelete(false)\r\n              //_contentDeleteDialogOpen = false\r\n            }}>{t('deleteNo')}</Button>\r\n            <Button variant=\"contained\" /* color=\"secondary\" */ style={{textTransform:'none', marginTop:'0.4em', backgroundColor:'#7ececc', height:'40px', fontSize:'20px', fontWeight:'bold'}}\r\n            onClick={(ev) => {\r\n              setShowDelete(false)\r\n              //_contentDeleteDialogOpen = false\r\n              //stop(ev)\r\n              props.onClose?.call(null, ev)\r\n            }}>{t('deleteYes')}</Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n      </div>\r\n    </div>\r\n\r\n\r\n  return (\r\n    <div className={classes.container} style={{zIndex:props.content.zIndex}} onContextMenu={\r\n      (evt) => {\r\n        evt.stopPropagation()\r\n        evt.preventDefault()\r\n      }\r\n    }>\r\n\r\n      {/* <Rnd className={classes.rndCls} enableResizing={isFixed ? resizeDisable : resizeEnable}\r\n        disableDragging={isFixed} ref={rnd}\r\n        onResizeStart = {onResizeStart}\r\n        onResize = {onResize}\r\n        onResizeStop = {onResizeStop}\r\n      >\r\n        {theContent}\r\n      </Rnd> */}\r\n\r\n      {(props.content.shareType !== 'roomimg' && props.content.shareType !== 'appimg') ?\r\n        <Rnd className={classes.rndCls} enableResizing={showTitle ? resizeDisable : (showHandler ? resizeEnable : resizeDisable)}\r\n        disableDragging={isFixed} ref={rnd}\r\n       /*  disableDragging={showTitle} ref={rnd}\r\n        disableDragging={false} ref={rnd} */\r\n        onResizeStart = {onResizeStart}\r\n        onResize = {onResize}\r\n        onResizeStop = {onResizeStop}\r\n        /* bounds = {'body'} */\r\n        resizeHandleStyles={{\r\n          topLeft: cursorStyles,\r\n          topRight: cursorStyles,\r\n          bottomLeft: cursorStyles,\r\n          bottomRight: cursorStyles,\r\n        }}\r\n        dragHandleClassName={classes.cursorStyles}\r\n        /* default={{\r\n          x: 0,\r\n          y: 0,\r\n          width: props.content.size[0] * 1.5,\r\n          height: props.content.size[1] * 1.5,\r\n        }} */\r\n      >\r\n          {theContent}\r\n      </Rnd> : ''}\r\n\r\n      <ShareDialog {...props} open={showUploadOption} onClose={() => setShowUploadOption(false)} cordX={pose.position[0] + member.downXPos} cordY={pose.position[1] + member.downPos} origin={'contextmenu'} _type={'menu'}/>\r\n\r\n      {/*  {showTitle ? */}\r\n      <Dialog open={showTitle} onClose={() => setShowTitle(false)} onExited={() => setShowTitle(false)}\r\n      keepMounted\r\n        PaperProps={{\r\n          style: {\r\n            backgroundColor: 'transparent',\r\n            position:'absolute',\r\n            boxShadow: 'none',\r\n            overflow:'hidden',\r\n            //width:'600px',\r\n            //height: '500px',\r\n            //left: props.content.pose.position[0] - props.stores.map.mouseOnMap[0],\r\n            //top:props.stores.map.mouseOnMap[1],\r\n            left: Number(member._clickX) - 207,\r\n            top: Number(member._clickY) - 170,\r\n            zIndex: showTitle ? 999 : -999,\r\n            transform: isSmartphone() ? 'scale(2.5)' : 'scale(1)',\r\n          },\r\n        }}\r\n        BackdropProps={{ invisible: true }}\r\n        >\r\n        <DialogContent style={showTitle ? {transform:'scale(1.1)', transition:'0s ease-out'} : {transform:'scale(0)', transition:'0s ease-out'}}>\r\n        {/* <Zoom in={showTitle} style={{ transitionDelay: showTitle ? '0ms' : '0ms' }}> */}\r\n        <Zoom in={showTitle} style={{ transition: showTitle ? '500ms' : '0ms' }}>\r\n          <div className={classes.titleContainer_dialog}\r\n              onMouseLeave = {() => {\r\n                //console.log(\"out from title - \", member.onContent)\r\n                //member._item = \"DIV\"\r\n                //clearTimeout(member._timer)\r\n                //showHideTimer()\r\n              }}\r\n                onContextMenu = {() => {\r\n                  //setShowForm(true)\r\n                  //map.keyInputUsers.add('contentForm')\r\n                }}\r\n            >\r\n\r\n           {/*  <Tooltip placement=\"top\" title={member._down ? (props.content.pinned ? t('ctUnpin') : t('ctPin')) : ''}>\r\n            <div className={classes.pin_dialog} onMouseUp={onClickPin} onTouchStart={stop} onMouseLeave={onLeaveIcon}>\r\n              <img src={props.content.pinned ? pinIcon : pinOffIcon} height={TITLE_HEIGHT} width={TITLE_HEIGHT} alt=\"\" />\r\n            </div></Tooltip> */}\r\n\r\n\r\n              <Tooltip placement=\"top\" title={member._down ? t('ctMoveTop') : ''} >\r\n                <div className={classes.moveTopButton_dialog} onMouseUp={onClickMoveToTop}\r\n                  onTouchStart={stop} onMouseLeave={onLeaveIcon}>\r\n                    <img id='contextFlipFront' src={FlipToFrontIcon} height={TITLE_HEIGHT} width={TITLE_HEIGHT} alt=\"\"/>\r\n                    </div></Tooltip>\r\n              <Tooltip placement=\"top\" title={member._down ? t('ctMoveBottom') : ''} >\r\n                <div className={classes.moveBottomButton_dialog} onMouseUp={onClickMoveToBottom}\r\n                  onTouchStart={stop} onMouseLeave={onLeaveIcon}>\r\n                    <img id='contextFlipBack' src={FlipToBackIcon} height={TITLE_HEIGHT} width={TITLE_HEIGHT} alt=\"\"/>\r\n                  </div></Tooltip>\r\n            <Tooltip placement=\"top\" title={member._down ? (props.content.zone === \"close\" ? t('ctUnProximity') : t('ctProximity')) : ''} >\r\n            <div className={classes.prox_dialog} onMouseUp={onClickZone} onTouchStart={stop} onMouseLeave={onLeaveIcon}>\r\n              <img id='contextProx' src={props.content.zone === \"close\" ? proximityOffIcon : proximityIcon} height={TITLE_HEIGHT} width={TITLE_HEIGHT} alt=\"\"/>\r\n            </div>\r\n            </Tooltip>\r\n            <div className={classes.titleButton_dialog} onMouseUp={onClickMore} onTouchStart={stop} onMouseLeave={onLeaveIcon} ref={formRef}>\r\n                <img id='contextMore' src={MoreIcon} height={TITLE_HEIGHT} width={TITLE_HEIGHT} alt=\"\"/>\r\n            </div>\r\n            {/* <SharedContentForm open={showForm} {...props} close={onCloseForm}\r\n              anchorEl={contentRef.current} anchorOrigin={{vertical:'top', horizontal:'right'}}\r\n            /> */}\r\n              <div className={classes.close_dialog} onMouseUp={onClickClose} /* onTouchEnd={onClickClose} */ onTouchStart={stop} onMouseLeave={onLeaveIcon}>\r\n                <img id='contextDelete' src={CloseIcon} height={TITLE_HEIGHT} width={TITLE_HEIGHT} alt=\"\"/>\r\n              </div>\r\n            <Tooltip placement=\"bottom\" title={member._down ? t('ctUploadZone') : ''} >\r\n              <div className={classes.uploadZone_dialog} onMouseUp={onClickUploadZone}\r\n                onTouchStart={stop} onMouseLeave={onLeaveIcon}>\r\n                  <img id='contextUpload' src={UploadShare} height={TITLE_HEIGHT} width={TITLE_HEIGHT} alt=\"\"/>\r\n              </div>\r\n            </Tooltip>\r\n            <Tooltip placement=\"top\" title={member._down ? (props.content.showStopWatch ? t('ctStopWatchOff') : t('ctStopWatchOn')) : ''} >\r\n              <div className={classes.stopWatch_dialog} onMouseUp={onClickStopWatch}\r\n                onTouchStart={stop} onMouseLeave={onLeaveIcon}>\r\n                  {props.content.showStopWatch ? <StopWatchOffIcon id='contextStopWatch' style={{width:TITLE_HEIGHT, height:TITLE_HEIGHT, color:'white'}} /> :\r\n                  <StopWatchOnIcon id='contextStopWatch' style={{width:TITLE_HEIGHT, height:TITLE_HEIGHT, color:'white'}} />\r\n                  }\r\n              </div>\r\n            </Tooltip>\r\n            <Tooltip placement=\"top\" title={member._down ? (props.content.scaleRotateToggle ? t('ctUnScaleRotate') : t('ctScaleRotate')) : ''} >\r\n              <div className={classes.scaleRotate_dialog} onMouseUp={onClickScaleRotate}\r\n                onTouchStart={stop} onMouseLeave={onLeaveIcon}>\r\n                  {props.content.scaleRotateToggle ? <AspectRatioIcon id='contextScaleRotate' style={{width:TITLE_HEIGHT, height:TITLE_HEIGHT, color:'white'}} /> :\r\n                  <AspectRatioIcon id='contextScaleRotate' style={{width:TITLE_HEIGHT, height:TITLE_HEIGHT, color:'white'}} />\r\n                  }\r\n              </div>\r\n            </Tooltip>\r\n\r\n            <div className={showTitle ? classes.dashedCircle_dialog : undefined}></div>\r\n          </div>\r\n          </Zoom>\r\n        </DialogContent>\r\n        </Dialog>\r\n\r\n    </div >\r\n  )\r\n}\r\n\r\n/* const buttonStyle = {\r\n  '&:hover': {\r\n    backgroundColor: 'rosybrown',\r\n  },\r\n  '&:active': {\r\n    backgroundColor: 'firebrick',\r\n  },\r\n}\r\n\r\nconst BORDER_WIDTH = 3\r\n\r\nconst useStyles = makeStyles({\r\n  container: (props: StyleProps) => {\r\n    const mat = new DOMMatrix()\r\n    mat.rotateSelf(0, 0, props.pose.orientation)\r\n\r\n    return ({\r\n      display: props.props.hideAll ? 'none' : 'block',\r\n      width:0,\r\n      height:0,\r\n      transform: mat.toString(),\r\n      position: 'absolute',\r\n    })\r\n  },\r\n  rndCls: (props: StyleProps) => ({\r\n    borderRadius: props.showTitle ? '0.5em 0.5em 0 0' : '0 0 0 0',\r\n    backgroundColor: props.props.content.noFrame ? 'rgba(0,0,0,0)' :\r\n      settings.useTransparent ? 'rgba(200,200,200,0.5)' : 'rgba(200,200,200,1)',\r\n    boxShadow: props.props.content.noFrame ? undefined :\r\n      settings.useTransparent ? '0.2em 0.2em 0.2em 0.2em rgba(0,0,0,0.4)' :\r\n        '0.2em 0.2em 0.2em 0.2em rgba(100,100,100,1)',\r\n  }),\r\n  rndContainer: (props: StyleProps) => ({\r\n    width:'100%',\r\n    height:'100%',\r\n  }),\r\n  titlePosition: (props:StyleProps) => (\r\n    props.showTitle ?\r\n    {}\r\n    :\r\n    {\r\n      width:0,\r\n      heihgt:0,\r\n      position:'absolute',\r\n      top:0,\r\n    }\r\n  ),\r\n  titleContainer: (props:StyleProps) => {\r\n    const rv:CreateCSSProperties = {\r\n      display:'flex',\r\n      width: props.size[0],\r\n      overflow: 'hidden',\r\n      userSelect: 'none',\r\n      userDrag: 'none',\r\n    }\r\n    if (!props.showTitle) {\r\n      rv['position'] = 'absolute'\r\n      rv['bottom'] = 0\r\n    }\r\n\r\n    return rv\r\n  },\r\n  content: (props: StyleProps) => ({\r\n    position: 'absolute',\r\n    top: (props.showTitle ? TITLE_HEIGHT : 0) - (props.editing ? BORDER_WIDTH : 0),\r\n    left: props.editing ? -BORDER_WIDTH : 0,\r\n    width: props.size[0],\r\n    height: props.size[1],\r\n    userDrag: 'none',\r\n    pointerEvents: props.dragging ? 'none' : 'auto',\r\n    borderWidth: BORDER_WIDTH,\r\n    borderColor: 'yellow',\r\n    borderStyle: props.editing ? 'solid' : 'none',\r\n    cursor: props.editing ? 'default' : undefined,\r\n    opacity: props.props.content.opacity,\r\n  }),\r\n  note: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      visibility: props.props.onShare ? 'visible' : 'hidden',\r\n      whiteSpace: 'pre',\r\n      borderRadius: '0.5em 0 0 0',\r\n      ...buttonStyle,\r\n    } : {\r\n      visibility: 'hidden',\r\n    }),\r\n  pin: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: props.props.onShare ? 'none' : 'block',\r\n      height: TITLE_HEIGHT,\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      ...buttonStyle,\r\n    } : {display:'none'}\r\n  ),\r\n  titleButton: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: 'block',\r\n      height: TITLE_HEIGHT,\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      ...buttonStyle,\r\n    } : {display:'none'}\r\n  ),\r\n  edit: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: (props.props.onShare || !isContentEditable(props.props.content)) ? 'none' : 'block',\r\n      height: TITLE_HEIGHT,\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      ...buttonStyle,\r\n    } : {display:'none'}\r\n  ),\r\n  type: (props: StyleProps) => ({\r\n    display: props.showTitle ? 'block' : 'none',\r\n    height: TITLE_HEIGHT,\r\n  }),\r\n  close: (props: StyleProps) => ({\r\n    visibility: props.showTitle ? 'visible' : 'hidden',\r\n    position:'absolute',\r\n    right:0,\r\n    margin:0,\r\n    padding:0,\r\n    height: TITLE_HEIGHT,\r\n    borderRadius: '0 0.5em 0 0',\r\n    cursor: 'default',\r\n    ...buttonStyle,\r\n  }),\r\n})\r\n\r\nconst resizeEnable = {\r\n  bottom: true,\r\n  bottomLeft: true,\r\n  bottomRight: true,\r\n  left: true,\r\n  right: true,\r\n  top: true,\r\n  topLeft: true,\r\n  topRight:true,\r\n}\r\nconst resizeDisable = {\r\n  bottom: false,\r\n  bottomLeft: false,\r\n  bottomRight: false,\r\n  left: false,\r\n  right: false,\r\n  top: false,\r\n  topLeft: false,\r\n  topRight:false,\r\n} */\r\n\r\nconst buttonStyle = {\r\n  '&': {\r\n    margin: '5px',\r\n    borderRadius: '50%',\r\n    width: '35px',\r\n    height: '35px',\r\n    padding: '3px',\r\n\r\n    //border: '2px solid #9e886c',\r\n    //backgroundColor: 'white',\r\n  },\r\n\r\n  '&:hover': {\r\n    backgroundColor: 'black', //'rosybrown',\r\n    margin: '5px',\r\n    padding: '3px',\r\n    borderRadius: '50%',\r\n  },\r\n  '&:active': {\r\n    //backgroundColor: 'firebrick',\r\n    margin: '5px',\r\n    padding: '3px',\r\n    borderRadius: '50%',\r\n  },\r\n}\r\n\r\nconst buttonStyleActive = {\r\n  '&': {\r\n    margin: '5px',\r\n    borderRadius: '50%',\r\n    width: '35px',\r\n    height: '35px',\r\n    padding: '3px',\r\n\r\n    //border: '2px solid #9e886c',\r\n    //backgroundColor: 'white',\r\n  },\r\n\r\n  '&:hover': {\r\n    backgroundColor: '#B34700', //'rosybrown',\r\n    margin: '5px',\r\n    padding: '3px',\r\n    borderRadius: '50%',\r\n  },\r\n  '&:active': {\r\n    //backgroundColor: 'firebrick',\r\n    margin: '5px',\r\n    padding: '3px',\r\n    borderRadius: '50%',\r\n  },\r\n}\r\n\r\nconst buttonStyleDisabled = {\r\n  '&': {\r\n    margin: '5px',\r\n    borderRadius: '50%',\r\n    width: '35px',\r\n    height: '35px',\r\n    padding: '3px',\r\n    //border: '2px solid #9e886c',\r\n    //backgroundColor: 'white',\r\n  },\r\n\r\n  '&:hover': {\r\n    backgroundColor: '#9e886c', //'rosybrown',\r\n    margin: '5px',\r\n    padding: '3px',\r\n    borderRadius: '50%',\r\n  },\r\n  '&:active': {\r\n    //backgroundColor: 'firebrick',\r\n    margin: '5px',\r\n    padding: '3px',\r\n    borderRadius: '50%',\r\n  },\r\n}\r\n\r\nconst BORDER_WIDTH = 3\r\n\r\nconst useStyles = makeStyles({\r\n  container: (props: StyleProps) => {\r\n    const mat = new DOMMatrix()\r\n    mat.rotateSelf(0, 0, props.pose.orientation)\r\n\r\n    return ({\r\n      display: props.props.hideAll ? 'none' : 'block',\r\n      width:0,\r\n      height:0,\r\n      transform: mat.toString(),\r\n      position: 'absolute',\r\n    })\r\n  },\r\n  rndCls: (props: StyleProps) => ({\r\n    borderRadius: props.showTitle ? '0.5em 0.5em 0 0' : '0 0 0 0',\r\n    backgroundColor: props.props.content.noFrame ? 'rgba(0,0,0,0)' :\r\n      settings.useTransparent ? 'rgba(200,200,200,0.5)' : 'rgba(200,200,200,1)',\r\n    boxShadow: props.props.content.noFrame ? undefined :\r\n      settings.useTransparent ? '0.2em 0.2em 0.2em 0.2em rgba(0,0,0,0.4)' :\r\n        '0.2em 0.2em 0.2em 0.2em rgba(100,100,100,1)',\r\n  }),\r\n  rndContainer: (props: StyleProps) => ({\r\n    width:'100%',\r\n    height:'100%',\r\n  }),\r\n\r\n  dashed:(props: StyleProps) => ({\r\n    position: (props.props.content.showTitle ? 'absolute' : 'relative'),\r\n    width:(props.size[0] + 8),\r\n    height:(props.size[1] + 8),\r\n    borderWidth:2,\r\n    borderStyle: 'dashed',\r\n    borderColor:'red',\r\n    borderRadius:0,\r\n    top: (props.props.content.showTitle ? '-5px' : ((-(props.size[1])) - 6) + \"px\"),\r\n    left: '-6px',\r\n  }),\r\n\r\n  dashedInEdit:(props: StyleProps) => ({\r\n    position: (props.props.content.showTitle ? 'absolute' : 'relative'),\r\n    width:(props.size[0] + 8),\r\n    height:(props.size[1] + 8),\r\n    borderWidth:2,\r\n    borderStyle: 'dashed',\r\n    borderColor:'#9e886c',\r\n    borderRadius:0,\r\n    top: (props.props.content.showTitle ? '-5px' : ((-(props.size[1])) - 6) + \"px\"),\r\n    left: '-6px',\r\n  }),\r\n\r\n\r\n  titlePosition: (props:StyleProps) => (\r\n    props.showTitle ?\r\n    {}\r\n    :\r\n    {\r\n      width:0,\r\n      heihgt:0,\r\n      position:'absolute',\r\n      top:0,\r\n    }\r\n  ),\r\n  dashedCircle: (props: StyleProps) => ({\r\n    position: 'relative',\r\n    width:200,\r\n    height:200,\r\n    borderWidth:2,\r\n    borderStyle: 'solid',\r\n    borderColor:'#9e886c',\r\n    borderRadius:'50%',\r\n    opacity: 0.4,\r\n    top: 20,\r\n    left: 31,\r\n    //backgroundColor: 'transparent',\r\n    background: 'radial-gradient(#ffffff, #ffffff, #ffffff, #9e886c, #9e886c)',\r\n    zIndex: -9999,\r\n  }),\r\n\r\n  dashedCircle_dialog: (props: StyleProps) => ({\r\n    position: 'relative',\r\n    width:220,\r\n    height:220,\r\n    borderWidth:2,\r\n    borderStyle: 'solid',\r\n    borderColor:'#9e886c',\r\n    borderRadius:'50%',\r\n    opacity: 0.4,\r\n    top: 15,\r\n    left: 35,\r\n    //backgroundColor: 'transparent',\r\n    background: 'radial-gradient(#ffffff, #ffffff, #ffffff, #9e886c, #9e886c)',\r\n    zIndex: -9999,\r\n  }),\r\n\r\n\r\n  titleContainer_dialog: (props:StyleProps) => {\r\n    const rv:CreateCSSProperties = {\r\n      display: 'flex',\r\n      width:'300px',\r\n      height:'250px',\r\n      backgroundColor:'transparent',\r\n      position:'relative',\r\n      //transform: 'scale(0)',\r\n      //transition: '0.3s ease-out',\r\n      cursor: 'default',\r\n    }\r\n    if (!props.showTitle) {\r\n      rv['display'] = 'flex'\r\n      rv['position'] = 'relative'\r\n      rv['bottom'] = 'auto'\r\n      rv['top'] = 'auto'\r\n      rv['left'] = 'auto'\r\n      //rv['transform'] = 'scale(0)'\r\n    } else {\r\n      rv['display'] = 'flex'\r\n      rv['position'] = 'relative'\r\n      rv['bottom'] = 'auto'\r\n      // Scale Accordingly\r\n      //rv['transform'] = 'scale(1)'\r\n      }\r\n    return rv\r\n  },\r\n\r\n  titleContainer: (props:StyleProps) => {\r\n    const rv:CreateCSSProperties = {\r\n      display: 'flex',\r\n      position: 'relative',\r\n      width: (props.pinned ? 350 : 350), //props.size[0],\r\n      height: (props.pinned ? 250 : 250), //props.size[0],\r\n      overflow: 'hidden',\r\n      userSelect: 'none',\r\n      userDrag: 'none',\r\n      top: 'auto',\r\n      left: 'auto',\r\n      bottom: 'auto',\r\n      transform: 'scale(0)',\r\n\r\n      //top: '200px',\r\n      //backgroundColor: 'red',\r\n      backgroundColor: 'transparent',\r\n      transition: '0.3s ease-out',\r\n      cursor: 'default',\r\n    }\r\n    if (!props.showTitle) {\r\n      rv['display'] = 'flex'\r\n      rv['position'] = 'relative'\r\n      rv['bottom'] = 'auto'\r\n      rv['top'] = 'auto'\r\n      rv['left'] = 'auto'\r\n      rv['transform'] = 'scale(0)'\r\n    } else {\r\n      rv['display'] = 'flex'\r\n      rv['position'] = 'relative'\r\n      rv['bottom'] = 'auto'\r\n      // New Changes [Making menu normal]\r\n      var zoomValue = Number(props.props.stores.map.matrix.a)\r\n      //console.log(zoomValue, \" zoomValue\")\r\n      var zoomRatio = 1.2/zoomValue;\r\n      var tPos =  165 + (2.7 * zoomValue)\r\n      var lPos = 0\r\n      if(zoomValue >= 1 && zoomValue < 5) {\r\n        lPos = 380 - (6 * zoomValue)\r\n      } else if(zoomValue === 5) {\r\n        lPos = 382 - (5 * zoomValue)\r\n      } else if(zoomValue < 0.34) {\r\n        lPos = 500 - (1 * zoomValue)\r\n      } else if(zoomValue > 0.34 && zoomValue < 0.4) {\r\n        lPos = 465 - (1 * zoomValue)\r\n      } else {\r\n        lPos = 400 - (1 * zoomValue)\r\n      }\r\n      rv['top'] = (props.downPos - ((tPos/2))) // 165\r\n      rv['left'] = props.props.content.shareType === 'img' ? (props.downXPos - (360/2)) : (props.downXPos - ((lPos/2))) // 380\r\n\r\n      // Scale Accordingly\r\n      rv['transform'] = 'scale('+zoomRatio+')'\r\n      }\r\n    return rv\r\n  },\r\n  content: (props: StyleProps) => ({\r\n    position: 'absolute',\r\n    top: (props.showTitle ? TITLE_HEIGHT : 0) - (props.editing ? BORDER_WIDTH : 0),\r\n    left: props.editing ? -BORDER_WIDTH : 0,\r\n    width: props.size[0],\r\n    height: props.size[1],\r\n    userDrag: 'none',\r\n    pointerEvents: props.dragging ? 'none' : 'auto',\r\n    borderWidth: BORDER_WIDTH,\r\n    borderColor: 'yellow',\r\n    borderStyle: props.editing ? 'solid' : 'none',\r\n    cursor: props.editing ? 'default' : undefined,\r\n    opacity: props.props.content.opacity,\r\n  }),\r\n  note: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      //visibility: props.props.onShare ? 'visible' : 'hidden',\r\n      visibility: 'hidden',\r\n      whiteSpace: 'pre',\r\n      //borderRadius: '0.5em 0 0 0',\r\n      position: 'relative',\r\n      top: 143,\r\n      left: 170,\r\n      ...buttonStyle,\r\n    } : {\r\n      visibility: 'hidden',\r\n    }),\r\n  pin: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: props.props.onShare ? 'none' : 'block',\r\n      height: TITLE_HEIGHT,\r\n      position:'absolute',\r\n      textAlign: 'center',\r\n      top: 128, //77,\r\n      left: 86, //60,\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      //transform: \"rotate(-75deg)\",\r\n      background: props.pinned ? '#ef4623' : '#9e886c',\r\n      ...props.pinned ?  (props._down ? buttonStyle : buttonStyleActive) : (props._down ? buttonStyle : buttonStyleDisabled),\r\n    } : {display:'none'}\r\n  ),\r\n\r\n  pin_dialog: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: props.props.onShare ? 'none' : 'block',\r\n      height: TITLE_HEIGHT,\r\n      position:'absolute',\r\n      textAlign: 'center',\r\n      top: 150, //128,\r\n      left: 47, //38,\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      background: props.pinned ? '#ef4623' : '#9e886c',\r\n      ...props.pinned ?  (props._down ? buttonStyle : buttonStyleActive) : (props._down ? buttonStyle : buttonStyleDisabled),\r\n    } : {display:'none'}\r\n  ),\r\n\r\n  prox: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: props.props.onShare ? 'none' : 'block',\r\n      height: TITLE_HEIGHT,\r\n      position:'relative',\r\n      top: 78, //27,\r\n      left: 82, //82,\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      //transform: \"rotate(60deg)\",\r\n      background: props.props.content.zone === \"close\" ? '#ef4623' : '#9e886c',\r\n      ...props.props.content.zone === \"close\" ?  (props._down ? buttonStyle : buttonStyleActive) : (props._down ? buttonStyle : buttonStyleDisabled),\r\n    } : {display:'none'}\r\n  ),\r\n\r\n  prox_dialog: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: props.props.onShare ? 'none' : 'block',\r\n      height: TITLE_HEIGHT,\r\n      position:'absolute',\r\n      top: 128, //100, //76,\r\n      left: 38, //34, //37,\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      background: props.props.content.zone === \"close\" ? '#ef4623' : '#9e886c',\r\n      ...props.props.content.zone === \"close\" ?  (props._down ? buttonStyle : buttonStyleActive) : (props._down ? buttonStyle : buttonStyleDisabled),\r\n    } : {display:'none'}\r\n  ),\r\n\r\n\r\n  titleButton: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: 'block',\r\n      height: TITLE_HEIGHT,\r\n      textAlign: 'center',\r\n      whiteSpace: 'pre',\r\n      position:'absolute',\r\n      cursor: 'default',\r\n      top: 127, //77,\r\n      left: 230, //258,\r\n      //transform: \"rotate(90deg)\",\r\n      background: '#9e886c',\r\n      ...buttonStyle,\r\n    } : {display:'none'}\r\n  ),\r\n\r\n  titleButton_dialog: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: 'block',\r\n      height: TITLE_HEIGHT,\r\n      textAlign: 'center',\r\n      whiteSpace: 'pre',\r\n      position:'absolute',\r\n      cursor: 'default',\r\n      top: 128, //150, //128,\r\n      left: 205, //195, //205,\r\n      background: '#9e886c',\r\n      ...buttonStyle,\r\n    } : {display:'none'}\r\n  ),\r\n\r\n  uploadZone: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: 'block',\r\n      height: TITLE_HEIGHT,\r\n      position:'absolute',\r\n      textAlign: 'center',\r\n      /* top: 172,\r\n      left: 138, */\r\n      top: 175,\r\n      left: 160,\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      background: '#9e886c',\r\n      ...buttonStyle,\r\n    } : {display:'none'}\r\n  ),\r\n\r\n  uploadZone_dialog: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: 'block',\r\n      height: TITLE_HEIGHT,\r\n      position:'absolute',\r\n      textAlign: 'center',\r\n      top: 190,\r\n      left: 125,\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      background: '#9e886c',\r\n      ...buttonStyle,\r\n    } : {display:'none'}\r\n  ),\r\n\r\n  stopWatch: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: props.props.onShare ? 'none' : 'block',\r\n      height: TITLE_HEIGHT,\r\n      position:'absolute',\r\n      textAlign: 'center',\r\n      top: 36,\r\n      left: 110,\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      //...buttonStyle,\r\n      background:  props.props.content.showStopWatch ? '#ef4623' : '#9e886c',\r\n      ...props.props.content.showStopWatch ?  (props._down ? buttonStyle : buttonStyleActive) : (props._down ? buttonStyle : buttonStyleDisabled),\r\n    } : {display:'none'}\r\n  ),\r\n\r\n  stopWatch_dialog: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: props.props.onShare ? 'none' : 'block',\r\n      height: TITLE_HEIGHT,\r\n      position:'absolute',\r\n      textAlign: 'center',\r\n      top: 76, //52, //33,\r\n      left: 37, //50, //68,\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      background:  props.props.content.showStopWatch ? '#ef4623' : '#9e886c',\r\n      ...props.props.content.showStopWatch ?  (props._down ? buttonStyle : buttonStyleActive) : (props._down ? buttonStyle : buttonStyleDisabled),\r\n    } : {display:'none'}\r\n  ),\r\n\r\n  scaleRotate_dialog: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: props.props.onShare ? 'none' : 'block',\r\n      height: TITLE_HEIGHT,\r\n      position:'absolute',\r\n      textAlign: 'center',\r\n      top: 33, //20, //33,\r\n      left: 68, //92, //68,\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      background:  props.props.content.scaleRotateToggle ? '#ef4623' : '#9e886c',\r\n      ...props.props.content.showStopWatch ?  (props._down ? buttonStyle : buttonStyleActive) : (props._down ? buttonStyle : buttonStyleDisabled),\r\n    } : {display:'none'}\r\n  ),\r\n\r\n  uploadImage: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: 'block',\r\n      height: TITLE_HEIGHT,\r\n      position:'absolute',\r\n      textAlign: 'center',\r\n      top: 190,\r\n      left: 186,\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      background: '#9e886c',\r\n      ...buttonStyle,\r\n    } : {display:'none'}\r\n  ),\r\n\r\n  moveTopButton: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: 'block',\r\n      height: TITLE_HEIGHT,\r\n      position:'absolute',\r\n      textAlign: 'center',\r\n      top: 18, //0,\r\n      left: 158,\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      //transform: \"rotate(-60deg)\",\r\n      background: '#9e886c',\r\n      ...buttonStyle,\r\n    } : {display:'none'}\r\n  ),\r\n\r\n  moveTopButton_dialog: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: 'block',\r\n      height: TITLE_HEIGHT,\r\n      position:'absolute',\r\n      textAlign: 'center',\r\n      top: 14, //18, //14,\r\n      left: 120, //148, //120,\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      background: '#9e886c',\r\n      ...buttonStyle,\r\n    } : {display:'none'}\r\n  ),\r\n\r\n  moveBottomButton: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: 'block',\r\n      height: TITLE_HEIGHT,\r\n      position:'absolute',\r\n      textAlign: 'center',\r\n      top: 35, //0,\r\n      left: 206,\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      //transform: \"rotate(45deg)\",\r\n      background: '#9e886c',\r\n      ...buttonStyle,\r\n    } : {display:'none'}\r\n  ),\r\n\r\n  moveBottomButton_dialog: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: 'block',\r\n      height: TITLE_HEIGHT,\r\n      position:'absolute',\r\n      textAlign: 'center',\r\n      top: 32, //49, //32,\r\n      left: 174, //192, //174,\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      background: '#9e886c',\r\n      ...buttonStyle,\r\n    } : {display:'none'}\r\n  ),\r\n\r\n  copyClipButton: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: 'block',\r\n      height: TITLE_HEIGHT,\r\n      position:'absolute',\r\n      top: '0px',\r\n      left: '185px',\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      //transform: \"rotate(45deg)\",\r\n      background: '#9e886c',\r\n      ...buttonStyle,\r\n    } : {display:'none'}\r\n  ),\r\n\r\n  edit: (props:StyleProps) => (\r\n    props.showTitle ? {\r\n      display: (props.props.onShare || !isContentEditable(props.props.content)) ? 'none' : 'block',\r\n      height: TITLE_HEIGHT,\r\n      whiteSpace: 'pre',\r\n      cursor: 'default',\r\n      background: '#9e886c',\r\n      position: 'absolute',\r\n      top: 147,\r\n      left: 217,\r\n      ...buttonStyle,\r\n    } : {display:'none'}\r\n  ),\r\n  type: (props: StyleProps) => ({\r\n    display: props.showTitle ? 'block' : 'none',\r\n    height: TITLE_HEIGHT,\r\n    position:'absolute',\r\n    top: 105,\r\n    left: 50,\r\n    //transform: \"rotate(75deg)\",\r\n    background: '#9e886c',\r\n    ...buttonStyle,\r\n  }),\r\n  close: (props: StyleProps) => ({\r\n    visibility: props.showTitle ? 'visible' : 'hidden',\r\n    position:'absolute',\r\n    textAlign: 'left',\r\n    top: 78, //27,\r\n    left: 234, //233,\r\n    right:0,\r\n    margin:0,\r\n    padding:0,\r\n    height: TITLE_HEIGHT,\r\n    borderRadius: '0 0.5em 0 0',\r\n    //transform: \"rotate(90deg)\",\r\n    cursor: 'default',\r\n    background: '#9e886c',\r\n    ...buttonStyle,\r\n  }),\r\n\r\n  close_dialog: (props: StyleProps) => ({\r\n    visibility: props.showTitle ? 'visible' : 'hidden',\r\n    position:'absolute',\r\n    textAlign: 'left',\r\n    top: 76, //100, //76,\r\n    left: 205, //209, //205,\r\n    right:0,\r\n    margin:0,\r\n    padding:0,\r\n    height: TITLE_HEIGHT,\r\n    borderRadius: '0 0.5em 0 0',\r\n    cursor: 'default',\r\n    background: '#9e886c',\r\n    ...buttonStyle,\r\n  }),\r\n\r\n  nameContainerHolder: (props: StyleProps) => ({\r\n    display: (props._title && props.props.content.name !== '') ? 'block' : 'none',\r\n    fontWeight: 'bold',\r\n    fontSize: isSmartphone() ? '1.2em' : '1em',\r\n    width: props.pose.orientation === 0 || props.pose.orientation === 180 ? props.size[0] : props.size[0],\r\n    height: props.pose.orientation === 0 || props.pose.orientation === 180 ? props.size[1] : props.size[1],\r\n    padding:5,\r\n    backgroundColor: '#eab67600', //'#eab676',\r\n    textAlign: 'center',\r\n    borderRadius: 2,\r\n    alignContent: 'center',\r\n    position:'absolute',\r\n    bottom: 5,\r\n    transform: props.pose.orientation === 0 ? 'rotate(0deg)' : props.pose.orientation === 90 ? 'rotate(-90deg)' : props.pose.orientation === 180 ? 'rotate(-180deg)' : props.pose.orientation === 270 ? 'rotate(-270deg)' : 'rotate(0deg)',\r\n    left: props.pose.orientation === 0 || props.pose.orientation === 180 ? -5 : props.pose.orientation === 270 ? (props.size[0] - props.size[1])/2 - 10 : (props.size[1] - props.size[0])/2,\r\n    top:  props.pose.orientation === 0 ? 0 : props.pose.orientation === 180 ? -7 : -5,\r\n    transformOrigin: 'middle',\r\n  }),\r\n\r\n  nameContainer: (props: StyleProps) => ({\r\n    display: (props._title && props.props.content.name !== '') ? 'block' : 'none',\r\n    fontWeight: 'bold',\r\n    fontSize: isSmartphone() ? '1.2em' : '1em',\r\n    width : props.props.content.name.length * 24 + 'px', //\"70%\",\r\n    height: '20',\r\n    marginBottom: 5,\r\n    marginLeft: props.pose.orientation === 0 || props.pose.orientation === 180 ? ((props.size[0]) - (props.props.content.name.length * 24))/2 - 3 + 'px' : ((props.size[0]) - (props.props.content.name.length * 24))/2 - 5 + 'px',\r\n    marginTop: -40,\r\n    padding:5,\r\n    backgroundColor: '#7ececc', //'#eab676',\r\n    textAlign: 'center',\r\n    borderRadius: 2,\r\n    overflow:'hidden',\r\n    alignContent: 'center',\r\n    position:'relative',\r\n    bottom: 5,\r\n  }),\r\n\r\n  stopWatchTitleHolder: (props: StyleProps) => ({\r\n    display: (props.props.content.showStopWatch ? 'block' : 'none'), //(props._title && props.props.content.name !== '') ? 'block' : 'none',\r\n    fontWeight: 'bold',\r\n    fontSize: isSmartphone() ? '1.2em' : '1em',\r\n    width: props.pose.orientation === 0 || props.pose.orientation === 180 ? props.size[0] : props.size[0],\r\n    height: props.pose.orientation === 0 || props.pose.orientation === 180 ? props.size[1] : props.size[1],\r\n    padding:5,\r\n    backgroundColor: '#eab67600', //'#eab676',\r\n    textAlign: 'center',\r\n    borderRadius: 2,\r\n    alignContent: 'center',\r\n    position:'absolute',\r\n    bottom: 5,\r\n    transform: props.pose.orientation === 0 ? 'rotate(0deg)' : props.pose.orientation === 90 ? 'rotate(-90deg)' : props.pose.orientation === 180 ? 'rotate(-180deg)' : props.pose.orientation === 270 ? 'rotate(-270deg)' : 'rotate(0deg)',\r\n\r\n    left: props.pose.orientation === 0 || props.pose.orientation === 180 ? -5 : props.pose.orientation === 270 ? (props.size[0] - props.size[1])/2 - 5 : (props.size[1] - props.size[0])/2 - 5,\r\n\r\n    top:  props.pose.orientation === 0 ? -5 : props.pose.orientation === 180 ? -5 : -5,\r\n\r\n    transformOrigin: 'middle',\r\n  }),\r\n\r\n  stopWatchTitle: (props: StyleProps) => ({\r\n    display: (props.props.content.showStopWatch ? 'block' : 'none'), //(props._stopWatch) ? 'block' : 'none',\r\n    fontWeight: 'bold',\r\n    fontSize: isSmartphone() ? '1.2em' : '1em',\r\n    width : '90px', //'40%', //\"70%\",\r\n    height: '20px',\r\n    marginLeft: props.pose.orientation === 0 || props.pose.orientation === 180 ? ((props.size[0]) - (90))/2 - 3 + 'px' : ((props.size[0]) - (90))/2 - 5 + 'px',\r\n    marginTop: props.pose.orientation === 0 || props.pose.orientation === 180 ? props.size[1] - 30 : props.size[0] - 30,\r\n    marginBottom: '5px',\r\n    padding:5,\r\n    backgroundColor: '#EEDC82', //'#F8DE7E', //'#7ececc',\r\n    textAlign: 'center',\r\n    borderRadius: 2,\r\n    overflow:'hidden',\r\n    alignContent: 'center',\r\n    position:'relative',\r\n    bottom: 0,\r\n  }),\r\n\r\n  PingLocation: (props:StyleProps) => ({\r\n    display: 'block',\r\n    height: TITLE_HEIGHT,\r\n    position:'absolute',\r\n    textAlign: 'center',\r\n    top: (props.pingY - 25),\r\n    left: (props.pingX - 17),\r\n    whiteSpace: 'pre',\r\n  }),\r\n\r\n  PingLocationHide: (props:StyleProps) => ({\r\n    display: 'none',\r\n    height: TITLE_HEIGHT,\r\n    position:'absolute',\r\n    textAlign: 'center',\r\n    top: (props.pingY - 25),\r\n    left: (props.pingX - 17),\r\n    whiteSpace: 'pre',\r\n  }),\r\n\r\n  cursorStyles:{\r\n    cursor: 'auto',\r\n  }\r\n})\r\n\r\nconst resizeEnable = {\r\n  bottom: false,\r\n  bottomLeft: true,\r\n  bottomRight: true,\r\n  left: false,\r\n  right: false,\r\n  top: false,\r\n  topLeft: true,\r\n  topRight:true,\r\n}\r\nconst resizeDisable = {\r\n  bottom: false,\r\n  bottomLeft: false,\r\n  bottomRight: false,\r\n  left: false,\r\n  right: false,\r\n  top: false,\r\n  topLeft: false,\r\n  topRight:false,\r\n}\r\n\r\nconst cursorStyles = {\r\n  width: '40px',\r\n  height: '40px',\r\n  color: 'white',\r\n  borderRadius: '50%',\r\n  cursor: 'auto',\r\n}\r\n\r\nRndContent.displayName = 'RndContent'\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAAABGdBTUEAALGOfPtRkwAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAFaUlEQVR42mL8//8/wygYmgAggJhGg2DoAoAAGo28IQwAAmg08oYwAAig0cgbwgAggEYjbwgDgAAajbwhDAACaDTyhjAACKDRyBvCACCARiNvCAOAABqNvCEMAAJoNPKGMAAIoNHIG8IAIIBGI28IA4AAGo28IQwAAmg08oYwAAig0cgbwgAggEYjbwgDgAAajbwhDAACaDTyhjAACKDRyBvCACCARiNvCAOAAGKhkjkJQCwKxNzQBPFvNGixZhRQuHwF4tdAvIBSAwECiFqR5wbEqkAsBMSMQDy6nhATwMLlHRDfpkbkAQQQtSIPFHE6QMwxGkcEgRS1DAIIIGrVeaCi4PNovBAFPkPDi2IAEECjDZYhDAACaDTyhjAACKDRyBvCACCARiNvCAOAABqNvCEMAAJoNPKGMAAIoNHIG8IAIIBGI28IA4AAGo28IQwAAmg08oYwAAig0cgbwgAggEYjbwgDgACiVuQJALHwaHASBYSh4UUxAAggak0JHQHiJ1BHjc7nYQewcPkAxA+oYSBAADFS6RwWAwbILDrraOQRjLzfDJApoQuUGggQQNSKPHZoEcw4GkcEASjAQcshflJqEEAAMY6egDR0AUAAjbY2hzAACKDhHHmgIlxsOEceQACxDFN/sQGxHRA7AvEVIN4PxC+GmycBAmi4Rp4mA2QtaTQDZJkdaFXb/OHmSYAAGo6Rpw/E2UDsCuWrAHE8lL0WiD8NF48CBNBwijxQUWkFjahgIOZFqvvsgVgQ2g/dNFyKUIAAGk4NFk1oxCUgRRwy0IPmSM/h4mGAABouOU+fyIjRGE5FKEAADfXIw1VU4lOPXIRuBuLnQ9XzAAE01ItNQkUlLgArQj2GsucBAmgoRx6xRSW+IjQQiG2GagkEEEBD0dGgQXBLEopKQkXoT2g/8BAQ/xpKAQEQQEMx8jSQikpKAR8QhwDxFwbIhseLQykgAAJoqBWboDnDGBo09z2gRbD+UAoMgAAaSjlPAVpMRgCxOJXNloCaC2qBLgTiY0OhCAUIIJYhlONAEVcLxPw0soMXqSh+PxSKUIAAYhoiEZcJxKk0jDhk4DlUilCAABrsM+mwohIUmIp0tBe09XjtYC9CAQKIZZDnOFoXlUO6CAUIIKZBHHH0LCqHZBEKEECDsdgcqKJyyBWhAAHEMghz3EAVlUOuCAUIIKZBFnGDoagcMkUoQAANlmJzsBWVQ6IIBQgglkGS4wZbUTkkilCAABrInMcMxMrQ3JYMjcShBEBrYfqA+BzDAB3dBRBAgyHngYqe49AAoPSoR9D2KW0GyOmDzFjkTwDxUyq4mQuIXw50wAEE0HDbq2ANxK1AbAbEnFjkQ6B11rAAAAE03Ja7g7ZO/WHAvcXs23DyLEAADbfI44ZWBYx4irthAwACaHSX0BAGAAE0GnlDGAAE0GjkDWEAEECjkTeEAUAAjUbeEAYAATQaeUMYAATQaOQNYQAQQKORN4QBQACNRt4QBgABNBp5QxgABNBo5A1hABBAo5E3hAFAAI1G3hAGAAE03CIPNAELmlngxCHPOpw8CxBAw+0cFtB8HujQHC4o/ocUqX8ZIGddDhsAEEDDLfJeAfEuIL4KzX1/oOKg3bSgHbCPhpNnAQJo9MjGIQwAAmi0wTKEAUAAjUbeEAYAATQaeUMYAATQaOQNYQAQQKORN4QBQACNRt4QBgABNBp5QxgABNBo5A1hABBAo5E3hAFAAI1G3hAGAAE0GnlDGAAE0GjkDWEAEECjkTeEAUAAjUbeEAYAATQaeUMYAATQaOQNYQAQQKORN4QBQACNRt4QBgABNBp5QxgABNBo5A1hABBAo5E3hAFAgAEAvHyafYeUJxIAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","import {BMProps} from '@components/utils'\r\nimport {ISharedContent} from '@models/ISharedContent'\r\nimport {SharedContentInfo} from '@models/ISharedContent'\r\nimport {contentLog} from '@stores/sharedContents/SharedContents'\r\nimport React from 'react'\r\nimport {MouseOrTouch, RndContent} from './RndContent'\r\nexport interface ISharedContentProps extends BMProps{\r\n  content: ISharedContent,\r\n}\r\n\r\nexport const sharedContentHandler = (props: BMProps&{content:SharedContentInfo}) => {\r\n  return {\r\n    onClose: (evt: MouseOrTouch) => {\r\n      contentLog('RndContent onClose for ', props.content.id)\r\n      evt.stopPropagation()\r\n      props.stores.map.keyInputUsers.delete(props.content.id)\r\n      props.stores.map.keyInputUsers.delete('contentForm')\r\n      props.stores.contents.removeByLocal(props.content.id)\r\n    },\r\n    updateAndSend:(c: ISharedContent) => {\r\n      //\tconsole.log('updateByLocal(send content)')\r\n      props.stores.contents.updateByLocal(Object.assign({}, c))\r\n    },\r\n    updateOnly:(c: ISharedContent) => {\r\n      props.stores.contents.updateLocalOnly(Object.assign({}, c))\r\n    }\r\n  }\r\n}\r\n\r\nexport const SharedContent: React.FC<ISharedContentProps> = (props:ISharedContentProps) => {\r\n  return <RndContent {...props} autoHideTitle={true} {... sharedContentHandler(props)} />\r\n}\r\n\r\nSharedContent.displayName = 'SharedContent'\r\n","import {sharedContentHandler} from '@components/map/Share/SharedContent'\r\nimport {SharedContentForm} from '@components/map/Share/SharedContentForm'\r\nimport {Tooltip} from '@material-ui/core'\r\nimport Button from '@material-ui/core/Button'\r\nimport DoneIcon from '@material-ui/icons/CheckCircle'\r\nimport {isContentOutOfRange, ISharedContent, SharedContentInfo} from '@models/ISharedContent'\r\nimport {useTranslation} from '@models/locales'\r\nimport {getRandomColor, rgb2Color} from '@models/utils'\r\n/* import {isDarkColor} from '@models/utils' */\r\nimport contents from '@stores/sharedContents/SharedContents'\r\nimport {autorun} from 'mobx'\r\nimport {Observer} from 'mobx-react-lite'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React from 'react'\r\nimport {contentTypeIcons} from '../map/Share/Content'\r\nimport {BMProps} from '../utils'\r\nimport {styleForList} from '../utils/styles'\r\nimport {TextLineStyle} from './LeftBar'\r\n\r\nimport {ImageAvatar} from '@components/avatar/ImageAvatar'\r\nimport { Participants } from '@stores/participants/Participants'\r\nimport {findReverseColorRGB, findTextColorRGB, getRandomColorRGB, isSmartphone} from '@models/utils'\r\n/* import {ParticipantBase} from '@stores/participants/ParticipantBase' */\r\n\r\nfunction locatedContentOnly(content: ISharedContent|undefined){\r\n  if (isContentOutOfRange(content)){ return undefined }\r\n\r\n  return content\r\n}\r\n\r\n//export const ContentLine: React.FC<BMProps & TextLineStyle & {content: SharedContentInfo}>=(props) => {\r\nexport const ContentLine: React.FC<BMProps & TextLineStyle &\r\n{/* participant: ParticipantBase,  */content: SharedContentInfo, ap:Participants}> = (props) => {\r\n  const classes = styleForList({height:props.lineHeight, fontSize:props.fontSize})\r\n  const [showForm, setShowForm] = React.useState(false)\r\n  const ref = React.useRef<HTMLButtonElement>(null)\r\n  const {lineHeight, content, ...contentProps} = props\r\n  let targetContent: ISharedContent|undefined = undefined\r\n  const map = props.stores.map\r\n\r\n  const userName = useObserver(() => {\r\n    return props.content.ownerName\r\n  })\r\n\r\n  const userAvatar = useObserver(() => {\r\n    return props.content.ownerURL\r\n  })\r\n\r\n  const colorsIcon = useObserver(() => {\r\n    let color = props.content.color\r\n    if (!color.length) {\r\n      if (userName?.length){\r\n        color = getRandomColorRGB(userName)\r\n      }else{\r\n        color = [0xD0, 0xD0, 0xE0]\r\n      }\r\n    }\r\n    let textColor = props.content.color\r\n    if (!textColor.length) {\r\n      textColor = findTextColorRGB(color)\r\n    }\r\n    const reverseRGB = findReverseColorRGB(color)\r\n    const colors = [rgb2Color(color), rgb2Color(textColor), rgb2Color(reverseRGB)]\r\n    return colors\r\n  })\r\n\r\n  const contentInfo = (props.content.shareType === \"img\") ? 'Image' : (props.content.shareType === 'zoneimg') ? 'Chat Zone' : (props.content.shareType === 'text') ? 'Text' : (props.content.shareType === 'screen') ? 'Screen' : ''\r\n\r\n  return <Observer>{()=> {\r\n    const typeIcon = contentTypeIcons(props.content.type, props.fontSize)\r\n    const colors = getRandomColor(props.content.ownerName)\r\n\r\n    if (props.content.color?.length){ colors[0] = rgb2Color(props.content.color) }\r\n    if (props.content.textColor?.length){ colors[1] = rgb2Color(props.content.textColor) }\r\n    if (showForm){\r\n      targetContent = locatedContentOnly(props.stores.contents.find(props.content.id))\r\n    }\r\n\r\n    return <>\r\n      <Tooltip title={<>{props.content.name}<br />{props.content.ownerName}</>} placement=\"right\">\r\n        <Button ref={ref} /* variant=\"contained\" */ className={classes.line}\r\n          /* style={{backgroundColor:colors[0], color:colors[1], margin: '1px 0 1px 0', textTransform:'none'}} */\r\n          style={{/* backgroundColor:colors[0],  */color:'#FFFFFF'/* colors[1] */, margin: '1px 0 1px 10px', textTransform:'none', position:'relative', left:'5px', marginTop: '0px', top:'7px', height:isSmartphone() ? '75px' : '40px'}}\r\n          onClick={() => {\r\n            const found = contents.find(props.content.id)\r\n            if (found){\r\n              map.focusOn(found)\r\n            }else{\r\n              contents.requestContent([props.content.id])\r\n              const disposer = autorun(()=>{\r\n                const found = contents.find(props.content.id)\r\n                if (found){\r\n                  map.focusOn(found)\r\n                  disposer()\r\n                }\r\n              })\r\n            }\r\n          }}\r\n          onContextMenu={() => {\r\n            const found = locatedContentOnly(contents.find(props.content.id))\r\n            if (found){\r\n              setShowForm(true)\r\n              map.keyInputUsers.add('contentForm')\r\n            }else{\r\n              contents.requestContent([props.content.id])\r\n              const disposer = autorun(()=>{\r\n                const found = locatedContentOnly(contents.find(props.content.id))\r\n                if (found){\r\n                  setShowForm(true)\r\n                  map.keyInputUsers.add('contentForm')\r\n                  disposer()\r\n                }\r\n              })\r\n            }\r\n          }}\r\n        >{typeIcon}{/* {props.content.name} */}\r\n        <div style={{position:'relative', color:'#FFFFFF', left:'5px', display:'flex', fontSize:isSmartphone() ? '2rem' : '1rem'}}>\r\n        {/* {String(props.content.shareType.charAt(0).toUpperCase() + String(props.content.shareType.slice(1)))} */}\r\n        {contentInfo}\r\n        <div style={{position:'relative', left:'5px', color:'#F7A76B', /* fontSize:isSmartphone() ? '2em' : '1em' *//* '#EDA741' */}}>\r\n        {props.content.name !== '' ?' (' + props.content.name + ')' : ''}\r\n        </div>\r\n        </div>\r\n        {userName !== '' ?\r\n        <div style={{position:'absolute', width:'100%', right:isSmartphone() ? '25px' : '20px', textAlign:'right', top:'5px'/* '#EDA741' */}}>\r\n        <ImageAvatar border={true} colors={colorsIcon} size={isSmartphone() ? 60 : 30} name={userName !== undefined ? userName : ''} avatarSrc={userAvatar !== undefined ? userAvatar : ''} />\r\n        </div> : ''}\r\n        </Button>\r\n      </Tooltip>\r\n      <SharedContentForm {...contentProps} content={targetContent}\r\n        {...sharedContentHandler(props)} open={showForm}\r\n        close={()=>{\r\n          setShowForm(false)\r\n           map.keyInputUsers.delete('contentForm')\r\n        }}\r\n        anchorEl={ref.current} anchorOrigin={{vertical:'top', horizontal:'right'}}\r\n      />\r\n    </>\r\n  }}</Observer>\r\n}\r\n\r\nexport const ContentList: React.FC<BMProps&TextLineStyle>  = (props) => {\r\n  //  console.log('Render RawContentList')\r\n  /* const roomInfo = props.stores.roomInfo */\r\n  const contents = props.stores.contents\r\n  const all = useObserver(() => {\r\n    const all:SharedContentInfo[] =\r\n      //Array.from(contents.roomContentsInfo.size ? contents.roomContentsInfo.values() : contents.all)\r\n    Array.from(contents.all)\r\n    all.sort((a,b) => {\r\n      let rv = a.name.localeCompare(b.name)\r\n      if (rv === 0){ rv = a.ownerName.localeCompare(b.ownerName) }\r\n      if (rv === 0){ rv = a.type.localeCompare(b.type) }\r\n      if (rv === 0){ rv = a.id.localeCompare(b.id) }\r\n\r\n      return rv\r\n    })\r\n\r\n    return all\r\n  })\r\n\r\n  let contentLength = 0\r\n  all.filter(item => item.shareType !== \"appimg\").map((content, index) => (\r\n    content.shareType !== 'appimg' ? contentLength++ : 0\r\n  ))\r\n\r\n\r\n\r\n  const editing = useObserver(() => contents.editing)\r\n  const classes = styleForList({height:props.lineHeight, fontSize:props.fontSize})\r\n  const participants = useObserver(() => props.stores.participants)\r\n\r\n  const elements = all.map(c =>\r\n    c.shareType !== 'appimg' ?\r\n    <ContentLine key={c.id} content = {c} {...props} ap={participants}\r\n      /* participant={participants.find(contents.owner.get(c.id) as string) as ParticipantBase} */\r\n       /> : <></>)\r\n\r\n  const {t} = useTranslation()\r\n  /* const textColor = useObserver(() => isDarkColor(roomInfo.backgroundFill) ? 'white' : 'black') */\r\n\r\n  /* return <div className={classes.container} >\r\n    <div className={classes.title} style={{color:textColor}}>{t('Contents')}\r\n      {editing ? <Button variant=\"contained\" size=\"small\" color=\"primary\"\r\n        style={{marginLeft:4, padding:3, height:'1.4em', fontSize:'0.8'}}\r\n        onClick={()=>{ contents.setEditing('')}}>\r\n          <DoneIcon style={{fontSize:'1em'}}/>&nbsp;{t('shareEditEnd')}</Button>: undefined}\r\n    </div>\r\n    {elements}\r\n  </div> */\r\n  return <div className={classes.container} >\r\n    <div className={classes.title} style={{color:'#FFFFFF90', marginLeft:isSmartphone() ? '10px':'8px', padding:'10px', borderRadius:'5px', /* border:'1px dotted #FFFFFF80', */ marginTop:'5px', userSelect:'text', fontWeight:'bold', fontSize:isSmartphone() ? '2rem' : '1rem'}} /* style={{color:textColor}} */>{t('Contents')} ({(contentLength/* props.stores.contents.all.length */).toString()})\r\n      {editing ? <Button variant=\"contained\" size=\"small\" color=\"secondary\"\r\n        style={{marginLeft:4, padding:3, height:'1.4rem', fontSize:'0.8'}}\r\n        onClick={()=>{ contents.setEditing('')}}>\r\n          <DoneIcon style={{fontSize:'1rem'}}/>&nbsp;{t('shareEditEnd')}</Button>: undefined}\r\n    </div>\r\n    {elements}\r\n  </div>\r\n}\r\nContentList.displayName = 'ContentList'\r\n","import Button from '@material-ui/core/Button'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Popper, { PopperProps } from '@material-ui/core/Popper'\r\nimport { StreamStat, TransportStat } from '@models/conference/RtcConnection'\r\nimport React from 'react'\r\nimport {BMProps} from '../utils'\r\nimport {conference} from '@models/conference'\r\nimport { useObserver } from 'mobx-react-lite'\r\nimport errorInfo from '@stores/ErrorInfo'\r\nimport {useTranslation} from '@models/locales'\r\nimport {ConnectionStat} from '@components/map/Participant/SignalQuality'\r\n\r\ndeclare const config:any             //  from ../../config.js included from index.html\r\n\r\nexport interface StatusDialogProps extends Omit<PopperProps, 'children'>, BMProps{\r\n  close: () => void,\r\n}\r\nexport const StatusDialog: React.FC<StatusDialogProps> = (props: StatusDialogProps) => {\r\n  const {t} = useTranslation()\r\n  const stat = useObserver(()=>{\r\n    const stats:TransportStat[] = []\r\n    const senderStat = conference.sendTransport?.appData?.stat as (TransportStat|undefined)\r\n    if (senderStat) stats.push(senderStat)\r\n    const receiverStats:TransportStat[] = Array.from(conference.remotePeers.values())\r\n      .map(remote => remote.transport?.appData?.stat as (TransportStat)).filter(s=>s!==undefined)\r\n    stats.push(...receiverStats)\r\n    const servers:[string, string, string|undefined][] = []\r\n    const sum = {} as any\r\n    const streams:StreamStat[] = []\r\n    for(const ts of stats){\r\n      for(const key in ts){\r\n        if (key !== 'turn' && key !== 'streams' && key !== 'localServer' && key !== 'remoteServer'){\r\n          if (sum[key]) sum[key] = sum[key] + (ts as any)[key]\r\n          else sum[key] = (ts as any)[key]\r\n        }\r\n      }\r\n      if (ts.remoteServer){\r\n        const len = ts.remoteServer.lastIndexOf(':')\r\n        const serverAddr = ts.remoteServer!.substring(0,len)\r\n        const sameAddr = servers.find(s => s[0]===ts.dir && s[1].substring(0, len) === serverAddr)\r\n        if (!sameAddr){\r\n          servers.push([ts.dir, ts.remoteServer, ts.turn])\r\n        }else{\r\n          const port = ts.remoteServer!.substring(len+1)\r\n          sameAddr[1] += `,${port}`\r\n        }\r\n        streams.push(...ts.streams)\r\n      }\r\n    }\r\n    if (stats.length){\r\n      const tStatSum = sum as TransportStat\r\n      tStatSum.fractionLost = tStatSum.fractionLost ? tStatSum.fractionLost/stats.length : undefined\r\n      tStatSum.jitter = tStatSum.jitter ? tStatSum.jitter/stats.length : undefined\r\n      tStatSum.quality = tStatSum.quality ? tStatSum.quality/stats.length : undefined\r\n      tStatSum.roundTripTime  = tStatSum.roundTripTime ? tStatSum.roundTripTime/stats.length : undefined\r\n    }\r\n    const data = errorInfo.types.has('dataConnection') ? undefined : config.bmRelayServer\r\n    return {\r\n      transport: stats.length ? sum as TransportStat : undefined,\r\n      streams,\r\n      servers,\r\n      data,\r\n    }\r\n  })\r\n\r\n  const {close, ...poperProps} = props\r\n  return <Popper {...poperProps} disablePortal={false} style={{zIndex:2}}>\r\n    <Paper style={{background:'rgba(255,255,255,1)', padding:'0.4em'}}>\r\n      <div style={{overflowY:'auto'}}>\r\n        <strong>{t('connectionStatus')}</strong><br />\r\n        <div> Data: {stat.data}</div>\r\n        {stat.servers.length === 0 ? <div>'No RTC server'</div> :\r\n          stat.servers.map((server, idx) => <div key={idx}>\r\n            RTC{server[0]==='send'?'⇑':'⇓'}:{server[1]}\r\n            {server[2] ? <><br/>&nbsp; via {server[2]}</> : undefined}\r\n        </div>)}\r\n        <ConnectionStat stat={stat.transport} streams={stat.streams} />\r\n      </div>\r\n      <Button variant=\"contained\" color=\"primary\" style={{textTransform:'none', marginTop:'0.4em'}}\r\n        onClick={close}\r\n        >{t('emClose')}</Button>\r\n    </Paper>\r\n  </Popper>\r\n}\r\n","import {ImageAvatar} from '@components/avatar/ImageAvatar'\r\nimport {LocalParticipantForm} from '@components/map/Participant/LocalParticipantForm'\r\nimport {RemoteParticipantForm} from '@components/map/Participant/RemoteParticipantForm'\r\nimport {BMProps} from '@components/utils'\r\nimport {Tooltip} from '@material-ui/core'\r\nimport Button from '@material-ui/core/Button'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport {conference} from '@models/conference'\r\nimport {MessageType} from '@models/conference/DataMessageType'\r\nimport {getColorOfParticipant} from '@models/Participant'\r\n/* import {isDarkColor} from '@models/utils' */\r\nimport {ParticipantBase} from '@stores/participants/ParticipantBase'\r\nimport {autorun} from 'mobx'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React from 'react'\r\nimport {styleForList} from '../utils/styles'\r\nimport {TextLineStyle} from './LeftBar'\r\nimport {StatusDialog} from './StatusDialog'\r\n\r\nimport goodConnIcon from '@images/earshot_icon_quality_3.png'\r\nimport averageConnIcon from '@images/earshot_icon_quality_2.png'\r\nimport badConnIcon from '@images/earshot_icon_quality_1.png'\r\nimport {isSmartphone} from '@models/utils'\r\n// Animated Emoticons\r\nimport symSmileIcon from '@images/whoo-screen_sym-smile.png'\r\nimport symClapIcon from '@images/whoo-screen_sym-clap.png'\r\nimport symHandIcon from '@images/whoo-screen_sym-hand.png'\r\n\r\nimport {makeStyles} from '@material-ui/core/styles'\r\n\r\n// config.js\r\ndeclare const config:any             //  from ../../config.js included from index.html\r\n\r\ninterface StyleProps {\r\n  size: number,\r\n}\r\n\r\nconst useStyles = makeStyles({\r\n  iconEmoticon: (props: StyleProps) => ({\r\n    position: 'absolute',\r\n    width: props.size * 0.6 ,\r\n    height: props.size * 0.6,\r\n    left: props.size * -0.2,\r\n    top: props.size * -0.2,\r\n    pointerEvents: 'none',\r\n    transform: 'scale(1)',\r\n    transition: '0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55)',\r\n  }),\r\n  iconEmoticonNone: (props: StyleProps) => ({\r\n    position: 'absolute',\r\n    width: props.size * 0.6 ,\r\n    height: props.size * 0.6,\r\n    left: props.size * 0.1,\r\n    top: props.size * 0,\r\n    pointerEvents: 'none',\r\n    transform: 'scale(0)',\r\n    transition: '0s ease-out',\r\n  }),\r\n})\r\n\r\nexport const ParticipantLine: React.FC<TextLineStyle&BMProps&{participant: ParticipantBase}> = (props) => {\r\n  const map = props.stores.map\r\n  const name = useObserver(() => (props.participant.information.name))\r\n  const avatarSrc = useObserver(() => (props.participant.information.avatarSrc))\r\n  const colors = useObserver(() => getColorOfParticipant(props.participant.information))\r\n  const size = useObserver(() => props.lineHeight)\r\n  const classes = styleForList({height:props.lineHeight, fontSize:props.fontSize})\r\n  const [showForm, setShowForm] = React.useState(false)\r\n  const ref = React.useRef<HTMLButtonElement>(null)\r\n  const {lineHeight, ...propsForForm} = props\r\n  //  console.log(`PColor pid:${props.participant.id} colors:${colors}`, props.participant)\r\n\r\n  const classesIcons = useStyles({\r\n    size: isSmartphone() ? (props.lineHeight * 4) : (props.lineHeight * 2.5),\r\n  })\r\n\r\n  const _connQuality = useObserver(() => props.participant.quality)\r\n\r\n\r\n  //console.log(props)\r\n\r\n  const zoneName = useObserver(() => {\r\n    let remotes = Array.from(props.stores.participants.remote.keys()).filter(key => key !== props.stores.participants.localId)\r\n    for(let [i] of remotes.entries()) {\r\n      if(props.stores.participants.remote.get(remotes[i])?.closedZone !== undefined) {\r\n        if(props.stores.participants.remote.get(remotes[i])?.id === props.participant.id && props.stores.participants.remote.get(remotes[i])?.closedZone?.name !== '') {\r\n          return ' (' + props.stores.participants.remote.get(remotes[i])?.closedZone?.name + ')'\r\n        }\r\n      } else {\r\n        return ''\r\n      }\r\n    }\r\n  })\r\n\r\n  // For Emoticons\r\n  const _iconsRemote = useObserver(() => {\r\n    let remotes = Array.from(props.stores.participants.remote.keys()).filter(key => key !== props.stores.participants.localId)\r\n    for(let [i] of remotes.entries()) {\r\n      if(props.stores.participants.remote.get(remotes[i])?.trackStates.emoticon !== '') {\r\n        if(props.stores.participants.remote.get(remotes[i])?.id === props.participant.id && props.stores.participants.remote.get(remotes[i])?.trackStates.emoticon !== '') {\r\n          return props.stores.participants.remote.get(remotes[i])?.trackStates.emoticon\r\n        }\r\n      } else {\r\n        return ''\r\n      }\r\n    }\r\n  })\r\n  const _iconsLocal = useObserver(() => props.stores.participants.local.trackStates.emoticon)\r\n  const localZone = useObserver(() => (props.stores.participants.local.zone?.name !== undefined && props.stores.participants.local.zone?.name !== '') ? ' ('+props.stores.participants.local.zone?.name+')' : '')\r\n\r\n  function onClick(){\r\n    if (props.participant.physics.located){\r\n      map.focusOn(props.participant)\r\n    }else{\r\n      if(config.bmRelayServer){\r\n        conference.dataConnection.pushOrUpdateMessageViaRelay(\r\n          MessageType.REQUEST_PARTICIPANT_STATES, [props.participant.id])\r\n      }\r\n      const disposer = autorun(()=>{\r\n        if (props.participant.physics.located){\r\n          map.focusOn(props.participant)\r\n          disposer()\r\n        }\r\n      })\r\n    }\r\n  }\r\n  function onContextMenu(){\r\n    if (props.participant.physics.located){\r\n      setShowForm(true)\r\n      map.keyInputUsers.add('participantList')\r\n    }else{\r\n      if(config.bmRelayServer){\r\n        conference.dataConnection.pushOrUpdateMessageViaRelay(\r\n          MessageType.REQUEST_PARTICIPANT_STATES, [props.participant.id])\r\n      }\r\n      const disposer = autorun(()=>{\r\n        if (props.participant.physics.located){\r\n          setShowForm(true)\r\n          map.keyInputUsers.add('participantList')\r\n          disposer()\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  /*\r\n  <>\r\n    <Tooltip title={`${props.participant.information.name} (${props.participant.id})`} placement=\"right\">\r\n      <div className={classes.outer} style={{margin:'1px 0 1px 0'}}>\r\n        <IconButton style={{margin:0, padding:0}} onClick={onClick} onContextMenu={onContextMenu}>\r\n          <ImageAvatar border={true} colors={colors} size={size} name={name} avatarSrc={avatarSrc} />\r\n        </IconButton>\r\n        <Button variant=\"contained\" className={classes.line} ref={ref}\r\n          style={{backgroundColor:colors[0], color:colors[1], textTransform:'none'}}\r\n          onClick={onClick} onContextMenu={onContextMenu}>\r\n            {name}\r\n        </Button>\r\n      </div>\r\n    </Tooltip>\r\n    {props.participant.id === props.stores.participants.localId ?\r\n      <LocalParticipantForm stores={props.stores} open={showForm} close={()=>{\r\n        setShowForm(false)\r\n        map.keyInputUsers.delete('participantList')\r\n      }} anchorEl={ref.current} anchorOrigin={{vertical:'top', horizontal:'right'}} /> :\r\n      <RemoteParticipantForm {...propsForForm} open={showForm} close={()=>{\r\n        setShowForm(false)\r\n        map.keyInputUsers.delete('participantList')\r\n      }} participant={props.stores.participants.remote.get(props.participant.id)}\r\n        anchorEl={ref.current} anchorOrigin={{vertical:'top', horizontal:'right'}} />\r\n    }\r\n  </> */\r\n\r\n\r\n  return <>\r\n    <Tooltip title={<span style={{fontSize:isSmartphone() ? '2rem' : '1rem'}}>{`${props.participant.information.name} (${props.participant.id})`}</span>} placement=\"right\">\r\n      <div className={classes.outer} /* style={{margin:'1px 0 1px 0'}} */ style={{margin:'1px 0 1px 10px', position:'relative', left:'5px', marginTop: '0px', top:'7px'}}>\r\n        <IconButton style={{margin:0, padding:0, marginTop: '5px', marginLeft:isSmartphone() ? '10px' : '5px'}} onClick={onClick} onContextMenu={onContextMenu}>\r\n          <ImageAvatar border={true} colors={colors} /* size={size} */ size={(isSmartphone() ? (size * 3.2) : (size * 2))} name={name} avatarSrc={avatarSrc} />\r\n          <img\r\n          src={ (props.stores.participants.localId === props.participant.id) ?\r\n            _iconsLocal === 'smile' ? symSmileIcon : (_iconsLocal === \"hand\" ? symHandIcon : (_iconsLocal === \"clap\" ? symClapIcon : undefined)) :  _iconsRemote === 'smile' ? symSmileIcon : (_iconsRemote === \"hand\" ? symHandIcon : (_iconsRemote === \"clap\" ? symClapIcon : undefined))\r\n          }\r\n            className={ (props.stores.participants.localId === props.participant.id) ?\r\n              _iconsLocal === '' ? classesIcons.iconEmoticonNone : classesIcons.iconEmoticon\r\n              :  _iconsRemote === '' ? classesIcons.iconEmoticonNone : classesIcons.iconEmoticon\r\n            }  alt='' />\r\n        </IconButton>\r\n        <Button /* variant=\"contained\" */ className={classes.line} ref={ref}\r\n          style={{/* backgroundColor:colors[0],  */color:'#FFFFFF'/* colors[1] */, textTransform:'none', marginLeft:'10px', marginTop: '10px', fontWeight: 'bold', fontSize: isSmartphone() ? '2rem' : '1rem', height:'30px'}}\r\n          onClick={onClick} onContextMenu={onContextMenu}>\r\n            {name}\r\n            <div style={{color:'#EDA741', letterSpacing:'0px', position:'relative', marginLeft:'5px', fontSize:isSmartphone() ? '1.5rem' : '1rem'}}>{(props.stores.participants.localId === props.participant.id) ? localZone : zoneName}</div>\r\n        </Button>\r\n        <div style={{position:'absolute', width:'10px', height:'10px', /* backgroundColor:'yellow', */ right:isSmartphone() ? '60px' : '40px', marginTop: '5px',}}>\r\n            {(_connQuality !== undefined && _connQuality > 80) ? <img width={isSmartphone() ? '60px' : '40px'} height={isSmartphone() ? '60px' : '40px'} src={goodConnIcon} draggable={false} style={{userSelect:'none'}} alt='' /> : (_connQuality !== undefined && _connQuality < 80 && _connQuality > 50) ? <img width={isSmartphone() ? '60px' : '40px'} height={isSmartphone() ? '60px' : '40px'} src={averageConnIcon} draggable={false} style={{userSelect:'none'}} alt='' /> : <img width={isSmartphone() ? '60px' : '40px'} height={isSmartphone() ? '60px' : '40px'} src={badConnIcon} draggable={false} style={{userSelect:'none'}} alt='' /> }\r\n        </div>\r\n\r\n      </div>\r\n    </Tooltip>\r\n    {props.participant.id === props.stores.participants.localId ?\r\n      <LocalParticipantForm stores={props.stores} open={showForm} close={()=>{\r\n        setShowForm(false)\r\n        map.keyInputUsers.delete('participantList')\r\n      }} anchorEl={ref.current} anchorOrigin={{vertical:'top', horizontal:'right'}} /> :\r\n      <RemoteParticipantForm {...propsForForm} open={showForm} close={()=>{\r\n        setShowForm(false)\r\n        map.keyInputUsers.delete('participantList')\r\n      }} participant={props.stores.participants.remote.get(props.participant.id)}\r\n        anchorEl={ref.current} anchorOrigin={{vertical:'top', horizontal:'right'}} />\r\n    }\r\n  </>\r\n}\r\n\r\nexport const RawParticipantList: React.FC<BMProps&TextLineStyle&{localId: string, remoteIds: string[]}> = (props) => {\r\n  const [showStat, setShowStat] = React.useState(false)\r\n  const participants = props.stores.participants\r\n  /* const roomInfo = props.stores.roomInfo */\r\n  const classes = styleForList({height: props.lineHeight, fontSize: props.fontSize})\r\n  const {localId, remoteIds, lineHeight, fontSize, ...statusProps} = props\r\n  const lineProps = {lineHeight, fontSize, ...statusProps}\r\n  //const textColor = useObserver(() => isDarkColor(roomInfo.backgroundFill) ? 'white' : 'black')\r\n\r\n  remoteIds.sort((a, b) => {\r\n    const pa = participants.remote.get(a)\r\n    const pb = participants.remote.get(b)\r\n    let rv = pa!.information.name.localeCompare(pb!.information.name, undefined, {sensitivity: 'accent'})\r\n    if (rv === 0) {\r\n      rv = (pa!.information.avatarSrc || '').localeCompare(pb!.information.avatarSrc || '', undefined, {sensitivity: 'accent'})\r\n    }\r\n\r\n    return rv\r\n  })\r\n  const remoteElements = remoteIds.map(id =>\r\n    <ParticipantLine key={id}\r\n      participant={participants.remote.get(id)!}\r\n      {...lineProps} />)\r\n  const localElement = (<ParticipantLine key={localId} participant={participants.local} {...lineProps} />)\r\n  const ref = React.useRef<HTMLDivElement>(null)\r\n\r\n  return (\r\n    <div className={classes.container} >\r\n      <div className={classes.title} /* style={{color:textColor}} */style={{color:'#FFFFFF90'/* textColor */, marginLeft: isSmartphone() ? '14px' : '8px', padding:'10px', borderRadius:'5px', /* border:'1px dotted #FFFFFF80', */ marginTop:'5px', userSelect:'text', fontWeight:'bold', fontSize:isSmartphone() ? '2rem' : '1rem'}} ref={ref}\r\n        onClick={()=>{setShowStat(true)}}\r\n      >{/* {conference.room} */}{sessionStorage.getItem('room')} ({(participants.remote.size + 1).toString()}){/*  in {conference.room} */}</div>\r\n      <StatusDialog open={showStat}\r\n        close={()=>{setShowStat(false)}} {...statusProps} anchorEl={ref.current}/>\r\n      {localElement}{remoteElements}\r\n    </div>\r\n  )\r\n}\r\nRawParticipantList.displayName = 'ParticipantList'\r\n\r\nexport const ParticipantList = React.memo<BMProps&TextLineStyle>(\r\n  (props) => {\r\n    const localId = useObserver(() => props.stores.participants.localId)\r\n    const ids = useObserver(() => Array.from(props.stores.participants.remote.keys()))\r\n\r\n    return <RawParticipantList {...props} localId={localId} remoteIds = {ids} />\r\n  },\r\n)\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAABoklEQVR4nO3asc3TUBSA0RvEIP8a6TwKO2QAYIDswCaYKi0jZAQ2MBUSrSOC88E5jRs/+Uqf/Ipnn7ZtG5reHT0AjxMvTLww8cLECxMvTLww8cLECxMvTLww8cLECxMvTLww8cLECxMvTLww8cLECxMvTLww8cLECxMvTLww8cLECxMvTLyw90cPcLTrbXmbmbcdS35czuv350yzz38fb2Y+zMzHHfd/m5nlKZPsZNsMEy9MvDDxwsQLEy9MvDDxwsQLEy9MvLB/4mzzeluWmfm6Z83lvJ6eM83f480LEy9MvDDxwsQLEy9MvDDxwsQLEy9MvDDxwl7qYPp6Wz7tXPLlcl7vTxgl4aXizb4/l2dm1pm5//kxGmybYeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4Ya/2Jf3zzvvvv133rv1lffCZhztt23b0DDzIthkmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKF/QQEgh1Eo89xKgAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAABp0lEQVR4nO3csXETURRA0bfYEVUQ0QajCtyCW6ETWnAFVgP0QEYBRASedWAC0m8Q2mvOSZTojd7MHf3g70jbvu9D07trL8DriRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXtjttRe4pm3bbmbm/crMvu8/LrTOsv863ryE+7g48/USi7yGYzNMvDDxwsQLEy9MvDDxwsQLEy9MvDDxwt7E3ebTw2n13+9ON3eP50vs8i/55oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhhh7mYfno43c/Mh4WR81u4XP4Th4k3M/cz82lx5vz31+hwbIaJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oUd6Un6l1l7Mv77ez8vfta3X68/Z+b74uxhbPu++rtEjsKxGSZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oU9A1m1HKAM8GK/AAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAABqElEQVR4nO3ZMUrFQBRG4X9EtLIRGwtL3aa+nbgUN+AGtAlY2Nk8EF4h18YN3PBicvR8TZoZcuGQKSajqiKmk7UH0HzGAzMemPHAjAdmPDDjgRkPzHhgxgMzHpjxwIwHZjww44EZD8x4YMYDMx6Y8cCMB2Y8MOOBGQ/MeGDGAzMemPHAjAdmPDDjgZ2uPcDaxhhnSc4bW76q6nOpeTr+fbwkV0muG+v3SV4WmqXFYxPMeGDGAzMemPHAjAdmPDDjgRkPzHhgxgP7E3ebY4yLJHedPVX1vNA4v8YvD8x4YMYDMx6Y8cCMB2Y8MOOBGQ/MeGDGAzMe2KYupj9ubh+aWx4v316nBUZB2FS8JPfN9U9JpuOPweCxCWY8MOOBGQ/MeGDGAzMemPHAjAdmPDDjgRkPzHhgxgMzHpjxwIwHtrU/6bvm+unneUjyPvOd++b6w8z3HN2oqrVn0Ewem2DGAzMemPHAjAdmPDDjgRkPzHhgxgMzHpjxwIwHZjww44EZD8x4YMYDMx6Y8cCMB2Y8MOOBGQ/MeGDGAzMemPHAjAdmPDDjgRkP7BvKkh4pxeVM2gAAAABJRU5ErkJggg==\"","/* import React, {useState} from 'react'\r\nimport SplitPane from 'react-split-pane'\r\nimport {useGesture} from 'react-use-gesture'\r\nimport {BMProps} from '../utils'\r\nimport {styleForSplit} from '../utils/styles'\r\nimport {ChatInBar} from './Chat'\r\nimport {ContentList} from './ContentList'\r\nimport {ParticipantList} from './ParticipantList'\r\n\r\n\r\nexport interface TextLineStyle {\r\n  lineHeight: number\r\n  fontSize: number\r\n}\r\nconst defaultTextLineHeight = {\r\n  lineHeight:20,\r\n  fontSize:16,\r\n}\r\n\r\nfunction limitScale(currentScale: number, scale: number): number {\r\n  const targetScale = currentScale * scale\r\n  const maxScale = 4\r\n  const minScale = 0.5\r\n\r\n  if (targetScale > maxScale) { return maxScale }\r\n  if (targetScale < minScale) { return minScale }\r\n\r\n  return targetScale\r\n}\r\nconst textLineStyle = Object.assign({}, defaultTextLineHeight)\r\n\r\nexport const LeftBar: React.FC<BMProps> = (props) => {\r\n  const classes = styleForSplit()\r\n  const [scale, doSetScale] = useState<number>(1)\r\n  const setScale = (scale:number) => {\r\n    Object.assign(textLineStyle, defaultTextLineHeight)\r\n    textLineStyle.fontSize *= scale\r\n    textLineStyle.lineHeight *= scale\r\n    doSetScale(scale)\r\n  }\r\n\r\n  const bind = useGesture(\r\n    {\r\n      onPinch: ({da: [d, a], origin, event, memo}) => {\r\n        if (memo === undefined) {\r\n          return [d, a]\r\n        }\r\n        const [md] = memo\r\n\r\n        const MIN_D = 10\r\n        const scaleChange = d > MIN_D ? d / md : d <  -MIN_D ? md / d : (1 + (d - md) / MIN_D)\r\n        setScale(limitScale(scale, scaleChange))\r\n        //  console.log(`Pinch: da:${[d, a]} origin:${origin}  memo:${memo}  scale:${scale}`)\r\n\r\n        return [d, a]\r\n      },\r\n    },\r\n    {\r\n      eventOptions:{passive:false}, //  This prevents default zoom by browser when pinch.\r\n    },\r\n  )\r\n\r\n\r\n  return (\r\n    <div {...bind()}>\r\n      <SplitPane split=\"horizontal\" defaultSize=\"80%\" resizerClassName = {classes.resizerHorizontal}\r\n        paneStyle = {{overflowY: 'auto', overflowX: 'hidden', width:'100%'}} >\r\n        <SplitPane split=\"horizontal\" defaultSize=\"50%\" resizerClassName = {classes.resizerHorizontal}\r\n          paneStyle = {{overflowY: 'auto', overflowX: 'hidden', width:'100%'}} >\r\n          <ParticipantList {...props} {...textLineStyle} />\r\n          <ContentList {...props}  {...textLineStyle} />\r\n        </SplitPane >\r\n        <ChatInBar {...props}  {...textLineStyle} />\r\n      </SplitPane >\r\n    </div>\r\n  )\r\n}\r\nLeftBar.displayName = 'LeftBar' */\r\n\r\n\r\n\r\nimport React, {useState} from 'react'\r\nimport SplitPane from 'react-split-pane'\r\nimport {useGesture} from 'react-use-gesture'\r\nimport {BMProps} from '../utils'\r\nimport {styleForSplit} from '../utils/styles'\r\nimport {ChatInBar} from './Chat'\r\nimport {ContentList} from './ContentList'\r\nimport {ParticipantList} from './ParticipantList'\r\n\r\nimport { getSelectedMenuPos } from '@components/App'\r\nimport { getSelectedMenuType } from '@components/App'\r\nimport { useObserver } from 'mobx-react-lite'\r\n\r\n//declare const config:any             //  from ../../config.js included from index.html\r\n\r\nexport interface TextLineStyle {\r\n  lineHeight: number\r\n  fontSize: number\r\n}\r\nconst defaultTextLineHeight = {\r\n  lineHeight:20,\r\n  fontSize:16,\r\n}\r\n\r\nfunction limitScale(currentScale: number, scale: number): number {\r\n  const targetScale = currentScale * scale\r\n  const maxScale = 4\r\n  const minScale = 0.5\r\n\r\n  if (targetScale > maxScale) { return maxScale }\r\n  if (targetScale < minScale) { return minScale }\r\n\r\n  return targetScale\r\n}\r\nconst textLineStyle = Object.assign({}, defaultTextLineHeight)\r\n\r\nexport const LeftBar: React.FC<BMProps&{type?:string}> = (props) => {\r\n  const classes = styleForSplit()\r\n  const [scale, doSetScale] = useState<number>(1)\r\n\r\n  const cContent = useObserver(() => props.stores.contents.all)\r\n\r\n\r\n  const setScale = (scale:number) => {\r\n    Object.assign(textLineStyle, defaultTextLineHeight)\r\n    textLineStyle.fontSize *= scale\r\n    textLineStyle.lineHeight *= scale\r\n    doSetScale(scale)\r\n  }\r\n\r\n  const bind = useGesture(\r\n    {\r\n      onPinch: ({da: [d, a], origin, event, memo}) => {\r\n        if (memo === undefined) {\r\n          return [d, a]\r\n        }\r\n        const [md] = memo\r\n\r\n        const MIN_D = 10\r\n        const scaleChange = d > MIN_D ? d / md : d <  -MIN_D ? md / d : (1 + (d - md) / MIN_D)\r\n        setScale(limitScale(scale, scaleChange))\r\n        //  console.log(`Pinch: da:${[d, a]} origin:${origin}  memo:${memo}  scale:${scale}`)\r\n\r\n        return [d, a]\r\n      },\r\n    },\r\n    {\r\n      eventOptions:{passive:false}, //  This prevents default zoom by browser when pinch.\r\n    },\r\n  )\r\n\r\n\r\n  //const _status = useObserver(() => getAbleStatus())\r\n  const _menuSelected = useObserver(() => getSelectedMenuType())\r\n\r\n\r\n\r\n  const _menuSelectedPos = useObserver(() => getSelectedMenuPos())\r\n\r\n\r\n\r\n\r\n  return (\r\n    <div {...bind()}>\r\n      {props.type === 'chat' ?\r\n      <SplitPane split=\"horizontal\" defaultSize=\"50%\" resizerClassName = {classes.resizerHorizontal}\r\n        paneStyle = {{overflowY: 'auto', overflowX: 'hidden', width:'100%', minWidth:'280px'}} >\r\n\r\n          <ParticipantList {...props} {...textLineStyle} />\r\n\r\n        <ChatInBar {...props}  {...textLineStyle} />\r\n      </SplitPane >\r\n      : (props.type === 'content') ?\r\n      <SplitPane split=\"horizontal\" defaultSize=\"100%\" resizerClassName = {classes.resizerHorizontal}\r\n        paneStyle = {{overflowY: 'auto', overflowX: 'hidden', width:'100%', minWidth:'280px'}} >\r\n          <ContentList {...props}  {...textLineStyle} />\r\n      </SplitPane >\r\n      :\r\n      <>\r\n      {cContent.filter(item => item.shareType === \"appimg\").map(content => (\r\n        (_menuSelected === content.type && _menuSelectedPos === -2) ?\r\n        <SplitPane split=\"horizontal\" defaultSize=\"100%\" resizerClassName = {classes.resizerHorizontal}\r\n          paneStyle = {{overflowY: 'auto', overflowX: 'hidden', width:'100%', minWidth:'280px'}} >\r\n            <iframe src= {content.url} title={content.type} allowTransparency={true} frameBorder={0} style={{width:'100%', height:'100%'}}></iframe>\r\n        </SplitPane >\r\n        : <></>\r\n       ))}\r\n      </>\r\n      }\r\n    </div>\r\n  )\r\n}\r\nLeftBar.displayName = 'LeftBar'\r\n","import {urlParameters} from '@models/url'\r\nimport {isPortrait, isSmartphone} from '@models/utils'\r\n/* import { rgb2Color } from '@models/utils' */\r\nimport chatStore from '@stores/Chat'\r\nimport errorInfo from '@stores/ErrorInfo'\r\nimport mapStore from '@stores/Map'\r\nimport participantsStore from '@stores/participants/Participants'\r\nimport roomInfo from '@stores/RoomInfo'\r\nimport sharedContentsStore from '@stores/sharedContents/SharedContents'\r\nimport {Observer, useObserver} from 'mobx-react-lite'\r\nimport React, {Fragment, useRef, useState, useEffect} from 'react'\r\nimport SplitPane from 'react-split-pane'\r\nimport { getLoginClick, getUserType } from './error/TheEntrance'\r\nimport {Footer} from './footer/Footer'\r\nimport {LeftBar} from './leftBar/LeftBar'\r\nimport {MainScreen} from './map/MainScreen'\r\nimport {Map} from './map/map'\r\nimport {Stores} from './utils'\r\nimport {styleCommon/* , styleForSplit */} from './utils/styles'\r\nimport logo_es from '@images/logo.png'\r\n//import { getLoginClick, getUserType} from './error/TheEntrance' // getRoomName\r\n\r\nimport tabCollapseChat from '@images/earshot_icon_tab.png'\r\nimport tabCollapseContent from '@images/earshot_icon_tab_content.png'\r\nimport tabChatActive from '@images/earshot_icon_btn-chat.png'\r\nimport tabContentActive from '@images/earshot_icon_btn-note.png'\r\nimport ArrowBackIosIcon from '@material-ui/icons/ArrowBackIos';\r\nimport ArrowForwardIosIcon from '@material-ui/icons/ArrowForwardIos';\r\nimport CloseTabIcon from '@material-ui/icons/HighlightOff';\r\nimport html2canvas from 'html2canvas'\r\nimport { Dialog, DialogContent } from '@material-ui/core'\r\nimport Draggable from 'react-draggable'\r\nimport { Emoticons } from './footer/Emoticons'\r\nimport { ZoneAvatar } from './footer/ZoneAvatar'\r\n\r\n\r\nlet _able:Boolean = false\r\nexport function getAbleStatus():Boolean {\r\n  return _able\r\n}\r\n\r\nlet _menuType:string = ''\r\nexport function getSelectedMenuType() :string {\r\n  return _menuType\r\n}\r\n\r\nlet _menuPos:number = -2\r\nexport function getSelectedMenuPos() : number {\r\n  return _menuPos;\r\n}\r\n\r\n//let selectedImage:string = ''\r\nlet selectedGroup = ''\r\nlet selectedSkin = ''\r\nlet selectedHairColor = ''\r\nlet selectedHair = ''\r\nlet selectedHairBack = ''\r\nlet selectedOutfits = ''\r\nlet selectedSpecs = ''\r\n\r\nexport const App: React.FC<{}> = () => {\r\n  /* const clsSplit = styleForSplit() */\r\n  const classes = styleCommon()\r\n  const DEBUG_VIDEO = false //  To see all local and remote tracks or not.\r\n  const stores:Stores = {\r\n    map: mapStore,\r\n    participants: participantsStore,\r\n    contents: sharedContentsStore,\r\n    chat: chatStore,\r\n    roomInfo: roomInfo,\r\n  }\r\n  const refDiv = useRef<HTMLDivElement>(null)\r\n  const [able, setAble] = useState<Boolean>(false)\r\n  const [showIntro, setShowIntro] = useState<Boolean>(true)\r\n  const [menuType, setMenuType] = useState('')\r\n  const [activeOutfit, setActiveOutfit] = useState(-1)\r\n  const [activeSpecs, setActiveSpecs] = useState(-1)\r\n  const [activeSkin, setActiveSkin] = useState(-1)\r\n  const [activeHair, setActiveHair] = useState(-1)\r\n  const [activeGroup, setActiveGroup] = useState(-1)\r\n  const [activeFrontHair, setActiveFrontHair] = useState(-1)\r\n  const [activeBackHair, setActiveBackHair] = useState(-1)\r\n  // help ui\r\n  const [showHelp, setShowHelp] = useState(false)\r\n  // for tab\r\n  const [position, setPosition] = useState({ x: 0, y: 0 })\r\n  const [activeTabIndex, setActiveTabIndex] = useState(-1)\r\n\r\n  // For Saving data\r\n  const refAvatar = useRef<HTMLDivElement>(null)\r\n\r\n  // For supporting Apps\r\n  const refEntity_0 = useRef<Draggable>(null)\r\n  const refEntity_1 = useRef<Draggable>(null)\r\n  const refEntity_2 = useRef<Draggable>(null)\r\n  const refEntity_3 = useRef<Draggable>(null)\r\n  const refEntity_4 = useRef<Draggable>(null)\r\n  const refEntity_5 = useRef<Draggable>(null)\r\n  const refEntity_6 = useRef<Draggable>(null)\r\n  const refEntity_7 = useRef<Draggable>(null)\r\n  const refEntity_8 = useRef<Draggable>(null)\r\n\r\n  // to display image and desc\r\n  let roomImgPath:string = \"\"\r\n  let roomImgDesc:string = \"\"\r\n  let activeBgColor:string = \"\"\r\n  let AllMenusTypes:any = []\r\n  const cContent = useObserver(() => stores.contents.all)\r\n  cContent.filter(item => item.shareType===\"roomimg\").map(content => (\r\n    roomImgPath = content.url\r\n  ))\r\n  cContent.filter(item => item.shareType===\"roomimg\").map(content => (\r\n    roomImgDesc = content.contentDesc\r\n  ))\r\n\r\n  // Setting default Menu Type\r\n  cContent.filter(item => item.shareType === \"appimg\").map((content, index) => (\r\n    index === 0 && menuType === '' ? setMenuType(content.type) : ''\r\n  ))\r\n  // For Apps section [Room based loading directly from JSON file]\r\n  cContent.filter(item => item.shareType === \"appimg\").map((content, index) => (\r\n    //console.log(content, \" TYPE \", index)\r\n    //content.type === menuType ? content.\r\n    //console.log(menuType, \" -------------- \", content.type)\r\n    menuType === content.type ? activeBgColor = content.baseColor : ''\r\n  ))\r\n  cContent.filter(item => item.shareType === \"appimg\").map((content, index) => (\r\n    AllMenusTypes.push(content.type)\r\n  ))\r\n  //const elementsRef = useRef(cContent.filter(item => item.shareType === \"appimg\").map(() => React.createRef()));\r\n  let press = false\r\n  const loginStatus = useObserver(() => stores.participants.localId)\r\n  const _roomName = sessionStorage.getItem(\"room\") //getRoomName()\r\n  const enterUserType = useObserver(() => getUserType())\r\n  //console.log(loginStatus, \" --------- !!!! -------- \", enterUserType)\r\n  _able = able\r\n  _menuType = menuType\r\n\r\n  let tabBGTopBGWeb:number = 0 //100 //98 //98\r\n  let tabBGTopBGMob:number = 0 //242 //238\r\n\r\n   ////////////////////////////////////////////////////////////\r\n   const [data,setData] = useState('');\r\n   const [uiData, setUIData] = useState('')\r\n   const getData=()=>{\r\n     fetch('folderlist.php?folder=avatar_tool/*/*.png')\r\n       .then((response) => response.text())\r\n       .then((response) => setData(response));\r\n     /* let dataStr = \"avatar_tool/Colors/es_co_group_0.png,avatar_tool/Colors/es_co_group_1.png,avatar_tool/Colors/es_co_group_2.png,avatar_tool/Colors/es_co_group_3.png,avatar_tool/Colors/es_co_group_4.png,avatar_tool/Colors/es_co_group_5.png,avatar_tool/Colors/es_co_group_6.png,avatar_tool/Colors/es_co_group_x.png,avatar_tool/Colors/es_co_hair_0.png,avatar_tool/Colors/es_co_hair_1.png,avatar_tool/Colors/es_co_hair_2.png,avatar_tool/Colors/es_co_hair_3.png,avatar_tool/Colors/es_co_hair_4.png,avatar_tool/Colors/es_co_hair_5.png,avatar_tool/Colors/es_co_hair_6.png,avatar_tool/Colors/es_co_skin_0.png,avatar_tool/Colors/es_co_skin_1.png,avatar_tool/Colors/es_co_skin_2.png,avatar_tool/Colors/es_co_skin_3.png,avatar_tool/Colors/es_co_skin_4.png,avatar_tool/Colors/es_co_skin_5_x.png,avatar_tool/Colors/es_co_skin_6_x.png,avatar_tool/Hair/avatars_hair_5_0_f.png,avatar_tool/Hair/avatars_hair_5_1_f.png,avatar_tool/Hair/avatars_hair_5_2_f.png,avatar_tool/Hair/avatars_hair_5_3_f.png,avatar_tool/Hair/avatars_hair_5_4_f.png,avatar_tool/Hair/avatars_hair_5_5_f.png,avatar_tool/Hair/avatars_hair_5_6_f.png,avatar_tool/Hair/es_hair_0_0_f.png,avatar_tool/Hair/es_hair_0_1_f.png,avatar_tool/Hair/es_hair_0_2_f.png,avatar_tool/Hair/es_hair_0_3_f.png,avatar_tool/Hair/es_hair_0_4_f.png,avatar_tool/Hair/es_hair_0_5_f.png,avatar_tool/Hair/es_hair_0_6_f.png,avatar_tool/Hair/es_hair_0_x_b.png,avatar_tool/Hair/es_hair_0_x_f.png,avatar_tool/Hair/es_hair_1_0_b.png,avatar_tool/Hair/es_hair_1_0_f.png,avatar_tool/Hair/es_hair_1_1_b.png,avatar_tool/Hair/es_hair_1_1_f.png,avatar_tool/Hair/es_hair_1_2_b.png,avatar_tool/Hair/es_hair_1_2_f.png,avatar_tool/Hair/es_hair_1_3_b.png,avatar_tool/Hair/es_hair_1_3_f.png,avatar_tool/Hair/es_hair_1_4_b.png,avatar_tool/Hair/es_hair_1_4_f.png,avatar_tool/Hair/es_hair_1_5_b.png,avatar_tool/Hair/es_hair_1_5_f.png,avatar_tool/Hair/es_hair_1_6_b.png,avatar_tool/Hair/es_hair_1_6_f.png,avatar_tool/Hair/es_hair_2_0_f.png,avatar_tool/Hair/es_hair_2_1_f.png,avatar_tool/Hair/es_hair_2_2_f.png,avatar_tool/Hair/es_hair_2_3_f.png,avatar_tool/Hair/es_hair_2_4_f.png,avatar_tool/Hair/es_hair_2_5_f.png,avatar_tool/Hair/es_hair_2_6_f.png,avatar_tool/Hair/es_hair_3_0_f.png,avatar_tool/Hair/es_hair_3_1_f.png,avatar_tool/Hair/es_hair_3_2_f.png,avatar_tool/Hair/es_hair_3_3_f.png,avatar_tool/Hair/es_hair_3_4_f.png,avatar_tool/Hair/es_hair_3_5_f.png,avatar_tool/Hair/es_hair_3_6_f.png,avatar_tool/Hair/es_hair_4_0_f.png,avatar_tool/Hair/es_hair_4_1_f.png,avatar_tool/Hair/es_hair_4_2_f.png,avatar_tool/Hair/es_hair_4_3_f.png,avatar_tool/Hair/es_hair_4_4_f.png,avatar_tool/Hair/es_hair_4_5_f.png,avatar_tool/Hair/es_hair_4_6_f.png,avatar_tool/Outfits/es_outfit_0.png,avatar_tool/Outfits/es_outfit_1.png,avatar_tool/Outfits/es_outfit_2.png,avatar_tool/Outfits/es_outfit_3.png,avatar_tool/Outfits/es_outfit_4.png,avatar_tool/Outfits/es_outfit_5.png,avatar_tool/Outfits/es_outfit_6.png,avatar_tool/Specs/es_specs_0.png,avatar_tool/Specs/es_specs_1.png,avatar_tool/Specs/es_specs_2.png,\"\r\n     setData(dataStr) */\r\n\r\n     /* let uiDataStr = \"help/help_0.png,help/help_1.png,help/help_2.png,\"\r\n     setUIData(uiDataStr) */\r\n   }\r\n\r\n   const getUIData=()=>{\r\n     fetch('folderlist.php?folder=ui/help/*.png')\r\n       .then((response) => response.text())\r\n       .then((response) => setUIData(response));\r\n\r\n     /* let uiDataStr = \"ui/help/help_0.png,ui/help/help_1.png,ui/help/help_2.png,\"\r\n     setUIData(uiDataStr) */\r\n   }\r\n\r\n\r\n   ////////////////////////////////////////////////////////////\r\n   //console.log(\"CALLLEEEED- \", loginStatus)\r\n\r\n   let sliderData: Array<string> = []\r\n   let sliderDots: Array<string> = []\r\n   if(uiData !== '') {\r\n     sliderData = uiData.split(',')\r\n     sliderDots = uiData.split(',')\r\n     sliderDots.pop()\r\n   }\r\n\r\n   useEffect(() => {\r\n     //console.log(\"CALLLEEEED- \", getLoginClick())\r\n     getData()\r\n     getUIData()\r\n\r\n     //console.log(enterUserType, \" --CHECK RANDOM-- \", activeSkin, \" --- \", stores.participants.local.information.randomAvatar, \" ==== \", stores.participants.local.information.randomAvatar.length)\r\n     if(getLoginClick() || loginStatus) {\r\n       if(enterUserType === \"N\" && activeSkin === -1 && (stores.participants.local.information.randomAvatar === undefined || stores.participants.local.information.randomAvatar.length === 0)) {\r\n         onGenerateRandomAvatar()\r\n         const genImage = setTimeout(() => {\r\n           clearTimeout(genImage)\r\n           onGenImageForNewUser()\r\n         }, 50)\r\n       }\r\n       const introTimer = setTimeout(() => {\r\n         clearTimeout(introTimer)\r\n         setShowIntro(false)\r\n\r\n         if(getUserType() === \"N\" && activeSkin === -1) {\r\n           setShowHelp(true)\r\n         }\r\n       }, 5000)\r\n     }\r\n   })\r\n\r\n   const [currentSlide, setCurrentSlide] = useState(0)\r\n   const slidesLength = sliderData.length-1\r\n\r\n   if(!Array.isArray(sliderData) || sliderData.length <= 0) {\r\n     return null\r\n   }\r\n\r\n   function onGenImageForNewUser() {\r\n     if (refAvatar.current === null) {\r\n       return\r\n     }\r\n\r\n     html2canvas(refAvatar.current, { allowTaint: true }).then(function(canvas:any) {\r\n       var formData = new FormData();\r\n       formData.append('imgData', canvas.toDataURL());\r\n       fetch('saveAvatarImage.php',\r\n         {\r\n           method: 'POST',\r\n           body: formData\r\n         }\r\n       )\r\n         .then((response) => response.text())\r\n         .then((response) => updateUserAvatar(response));\r\n       ////////////////////////////////////////////////////\r\n     })\r\n     .catch((err) => {\r\n       console.log(err)\r\n     })\r\n   }\r\n\r\n\r\n   function updateUserAvatar(_path:string) {\r\n     stores.participants.local.information.avatarSrc = _path\r\n\r\n     // Storing values to localstorage\r\n     stores.participants.local.information.randomAvatar = [selectedSkin, selectedHairColor, selectedGroup, selectedHair, selectedOutfits, selectedSpecs]\r\n\r\n     stores.participants.local.sendInformation()\r\n     stores.participants.local.saveInformationToStorage(true)\r\n   }\r\n\r\n   function generateRandomNumber(min:number, max:number) {\r\n     return Math.floor(Math.random() * (max - min + 1) + min)\r\n   }\r\n\r\n\r\n   function onGenerateRandomAvatar() {\r\n\r\n     //////////////////////////////////////////////////////////////////////////////\r\n\r\n   //console.log(data, \" data\")\r\n   // format accordingly to folder name\r\n   const folders : Array<string> = []\r\n   const images : Array<string> = []\r\n   let tempArr : string = ''\r\n   let dataFolderWise = data.split(',')\r\n\r\n   for (let i=0; i<dataFolderWise.length-1; i++) {\r\n       if(folders.indexOf(dataFolderWise[i].split('/')[1]) === -1 && dataFolderWise[i].split('/')[1] !== undefined) {\r\n         folders.push(dataFolderWise[i].split('/')[1])\r\n       }\r\n\r\n     }\r\n     for (var j=0; j < folders.length; j++) {\r\n       for (let i=0; i<dataFolderWise.length-1; i++) {\r\n       if(folders[j] === dataFolderWise[i].split('/')[1]) {\r\n         tempArr += (dataFolderWise[i]) + ','\r\n       }\r\n     }\r\n     images.push(tempArr)\r\n     tempArr = ''\r\n   }\r\n   ////////////////////////////////////////////////////////////////////////////\r\n     // For Group, Skin and Hair Color setting\r\n     //let randGroupIndex = generateRandomNumber(0,6)\r\n     let randSkinIndex = generateRandomNumber(15, 20)\r\n     let randHairColorIndex = generateRandomNumber(8, 14)\r\n     let imgArr = images[0].split(',')\r\n     let randGroupIndex = imgArr.indexOf('avatar_tool/Colors/es_co_group_x.png')\r\n\r\n     //console.log(randGroupIndex)\r\n\r\n     //if(pageIndex === 0) {\r\n       //if(randGroupIndex < 7) {\r\n         selectedGroup = imgArr[randGroupIndex]\r\n         if(activeGroup !== randGroupIndex) {\r\n           setActiveGroup(randGroupIndex)\r\n         }\r\n       //}\r\n     //}\r\n     if(randHairColorIndex >= 7 && randHairColorIndex < 15) {\r\n       selectedHairColor = imgArr[randHairColorIndex].split('/')[2].split('.')[0].split('co_')[1]\r\n       if(activeHair !== randHairColorIndex) {\r\n         setActiveHair(randHairColorIndex)\r\n       }\r\n     }\r\n     if(randSkinIndex >= 15 && randSkinIndex < 20) {\r\n       selectedSkin = imgArr[randSkinIndex]\r\n       if(activeSkin !== randSkinIndex) {\r\n         setActiveSkin(randSkinIndex)\r\n       }\r\n     }\r\n   //}\r\n\r\n     // Setting Hairs [ Front , Back ]\r\n     let imgHairArr = images[1].split(',')\r\n     let frontHairs : Array<string> = []\r\n     let frontHairIndex : Array<number> = []\r\n     let backHairs : Array<string> = []\r\n     let backHairIndex : Array<number> = []\r\n     frontHairs.splice(0)\r\n     frontHairIndex.splice(0)\r\n     backHairs.splice(0)\r\n     backHairIndex.splice(0)\r\n     for (let i:number = 0; i < imgHairArr.length - 1; i++) {\r\n       //console.log(selectedHairColor.split('_')[1], \" ---- \", imgHairArr[i].split(\"_\")[4])\r\n       //if(imgHairArr[i].indexOf(selectedHairColor) !== -1) {\r\n\r\n         //console.log(selectedHairColor.split('_')[1], \" --- \", selectedHairColor)\r\n\r\n         if(imgHairArr.indexOf(selectedHairColor.split('_')[1] + '_' + imgHairArr[i].split(\"_\")[4]) === -1) {\r\n         if((selectedHairColor.split(\"_\")[1] === imgHairArr[i].split(\"_\")[4])) {\r\n           let hairType = imgHairArr[i].split('/')[2].split('.')[0].split('_')[4]\r\n           if(hairType === 'f') {\r\n             frontHairs.push(imgHairArr[i])\r\n             frontHairIndex.push(i)\r\n           } else if(hairType === 'b') {\r\n             backHairs.push(imgHairArr[i])\r\n             backHairIndex.push(i)\r\n           }\r\n         }\r\n       }\r\n     }\r\n     if(frontHairs.length > 0) {\r\n       let randFrontHairIndex = generateRandomNumber(0, frontHairs.length-1)\r\n       selectedHair = frontHairs[randFrontHairIndex]\r\n       //console.log(frontHairs[randFrontHairIndex])\r\n       if(activeFrontHair !== frontHairIndex[randFrontHairIndex]) {\r\n         setActiveFrontHair(frontHairIndex[randFrontHairIndex])\r\n       }\r\n       //console.log(frontHairs[randFrontHairIndex].split('/')[2].split('.')[0], \" random front\")\r\n       let findBack = imgHairArr.indexOf(String(frontHairs[randFrontHairIndex].split('_f.png')[0] + '_b.png'))\r\n       //console.log(String(frontHairs[randFrontHairIndex].split('_f.png')[0] + '_b.png'), \" BackRandom \", findBack)\r\n       //console.log(findBack, \" findBack\")\r\n       if(findBack !== -1) {\r\n         selectedHairBack = imgHairArr[findBack]\r\n         if(activeBackHair !== findBack) {\r\n           setActiveBackHair(findBack)\r\n         } else {\r\n           selectedHairBack = ''\r\n           setActiveBackHair(-1)\r\n         }\r\n       } else {\r\n         selectedHairBack = ''\r\n         setActiveBackHair(-1)\r\n       }\r\n\r\n     } else {\r\n       selectedHair = ''\r\n       setActiveFrontHair(-1)\r\n\r\n       selectedHairBack = ''\r\n       setActiveBackHair(-1)\r\n     }\r\n     /* if(backHairs.length > 0) {\r\n       let randBackHairIndex = generateRandomNumber(0, backHairs.length-1)\r\n       selectedHairBack = backHairs[randBackHairIndex]\r\n       setActiveBackHair(backHairIndex[randBackHairIndex])\r\n     } else {\r\n       selectedHairBack = ''\r\n       setActiveBackHair(-1)\r\n     } */\r\n\r\n     // Setting OutFits\r\n     let imgOutfitArr = images[2].split(',')\r\n     let randOutfitIndex = generateRandomNumber(0, imgOutfitArr.length-2)\r\n     selectedOutfits = imgOutfitArr[randOutfitIndex]\r\n     if(activeOutfit !== randOutfitIndex) {\r\n       setActiveOutfit(randOutfitIndex)\r\n     }\r\n\r\n     // Setting Specs\r\n     let imgSpecsArr = images[3].split(',')\r\n     let randSpecsIndex = generateRandomNumber(0, imgSpecsArr.length-2)\r\n     selectedSpecs = imgSpecsArr[randSpecsIndex]\r\n     if(activeSpecs !== randSpecsIndex) {\r\n       setActiveSpecs(randSpecsIndex)\r\n     }\r\n   }\r\n\r\n\r\n   function onPrevClick() {\r\n     //console.log(\"prev click\")\r\n     setCurrentSlide(currentSlide === 0 ? slidesLength-1 : currentSlide - 1)\r\n   }\r\n\r\n   function onNextClick() {\r\n     //console.log(\"next click\")\r\n     setCurrentSlide(currentSlide === slidesLength-1 ? 0 : currentSlide + 1)\r\n   }\r\n\r\n\r\n  window.addEventListener('keydown', (ev) => {\r\n    //ev.preventDefault()\r\n    if(ev.ctrlKey) {return}\r\n\r\n    if(ev.key === \"F3\" && press === false) {\r\n      ev.preventDefault()\r\n      press = true;\r\n      if(able === true) {\r\n        setAble(false)\r\n      } else\r\n      if(able === false) {\r\n        setAble(true)\r\n      }\r\n    }\r\n  }, {})\r\n  //  toucmove: prevent browser zoom by pinch\r\n  window.addEventListener('touchmove', (ev) => {\r\n    //  if (ev.touches.length > 1) {\r\n    ev.preventDefault()\r\n    //  }\r\n  },                      {passive: false, capture: false})\r\n  //  contextmenu: prevent to show context menu with right mouse click\r\n  window.addEventListener('contextmenu', (ev) => {\r\n    ev.preventDefault()\r\n  },                      {passive: false, capture: false})\r\n\r\n  //  Global error handler\r\n  window.onerror = (message, source, lineno, colno, error) => {\r\n    if ((error?.message === 'Ping timeout' || error?.message === 'Strophe: Websocket error [object Event]')\r\n     && message === null && source === null && lineno === null && colno === null){\r\n      errorInfo.setType('connection')\r\n      if (urlParameters.testBot !== null){  //  testBot\r\n        window.location.reload()  //  testBot will reload when connection is cutted off.\r\n      }\r\n    }else{\r\n      console.warn(`Global handler: ${message}`, source, lineno, colno, error)\r\n    }\r\n    return true\r\n  }\r\n\r\n\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n\r\n  function trackPos(data:any, _index:number, _menu:string) {\r\n    //console.log(data.x, \" XXXX START\")\r\n\r\n    if(data.x > -100 || data.x === 0) {\r\n      setPosition({ x: 0, y: 0 })\r\n      return\r\n    }\r\n\r\n    setPosition({ x: data.x, y: data.y })\r\n    _menuPos = position.x\r\n\r\n    //_menuType = menu\r\n\r\n    // Setting Pos\r\n    CheckAndSetPosition(_index)\r\n    CheckAndActivateMenu(_index)\r\n\r\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n    // Check How many items are there in the dock tab\r\n    /* let _bool = false\r\n    if(Object(refEntity_0.current?.state).x === 0 || Object(refEntity_1.current?.state).x === 0 || Object(refEntity_2.current?.state).x === 0) {\r\n      _bool = true\r\n    }\r\n    console.log(_bool) */\r\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n/*\r\n    if(_index === 0) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0 || Object(refEntity_0.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = (0)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = (moveIndex * -51)\r\n      }\r\n\r\n    } else if(_index === 1) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = (0)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0 || Object(refEntity_1.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else if(Object(refEntity_1.current?.state).x === 0) {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = (moveIndex * -51)\r\n      }\r\n    } else if(_index === 2) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = (0)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0 || Object(refEntity_2.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = (moveIndex * -51)\r\n      }\r\n    } else if(_index === 3) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0 || Object(refEntity_3.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = (moveIndex * -51)\r\n      }\r\n    } else if(_index === 4) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0 || Object(refEntity_4.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = (moveIndex * -51)\r\n      }\r\n    } else if(_index === 5) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0 || Object(refEntity_5.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = (moveIndex * -51)\r\n      }\r\n    } else if(_index === 6) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0  || Object(refEntity_6.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = (moveIndex * -51)\r\n      }\r\n    }\r\n     */\r\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n    //setMenuType('chat')\r\n    setActiveTabIndex(_index)\r\n\r\n    //setMenuType('chat')\r\n    //setAble(false)\r\n\r\n    /* cContent.filter(item => item.shareType === \"appimg\").map((content, index) => (\r\n      console.log(Object(refEntity.current?.state).x, \" - ALL X POS - \", content.type)\r\n    )) */\r\n  }\r\n\r\n  /* function setDefaultTrack(_url:string, _index:number) {\r\n    if(_index === 0) {\r\n      Object(refEntity_0.current?.state).x = -99999999\r\n      console.log(\"Hiding Element\", Object(refEntity_0.current))\r\n    } else if(_index === 1) {\r\n      Object(refEntity_1.current?.state).x = -99999999\r\n    } else if(_index === 2) {\r\n      Object(refEntity_2.current?.state).x = -99999999\r\n    } else if(_index === 3) {\r\n      Object(refEntity_3.current?.state).x = -99999999\r\n    } else if(_index === 4) {\r\n      Object(refEntity_4.current?.state).x = -99999999\r\n    }\r\n\r\n    ///////////////////////////////////////////////////////\r\n    //window.open(_url, \"_new\")\r\n    let externalWindow = window.open(_url, '', 'width=400,height=650,left=500,top=100');\r\n    var timer = setInterval(function() {\r\n      if(externalWindow?.closed) {\r\n          clearInterval(timer);\r\n      }})\r\n  } */\r\n\r\n\r\n\r\n  function CheckAndActivateMenu(_index:number) {\r\n    //console.log(AllMenusTypes)\r\n    if(AllMenusTypes.length === 0) {\r\n      if(_index === 0) {\r\n        if(Object(refEntity_1.current?.state).x === 0) {\r\n          setMenuType('content')\r\n        } else {\r\n          setMenuType('blank')\r\n        }\r\n      } else if(_index === 1) {\r\n        if(Object(refEntity_0.current?.state).x === 0) {\r\n          setMenuType('chat')\r\n        } else {\r\n          setMenuType('blank')\r\n        }\r\n      }\r\n    } else {\r\n      if(_index === 0) {\r\n        if(Object(refEntity_1.current?.state).x === 0) {\r\n          setMenuType('content')\r\n        } else if(Object(refEntity_2.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index])\r\n        } else if(Object(refEntity_3.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index+1])\r\n        } else if(Object(refEntity_4.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index+2])\r\n        } else if(Object(refEntity_5.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index+3])\r\n        } else if(Object(refEntity_6.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index+4])\r\n        } else {\r\n          setMenuType('blank')\r\n        }\r\n      } else if(_index === 1) {\r\n        if(Object(refEntity_0.current?.state).x === 0) {\r\n          setMenuType('chat')\r\n        } else if(Object(refEntity_2.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index-1])\r\n        } else if(Object(refEntity_3.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index])\r\n        } else if(Object(refEntity_4.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index+1])\r\n        } else if(Object(refEntity_5.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index+3])\r\n        } else if(Object(refEntity_6.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index+4])\r\n        } else {\r\n          setMenuType('blank')\r\n        }\r\n      } else if(_index >= 2) {\r\n        if(Object(refEntity_0.current?.state).x === 0) {\r\n          setMenuType('chat')\r\n        } else if(Object(refEntity_1.current?.state).x === 0) {\r\n          setMenuType('content')\r\n        } else if(Object(refEntity_3.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index-2])\r\n        } else if(Object(refEntity_4.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index-2])\r\n        } else if(Object(refEntity_5.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index-2])\r\n        } else if(Object(refEntity_6.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index-2])\r\n        } else {\r\n          setMenuType('blank')\r\n        }\r\n      } /* else if(_index === 3) {\r\n        if(Object(refEntity_0.current?.state).x === 0) {\r\n          setMenuType('chat')\r\n        } else if(Object(refEntity_1.current?.state).x === 0) {\r\n          setMenuType('content')\r\n        } else if(Object(refEntity_2.current?.state).x === 0) {\r\n          setMenuType(AllMenusTypes[_index-2])\r\n        } else if(Object(refEntity_4.current?.state).x === 0) {\r\n          setMenuType(AllMenusTypes[_index-2])\r\n        } else if(Object(refEntity_5.current?.state).x === 0) {\r\n          setMenuType(AllMenusTypes[_index-2])\r\n        } else if(Object(refEntity_6.current?.state).x === 0) {\r\n          setMenuType(AllMenusTypes[_index-2])\r\n        } else {\r\n          setMenuType('blank')\r\n        }\r\n      } */\r\n    }\r\n  }\r\n\r\n\r\n\r\n\r\n  function CheckAndSetPosition(_index:number) {\r\n\r\n    if(_index === 0) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0 || Object(refEntity_0.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = (0)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n\r\n    } else if(_index === 1) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = (0)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0 || Object(refEntity_1.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else if(Object(refEntity_1.current?.state).x === 0) {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n    } else if(_index === 2) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = (0)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0 || Object(refEntity_2.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n    } else if(_index === 3) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0 || Object(refEntity_3.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n    } else if(_index === 4) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0 || Object(refEntity_4.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n    } else if(_index === 5) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0 || Object(refEntity_5.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n    } else if(_index === 6) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0  || Object(refEntity_6.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  function setTrack(data:any, _url:string, _index:number) {\r\n    //setMenuType(_type)\r\n\r\n    /* if(_index === 0) {\r\n      if(Object(refEntity_0.current?.state).x > 0) {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = (0)\r\n      }\r\n      _menuPos = -2\r\n    } */\r\n\r\n    /* if(data.x >= -1) {\r\n    if(_index === 0) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x >= 0) {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = (0)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n      if(Object(refEntity_1.current?.state).x === 0) {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = (moveIndex * 51)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n\r\n      if(Object(refEntity_2.current?.state).x === 0) {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n\r\n      if(Object(refEntity_3.current?.state).x === 0) {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n      if(Object(refEntity_4.current?.state).x === 0) {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n      }\r\n      _menuPos = -2\r\n    } else if(_index === 1) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x === 0) {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = (0)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n      if(Object(refEntity_1.current?.state).x >= 0) {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n\r\n      if(Object(refEntity_2.current?.state).x === 0) {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n\r\n      if(Object(refEntity_3.current?.state).x === 0) {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n      if(Object(refEntity_4.current?.state).x === 0) {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n      }\r\n      _menuPos = -2\r\n    } else if(_index === 2) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x === 0) {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = (0)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n      if(Object(refEntity_1.current?.state).x === 0) {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n\r\n      if(Object(refEntity_2.current?.state).x >= 0) {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n\r\n      if(Object(refEntity_3.current?.state).x === 0) {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n      if(Object(refEntity_4.current?.state).x === 0) {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n      }\r\n      _menuPos = -2\r\n    } else if(_index === 3) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x === 0) {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = (0)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n      if(Object(refEntity_1.current?.state).x === 0) {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = (0)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n\r\n      if(Object(refEntity_2.current?.state).x === 0) {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n\r\n      if(Object(refEntity_3.current?.state).x >= 0) {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n      if(Object(refEntity_4.current?.state).x === 0) {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = (0)\r\n      }\r\n      _menuPos = -2\r\n    } else if(_index === 4) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x === 0) {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = (0)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n      if(Object(refEntity_1.current?.state).x === 0) {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = (0)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n\r\n      if(Object(refEntity_2.current?.state).x === 0) {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = (0)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n\r\n      if(Object(refEntity_3.current?.state).x === 0) {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n      } else {\r\n        moveIndex = moveIndex + 1\r\n      }\r\n      if(Object(refEntity_4.current?.state).x >= 0) {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n      }\r\n      _menuPos = -2\r\n    }\r\n  } */\r\n\r\n\r\n  // 30\r\n  //console.log(window.innerHeight, \" --- \", data.y)\r\n  //console.log(data.x, \" ---- \", (stores.map.screenSize))\r\n\r\n  //console.log(data.y, \"  < \" , ((_index * -51)))\r\n\r\n  //if(data.x === -40 || data.x === 0) {return}\r\n\r\n\r\n    //if(data.y < (-135 + (_index * -51)) || data.y > (675 + (_index * -51)) || data.x < (-(stores.map.screenSize[0] - 40)) || data.x > 0) {\r\n    if(data.y < ((_index * -51)) || data.y > (675 + (_index * -51)) || data.x < (-(stores.map.screenSize[0] - 40)) || data.x > 0) {\r\n      ///////////////////////////////////////////////////////\r\n      // Hide the Tab\r\n      if(_index === 0) {\r\n        //Object(refEntity_0.current?.state).x = -99999999\r\n        ResetAppsPanel(0, 'chat')\r\n        return\r\n      } else if(_index === 1) {\r\n        //Object(refEntity_1.current?.state).x = -99999999\r\n        ResetAppsPanel(1, 'content')\r\n        return\r\n      } else if(_index === 2) {\r\n        Object(refEntity_2.current?.state).x = -99999999\r\n      } else if(_index === 3) {\r\n        Object(refEntity_3.current?.state).x = -99999999\r\n      } else if(_index === 4) {\r\n        Object(refEntity_4.current?.state).x = -99999999\r\n      } else if(_index === 5) {\r\n        Object(refEntity_5.current?.state).x = -99999999\r\n      } else if(_index === 6) {\r\n        Object(refEntity_6.current?.state).x = -99999999\r\n      }\r\n\r\n      ///////////////////////////////////////////////////////\r\n      //window.open(_url, \"_new\")\r\n      let externalWindow = window.open(_url, '', 'width=400,height=650,left=500,top=100');\r\n      var timer = setInterval(function() {\r\n        if(externalWindow?.closed) {\r\n            clearInterval(timer);\r\n            //alert(_index);\r\n            //////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n            //CheckAndSetPosition(_index)\r\n            if(_index === 0) {\r\n              let moveIndex = 0\r\n              if(Object(refEntity_0.current?.state).x < 0 || Object(refEntity_0.current?.state).x > 0) {\r\n                Object(refEntity_0.current?.state).x = 0\r\n                Object(refEntity_0.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_1.current?.state).x === 0) {\r\n                Object(refEntity_1.current?.state).x = 0\r\n                Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * 51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_2.current?.state).x === 0) {\r\n                Object(refEntity_2.current?.state).x = 0\r\n                Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_3.current?.state).x === 0) {\r\n                Object(refEntity_3.current?.state).x = 0\r\n                Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_4.current?.state).x === 0) {\r\n                Object(refEntity_4.current?.state).x = 0\r\n                Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_5.current?.state).x === 0) {\r\n                Object(refEntity_5.current?.state).x = 0\r\n                Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_6.current?.state).x === 0) {\r\n                Object(refEntity_6.current?.state).x = 0\r\n                Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              }\r\n            } else if(_index === 1) {\r\n              let moveIndex = 0\r\n              if(Object(refEntity_0.current?.state).x === 0) {\r\n                Object(refEntity_0.current?.state).x = 0\r\n                Object(refEntity_0.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_1.current?.state).x < 0 || Object(refEntity_1.current?.state).x > 0) {\r\n                Object(refEntity_1.current?.state).x = 0\r\n                Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_2.current?.state).x === 0) {\r\n                Object(refEntity_2.current?.state).x = 0\r\n                Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_3.current?.state).x === 0) {\r\n                Object(refEntity_3.current?.state).x = 0\r\n                Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_4.current?.state).x === 0) {\r\n                Object(refEntity_4.current?.state).x = 0\r\n                Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_5.current?.state).x === 0) {\r\n                Object(refEntity_5.current?.state).x = 0\r\n                Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_6.current?.state).x === 0) {\r\n                Object(refEntity_6.current?.state).x = 0\r\n                Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              }\r\n            } else if(_index === 2) {\r\n              let moveIndex = 0\r\n              if(Object(refEntity_0.current?.state).x === 0) {\r\n                Object(refEntity_0.current?.state).x = 0\r\n                Object(refEntity_0.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_1.current?.state).x === 0) {\r\n                Object(refEntity_1.current?.state).x = 0\r\n                Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_2.current?.state).x < 0 || Object(refEntity_2.current?.state).x > 0) {\r\n                Object(refEntity_2.current?.state).x = 0\r\n                Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_3.current?.state).x === 0) {\r\n                Object(refEntity_3.current?.state).x = 0\r\n                Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_4.current?.state).x === 0) {\r\n                Object(refEntity_4.current?.state).x = 0\r\n                Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_5.current?.state).x === 0) {\r\n                Object(refEntity_5.current?.state).x = 0\r\n                Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_6.current?.state).x === 0) {\r\n                Object(refEntity_6.current?.state).x = 0\r\n                Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              }\r\n            } else if(_index === 3) {\r\n              let moveIndex = 0\r\n              if(Object(refEntity_0.current?.state).x === 0) {\r\n                Object(refEntity_0.current?.state).x = 0\r\n                Object(refEntity_0.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_1.current?.state).x === 0) {\r\n                Object(refEntity_1.current?.state).x = 0\r\n                Object(refEntity_1.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_2.current?.state).x === 0) {\r\n                Object(refEntity_2.current?.state).x = 0\r\n                Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_3.current?.state).x < 0 || Object(refEntity_3.current?.state).x > 0) {\r\n                Object(refEntity_3.current?.state).x = 0\r\n                Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_4.current?.state).x === 0) {\r\n                Object(refEntity_4.current?.state).x = 0\r\n                Object(refEntity_4.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_5.current?.state).x === 0) {\r\n                Object(refEntity_5.current?.state).x = 0\r\n                Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_6.current?.state).x === 0) {\r\n                Object(refEntity_6.current?.state).x = 0\r\n                Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              }\r\n            } else if(_index === 4) {\r\n              let moveIndex = 0\r\n              if(Object(refEntity_0.current?.state).x === 0) {\r\n                Object(refEntity_0.current?.state).x = 0\r\n                Object(refEntity_0.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_1.current?.state).x === 0) {\r\n                Object(refEntity_1.current?.state).x = 0\r\n                Object(refEntity_1.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_2.current?.state).x === 0) {\r\n                Object(refEntity_2.current?.state).x = 0\r\n                Object(refEntity_2.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_3.current?.state).x === 0) {\r\n                Object(refEntity_3.current?.state).x = 0\r\n                Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_4.current?.state).x < 0 || Object(refEntity_4.current?.state).x > 0) {\r\n                Object(refEntity_4.current?.state).x = 0\r\n                Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_5.current?.state).x === 0) {\r\n                Object(refEntity_5.current?.state).x = 0\r\n                Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_6.current?.state).x === 0) {\r\n                Object(refEntity_6.current?.state).x = 0\r\n                Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              }\r\n            } else if(_index === 5) {\r\n              let moveIndex = 0\r\n              if(Object(refEntity_0.current?.state).x === 0) {\r\n                Object(refEntity_0.current?.state).x = 0\r\n                Object(refEntity_0.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_1.current?.state).x === 0) {\r\n                Object(refEntity_1.current?.state).x = 0\r\n                Object(refEntity_1.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_2.current?.state).x === 0) {\r\n                Object(refEntity_2.current?.state).x = 0\r\n                Object(refEntity_2.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_3.current?.state).x === 0) {\r\n                Object(refEntity_3.current?.state).x = 0\r\n                Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_4.current?.state).x === 0) {\r\n                Object(refEntity_4.current?.state).x = 0\r\n                Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_5.current?.state).x < 0  || Object(refEntity_5.current?.state).x > 0) {\r\n                Object(refEntity_5.current?.state).x = 0\r\n                Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_6.current?.state).x === 0) {\r\n                Object(refEntity_6.current?.state).x = 0\r\n                Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              }\r\n            } else if(_index === 6) {\r\n              let moveIndex = 0\r\n              if(Object(refEntity_0.current?.state).x === 0) {\r\n                Object(refEntity_0.current?.state).x = 0\r\n                Object(refEntity_0.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_1.current?.state).x === 0) {\r\n                Object(refEntity_1.current?.state).x = 0\r\n                Object(refEntity_1.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_2.current?.state).x === 0) {\r\n                Object(refEntity_2.current?.state).x = 0\r\n                Object(refEntity_2.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_3.current?.state).x === 0) {\r\n                Object(refEntity_3.current?.state).x = 0\r\n                Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_4.current?.state).x === 0) {\r\n                Object(refEntity_4.current?.state).x = 0\r\n                Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_5.current?.state).x === 0) {\r\n                Object(refEntity_5.current?.state).x = 0\r\n                Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_6.current?.state).x < 0  || Object(refEntity_5.current?.state).x > 0) {\r\n                Object(refEntity_6.current?.state).x = 0\r\n                Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              }\r\n            }\r\n\r\n            //////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n            setPosition({x:0, y:0})\r\n        }\r\n    }, 100);\r\n      ///////////////////////////////////////////////////////\r\n      /* if(_index === 0) {\r\n        let moveIndex = 0\r\n        if(Object(refEntity_0.current?.state).x < 0) {\r\n          Object(refEntity_0.current?.state).x = 0\r\n          Object(refEntity_0.current?.state).y = (0)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n        if(Object(refEntity_1.current?.state).x === 0) {\r\n          Object(refEntity_1.current?.state).x = 0\r\n          Object(refEntity_1.current?.state).y = (moveIndex * 51)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n\r\n        if(Object(refEntity_2.current?.state).x === 0) {\r\n          Object(refEntity_2.current?.state).x = 0\r\n          Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n\r\n        if(Object(refEntity_3.current?.state).x === 0) {\r\n          Object(refEntity_3.current?.state).x = 0\r\n          Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n\r\n        if(Object(refEntity_4.current?.state).x === 0) {\r\n          Object(refEntity_4.current?.state).x = 0\r\n          Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n        }\r\n      } else if(_index === 1) {\r\n        let moveIndex = 0\r\n        if(Object(refEntity_0.current?.state).x === 0) {\r\n          Object(refEntity_0.current?.state).x = 0\r\n          Object(refEntity_0.current?.state).y = (0)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n        if(Object(refEntity_1.current?.state).x < 0) {\r\n          Object(refEntity_1.current?.state).x = 0\r\n          Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n\r\n        if(Object(refEntity_2.current?.state).x === 0) {\r\n          Object(refEntity_2.current?.state).x = 0\r\n          Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n\r\n        if(Object(refEntity_3.current?.state).x === 0) {\r\n          Object(refEntity_3.current?.state).x = 0\r\n          Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n        if(Object(refEntity_4.current?.state).x === 0) {\r\n          Object(refEntity_4.current?.state).x = 0\r\n          Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n        }\r\n      } else if(_index === 2) {\r\n        let moveIndex = 0\r\n        if(Object(refEntity_0.current?.state).x === 0) {\r\n          Object(refEntity_0.current?.state).x = 0\r\n          Object(refEntity_0.current?.state).y = (0)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n        if(Object(refEntity_1.current?.state).x === 0) {\r\n          Object(refEntity_1.current?.state).x = 0\r\n          Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n\r\n        if(Object(refEntity_2.current?.state).x < 0) {\r\n          Object(refEntity_2.current?.state).x = 0\r\n          Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n\r\n        if(Object(refEntity_3.current?.state).x === 0) {\r\n          Object(refEntity_3.current?.state).x = 0\r\n          Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n        if(Object(refEntity_4.current?.state).x === 0) {\r\n          Object(refEntity_4.current?.state).x = 0\r\n          Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n        }\r\n      } else if(_index === 3) {\r\n        let moveIndex = 0\r\n        if(Object(refEntity_0.current?.state).x === 0) {\r\n          Object(refEntity_0.current?.state).x = 0\r\n          Object(refEntity_0.current?.state).y = (0)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n        if(Object(refEntity_1.current?.state).x === 0) {\r\n          Object(refEntity_1.current?.state).x = 0\r\n          Object(refEntity_1.current?.state).y = (0)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n\r\n        if(Object(refEntity_2.current?.state).x === 0) {\r\n          Object(refEntity_2.current?.state).x = 0\r\n          Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n\r\n        if(Object(refEntity_3.current?.state).x < 0) {\r\n          Object(refEntity_3.current?.state).x = 0\r\n          Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n        if(Object(refEntity_4.current?.state).x === 0) {\r\n          Object(refEntity_4.current?.state).x = 0\r\n          Object(refEntity_4.current?.state).y = (0)\r\n        }\r\n      } else if(_index === 4) {\r\n        let moveIndex = 0\r\n        if(Object(refEntity_0.current?.state).x === 0) {\r\n          Object(refEntity_0.current?.state).x = 0\r\n          Object(refEntity_0.current?.state).y = (0)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n        if(Object(refEntity_1.current?.state).x === 0) {\r\n          Object(refEntity_1.current?.state).x = 0\r\n          Object(refEntity_1.current?.state).y = (0)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n\r\n        if(Object(refEntity_2.current?.state).x === 0) {\r\n          Object(refEntity_2.current?.state).x = 0\r\n          Object(refEntity_2.current?.state).y = (0)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n\r\n        if(Object(refEntity_3.current?.state).x === 0) {\r\n          Object(refEntity_3.current?.state).x = 0\r\n          Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n        } else {\r\n          moveIndex = moveIndex + 1\r\n        }\r\n        if(Object(refEntity_4.current?.state).x < 0) {\r\n          Object(refEntity_4.current?.state).x = 0\r\n          Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n        }\r\n      } */\r\n\r\n      ///////////////////////////////////////////////////////\r\n        _menuPos = -2\r\n        //setPosition({x:0, y:0})\r\n        setAble(false)\r\n    }\r\n  }\r\n\r\n//console.log(able, \" able\")\r\n\r\n//////////////////////////////////////////\r\n\r\n/* let timer = 0\r\nlet delay = 200;\r\nlet prevent = false;\r\n */\r\n\r\n/* function onSingleClickHandler() {\r\n  timer = window.setTimeout(() => {\r\n    if (!prevent) {\r\n      console.log(\"single click\")\r\n    }\r\n  }, delay);\r\n};\r\nfunction onDoubleClickHandler(){\r\n  clearTimeout(timer);\r\n  prevent = true;\r\n  setTimeout(() => {\r\n    prevent = false;\r\n    //console.log(\"double click\")\r\n\r\n  }, delay);\r\n}; */\r\n//////////////////////////////////////////\r\nfunction ResetAppsPanel(index:number, _type:string) {\r\n  if(index === 0) {\r\n    let moveIndex = 0\r\n    if(Object(refEntity_0.current?.state).x < 0 || Object(refEntity_0.current?.state).x > 0) {\r\n      Object(refEntity_0.current?.state).x = 0\r\n      Object(refEntity_0.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_1.current?.state).x === 0) {\r\n      Object(refEntity_1.current?.state).x = 0\r\n      Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * 51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_2.current?.state).x === 0) {\r\n      Object(refEntity_2.current?.state).x = 0\r\n      Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_3.current?.state).x === 0) {\r\n      Object(refEntity_3.current?.state).x = 0\r\n      Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_4.current?.state).x === 0) {\r\n      Object(refEntity_4.current?.state).x = 0\r\n      Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_5.current?.state).x === 0) {\r\n      Object(refEntity_5.current?.state).x = 0\r\n      Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_6.current?.state).x === 0) {\r\n      Object(refEntity_6.current?.state).x = 0\r\n      Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    }\r\n\r\n  } else if(index === 1) {\r\n    let moveIndex = 0\r\n    if(Object(refEntity_0.current?.state).x === 0) {\r\n      Object(refEntity_0.current?.state).x = 0\r\n      Object(refEntity_0.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_1.current?.state).x < 0 || Object(refEntity_1.current?.state).x > 0) {\r\n      Object(refEntity_1.current?.state).x = 0\r\n      Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_2.current?.state).x === 0) {\r\n      Object(refEntity_2.current?.state).x = 0\r\n      Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_3.current?.state).x === 0) {\r\n      Object(refEntity_3.current?.state).x = 0\r\n      Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_4.current?.state).x === 0) {\r\n      Object(refEntity_4.current?.state).x = 0\r\n      Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_5.current?.state).x === 0) {\r\n      Object(refEntity_5.current?.state).x = 0\r\n      Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_6.current?.state).x === 0) {\r\n      Object(refEntity_6.current?.state).x = 0\r\n      Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    }\r\n\r\n  } else if(index === 2) {\r\n    let moveIndex = 0\r\n    if(Object(refEntity_0.current?.state).x === 0) {\r\n      Object(refEntity_0.current?.state).x = 0\r\n      Object(refEntity_0.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_1.current?.state).x === 0) {\r\n      Object(refEntity_1.current?.state).x = 0\r\n      Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_2.current?.state).x < 0) {\r\n      Object(refEntity_2.current?.state).x = 0\r\n      Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_3.current?.state).x === 0) {\r\n      Object(refEntity_3.current?.state).x = 0\r\n      Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_4.current?.state).x === 0) {\r\n      Object(refEntity_4.current?.state).x = 0\r\n      Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_5.current?.state).x === 0) {\r\n      Object(refEntity_5.current?.state).x = 0\r\n      Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_6.current?.state).x === 0) {\r\n      Object(refEntity_6.current?.state).x = 0\r\n      Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    }\r\n\r\n  } else if(index === 3) {\r\n    let moveIndex = 0\r\n    if(Object(refEntity_0.current?.state).x === 0) {\r\n      Object(refEntity_0.current?.state).x = 0\r\n      Object(refEntity_0.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_1.current?.state).x === 0) {\r\n      Object(refEntity_1.current?.state).x = 0\r\n      Object(refEntity_1.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_2.current?.state).x === 0) {\r\n      Object(refEntity_2.current?.state).x = 0\r\n      Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_3.current?.state).x < 0) {\r\n      Object(refEntity_3.current?.state).x = 0\r\n      Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_4.current?.state).x === 0) {\r\n      Object(refEntity_4.current?.state).x = 0\r\n      Object(refEntity_4.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_5.current?.state).x === 0) {\r\n      Object(refEntity_5.current?.state).x = 0\r\n      Object(refEntity_5.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_6.current?.state).x === 0) {\r\n      Object(refEntity_6.current?.state).x = 0\r\n      Object(refEntity_6.current?.state).y = (0)\r\n    }\r\n  } else if(index === 4) {\r\n    let moveIndex = 0\r\n    if(Object(refEntity_0.current?.state).x === 0) {\r\n      Object(refEntity_0.current?.state).x = 0\r\n      Object(refEntity_0.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_1.current?.state).x === 0) {\r\n      Object(refEntity_1.current?.state).x = 0\r\n      Object(refEntity_1.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_2.current?.state).x === 0) {\r\n      Object(refEntity_2.current?.state).x = 0\r\n      Object(refEntity_2.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_3.current?.state).x === 0) {\r\n      Object(refEntity_3.current?.state).x = 0\r\n      Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_4.current?.state).x < 0) {\r\n      Object(refEntity_4.current?.state).x = 0\r\n      Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_5.current?.state).x === 0) {\r\n      Object(refEntity_5.current?.state).x = 0\r\n      Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_6.current?.state).x === 0) {\r\n      Object(refEntity_6.current?.state).x = 0\r\n      Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    }\r\n  } else if(index === 5) {\r\n    let moveIndex = 0\r\n    if(Object(refEntity_0.current?.state).x === 0) {\r\n      Object(refEntity_0.current?.state).x = 0\r\n      Object(refEntity_0.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_1.current?.state).x === 0) {\r\n      Object(refEntity_1.current?.state).x = 0\r\n      Object(refEntity_1.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_2.current?.state).x === 0) {\r\n      Object(refEntity_2.current?.state).x = 0\r\n      Object(refEntity_2.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_3.current?.state).x === 0) {\r\n      Object(refEntity_3.current?.state).x = 0\r\n      Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_4.current?.state).x === 0) {\r\n      Object(refEntity_4.current?.state).x = 0\r\n      Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_5.current?.state).x < 0) {\r\n      Object(refEntity_5.current?.state).x = 0\r\n      Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_6.current?.state).x === 0) {\r\n      Object(refEntity_6.current?.state).x = 0\r\n      Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    }\r\n  } else if(index === 6) {\r\n    let moveIndex = 0\r\n    if(Object(refEntity_0.current?.state).x === 0) {\r\n      Object(refEntity_0.current?.state).x = 0\r\n      Object(refEntity_0.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_1.current?.state).x === 0) {\r\n      Object(refEntity_1.current?.state).x = 0\r\n      Object(refEntity_1.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_2.current?.state).x === 0) {\r\n      Object(refEntity_2.current?.state).x = 0\r\n      Object(refEntity_2.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_3.current?.state).x === 0) {\r\n      Object(refEntity_3.current?.state).x = 0\r\n      Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_4.current?.state).x === 0) {\r\n      Object(refEntity_4.current?.state).x = 0\r\n      Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_5.current?.state).x === 0) {\r\n      Object(refEntity_5.current?.state).x = 0\r\n      Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_6.current?.state).x < 0) {\r\n      Object(refEntity_6.current?.state).x = 0\r\n      Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    }\r\n  }\r\n  _menuPos = -2\r\n  setPosition({x:0, y:0})\r\n  setActiveTabIndex(-1)\r\n  setMenuType(_type)\r\n}\r\n//////////////////////////////////////////\r\nlet clicks:any = [];\r\nlet timeout:any;\r\n// Single & Double Click\r\nfunction singleClick(event:any, tabType:string, tabURL:string, tabIndex:number) {\r\n  //alert(tabType);\r\n  if((position.x < 0 || position.x > 0) && activeTabIndex === tabIndex) {return}\r\n    press = true;\r\n    if(able === true) {\r\n      if(menuType === tabType) {\r\n        setAble(false)\r\n      }\r\n    } else\r\n    if(able === false) {\r\n      setAble(true)\r\n    }\r\n    setMenuType(tabType)\r\n    setActiveTabIndex(tabIndex)\r\n}\r\n\r\nfunction doubleClick(event:any, tabType:string, tabURL:string, tabIndex:number) {\r\n  //alert(tabType);\r\n  if(tabIndex === 0 && (tabType === 'chat' || tabType === 'content')) {\r\n    if(Object(refEntity_0.current?.state).x < 0 || Object(refEntity_0.current?.state).x > 0) {return}\r\n    Object(refEntity_0.current?.state).x = -Math.floor(Math.random() * (stores.map.screenSize[0] - 500 + 1) + 500) //Math.random() * -(stores.map.screenSize[0])\r\n    Object(refEntity_0.current?.state).y = Math.floor(Math.random() * (150 - 50 + 1) + 50) + (tabIndex * -25)\r\n  } else if(tabIndex === 1 && (tabType === 'chat' || tabType === 'content')) {\r\n    if(Object(refEntity_1.current?.state).x < 0 || Object(refEntity_1.current?.state).x > 0) {return}\r\n    Object(refEntity_1.current?.state).x = -Math.floor(Math.random() * (stores.map.screenSize[0] - 500 + 1) + 500) //Math.random() * -(stores.map.screenSize[0])\r\n    Object(refEntity_1.current?.state).y = Math.floor(Math.random() * (150 - 50 + 1) + 50) + (tabIndex * -25)\r\n  } else if(tabIndex === 2 && (tabType === 'chat' || tabType === 'content')) {\r\n    if(Object(refEntity_2.current?.state).x < 0 || Object(refEntity_2.current?.state).x > 0) {return}\r\n    Object(refEntity_2.current?.state).x = -Math.floor(Math.random() * (stores.map.screenSize[0] - 500 + 1) + 500) //Math.random() * -(stores.map.screenSize[0])\r\n    Object(refEntity_2.current?.state).y = Math.floor(Math.random() * (150 - 50 + 1) + 50) + (tabIndex * -25)\r\n  } else if(tabIndex === 3 && (tabType === 'chat' || tabType === 'content')) {\r\n    if(Object(refEntity_3.current?.state).x < 0 || Object(refEntity_3.current?.state).x > 0) {return}\r\n    Object(refEntity_3.current?.state).x = -Math.floor(Math.random() * (stores.map.screenSize[0] - 500 + 1) + 500) //Math.random() * -(stores.map.screenSize[0] + 400)/2\r\n    Object(refEntity_3.current?.state).y = Math.floor(Math.random() * (150 - 50 + 1) + 50) + (tabIndex * -25)\r\n  } else if(tabIndex === 4 && (tabType === 'chat' || tabType === 'content')) {\r\n    if(Object(refEntity_4.current?.state).x < 0 || Object(refEntity_4.current?.state).x > 0) {return}\r\n    Object(refEntity_4.current?.state).x = -Math.floor(Math.random() * (stores.map.screenSize[0] - 500 + 1) + 500) //Math.random() * -(stores.map.screenSize[0] + 400)/2\r\n    Object(refEntity_4.current?.state).y = Math.floor(Math.random() * (150 - 50 + 1) + 50) + (tabIndex * -25)\r\n  } else if(tabIndex === 5 && (tabType === 'chat' || tabType === 'content')) {\r\n    if(Object(refEntity_5.current?.state).x < 0 || Object(refEntity_5.current?.state).x > 0) {return}\r\n    Object(refEntity_5.current?.state).x = -Math.floor(Math.random() * (stores.map.screenSize[0] - 500 + 1) + 500) //Math.random() * -(stores.map.screenSize[0] + 400)/2\r\n    Object(refEntity_5.current?.state).y = Math.floor(Math.random() * (150 - 50 + 1) + 50) + (tabIndex * -25) //(120)\r\n  } else if(tabIndex === 6 && (tabType === 'chat' || tabType === 'content')) {\r\n    if(Object(refEntity_6.current?.state).x < 0 || Object(refEntity_6.current?.state).x > 0) {return}\r\n    Object(refEntity_6.current?.state).x = -Math.floor(Math.random() * (stores.map.screenSize[0] - 500 + 1) + 500) //Math.random() * -(stores.map.screenSize[0] + 400)/2\r\n    Object(refEntity_6.current?.state).y = Math.floor(Math.random() * (150 - 50 + 1) + 50) + (tabIndex * -25)\r\n  } else {\r\n    if(tabIndex === 0) {\r\n      if(Object(refEntity_0.current?.state).x < 0 || Object(refEntity_0.current?.state).x > 0) {return}\r\n      Object(refEntity_0.current?.state).x = -99999999\r\n    } else if(tabIndex === 1) {\r\n      if(Object(refEntity_1.current?.state).x < 0 || Object(refEntity_1.current?.state).x > 0) {return}\r\n      Object(refEntity_1.current?.state).x = -99999999\r\n    } else if(tabIndex === 2) {\r\n      if(Object(refEntity_2.current?.state).x < 0 || Object(refEntity_2.current?.state).x > 0) {return}\r\n      Object(refEntity_2.current?.state).x = -99999999\r\n    } else if(tabIndex === 3) {\r\n      if(Object(refEntity_3.current?.state).x < 0 || Object(refEntity_3.current?.state).x > 0) {return}\r\n      Object(refEntity_3.current?.state).x = -99999999\r\n    } else if(tabIndex === 4) {\r\n      if(Object(refEntity_4.current?.state).x < 0 || Object(refEntity_4.current?.state).x > 0) {return}\r\n      Object(refEntity_4.current?.state).x = -99999999\r\n    } else if(tabIndex === 5) {\r\n      if(Object(refEntity_5.current?.state).x < 0 || Object(refEntity_5.current?.state).x > 0) {return}\r\n      Object(refEntity_5.current?.state).x = -99999999\r\n    } else if(tabIndex === 6) {\r\n      if(Object(refEntity_6.current?.state).x < 0 || Object(refEntity_6.current?.state).x > 0) {return}\r\n      Object(refEntity_6.current?.state).x = -99999999\r\n    }\r\n\r\n    ///////////////////////////////////////////////////////\r\n    //window.open(_url, \"_new\")\r\n    let externalWindow = window.open(tabURL, '', 'width=400,height=650,left=500,top=100');\r\n    var timer = setInterval(function() {\r\n      if(externalWindow?.closed) {\r\n          clearInterval(timer);\r\n          //alert(_index);\r\n          //////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n          //CheckAndSetPosition(_index)\r\n          if(tabIndex === 0) {\r\n            let moveIndex = 0\r\n            if(Object(refEntity_0.current?.state).x < 0 || Object(refEntity_0.current?.state).x > 0) {\r\n              Object(refEntity_0.current?.state).x = 0\r\n              Object(refEntity_0.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_1.current?.state).x === 0) {\r\n              Object(refEntity_1.current?.state).x = 0\r\n              Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_2.current?.state).x === 0) {\r\n              Object(refEntity_2.current?.state).x = 0\r\n              Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_3.current?.state).x === 0) {\r\n              Object(refEntity_3.current?.state).x = 0\r\n              Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_4.current?.state).x === 0) {\r\n              Object(refEntity_4.current?.state).x = 0\r\n              Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_5.current?.state).x === 0) {\r\n              Object(refEntity_5.current?.state).x = 0\r\n              Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_6.current?.state).x === 0) {\r\n              Object(refEntity_6.current?.state).x = 0\r\n              Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            }\r\n          } else if(tabIndex === 1) {\r\n            let moveIndex = 0\r\n            if(Object(refEntity_0.current?.state).x === 0) {\r\n              Object(refEntity_0.current?.state).x = 0\r\n              Object(refEntity_0.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_1.current?.state).x < 0 || Object(refEntity_1.current?.state).x > 0) {\r\n              Object(refEntity_1.current?.state).x = 0\r\n              Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_2.current?.state).x === 0) {\r\n              Object(refEntity_2.current?.state).x = 0\r\n              Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_3.current?.state).x === 0) {\r\n              Object(refEntity_3.current?.state).x = 0\r\n              Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_4.current?.state).x === 0) {\r\n              Object(refEntity_4.current?.state).x = 0\r\n              Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_5.current?.state).x === 0) {\r\n              Object(refEntity_5.current?.state).x = 0\r\n              Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_6.current?.state).x === 0) {\r\n              Object(refEntity_6.current?.state).x = 0\r\n              Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            }\r\n          } else if(tabIndex === 2) {\r\n            let moveIndex = 0\r\n            if(Object(refEntity_0.current?.state).x === 0) {\r\n              Object(refEntity_0.current?.state).x = 0\r\n              Object(refEntity_0.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_1.current?.state).x === 0) {\r\n              Object(refEntity_1.current?.state).x = 0\r\n              Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_2.current?.state).x < 0 || Object(refEntity_2.current?.state).x > 0) {\r\n              Object(refEntity_2.current?.state).x = 0\r\n              Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_3.current?.state).x === 0) {\r\n              Object(refEntity_3.current?.state).x = 0\r\n              Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_4.current?.state).x === 0) {\r\n              Object(refEntity_4.current?.state).x = 0\r\n              Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_5.current?.state).x === 0) {\r\n              Object(refEntity_5.current?.state).x = 0\r\n              Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_6.current?.state).x === 0) {\r\n              Object(refEntity_6.current?.state).x = 0\r\n              Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            }\r\n          } else if(tabIndex === 3) {\r\n            let moveIndex = 0\r\n            if(Object(refEntity_0.current?.state).x === 0) {\r\n              Object(refEntity_0.current?.state).x = 0\r\n              Object(refEntity_0.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_1.current?.state).x === 0) {\r\n              Object(refEntity_1.current?.state).x = 0\r\n              Object(refEntity_1.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_2.current?.state).x === 0) {\r\n              Object(refEntity_2.current?.state).x = 0\r\n              Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_3.current?.state).x < 0 || Object(refEntity_3.current?.state).x > 0) {\r\n              Object(refEntity_3.current?.state).x = 0\r\n              Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_4.current?.state).x === 0) {\r\n              Object(refEntity_4.current?.state).x = 0\r\n              Object(refEntity_4.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_5.current?.state).x === 0) {\r\n              Object(refEntity_5.current?.state).x = 0\r\n              Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_6.current?.state).x === 0) {\r\n              Object(refEntity_6.current?.state).x = 0\r\n              Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            }\r\n          } else if(tabIndex === 4) {\r\n            let moveIndex = 0\r\n            if(Object(refEntity_0.current?.state).x === 0) {\r\n              Object(refEntity_0.current?.state).x = 0\r\n              Object(refEntity_0.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_1.current?.state).x === 0) {\r\n              Object(refEntity_1.current?.state).x = 0\r\n              Object(refEntity_1.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_2.current?.state).x === 0) {\r\n              Object(refEntity_2.current?.state).x = 0\r\n              Object(refEntity_2.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_3.current?.state).x === 0) {\r\n              Object(refEntity_3.current?.state).x = 0\r\n              Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_4.current?.state).x < 0 || Object(refEntity_4.current?.state).x > 0) {\r\n              Object(refEntity_4.current?.state).x = 0\r\n              Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_5.current?.state).x === 0) {\r\n              Object(refEntity_5.current?.state).x = 0\r\n              Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_6.current?.state).x === 0) {\r\n              Object(refEntity_6.current?.state).x = 0\r\n              Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            }\r\n          } else if(tabIndex === 5) {\r\n            let moveIndex = 0\r\n            if(Object(refEntity_0.current?.state).x === 0) {\r\n              Object(refEntity_0.current?.state).x = 0\r\n              Object(refEntity_0.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_1.current?.state).x === 0) {\r\n              Object(refEntity_1.current?.state).x = 0\r\n              Object(refEntity_1.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_2.current?.state).x === 0) {\r\n              Object(refEntity_2.current?.state).x = 0\r\n              Object(refEntity_2.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_3.current?.state).x === 0) {\r\n              Object(refEntity_3.current?.state).x = 0\r\n              Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_4.current?.state).x === 0) {\r\n              Object(refEntity_4.current?.state).x = 0\r\n              Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_5.current?.state).x < 0  || Object(refEntity_5.current?.state).x > 0) {\r\n              Object(refEntity_5.current?.state).x = 0\r\n              Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_6.current?.state).x === 0) {\r\n              Object(refEntity_6.current?.state).x = 0\r\n              Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            }\r\n          } else if(tabIndex === 6) {\r\n            let moveIndex = 0\r\n            if(Object(refEntity_0.current?.state).x === 0) {\r\n              Object(refEntity_0.current?.state).x = 0\r\n              Object(refEntity_0.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_1.current?.state).x === 0) {\r\n              Object(refEntity_1.current?.state).x = 0\r\n              Object(refEntity_1.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_2.current?.state).x === 0) {\r\n              Object(refEntity_2.current?.state).x = 0\r\n              Object(refEntity_2.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_3.current?.state).x === 0) {\r\n              Object(refEntity_3.current?.state).x = 0\r\n              Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_4.current?.state).x === 0) {\r\n              Object(refEntity_4.current?.state).x = 0\r\n              Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_5.current?.state).x === 0) {\r\n              Object(refEntity_5.current?.state).x = 0\r\n              Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_6.current?.state).x < 0  || Object(refEntity_5.current?.state).x > 0) {\r\n              Object(refEntity_6.current?.state).x = 0\r\n              Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            }\r\n          }\r\n          //////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n          _menuPos = -2\r\n          setPosition({x:0, y:0})\r\n          setMenuType(tabType)\r\n      }\r\n  }, 100);\r\n    ///////////////////////////////////////////////////////\r\n    //_menuPos = -2\r\n    //setAble(false)\r\n  }\r\n\r\n  //_menuPos = -(stores.map.screenSize[0]/2)\r\n  CheckAndSetPosition(tabIndex)\r\n\r\n  // When double click\r\n  CheckAndActivateMenu(tabIndex)\r\n\r\n  setActiveTabIndex(tabIndex)\r\n\r\n  // Enable When needed\r\n  setAble(false)\r\n}\r\n\r\nfunction onTabMenuClick(event:any, _type:string, _url:string, _index:number) {\r\n  event.preventDefault();\r\n  clicks.push(new Date().getTime());\r\n  window.clearTimeout(timeout);\r\n  timeout = window.setTimeout(() => {\r\n      if (clicks.length > 1 && clicks[clicks.length - 1] - clicks[clicks.length - 2] < 250) {\r\n          doubleClick(event.target, _type, _url, _index);\r\n      } else {\r\n          singleClick(event.target, _type, _url, _index);\r\n      }\r\n  }, 250);\r\n}\r\n\r\n  //////////////////////////////////////////////////////////////////////////////////\r\n\r\n  return <Observer>{()=>{\r\n    return <div ref={refDiv} className={classes.back} style={{backgroundColor: '#0f5c81'/* rgb2Color(roomInfo.backgroundFill) */}}>\r\n        {/* <SplitPane className={classes.fill} split=\"vertical\" resizerClassName={clsSplit.resizerVertical}\r\n          minSize={0} defaultSize=\"7em\"> */}\r\n          <SplitPane pane2Style={able === true ? {display: 'block', backgroundColor: menuType === 'chat' ? '#0f5c81' : menuType === 'content' ? '#8b5e3c' : menuType !== 'blank' ? activeBgColor : 'white'\r\n/* '#5f7ca020' */, boxShadow: menuType !== 'blank' ? '5px 10px 10px 3px black' : '5px 10px 10px 3px white'} : {display: 'none', backgroundColor: '#FFF'}} className={classes.fill} split=\"vertical\" /* resizerClassName={clsSplit.resizerVertical} */\r\n  minSize={0} defaultSize={able === true ? isSmartphone() ? '40%' : (_menuType !== 'chat' && _menuType !== 'content') ? \"73%\" : '73%'/* \"77%\" *//* \"85%\" */ : \"100%\"}>\r\n          {/* <LeftBar stores={stores}/> */}\r\n          <Fragment>\r\n            <MainScreen showAllTracks = {DEBUG_VIDEO} stores={stores} />\r\n            <Observer>{() => <Map transparent={sharedContentsStore.mainScreenStream !== undefined\r\n             || DEBUG_VIDEO} stores={stores} />\r\n            }</Observer>\r\n\r\n\r\n            {/* /////////////////////////////////SEPARATE BLOCK/////////////////////////////////// */}\r\n             {/* <div  style={{position:'absolute', right:able ? '0%' : '0%', top:'0px', borderRadius: '5px', display:'flex'}}\r\n              onClick={() => {\r\n                press = true;\r\n                if(able === true) {\r\n                  if(_menuType === 'chat') {\r\n                    setAble(false)\r\n                  }\r\n                } else\r\n                if(able === false) {\r\n                  setAble(true)\r\n                }\r\n                setMenuType('chat')\r\n               }}\r\n             >\r\n               <img src={tabCollapseChat} style={{width:isSmartphone() ? 120 : 50, height:'auto', position:'relative', top:'0px', left:isSmartphone() ? '1px' : '1px', userSelect:'none', zIndex:showIntro ? 0 : menuType === 'chat' ? 19 : 18}} draggable={false} alt='' />\r\n                <img src={able ? tabChatActive : tabChat} style={{width:isSmartphone() ? 120 : 50, height:isSmartphone() ? 120 : 50, color:'white', position:'absolute', top:'2px', left:isSmartphone() ? '10px' : '5px', userSelect:'none', zIndex:showIntro ? 0 : 99}} draggable={false} alt='' />\r\n             </div> */}\r\n\r\n\r\n             {/* <div  style={{position:'absolute', right:able ? '0%' : '0%', top:'0px', borderRadius: '5px', display:'flex'}}\r\n              onClick={() => {\r\n                press = true;\r\n                if(able === true) {\r\n                  if(menuType === 'content') {\r\n                    setAble(false)\r\n                  }\r\n                } else\r\n                if(able === false) {\r\n                  setAble(true)\r\n                }\r\n                setMenuType('content')\r\n               }}\r\n             >\r\n              <img src={tabCollapseContent} style={{width:isSmartphone() ? 120 : 50, height:'auto', position:'relative', top:isSmartphone() ? '119px' : '49px', left:isSmartphone() ? '1px' : '1px', userSelect:'none', zIndex:showIntro ? 0 : menuType === 'content' ? 19 : 17}} draggable={false} alt='' />\r\n              <img src={able ? tabContentActive : tabContent} style={{width:isSmartphone() ? 120 : 50, height:isSmartphone() ? 120 : 50, color:'white', position:'absolute', top:isSmartphone() ? '122px' : '52px', left:isSmartphone() ? '10px' : '5px', userSelect:'none', zIndex:showIntro ? 0 : 98}} draggable={false} alt='' />\r\n             </div> */}\r\n\r\n            {/* /////////////////////////////////CHAT APP/////////////////////////////////// */}\r\n\r\n            <Draggable /* bounds={{top: (0 * -51), left: -(stores.map.screenSize[0] - 40), right: -40, bottom: (stores.map.screenSize[1] - (50 + (0 * 51)))}} */ ref={refEntity_0} key={0} onDrag={(e, data) => trackPos(data, 0, 'chat')} onStop={(e, data) => setTrack(data, '', 0)} defaultPosition={{x: 0, y: 0}}>\r\n\r\n            <div style={{position:'absolute', right:able ? '0%' : '0%', top:isSmartphone() ? tabBGTopBGMob + (0 * 119) : tabBGTopBGWeb + (0*51), borderRadius: '5px', display:'flex', zIndex:showIntro ? 0 : menuType === 'chat' ? 19 : (activeTabIndex === 0) ? 19 : (18 - (0+2)), height:'100%'}}>\r\n            <div  style={{position:'absolute', right:able ? '0%' : '0%', top:'0px', borderRadius: '5px', display:'flex', zIndex:showIntro ? 0 : menuType === 'chat' ? 19 : (18 - (0+2))}}\r\n            ////////////////////////////////////////////////////////////////////\r\n              onClick={(e) => {\r\n                // handling single & double click\r\n                onTabMenuClick(e, 'chat', '', 0)\r\n              }}\r\n              onTouchEnd={(e) => {\r\n                onTabMenuClick(e, 'chat', '', 0)\r\n              }}\r\n              >\r\n\r\n                <img src={tabCollapseChat} style={{width:isSmartphone() ? 120 : 50, height:'auto', position:'relative', top:'0px', left:isSmartphone() ? '1px' : '1px', userSelect:'none', zIndex:showIntro ? 0 : menuType === 'chat' ? 19 : (18 - (0+2))}} draggable={false} alt='' />\r\n                <img src={tabChatActive} style={{width:isSmartphone() ? 120 : 50, height:isSmartphone() ? 120 : 50, color:'white', position:'absolute', top:'2px', left:isSmartphone() ? '10px' : '5px' , userSelect:'none', zIndex:showIntro ? 0 : 99}} draggable={false} alt='' />\r\n              </div>\r\n\r\n              <div style={{position: 'absolute', width:'405px', height:'70%', left:'0px'/* , top:'0px' */, backgroundColor:'#0f5c81', borderRadius:'2px', minWidth:'280px', top:'0px',\r\n              display:((Object(refEntity_0.current?.state).x < 0 || Object(refEntity_0.current?.state).x > 0)) ? 'block' : 'none' , zIndex:-9999}}>\r\n              <CloseTabIcon style={{width:'40px', height:'50px', position:'absolute', right:'25px', color:'white', padding:isSmartphone() ? '10px' : '1px', transform:isSmartphone() ? 'scale(2)' : 'scale(1)', zIndex:9999}}\r\n                onClick={() => {\r\n                  ResetAppsPanel(0, 'chat')\r\n                }}\r\n                onTouchEnd={() => {\r\n                  ResetAppsPanel(0, 'chat')\r\n                }}\r\n              />\r\n                <LeftBar stores={stores} type={'chat'}/>\r\n              </div>\r\n              </div>\r\n            </Draggable>\r\n\r\n             {/* /////////////////////////////////CONTENT APP////////////////////////////////// */}\r\n\r\n             <Draggable /* bounds={{top: (1 * -51), left: -(stores.map.screenSize[0] - 40), right: -40, bottom: (stores.map.screenSize[1] - (50 + (1 * 51)))}} */ ref={refEntity_1} key={1} onDrag={(e, data) => trackPos(data, 1, 'content')} onStop={(e, data) => setTrack(data, '', 1)} defaultPosition={{x: 0, y: 0}}>\r\n\r\n            <div style={{position:'absolute', right:able ? '0%' : '0%', top:isSmartphone() ? tabBGTopBGMob + (1 * 119) : tabBGTopBGWeb + (1*51), borderRadius: '5px', display:'flex', zIndex:showIntro ? 0 : menuType === 'content' ? 19 : (activeTabIndex === 1) ? 19 : (18 - (1+2)), height:'100%'}}>\r\n            <div  style={{position:'absolute', right:able ? '0%' : '0%', top:'0px', borderRadius: '5px', display:'flex', zIndex:showIntro ? 0 : menuType === 'content' ? 19 : (18 - (1+2))}}\r\n              onClick={(e) => {\r\n                // handling single & double click\r\n                onTabMenuClick(e, 'content', '', 1)\r\n              }}\r\n              onTouchEnd={(e) => {\r\n                onTabMenuClick(e, 'content', '', 1)\r\n              }}\r\n              >\r\n\r\n                <img src={tabCollapseContent} style={{width:isSmartphone() ? 120 : 50, height:'auto', position:'relative', top:'0px', left:isSmartphone() ? '1px' : '1px', userSelect:'none', zIndex:showIntro ? 0 : menuType === 'content' ? 19 : (18 - (1+2))}} draggable={false} alt='' />\r\n                <img src={tabContentActive} style={{width:isSmartphone() ? 120 : 50, height:isSmartphone() ? 120 : 50, color:'white', position:'absolute', top:'2px', left:isSmartphone() ? '10px' : '5px' , userSelect:'none', zIndex:showIntro ? 0 : 99}} draggable={false} alt='' />\r\n              </div>\r\n\r\n              <div style={{position: 'absolute', width:'405px', height:'70%', left:'0px'/* , top:'0px' */, backgroundColor:'#8b5e3c', borderRadius:'2px', minWidth:'280px', top:'0px',\r\n              display:((Object(refEntity_1.current?.state).x < 0 || Object(refEntity_1.current?.state).x > 0)) ? 'block' : 'none' , zIndex:-9999}}>\r\n              <CloseTabIcon style={{width:'40px', height:'50px', position:'absolute', right:'25px', color:'white', padding:isSmartphone() ? '10px' : '1px', transform:isSmartphone() ? 'scale(2)' : 'scale(1)', zIndex:9999}}\r\n                onClick={() => {\r\n                  ResetAppsPanel(1, 'content')\r\n                }}\r\n                onTouchEnd={() => {\r\n                  ResetAppsPanel(1, 'content')\r\n                }}\r\n              />\r\n                <LeftBar stores={stores} type={'content'}/>\r\n              </div>\r\n              </div>\r\n            </Draggable>\r\n              {/* /////////////////////////////////////////////////////////////////// */}\r\n\r\n\r\n\r\n             {/* <div  style={{position:'absolute', right:able ? '0%' : '0%', top:'0px', borderRadius: '5px', display:'flex'}}\r\n              onClick={() => {\r\n                press = true;\r\n                if(able === true) {\r\n                  if(menuType === 'events') {\r\n                    setAble(false)\r\n                  }\r\n                } else\r\n                if(able === false) {\r\n                  setAble(true)\r\n                }\r\n                setMenuType('events')\r\n               }}\r\n             >\r\n              <img src={tabCollapseEvents} style={{width:isSmartphone() ? 120 : 50, height:'auto', position:'relative', top:isSmartphone() ? '238px' : '100px', left:isSmartphone() ? '1px' : '0px', userSelect:'none', zIndex:showIntro ? 0 : menuType === 'events' ? 9 : 7}} draggable={false} alt='' />\r\n              <img src={able ? tabEventsActive : tabEvents} style={{width:isSmartphone() ? 120 : 50, height:isSmartphone() ? 120 : 50, color:'white', position:'absolute', top:isSmartphone() ? '241px' : '102px', left:isSmartphone() ? '10px' : '5px' , userSelect:'none', zIndex:showIntro ? 0 : 99}} draggable={false} alt='' />\r\n             </div> */}\r\n             {/* console.log(activeTabIndex, \" TAB active\") */}\r\n             <>\r\n            { cContent.filter(item => item.shareType === \"appimg\").map((content, index) => (\r\n              <Draggable/*  bounds={{ top: -2500, left: -2500, right: 0, bottom: 2500 }} */ bounds={content.url === '' ? {top: ((index+2) * -51), left: -(stores.map.screenSize[0] - 40), right: -40, bottom: (stores.map.screenSize[1] - (50 + ((index+2) * 51)))} : {}}\r\n\r\n              ref={(index+2) === 2 ? refEntity_2 : index === 3 ? refEntity_3 : index === 4 ? refEntity_4 : index === 5 ? refEntity_5 : index === 6 ? refEntity_6 : index === 7 ? refEntity_7 : refEntity_8}\r\n\r\n              key={(index+2)} onDrag={(e, data) => trackPos(data, (index+2), content.type)} onStop={(e, data) => setTrack(data, content.url, (index+2))} /* disabled={able ? true : false} */ defaultPosition={{x: 0, y: 0}}>\r\n\r\n                <div style={{position:'absolute', right:able ? '0%' : '0%', top:isSmartphone() ? tabBGTopBGMob + ((index+2) * 119) : tabBGTopBGWeb + ((index+2)*51), borderRadius: '5px', display:'flex', zIndex:showIntro ? 0 : menuType === content.type ? 19 : (activeTabIndex === (index+2)) ? 19 : (18 - ((index+2)+2)), height:'100%'}}>\r\n                <div  style={{position:'absolute', right:able ? '0%' : '0%', top:'0px', borderRadius: '5px', display:'flex', zIndex:showIntro ? 0 : menuType === content.type ? 19 : (18 - ((index+2)+2))}}\r\n                ////////////////////////////////////////////////////////////////////\r\n                  onClick={(e) => {\r\n\r\n                    // handling single & double click\r\n                    onTabMenuClick(e, content.type, content.url, (index+2))\r\n\r\n                    /*\r\n                    //console.log(position.x, \" --- \", menuType)\r\n                    if((position.x < 0 || position.x > 0) && activeTabIndex === index) {return}\r\n                    //if(position.x < -2 && menuType === content.type) {\r\n                      //setAble(false)\r\n                      //setMenuType('')\r\n                    //} else {\r\n\r\n                      press = true;\r\n                      if(able === true) {\r\n                        if(menuType === content.type) {\r\n                          setAble(false)\r\n                        }\r\n                      } else\r\n                      if(able === false) {\r\n                        setAble(true)\r\n                      }\r\n                      setMenuType(content.type)\r\n                    //} */\r\n                  }}\r\n                  onTouchEnd={(e) => {\r\n                    onTabMenuClick(e, content.type, content.url, (index+2))\r\n                  }}\r\n                  ////////////////////////////////////////////////////////////////////\r\n                 /*  onClick={onSingleClickHandler}\r\n                  onDoubleClick={onDoubleClickHandler} */\r\n                  /* onClick={(e) => {\r\n                    if(position.x < 0 || position.x > 0) {return}\r\n                    timer = window.setTimeout(() => {\r\n                      if (!prevent) {\r\n                        //console.log(\"single click\")\r\n                        press = true;\r\n                        if(able === true) {\r\n                          if(menuType === content.type) {\r\n                            setAble(false)\r\n                          }\r\n                        } else\r\n                        if(able === false) {\r\n                          setAble(true)\r\n                        }\r\n                        setMenuType(content.type)\r\n                      }\r\n                    }, delay);\r\n                  }}\r\n                  onDoubleClick={(e) => {\r\n                    clearTimeout(timer);\r\n                    prevent = true;\r\n                    setTimeout(() => {\r\n                      prevent = false;\r\n                      //console.log(\"double click\")\r\n                      //setTrack(data, content.url, index)\r\n                      //console.log(data, \" --- \", index)\r\n                      setDefaultTrack(content.url, index)\r\n                    }, delay);\r\n                  }} */\r\n                >\r\n                  <img src={content.baseImage} style={{width:isSmartphone() ? 120 : 50, height:'auto', position:'relative', top:'0px'/* isSmartphone() ? tabBGTopBGMob + (index * 119) : tabBGTopBGWeb + (index*51) */, left:isSmartphone() ? '1px' : '1px', userSelect:'none', zIndex:showIntro ? 0 : menuType === content.type ? 19 : (18 - ((index+2)+2))}} draggable={false} alt='' />\r\n                  <img src={content.baseIcon} style={{width:isSmartphone() ? 120 : 50, height:isSmartphone() ? 120 : 50, color:'white', position:'absolute', top:'2px'/* isSmartphone() ? tabBGTopIconMob + (index * 119) : tabBGTopIconWeb + (index*51) */, left:isSmartphone() ? '10px' : '5px' , userSelect:'none', zIndex:showIntro ? 0 : 99}} draggable={false} alt='' />\r\n                </div>\r\n\r\n                <div style={{position: 'absolute', width:'405px', height:'70%', left:'0px'/* , top:'0px' */, backgroundColor:content.baseColor, borderRadius:'2px', minWidth:'280px', top:'0px'/* isSmartphone() ? tabBGTopBGMob + (index * 119) : tabBGTopBGWeb + (index*51) */,\r\n\r\n                display:((Object(refEntity_2.current?.state).x < 0 || Object(refEntity_2.current?.state).x > 0) && (index+2) === 2) ? 'block' : ((Object(refEntity_3.current?.state).x < 0 || Object(refEntity_3.current?.state).x > 0) && (index+2) === 3) ? 'block' : ((Object(refEntity_4.current?.state).x < 0 || Object(refEntity_4.current?.state).x > 0) && (index+2) === 4) ? 'block' : ((Object(refEntity_5.current?.state).x < 0 || Object(refEntity_5.current?.state).x > 0) && (index+2) === 5) ? 'block' : ((Object(refEntity_6.current?.state).x < 0 || Object(refEntity_6.current?.state).x > 0) && (index+2) === 6) ? 'block' : 'none'\r\n\r\n                /* Object(refEntity_5.current?.state).x < 0 ? 'block' : Object(refEntity_6.current?.state).x < ? 'block' : Object(refEntity_7.current?.state).x < 0 ? 'block' : Object(refEntity_8.current?.state).x < 0 ? 'block' : 'none' */, zIndex:-9999}}>\r\n                <CloseTabIcon style={{width:'40px', height:'50px', position:'absolute', right:'25px', color:'white', padding:isSmartphone() ? '10px' : '1px', transform:isSmartphone() ? 'scale(2)' : 'scale(1)', zIndex:9999}}\r\n                  onClick={() => {\r\n                    //console.log(\"Close Tab click\")\r\n                    //console.log(Object(refEntity.current?.state).x)\r\n                    ResetAppsPanel((index+2), content.type)\r\n                  }}\r\n                  onTouchEnd={() => {\r\n                    //console.log(\"Close Tab click\")\r\n                    //console.log(Object(refEntity.current?.state).x)\r\n                    ResetAppsPanel((index+2), content.type)\r\n                    /* if(index === 0) {\r\n                      let moveIndex = 0\r\n                      if(Object(refEntity_0.current?.state).x < 0) {\r\n                        Object(refEntity_0.current?.state).x = 0\r\n                        Object(refEntity_0.current?.state).y = (0)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n                      if(Object(refEntity_1.current?.state).x === 0) {\r\n                        Object(refEntity_1.current?.state).x = 0\r\n                        Object(refEntity_1.current?.state).y = (moveIndex * 51)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n\r\n                      if(Object(refEntity_2.current?.state).x === 0) {\r\n                        Object(refEntity_2.current?.state).x = 0\r\n                        Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n\r\n                      if(Object(refEntity_3.current?.state).x === 0) {\r\n                        Object(refEntity_3.current?.state).x = 0\r\n                        Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n\r\n                      if(Object(refEntity_4.current?.state).x === 0) {\r\n                        Object(refEntity_4.current?.state).x = 0\r\n                        Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n                      }\r\n                    } else if(index === 1) {\r\n                      let moveIndex = 0\r\n                      if(Object(refEntity_0.current?.state).x === 0) {\r\n                        Object(refEntity_0.current?.state).x = 0\r\n                        Object(refEntity_0.current?.state).y = (0)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n                      if(Object(refEntity_1.current?.state).x < 0) {\r\n                        Object(refEntity_1.current?.state).x = 0\r\n                        Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n\r\n                      if(Object(refEntity_2.current?.state).x === 0) {\r\n                        Object(refEntity_2.current?.state).x = 0\r\n                        Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n\r\n                      if(Object(refEntity_3.current?.state).x === 0) {\r\n                        Object(refEntity_3.current?.state).x = 0\r\n                        Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n                      if(Object(refEntity_4.current?.state).x === 0) {\r\n                        Object(refEntity_4.current?.state).x = 0\r\n                        Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n                      }\r\n                    } else if(index === 2) {\r\n                      let moveIndex = 0\r\n                      if(Object(refEntity_0.current?.state).x === 0) {\r\n                        Object(refEntity_0.current?.state).x = 0\r\n                        Object(refEntity_0.current?.state).y = (0)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n                      if(Object(refEntity_1.current?.state).x === 0) {\r\n                        Object(refEntity_1.current?.state).x = 0\r\n                        Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n\r\n                      if(Object(refEntity_2.current?.state).x < 0) {\r\n                        Object(refEntity_2.current?.state).x = 0\r\n                        Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n\r\n                      if(Object(refEntity_3.current?.state).x === 0) {\r\n                        Object(refEntity_3.current?.state).x = 0\r\n                        Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n                      if(Object(refEntity_4.current?.state).x === 0) {\r\n                        Object(refEntity_4.current?.state).x = 0\r\n                        Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n                      }\r\n                    } else if(index === 3) {\r\n                      let moveIndex = 0\r\n                      if(Object(refEntity_0.current?.state).x === 0) {\r\n                        Object(refEntity_0.current?.state).x = 0\r\n                        Object(refEntity_0.current?.state).y = (0)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n                      if(Object(refEntity_1.current?.state).x === 0) {\r\n                        Object(refEntity_1.current?.state).x = 0\r\n                        Object(refEntity_1.current?.state).y = (0)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n\r\n                      if(Object(refEntity_2.current?.state).x === 0) {\r\n                        Object(refEntity_2.current?.state).x = 0\r\n                        Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n\r\n                      if(Object(refEntity_3.current?.state).x < 0) {\r\n                        Object(refEntity_3.current?.state).x = 0\r\n                        Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n                      if(Object(refEntity_4.current?.state).x === 0) {\r\n                        Object(refEntity_4.current?.state).x = 0\r\n                        Object(refEntity_4.current?.state).y = (0)\r\n                      }\r\n                    } else if(index === 4) {\r\n                      let moveIndex = 0\r\n                      if(Object(refEntity_0.current?.state).x === 0) {\r\n                        Object(refEntity_0.current?.state).x = 0\r\n                        Object(refEntity_0.current?.state).y = (0)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n                      if(Object(refEntity_1.current?.state).x === 0) {\r\n                        Object(refEntity_1.current?.state).x = 0\r\n                        Object(refEntity_1.current?.state).y = (0)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n\r\n                      if(Object(refEntity_2.current?.state).x === 0) {\r\n                        Object(refEntity_2.current?.state).x = 0\r\n                        Object(refEntity_2.current?.state).y = (0)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n\r\n                      if(Object(refEntity_3.current?.state).x === 0) {\r\n                        Object(refEntity_3.current?.state).x = 0\r\n                        Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n                      } else {\r\n                        moveIndex = moveIndex + 1\r\n                      }\r\n                      if(Object(refEntity_4.current?.state).x < 0) {\r\n                        Object(refEntity_4.current?.state).x = 0\r\n                        Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n                      }\r\n                    }\r\n                    _menuPos = -2\r\n                    setPosition({x:0, y:0}) */\r\n                  }}\r\n                 />\r\n\r\n                 {/* {(content.type.toLowerCase() !== 'chat' || content.type.toLowerCase() !== 'content') ?\r\n                    <iframe src={content.url} title={content.type} allowTransparency={true} frameBorder={0} style={{width:'100%', height:'100%'}}></iframe>\r\n                    : <LeftBar stores={stores}/>}\r\n */}\r\n                  {}\r\n                 {/*  {content.type === 'chat' || content.type === 'content' ?\r\n                  <LeftBar stores={stores} type={content.type}/>\r\n                  :  */}<iframe src={content.url} title={content.type} allowTransparency={true} frameBorder={0} style={{width:'100%', height:'100%'}}></iframe>\r\n                 {/* } */}\r\n                </div>\r\n                </div>\r\n              </Draggable>\r\n\r\n             ))}\r\n             </>\r\n            <Footer stores={stores} height={(isSmartphone() && isPortrait()) ? 100 : undefined} />\r\n            <ZoneAvatar stores={stores} height={(isSmartphone() && isPortrait()) ? 100 : undefined} />\r\n            <Emoticons stores={stores} height={(isSmartphone() && isPortrait()) ? 100 : undefined} />\r\n          </Fragment>\r\n          <div style={{display: (able === true ? \"block\" : \"none\"), minWidth:'280px', width:'100%', maxWidth:'280px'}}>\r\n            <LeftBar stores={stores} type={_menuType}/>\r\n          </div>\r\n        </SplitPane>\r\n        <div /* onClick={StartMeeting}  */style={{width:'100%', height:'100%', alignItems:'center', justifyContent:'center', verticalAlign:'center',position:'absolute', backgroundColor: '#5f7ca0', textAlign:'center', display:showIntro ? 'block' : 'none'}}>\r\n        <p style={{textAlign:'right', color: 'white', position:'relative', right:'24.5px', top:'20px', fontSize: isSmartphone() ? '2.4rem' : '1rem', fontWeight:'normal'}}>Version 2.0.6</p>\r\n          <div style={{position:'relative', top:roomImgPath === '' ? '20%' : '0%'}}>\r\n          <p style={{textAlign:'center', color: 'white',fontSize:isSmartphone() ? '3rem' : '1.2rem', fontWeight:'normal'}}>Welcome To</p>\r\n          <p style={_roomName ? {textAlign:'center', color: 'white', marginTop:isSmartphone() ? '-2.6rem' : '-0.8rem', fontSize:isSmartphone() ? '2.8rem' : '1.2rem', fontWeight:'bold', opacity: 1, transition: 'opacity 300ms'} : {textAlign:'center', color: 'white', marginTop:isSmartphone() ? '-2.6rem' : '-0.8rem', fontSize:isSmartphone() ? '3rem' : '1.2rem', fontWeight:'bold', opacity: 0}}>{_roomName}</p>\r\n          <img src={roomImgPath} style={roomImgPath ? {height: '250px', transform: \"scale(1)\", opacity:1, transition: 'opacity 300ms, transform: 300ms', userSelect:'none'} : {height: '0px', transform: \"scale(0)\", opacity:0, transition: '0.3s ease-out', userSelect:'none'}} draggable={false} alt=\"\"/>\r\n          <p style={{textAlign:'center', color: '#cdcdcd', fontSize:isSmartphone() ? '2.8rem' : '1rem', overflow:'hidden', position:'relative', marginTop:'0.5rem', width:'80%', marginLeft:'10%', fontWeight:'normal'}}>{roomImgDesc}</p>\r\n          <img style={{width:isSmartphone() ? '8rem' : '4rem', backgroundColor:'#00000020', borderRadius: '50%', position:'relative', marginTop:roomImgPath !== '' ? '20px' : '-15px', userSelect:'none'}} src={stores.participants.local.information.avatarSrc} draggable={false} alt=\"\" />\r\n        <p style={{textAlign:'center', color: 'black', marginTop:'0.5rem', fontSize:isSmartphone() ? '3rem' : '1.2rem', fontWeight:'normal'}}>{stores.participants.local.information.name}</p>\r\n        <p style={{textAlign:'center', color: 'black', marginTop:'1.5rem',fontSize:isSmartphone() ? '3rem' : '1.2rem', fontWeight:'normal'}}>Give your web browser permissions</p>\r\n        <p style={{textAlign:'center', color: 'black', marginTop:isSmartphone() ? '-2.9rem' : '-0.9rem',fontSize:isSmartphone() ? '3rem' : '1.2rem', fontWeight:'normal'}}>to access the mic and camera if necessary.</p>\r\n        <img style={{width:isSmartphone() ? '18rem' : '8rem', position:'relative', userSelect:'none'}} src={logo_es} draggable={false} alt=\"\" />\r\n        </div>\r\n        </div>\r\n\r\n        <div ref={refAvatar} style={{position:'relative', width:'130px', height:'130px', maxWidth:'130px', zIndex:-999}}>\r\n          <div style={{position:'absolute', top:'0px', left:'0px'}}>\r\n            <img style={{display: selectedGroup !== '' ? 'block' : 'none'}} src={selectedGroup} width={'130px'} height={'130px'} draggable={false} alt='' />\r\n          </div>\r\n          <div style={{position:'absolute', top:'0px', left:'0px'}}>\r\n            <img style={{display: selectedHairBack !== '' ? 'block' : 'none'}} src={selectedHairBack} width={'130px'} height={'130px'} draggable={false} alt='' />\r\n          </div>\r\n          <div style={{position:'absolute', top:'0px', left:'0px'}}>\r\n            <img style={{display: selectedSkin !== '' ? 'block' : 'none'}} src={selectedSkin} width={'130px'} height={'130px'}  draggable={false} alt='' />\r\n          </div>\r\n          <div style={{position:'absolute', top:'0px', left:'0px'}}>\r\n            <img style={{display: selectedHair !== '' ? 'block' : 'none'}} src={selectedHair} width={'130px'} height={'130px'}  draggable={false}alt='' />\r\n          </div>\r\n          <div style={{position:'absolute', top:'-3px', left:'0px'}}>\r\n            <img style={{display: selectedOutfits !== '' ? 'block' : 'none'}} src={selectedOutfits} width={'130px'} height={'130px'} draggable={false} alt='' />\r\n          </div>\r\n          <div style={{position:'absolute', top:'0px', left:'0px'}}>\r\n            <img style={{display: selectedSpecs !== '' ? 'block' : 'none'}} src={selectedSpecs} width={'130px'} height={'130px'} draggable={false} alt='' />\r\n          </div>\r\n        </div>\r\n\r\n\r\n        {/* Showing slideshow for new user */}\r\n        <Dialog open={showHelp} onClose={() => setShowHelp(false)} onExited={() => setShowHelp(false)}\r\n        keepMounted\r\n        PaperProps={{\r\n          style: {\r\n            backgroundColor: 'white',\r\n            position:'relative',\r\n            /* boxShadow: 'none', */\r\n            overflow:'hidden',\r\n            borderRadius: '20px',\r\n            width: 300,\r\n            height: 350,\r\n            zIndex: 0,\r\n            left: '250px',\r\n            transform: isSmartphone() ? 'scale(1.5)' : 'scale(1)',\r\n          },\r\n        }}\r\n        BackdropProps={{ invisible: true }}\r\n        >\r\n        <DialogContent style={{overflow:'hidden'}}>\r\n          <div>\r\n            <div style={{position:'relative', left:'0px'}}>\r\n              <>\r\n              {\r\n                sliderData.map((slide, index) => {\r\n                  return (\r\n                    <div className={index === currentSlide ? classes.activeSlide : classes.slide} key={index}>\r\n                      {index === currentSlide && (\r\n                         <img src={slide} width={'250px'} height={'250px'} alt='' />\r\n                      )}\r\n\r\n                    </div>\r\n                  )\r\n                })\r\n              }\r\n              </>\r\n            </div>\r\n            <div style={{width:'100%', height:'1px', backgroundColor:'lightgrey', position:'relative', top:'5px'}}></div>\r\n            <div style={{display:'flex', position:'relative', top:'15px', width:'100%'}}>\r\n              <div onClick={() => onPrevClick()}>\r\n                <ArrowBackIosIcon className={classes.previous}  />\r\n              </div>\r\n              <div onClick={() => onNextClick()}>\r\n                <ArrowForwardIosIcon className={classes.next} />\r\n              </div>\r\n              <div style={{display:'flex', width:'80%', justifyContent:'center', position:'relative', top:'15px', left:'10%'}}>\r\n              {\r\n                sliderDots.map((slide, index) => {\r\n                  return (\r\n                    <div style={{position:'relative', width:'12px', height:'12px', borderRadius:'50%', backgroundColor: index === currentSlide ? 'green' : 'lightgray', alignItems:'center', margin:'3px'}} />\r\n                  )\r\n                })\r\n              }\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n      </div>\r\n  }}</Observer>\r\n}\r\nApp.displayName = 'App'\r\n\r\n\r\n\r\n\r\n\r\n/*\r\nimport {urlParameters} from '@models/url'\r\nimport {isPortrait, isSmartphone} from '@models/utils'\r\n//import { rgb2Color } from '@models/utils'\r\nimport chatStore from '@stores/Chat'\r\nimport errorInfo from '@stores/ErrorInfo'\r\nimport mapStore from '@stores/Map'\r\nimport participantsStore from '@stores/participants/Participants'\r\nimport roomInfo from '@stores/RoomInfo'\r\nimport sharedContentsStore from '@stores/sharedContents/SharedContents'\r\nimport {Observer, useObserver} from 'mobx-react-lite'\r\nimport React, {Fragment, useRef, useState, useEffect} from 'react'\r\nimport SplitPane from 'react-split-pane'\r\nimport {Footer} from './footer/Footer'\r\n//import {Emoticons} from './footer/Emoticons'\r\n//import {ZoneAvatar} from './footer/ZoneAvatar'\r\nimport {LeftBar} from './leftBar/LeftBar'\r\nimport {MainScreen} from './map/MainScreen'\r\nimport {Map} from './map/map'\r\nimport {Stores} from './utils'\r\nimport {styleCommon} from './utils/styles'\r\nimport logo_es from '@images/logo.png'\r\nimport { getLoginClick, getUserType} from './error/TheEntrance' // getRoomName\r\n\r\n// import ArrowForwardIosIcon from '@material-ui/icons/ArrowForwardIos';\r\n// import iconCollapse from '@images/earshot_icon_btn_collapse.png'\r\n////////////////////////////////////////////////////////////////////////////////////\r\nimport tabCollapseChat from '@images/earshot_icon_tab.png'\r\nimport tabCollapseContent from '@images/earshot_icon_tab_content.png'\r\n////////////////////////////////////////////////////////////////////////////////////\r\n//import tabCollapseEvents from '@images/earshot_icon_tab_events.png'\r\n\r\n////////////////////////////////////////////////////////////////////////////////////\r\n//import tabChat from '@images/earshot_icon_btn-chat.png'\r\nimport tabChatActive from '@images/earshot_icon_btn-chat.png'\r\n\r\n//import tabContent from '@images/earshot_icon_btn-note.png'\r\nimport tabContentActive from '@images/earshot_icon_btn-note.png'\r\n////////////////////////////////////////////////////////////////////////////////////\r\n\r\n//import tabEvents from '@images/earshot_icon_btn_events.png'\r\n//import tabEventsActive from '@images/earshot_icon_btn_events.png'\r\n\r\nimport ArrowBackIosIcon from '@material-ui/icons/ArrowBackIos';\r\nimport ArrowForwardIosIcon from '@material-ui/icons/ArrowForwardIos';\r\n\r\nimport CloseTabIcon from '@material-ui/icons/HighlightOff';\r\n\r\n\r\n//import { toPng } from 'html-to-image'\r\n\r\nimport html2canvas from 'html2canvas'\r\nimport { Dialog, DialogContent } from '@material-ui/core'\r\nimport Draggable from 'react-draggable'\r\nimport { Emoticons } from './footer/Emoticons'\r\n\r\n\r\n\r\n//declare const config:any             //  from ../../config.js included from index.html\r\n\r\nlet _able:Boolean = false\r\nexport function getAbleStatus():Boolean {\r\n  return _able\r\n}\r\n\r\nlet _menuType:string = ''\r\nexport function getSelectedMenuType() :string {\r\n  return _menuType\r\n}\r\n\r\nlet _menuPos:number = -2\r\nexport function getSelectedMenuPos() : number {\r\n  return _menuPos;\r\n}\r\n\r\n//let selectedImage:string = ''\r\nlet selectedGroup = ''\r\nlet selectedSkin = ''\r\nlet selectedHairColor = ''\r\nlet selectedHair = ''\r\nlet selectedHairBack = ''\r\nlet selectedOutfits = ''\r\nlet selectedSpecs = ''\r\n\r\n\r\nexport const App: React.FC<{}> = () => {\r\n  // const clsSplit = styleForSplit()\r\n  const classes = styleCommon()\r\n  const DEBUG_VIDEO = false //  To see all local and remote tracks or not.\r\n  const stores:Stores = {\r\n    map: mapStore,\r\n    participants: participantsStore,\r\n    contents: sharedContentsStore,\r\n    chat: chatStore,\r\n    roomInfo: roomInfo,\r\n  }\r\n  const refDiv = useRef<HTMLDivElement>(null)\r\n  const [able, setAble] = useState<Boolean>(false)\r\n\r\n  const [showIntro, setShowIntro] = useState<Boolean>(true)\r\n\r\n  const [menuType, setMenuType] = useState('')\r\n\r\n  //console.log(showIntro, \" showIntro\")\r\n  const [activeOutfit, setActiveOutfit] = useState(-1)\r\n  const [activeSpecs, setActiveSpecs] = useState(-1)\r\n\r\n  const [activeSkin, setActiveSkin] = useState(-1)\r\n  const [activeHair, setActiveHair] = useState(-1)\r\n  const [activeGroup, setActiveGroup] = useState(-1)\r\n\r\n  const [activeFrontHair, setActiveFrontHair] = useState(-1)\r\n  const [activeBackHair, setActiveBackHair] = useState(-1)\r\n\r\n\r\n  // help ui\r\n  const [showHelp, setShowHelp] = useState(false)\r\n\r\n\r\n  // for tab\r\n  const [position, setPosition] = useState({ x: 0, y: 0 })\r\n  const [activeTabIndex, setActiveTabIndex] = useState(-1)\r\n\r\n\r\n\r\n  // For Saving data\r\n  const refAvatar = useRef<HTMLDivElement>(null)\r\n\r\n  // For supporting Apps\r\n  const refEntity_0 = useRef<Draggable>(null)\r\n  const refEntity_1 = useRef<Draggable>(null)\r\n  const refEntity_2 = useRef<Draggable>(null)\r\n  const refEntity_3 = useRef<Draggable>(null)\r\n  const refEntity_4 = useRef<Draggable>(null)\r\n  const refEntity_5 = useRef<Draggable>(null)\r\n  const refEntity_6 = useRef<Draggable>(null)\r\n  const refEntity_7 = useRef<Draggable>(null)\r\n  const refEntity_8 = useRef<Draggable>(null)\r\n\r\n  //const p = React.createRef<Draggable>(null)\r\n\r\n  // to display image and desc\r\n  let roomImgPath:string = \"\"\r\n  let roomImgDesc:string = \"\"\r\n  let activeBgColor:string = \"\"\r\n  let AllMenusTypes:any = []\r\n  const cContent = useObserver(() => stores.contents.all)\r\n  cContent.filter(item => item.shareType===\"roomimg\").map(content => (\r\n    roomImgPath = content.url\r\n  ))\r\n\r\n  cContent.filter(item => item.shareType===\"roomimg\").map(content => (\r\n    roomImgDesc = content.contentDesc\r\n  ))\r\n\r\n  // Setting default Menu Type\r\n  cContent.filter(item => item.shareType === \"appimg\").map((content, index) => (\r\n    index === 0 && menuType === '' ? setMenuType(content.type) : ''\r\n  ))\r\n\r\n  // For Apps section [Room based loading directly from JSON file]\r\n  cContent.filter(item => item.shareType === \"appimg\").map((content, index) => (\r\n    //console.log(content, \" TYPE \", index)\r\n    //content.type === menuType ? content.\r\n    //console.log(menuType, \" -------------- \", content.type)\r\n    menuType === content.type ? activeBgColor = content.baseColor : ''\r\n  ))\r\n\r\n  cContent.filter(item => item.shareType === \"appimg\").map((content, index) => (\r\n    AllMenusTypes.push(content.type)\r\n  ))\r\n\r\n  //const elementsRef = useRef(cContent.filter(item => item.shareType === \"appimg\").map(() => React.createRef()));\r\n\r\n  // const rgb = stores.participants.local.getColorRGB()\r\n\r\n  let press = false\r\n  const loginStatus = useObserver(() => stores.participants.localId)\r\n\r\n  const _roomName = sessionStorage.getItem(\"room\") //getRoomName()\r\n\r\n  const enterUserType = useObserver(() => getUserType())\r\n\r\n  //console.log(loginStatus, \" --------- !!!! -------- \", enterUserType)\r\n\r\n  _able = able\r\n  _menuType = menuType\r\n\r\n\r\n\r\n  let tabBGTopBGWeb:number = 0 //100 //98 //98\r\n  let tabBGTopBGMob:number = 0 //242 //238\r\n\r\n\r\n  //console.log(activeTabIndex, \" TAB INDEX\")\r\n  //let tabBGTopIconWeb:number = 2 //102 //104 //102\r\n  //let tabBGTopIconMob:number = 255 //241\r\n\r\n  ////////////////////////////////////////////////////////////\r\n  //console.log(config.apps[0].name, \" >>> \")\r\n  ////////////////////////////////////////////////////////////\r\n  const [data,setData] = useState('');\r\n  const [uiData, setUIData] = useState('')\r\n  const getData=()=>{\r\n    fetch('folderlist.php?folder=avatar_tool/*.png')\r\n      .then((response) => response.text())\r\n      .then((response) => setData(response));\r\n    // let dataStr = \"avatar_tool/Colors/es_co_group_0.png,avatar_tool/Colors/es_co_group_1.png,avatar_tool/Colors/es_co_group_2.png,avatar_tool/Colors/es_co_group_3.png,avatar_tool/Colors/es_co_group_4.png,avatar_tool/Colors/es_co_group_5.png,avatar_tool/Colors/es_co_group_6.png,avatar_tool/Colors/es_co_group_x.png,avatar_tool/Colors/es_co_hair_0.png,avatar_tool/Colors/es_co_hair_1.png,avatar_tool/Colors/es_co_hair_2.png,avatar_tool/Colors/es_co_hair_3.png,avatar_tool/Colors/es_co_hair_4.png,avatar_tool/Colors/es_co_hair_5.png,avatar_tool/Colors/es_co_hair_6.png,avatar_tool/Colors/es_co_skin_0.png,avatar_tool/Colors/es_co_skin_1.png,avatar_tool/Colors/es_co_skin_2.png,avatar_tool/Colors/es_co_skin_3.png,avatar_tool/Colors/es_co_skin_4.png,avatar_tool/Colors/es_co_skin_5_x.png,avatar_tool/Colors/es_co_skin_6_x.png,avatar_tool/Hair/avatars_hair_5_0_f.png,avatar_tool/Hair/avatars_hair_5_1_f.png,avatar_tool/Hair/avatars_hair_5_2_f.png,avatar_tool/Hair/avatars_hair_5_3_f.png,avatar_tool/Hair/avatars_hair_5_4_f.png,avatar_tool/Hair/avatars_hair_5_5_f.png,avatar_tool/Hair/avatars_hair_5_6_f.png,avatar_tool/Hair/es_hair_0_0_f.png,avatar_tool/Hair/es_hair_0_1_f.png,avatar_tool/Hair/es_hair_0_2_f.png,avatar_tool/Hair/es_hair_0_3_f.png,avatar_tool/Hair/es_hair_0_4_f.png,avatar_tool/Hair/es_hair_0_5_f.png,avatar_tool/Hair/es_hair_0_6_f.png,avatar_tool/Hair/es_hair_0_x_b.png,avatar_tool/Hair/es_hair_0_x_f.png,avatar_tool/Hair/es_hair_1_0_b.png,avatar_tool/Hair/es_hair_1_0_f.png,avatar_tool/Hair/es_hair_1_1_b.png,avatar_tool/Hair/es_hair_1_1_f.png,avatar_tool/Hair/es_hair_1_2_b.png,avatar_tool/Hair/es_hair_1_2_f.png,avatar_tool/Hair/es_hair_1_3_b.png,avatar_tool/Hair/es_hair_1_3_f.png,avatar_tool/Hair/es_hair_1_4_b.png,avatar_tool/Hair/es_hair_1_4_f.png,avatar_tool/Hair/es_hair_1_5_b.png,avatar_tool/Hair/es_hair_1_5_f.png,avatar_tool/Hair/es_hair_1_6_b.png,avatar_tool/Hair/es_hair_1_6_f.png,avatar_tool/Hair/es_hair_2_0_f.png,avatar_tool/Hair/es_hair_2_1_f.png,avatar_tool/Hair/es_hair_2_2_f.png,avatar_tool/Hair/es_hair_2_3_f.png,avatar_tool/Hair/es_hair_2_4_f.png,avatar_tool/Hair/es_hair_2_5_f.png,avatar_tool/Hair/es_hair_2_6_f.png,avatar_tool/Hair/es_hair_3_0_f.png,avatar_tool/Hair/es_hair_3_1_f.png,avatar_tool/Hair/es_hair_3_2_f.png,avatar_tool/Hair/es_hair_3_3_f.png,avatar_tool/Hair/es_hair_3_4_f.png,avatar_tool/Hair/es_hair_3_5_f.png,avatar_tool/Hair/es_hair_3_6_f.png,avatar_tool/Hair/es_hair_4_0_f.png,avatar_tool/Hair/es_hair_4_1_f.png,avatar_tool/Hair/es_hair_4_2_f.png,avatar_tool/Hair/es_hair_4_3_f.png,avatar_tool/Hair/es_hair_4_4_f.png,avatar_tool/Hair/es_hair_4_5_f.png,avatar_tool/Hair/es_hair_4_6_f.png,avatar_tool/Outfits/es_outfit_0.png,avatar_tool/Outfits/es_outfit_1.png,avatar_tool/Outfits/es_outfit_2.png,avatar_tool/Outfits/es_outfit_3.png,avatar_tool/Outfits/es_outfit_4.png,avatar_tool/Outfits/es_outfit_5.png,avatar_tool/Outfits/es_outfit_6.png,avatar_tool/Specs/es_specs_0.png,avatar_tool/Specs/es_specs_1.png,avatar_tool/Specs/es_specs_2.png,\"\r\n    // setData(dataStr)\r\n\r\n    // let uiDataStr = \"help/help_0.png,help/help_1.png,help/help_2.png,\"\r\n    // setUIData(uiDataStr)\r\n  }\r\n\r\n  const getUIData=()=>{\r\n    fetch('folderlist.php?folder=ui/help/*.png')\r\n      .then((response) => response.text())\r\n      .then((response) => setUIData(response));\r\n\r\n    // let uiDataStr = \"ui/help/help_0.png,ui/help/help_1.png,ui/help/help_2.png,\"\r\n    // setUIData(uiDataStr)\r\n  }\r\n\r\n\r\n  ////////////////////////////////////////////////////////////\r\n  //console.log(\"CALLLEEEED- \", loginStatus)\r\n\r\n\r\n\r\n  let sliderData: Array<string> = []\r\n  let sliderDots: Array<string> = []\r\n  if(uiData !== '') {\r\n    sliderData = uiData.split(',')\r\n    sliderDots = uiData.split(',')\r\n    sliderDots.pop()\r\n  }\r\n\r\n  useEffect(() => {\r\n    //console.log(\"CALLLEEEED- \", getLoginClick())\r\n    getData()\r\n    getUIData()\r\n\r\n    //console.log(enterUserType, \" --CHECK RANDOM-- \", activeSkin)\r\n    if(getLoginClick() || loginStatus) {\r\n      //console.log(sessionStorage.getItem(\"room\"), \" roomname\")\r\n      //console.log(\"Show User random avatar - \", data)\r\n      //console.log(\"BBBB --- \", stores.participants.local.information, \" ---- \", getUserType())\r\n      if(enterUserType === \"N\" && activeSkin === -1 && (stores.participants.local.information.randomAvatar === undefined || stores.participants.local.information.randomAvatar.length === 0)) {\r\n      //if(stores.participants.local.information.avatarSrc === \"\" || stores.participants.local.information.avatarSrc === undefined || activeSkin === -1 || stores.participants.local.information.randomAvatar === undefined || stores.participants.local.information.randomAvatar.length === 0) {\r\n      //if(activeSkin === -1 && stores.participants.local.information.randomAvatar.length === 0) {\r\n        onGenerateRandomAvatar()\r\n        const genImage = setTimeout(() => {\r\n          clearTimeout(genImage)\r\n          onGenImageForNewUser()\r\n        }, 50)\r\n      }\r\n\r\n      const introTimer = setTimeout(() => {\r\n        clearTimeout(introTimer)\r\n        setShowIntro(false)\r\n\r\n        if(getUserType() === \"N\" && activeSkin === -1) {\r\n          setShowHelp(true)\r\n        }\r\n      }, 5000)\r\n    }\r\n  })\r\n\r\n  const [currentSlide, setCurrentSlide] = useState(0)\r\n  const slidesLength = sliderData.length-1\r\n\r\n  if(!Array.isArray(sliderData) || sliderData.length <= 0) {\r\n    return null\r\n  }\r\n\r\n  function onGenImageForNewUser() {\r\n    if (refAvatar.current === null) {\r\n      return\r\n    }\r\n\r\n    html2canvas(refAvatar.current, { allowTaint: true }).then(function(canvas:any) {\r\n      var formData = new FormData();\r\n      formData.append('imgData', canvas.toDataURL());\r\n      fetch('saveAvatarImage.php',\r\n        {\r\n          method: 'POST',\r\n          body: formData\r\n        }\r\n      )\r\n        .then((response) => response.text())\r\n        .then((response) => updateUserAvatar(response));\r\n      ////////////////////////////////////////////////////\r\n    })\r\n    .catch((err) => {\r\n      console.log(err)\r\n    })\r\n\r\n    // toPng(refAvatar.current, { cacheBust: true, })\r\n    //   .then((dataUrl) => {\r\n    //   ////////////////////////////////////////////////////\r\n    //   console.log(dataUrl, \" DATA\")\r\n    //   var formData = new FormData();\r\n    //   formData.append('imgData', dataUrl);\r\n    //   fetch('saveAvatarImage.php',\r\n    //     {\r\n    //       method: 'POST',\r\n    //       body: formData\r\n    //     }\r\n    //   )\r\n    //     .then((response) => response.text())\r\n    //     .then((response) => updateUserAvatar(response));\r\n    //   ////////////////////////////////////////////////////\r\n    // })\r\n    // .catch((err) => {\r\n    //   console.log(err)\r\n    // })\r\n  }\r\n\r\n\r\n  function updateUserAvatar(_path:string) {\r\n    stores.participants.local.information.avatarSrc = _path\r\n\r\n    // Storing values to localstorage\r\n    stores.participants.local.information.randomAvatar = [selectedSkin, selectedHairColor, selectedGroup, selectedHair, selectedOutfits, selectedSpecs]\r\n\r\n    stores.participants.local.sendInformation()\r\n    stores.participants.local.saveInformationToStorage(true)\r\n  }\r\n\r\n  function generateRandomNumber(min:number, max:number) {\r\n    return Math.floor(Math.random() * (max - min + 1) + min)\r\n  }\r\n\r\n\r\n  function onGenerateRandomAvatar() {\r\n\r\n    //////////////////////////////////////////////////////////////////////////////\r\n\r\n  //console.log(data, \" data\")\r\n  // format accordingly to folder name\r\n  const folders : Array<string> = []\r\n  const images : Array<string> = []\r\n  let tempArr : string = ''\r\n  let dataFolderWise = data.split(',')\r\n\r\n  for (let i=0; i<dataFolderWise.length-1; i++) {\r\n      if(folders.indexOf(dataFolderWise[i].split('/')[1]) === -1 && dataFolderWise[i].split('/')[1] !== undefined) {\r\n        folders.push(dataFolderWise[i].split('/')[1])\r\n      }\r\n\r\n    }\r\n    for (var j=0; j < folders.length; j++) {\r\n      for (let i=0; i<dataFolderWise.length-1; i++) {\r\n      if(folders[j] === dataFolderWise[i].split('/')[1]) {\r\n        tempArr += (dataFolderWise[i]) + ','\r\n      }\r\n    }\r\n    images.push(tempArr)\r\n    tempArr = ''\r\n  }\r\n  ////////////////////////////////////////////////////////////////////////////\r\n    // For Group, Skin and Hair Color setting\r\n    //let randGroupIndex = generateRandomNumber(0,6)\r\n    let randSkinIndex = generateRandomNumber(15, 20)\r\n    let randHairColorIndex = generateRandomNumber(8, 14)\r\n    let imgArr = images[0].split(',')\r\n    let randGroupIndex = imgArr.indexOf('avatar_tool/Colors/es_co_group_x.png')\r\n\r\n    //console.log(randGroupIndex)\r\n\r\n    //if(pageIndex === 0) {\r\n      //if(randGroupIndex < 7) {\r\n        selectedGroup = imgArr[randGroupIndex]\r\n        if(activeGroup !== randGroupIndex) {\r\n          setActiveGroup(randGroupIndex)\r\n        }\r\n      //}\r\n    //}\r\n    if(randHairColorIndex >= 7 && randHairColorIndex < 15) {\r\n      selectedHairColor = imgArr[randHairColorIndex].split('/')[2].split('.')[0].split('co_')[1]\r\n      if(activeHair !== randHairColorIndex) {\r\n        setActiveHair(randHairColorIndex)\r\n      }\r\n    }\r\n    if(randSkinIndex >= 15 && randSkinIndex < 20) {\r\n      selectedSkin = imgArr[randSkinIndex]\r\n      if(activeSkin !== randSkinIndex) {\r\n        setActiveSkin(randSkinIndex)\r\n      }\r\n    }\r\n  //}\r\n\r\n    // Setting Hairs [ Front , Back ]\r\n    let imgHairArr = images[1].split(',')\r\n    let frontHairs : Array<string> = []\r\n    let frontHairIndex : Array<number> = []\r\n    let backHairs : Array<string> = []\r\n    let backHairIndex : Array<number> = []\r\n    frontHairs.splice(0)\r\n    frontHairIndex.splice(0)\r\n    backHairs.splice(0)\r\n    backHairIndex.splice(0)\r\n    for (let i:number = 0; i < imgHairArr.length - 1; i++) {\r\n      //console.log(selectedHairColor.split('_')[1], \" ---- \", imgHairArr[i].split(\"_\")[4])\r\n      //if(imgHairArr[i].indexOf(selectedHairColor) !== -1) {\r\n\r\n        //console.log(selectedHairColor.split('_')[1], \" --- \", selectedHairColor)\r\n\r\n        if(imgHairArr.indexOf(selectedHairColor.split('_')[1] + '_' + imgHairArr[i].split(\"_\")[4]) === -1) {\r\n        if((selectedHairColor.split(\"_\")[1] === imgHairArr[i].split(\"_\")[4])) {\r\n          let hairType = imgHairArr[i].split('/')[2].split('.')[0].split('_')[4]\r\n          if(hairType === 'f') {\r\n            frontHairs.push(imgHairArr[i])\r\n            frontHairIndex.push(i)\r\n          } else if(hairType === 'b') {\r\n            backHairs.push(imgHairArr[i])\r\n            backHairIndex.push(i)\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if(frontHairs.length > 0) {\r\n      let randFrontHairIndex = generateRandomNumber(0, frontHairs.length-1)\r\n      selectedHair = frontHairs[randFrontHairIndex]\r\n      //console.log(frontHairs[randFrontHairIndex])\r\n      if(activeFrontHair !== frontHairIndex[randFrontHairIndex]) {\r\n        setActiveFrontHair(frontHairIndex[randFrontHairIndex])\r\n      }\r\n      //console.log(frontHairs[randFrontHairIndex].split('/')[2].split('.')[0], \" random front\")\r\n      let findBack = imgHairArr.indexOf(String(frontHairs[randFrontHairIndex].split('_f.png')[0] + '_b.png'))\r\n      //console.log(String(frontHairs[randFrontHairIndex].split('_f.png')[0] + '_b.png'), \" BackRandom \", findBack)\r\n      //console.log(findBack, \" findBack\")\r\n      if(findBack !== -1) {\r\n        selectedHairBack = imgHairArr[findBack]\r\n        if(activeBackHair !== findBack) {\r\n          setActiveBackHair(findBack)\r\n        } else {\r\n          selectedHairBack = ''\r\n          setActiveBackHair(-1)\r\n        }\r\n      } else {\r\n        selectedHairBack = ''\r\n        setActiveBackHair(-1)\r\n      }\r\n\r\n    } else {\r\n      selectedHair = ''\r\n      setActiveFrontHair(-1)\r\n\r\n      selectedHairBack = ''\r\n      setActiveBackHair(-1)\r\n    }\r\n    // if(backHairs.length > 0) {\r\n    //   let randBackHairIndex = generateRandomNumber(0, backHairs.length-1)\r\n    //   selectedHairBack = backHairs[randBackHairIndex]\r\n    //   setActiveBackHair(backHairIndex[randBackHairIndex])\r\n    // } else {\r\n    //   selectedHairBack = ''\r\n    //   setActiveBackHair(-1)\r\n    // }\r\n\r\n    // Setting OutFits\r\n    let imgOutfitArr = images[2].split(',')\r\n    let randOutfitIndex = generateRandomNumber(0, imgOutfitArr.length-2)\r\n    selectedOutfits = imgOutfitArr[randOutfitIndex]\r\n    if(activeOutfit !== randOutfitIndex) {\r\n      setActiveOutfit(randOutfitIndex)\r\n    }\r\n\r\n    // Setting Specs\r\n    let imgSpecsArr = images[3].split(',')\r\n    let randSpecsIndex = generateRandomNumber(0, imgSpecsArr.length-2)\r\n    selectedSpecs = imgSpecsArr[randSpecsIndex]\r\n    if(activeSpecs !== randSpecsIndex) {\r\n      setActiveSpecs(randSpecsIndex)\r\n    }\r\n  }\r\n\r\n\r\n  function onPrevClick() {\r\n    //console.log(\"prev click\")\r\n    setCurrentSlide(currentSlide === 0 ? slidesLength-1 : currentSlide - 1)\r\n  }\r\n\r\n  function onNextClick() {\r\n    //console.log(\"next click\")\r\n    setCurrentSlide(currentSlide === slidesLength-1 ? 0 : currentSlide + 1)\r\n  }\r\n\r\n\r\n  // For toggle right panel that has users/contents/chat\r\n  window.addEventListener('keydown', (ev) => {\r\n    //ev.preventDefault()\r\n    if(ev.key === \"F3\" && press === false) {\r\n      ev.preventDefault()\r\n      press = true;\r\n      if(able === true) {\r\n        setAble(false)\r\n      } else\r\n      if(able === false) {\r\n        setAble(true)\r\n      }\r\n    }\r\n  }, {})\r\n  //  toucmove: prevent browser zoom by pinch\r\n  window.addEventListener('touchmove', (ev) => {\r\n    //  if (ev.touches.length > 1) {\r\n    ev.preventDefault()\r\n    //  }\r\n  },                      {passive: false, capture: false})\r\n  //  contextmenu: prevent to show context menu with right mouse click\r\n  window.addEventListener('contextmenu', (ev) => {\r\n    ev.preventDefault()\r\n  },                      {passive: false, capture: false})\r\n\r\n  //  Global error handler\r\n  window.onerror = (message, source, lineno, colno, error) => {\r\n    if ((error?.message === 'Ping timeout' || error?.message === 'Strophe: Websocket error [object Event]')\r\n     && message === null && source === null && lineno === null && colno === null){\r\n      errorInfo.setType('connection')\r\n      if (urlParameters.testBot !== null){  //  testBot\r\n        window.location.reload()  //  testBot will reload when connection is cutted off.\r\n      }\r\n    }else{\r\n      console.warn(`Global handler: ${message}`, source, lineno, colno, error)\r\n    }\r\n    return true\r\n  }\r\n  // FF00FF\r\n\r\n  //console.log(isSmartphone(), \" .....\")\r\n\r\n  // function StartMeeting() {\r\n  //   setShowIntro(false)\r\n  // }\r\n\r\n  function trackPos(data:any, _index:number, _menu:string) {\r\n    setPosition({ x: data.x, y: data.y })\r\n    _menuPos = position.x\r\n\r\n    //_menuType = menu\r\n\r\n    // Setting Pos\r\n    CheckAndSetPosition(_index)\r\n    CheckAndActivateMenu(_index)\r\n\r\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n    // Check How many items are there in the dock tab\r\n    // let _bool = false\r\n    // if(Object(refEntity_0.current?.state).x === 0 || Object(refEntity_1.current?.state).x === 0 || Object(refEntity_2.current?.state).x === 0) {\r\n    //   _bool = true\r\n    // }\r\n    // console.log(_bool)\r\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n    // if(_index === 0) {\r\n    //   let moveIndex = 0\r\n    //   if(Object(refEntity_0.current?.state).x < 0 || Object(refEntity_0.current?.state).x > 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_0.current?.state).x = 0\r\n    //     Object(refEntity_0.current?.state).y = (0)\r\n    //   }\r\n    //   if(Object(refEntity_1.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_1.current?.state).x = 0\r\n    //     Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_2.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_2.current?.state).x = 0\r\n    //     Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_3.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_3.current?.state).x = 0\r\n    //     Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_4.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_4.current?.state).x = 0\r\n    //     Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_5.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_5.current?.state).x = 0\r\n    //     Object(refEntity_5.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_6.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_6.current?.state).x = 0\r\n    //     Object(refEntity_6.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n\r\n    // } else if(_index === 1) {\r\n    //   let moveIndex = 0\r\n    //   if(Object(refEntity_0.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_0.current?.state).x = 0\r\n    //     Object(refEntity_0.current?.state).y = (0)\r\n    //   }\r\n    //   if(Object(refEntity_1.current?.state).x < 0 || Object(refEntity_1.current?.state).x > 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else if(Object(refEntity_1.current?.state).x === 0) {\r\n    //     Object(refEntity_1.current?.state).x = 0\r\n    //     Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_2.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_2.current?.state).x = 0\r\n    //     Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_3.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_3.current?.state).x = 0\r\n    //     Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_4.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_4.current?.state).x = 0\r\n    //     Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_5.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_5.current?.state).x = 0\r\n    //     Object(refEntity_5.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_6.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_6.current?.state).x = 0\r\n    //     Object(refEntity_6.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    // } else if(_index === 2) {\r\n    //   let moveIndex = 0\r\n    //   if(Object(refEntity_0.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_0.current?.state).x = 0\r\n    //     Object(refEntity_0.current?.state).y = (0)\r\n    //   }\r\n    //   if(Object(refEntity_1.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_1.current?.state).x = 0\r\n    //     Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_2.current?.state).x < 0 || Object(refEntity_2.current?.state).x > 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_2.current?.state).x = 0\r\n    //     Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_3.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_3.current?.state).x = 0\r\n    //     Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_4.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_4.current?.state).x = 0\r\n    //     Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_5.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_5.current?.state).x = 0\r\n    //     Object(refEntity_5.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_6.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_6.current?.state).x = 0\r\n    //     Object(refEntity_6.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    // } else if(_index === 3) {\r\n    //   let moveIndex = 0\r\n    //   if(Object(refEntity_0.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_0.current?.state).x = 0\r\n    //     Object(refEntity_0.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_1.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_1.current?.state).x = 0\r\n    //     Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_2.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_2.current?.state).x = 0\r\n    //     Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_3.current?.state).x < 0 || Object(refEntity_3.current?.state).x > 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_3.current?.state).x = 0\r\n    //     Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_4.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_4.current?.state).x = 0\r\n    //     Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_5.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_5.current?.state).x = 0\r\n    //     Object(refEntity_5.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_6.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_6.current?.state).x = 0\r\n    //     Object(refEntity_6.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    // } else if(_index === 4) {\r\n    //   let moveIndex = 0\r\n    //   if(Object(refEntity_0.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_0.current?.state).x = 0\r\n    //     Object(refEntity_0.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_1.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_1.current?.state).x = 0\r\n    //     Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_2.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_2.current?.state).x = 0\r\n    //     Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_3.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_3.current?.state).x = 0\r\n    //     Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_4.current?.state).x < 0 || Object(refEntity_4.current?.state).x > 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_4.current?.state).x = 0\r\n    //     Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_5.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_5.current?.state).x = 0\r\n    //     Object(refEntity_5.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_6.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_6.current?.state).x = 0\r\n    //     Object(refEntity_6.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    // } else if(_index === 5) {\r\n    //   let moveIndex = 0\r\n    //   if(Object(refEntity_0.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_0.current?.state).x = 0\r\n    //     Object(refEntity_0.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_1.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_1.current?.state).x = 0\r\n    //     Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_2.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_2.current?.state).x = 0\r\n    //     Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_3.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_3.current?.state).x = 0\r\n    //     Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_4.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_4.current?.state).x = 0\r\n    //     Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_5.current?.state).x < 0 || Object(refEntity_5.current?.state).x > 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_5.current?.state).x = 0\r\n    //     Object(refEntity_5.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_6.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_6.current?.state).x = 0\r\n    //     Object(refEntity_6.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    // } else if(_index === 6) {\r\n    //   let moveIndex = 0\r\n    //   if(Object(refEntity_0.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_0.current?.state).x = 0\r\n    //     Object(refEntity_0.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_1.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_1.current?.state).x = 0\r\n    //     Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_2.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_2.current?.state).x = 0\r\n    //     Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_3.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_3.current?.state).x = 0\r\n    //     Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_4.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_4.current?.state).x = 0\r\n    //     Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_5.current?.state).x < 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_5.current?.state).x = 0\r\n    //     Object(refEntity_5.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    //   if(Object(refEntity_6.current?.state).x < 0  || Object(refEntity_6.current?.state).x > 0) {\r\n    //     moveIndex = moveIndex + 1\r\n    //   } else {\r\n    //     Object(refEntity_6.current?.state).x = 0\r\n    //     Object(refEntity_6.current?.state).y = (moveIndex * -51)\r\n    //   }\r\n    // }\r\n\r\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n    //setMenuType('chat')\r\n    setActiveTabIndex(_index)\r\n\r\n    //setMenuType('chat')\r\n    //setAble(false)\r\n\r\n    // cContent.filter(item => item.shareType === \"appimg\").map((content, index) => (\r\n    //   console.log(Object(refEntity.current?.state).x, \" - ALL X POS - \", content.type)\r\n    // ))\r\n  }\r\n\r\n  // function setDefaultTrack(_url:string, _index:number) {\r\n  //   if(_index === 0) {\r\n  //     Object(refEntity_0.current?.state).x = -99999999\r\n  //     console.log(\"Hiding Element\", Object(refEntity_0.current))\r\n  //   } else if(_index === 1) {\r\n  //     Object(refEntity_1.current?.state).x = -99999999\r\n  //   } else if(_index === 2) {\r\n  //     Object(refEntity_2.current?.state).x = -99999999\r\n  //   } else if(_index === 3) {\r\n  //     Object(refEntity_3.current?.state).x = -99999999\r\n  //   } else if(_index === 4) {\r\n  //     Object(refEntity_4.current?.state).x = -99999999\r\n  //   }\r\n\r\n  //   ///////////////////////////////////////////////////////\r\n  //   //window.open(_url, \"_new\")\r\n  //   let externalWindow = window.open(_url, '', 'width=400,height=650,left=500,top=100');\r\n  //   var timer = setInterval(function() {\r\n  //     if(externalWindow?.closed) {\r\n  //         clearInterval(timer);\r\n  //     }})\r\n  // }\r\n\r\n\r\n\r\n  function CheckAndActivateMenu(_index:number) {\r\n    //console.log(AllMenusTypes)\r\n    if(AllMenusTypes.length === 0) {\r\n      if(_index === 0) {\r\n        if(Object(refEntity_1.current?.state).x === 0) {\r\n          setMenuType('content')\r\n        } else {\r\n          setMenuType('blank')\r\n        }\r\n      } else if(_index === 1) {\r\n        if(Object(refEntity_0.current?.state).x === 0) {\r\n          setMenuType('chat')\r\n        } else {\r\n          setMenuType('blank')\r\n        }\r\n      }\r\n    } else {\r\n      if(_index === 0) {\r\n        if(Object(refEntity_1.current?.state).x === 0) {\r\n          setMenuType('content')\r\n        } else if(Object(refEntity_2.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index])\r\n        } else if(Object(refEntity_3.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index+1])\r\n        } else if(Object(refEntity_4.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index+2])\r\n        } else if(Object(refEntity_5.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index+3])\r\n        } else if(Object(refEntity_6.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index+4])\r\n        } else {\r\n          setMenuType('blank')\r\n        }\r\n      } else if(_index === 1) {\r\n        if(Object(refEntity_0.current?.state).x === 0) {\r\n          setMenuType('chat')\r\n        } else if(Object(refEntity_2.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index-1])\r\n        } else if(Object(refEntity_3.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index])\r\n        } else if(Object(refEntity_4.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index+1])\r\n        } else if(Object(refEntity_5.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index+3])\r\n        } else if(Object(refEntity_6.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index+4])\r\n        } else {\r\n          setMenuType('blank')\r\n        }\r\n      } else if(_index >= 2) {\r\n        if(Object(refEntity_0.current?.state).x === 0) {\r\n          setMenuType('chat')\r\n        } else if(Object(refEntity_1.current?.state).x === 0) {\r\n          setMenuType('content')\r\n        } else if(Object(refEntity_3.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index-2])\r\n        } else if(Object(refEntity_4.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index-2])\r\n        } else if(Object(refEntity_5.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index-2])\r\n        } else if(Object(refEntity_6.current?.state).x === 0) {\r\n          _menuPos = -2\r\n          setActiveTabIndex(-1)\r\n          setMenuType(AllMenusTypes[_index-2])\r\n        } else {\r\n          setMenuType('blank')\r\n        }\r\n      // } else if(_index === 3) {\r\n      //   if(Object(refEntity_0.current?.state).x === 0) {\r\n      //     setMenuType('chat')\r\n      //   } else if(Object(refEntity_1.current?.state).x === 0) {\r\n      //     setMenuType('content')\r\n      //   } else if(Object(refEntity_2.current?.state).x === 0) {\r\n      //     setMenuType(AllMenusTypes[_index-2])\r\n      //   } else if(Object(refEntity_4.current?.state).x === 0) {\r\n      //     setMenuType(AllMenusTypes[_index-2])\r\n      //   } else if(Object(refEntity_5.current?.state).x === 0) {\r\n      //     setMenuType(AllMenusTypes[_index-2])\r\n      //   } else if(Object(refEntity_6.current?.state).x === 0) {\r\n      //     setMenuType(AllMenusTypes[_index-2])\r\n      //   } else {\r\n      //     setMenuType('blank')\r\n      //   }\r\n      // }\r\n    }\r\n  }\r\n\r\n\r\n\r\n\r\n  function CheckAndSetPosition(_index:number) {\r\n\r\n    if(_index === 0) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0 || Object(refEntity_0.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = (0)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n\r\n    } else if(_index === 1) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = (0)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0 || Object(refEntity_1.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else if(Object(refEntity_1.current?.state).x === 0) {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n    } else if(_index === 2) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = (0)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0 || Object(refEntity_2.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n    } else if(_index === 3) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0 || Object(refEntity_3.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n    } else if(_index === 4) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0 || Object(refEntity_4.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n    } else if(_index === 5) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0 || Object(refEntity_5.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n    } else if(_index === 6) {\r\n      let moveIndex = 0\r\n      if(Object(refEntity_0.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_0.current?.state).x = 0\r\n        Object(refEntity_0.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_1.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_1.current?.state).x = 0\r\n        Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_2.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_2.current?.state).x = 0\r\n        Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_3.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_3.current?.state).x = 0\r\n        Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_4.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_4.current?.state).x = 0\r\n        Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_5.current?.state).x < 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_5.current?.state).x = 0\r\n        Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n      if(Object(refEntity_6.current?.state).x < 0  || Object(refEntity_6.current?.state).x > 0) {\r\n        moveIndex = moveIndex + 1\r\n      } else {\r\n        Object(refEntity_6.current?.state).x = 0\r\n        Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  function setTrack(data:any, _url:string, _index:number) {\r\n    //setMenuType(_type)\r\n\r\n    // if(_index === 0) {\r\n    //   if(Object(refEntity_0.current?.state).x > 0) {\r\n    //     Object(refEntity_0.current?.state).x = 0\r\n    //     Object(refEntity_0.current?.state).y = (0)\r\n    //   }\r\n    //   _menuPos = -2\r\n    // }\r\n\r\n  //   if(data.x >= -1) {\r\n  //   if(_index === 0) {\r\n  //     let moveIndex = 0\r\n  //     if(Object(refEntity_0.current?.state).x >= 0) {\r\n  //       Object(refEntity_0.current?.state).x = 0\r\n  //       Object(refEntity_0.current?.state).y = (0)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n  //     if(Object(refEntity_1.current?.state).x === 0) {\r\n  //       Object(refEntity_1.current?.state).x = 0\r\n  //       Object(refEntity_1.current?.state).y = (moveIndex * 51)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n\r\n  //     if(Object(refEntity_2.current?.state).x === 0) {\r\n  //       Object(refEntity_2.current?.state).x = 0\r\n  //       Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n\r\n  //     if(Object(refEntity_3.current?.state).x === 0) {\r\n  //       Object(refEntity_3.current?.state).x = 0\r\n  //       Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n  //     if(Object(refEntity_4.current?.state).x === 0) {\r\n  //       Object(refEntity_4.current?.state).x = 0\r\n  //       Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n  //     }\r\n  //     _menuPos = -2\r\n  //   } else if(_index === 1) {\r\n  //     let moveIndex = 0\r\n  //     if(Object(refEntity_0.current?.state).x === 0) {\r\n  //       Object(refEntity_0.current?.state).x = 0\r\n  //       Object(refEntity_0.current?.state).y = (0)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n  //     if(Object(refEntity_1.current?.state).x >= 0) {\r\n  //       Object(refEntity_1.current?.state).x = 0\r\n  //       Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n\r\n  //     if(Object(refEntity_2.current?.state).x === 0) {\r\n  //       Object(refEntity_2.current?.state).x = 0\r\n  //       Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n\r\n  //     if(Object(refEntity_3.current?.state).x === 0) {\r\n  //       Object(refEntity_3.current?.state).x = 0\r\n  //       Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n  //     if(Object(refEntity_4.current?.state).x === 0) {\r\n  //       Object(refEntity_4.current?.state).x = 0\r\n  //       Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n  //     }\r\n  //     _menuPos = -2\r\n  //   } else if(_index === 2) {\r\n  //     let moveIndex = 0\r\n  //     if(Object(refEntity_0.current?.state).x === 0) {\r\n  //       Object(refEntity_0.current?.state).x = 0\r\n  //       Object(refEntity_0.current?.state).y = (0)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n  //     if(Object(refEntity_1.current?.state).x === 0) {\r\n  //       Object(refEntity_1.current?.state).x = 0\r\n  //       Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n\r\n  //     if(Object(refEntity_2.current?.state).x >= 0) {\r\n  //       Object(refEntity_2.current?.state).x = 0\r\n  //       Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n\r\n  //     if(Object(refEntity_3.current?.state).x === 0) {\r\n  //       Object(refEntity_3.current?.state).x = 0\r\n  //       Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n  //     if(Object(refEntity_4.current?.state).x === 0) {\r\n  //       Object(refEntity_4.current?.state).x = 0\r\n  //       Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n  //     }\r\n  //     _menuPos = -2\r\n  //   } else if(_index === 3) {\r\n  //     let moveIndex = 0\r\n  //     if(Object(refEntity_0.current?.state).x === 0) {\r\n  //       Object(refEntity_0.current?.state).x = 0\r\n  //       Object(refEntity_0.current?.state).y = (0)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n  //     if(Object(refEntity_1.current?.state).x === 0) {\r\n  //       Object(refEntity_1.current?.state).x = 0\r\n  //       Object(refEntity_1.current?.state).y = (0)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n\r\n  //     if(Object(refEntity_2.current?.state).x === 0) {\r\n  //       Object(refEntity_2.current?.state).x = 0\r\n  //       Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n\r\n  //     if(Object(refEntity_3.current?.state).x >= 0) {\r\n  //       Object(refEntity_3.current?.state).x = 0\r\n  //       Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n  //     if(Object(refEntity_4.current?.state).x === 0) {\r\n  //       Object(refEntity_4.current?.state).x = 0\r\n  //       Object(refEntity_4.current?.state).y = (0)\r\n  //     }\r\n  //     _menuPos = -2\r\n  //   } else if(_index === 4) {\r\n  //     let moveIndex = 0\r\n  //     if(Object(refEntity_0.current?.state).x === 0) {\r\n  //       Object(refEntity_0.current?.state).x = 0\r\n  //       Object(refEntity_0.current?.state).y = (0)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n  //     if(Object(refEntity_1.current?.state).x === 0) {\r\n  //       Object(refEntity_1.current?.state).x = 0\r\n  //       Object(refEntity_1.current?.state).y = (0)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n\r\n  //     if(Object(refEntity_2.current?.state).x === 0) {\r\n  //       Object(refEntity_2.current?.state).x = 0\r\n  //       Object(refEntity_2.current?.state).y = (0)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n\r\n  //     if(Object(refEntity_3.current?.state).x === 0) {\r\n  //       Object(refEntity_3.current?.state).x = 0\r\n  //       Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n  //     } else {\r\n  //       moveIndex = moveIndex + 1\r\n  //     }\r\n  //     if(Object(refEntity_4.current?.state).x >= 0) {\r\n  //       Object(refEntity_4.current?.state).x = 0\r\n  //       Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n  //     }\r\n  //     _menuPos = -2\r\n  //   }\r\n  // }\r\n\r\n\r\n  // 30\r\n  //console.log(window.innerHeight, \" --- \", data.y)\r\n  //console.log(data.x, \" ---- \", (stores.map.screenSize))\r\n\r\n  //console.log(data.y, \"  < \" , ((_index * -51)))\r\n\r\n\r\n    //if(data.y < (-135 + (_index * -51)) || data.y > (675 + (_index * -51)) || data.x < (-(stores.map.screenSize[0] - 40)) || data.x > 0) {\r\n    if(data.y < ((_index * -51)) || data.y > (675 + (_index * -51)) || data.x < (-(stores.map.screenSize[0] - 40)) || data.x > 0) {\r\n      ///////////////////////////////////////////////////////\r\n      // Hide the Tab\r\n      if(_index === 0) {\r\n        Object(refEntity_0.current?.state).x = -99999999\r\n      } else if(_index === 1) {\r\n        Object(refEntity_1.current?.state).x = -99999999\r\n      } else if(_index === 2) {\r\n        Object(refEntity_2.current?.state).x = -99999999\r\n      } else if(_index === 3) {\r\n        Object(refEntity_3.current?.state).x = -99999999\r\n      } else if(_index === 4) {\r\n        Object(refEntity_4.current?.state).x = -99999999\r\n      } else if(_index === 5) {\r\n        Object(refEntity_5.current?.state).x = -99999999\r\n      } else if(_index === 6) {\r\n        Object(refEntity_6.current?.state).x = -99999999\r\n      }\r\n\r\n      ///////////////////////////////////////////////////////\r\n      //window.open(_url, \"_new\")\r\n      let externalWindow = window.open(_url, '', 'width=400,height=650,left=500,top=100');\r\n      var timer = setInterval(function() {\r\n        if(externalWindow?.closed) {\r\n            clearInterval(timer);\r\n            //alert(_index);\r\n            //////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n            //CheckAndSetPosition(_index)\r\n            if(_index === 0) {\r\n              let moveIndex = 0\r\n              if(Object(refEntity_0.current?.state).x < 0 || Object(refEntity_0.current?.state).x > 0) {\r\n                Object(refEntity_0.current?.state).x = 0\r\n                Object(refEntity_0.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_1.current?.state).x === 0) {\r\n                Object(refEntity_1.current?.state).x = 0\r\n                Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * 51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_2.current?.state).x === 0) {\r\n                Object(refEntity_2.current?.state).x = 0\r\n                Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_3.current?.state).x === 0) {\r\n                Object(refEntity_3.current?.state).x = 0\r\n                Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_4.current?.state).x === 0) {\r\n                Object(refEntity_4.current?.state).x = 0\r\n                Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_5.current?.state).x === 0) {\r\n                Object(refEntity_5.current?.state).x = 0\r\n                Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_6.current?.state).x === 0) {\r\n                Object(refEntity_6.current?.state).x = 0\r\n                Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              }\r\n            } else if(_index === 1) {\r\n              let moveIndex = 0\r\n              if(Object(refEntity_0.current?.state).x === 0) {\r\n                Object(refEntity_0.current?.state).x = 0\r\n                Object(refEntity_0.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_1.current?.state).x < 0 || Object(refEntity_1.current?.state).x > 0) {\r\n                Object(refEntity_1.current?.state).x = 0\r\n                Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_2.current?.state).x === 0) {\r\n                Object(refEntity_2.current?.state).x = 0\r\n                Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_3.current?.state).x === 0) {\r\n                Object(refEntity_3.current?.state).x = 0\r\n                Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_4.current?.state).x === 0) {\r\n                Object(refEntity_4.current?.state).x = 0\r\n                Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_5.current?.state).x === 0) {\r\n                Object(refEntity_5.current?.state).x = 0\r\n                Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_6.current?.state).x === 0) {\r\n                Object(refEntity_6.current?.state).x = 0\r\n                Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              }\r\n            } else if(_index === 2) {\r\n              let moveIndex = 0\r\n              if(Object(refEntity_0.current?.state).x === 0) {\r\n                Object(refEntity_0.current?.state).x = 0\r\n                Object(refEntity_0.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_1.current?.state).x === 0) {\r\n                Object(refEntity_1.current?.state).x = 0\r\n                Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_2.current?.state).x < 0 || Object(refEntity_2.current?.state).x > 0) {\r\n                Object(refEntity_2.current?.state).x = 0\r\n                Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_3.current?.state).x === 0) {\r\n                Object(refEntity_3.current?.state).x = 0\r\n                Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_4.current?.state).x === 0) {\r\n                Object(refEntity_4.current?.state).x = 0\r\n                Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_5.current?.state).x === 0) {\r\n                Object(refEntity_5.current?.state).x = 0\r\n                Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_6.current?.state).x === 0) {\r\n                Object(refEntity_6.current?.state).x = 0\r\n                Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              }\r\n            } else if(_index === 3) {\r\n              let moveIndex = 0\r\n              if(Object(refEntity_0.current?.state).x === 0) {\r\n                Object(refEntity_0.current?.state).x = 0\r\n                Object(refEntity_0.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_1.current?.state).x === 0) {\r\n                Object(refEntity_1.current?.state).x = 0\r\n                Object(refEntity_1.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_2.current?.state).x === 0) {\r\n                Object(refEntity_2.current?.state).x = 0\r\n                Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_3.current?.state).x < 0 || Object(refEntity_3.current?.state).x > 0) {\r\n                Object(refEntity_3.current?.state).x = 0\r\n                Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_4.current?.state).x === 0) {\r\n                Object(refEntity_4.current?.state).x = 0\r\n                Object(refEntity_4.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_5.current?.state).x === 0) {\r\n                Object(refEntity_5.current?.state).x = 0\r\n                Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_6.current?.state).x === 0) {\r\n                Object(refEntity_6.current?.state).x = 0\r\n                Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              }\r\n            } else if(_index === 4) {\r\n              let moveIndex = 0\r\n              if(Object(refEntity_0.current?.state).x === 0) {\r\n                Object(refEntity_0.current?.state).x = 0\r\n                Object(refEntity_0.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_1.current?.state).x === 0) {\r\n                Object(refEntity_1.current?.state).x = 0\r\n                Object(refEntity_1.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_2.current?.state).x === 0) {\r\n                Object(refEntity_2.current?.state).x = 0\r\n                Object(refEntity_2.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_3.current?.state).x === 0) {\r\n                Object(refEntity_3.current?.state).x = 0\r\n                Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_4.current?.state).x < 0 || Object(refEntity_4.current?.state).x > 0) {\r\n                Object(refEntity_4.current?.state).x = 0\r\n                Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_5.current?.state).x === 0) {\r\n                Object(refEntity_5.current?.state).x = 0\r\n                Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_6.current?.state).x === 0) {\r\n                Object(refEntity_6.current?.state).x = 0\r\n                Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              }\r\n            } else if(_index === 5) {\r\n              let moveIndex = 0\r\n              if(Object(refEntity_0.current?.state).x === 0) {\r\n                Object(refEntity_0.current?.state).x = 0\r\n                Object(refEntity_0.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_1.current?.state).x === 0) {\r\n                Object(refEntity_1.current?.state).x = 0\r\n                Object(refEntity_1.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_2.current?.state).x === 0) {\r\n                Object(refEntity_2.current?.state).x = 0\r\n                Object(refEntity_2.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_3.current?.state).x === 0) {\r\n                Object(refEntity_3.current?.state).x = 0\r\n                Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_4.current?.state).x === 0) {\r\n                Object(refEntity_4.current?.state).x = 0\r\n                Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_5.current?.state).x < 0  || Object(refEntity_5.current?.state).x > 0) {\r\n                Object(refEntity_5.current?.state).x = 0\r\n                Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_6.current?.state).x === 0) {\r\n                Object(refEntity_6.current?.state).x = 0\r\n                Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              }\r\n            } else if(_index === 6) {\r\n              let moveIndex = 0\r\n              if(Object(refEntity_0.current?.state).x === 0) {\r\n                Object(refEntity_0.current?.state).x = 0\r\n                Object(refEntity_0.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_1.current?.state).x === 0) {\r\n                Object(refEntity_1.current?.state).x = 0\r\n                Object(refEntity_1.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_2.current?.state).x === 0) {\r\n                Object(refEntity_2.current?.state).x = 0\r\n                Object(refEntity_2.current?.state).y = (0)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n\r\n              if(Object(refEntity_3.current?.state).x === 0) {\r\n                Object(refEntity_3.current?.state).x = 0\r\n                Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_4.current?.state).x === 0) {\r\n                Object(refEntity_4.current?.state).x = 0\r\n                Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_5.current?.state).x === 0) {\r\n                Object(refEntity_5.current?.state).x = 0\r\n                Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              } else {\r\n                moveIndex = moveIndex + 1\r\n              }\r\n              if(Object(refEntity_6.current?.state).x < 0  || Object(refEntity_5.current?.state).x > 0) {\r\n                Object(refEntity_6.current?.state).x = 0\r\n                Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n              }\r\n            }\r\n\r\n            //////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n            setPosition({x:0, y:0})\r\n        }\r\n    }, 100);\r\n      ///////////////////////////////////////////////////////\r\n      // if(_index === 0) {\r\n      //   let moveIndex = 0\r\n      //   if(Object(refEntity_0.current?.state).x < 0) {\r\n      //     Object(refEntity_0.current?.state).x = 0\r\n      //     Object(refEntity_0.current?.state).y = (0)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n      //   if(Object(refEntity_1.current?.state).x === 0) {\r\n      //     Object(refEntity_1.current?.state).x = 0\r\n      //     Object(refEntity_1.current?.state).y = (moveIndex * 51)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n\r\n      //   if(Object(refEntity_2.current?.state).x === 0) {\r\n      //     Object(refEntity_2.current?.state).x = 0\r\n      //     Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n\r\n      //   if(Object(refEntity_3.current?.state).x === 0) {\r\n      //     Object(refEntity_3.current?.state).x = 0\r\n      //     Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n\r\n      //   if(Object(refEntity_4.current?.state).x === 0) {\r\n      //     Object(refEntity_4.current?.state).x = 0\r\n      //     Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n      //   }\r\n      // } else if(_index === 1) {\r\n      //   let moveIndex = 0\r\n      //   if(Object(refEntity_0.current?.state).x === 0) {\r\n      //     Object(refEntity_0.current?.state).x = 0\r\n      //     Object(refEntity_0.current?.state).y = (0)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n      //   if(Object(refEntity_1.current?.state).x < 0) {\r\n      //     Object(refEntity_1.current?.state).x = 0\r\n      //     Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n\r\n      //   if(Object(refEntity_2.current?.state).x === 0) {\r\n      //     Object(refEntity_2.current?.state).x = 0\r\n      //     Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n\r\n      //   if(Object(refEntity_3.current?.state).x === 0) {\r\n      //     Object(refEntity_3.current?.state).x = 0\r\n      //     Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n      //   if(Object(refEntity_4.current?.state).x === 0) {\r\n      //     Object(refEntity_4.current?.state).x = 0\r\n      //     Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n      //   }\r\n      // } else if(_index === 2) {\r\n      //   let moveIndex = 0\r\n      //   if(Object(refEntity_0.current?.state).x === 0) {\r\n      //     Object(refEntity_0.current?.state).x = 0\r\n      //     Object(refEntity_0.current?.state).y = (0)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n      //   if(Object(refEntity_1.current?.state).x === 0) {\r\n      //     Object(refEntity_1.current?.state).x = 0\r\n      //     Object(refEntity_1.current?.state).y = (moveIndex * -51)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n\r\n      //   if(Object(refEntity_2.current?.state).x < 0) {\r\n      //     Object(refEntity_2.current?.state).x = 0\r\n      //     Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n\r\n      //   if(Object(refEntity_3.current?.state).x === 0) {\r\n      //     Object(refEntity_3.current?.state).x = 0\r\n      //     Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n      //   if(Object(refEntity_4.current?.state).x === 0) {\r\n      //     Object(refEntity_4.current?.state).x = 0\r\n      //     Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n      //   }\r\n      // } else if(_index === 3) {\r\n      //   let moveIndex = 0\r\n      //   if(Object(refEntity_0.current?.state).x === 0) {\r\n      //     Object(refEntity_0.current?.state).x = 0\r\n      //     Object(refEntity_0.current?.state).y = (0)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n      //   if(Object(refEntity_1.current?.state).x === 0) {\r\n      //     Object(refEntity_1.current?.state).x = 0\r\n      //     Object(refEntity_1.current?.state).y = (0)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n\r\n      //   if(Object(refEntity_2.current?.state).x === 0) {\r\n      //     Object(refEntity_2.current?.state).x = 0\r\n      //     Object(refEntity_2.current?.state).y = (moveIndex * -51)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n\r\n      //   if(Object(refEntity_3.current?.state).x < 0) {\r\n      //     Object(refEntity_3.current?.state).x = 0\r\n      //     Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n      //   if(Object(refEntity_4.current?.state).x === 0) {\r\n      //     Object(refEntity_4.current?.state).x = 0\r\n      //     Object(refEntity_4.current?.state).y = (0)\r\n      //   }\r\n      // } else if(_index === 4) {\r\n      //   let moveIndex = 0\r\n      //   if(Object(refEntity_0.current?.state).x === 0) {\r\n      //     Object(refEntity_0.current?.state).x = 0\r\n      //     Object(refEntity_0.current?.state).y = (0)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n      //   if(Object(refEntity_1.current?.state).x === 0) {\r\n      //     Object(refEntity_1.current?.state).x = 0\r\n      //     Object(refEntity_1.current?.state).y = (0)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n\r\n      //   if(Object(refEntity_2.current?.state).x === 0) {\r\n      //     Object(refEntity_2.current?.state).x = 0\r\n      //     Object(refEntity_2.current?.state).y = (0)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n\r\n      //   if(Object(refEntity_3.current?.state).x === 0) {\r\n      //     Object(refEntity_3.current?.state).x = 0\r\n      //     Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n      //   } else {\r\n      //     moveIndex = moveIndex + 1\r\n      //   }\r\n      //   if(Object(refEntity_4.current?.state).x < 0) {\r\n      //     Object(refEntity_4.current?.state).x = 0\r\n      //     Object(refEntity_4.current?.state).y = (moveIndex * -51)\r\n      //   }\r\n      // }\r\n\r\n      ///////////////////////////////////////////////////////\r\n      _menuPos = -2\r\n      //setPosition({x:0, y:0})\r\n      setAble(false)\r\n    }\r\n  }\r\n\r\n//console.log(able, \" able\")\r\n\r\n//////////////////////////////////////////\r\n\r\n// let timer = 0\r\n// let delay = 200;\r\n// let prevent = false;\r\n\r\n\r\n// function onSingleClickHandler() {\r\n//   timer = window.setTimeout(() => {\r\n//     if (!prevent) {\r\n//       console.log(\"single click\")\r\n//     }\r\n//   }, delay);\r\n// };\r\n// function onDoubleClickHandler(){\r\n//   clearTimeout(timer);\r\n//   prevent = true;\r\n//   setTimeout(() => {\r\n//     prevent = false;\r\n//     //console.log(\"double click\")\r\n\r\n//   }, delay);\r\n// };\r\n//////////////////////////////////////////\r\nfunction ResetAppsPanel(index:number, _type:string) {\r\n  if(index === 0) {\r\n    let moveIndex = 0\r\n    if(Object(refEntity_0.current?.state).x < 0) {\r\n      Object(refEntity_0.current?.state).x = 0\r\n      Object(refEntity_0.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_1.current?.state).x === 0) {\r\n      Object(refEntity_1.current?.state).x = 0\r\n      Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * 51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_2.current?.state).x === 0) {\r\n      Object(refEntity_2.current?.state).x = 0\r\n      Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_3.current?.state).x === 0) {\r\n      Object(refEntity_3.current?.state).x = 0\r\n      Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_4.current?.state).x === 0) {\r\n      Object(refEntity_4.current?.state).x = 0\r\n      Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_5.current?.state).x === 0) {\r\n      Object(refEntity_5.current?.state).x = 0\r\n      Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_6.current?.state).x === 0) {\r\n      Object(refEntity_6.current?.state).x = 0\r\n      Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    }\r\n\r\n  } else if(index === 1) {\r\n    let moveIndex = 0\r\n    if(Object(refEntity_0.current?.state).x === 0) {\r\n      Object(refEntity_0.current?.state).x = 0\r\n      Object(refEntity_0.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_1.current?.state).x < 0) {\r\n      Object(refEntity_1.current?.state).x = 0\r\n      Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_2.current?.state).x === 0) {\r\n      Object(refEntity_2.current?.state).x = 0\r\n      Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_3.current?.state).x === 0) {\r\n      Object(refEntity_3.current?.state).x = 0\r\n      Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_4.current?.state).x === 0) {\r\n      Object(refEntity_4.current?.state).x = 0\r\n      Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_5.current?.state).x === 0) {\r\n      Object(refEntity_5.current?.state).x = 0\r\n      Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_6.current?.state).x === 0) {\r\n      Object(refEntity_6.current?.state).x = 0\r\n      Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    }\r\n\r\n  } else if(index === 2) {\r\n    let moveIndex = 0\r\n    if(Object(refEntity_0.current?.state).x === 0) {\r\n      Object(refEntity_0.current?.state).x = 0\r\n      Object(refEntity_0.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_1.current?.state).x === 0) {\r\n      Object(refEntity_1.current?.state).x = 0\r\n      Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_2.current?.state).x < 0) {\r\n      Object(refEntity_2.current?.state).x = 0\r\n      Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_3.current?.state).x === 0) {\r\n      Object(refEntity_3.current?.state).x = 0\r\n      Object(refEntity_3.current?.state).y = (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_4.current?.state).x === 0) {\r\n      Object(refEntity_4.current?.state).x = 0\r\n      Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_5.current?.state).x === 0) {\r\n      Object(refEntity_5.current?.state).x = 0\r\n      Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_6.current?.state).x === 0) {\r\n      Object(refEntity_6.current?.state).x = 0\r\n      Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    }\r\n\r\n  } else if(index === 3) {\r\n    let moveIndex = 0\r\n    if(Object(refEntity_0.current?.state).x === 0) {\r\n      Object(refEntity_0.current?.state).x = 0\r\n      Object(refEntity_0.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_1.current?.state).x === 0) {\r\n      Object(refEntity_1.current?.state).x = 0\r\n      Object(refEntity_1.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_2.current?.state).x === 0) {\r\n      Object(refEntity_2.current?.state).x = 0\r\n      Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_3.current?.state).x < 0) {\r\n      Object(refEntity_3.current?.state).x = 0\r\n      Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_4.current?.state).x === 0) {\r\n      Object(refEntity_4.current?.state).x = 0\r\n      Object(refEntity_4.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_5.current?.state).x === 0) {\r\n      Object(refEntity_5.current?.state).x = 0\r\n      Object(refEntity_5.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_6.current?.state).x === 0) {\r\n      Object(refEntity_6.current?.state).x = 0\r\n      Object(refEntity_6.current?.state).y = (0)\r\n    }\r\n  } else if(index === 4) {\r\n    let moveIndex = 0\r\n    if(Object(refEntity_0.current?.state).x === 0) {\r\n      Object(refEntity_0.current?.state).x = 0\r\n      Object(refEntity_0.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_1.current?.state).x === 0) {\r\n      Object(refEntity_1.current?.state).x = 0\r\n      Object(refEntity_1.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_2.current?.state).x === 0) {\r\n      Object(refEntity_2.current?.state).x = 0\r\n      Object(refEntity_2.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_3.current?.state).x === 0) {\r\n      Object(refEntity_3.current?.state).x = 0\r\n      Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_4.current?.state).x < 0) {\r\n      Object(refEntity_4.current?.state).x = 0\r\n      Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_5.current?.state).x === 0) {\r\n      Object(refEntity_5.current?.state).x = 0\r\n      Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_6.current?.state).x === 0) {\r\n      Object(refEntity_6.current?.state).x = 0\r\n      Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    }\r\n  } else if(index === 5) {\r\n    let moveIndex = 0\r\n    if(Object(refEntity_0.current?.state).x === 0) {\r\n      Object(refEntity_0.current?.state).x = 0\r\n      Object(refEntity_0.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_1.current?.state).x === 0) {\r\n      Object(refEntity_1.current?.state).x = 0\r\n      Object(refEntity_1.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_2.current?.state).x === 0) {\r\n      Object(refEntity_2.current?.state).x = 0\r\n      Object(refEntity_2.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_3.current?.state).x === 0) {\r\n      Object(refEntity_3.current?.state).x = 0\r\n      Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_4.current?.state).x === 0) {\r\n      Object(refEntity_4.current?.state).x = 0\r\n      Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_5.current?.state).x < 0) {\r\n      Object(refEntity_5.current?.state).x = 0\r\n      Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_6.current?.state).x === 0) {\r\n      Object(refEntity_6.current?.state).x = 0\r\n      Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    }\r\n  } else if(index === 6) {\r\n    let moveIndex = 0\r\n    if(Object(refEntity_0.current?.state).x === 0) {\r\n      Object(refEntity_0.current?.state).x = 0\r\n      Object(refEntity_0.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_1.current?.state).x === 0) {\r\n      Object(refEntity_1.current?.state).x = 0\r\n      Object(refEntity_1.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_2.current?.state).x === 0) {\r\n      Object(refEntity_2.current?.state).x = 0\r\n      Object(refEntity_2.current?.state).y = (0)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n\r\n    if(Object(refEntity_3.current?.state).x === 0) {\r\n      Object(refEntity_3.current?.state).x = 0\r\n      Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_4.current?.state).x === 0) {\r\n      Object(refEntity_4.current?.state).x = 0\r\n      Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_5.current?.state).x === 0) {\r\n      Object(refEntity_5.current?.state).x = 0\r\n      Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    } else {\r\n      moveIndex = moveIndex + 1\r\n    }\r\n    if(Object(refEntity_6.current?.state).x < 0) {\r\n      Object(refEntity_6.current?.state).x = 0\r\n      Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n    }\r\n  }\r\n  _menuPos = -2\r\n  setPosition({x:0, y:0})\r\n  setActiveTabIndex(-1)\r\n  setMenuType(_type)\r\n}\r\n//////////////////////////////////////////\r\nlet clicks:any = [];\r\nlet timeout:any;\r\n// Single & Double Click\r\nfunction singleClick(event:any, tabType:string, tabURL:string, tabIndex:number) {\r\n  //alert(tabType);\r\n  if((position.x < 0 || position.x > 0) && activeTabIndex === tabIndex) {return}\r\n    press = true;\r\n    if(able === true) {\r\n      if(menuType === tabType) {\r\n        setAble(false)\r\n      }\r\n    } else\r\n    if(able === false) {\r\n      setAble(true)\r\n    }\r\n    setMenuType(tabType)\r\n    setActiveTabIndex(tabIndex)\r\n}\r\n\r\nfunction doubleClick(event:any, tabType:string, tabURL:string, tabIndex:number) {\r\n  //alert(tabType);\r\n  if(tabIndex === 0 && (tabType === 'chat' || tabType === 'content')) {\r\n    if(Object(refEntity_0.current?.state).x < 0 || Object(refEntity_0.current?.state).x > 0) {return}\r\n    Object(refEntity_0.current?.state).x = -Math.floor(Math.random() * (stores.map.screenSize[0] - 500 + 1) + 500) //Math.random() * -(stores.map.screenSize[0])\r\n    Object(refEntity_0.current?.state).y = Math.floor(Math.random() * (150 - 50 + 1) + 50) + (tabIndex * -25)\r\n  } else if(tabIndex === 1 && (tabType === 'chat' || tabType === 'content')) {\r\n    if(Object(refEntity_1.current?.state).x < 0 || Object(refEntity_1.current?.state).x > 0) {return}\r\n    Object(refEntity_1.current?.state).x = -Math.floor(Math.random() * (stores.map.screenSize[0] - 500 + 1) + 500) //Math.random() * -(stores.map.screenSize[0])\r\n    Object(refEntity_1.current?.state).y = Math.floor(Math.random() * (150 - 50 + 1) + 50) + (tabIndex * -25)\r\n  } else if(tabIndex === 2 && (tabType === 'chat' || tabType === 'content')) {\r\n    if(Object(refEntity_2.current?.state).x < 0 || Object(refEntity_2.current?.state).x > 0) {return}\r\n    Object(refEntity_2.current?.state).x = -Math.floor(Math.random() * (stores.map.screenSize[0] - 500 + 1) + 500) //Math.random() * -(stores.map.screenSize[0])\r\n    Object(refEntity_2.current?.state).y = Math.floor(Math.random() * (150 - 50 + 1) + 50) + (tabIndex * -25)\r\n  } else if(tabIndex === 3 && (tabType === 'chat' || tabType === 'content')) {\r\n    if(Object(refEntity_3.current?.state).x < 0 || Object(refEntity_3.current?.state).x > 0) {return}\r\n    Object(refEntity_3.current?.state).x = -Math.floor(Math.random() * (stores.map.screenSize[0] - 500 + 1) + 500) //Math.random() * -(stores.map.screenSize[0] + 400)/2\r\n    Object(refEntity_3.current?.state).y = Math.floor(Math.random() * (150 - 50 + 1) + 50) + (tabIndex * -25)\r\n  } else if(tabIndex === 4 && (tabType === 'chat' || tabType === 'content')) {\r\n    if(Object(refEntity_4.current?.state).x < 0 || Object(refEntity_4.current?.state).x > 0) {return}\r\n    Object(refEntity_4.current?.state).x = -Math.floor(Math.random() * (stores.map.screenSize[0] - 500 + 1) + 500) //Math.random() * -(stores.map.screenSize[0] + 400)/2\r\n    Object(refEntity_4.current?.state).y = Math.floor(Math.random() * (150 - 50 + 1) + 50) + (tabIndex * -25)\r\n  } else if(tabIndex === 5 && (tabType === 'chat' || tabType === 'content')) {\r\n    if(Object(refEntity_5.current?.state).x < 0 || Object(refEntity_5.current?.state).x > 0) {return}\r\n    Object(refEntity_5.current?.state).x = -Math.floor(Math.random() * (stores.map.screenSize[0] - 500 + 1) + 500) //Math.random() * -(stores.map.screenSize[0] + 400)/2\r\n    Object(refEntity_5.current?.state).y = Math.floor(Math.random() * (150 - 50 + 1) + 50) + (tabIndex * -25) //(120)\r\n  } else if(tabIndex === 6 && (tabType === 'chat' || tabType === 'content')) {\r\n    if(Object(refEntity_6.current?.state).x < 0 || Object(refEntity_6.current?.state).x > 0) {return}\r\n    Object(refEntity_6.current?.state).x = -Math.floor(Math.random() * (stores.map.screenSize[0] - 500 + 1) + 500) //Math.random() * -(stores.map.screenSize[0] + 400)/2\r\n    Object(refEntity_6.current?.state).y = Math.floor(Math.random() * (150 - 50 + 1) + 50) + (tabIndex * -25)\r\n  } else {\r\n    if(tabIndex === 0) {\r\n      if(Object(refEntity_0.current?.state).x < 0 || Object(refEntity_0.current?.state).x > 0) {return}\r\n      Object(refEntity_0.current?.state).x = -99999999\r\n    } else if(tabIndex === 1) {\r\n      if(Object(refEntity_1.current?.state).x < 0 || Object(refEntity_1.current?.state).x > 0) {return}\r\n      Object(refEntity_1.current?.state).x = -99999999\r\n    } else if(tabIndex === 2) {\r\n      if(Object(refEntity_2.current?.state).x < 0 || Object(refEntity_2.current?.state).x > 0) {return}\r\n      Object(refEntity_2.current?.state).x = -99999999\r\n    } else if(tabIndex === 3) {\r\n      if(Object(refEntity_3.current?.state).x < 0 || Object(refEntity_3.current?.state).x > 0) {return}\r\n      Object(refEntity_3.current?.state).x = -99999999\r\n    } else if(tabIndex === 4) {\r\n      if(Object(refEntity_4.current?.state).x < 0 || Object(refEntity_4.current?.state).x > 0) {return}\r\n      Object(refEntity_4.current?.state).x = -99999999\r\n    } else if(tabIndex === 5) {\r\n      if(Object(refEntity_5.current?.state).x < 0 || Object(refEntity_5.current?.state).x > 0) {return}\r\n      Object(refEntity_5.current?.state).x = -99999999\r\n    } else if(tabIndex === 6) {\r\n      if(Object(refEntity_6.current?.state).x < 0 || Object(refEntity_6.current?.state).x > 0) {return}\r\n      Object(refEntity_6.current?.state).x = -99999999\r\n    }\r\n\r\n    ///////////////////////////////////////////////////////\r\n    //window.open(_url, \"_new\")\r\n    let externalWindow = window.open(tabURL, '', 'width=400,height=650,left=500,top=100');\r\n    var timer = setInterval(function() {\r\n      if(externalWindow?.closed) {\r\n          clearInterval(timer);\r\n          //alert(_index);\r\n          //////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n          //CheckAndSetPosition(_index)\r\n          if(tabIndex === 0) {\r\n            let moveIndex = 0\r\n            if(Object(refEntity_0.current?.state).x < 0 || Object(refEntity_0.current?.state).x > 0) {\r\n              Object(refEntity_0.current?.state).x = 0\r\n              Object(refEntity_0.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_1.current?.state).x === 0) {\r\n              Object(refEntity_1.current?.state).x = 0\r\n              Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_2.current?.state).x === 0) {\r\n              Object(refEntity_2.current?.state).x = 0\r\n              Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_3.current?.state).x === 0) {\r\n              Object(refEntity_3.current?.state).x = 0\r\n              Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_4.current?.state).x === 0) {\r\n              Object(refEntity_4.current?.state).x = 0\r\n              Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_5.current?.state).x === 0) {\r\n              Object(refEntity_5.current?.state).x = 0\r\n              Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_6.current?.state).x === 0) {\r\n              Object(refEntity_6.current?.state).x = 0\r\n              Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            }\r\n          } else if(tabIndex === 1) {\r\n            let moveIndex = 0\r\n            if(Object(refEntity_0.current?.state).x === 0) {\r\n              Object(refEntity_0.current?.state).x = 0\r\n              Object(refEntity_0.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_1.current?.state).x < 0 || Object(refEntity_1.current?.state).x > 0) {\r\n              Object(refEntity_1.current?.state).x = 0\r\n              Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_2.current?.state).x === 0) {\r\n              Object(refEntity_2.current?.state).x = 0\r\n              Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_3.current?.state).x === 0) {\r\n              Object(refEntity_3.current?.state).x = 0\r\n              Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_4.current?.state).x === 0) {\r\n              Object(refEntity_4.current?.state).x = 0\r\n              Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_5.current?.state).x === 0) {\r\n              Object(refEntity_5.current?.state).x = 0\r\n              Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_6.current?.state).x === 0) {\r\n              Object(refEntity_6.current?.state).x = 0\r\n              Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            }\r\n          } else if(tabIndex === 2) {\r\n            let moveIndex = 0\r\n            if(Object(refEntity_0.current?.state).x === 0) {\r\n              Object(refEntity_0.current?.state).x = 0\r\n              Object(refEntity_0.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_1.current?.state).x === 0) {\r\n              Object(refEntity_1.current?.state).x = 0\r\n              Object(refEntity_1.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_2.current?.state).x < 0 || Object(refEntity_2.current?.state).x > 0) {\r\n              Object(refEntity_2.current?.state).x = 0\r\n              Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_3.current?.state).x === 0) {\r\n              Object(refEntity_3.current?.state).x = 0\r\n              Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_4.current?.state).x === 0) {\r\n              Object(refEntity_4.current?.state).x = 0\r\n              Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_5.current?.state).x === 0) {\r\n              Object(refEntity_5.current?.state).x = 0\r\n              Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_6.current?.state).x === 0) {\r\n              Object(refEntity_6.current?.state).x = 0\r\n              Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            }\r\n          } else if(tabIndex === 3) {\r\n            let moveIndex = 0\r\n            if(Object(refEntity_0.current?.state).x === 0) {\r\n              Object(refEntity_0.current?.state).x = 0\r\n              Object(refEntity_0.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_1.current?.state).x === 0) {\r\n              Object(refEntity_1.current?.state).x = 0\r\n              Object(refEntity_1.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_2.current?.state).x === 0) {\r\n              Object(refEntity_2.current?.state).x = 0\r\n              Object(refEntity_2.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_3.current?.state).x < 0 || Object(refEntity_3.current?.state).x > 0) {\r\n              Object(refEntity_3.current?.state).x = 0\r\n              Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_4.current?.state).x === 0) {\r\n              Object(refEntity_4.current?.state).x = 0\r\n              Object(refEntity_4.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_5.current?.state).x === 0) {\r\n              Object(refEntity_5.current?.state).x = 0\r\n              Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_6.current?.state).x === 0) {\r\n              Object(refEntity_6.current?.state).x = 0\r\n              Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            }\r\n          } else if(tabIndex === 4) {\r\n            let moveIndex = 0\r\n            if(Object(refEntity_0.current?.state).x === 0) {\r\n              Object(refEntity_0.current?.state).x = 0\r\n              Object(refEntity_0.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_1.current?.state).x === 0) {\r\n              Object(refEntity_1.current?.state).x = 0\r\n              Object(refEntity_1.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_2.current?.state).x === 0) {\r\n              Object(refEntity_2.current?.state).x = 0\r\n              Object(refEntity_2.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_3.current?.state).x === 0) {\r\n              Object(refEntity_3.current?.state).x = 0\r\n              Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_4.current?.state).x < 0 || Object(refEntity_4.current?.state).x > 0) {\r\n              Object(refEntity_4.current?.state).x = 0\r\n              Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_5.current?.state).x === 0) {\r\n              Object(refEntity_5.current?.state).x = 0\r\n              Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_6.current?.state).x === 0) {\r\n              Object(refEntity_6.current?.state).x = 0\r\n              Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            }\r\n          } else if(tabIndex === 5) {\r\n            let moveIndex = 0\r\n            if(Object(refEntity_0.current?.state).x === 0) {\r\n              Object(refEntity_0.current?.state).x = 0\r\n              Object(refEntity_0.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_1.current?.state).x === 0) {\r\n              Object(refEntity_1.current?.state).x = 0\r\n              Object(refEntity_1.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_2.current?.state).x === 0) {\r\n              Object(refEntity_2.current?.state).x = 0\r\n              Object(refEntity_2.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_3.current?.state).x === 0) {\r\n              Object(refEntity_3.current?.state).x = 0\r\n              Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_4.current?.state).x === 0) {\r\n              Object(refEntity_4.current?.state).x = 0\r\n              Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_5.current?.state).x < 0  || Object(refEntity_5.current?.state).x > 0) {\r\n              Object(refEntity_5.current?.state).x = 0\r\n              Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_6.current?.state).x === 0) {\r\n              Object(refEntity_6.current?.state).x = 0\r\n              Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            }\r\n          } else if(tabIndex === 6) {\r\n            let moveIndex = 0\r\n            if(Object(refEntity_0.current?.state).x === 0) {\r\n              Object(refEntity_0.current?.state).x = 0\r\n              Object(refEntity_0.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_1.current?.state).x === 0) {\r\n              Object(refEntity_1.current?.state).x = 0\r\n              Object(refEntity_1.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_2.current?.state).x === 0) {\r\n              Object(refEntity_2.current?.state).x = 0\r\n              Object(refEntity_2.current?.state).y = (0)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n\r\n            if(Object(refEntity_3.current?.state).x === 0) {\r\n              Object(refEntity_3.current?.state).x = 0\r\n              Object(refEntity_3.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_4.current?.state).x === 0) {\r\n              Object(refEntity_4.current?.state).x = 0\r\n              Object(refEntity_4.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_5.current?.state).x === 0) {\r\n              Object(refEntity_5.current?.state).x = 0\r\n              Object(refEntity_5.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            } else {\r\n              moveIndex = moveIndex + 1\r\n            }\r\n            if(Object(refEntity_6.current?.state).x < 0  || Object(refEntity_5.current?.state).x > 0) {\r\n              Object(refEntity_6.current?.state).x = 0\r\n              Object(refEntity_6.current?.state).y = isSmartphone() ? (moveIndex * -121) : (moveIndex * -51)\r\n            }\r\n          }\r\n          //////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n          _menuPos = -2\r\n          setPosition({x:0, y:0})\r\n          setMenuType(tabType)\r\n      }\r\n  }, 100);\r\n    ///////////////////////////////////////////////////////\r\n    //_menuPos = -2\r\n    //setAble(false)\r\n  }\r\n\r\n  //_menuPos = -(stores.map.screenSize[0]/2)\r\n  CheckAndSetPosition(tabIndex)\r\n\r\n  // When double click\r\n  CheckAndActivateMenu(tabIndex)\r\n\r\n  setActiveTabIndex(tabIndex)\r\n\r\n  // Enable When needed\r\n  setAble(false)\r\n}\r\n\r\nfunction onTabMenuClick(event:any, _type:string, _url:string, _index:number) {\r\n  event.preventDefault();\r\n  clicks.push(new Date().getTime());\r\n  window.clearTimeout(timeout);\r\n  timeout = window.setTimeout(() => {\r\n      if (clicks.length > 1 && clicks[clicks.length - 1] - clicks[clicks.length - 2] < 250) {\r\n          doubleClick(event.target, _type, _url, _index);\r\n      } else {\r\n          singleClick(event.target, _type, _url, _index);\r\n      }\r\n  }, 250);\r\n}\r\n\r\n//////////////////////////////////////////\r\n\r\n  return <Observer>{()=>{\r\n    return <div ref={refDiv} className={classes.back} style={{backgroundColor: '#0f5c81'}}>\r\n        <SplitPane pane2Style={able === true ? {display: 'block', backgroundColor: menuType === 'chat' ? '#0f5c81' : menuType === 'content' ? '#8b5e3c' : menuType !== 'blank' ? activeBgColor : 'white', boxShadow: menuType !== 'blank' ? '5px 10px 10px 3px black' : '5px 10px 10px 3px white'} : {display: 'none', backgroundColor: '#FFF'}} className={classes.fill} split=\"vertical\"\r\n          minSize={0} defaultSize={able === true ? isSmartphone() ? '40%' : (_menuType !== 'chat' && _menuType !== 'content') ? \"73%\" : '73%' : \"100%\"}>\r\n\r\n          <Fragment>\r\n            <MainScreen showAllTracks = {DEBUG_VIDEO} stores={stores} />\r\n            <Observer>{() => <Map transparent={sharedContentsStore.mainScreenStream !== undefined\r\n             || DEBUG_VIDEO} stores={stores} />\r\n            }</Observer>\r\n\r\n\r\n\r\n\r\n\r\n            <Draggable bounds={{top: (0 * -51), left: -(stores.map.screenSize[0] - 40), right: -40, bottom: (stores.map.screenSize[1] - (50 + (0 * 51)))}}ref={refEntity_0} key={0} onDrag={(e, data) => trackPos(data, 0, 'chat')} onStop={(e, data) => setTrack(data, '', 0)} defaultPosition={{x: 0, y: 0}}>\r\n\r\n            <div style={{position:'absolute', right:able ? '0%' : '0%', top:isSmartphone() ? tabBGTopBGMob + (0 * 119) : tabBGTopBGWeb + (0*51), borderRadius: '5px', display:'flex', zIndex:showIntro ? 0 : menuType === 'chat' ? 19 : (activeTabIndex === 0) ? 19 : (18 - (0+2)), height:'100%'}}>\r\n            <div  style={{position:'absolute', right:able ? '0%' : '0%', top:'0px', borderRadius: '5px', display:'flex', zIndex:showIntro ? 0 : menuType === 'chat' ? 19 : (18 - (0+2))}}\r\n            ////////////////////////////////////////////////////////////////////\r\n              onClick={(e) => {\r\n                // handling single & double click\r\n                onTabMenuClick(e, 'chat', '', 0)\r\n              }}\r\n              onTouchEnd={(e) => {\r\n                  onTabMenuClick(e, 'chat', '', 0)\r\n                }}\r\n              >\r\n\r\n                <img src={tabCollapseChat} style={{width:isSmartphone() ? 120 : 50, height:'auto', position:'relative', top:'0px', left:isSmartphone() ? '1px' : '1px', userSelect:'none', zIndex:showIntro ? 0 : menuType === 'chat' ? 19 : (18 - (0+2))}} draggable={false} alt='' />\r\n                <img src={tabChatActive} style={{width:isSmartphone() ? 120 : 50, height:isSmartphone() ? 120 : 50, color:'white', position:'absolute', top:'2px', left:isSmartphone() ? '10px' : '5px' , userSelect:'none', zIndex:showIntro ? 0 : 99}} draggable={false} alt='' />\r\n              </div>\r\n\r\n              <div style={{position: 'absolute', width:'405px', height:'70%', left:'0px' backgroundColor:'#0f5c81', borderRadius:'2px', minWidth:'280px', top:'0px',\r\n              display:((Object(refEntity_0.current?.state).x < 0 || Object(refEntity_0.current?.state).x > 0)) ? 'block' : 'none' , zIndex:-9999}}>\r\n              <CloseTabIcon style={{width:'40px', height:'50px', position:'absolute', right:'25px', color:'white', padding:isSmartphone() ? '10px' : '1px', transform:isSmartphone() ? 'scale(2)' : 'scale(1)', zIndex:9999}}\r\n                onClick={() => {\r\n                  ResetAppsPanel(0, 'chat')\r\n                }}\r\n                onTouchEnd={() => {\r\n                  ResetAppsPanel(0, 'chat')\r\n                }}\r\n              />\r\n                <LeftBar stores={stores} type={'chat'}/>\r\n              </div>\r\n              </div>\r\n            </Draggable>\r\n\r\n\r\n\r\n\r\n             <Draggable bounds={{top: (1 * -51), left: -(stores.map.screenSize[0] - 40), right: -40, bottom: (stores.map.screenSize[1] - (50 + (1 * 51)))}}ref={refEntity_1} key={1} onDrag={(e, data) => trackPos(data, 1, 'content')} onStop={(e, data) => setTrack(data, '', 1)} defaultPosition={{x: 0, y: 0}}>\r\n\r\n            <div style={{position:'absolute', right:able ? '0%' : '0%', top:isSmartphone() ? tabBGTopBGMob + (1 * 119) : tabBGTopBGWeb + (1*51), borderRadius: '5px', display:'flex', zIndex:showIntro ? 0 : menuType === 'content' ? 19 : (activeTabIndex === 1) ? 19 : (18 - (1+2)), height:'100%'}}>\r\n            <div  style={{position:'absolute', right:able ? '0%' : '0%', top:'0px', borderRadius: '5px', display:'flex', zIndex:showIntro ? 0 : menuType === 'content' ? 19 : (18 - (1+2))}}\r\n              onClick={(e) => {\r\n                // handling single & double click\r\n                onTabMenuClick(e, 'content', '', 1)\r\n              }}\r\n              onTouchEnd={(e) => {\r\n                onTabMenuClick(e, 'content', '', 1)\r\n              }}\r\n              >\r\n\r\n                <img src={tabCollapseContent} style={{width:isSmartphone() ? 120 : 50, height:'auto', position:'relative', top:'0px', left:isSmartphone() ? '1px' : '1px', userSelect:'none', zIndex:showIntro ? 0 : menuType === 'content' ? 19 : (18 - (1+2))}} draggable={false} alt='' />\r\n                <img src={tabContentActive} style={{width:isSmartphone() ? 120 : 50, height:isSmartphone() ? 120 : 50, color:'white', position:'absolute', top:'2px', left:isSmartphone() ? '10px' : '5px' , userSelect:'none', zIndex:showIntro ? 0 : 99}} draggable={false} alt='' />\r\n              </div>\r\n\r\n              <div style={{position: 'absolute', width:'405px', height:'70%', left:'0px', backgroundColor:'#8b5e3c', borderRadius:'2px', minWidth:'280px', top:'0px',\r\n              display:((Object(refEntity_1.current?.state).x < 0 || Object(refEntity_1.current?.state).x > 0)) ? 'block' : 'none' , zIndex:-9999}}>\r\n              <CloseTabIcon style={{width:'40px', height:'50px', position:'absolute', right:'25px', color:'white', padding:isSmartphone() ? '10px' : '1px', transform:isSmartphone() ? 'scale(2)' : 'scale(1)', zIndex:9999}}\r\n                onClick={() => {\r\n                  ResetAppsPanel(1, 'content')\r\n                }}\r\n                onTouchEnd={() => {\r\n                  ResetAppsPanel(1, 'content')\r\n                }}\r\n              />\r\n                <LeftBar stores={stores} type={'content'}/>\r\n              </div>\r\n              </div>\r\n            </Draggable>\r\n\r\n\r\n             <>\r\n            { cContent.filter(item => item.shareType === \"appimg\").map((content, index) => (\r\n              <Draggable bounds={content.url === '' ? {top: ((index+2) * -51), left: -(stores.map.screenSize[0] - 40), right: -40, bottom: (stores.map.screenSize[1] - (50 + ((index+2) * 51)))} : {}}\r\n\r\n              ref={(index+2) === 2 ? refEntity_2 : index === 3 ? refEntity_3 : index === 4 ? refEntity_4 : index === 5 ? refEntity_5 : index === 6 ? refEntity_6 : index === 7 ? refEntity_7 : refEntity_8}\r\n\r\n              key={(index+2)} onDrag={(e, data) => trackPos(data, (index+2), content.type)} onStop={(e, data) => setTrack(data, content.url, (index+2))} defaultPosition={{x: 0, y: 0}}>\r\n\r\n                <div style={{position:'absolute', right:able ? '0%' : '0%', top:isSmartphone() ? tabBGTopBGMob + ((index+2) * 119) : tabBGTopBGWeb + ((index+2)*51), borderRadius: '5px', display:'flex', zIndex:showIntro ? 0 : menuType === content.type ? 19 : (activeTabIndex === (index+2)) ? 19 : (18 - ((index+2)+2)), height:'100%'}}>\r\n                <div  style={{position:'absolute', right:able ? '0%' : '0%', top:'0px', borderRadius: '5px', display:'flex', zIndex:showIntro ? 0 : menuType === content.type ? 19 : (18 - ((index+2)+2))}}\r\n                ////////////////////////////////////////////////////////////////////\r\n                  onClick={(e) => {\r\n                    // handling single & double click\r\n                    onTabMenuClick(e, content.type, content.url, (index+2))\r\n                  }}\r\n                  onTouchEnd={(e) => {\r\n                    onTabMenuClick(e, content.type, content.url, (index+2))\r\n                  }}\r\n                  ////////////////////////////////////////////////////////////////////\r\n                >\r\n                  <img src={content.baseImage} style={{width:isSmartphone() ? 120 : 50, height:'auto', position:'relative', top:'0px', left:isSmartphone() ? '1px' : '1px', userSelect:'none', zIndex:showIntro ? 0 : menuType === content.type ? 19 : (18 - ((index+2)+2))}} draggable={false} alt='' />\r\n                  <img src={content.baseIcon} style={{width:isSmartphone() ? 120 : 50, height:isSmartphone() ? 120 : 50, color:'white', position:'absolute', top:'2px', left:isSmartphone() ? '10px' : '5px' , userSelect:'none', zIndex:showIntro ? 0 : 99}} draggable={false} alt='' />\r\n                </div>\r\n\r\n                <div style={{position: 'absolute', width:'405px', height:'70%', left:'0px', backgroundColor:content.baseColor, borderRadius:'2px', minWidth:'280px', top:'0px',\r\n\r\n                display:((Object(refEntity_2.current?.state).x < 0 || Object(refEntity_2.current?.state).x > 0) && (index+2) === 2) ? 'block' : ((Object(refEntity_3.current?.state).x < 0 || Object(refEntity_3.current?.state).x > 0) && (index+2) === 3) ? 'block' : ((Object(refEntity_4.current?.state).x < 0 || Object(refEntity_4.current?.state).x > 0) && (index+2) === 4) ? 'block' : ((Object(refEntity_5.current?.state).x < 0 || Object(refEntity_5.current?.state).x > 0) && (index+2) === 5) ? 'block' : ((Object(refEntity_6.current?.state).x < 0 || Object(refEntity_6.current?.state).x > 0) && (index+2) === 6) ? 'block' : 'none'\r\n\r\n               , zIndex:-9999}}>\r\n                <CloseTabIcon style={{width:'40px', height:'50px', position:'absolute', right:'25px', color:'white', padding:isSmartphone() ? '10px' : '1px', transform:isSmartphone() ? 'scale(2)' : 'scale(1)', zIndex:9999}}\r\n                  onClick={() => {\r\n                    //console.log(\"Close Tab click\")\r\n                    //console.log(Object(refEntity.current?.state).x)\r\n                    ResetAppsPanel((index+2), content.type)\r\n                  }}\r\n                  onTouchEnd={() => {\r\n                    //console.log(\"Close Tab click\")\r\n                    //console.log(Object(refEntity.current?.state).x)\r\n                    ResetAppsPanel((index+2), content.type)\r\n\r\n                  }}\r\n                 />\r\n                  {}\r\n                <iframe src={content.url} title={content.type} allowTransparency={true} frameBorder={0} style={{width:'100%', height:'100%'}}></iframe>\r\n\r\n                </div>\r\n                </div>\r\n              </Draggable>\r\n\r\n             ))}\r\n             </>\r\n\r\n            <Footer stores={stores} height={(isSmartphone() && isPortrait()) ? 100 : undefined} />\r\n            <Emoticons stores={stores} height={(isSmartphone() && isPortrait()) ? 100 : undefined} />\r\n\r\n\r\n          </Fragment>\r\n          <div style={{display: (able === true ? \"block\" : \"none\"), minWidth:'280px', width:'100%', maxWidth:'280px'}}>\r\n            <LeftBar stores={stores} type={_menuType}/>\r\n          </div>\r\n        </SplitPane>\r\n        <div style={{width:'100%', height:'100%', alignItems:'center', justifyContent:'center', verticalAlign:'center',position:'absolute', backgroundColor: '#5f7ca0', textAlign:'center', display:showIntro ? 'block' : 'none'}}>\r\n        <p style={{textAlign:'right', color: 'white', position:'relative', right:'24.5px', top:'20px', fontSize: isSmartphone() ? '2.4em' : '1em'}}>Version 2.0.5</p>\r\n          <div style={{position:'relative', top:roomImgPath === '' ? '20%' : '0%'}}>\r\n          <p style={{textAlign:'center', color: 'white', fontSize:isSmartphone() ? '3em' : '1.2em'}}>Welcome To</p>\r\n          <p style={_roomName ? {textAlign:'center', color: 'white', marginTop:'-0.8em', fontSize:isSmartphone() ? '2.8em' : '1.2em', fontWeight:'bold', opacity: 1, transition: 'opacity 300ms'} : {textAlign:'center', color: 'white', marginTop:'-0.8em', fontSize:isSmartphone() ? '3em' : '1.2em', fontWeight:'bold', opacity: 0}}>{_roomName}</p>\r\n          <img src={roomImgPath} style={roomImgPath ? {height: '250px', transform: \"scale(1)\", opacity:1, transition: 'opacity 300ms, transform: 300ms', userSelect:'none'} : {height: '0px', transform: \"scale(0)\", opacity:0, transition: '0.3s ease-out', userSelect:'none'}} draggable={false} alt=\"\"/>\r\n          <p style={{textAlign:'center', color: '#cdcdcd', fontSize:isSmartphone() ? '2.8em' : '1em', overflow:'hidden', position:'relative', marginTop:'0.5em', width:'80%', marginLeft:'10%'}}>{roomImgDesc}</p>\r\n          <img style={{width:isSmartphone() ? '8em' : '4em', backgroundColor:'#00000020', borderRadius: '50%', position:'relative', marginTop:roomImgPath !== '' ? '20px' : '-15px', userSelect:'none'}} src={stores.participants.local.information.avatarSrc} draggable={false} alt=\"\" />\r\n        <p style={{textAlign:'center', color: 'black', marginTop:'0.5em', fontSize:isSmartphone() ? '3em' : '1.2em'}}>{stores.participants.local.information.name}</p>\r\n        <p style={{textAlign:'center', color: 'black', marginTop:'1.5em',fontSize:isSmartphone() ? '3em' : '1.2em'}}>Give your web browser permissions</p>\r\n        <p style={{textAlign:'center', color: 'black', marginTop:'-0.9em',fontSize:isSmartphone() ? '3em' : '1.2em'}}>to access the mic and camera if necessary.</p>\r\n        <img style={{width:isSmartphone() ? '18em' : '8em', position:'relative', userSelect:'none'}} src={logo_es} draggable={false} alt=\"\" />\r\n        </div>\r\n        </div>\r\n\r\n\r\n        <div ref={refAvatar} style={{position:'relative', width:'130px', height:'130px', maxWidth:'130px', zIndex:-999}}>\r\n          <div style={{position:'absolute', top:'0px', left:'0px'}}>\r\n            <img style={{display: selectedGroup !== '' ? 'block' : 'none'}} src={selectedGroup} width={'130px'} height={'130px'} draggable={false} alt='' />\r\n          </div>\r\n          <div style={{position:'absolute', top:'0px', left:'0px'}}>\r\n            <img style={{display: selectedHairBack !== '' ? 'block' : 'none'}} src={selectedHairBack} width={'130px'} height={'130px'} draggable={false} alt='' />\r\n          </div>\r\n          <div style={{position:'absolute', top:'0px', left:'0px'}}>\r\n            <img style={{display: selectedSkin !== '' ? 'block' : 'none'}} src={selectedSkin} width={'130px'} height={'130px'}  draggable={false} alt='' />\r\n          </div>\r\n          <div style={{position:'absolute', top:'0px', left:'0px'}}>\r\n            <img style={{display: selectedHair !== '' ? 'block' : 'none'}} src={selectedHair} width={'130px'} height={'130px'}  draggable={false}alt='' />\r\n          </div>\r\n          <div style={{position:'absolute', top:'-3px', left:'0px'}}>\r\n            <img style={{display: selectedOutfits !== '' ? 'block' : 'none'}} src={selectedOutfits} width={'130px'} height={'130px'} draggable={false} alt='' />\r\n          </div>\r\n          <div style={{position:'absolute', top:'0px', left:'0px'}}>\r\n            <img style={{display: selectedSpecs !== '' ? 'block' : 'none'}} src={selectedSpecs} width={'130px'} height={'130px'} draggable={false} alt='' />\r\n          </div>\r\n        </div>\r\n\r\n\r\n\r\n        <Dialog open={showHelp} onClose={() => setShowHelp(false)} onExited={() => setShowHelp(false)}\r\n        keepMounted\r\n        PaperProps={{\r\n          style: {\r\n            backgroundColor: 'white',\r\n            position:'relative',\r\n\r\n            overflow:'hidden',\r\n            borderRadius: '20px',\r\n            width: 300,\r\n            height: 350,\r\n            zIndex: 0,\r\n            left: '250px',\r\n            transform: isSmartphone() ? 'scale(1.5)' : 'scale(1)',\r\n          },\r\n        }}\r\n        BackdropProps={{ invisible: true }}\r\n        >\r\n        <DialogContent style={{overflow:'hidden'}}>\r\n          <div>\r\n            <div style={{position:'relative', left:'0px'}}>\r\n              <>\r\n              {\r\n                sliderData.map((slide, index) => {\r\n                  return (\r\n                    <div className={index === currentSlide ? classes.activeSlide : classes.slide} key={index}>\r\n                      {index === currentSlide && (\r\n                         <img src={slide} width={'250px'} height={'250px'} alt='' />\r\n                      )}\r\n\r\n                    </div>\r\n                  )\r\n                })\r\n              }\r\n              </>\r\n            </div>\r\n            <div style={{width:'100%', height:'1px', backgroundColor:'lightgrey', position:'relative', top:'5px'}}></div>\r\n            <div style={{display:'flex', position:'relative', top:'15px', width:'100%'}}>\r\n              <div onClick={() => onPrevClick()}>\r\n                <ArrowBackIosIcon className={classes.previous}  />\r\n              </div>\r\n              <div onClick={() => onNextClick()}>\r\n                <ArrowForwardIosIcon className={classes.next} />\r\n              </div>\r\n              <div style={{display:'flex', width:'80%', justifyContent:'center', position:'relative', top:'15px', left:'10%'}}>\r\n              {\r\n                sliderDots.map((slide, index) => {\r\n                  return (\r\n                    <div style={{position:'relative', width:'12px', height:'12px', borderRadius:'50%', backgroundColor: index === currentSlide ? 'green' : 'lightgray', alignItems:'center', margin:'3px'}} />\r\n                  )\r\n                })\r\n              }\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n      </div>\r\n  }}</Observer>\r\n}\r\nApp.displayName = 'App'\r\n */","import {BMProps} from '@components/utils'\r\nimport {makeStyles} from '@material-ui/core'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React, {useEffect, useRef, useState} from 'react'\r\n\r\nconst useStyles = makeStyles({\r\n  videoContainer: {\r\n    height: '100%',\r\n    width: '100%',\r\n    backgroundColor: 'none',\r\n  },\r\n  video:{\r\n    marginLeft: 'auto',\r\n    marginRight: 'auto',\r\n    display: 'block',\r\n    //  height: '100%',\r\n    width: '100%',\r\n  },\r\n})\r\n\r\nconst setStream = (\r\n  video: HTMLVideoElement,\r\n  stream: MediaStream | null,\r\n  ) => {\r\n  video.srcObject = stream\r\n  video.autoplay = true\r\n}\r\nexport interface MainScreenProps extends BMProps{\r\n  showAllTracks?:boolean\r\n}\r\n\r\nexport const MainScreen: React.FC<MainScreenProps> = (props) => {\r\n  const classes = useStyles()\r\n  const stream = useObserver(() => (props.stores.contents.mainScreenStream))\r\n  const videoRef = useRef<HTMLVideoElement>(null)\r\n  useEffect(\r\n    () => {\r\n      if (videoRef && videoRef.current) {\r\n        setStream(videoRef.current, stream ? stream : null)\r\n      }\r\n    },\r\n    [stream],\r\n  )\r\n  //  for showAllTracks (or DEBUG_VIDEO) ---------------------------------------\r\n  interface DebugVideo{\r\n    stream: MediaStream\r\n    label: string\r\n    color: string\r\n  }\r\n  const [debugVideos/* , setDebugVideos */] = useState<DebugVideo[]>()\r\n  const member = useRef<any>({})\r\n  member.current.debugVideos = debugVideos\r\n  const refs = useRef<React.RefObject<HTMLVideoElement>[]>([])\r\n\r\n  if (props.showAllTracks) {\r\n    while (refs.current.length < (debugVideos ? debugVideos.length : 0)) {\r\n      refs.current.push(React.createRef<HTMLVideoElement>())\r\n    }\r\n    refs.current.forEach((ref, idx) => {\r\n      if (ref.current && debugVideos && idx < debugVideos.length) {\r\n        setStream(ref.current, debugVideos[idx].stream)\r\n        //  console.log(`setStream for ${idx} ${ref.current}`)\r\n      }\r\n    })\r\n  }\r\n  useEffect(\r\n    () => {\r\n      if (member.current?.interval) {\r\n        clearInterval(member.current.interval)\r\n        member.current.interval = undefined\r\n      }\r\n    },\r\n    [props.showAllTracks],\r\n  )\r\n\r\n  const videos = (props.showAllTracks && debugVideos) ? debugVideos.map((debugVideo, idx) =>\r\n    <div key={idx} style={{display:'inline-block', position:'relative', verticalAlign:'top'}}>\r\n      <video style={{width:300}} ref={refs.current[idx]} />\r\n      <div style={{position:'absolute', left:0, top:0,\r\n        color:debugVideo.color, whiteSpace: 'pre-wrap'}}>\r\n        {debugVideo.label}\r\n      </div>\r\n    </div>,\r\n    ) : undefined\r\n  //  -----------------------------------------------------------------------\r\n\r\n  return (\r\n    <div className={classes.videoContainer} >\r\n      <video ref={videoRef} className={classes.video} style={{visibility : stream ? 'visible' : 'hidden'} } />\r\n      <div style={{position:'absolute', left:0, top:0}}>\r\n        {videos /* for DEBUG_VIDEO */}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\nMainScreen.displayName = 'MainScreen'\r\n","import {BMProps} from '@components/utils'\r\nimport {Tooltip} from '@material-ui/core'\r\nimport {ParticipantBase} from '@stores/participants/ParticipantBase'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React from 'react'\r\n\r\ninterface MouseCursorProps extends BMProps{\r\n  participantId: string\r\n}\r\n\r\n\r\nexport const MouseCursor: React.FC<MouseCursorProps> = (props:MouseCursorProps) => {\r\n  const participants = props.stores.participants\r\n  const participant = participants.find(props.participantId) as ParticipantBase\r\n  const position = useObserver(() => participant.mouse.position)\r\n  const name = useObserver(() => participant.information.name)\r\n  const [color] = participant.getColor()\r\n  if (!position) {\r\n    return <div />\r\n  }\r\n  const isLocal = props.participantId === participants.localId\r\n\r\n  const cursor = <div style={{width:18, height:30, left:position[0], top:position[1], position:'absolute',\r\n    pointerEvents: isLocal ? 'none' : 'auto', zIndex:isLocal ? 6000 : participant.zIndex+4000\r\n  }}>\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 60 100\">\r\n      <polygon points=\"32,100 53,92 36,57 60,56 0,0 0,81 16,65 32,100\" stroke=\"black\" fill={color} strokeWidth=\"6\" />\r\n    </svg>\r\n  </div>\r\n\r\n  return isLocal ? cursor\r\n    :<Tooltip title={name}>{cursor}</Tooltip>\r\n}\r\n","import React from 'react'\r\nimport {Participant, ParticipantProps} from './Participant'\r\n\r\n\r\nexport const PlaybackParticipant: React.FC<ParticipantProps> = (props) => {\r\n  return <Participant {...props} isLocal={false} isPlayback={true}/>\r\n}\r\n","import {Stores} from '@components/utils'\r\nimport {MapProps } from '@components/utils'\r\nimport {Participant, PARTICIPANT_SIZE} from '@models/Participant'\r\nimport {urlParameters} from '@models/url'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React from 'react'\r\nimport {MemoedLocalParticipant as LocalParticipant} from './LocalParticipant'\r\nimport {MouseCursor} from './MouseCursor'\r\nimport {PlaybackParticipant} from './PlaybackParticipant'\r\nimport {RemoteParticipant} from './RemoteParticipant'\r\n\r\ninterface LineProps {\r\n  start: [number, number]\r\n  end: [number, number]\r\n  remote: string,\r\n  stores: Stores\r\n}\r\n\r\nconst Line: React.FC<LineProps> = (props) => {\r\n  const left = Math.min(props.start[0], props.end[0])\r\n  const top = Math.min(props.start[1], props.end[1])\r\n  const width = Math.abs(props.start[0] - props.end[0])\r\n  const height = Math.abs(props.start[1] - props.end[1])\r\n\r\n  return <svg xmlns=\"http://www.w3.org/2000/svg\" style={{position:'absolute', left, top, width, height, pointerEvents:'stroke'}}\r\n    viewBox={`0, 0, ${width}, ${height}`}\r\n    onClick = {() => {\r\n      props.stores.participants.yarnPhones.delete(props.remote)\r\n      props.stores.participants.yarnPhoneUpdated = true\r\n    }}\r\n    >\r\n    <line x1={props.start[0] - left} y1={props.start[1] - top}\r\n      x2={props.end[0] - left} y2={props.end[1] - top} stroke=\"black\" />\r\n  </svg>\r\n}\r\n\r\nexport const ParticipantLayer: React.FC<MapProps> = (props) => {\r\n  const store = props.stores.participants\r\n  const remotes = useObserver(() => {\r\n    const rs = Array.from(store.remote.values()).filter(r => r.physics.located)\r\n    const all:Participant[] = Array.from(rs)\r\n    all.push(store.local)\r\n    all.sort((a,b) => a.pose.position[1] - b!.pose.position[1])\r\n    for(let i=0; i<all.length; ++i){\r\n      all[i].zIndex = i+1\r\n    }\r\n    //rs.sort((a,b) => a.pose.position[1] - b!.pose.position[1])\r\n    return rs\r\n  })\r\n  const localId = useObserver(() => store.localId)\r\n  const remoteElements = remotes.map(r => <RemoteParticipant key={r.id} stores={props.stores}\r\n    participant={r} size={PARTICIPANT_SIZE} />)\r\n  const localElement = (<LocalParticipant key={'local'} participant={store.local}\r\n    size={PARTICIPANT_SIZE} stores={props.stores}/>)\r\n  const lines = useObserver(\r\n    () => Array.from(store.yarnPhones).map((rid) => {\r\n      const start = store.local.pose.position\r\n      const remote = store.remote.get(rid)\r\n      if (!remote) { return undefined }\r\n      const end = remote.pose.position\r\n\r\n      return <Line start={start} end={end} key={rid} remote={rid} stores={props.stores}/>\r\n    }),\r\n  )\r\n  const playIds = useObserver(()=> Array.from(store.playback.keys()))\r\n  const playbackElements = playIds.map(id => <PlaybackParticipant key={id} stores={props.stores}\r\n    participant={store.playback.get(id)!} size={PARTICIPANT_SIZE} />)\r\n\r\n  const mouseIds = useObserver(() => Array.from(store.remote.keys()).filter(id => (store.find(id)!.mouse.show)))\r\n  const remoteMouseCursors = mouseIds.map(\r\n    id => <MouseCursor key={`M_${id}`} participantId={id} stores={props.stores} />)\r\n\r\n  const showLocalMouse = useObserver(() => store.local.mouse.show)\r\n  const localMouseCursor = showLocalMouse\r\n    ? <MouseCursor key={'M_local'} participantId={localId}  stores={props.stores} /> : undefined\r\n\r\n  if (urlParameters.testBot !== null) { return <div /> }\r\n\r\n  //  zIndex is needed to show the participants over the share layer.\r\n  return(\r\n    <div style={{position:'absolute', zIndex:0x7FFF}}>\r\n      {lines}\r\n      {playbackElements}\r\n      {remoteElements}\r\n      {localElement}\r\n      {remoteMouseCursors}\r\n      {localMouseCursor}\r\n    </div>\r\n  )\r\n}\r\n\r\nParticipantLayer.displayName = 'ParticipantsLayer'\r\n","import {BMProps} from '@components/utils'\r\nimport {ISharedContent, TIME_RESOLUTION_IN_MS} from '@models/ISharedContent'\r\nimport {createContent, createContentsFromDataTransfer} from '@stores/sharedContents/SharedContentCreator'\r\nimport {default as sharedContents} from '@stores/sharedContents/SharedContents'\r\nimport _ from 'lodash'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React, {useEffect} from 'react'\r\nimport {MouseOrTouch, RndContent} from './RndContent'\r\n\r\n\r\nexport const PastedContent: React.FC<BMProps> = (props:BMProps) => {\r\n  const map = props.stores.map\r\n  //  Pasted handler. It prevents paste to dialog.\r\n  function onPaste(evt: ClipboardEvent) {\r\n    //  console.log(`onPaste called enabled:${sharedContents.pasteEnabled}`)\r\n    if (sharedContents.pasteEnabled && map.keyInputUsers.size === 0 && evt.clipboardData) {\r\n      evt.preventDefault()\r\n      setContent(evt.clipboardData)\r\n    }\r\n  }\r\n  function onDrop(evt: DragEvent) {\r\n    //  console.log('onDrop', evt)\r\n    evt.preventDefault()\r\n    evt.stopPropagation()\r\n    if (evt.dataTransfer) {\r\n      setContent(evt.dataTransfer)\r\n    }\r\n  }\r\n\r\n  //  set pasted or dragged content to pasted content (not shared) or create shared content directly\r\n  const SHARE_DIRECT = true\r\n  function setContent(dataTransfer: DataTransfer) {\r\n    createContentsFromDataTransfer(dataTransfer, map).then(cs => {\r\n      for(const c of cs){\r\n        if (SHARE_DIRECT) {\r\n          sharedContents.shareContent(c)\r\n        } else {\r\n          sharedContents.setPasted(c)\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  function onShare() {\r\n    // console.log(\"onClick b:\", evt.button, \" bs:\" ,evt.buttons, \" d:\", evt.detail, \" p:\", evt.eventPhase)\r\n    //  Add the pasted content to sharedContents and clear the pastedContent.\r\n    pastedContent.zorder = Math.floor(Date.now() / TIME_RESOLUTION_IN_MS)\r\n    pastedContent.pinned = true\r\n    sharedContents.addLocalContent(_.cloneDeep(pastedContent))\r\n    sharedContents.setPasted(createContent())\r\n  }\r\n\r\n  useEffect(\r\n    () => {\r\n      window.document.body.addEventListener(\r\n        'paste',\r\n        (event) => {\r\n          onPaste(event)\r\n        },\r\n        {passive:false},\r\n      )\r\n      window.document.body.addEventListener(\r\n        'drop',\r\n        (event) => {\r\n          onDrop(event)\r\n        },\r\n        {passive:false},\r\n      )\r\n      window.document.body.addEventListener(\r\n        'dragover',\r\n        (ev) => {\r\n          // console.log('dragover called', ev)\r\n          ev.preventDefault()\r\n          ev.stopPropagation()\r\n          if (ev.dataTransfer?.dropEffect) {\r\n            ev.dataTransfer.dropEffect = 'copy'\r\n          }\r\n        },\r\n        {passive:false},\r\n      )\r\n    },\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    [],\r\n  )\r\n  const pastedContent = useObserver(() => sharedContents.pasted)\r\n  //  console.log('Pasted contents rendered.')\r\n\r\n  return (\r\n    <RndContent {...props} hideAll={pastedContent.type === ''} content={pastedContent}\r\n      onShare = {(evt: MouseOrTouch) => { onShare() }}\r\n      onClose = {(evt: MouseOrTouch) => {\r\n        sharedContents.setPasted(createContent())\r\n        evt.stopPropagation()\r\n      }}\r\n      updateAndSend = {(nc: ISharedContent) => {\r\n        sharedContents.setPasted(nc)\r\n      }}\r\n      updateOnly = {(nc: ISharedContent) => {\r\n        sharedContents.setPasted(nc)\r\n      }}\r\n    />\r\n  )\r\n}\r\n","import {MapProps} from '@components/utils'\r\nimport {makeStyles} from '@material-ui/core/styles'\r\nimport {isContentWallpaper} from '@models/ISharedContent'\r\nimport _ from 'lodash'\r\nimport {Observer} from 'mobx-react-lite'\r\nimport React from 'react'\r\nimport {PastedContent} from './PastedContent'\r\nimport {SharedContent} from './SharedContent'\r\n\r\nconst useStyles = makeStyles({\r\n  slContainer:{\r\n    userDrag: 'none',\r\n    userSelect: 'none',\r\n  },\r\n})\r\n\r\nexport const ShareLayer = React.memo<MapProps>(\r\n  (props) => {\r\n    const contents = props.stores.contents\r\n    const classes = useStyles()\r\n    const {transparent, ...contentProps} = props\r\n\r\n    return  <div className={classes.slContainer} >\r\n      <Observer>{\r\n        ()=>{\r\n          const all = Array.from(contents.all)\r\n          const filtered = props.transparent ? all.filter(c => !isContentWallpaper(c)) : all\r\n\r\n          return <>{\r\n            filtered.map(val =>\r\n              <SharedContent key={val.id} content={val} {...contentProps} />)\r\n          }</>\r\n        }\r\n      }</Observer>\r\n    <PastedContent {...contentProps} />\r\n    </div>\r\n  },\r\n  (prev, next) => {\r\n    return _.isEqual(prev.stores.contents.all, next.stores.contents.all) && prev.transparent === next.transparent\r\n  },\r\n)\r\nShareLayer.displayName = 'ShareLayer'\r\n","import {MAP_SIZE} from '@components/Constants'\r\nimport {MapProps} from '@components/utils'\r\nimport {makeStyles} from '@material-ui/core/styles'\r\nimport {rgb2Color} from '@models/utils'\r\nimport {Observer, useObserver} from 'mobx-react-lite'\r\nimport React from 'react'\r\nconst HALF = 0.5\r\n\r\nconst useStyles = makeStyles({\r\n  img: (props:BackgroundStyleProps) => {\r\n    if (props.transparent) {\r\n      return {display: 'none'}\r\n    }\r\n    //const color = `%23${rgb2Color(props.color).substring(1)}`\r\n    const fill = rgb2Color(props.fill)\r\n\r\n    return {\r\n      position: 'absolute',\r\n      top: - MAP_SIZE * HALF,\r\n      left: - MAP_SIZE * HALF,\r\n      backgroundColor: fill,\r\n      //backgroundImage: `url(\"data:image/svg+xml,%3Csvg width='120' height='120' viewBox='0 0 80 80' xmlns='http://www.w3.org/2000/svg'%3E%3Cg ` +\r\n      //  `fill='none' fill-rule='evenodd'%3E%3Cg fill='${color}' %3E%3Cpath d='M50 50c0-5.523 4.477-10 10-10s10 4.477 10 10-4.477 10-10 10c0 5.523-4.477 10-10 10s-10-4.477-10-10 4.477-10 10-10zM10 10c0-5.523 4.477-10 10-10s10 4.477 10 10-4.477 10-10 10c0 5.523-4.477 10-10 10S0 25.523 0 20s4.477-10 10-10zm10 8c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8zm40 40c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8z' /%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")`,\r\n      height: MAP_SIZE,\r\n      width: MAP_SIZE,\r\n    }\r\n  },\r\n  logo: (props:MapProps) => {\r\n    if (props.transparent) {\r\n      return {\r\n        display:'none',\r\n      }\r\n    }\r\n\r\n    return {\r\n      position: 'absolute',\r\n      top: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      left: 0,\r\n      margin: 'auto',\r\n      height: '10em',\r\n      userDrag: 'none',\r\n      userSelect: 'none',\r\n      pointerEvents: 'none',\r\n    }\r\n  },\r\n})\r\n\r\ninterface BackgroundStyleProps extends MapProps{\r\n  color: number[]\r\n  fill: number[]\r\n}\r\n\r\nexport const Background: React.FC<MapProps> = (props) => {\r\n  const roomInfo = props.stores.roomInfo\r\n  const styleProps = {\r\n    color: [0,0,0],\r\n    fill: [0,0,0],\r\n    ...props\r\n  }\r\n  useObserver(()=>{\r\n    styleProps.color = roomInfo.backgroundColor\r\n    styleProps.fill = roomInfo.backgroundFill\r\n  })\r\n  const classes = useStyles(styleProps)\r\n\r\n  return <Observer>{() => {\r\n    return <div className={classes.img} />\r\n  }}</Observer>\r\n}\r\nBackground.displayName = 'Background'\r\n","import {Base} from '@components/map/Base'\r\nimport {ParticipantLayer} from '@components/map/Participant'\r\nimport {ShareLayer} from '@components/map/Share'\r\nimport {MapProps} from '@components/utils'\r\n//import {useStore as useParticipantsStore} from '@hooks/ParticipantsStore'\r\n//import {useStore as useContentsStore} from '@hooks/SharedContentsStore'\r\n//import {useObserver} from 'mobx-react-lite'\r\nimport React from 'react'\r\nimport {BackgroundLayer} from './Background'\r\n\r\n\r\nexport const Map: React.FC<MapProps> = (props) => {\r\n\r\n  return (\r\n    <Base {...props}>\r\n      <BackgroundLayer {...props}/>\r\n      <ShareLayer {...props} />\r\n      <ParticipantLayer {...props}/>\r\n    </Base>\r\n  )\r\n}\r\nMap.displayName = 'Map'\r\n","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAAER0lEQVR4nO2c0ZHbNhCGv8vk/ZgKrFTgSwVHVxClA6aDlOAS7ArCEnQVWOpA6cCuwGIFzAOoOVoWbYCkbvef229Gc/cgCDv4BGAJAbjr+55Ak1+sAwjmE/KECXnChDxhQp4wIU+YkCdMyBMm5AkT8oQJecKEPGFCnjAhT5iQJ0zIEybkCRPyhAl5woQ8YUKeMCFPmJAnTMgTJuQJE/KECXnChDxhQp4wIU+YX60DWIEKqIGH4e8GeHPlfV+Az8AeOA5/TzeP7obcCZ/Pa4At8OeCz3gCdkC7Qjwvjpq8CvhneN2v+Lkd8GF4yfRGJXlbUuNeGxLXoiN9Mdob1rEaCvIqUmMuGR5LOZC+LK57oXd5D6TEYs0hMpeOlAAdDerOwvOjwhY7cQz17kmJkUu89rwG+Nc6iBF/43Ae9CjPcqicwuUQ6k1eRXqQ9iTuTEdaAHCTxHib83b4FAcprp11EGM8yWuAR+sgfsIjjhIYL8Om5+HyEjfDp5eet/Zy1y25J8Vrjpeed0JHHqTeV1kH4eEnoYZ8cV9IScOJlLqvMUceSI8mFWlhIGft9J4Ud7tC/fPp+976tevzOPZ9X12UbTLLTtFcfF411JPDrn+5Nrr6sh42K+Br5nt/43qSsGdeDzyQeu8tYnoRrBOWOvN9B6YbqZ1Z91S501BfDvXMulfBWt6Dcf1LMY3fWl6d+b5Hphtqbto+VW5D/jBcz6x7FazllaTbLalhx2Vb4O3Mut8O5ccxbChbAjN9XLBOWOZU/kRajclN63/G+fHj/KhQ+rx5t0IMs1CU5w0zedbDZrCAkCdMyBPGWt5/xvUvxTR+a3nmv4ktxDR+a3l74/qXsres3Fqeq91YMzCN3/o5r2QF3yOv+leFE2nFpISPwDvWSxY60q8IpXE88crnPCjfTrcjzTVbUsMvoeP5UOb7GXGYYj1sninZw/I7aW0TUqN/WlDvO75NOnIbw8UeFg89D9K5u1ya0f974A/Ke2DH9+LeF5Qvifd2WO/DGO0dOWXuHen7vt9eKd9mlm377/fC1AV1n66Uf5V7WMY05J8Mmjr4Mb5c4IHnzbyfmb5EoPRgi5sTQ57kQdlmojWOINeUnY+Y2rRkgpc570xJBnlP6qkfKE8eqqHcJ/LFdUN8bvDW82De+byO1ANbfrzqsSENz6Xb6+N8XgEN80/Gni/LOfI8v21IjT9324SbeW6MV3mQhqgW2zMMrq/28CwP4jaIH+ItYbnkSBryStcdl3IY6nUrDvzLgzRvbYG/SPPZLelI81uNwA/F3ofNS853jzWse41V3D32wjTErX+y8sbUPC+LVVxfpTmf/NkT920G1igkLMEEIU+YkCdMyBMm5AkT8oQJecKEPGFCnjAhT5iQJ0zIEybkCRPyhAl5woQ8YUKeMCFPmJAnTMgTJuQJE/KECXnChDxhQp4wIU+YkCdMyBMm5AkT8oT5H16yz3SnsLABAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAAFYElEQVR4nO2c7XWjRhRA7+bkv7UVWB2sUoGVCuytIGwFdipYtoIoFYTtQFuBUQVRKgiqIHIFkx8PHRAGBAg086R3z+EYYRjmcDVvPtEH5xyGTn7ynQFjOCZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMT/7zkAP5kAE7IGV15wEgiZ5K+Ax398Dib+shIGmsDkr7Ue+MhESmuSlpf0HjmXeJJrkrSufn7zkIiBCkbcAlrSXpi2wK302eb4zkLMCXoH/aK/PyqXvkRsPnaHIy0r7f9EsMKl8vunSF4q8an3WJLAaOpcT5UcFIcn7UjnWJDAp7W8nyo8KPgT2TnqESCvzhffhcomEzJfJcxQwocmD7gK7Ms+3LTIyczWEEjbLJNSH0CGNkwj4l6IlmyAir4IQ5UG9wGhAOtUB7N+QEhjTr5sRIyM8KSG1cJ1zPrZFvp06L3IFyYlzl865rXMuy88tX1tH5px76pCHuObapafndrT5uGlSeYAr1y5y7kREW5rzmgfclfTE/dOaa9YjPo/Bm4+wWQ5X98Az8DfFNM+ycn7G6cbKOSMtD/n9Vz3SeSSAutOHvAR4qzl+h9RJr/RvWW6Bj0g9WZd2F56RL0q1+9HUl4wG3mc8PBb7KA8/TcwHpjt3Uvedw9YV9dqi4ZxsYP5G27zH7Xx7clIXZvmD2TvnZvn/Zq4QnbrjRsaydDwuXbPI0ziXtWv/MnRp8Ey2hdhJr7IFPlWOfUbqyNfK8Q1FnfkC/DFSHnZI/VzlBx67DqHLW/JeEEi9lvFeKsA3pF8G0i97GD9bR3zE08hNqJ30U9xRLw7gKzK5C9KoGNqA6Uo0cfqNhC4vG3jdGmn2Z0z/cL0NjmuQ9+eA6+4pQucaqZum4p6ipF+U0OWBPPwhoe+ZovESDUyjK15KX8gNlggZ9bg7I403ZCRkT3vj59ARn9Fcl3a9z+Xw2U9p2WZunH6ac8fjkKvS8b1z7sUVfcNy33FIJz9yl31GwcpbDnh4bRw60zMnAwF71z4YPXP9BV58sFpDnTcGCcfhc0ERKuP8uEP6hYfz+na+H0+fMjKX/rb02M4dn6yS1twjrjlvW/p/0vMeVvJyxm7BPdSkWVe6PlG0UrOR8zAqIctLkaGuMYk57pMNaVk2MWVfspaQ5YE87H9GTO+O6d7riydKt5FQ5c2QkucYt3SQpxcz7nsO3/GwADjUN2PXTDsb8JV2eVnP9OLBOTmDUEve1NM4IMNnTWT533mHdL7hqWETqrxQmJ/4/w6PP24QqryN7wx0JMLjEvpQ5UVMP4naxO70KYBMVaUT5uMkocrL8NQI4Lj+aqp7vxPAG0qhygOpS3yHz2rH+wey+Cm6fFbeE/J8HhRLGc6Z0+tLeQVa0IRc8kAaA9GF76nmbdvQ5cH0a1CqqHkBU4M8kNLXtRV4M2iRd8nwaSVvAlKGLQPsi9V5ExEz7hSRakLvKtSxQF6GnApv7x70RVvJAwlrY8+wH9igRBzoLHkHUsafOvoVz+OVfdBY8g5EjDd4/Ya8Ep2OlN5F0CwvY5zB4R0yHJaMkNZF0Rw2D6wZvuB1gyz/U1PPlbkGeUMHr39H+U/8aw6bBw5L2LvWfxvgF5SLg+uQB9J9mCOTpE3skEbJEkWjKG1cQ9isMkfqsfLSvi3vf01XPdco72a4lrB5k5g8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xfwPFgG9kH+DJH4AAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAADY0lEQVR4nO3c7VEaURiG4dtM/ksH2oGkAkkFsYOQDkgHSQVqBdEOtAJJBcEOpIJIBeTHyw4fsyxLkN33WZ9rxnECBs54s2fPrgsn8/kc0/Sh7QHY/3M8YY4nzPGEOZ4wxxPmeMIcT5jjCXM8YY4nzPGEOZ4wxxPmeMIcT5jjCXM8YY4nzPGEOZ4wxxPmeMIcT5jjCXM8YY4nzPGEdSneALgDxovvg9ZG0pCTjrxLaAj8Krn9GxGyk7oQrwf83XLfbHF/J3Vh2ryquO+UDk+fH9sewJ7OWcZ6AF4Wt71LSvGGrO/Xrol92rulEq8H3JTcfkNsgXWcEy8AgFdiIfN64LhapbJgGQBPW+6bAmcV//czEW5zNTpbPO7ksKG1R2XB0q+4ryocbN9qT6m/1aakEu+Q5f6ACFXmjOoXRmoq8Q6xK47scWC2BUsPGLE8NhtTPuUZ+eI9AJcr/74kjuuk903Hkilen/VwhQvEl/THkmmfN2h7AGoyxZNdOLQlUzzbk+MJczxhjifM8YQ5njCVeIccRpQd+HeCSryLFp6zOM86AeaLrzGJjkdV4jVtRFwfc836C+eSRCfKM53bzKBHXB7xpeJnqq5Wa5TjrRuze4pOc5Lc0+bSHfX2rXfHHUZ9jheGwNcaP/cM/DjqSPbgaXO/cIOjjmRP3vLqhZsRkdPs78Dx6hqS8PpOx9vtlqTX0DhetSmJFiibHK/akGT7uVWOt90tcdCeluOVm5F4uiw4XrkRiafLQqZ4WZbiv0l0CqxKpnhZXumjtgdQV6Z4GdySZwbYKds7Y9sczIx4B22WGWCnbFvec4vPLbFIWZUt3ril55VZpKzKNm32gT8tPO8nhPZ1hWxb3oTYCpr0E8FwkG/Lg+qP7XhrjyS6oGhf2bY8iP3efQPP88zyQ3UkZYwHsfI75srzntjCpVaXm7LGeyV+uY9v/Lgz4DvJ/9RTV9Z4EL/cK+LD4aZv8Hj3xGo2zRXPh8q4YNlmSMSsupp505S4hOGGuHy9U5TireoTp7KKTzc6Jy5VL5b8k8XXS8PjapRqPCP3Ps92cDxhjifM8YQ5njDHE+Z4whxPmOMJczxhjifM8YQ5njDHE+Z4whxPmOMJczxhjifM8YQ5njDHE+Z4whxPmOMJczxhjifM8YT9AzPOgalOo8+wAAAAAElFTkSuQmCC\"","/* import {ErrorDialog} from '@components/error/ErrorDialog' */\r\nimport {BMProps} from '@components/utils'\r\n/* import {acceleratorText2El} from '@components/utils/formatter' */\r\n/* import megaphoneIcon from '@iconify/icons-mdi/megaphone' */\r\n/* import {Icon} from '@iconify/react' */\r\nimport {Collapse} from '@material-ui/core'\r\n/* import Menu from '@material-ui/core/Menu' */\r\n/* import MenuItem from '@material-ui/core/MenuItem' */\r\n/* import Popover from '@material-ui/core/Popover' */\r\nimport {makeStyles} from '@material-ui/core/styles'\r\n/* import MicIcon from '@material-ui/icons/Mic'\r\nimport MicOffIcon from '@material-ui/icons/MicOff'\r\nimport SettingsIcon from '@material-ui/icons/Settings'\r\nimport VideoIcon from '@material-ui/icons/Videocam'\r\nimport VideoOffIcon from '@material-ui/icons/VideocamOff'\r\nimport SpeakerOffIcon from '@material-ui/icons/VolumeOff'\r\nimport SpeakerOnIcon from '@material-ui/icons/VolumeUp' */\r\n\r\n//import ExitIcon from '@material-ui/icons/ExitToApp'\r\n\r\nimport smileIcon from '@images/whoo-screen_btn-smile.png'\r\n/* import symSmileIcon from '@images/whoo-screen_sym-smile.png' */\r\nimport clapIcon from '@images/whoo-screen_btn-clap.png'\r\n/* import symClapIcon from '@images/whoo-screen_sym-clap.png' */\r\nimport handIcon from '@images/whoo-screen_btn-hand.png'\r\n/* import symHandIcon from '@images/whoo-screen_sym-hand.png' */\r\n\r\n\r\n/* import {useTranslation} from '@models/locales' */\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React, {useEffect, useRef} from 'react'\r\n/* import {AdminConfigForm} from './adminConfig/AdminConfigForm' */\r\n/* import {BroadcastControl} from './BroadcastControl' */\r\nimport {FabMain} from '@components/utils/FabEx'\r\nimport {isSmartphone} from '@models/utils'\r\n\r\n/* import {ShareButton} from './share/ShareButton'\r\nimport {StereoAudioSwitch} from './StereoAudioSwitch' */\r\n\r\n/* import { MuiThemeProvider, createMuiTheme } from '@material-ui/core/styles';\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    primary: { main: '#9e886c' },\r\n    secondary: { main: '#ef4623' }\r\n  }\r\n}); */\r\n\r\nconst buttonStyle = {\r\n  '&': {\r\n    margin: '5px',\r\n    borderRadius: '50%',\r\n    width: isSmartphone() ? '100px' : '45px',\r\n    height: isSmartphone() ? '90px' : '45px',\r\n    textAlign: 'center',\r\n  },\r\n}\r\n\r\nconst useStyles = makeStyles({\r\n  emoticon:{\r\n    //display: 'block',\r\n    height: 50,\r\n    position:'relative',\r\n    cursor: 'pointer',\r\n    backgroundColor: '#9e886c', //  '#ef4623' : '#9e886c',\r\n    right: 0,\r\n    ...buttonStyle,\r\n  },\r\n  emoticonActive:{\r\n    display: 'block',\r\n    height: 50,\r\n    position:'relative',\r\n    cursor: 'pointer',\r\n    backgroundColor: '#ef4623', //  '#ef4623' : '#9e886c',\r\n    right: 0,\r\n    ...buttonStyle,\r\n  },\r\n  container:{\r\n    position: 'absolute',\r\n    width: '30%',\r\n    /* top: '70%', */\r\n    bottom: 15,\r\n    right:0,\r\n    padding: 0,\r\n    outline: 'none',\r\n    pointerEvents: 'none',\r\n  },\r\n  wrapper:{width:'100%'},\r\n  wrapperInner:{width:'100%', display:'flex', flexDirection:'column', alignItems:'flex-end'},\r\n})\r\n\r\nclass Member{\r\n  timeoutOut:NodeJS.Timeout|undefined = undefined\r\n  touched = false\r\n}\r\n\r\nexport const Emoticons: React.FC<BMProps&{height?:number}> = (props) => {\r\n  const {map, participants} = props.stores\r\n\r\n  //console.log(Object(participants.local).Blob \" >>zone\")\r\n\r\n  //  showor not\r\n  //const [show, setShow] = React.useState<boolean>(true)\r\n  //const [showAdmin, setShowAdmin] = React.useState<boolean>(false)\r\n  //const [showShare, setShowShareRaw] = React.useState<boolean>(false)\r\n\r\n  // For toggle emoticons\r\n  const [toggleSmile, setToggleSmile] = React.useState<boolean>(false)\r\n  const [toggleClap, setToggleClap] = React.useState<boolean>(false)\r\n  const [toggleHand, setToggleHand] = React.useState<boolean>(false)\r\n\r\n\r\n  /* function setShowShare(flag: boolean) {\r\n    if (flag) {\r\n      map.keyInputUsers.add('shareDialog')\r\n    }else {\r\n      map.keyInputUsers.delete('shareDialog')\r\n    }\r\n    //setShowShareRaw(flag)\r\n  } */\r\n\r\n  const memberRef = useRef<Member>(new Member())\r\n  const member = memberRef.current\r\n  const containerRef = useRef<HTMLDivElement>(null)\r\n  //const adminButton = useRef<HTMLDivElement>(null)\r\n  //  observers\r\n  /*\r\n   */\r\n  //  Fab state and menu\r\n  /* const [deviceInfos, setDeviceInfos] = React.useState<MediaDeviceInfo[]>([])\r\n  const [micMenuEl, setMicMenuEl] = React.useState<Element|null>(null)\r\n  const [speakerMenuEl, setSpeakerMenuEl] = React.useState<Element|null>(null)\r\n  const [videoMenuEl, setVideoMenuEl] = React.useState<Element|null>(null) */\r\n\r\n  /* const {t} = useTranslation() */\r\n  const classes = useStyles()\r\n\r\n  //  Footer collapse conrtrol\r\n  function checkMouseOnBottom() {\r\n    return map.screenSize[1] - (map.mouse[1] - map.offset[1]) < 90\r\n  }\r\n  const mouseOnBottom = useObserver(checkMouseOnBottom)\r\n  useEffect(() => {\r\n    if (checkMouseOnBottom()) { member.touched = true }\r\n    setShowFooter(mouseOnBottom || !member.touched)\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  },        [mouseOnBottom, member.touched])\r\n  function setShowFooter(show: boolean) {\r\n    if (show) {\r\n      //setShow(true)\r\n      if (member.timeoutOut) {\r\n        clearTimeout(member.timeoutOut)\r\n        member.timeoutOut = undefined\r\n      }\r\n      containerRef.current?.focus()\r\n    }else {\r\n      if (!member.timeoutOut) {\r\n        member.timeoutOut = setTimeout(() => {\r\n          //setShow(false)\r\n          member.timeoutOut = undefined\r\n        },                             500)\r\n      }\r\n    }\r\n  }\r\n\r\n  //  keyboard shortcut\r\n  useEffect(() => {\r\n    const onKeyDown = (e: KeyboardEvent) => {\r\n      //  console.log(`onKeyDown: code: ${e.code}`)\r\n      /* if (map.keyInputUsers.size === 0) {\r\n        if (!e.ctrlKey && !e.metaKey && !e.altKey){\r\n          if (e.code === 'KeyM') {  //  mute/unmute audio\r\n            participants.local.muteAudio = !participants.local.muteAudio\r\n            setShowFooter(true)\r\n          }\r\n          if (e.code === 'KeyC') {  //  Create share dialog\r\n            setShowFooter(true)\r\n            setShowShare(true)\r\n            e.preventDefault()\r\n            e.stopPropagation()\r\n          }\r\n          if (e.code === 'KeyL' || e.code === 'Escape') {  //  Leave from keyboard\r\n            participants.local.awayFromKeyboard = true\r\n          }\r\n        }\r\n      } */\r\n    }\r\n    window.addEventListener('keydown', onKeyDown)\r\n\r\n    return () => {\r\n      window.removeEventListener('keydown', onKeyDown)\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  },        [])\r\n\r\n  //  render footer\r\n  return React.useMemo(() => {\r\n    //  Create menu list for device selection\r\n    /* function makeMenuItem(info: MediaDeviceInfo, close:(did:string) => void):JSX.Element {\r\n      let selected = false\r\n      if (info.kind === 'audioinput') {\r\n        selected = info.deviceId === participants.local.devicePreference.audioInputDevice\r\n      }else if (info.kind === 'audiooutput') {\r\n        selected = info.deviceId === participants.local.devicePreference.audioOutputDevice\r\n      }else if (info.kind === 'videoinput') {\r\n        selected = info.deviceId === participants.local.devicePreference.videoInputDevice\r\n      }\r\n\r\n      return <MenuItem key={info.deviceId}\r\n        onClick={() => { close(info.deviceId) }}\r\n        > { (selected ? '✔\\u00A0' : '\\u2003') + info.label }</MenuItem>  //  \\u00A0: NBSP, u2003: EM space.\r\n    } */\r\n\r\n    /* const micMenuItems:JSX.Element[] = [<MenuItem  key = {'broadcast'} ><BroadcastControl {...props} /></MenuItem>]\r\n    const speakerMenuItems:JSX.Element[] = []\r\n    const videoMenuItems:JSX.Element[] = [] */\r\n    /* deviceInfos.forEach((info) => {\r\n      if (info.kind === 'audioinput') {\r\n        const broadcastControl = micMenuItems.pop() as JSX.Element\r\n        micMenuItems.push(makeMenuItem(info, closeMicMenu))\r\n        micMenuItems.push(broadcastControl)\r\n      }\r\n      if (info.kind === 'audiooutput') {\r\n        speakerMenuItems.push(makeMenuItem(info, closeSpeakerMenu))\r\n      }\r\n      if (info.kind === 'videoinput') {\r\n        videoMenuItems.push(makeMenuItem(info, closeVideoMenu))\r\n      }\r\n    })\r\n    function closeMicMenu(did:string) {\r\n      if (did) {\r\n        participants.local.devicePreference.audioInputDevice = did\r\n        participants.local.saveMediaSettingsToStorage()\r\n      }\r\n      setMicMenuEl(null)\r\n    }\r\n    function closeSpeakerMenu(did:string) {\r\n      if (did) {\r\n        participants.local.devicePreference.audioOutputDevice = did\r\n        participants.local.saveMediaSettingsToStorage()\r\n      }\r\n      setSpeakerMenuEl(null)\r\n    }\r\n    function closeVideoMenu(did:string) {\r\n      if (did) {\r\n        participants.local.devicePreference.videoInputDevice = did\r\n        participants.local.saveMediaSettingsToStorage()\r\n      }\r\n      setVideoMenuEl(null)\r\n    } */\r\n\r\n    //  Device list update when the user clicks to show the menu\r\n    //const fabSize = props.height\r\n    const iconSize = 55 //props.height ? props.height * 0.7 : 55\r\n    /* function updateDevices(ev:React.PointerEvent | React.MouseEvent | React.TouchEvent) {\r\n      navigator.mediaDevices.enumerateDevices()\r\n      .then(setDeviceInfos)\r\n      .catch(() => { console.log('Device enumeration error') })\r\n    }\r\n\r\n    function openAdmin(){\r\n      map.keyInputUsers.add('adminForm')\r\n      setShowAdmin(true)\r\n    }\r\n    function closeAdmin(){\r\n      map.keyInputUsers.delete('adminForm')t\r\n      setShowAdmin(false)\r\n    } */\r\n\r\n    function toggleSmileButton() {\r\n      participants.local.emoticon = ''\r\n      setToggleHand(false)\r\n      setToggleClap(false)\r\n      const _timer = setTimeout(()=> {\r\n        clearTimeout(_timer)\r\n        if(toggleSmile) {\r\n          participants.local.emoticon = ''\r\n          setToggleSmile(false)\r\n        } else {\r\n          participants.local.emoticon = 'smile'\r\n          setToggleSmile(true)\r\n        }\r\n      },100)\r\n    }\r\n    function toggleClapButton() {\r\n      participants.local.emoticon = ''\r\n      setToggleHand(false)\r\n      setToggleSmile(false)\r\n      const _timer = setTimeout(()=> {\r\n        clearTimeout(_timer)\r\n        if(toggleClap) {\r\n          participants.local.emoticon = ''\r\n          setToggleClap(false)\r\n        } else {\r\n          participants.local.emoticon = 'clap'\r\n          setToggleClap(true)\r\n        }\r\n      },100)\r\n    }\r\n    function toggleHandButton() {\r\n      participants.local.emoticon = ''\r\n      setToggleClap(false)\r\n      setToggleSmile(false)\r\n      const _timer = setTimeout(()=> {\r\n        clearTimeout(_timer)\r\n        if(toggleHand) {\r\n          participants.local.emoticon = ''\r\n          setToggleHand(false)\r\n        } else {\r\n          participants.local.emoticon = 'hand'\r\n          setToggleHand(true)\r\n        }\r\n      },100)\r\n    }\r\n\r\n    return <div ref={containerRef} className={classes.container}>\r\n      <Collapse in={true} classes={classes}>\r\n\r\n\r\n\r\n        {/* <StereoAudioSwitch size={fabSize} iconSize={iconSize} {...props}/>\r\n        <FabMain size={fabSize} color={mute.muteS ? 'primary' : 'secondary' }\r\n          aria-label=\"speaker\" onClick={() => {\r\n            participants.local.muteSpeaker = !mute.muteS\r\n            if (participants.local.muteSpeaker) {\r\n              participants.local.muteAudio = true\r\n            }\r\n            participants.local.saveMediaSettingsToStorage()\r\n          }}\r\n          onClickMore = { (ev) => {\r\n            updateDevices(ev)\r\n            setSpeakerMenuEl(ev.currentTarget)\r\n          }}\r\n          >\r\n          {mute.muteS ? <SpeakerOffIcon style={{width:iconSize, height:iconSize}} />\r\n            : <SpeakerOnIcon style={{width:iconSize, height:iconSize}} /> }\r\n        </FabMain>\r\n        <Menu anchorEl={speakerMenuEl} keepMounted={true}\r\n          open={Boolean(speakerMenuEl)} onClose={() => { closeSpeakerMenu('') }}>\r\n          {speakerMenuItems}\r\n        </Menu>\r\n\r\n        <FabWithTooltip size={fabSize} color={mute.muteA ? 'primary' : 'secondary' } aria-label=\"mic\"\r\n          title = {acceleratorText2El(t('ttMicMute'))}\r\n          onClick = { () => {\r\n            participants.local.muteAudio = !mute.muteA\r\n            if (!participants.local.muteAudio) {\r\n              participants.local.muteSpeaker = false\r\n            }\r\n            participants.local.saveMediaSettingsToStorage()\r\n          }}\r\n          onClickMore = { (ev) => {\r\n            updateDevices(ev)\r\n            setMicMenuEl(ev.currentTarget)\r\n          } }\r\n          >\r\n          {mute.muteA ? <MicOffIcon style={{width:iconSize, height:iconSize}} /> :\r\n            mute.onStage ?\r\n              <Icon icon={megaphoneIcon} style={{width:iconSize, height:iconSize}} color=\"gold\" />\r\n              : <MicIcon style={{width:iconSize, height:iconSize}} /> }\r\n        </FabWithTooltip>\r\n        <Menu anchorEl={micMenuEl} keepMounted={true}\r\n          open={Boolean(micMenuEl)} onClose={() => { closeMicMenu('') }}>\r\n          {micMenuItems}\r\n        </Menu>\r\n\r\n        <FabMain size={fabSize} color={mute.muteV ? 'primary' : 'secondary'} aria-label=\"camera\"\r\n          onClick = { () => {\r\n            participants.local.muteVideo = !mute.muteV\r\n            participants.local.saveMediaSettingsToStorage()\r\n          }}\r\n          onClickMore = { (ev) => {\r\n            updateDevices(ev)\r\n            setVideoMenuEl(ev.currentTarget)\r\n          } }\r\n        >\r\n          {mute.muteV ? <VideoOffIcon style={{width:iconSize, height:iconSize}} />\r\n            : <VideoIcon style={{width:iconSize, height:iconSize}} /> }\r\n        </FabMain>\r\n        <Menu anchorEl={videoMenuEl} keepMounted={true}\r\n          open={Boolean(videoMenuEl)} onClose={() => { closeVideoMenu('') }}>\r\n          {videoMenuItems}\r\n        </Menu>\r\n\r\n        <ShareButton {...props} size={fabSize} iconSize={iconSize} showDialog={showShare}\r\n          setShowDialog={setShowShare} />\r\n\r\n        <ErrorDialog {...props}/> */}\r\n\r\n        {/* ADD ANIMATED ICONS*/}\r\n\r\n        {/* <div className={toggleSmile ? classes.emoticonActive : classes.emoticon} onMouseDown={toggleSmileButton}>\r\n          <img src={smileIcon} style={{width:iconSize, height:iconSize, position:'relative', top:'-5px', left:'-5px'}} alt='' />\r\n        </div>\r\n\r\n        <div className={toggleClap ? classes.emoticonActive : classes.emoticon} onMouseDown={toggleClapButton}>\r\n          <img src={clapIcon} style={{width:iconSize, height:iconSize, position:'relative', top:'-5px', left:'-5px'}} alt='' />\r\n        </div>\r\n\r\n        <div className={toggleHand ? classes.emoticonActive : classes.emoticon} onMouseDown={toggleHandButton}>\r\n          <img src={handIcon} style={{width:iconSize, height:iconSize, position:'relative', top:'-5px', left:'-4px'}} alt='' />\r\n        </div> */}\r\n\r\n        <FabMain size={isSmartphone() ? 100 : 45}\r\n          onClick = { () => {\r\n            toggleSmileButton()\r\n          }}\r\n        >\r\n          {toggleSmile ? <div className={classes.emoticonActive}>\r\n            <img src={smileIcon} style={{width:iconSize, height:iconSize, position:'relative', top:isSmartphone() ? '17px' : '-5px', left:isSmartphone() ? '0px' : '-5px', transform : isSmartphone() ? 'scale(2)' : 'scale(1)'}} alt=\"\"/></div>\r\n            : <div className={classes.emoticon}>\r\n            <img src={smileIcon} style={{width:55, height:55, position:'relative', top:isSmartphone() ? '17px' : '-5px', left:isSmartphone() ? '0px' : '-5px', transform : isSmartphone() ? 'scale(2)' : 'scale(1)'}} alt=\"\"/></div> }\r\n        </FabMain>\r\n        <FabMain size={isSmartphone() ? 100 : 45}\r\n          onClick = { () => {\r\n            toggleClapButton()\r\n          }}\r\n        >\r\n          {toggleClap ? <div className={classes.emoticonActive}>\r\n            <img src={clapIcon} style={{width:iconSize, height:iconSize, position:'relative', top:isSmartphone() ? '17px' : '-5px', left:isSmartphone() ? '0px' : '-5px', transform : isSmartphone() ? 'scale(2)' : 'scale(1)'}} alt=\"\"/></div>\r\n            : <div className={classes.emoticon}>\r\n            <img src={clapIcon} style={{width:55, height:55, position:'relative', top:isSmartphone() ? '17px' : '-5px', left:isSmartphone() ? '0px' : '-5px', transform : isSmartphone() ? 'scale(2)' : 'scale(1)'}} alt=\"\"/></div> }\r\n        </FabMain>\r\n        <FabMain size={isSmartphone() ? 100 : 45}\r\n          onClick = { () => {\r\n            toggleHandButton()\r\n          }}\r\n        >\r\n          {toggleHand ? <div className={classes.emoticonActive}>\r\n            <img src={handIcon} style={{width:iconSize, height:iconSize, position:'relative', top:isSmartphone() ? '17px' : '-5px', left:isSmartphone() ? '0px' : '-5px', transform : isSmartphone() ? 'scale(2)' : 'scale(1)'}} alt=\"\"/></div>\r\n            : <div className={classes.emoticon}>\r\n            <img src={handIcon} style={{width:55, height:55, position:'relative', top:isSmartphone() ? '17px' : '-5px', left:isSmartphone() ? '0px' : '-5px', transform : isSmartphone() ? 'scale(2)' : 'scale(1)'}} alt=\"\"/></div> }\r\n        </FabMain>\r\n\r\n        {/* <FabMain size={45} onClick={toggleSmileButton}\r\n            >\r\n            <div className={toggleSmile ? classes.emoticonActive : classes.emoticon} onMouseDown={toggleSmileButton}>\r\n              <img src={smileIcon} style={{width:iconSize, height:iconSize, position:'relative', top:'-5px', left:'-5px'}} alt='' />\r\n            </div>\r\n          </FabMain>\r\n          <FabMain size={45} onClick={toggleClapButton}\r\n            >\r\n           <div className={toggleClap ? classes.emoticonActive : classes.emoticon} onMouseDown={toggleClapButton}>\r\n            <img src={clapIcon} style={{width:iconSize, height:iconSize, position:'relative', top:'-5px', left:'-5px'}} alt='' />\r\n          </div>\r\n          </FabMain>\r\n          <FabMain size={45} onClick={toggleHandButton}\r\n            >\r\n            <div className={toggleHand ? classes.emoticonActive : classes.emoticon} onMouseDown={toggleHandButton}>\r\n              <img src={handIcon} style={{width:iconSize, height:iconSize, position:'relative', top:'-5px', left:'-4px'}} alt='' />\r\n            </div>\r\n          </FabMain> */}\r\n\r\n        {/*\r\n        <MuiThemeProvider theme={theme}>\r\n          <FabMain size={45} onClick={toggleSmileButton} color={toggleSmile ? 'secondary' : 'primary' }\r\n            style={{marginLeft:'57%', opacity:1}}>\r\n            <img src={smileIcon} style={{width:iconSize, height:iconSize}} alt='' />\r\n          </FabMain>\r\n          <FabMain size={45} onClick={toggleClapButton} color={toggleClap ? 'secondary' : 'primary' }\r\n            style={{marginLeft:'0em', opacity:1}}>\r\n            <img src={clapIcon} style={{width:iconSize, height:iconSize}} alt='' />\r\n          </FabMain>\r\n          <FabMain size={45} onClick={toggleHandButton} color={toggleHand ? 'secondary' : 'primary' }\r\n            style={{marginLeft:'0em', opacity:1}}>\r\n            <img src={handIcon} style={{width:iconSize, height:iconSize}} alt='' />\r\n          </FabMain>\r\n        </MuiThemeProvider>\r\n */}\r\n\r\n        {/* <FabMain size={fabSize} onClick={openAdmin} divRef={adminButton}\r\n          style={{marginLeft:'auto', marginRight:10, opacity:0.1}}>\r\n          <SettingsIcon style={{width:iconSize, height:iconSize}} />\r\n        </FabMain>\r\n        <Popover open={showAdmin} onClose={closeAdmin}\r\n          anchorEl={adminButton.current} anchorOrigin={{vertical:'top', horizontal:'left'}}\r\n          anchorReference = \"anchorEl\" >\r\n          <AdminConfigForm close={closeAdmin} stores={props.stores}/>\r\n        </Popover> */}\r\n\r\n      </Collapse>\r\n    </div >\r\n  },\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    [toggleSmile, toggleClap, toggleHand]\r\n\r\n    )\r\n}\r\nEmoticons.displayName = 'Emoticons'\r\n","import {BMProps} from '@components/utils'\r\nimport {Collapse} from '@material-ui/core'\r\nimport {makeStyles} from '@material-ui/core/styles'\r\nimport {useObserver} from 'mobx-react-lite'\r\nimport React, {useEffect, useRef, useState} from 'react'\r\nimport {FabMain/* , FabWithTooltip */} from '@components/utils/FabEx'\r\nimport { PlaybackParticipant } from '@stores/participants/PlaybackParticipant'\r\nimport {Observer} from 'mobx-react-lite'\r\nimport {isSmartphone, rgb2Color} from '@models/utils'\r\nimport { getVideoButtonStatus } from './Footer'\r\n\r\n\r\nconst buttonStyle = {\r\n  '&': {\r\n    margin: '5px',\r\n    borderRadius: '50%',\r\n    width: '250px',\r\n    height: '243px',\r\n    textAlign: 'center',\r\n    overflow: 'hidden',\r\n    top: '1px',\r\n    PointerEvent: 'none',\r\n  },\r\n}\r\n\r\nconst useStyles = makeStyles({\r\n  tapBroadcast: {\r\n    display: 'block',\r\n    width:'265px',\r\n    position:'relative',\r\n    left:'-10px',\r\n    textAlign:'center',\r\n    color: '#FFFFFF',\r\n    fontWeight: 'bold',\r\n    fontSize: '20px',\r\n    textShadow: '1px 1px #000, -1px 1px #cdcdcd, -1px -1px #cdcdcd, 1px -1px #cdcdcd' // '1px 2px 2px #000000' //\r\n  },\r\n  tapBroadcastText: {\r\n    display: 'block',\r\n    width:'265px',\r\n    position:'relative',\r\n    top: '-20px',\r\n    left:'-10px',\r\n    textAlign:'center',\r\n    color: '#FFFFFF',\r\n    fontWeight: 'bold',\r\n    fontSize: '20px',\r\n    textShadow: '1px 1px #000, -1px 1px #cdcdcd, -1px -1px #cdcdcd, 1px -1px #cdcdcd' // '1px 2px 2px #000000' //\r\n  },\r\n  hidetapBroadcast:{\r\n    display: 'none',\r\n  },\r\n  fab:{\r\n    display:'none',\r\n    opacity: 0,\r\n    transition: 'opacity 0.3s ease-out',\r\n  },\r\n  fabActive: {\r\n    display:'block',\r\n    opacity: 1,\r\n    transition: 'opacity 0.3s ease-out'\r\n  },\r\n  vidicon:{\r\n    display: 'none',\r\n    height: 50,\r\n    position:'relative',\r\n    backgroundColor: 'black',\r\n    transform: 'rotateY(180deg)',\r\n    right: 0,\r\n    ...buttonStyle,\r\n  },\r\n  vidiconActive:{\r\n    display: 'block',\r\n    height: 50,\r\n    position:'relative',\r\n    alignItems:'center',\r\n    backgroundColor: 'black',\r\n    transform: 'rotateY(180deg)',\r\n    right: 0,\r\n    ...buttonStyle,\r\n  },\r\n  container:{\r\n    position: 'absolute',\r\n    width: '30%',\r\n    top: '0%',\r\n    right:10,\r\n    padding: 0,\r\n    outline: 'none',\r\n    pointerEvents: 'none',\r\n  },\r\n  wrapper:{width:'100%'},\r\n  wrapperInner:{width:'100%', display:'flex', flexDirection:'column', alignItems:'flex-end'},\r\n\r\n})\r\nexport const ZoneAvatar: React.FC<BMProps&{height?:number}> = (props) => {\r\n  const {participants} = props.stores\r\n  const rgb = participants.local.getColorRGB()\r\n  const videoButtonStatus = getVideoButtonStatus()\r\n  // check for remote status\r\n  const remotes = Array.from(participants.remote.keys()).filter(key => key !== participants.localId)\r\n  let userIndex:number = 0;\r\n  for (const [i] of remotes.entries()) {\r\n  if(participants.remote.get(remotes[i])?.tracks.avatarStream !== undefined) {\r\n    userIndex = i\r\n   }\r\n  }\r\n  const store = props.stores.participants\r\n  const ids = useObserver(() => Array.from(store.remote.keys()).filter((id) => {\r\n    const remote = store.find(id)!\r\n    if(remote.tracks.avatarStream !== undefined) {\r\n        return remote\r\n    }\r\n    return undefined\r\n  }))\r\nconst [streamUser, setStreamUser] = React.useState(ids)\r\nlet result:any = []\r\nif(ids.length !== streamUser.length) {\r\n  let onlyInA = ids.filter(comparer(streamUser));\r\n  let onlyInB = streamUser.filter(comparer(ids));\r\n  if(ids.length === 0) {\r\n    result = []\r\n  }else {\r\n    result = onlyInA.concat(onlyInB)\r\n  }\r\n  setStreamUser(result)\r\n}\r\nfunction comparer(otherArray:string[]){\r\n  return function(current:string){\r\n    return otherArray.filter(function(other){\r\n      return other === current\r\n    }).length === 0;\r\n  }\r\n}\r\n  const localStream = useObserver(() => Boolean(participants.local.showVideo))\r\n  const startStream = useObserver(() => Boolean(participants.remote.get(streamUser[streamUser.length-1])?.showVideo))\r\n  const rgbR = participants.remote.get(streamUser[streamUser.length-1])?.getColorRGB()\r\n  //const avStream = useObserver(() => participants.local.tracks.avatarStream)\r\n  const avLocalStream = useObserver(() =>  participants.local.tracks.avatarStream)\r\n  //const avStream = useObserver(() =>  participants.remote.get(remotes[userIndex])?.tracks.avatarStream)\r\n  const avStream = useObserver(() =>  participants.remote.get(streamUser[streamUser.length-1])?.tracks.avatarStream)\r\n  /* const avStream = useObserver(() =>  participants.remote.get(remotes[0])?.tracks.avatarStream) */\r\n  let stream = (localStream && !(participants instanceof PlaybackParticipant) ?\r\n  avLocalStream : (startStream && !(participants instanceof PlaybackParticipant) ?\r\n  avStream : undefined))\r\n\r\n  let blob = stream && (participants instanceof PlaybackParticipant) ? participants.videoBlob: undefined\r\n  // For toggle emoticons\r\n  const [toggleStream, setToggleStream] = React.useState<boolean>((localStream !== false || startStream !== false) ? true : false)\r\n  const [toggleUI, setToggleUI] = React.useState<boolean>(true)\r\n  const videoRef = useRef<HTMLVideoElement>(null)\r\n  const [liveTimer, setLiveTimer] = useState(1)\r\n  const containerRef = useRef<HTMLDivElement>(null)\r\n\r\n  /* //  observers\r\n  const mute = useObserver(() => ({\r\n    muteA: participants.local.muteAudio,  //  mic\r\n    muteS: participants.local.muteSpeaker,  //  speaker\r\n    muteV: participants.local.muteVideo,  //  camera\r\n    onStage: participants.local.physics.onStage,\r\n  })) */\r\n\r\n  if(stream === undefined) {\r\n    var dispText = ''\r\n    dispText = \"GOING LIVE...\"\r\n    if(videoButtonStatus === false) {\r\n      dispText = \"STREAM OFF\"\r\n    } else {\r\n      if(localStream) {\r\n      if(toggleUI) {\r\n        setToggleUI(false)\r\n      }\r\n      } else if(startStream) {\r\n        //dispText = \"RECONNECTING...\"\r\n        dispText = \"\"\r\n      } else {\r\n        dispText = \"STREAM OFF\"\r\n        if(toggleUI === false) {\r\n          setTimeout (() => {\r\n            let nTime = liveTimer\r\n            if(nTime <= 8) {\r\n              nTime += 1\r\n              setLiveTimer(nTime)\r\n            }\r\n          },500)\r\n          if(liveTimer >= 6) {\r\n            //console.log(\"timer off\")\r\n            setLiveTimer(1)\r\n            setToggleUI(true)\r\n          }\r\n        }\r\n      }\r\n    }\r\n  } else {\r\n      dispText = \"\"\r\n  }\r\n  const classes = useStyles()\r\n  useEffect(() => {\r\n    if (videoRef?.current !== null) {\r\n      setStream(videoRef.current, stream, blob,\r\n        '300', '300')\r\n        checkToggle()\r\n    }\r\n    return () => {\r\n      if(localStream === false) {\r\n        setLiveTimer(1)\r\n      }\r\n    }\r\n  },)\r\n\r\n  function checkToggle() {\r\n    setToggleStream((localStream !== false || startStream !== false) ? true : false)\r\n  }\r\n  function setStream(video: HTMLVideoElement, stream: MediaStream|undefined, blob: Blob|undefined,\r\n    videoLargerWidthClass: string, videoLargerHeightClass: string){\r\n\r\n    if (stream) {video.srcObject = stream}\r\n    else if (blob){\r\n      const url = URL.createObjectURL(blob)\r\n      video.src = url\r\n    }\r\n    video.autoplay = true\r\n    video.onloadedmetadata = () => {\r\n      const settings = {\r\n        width: 350, //video.width,\r\n        height: 350, //video.height,\r\n      }\r\n      if (settings.width !== undefined && settings.height !== undefined) {\r\n        video.className = settings.width >= settings.height ? videoLargerWidthClass : videoLargerHeightClass\r\n      } else {\r\n        console.error('video stream width || height is undefined')\r\n        video.className = videoLargerWidthClass\r\n      }\r\n    }\r\n  }\r\n  //  keyboard shortcut\r\n  useEffect(() => {\r\n    //console.log(videoRef?.current, \"mask\")\r\n    /* window.addEventListener('click', (ev) => {\r\n      //checkZone()\r\n      ev.preventDefault()\r\n    },                      {passive: false, capture: false}) */\r\n    /* const onKeyDown = (e: KeyboardEvent) => {\r\n      console.log(`onKeyDown: code: ${e.code}`)\r\n    }\r\n    window.addEventListener('keydown', onKeyDown) */\r\n\r\n    return () => {\r\n      //window.removeEventListener('keydown', onKeyDown)\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  },        [])\r\n  return <Observer>{() => {\r\n  return <div ref={containerRef} className={classes.container}>\r\n    <Collapse in={true} classes={classes}>\r\n      <FabMain size={250} className={((localStream !== false || startStream !== false || toggleUI === false)) ? classes.fabActive : classes.fab}\r\n      onClick = { () => {\r\n        /* console.log(\"on Vid Click\") */\r\n        /* if(localStream !== false || startStream !== false || toggleUI === false) {return} */\r\n        /* connection.conference.sendMessage(MessageType.MUTE_VIDEO, true)\r\n        participants.local.muteVideo = !mute.muteV\r\n        participants.local.saveMediaSettingsToStorage() */\r\n      }}\r\n      >\r\n      <div className={(toggleStream) ? classes.vidiconActive : classes.vidicon}>\r\n        <video ref={videoRef} style={{width: '350px', height:'350px', position: 'absolute', marginTop:'-50px', marginLeft:'-150px'}}/>\r\n      </div>\r\n    </FabMain>\r\n      <div style={toggleUI === false && stream === undefined ? {width:'240px', height:'243px', borderRadius: '50%',top:'12.5px', right:'20.7px', position:'absolute', backgroundColor:'black',/*  display:'block', */ /* transform: 'opacity(1)',  */opacity: 1, transition: 'opacity 0.3s ease-out'} : {/* display:'none',  */width:'240px', height:'243px', borderRadius: '50%', top:'12.5px', right:'20.7px', position:'absolute', backgroundColor:'black', /* transform: 'opacity(0)',  */ opacity: 0, transition: 'opacity 0.3s ease-out'}}>\r\n        <p style={dispText === 'GOING LIVE...' || stream !== undefined ? {display:'none'} : {display:'block', position:'absolute', color:'red', top:'235px', width:'250px', textAlign:'center', fontSize:'20px', fontWeight:'bold', /* textShadow: '1px 1px #ff0000, -1px 1px #ff0000, -1px -1px #ff0000, 1px -1px #ff0000' */}}>{/* RECONNECTING... */}</p>\r\n      </div>\r\n\r\n      <div style={{height:'50px', width:'150px', textAlign:'center', position:'relative', left:'-66px',\r\n        verticalAlign:'middle', display:'flex', flexDirection:'row', whiteSpace:'nowrap', marginTop: '-50px', color:'white', overflow:'hidden'}}>\r\n          <img style={{position:'relative', display: dispText !== \"STREAM OFF\" ? 'block' : 'none', width:'25px', height:'25px', marginTop:'0px', marginLeft: '35px', backgroundColor:localStream ? rgb2Color(rgb) : (rgbR !== undefined ? rgb2Color(rgbR) : undefined), borderRadius: '50%'}} src={localStream ? participants.local.information.avatarSrc : participants.remote.get(remotes[userIndex])?.information.avatarSrc}  alt=''/>\r\n          <p style={{position:'relative', marginTop:'4px', marginLeft:'4px', overflow:'hidden', display: dispText !== 'STREAM OFF' ? 'block' : 'none', fontSize: isSmartphone() ? '2rem' : '1rem', fontWeight:'bold'}}>{localStream ? participants.local.information.name : participants.remote.get(remotes[userIndex])?.information.name}</p>\r\n      </div>\r\n      <div className={localStream || ids.length === 0 || videoButtonStatus === false ? classes.hidetapBroadcast : classes.tapBroadcast}>\r\n        TAP TO GO LIVE\r\n      </div>\r\n      <p className={dispText === \"STREAM OFF\" ? classes.hidetapBroadcast : classes.tapBroadcastText}>{dispText}</p>\r\n    </Collapse>\r\n  </div >\r\n  }}</Observer>\r\n  //},\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  //  []\r\n\r\n   // )\r\n}\r\nZoneAvatar.displayName = 'ZoneAvatar'\r\n","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAADeUlEQVR4nO2c0W3bMBRFj4v+1xtUmaDeIOoEzQZ1N8gGyQjpBHU36AZ1J6izAbOBM0H6QRtxVMVNY1J6F7oHEGIIwiPhEz3yUaJnDw8PGE3ejN0B83osTxjLE8byhLE8YSxPGMsTxvKEsTxhLE8YyxPG8oSxPGEsTxjLE8byhLE8YSxPGMsTxvKEsTxhLE8YyxPG8oSxPGEsTxjLE8byhHk7dgeOMAcWhWK1u7+b3ZEKxR2ViPIWwDXwqWIbX4HLivEHYRZsi9cS+DZQW9937ckSSd4C+D1wm9ICI01Yrkdo8zOwGqHdIkSRN+fvMe4e+AKcAbMTjjPg9kjbsgKjyOubVV6Sv9R0YuwE/PjHNZICo8jrYzNwe3ICpyzvvueclMDI8mrTIi5wyvI2iAucsjwQFzh1eSAscCrytj3n5gefJQVORV7fzPWm55oWIYFR1jZb4Gfn3KxwG1vgXefcHY+LAAlodsf7Z2KEWgudkrxr4KpAnI/AukCck5lK2oQs71eBOMsCMYowJXkAF+QHsafQFOhHESI+Sa/JlrzgfUMW2fJ01tml4fnxb3SmJm9PIgvszjifuzakwKmlzdeQxu7Ac6jdeQse011J9m+VrQrHrYqSvIY8Re/WaiU4P/i8qhC/Ckpps6GOuEPayvGLoiQvDdDG0E/vT0IpbSby6kZL+TskkVPyqnDcqijJg/wFr0fuQxiU0qbpYHnCqKVN13kHKMlrqF/nzXnZklkIlNJmQ/0679gidTiU5KUB2uh71yUsSmkzkeu8C8rtmN2zJadkmZQJWvLAdd4TlNKm6WB5wqilzQX5NYamcNw1ZfYCDoqSvIa6dd4VgV7rewlKabOhfp3XVI5fFCV5qXL8e1znVSOR09ol5VdC0i6u5VVkjdCYVBultGk6WJ4wkeW1Y3dgR3d8DTMuRpHX94W0Q3eihwXwoXMuzBtmUSYsG/JU/bCOuyLXXWmE/kC+45Y958PIi7K5EsptfqzJHYEK+Ujy5uT/6pA7cnaEWj6LMuZBHvdajv9C31jsf4FwPXI/nhDpzjtkuTvOj19WnVsen7CnUXvSQ1R55gVESpvmP7E8YSxPGMsTxvKEsTxhLE8YyxPG8oSxPGEsTxjLE8byhLE8YSxPGMsTxvKEsTxhLE8YyxPG8oSxPGEsTxjLE8byhLE8YSxPGMsT5g9FnpQ4jUiu6wAAAABJRU5ErkJggg==\"","import stereoParameters from './StereoParameters'\r\nexport const stereoParametersStore = stereoParameters\r\n","import {MAP_SIZE} from '@components/Constants'\r\nimport {ISharedContent} from '@models/ISharedContent'\r\nimport {LocalParticipant, ParticipantBase, PARTICIPANT_SIZE, PlaybackParticipant, RemoteParticipant} from '@models/Participant'\r\nimport {getRect, isCircleInRect, Pose2DMap} from '@models/utils'\r\nimport {convertToAudioCoordinate, getRelativePose, mulV2, normV} from '@models/utils'\r\nimport {stereoParametersStore} from '@stores/AudioParameters'\r\nimport participants from '@stores/participants/Participants'\r\nimport contents from '@stores/sharedContents/SharedContents'\r\nimport _ from 'lodash'\r\nimport {autorun, IObservableValue, IReactionDisposer} from 'mobx'\r\nimport {NodeGroup, NodeGroupForPlayback} from './NodeGroup'\r\n\r\nconst audioLog = false ? console.log : ()=>{}\r\n\r\nfunction getRelativePoseFromObject(localPose: Pose2DMap, participant: ParticipantBase|undefined,\r\n                                   content: ISharedContent|undefined) {\r\n  const remotePose = _.cloneDeep(participant ? participant.pose :\r\n    content ? content.pose : {position:[0, 0], orientation:0}) as Pose2DMap\r\n  if (content) {\r\n    localPose.position.forEach((pos, idx) => {\r\n      if (localPose.position[idx] > remotePose.position[idx]) {\r\n        const fromLT = localPose.position[idx] - remotePose.position[idx]\r\n        remotePose.position[idx] += Math.min(content.size[idx], fromLT > 0 ? fromLT : 0)\r\n      }\r\n    })\r\n  }\r\n\r\n  return getRelativePose(localPose, remotePose)\r\n}\r\n\r\nexport class ConnectedGroup {\r\n  private readonly disposers: IReactionDisposer[] = []\r\n\r\n  //  content or remote will be given.\r\n  constructor(obsLocal: IObservableValue<LocalParticipant>, content: ISharedContent|undefined,\r\n    remote: RemoteParticipant|undefined, group: NodeGroup) {\r\n    this.disposers.push(autorun(()=>{\r\n        const local = obsLocal.get()\r\n        const base = _.clone(local.pose)\r\n        if (local.soundLocalizationBase === 'user') { base.orientation = 0 }\r\n        const relativePose = getRelativePoseFromObject(base, remote, content)\r\n        if (remote){\r\n          let remoteInLocalsZone = false  //  Remote is in local's zone or connected by yarn phone.\r\n          let inOtherClosedZone = false\r\n            //  Check where is the remote and the yarn phone connection.\r\n          if (participants.yarnPhones.has(remote.id)){\r\n            remoteInLocalsZone = true\r\n          }else if (remote.closedZone){\r\n            if(remote.closedZone === local.zone){\r\n              remoteInLocalsZone = true\r\n            }else{\r\n              inOtherClosedZone = true\r\n            }\r\n          }\r\n          if (!(inOtherClosedZone||remoteInLocalsZone) && local.zone){\r\n            const rect = getRect(local.zone.pose, local.zone.size)\r\n            remoteInLocalsZone = isCircleInRect(remote.pose.position, 0.5*PARTICIPANT_SIZE, rect)\r\n            inOtherClosedZone = !remoteInLocalsZone && (local.zone.zone==='close' || remote.closedZone?.zone==='close')\r\n          }\r\n          if (!remote.physics.located || inOtherClosedZone) {\r\n            // Not located yet or in different clozed zone -> mute audio\r\n            group.updatePose(convertToAudioCoordinate({orientation:0, position:[MAP_SIZE, MAP_SIZE]}))\r\n            audioLog(`mute ${remote.id} loc:${remote.physics.located} other:${inOtherClosedZone} rInL:${remoteInLocalsZone}`)\r\n          }else{\r\n            if (remoteInLocalsZone){  //  In zone -> make distance very small (1)\r\n              audioLog(`In zone: cid:${remote.id}`)\r\n              const distance = normV(relativePose.position)\r\n              if (distance > 1e-10){ relativePose.position = mulV2(1/distance, relativePose.position) }\r\n            }\r\n            // locate sound source\r\n            group.updatePose(convertToAudioCoordinate(relativePose))\r\n          }\r\n        }else if (content){\r\n          // locate sound source.\r\n          const contentInLocalsZone = local.zone ?\r\n            (content.overlapZones.includes(local.zone) || content.surroundingZones.includes(local.zone)) : false\r\n          const inOtherClosedZone = !contentInLocalsZone && content.surroundingZones.find(z => z.zone === 'close')\r\n          if (contentInLocalsZone){\r\n            //  make distance very small (1)\r\n            audioLog(`In zone: cid:${content.id}`)\r\n            const distance = normV(relativePose.position)\r\n            if (distance > 1e-10){\r\n              relativePose.position = mulV2(1/distance, relativePose.position)\r\n            }\r\n          }else if (inOtherClosedZone) {\r\n            // In different clozed zone -> mute audio\r\n            group.updatePose(convertToAudioCoordinate({orientation:0, position:[MAP_SIZE, MAP_SIZE]}))\r\n            audioLog(`mute ${content.id} other:${inOtherClosedZone} cInL:${contentInLocalsZone}`)\r\n          }\r\n          const pose = convertToAudioCoordinate(relativePose)\r\n          group.updatePose(pose)\r\n        }else{\r\n          console.error(`participant or content must be specified`)\r\n        }\r\n      },\r\n    ))\r\n\r\n    this.disposers.push(autorun(\r\n      () => {\r\n        const track = remote ? remote.tracks.audio : contents.getContentTrack(content!.id, 'audio')\r\n        const ms = new MediaStream()\r\n        if (track){\r\n          ms.addTrack(track)\r\n          group.updateStream(ms)\r\n        }\r\n      },\r\n    ))\r\n\r\n    this.disposers.push(autorun(\r\n      () => group.updatePannerConfig(stereoParametersStore),\r\n    ))\r\n\r\n    this.disposers.push(autorun(\r\n      () => group.updateBroadcast(remote?.physics.onStage ? true : false),\r\n    ))\r\n  }\r\n\r\n  dispose() {\r\n    for (const disposer of this.disposers) {\r\n      disposer()\r\n    }\r\n  }\r\n}\r\n\r\nexport class ConnectedGroupForPlayback {\r\n  private readonly disposers: IReactionDisposer[] = []\r\n\r\n  constructor(obsLocal: IObservableValue<LocalParticipant>, group: NodeGroupForPlayback, participant?: PlaybackParticipant, cid?: string) {\r\n    this.disposers.push(autorun(\r\n      () => {\r\n        const local = obsLocal.get()\r\n        const base = _.clone(local.pose)\r\n        if (local.soundLocalizationBase === 'user') { base.orientation = 0 }\r\n        let content\r\n        if (!participant && cid){\r\n          content = contents.findPlayback(cid)\r\n        }\r\n        // locate sound source.\r\n        const relativePose = getRelativePoseFromObject(base, participant, content)\r\n        const pose = convertToAudioCoordinate(relativePose)\r\n        group.updatePose(pose)\r\n        //if (content) console.log(`updatePose: ${JSON.stringify(content)}`)\r\n      },\r\n    ))\r\n\r\n    this.disposers.push(autorun(\r\n      () => {\r\n        //console.log(`playBlob(${play.audioBlob})`)\r\n        let content\r\n        if (!participant && cid){\r\n          content = contents.findPlayback(cid)\r\n        }\r\n        group.playBlob(participant ? participant.audioBlob : content?.audioBlob)\r\n        //if (content) console.log(`playBlob: ${JSON.stringify(content?.audioBlob)} c:${JSON.stringify(content)}`)\r\n      },\r\n    ))\r\n\r\n    this.disposers.push(autorun(\r\n      () => group.updatePannerConfig(stereoParametersStore),\r\n    ))\r\n  }\r\n\r\n  dispose() {\r\n    for (const disposer of this.disposers) {\r\n      disposer()\r\n    }\r\n  }\r\n}\r\n","import { conference } from '@models/conference'\r\nimport {assert} from '@models/utils'\r\nimport errorInfo from '@stores/ErrorInfo'\r\nimport {autorun} from 'mobx'\r\nimport {NodeGroup, NodeGroupForPlayback, PlayMode, setAudioOutputDevice} from './NodeGroup'\r\n\r\nexport class StereoManager {\r\n  private readonly audioContext: AudioContext = new window.AudioContext()\r\n  private readonly audioDestination = this.audioContext.createMediaStreamDestination()\r\n\r\n  private readonly audioElement = new Audio()   //  audioElement for context mode\r\n  private playMode: PlayMode = 'Pause'\r\n\r\n\r\n  nodes: {\r\n    [key: string]: NodeGroup,\r\n  } = {}\r\n\r\n  constructor() {\r\n    if (false) {\r\n      //  For ACE workaround for chrome, make local RTC loopback. But it also make sound monaural and useless.\r\n      const peerGo = new RTCPeerConnection()\r\n      const peerBack = new RTCPeerConnection()\r\n      this.audioDestination.stream.getAudioTracks().forEach(track => peerGo.addTrack(track))\r\n      let inboundStream:MediaStream|undefined = undefined\r\n      peerBack.ontrack = (ev) => {\r\n        if (ev.streams && ev.streams[0]) {\r\n          this.audioElement.srcObject = ev.streams[0]\r\n        }else {\r\n          if (!inboundStream) {\r\n            inboundStream = new MediaStream()\r\n          }\r\n          inboundStream.addTrack(ev.track)\r\n          this.audioElement.srcObject = inboundStream\r\n        }\r\n      }\r\n      peerGo.createOffer().then((offer) => {\r\n        return peerGo.setLocalDescription(offer)\r\n      }).then(() => {\r\n        console.log('peerGo set offer.')\r\n      }).catch((reason) => {\r\n        console.error('peerGo set offer failed', reason)\r\n      })\r\n\r\n      let bAnswerSent = false\r\n      peerGo.onicecandidate = (ev) => {\r\n        if (bAnswerSent) { return }\r\n        bAnswerSent = true\r\n\r\n        const offer = peerGo.localDescription\r\n        if (offer) {\r\n          peerBack.setRemoteDescription(offer).then(() => {\r\n            peerBack.createAnswer().then((answer) => {\r\n              peerBack.setLocalDescription(answer)\r\n              console.log('peerBack set answer.')\r\n\r\n              console.log('peerGo.signalingState', peerGo.signalingState)\r\n              peerGo.setRemoteDescription(answer)\r\n              .then(() => {\r\n                console.log('peerGo set answer.')\r\n              }).catch((err) => {\r\n                console.error('peerGo set answer failed:', err)\r\n              })\r\n            })\r\n          })\r\n        }else {\r\n          console.error('onicecnadidate: offer is null')\r\n        }\r\n      }\r\n    }else {\r\n      this.audioElement.srcObject = this.audioDestination.stream\r\n    }\r\n  }\r\n\r\n  addSpeaker(id: string) {\r\n    assert(this.nodes[id] === undefined)\r\n    this.nodes[id] = new NodeGroup(this.audioContext, this.audioDestination,\r\n                                   this.playMode, !this.audioOutputMuted)\r\n\r\n    return this.nodes[id]\r\n  }\r\n  addPlayback(id: string) {\r\n    assert(this.nodes[id] === undefined)\r\n    const node = new NodeGroupForPlayback(this.audioContext, this.audioDestination,\r\n                                   this.playMode, !this.audioOutputMuted)\r\n    this.nodes[id] = node\r\n\r\n    return node\r\n  }\r\n  removeSpeaker(id: string) {\r\n    //  console.log('remove speaker')\r\n    this.nodes[id].disconnect()\r\n    delete this.nodes[id]\r\n  }\r\n\r\n  switchPlayMode(playMode: PlayMode, muted: boolean) {\r\n    assert(playMode !== 'Pause')\r\n    if (this.playMode === 'Pause') {\r\n      //  this occurs only once when valid playMode has been set\r\n      autorun(() => {\r\n        const accepts = new Set(conference.priorityCalculator.tracksToConsume.audios.map(\r\n          info => info.producer.role === 'avatar' ? info.producer.peer.peer : info.producer.role\r\n        ))\r\n        for (const id in this.nodes) {\r\n          if (accepts.has(id) || this.nodes[id] instanceof NodeGroupForPlayback) {\r\n            this.nodes[id].setPlayMode(this.playMode)\r\n          }else {\r\n            this.nodes[id].setPlayMode('Pause')\r\n          }\r\n        }\r\n      })\r\n    }\r\n\r\n    if (playMode === this.playMode && muted === this.audioOutputMuted) {\r\n      return\r\n    }\r\n    this.playMode = playMode\r\n\r\n    switch (playMode) {\r\n      case 'Context':\r\n        // For Chrome, resume audio context when loaded (https://goo.gl/7K7WLu)\r\n        // AudioContext must be resumed (or created) after a user gesture on the page.\r\n        const interval = setInterval(\r\n          () => {\r\n            if (errorInfo.type) { return }\r\n            // console.log(`Audio context = ${this.audioContext.state}  element = ${this.audioElement.played}`)\r\n            if (this.audioContext.state !== 'suspended') {\r\n              //  console.log('AudioContext successfully resumed')\r\n              clearInterval(interval)\r\n            }\r\n            this.audioContext.resume()\r\n            this.audioElement.play()  //  play() must be delayed\r\n          },\r\n          1000,\r\n        )\r\n\r\n        for (const id in this.nodes) {\r\n          this.nodes[id].setPlayMode(playMode)\r\n        }\r\n        break\r\n\r\n      case 'Element':\r\n        this.audioContext.suspend()\r\n        this.audioElement.pause()\r\n\r\n        for (const id in this.nodes) {\r\n          this.nodes[id].setPlayMode(playMode)\r\n        }\r\n        break\r\n\r\n      default:\r\n        console.error(`Unsupported play mode: ${playMode}`)\r\n        break\r\n    }\r\n\r\n    this.audioOutputMuted = muted\r\n  }\r\n\r\n  setAudioOutput(deviceId:string) {\r\n    setAudioOutputDevice(this.audioElement, deviceId)\r\n    for (const node in this.nodes) {\r\n      this.nodes[node].setAudioOutput(deviceId)\r\n    }\r\n\r\n  }\r\n\r\n  set audioOutputMuted(muted: boolean) {\r\n    for (const id in this.nodes) {\r\n      this.nodes[id].updateAudibility(!muted)\r\n    }\r\n    this.audioDestination.stream.getTracks().forEach((track) => { track.enabled = !muted })\r\n  }\r\n  get audioOutputMuted():boolean {\r\n    return !(this.audioDestination.stream.getTracks().length > 0\r\n      && this.audioDestination.stream.getTracks()[0].enabled)\r\n  }\r\n}\r\n","import {ConnectedManager} from './ConnectedManager'\r\n\r\nexport const manager = new ConnectedManager()\r\n","import { IPlaybackContent, ISharedContent } from '@models/ISharedContent'\r\nimport {PlaybackContent, PlaybackParticipant, RemoteParticipant} from '@models/Participant'\r\nimport {urlParameters} from '@models/url'\r\nimport {diffMap} from '@models/utils'\r\nimport participants from '@stores/participants/Participants'\r\nimport contents from '@stores/sharedContents/SharedContents'\r\nimport {autorun} from 'mobx'\r\nimport {ConnectedGroup, ConnectedGroupForPlayback} from './ConnectedGroup'\r\nimport {StereoManager} from './StereoManager'\r\nexport class ConnectedManager {\r\n  private readonly manager = new StereoManager()\r\n\r\n  private readonly connectedGroups: {\r\n    [key: string]: ConnectedGroup|ConnectedGroupForPlayback,\r\n  } = {}\r\n\r\n  private remotesMemo = new Map<string, RemoteParticipant>()\r\n  private playbacksMemo = new Map<string, PlaybackParticipant>()\r\n  private contentsMemo = new Map<string, ISharedContent>()\r\n  private playbackContentsMemo = new Map<string, PlaybackContent>()\r\n\r\n  public setAudioOutput(deviceId: string) {\r\n    this.manager.setAudioOutput(deviceId)\r\n  }\r\n  constructor() {\r\n    if (urlParameters.testBot !== null) { return }\r\n\r\n    autorun(this.onRemotesChange)\r\n    autorun(this.onPlaybacksChange)\r\n    autorun(this.onPlaybackContentsChange)\r\n    autorun(this.onScreenContentsChange)\r\n    autorun(\r\n      () => {\r\n        const muteSpeaker = participants.local.muteSpeaker || participants.local.physics.awayFromKeyboard\r\n        this.manager.switchPlayMode(participants.local.useStereoAudio ? 'Context' : 'Element', muteSpeaker)\r\n      },\r\n    )\r\n  }\r\n\r\n  private onRemotesChange = () => {\r\n    const newRemotes = new Map(participants.remote)\r\n    const added = diffMap(newRemotes, this.remotesMemo)\r\n    const removed = diffMap(this.remotesMemo, newRemotes)\r\n    removed.forEach(this.removeRemote)\r\n    added.forEach(this.addRemote)\r\n    this.remotesMemo = newRemotes\r\n    //  console.log('Update connectedGroups:', this.connectedGroups)\r\n  }\r\n  private onPlaybacksChange = () => {\r\n    const newPlaybacks = new Map(participants.playback)\r\n    const added = diffMap(newPlaybacks, this.playbacksMemo)\r\n    const removed = diffMap(this.playbacksMemo, newPlaybacks)\r\n    removed.forEach(this.removePlayback)\r\n    added.forEach(this.addPlayback)\r\n    this.playbacksMemo = newPlaybacks\r\n    //  console.log('Update connectedGroups:', this.connectedGroups)\r\n  }\r\n  private onPlaybackContentsChange = () => {\r\n    const newPlaybackContents = new Map(contents.playbackContents)\r\n    const added = diffMap(newPlaybackContents, this.playbackContentsMemo)\r\n    const removed = diffMap(this.playbackContentsMemo, newPlaybackContents)\r\n    removed.forEach(this.removePlayback)\r\n    added.forEach(this.addPlaybackContent)\r\n    this.playbackContentsMemo = newPlaybackContents\r\n    //  console.log('Update connectedGroups:', this.connectedGroups)\r\n  }\r\n\r\n  private onScreenContentsChange = () => {\r\n    const audioRemoteContents = contents.getRemoteRtcContentIds().filter(cid => contents.getContentTrack(cid, 'audio'))\r\n    const newRemotes = new Map(audioRemoteContents.map(cid => [cid, contents.find(cid)!]))\r\n    const added = diffMap(newRemotes, this.contentsMemo)\r\n    const removed = diffMap(this.contentsMemo, newRemotes)\r\n    removed.forEach(this.removeContent)\r\n    added.forEach(this.addContent)\r\n    this.contentsMemo = newRemotes\r\n  }\r\n\r\n  private removePlayback = (pp: PlaybackParticipant | IPlaybackContent) => {\r\n    const id = pp.id\r\n    this.connectedGroups[id].dispose()\r\n    delete this.connectedGroups[id]\r\n\r\n    this.manager.removeSpeaker(id)\r\n  }\r\n  private addPlayback = (pp: PlaybackParticipant) => {\r\n    const id = pp.id\r\n    const group = this.manager.addPlayback(id)\r\n    this.connectedGroups[id] = new ConnectedGroupForPlayback(participants.local_, group, pp)\r\n  }\r\n  private addPlaybackContent = (pc: IPlaybackContent) => {\r\n    //  console.log(`addPlaybackContent: ${JSON.stringify(pc)}`)\r\n    const id = pc.id\r\n    const group = this.manager.addPlayback(id)\r\n    this.connectedGroups[id] = new ConnectedGroupForPlayback(participants.local_, group, undefined, pc.id)\r\n  }\r\n\r\n  private removeRemote = (rp: RemoteParticipant) => {\r\n    const id = rp.id\r\n    this.connectedGroups[id].dispose()\r\n    delete this.connectedGroups[id]\r\n\r\n    this.manager.removeSpeaker(id)\r\n  }\r\n  private addRemote = (remote: RemoteParticipant) => {\r\n    const group = this.manager.addSpeaker(remote.id)\r\n    this.connectedGroups[remote.id] = new ConnectedGroup(participants.local_, undefined, remote, group)\r\n  }\r\n\r\n  private removeContent = (content: ISharedContent) => {\r\n    this.connectedGroups[content.id].dispose()\r\n    delete this.connectedGroups[content.id]\r\n    this.manager.removeSpeaker(content.id)\r\n  }\r\n  private addContent = (content: ISharedContent) => {\r\n    const group = this.manager.addSpeaker(content.id)\r\n    this.connectedGroups[content.id] = new ConnectedGroup(participants.local_, content, undefined, group)\r\n  }\r\n}\r\n","import participants from '@stores/participants/Participants'\r\nimport * as Kalidokit from 'kalidokit'\r\nimport {Holistic} from '@mediapipe/holistic'\r\nimport {FaceMesh} from '@mediapipe/face_mesh'\r\nimport {VRMRigs} from '@models/Participant'\r\nimport {dataRequestInterval} from '@models/conference/DataConnection'\r\n\r\n// config.js\r\ndeclare const config:any                  //  from ../../config.js included from index.html\r\n\r\nlet holistic = new Holistic({locateFile: (file) => {\r\n  return `https://cdn.jsdelivr.net/npm/@mediapipe/holistic/${file}`;\r\n}})\r\nholistic.setOptions({\r\n  modelComplexity: 1,\r\n  smoothLandmarks: true,\r\n  minDetectionConfidence: 0.7,\r\n  minTrackingConfidence: 0.7,\r\n  refineFaceLandmarks:true\r\n})\r\n\r\nlet faceMesh = new FaceMesh({locateFile: (file) => {\r\n  return `https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${file}`;\r\n}})\r\nfaceMesh.setOptions({\r\n  //enableFaceGeometry?: boolean;\r\n  //selfieMode?: boolean;\r\n  maxNumFaces: 1,\r\n  refineLandmarks: true,\r\n})\r\n\r\n//  camera device selection\r\nlet videoEl: HTMLVideoElement|undefined\r\nlet runMeidaPipe = false\r\nexport function stopMpTrack(){\r\n  if (videoEl){\r\n    videoEl.srcObject = null\r\n    videoEl.remove()\r\n    videoEl = undefined\r\n  }\r\n  runMeidaPipe = false\r\n}\r\nexport function startMpTrack(faceOnly: boolean, did?:string) {\r\n  stopMpTrack()\r\n  const promise = new Promise<void>((resolutionFunc, rejectionFunc) => {\r\n    if (!did) did = participants.local.devicePreference.videoInputDevice\r\n\r\n    const rtcVideo = {...config.rtc.videoConstraints.video,\r\n      width:{\r\n        ideal:320,\r\n      },\r\n      height:{\r\n        ideal:240,\r\n      },\r\n      frameRate: {\r\n        ideal: 10,\r\n      },\r\n    }\r\n    navigator.mediaDevices.getUserMedia(\r\n      {video:{\r\n        deviceId:did,\r\n        ...rtcVideo\r\n      }}\r\n    ).then((ms)=>{\r\n      //  media-pipe\r\n      videoEl = window.document.createElement('video') as HTMLVideoElement\r\n      videoEl.srcObject = ms\r\n      videoEl.autoplay = true\r\n      if (faceOnly){\r\n        faceMesh.onResults(results=>{\r\n          const facelm = results.multiFaceLandmarks[0]\r\n          const vrmRigs: VRMRigs = {\r\n            face:facelm && Kalidokit.Face.solve(facelm,{\r\n              runtime:'mediapipe',\r\n              video:videoEl,\r\n            })\r\n          }\r\n          participants.local.vrmRigs = vrmRigs\r\n        })\r\n      }else{\r\n        holistic.onResults(results=>{\r\n          //console.log('results:', results)\r\n          // do something with prediction results\r\n          // landmark names may change depending on TFJS/Mediapipe model version\r\n          const facelm = results.faceLandmarks\r\n          const poselm = results.poseLandmarks\r\n          const poselm3d = (results as any).za\r\n          const rightHandlm = results.rightHandLandmarks\r\n          const leftHandlm = results.leftHandLandmarks\r\n          const vrmRigs: VRMRigs = {\r\n            face:facelm && Kalidokit.Face.solve(facelm,{\r\n              runtime:'mediapipe',\r\n              video:videoEl,\r\n            }),\r\n            pose:(poselm3d&&poselm) && Kalidokit.Pose.solve(poselm3d,poselm,{\r\n              runtime:'mediapipe',\r\n              video:videoEl,\r\n              imageSize: { height: 0, width: 0 },\r\n              enableLegs: true,\r\n            }),\r\n            leftHand: leftHandlm && Kalidokit.Hand.solve(leftHandlm,\"Left\"),\r\n            rightHand: rightHandlm && Kalidokit.Hand.solve(rightHandlm,\"Right\"),\r\n          }\r\n          participants.local.vrmRigs = vrmRigs\r\n        })\r\n      }\r\n      function timer(detector:Holistic | FaceMesh){\r\n        if (runMeidaPipe){\r\n          if (videoEl?.videoWidth){\r\n            detector.send({image: videoEl}).then(()=>{\r\n              window.setTimeout(()=>{timer(detector)}, dataRequestInterval)\r\n            })\r\n          }else{\r\n            window.setTimeout(()=>{timer(detector)}, dataRequestInterval)\r\n          }\r\n        }\r\n      }\r\n      runMeidaPipe = true\r\n      timer(faceOnly ? faceMesh : holistic)\r\n      resolutionFunc()\r\n    }).catch(rejectionFunc)\r\n  })\r\n\r\n  return promise\r\n}\r\n","import {getNotificationPermission} from '@models/conference/Notification'\r\nimport {manager as audioManager} from '@models/audio'\r\nimport {urlParameters} from '@models/url'\r\nimport participants from '@stores/participants/Participants'\r\nimport {autorun} from 'mobx'\r\nimport {stopMpTrack, startMpTrack} from './mediapipeCamera'\r\nimport {stopFaceTrack, createLocalCamera} from './faceCamera'\r\nimport {MSTrack} from '@models/utils'\r\nimport {conference} from '@models/conference'\r\n\r\n//  mic device selection\r\nexport function createLocalMic() {\r\n  //  console.log(`createLocalMic() called`)\r\n  const promise = new Promise<MSTrack>((resolutionFunc, rejectionFunc) => {\r\n    const did = participants.local.devicePreference.audioInputDevice\r\n    navigator.mediaDevices.getUserMedia({\r\n      audio:{deviceId: did}\r\n    }).then((ms)=>{\r\n      const track = ms.getAudioTracks()[0]\r\n      if (track){\r\n        resolutionFunc({track, peer:participants.local.id, role:'avatar'})\r\n      }\r\n    }).catch(rejectionFunc)\r\n  })\r\n\r\n  return promise\r\n}\r\n\r\n//  mic mute and audio input device selection\r\nfunction isMicMuted(){\r\n  return participants.local.muteAudio || participants.local.physics.awayFromKeyboard ||\r\n    !participants.localId || urlParameters.testBot !== null\r\n}\r\nautorun(() => {\r\n  const did = participants.local.devicePreference.audioInputDevice\r\n  //  console.log(`isMicMuted === ${isMicMuted()}`)\r\n  if (isMicMuted()){\r\n    conference.setLocalMicTrack(undefined).then(()=>{\r\n      participants.local.audioLevel = 0\r\n    })\r\n  }else{\r\n    const track = conference.getLocalMicTrack()\r\n    if (track && track.deviceId === did) { return }\r\n    createLocalMic().then((track)=>{\r\n      if (isMicMuted()){\r\n        track.track?.stop()\r\n      }else{\r\n        conference.setLocalMicTrack(track)\r\n      }\r\n    }).finally(getNotificationPermission)\r\n  }\r\n})\r\n\r\n\r\n//  headphone or audio output device update\r\nautorun(() => {\r\n  const did = participants.local.devicePreference.audioOutputDevice\r\n  if (did) {\r\n    audioManager.setAudioOutput(did)\r\n  }\r\n})\r\n\r\n//  camera mute and camera device update\r\nconst DELETE_TRACK = true\r\nfunction isCameraMuted(){\r\n  return participants.local.muteVideo || participants.local.physics.awayFromKeyboard ||\r\n    !participants.localId || urlParameters.testBot !== null\r\n}\r\nautorun(() => {\r\n  const did = participants.local.devicePreference.videoInputDevice\r\n  const faceTrack = participants.local.information.faceTrack\r\n  if (isCameraMuted()) {\r\n    stopMpTrack()\r\n    stopFaceTrack()\r\n    if (DELETE_TRACK){\r\n      conference.setLocalCameraTrack(undefined).then(track => track?.track.stop())\r\n    } else {\r\n      const track = conference.getLocalCameraTrack()\r\n      if (track) { conference.removeLocalTrack(track) }\r\n    }\r\n  }else{\r\n    const isVrm = participants.local.information.avatarSrc.slice(-4) === '.vrm'\r\n    if (isVrm){\r\n      stopFaceTrack()\r\n      startMpTrack(!faceTrack)\r\n    }else{\r\n      stopMpTrack()\r\n      const track = conference.getLocalCameraTrack()\r\n      if (track && track.deviceId === did) { return }\r\n      createLocalCamera(faceTrack).then((track)=>{\r\n        if (!isCameraMuted()){\r\n          conference.setLocalCameraTrack(track)\r\n        }else{\r\n          track?.track.stop()\r\n        }\r\n      }).finally(getNotificationPermission)\r\n    }\r\n  }\r\n})\r\n","import {App} from '@components/App'\r\nimport '@models/audio'  // init audio manager (DO NOT delete)\r\nimport {i18nInit} from '@models/locales'\r\nimport {urlParameters} from '@models/url'\r\nimport {resolveAtEnd} from '@models/utils'\r\nimport errorInfo from '@stores/ErrorInfo'\r\nimport '@stores/index'  // init store (DO NOT delete)\r\nimport contents from '@stores/sharedContents/SharedContents'\r\nimport {when} from 'mobx'\r\nimport {configure} from \"mobx\"\r\nimport ReactDOM from 'react-dom'\r\nimport {conference} from '@models/conference'\r\nimport {participants} from '@stores/index'\r\nimport {} from '@models/conference/chooseDevice'\r\n\r\nconfigure({\r\n    enforceActions: \"never\",\r\n})\r\n\r\n\r\ni18nInit().then(main)\r\n\r\nfunction main() {\r\n  const startPromise = resolveAtEnd(onStart)()\r\n  startPromise.then(resolveAtEnd(renderDOM))\r\n  startPromise.then(resolveAtEnd(startConference))\r\n}\r\n\r\nfunction onStart() {\r\n  //  console.debug('start')\r\n}\r\n\r\nfunction renderDOM() {\r\n  ReactDOM.render(\r\n      <App />,\r\n    document.getElementById('root')\r\n  )\r\n}\r\n\r\nlet logStr = ''\r\nfunction startConference() {\r\n  window.addEventListener('beforeunload', (ev) => {\r\n    logStr = `${logStr}beforeunload called. ${Date()} `\r\n    localStorage.setItem('log', logStr)\r\n\r\n    //  prevent leaving from and reloading browser, when the user shares screen(s).\r\n    if (!errorInfo.type &&\r\n      (contents.getLocalRtcContentIds().length || contents.mainScreenOwner === participants.localId)) {\r\n      logStr += 'Ask user. '\r\n      ev.preventDefault()\r\n      ev.stopImmediatePropagation()\r\n      ev.returnValue = ''\r\n      localStorage.setItem('log', logStr)\r\n\r\n      return ev.returnValue\r\n    }\r\n    conference.leave()\r\n  })\r\n\r\n  errorInfo.connectionStart()\r\n  when(() => errorInfo.type === '', () => {\r\n    const room = urlParameters.room || '_'\r\n    conference.enter(room)\r\n  })\r\n}\r\n"],"sourceRoot":""}
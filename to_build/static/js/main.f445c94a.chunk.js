(this["webpackJsonpbinaural-meet"]=this["webpackJsonpbinaural-meet"]||[]).push([[0],[,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i.a})),n.d(t,"K",(function(){return i.j})),n.d(t,"f",(function(){return i.c})),n.d(t,"g",(function(){return i.d})),n.d(t,"s",(function(){return i.f})),n.d(t,"h",(function(){return i.e})),n.d(t,"x",(function(){return i.i})),n.d(t,"v",(function(){return i.g})),n.d(t,"w",(function(){return i.h})),n.d(t,"c",(function(){return i.b})),n.d(t,"j",(function(){return a})),n.d(t,"k",(function(){return r})),n.d(t,"i",(function(){return s})),n.d(t,"P",(function(){return c})),n.d(t,"O",(function(){return l})),n.d(t,"I",(function(){return u})),n.d(t,"a",(function(){return d.a})),n.d(t,"N",(function(){return d.r})),n.d(t,"z",(function(){return d.h})),n.d(t,"A",(function(){return d.i})),n.d(t,"B",(function(){return d.k})),n.d(t,"D",(function(){return d.m})),n.d(t,"r",(function(){return d.e})),n.d(t,"d",(function(){return d.b})),n.d(t,"J",(function(){return d.o})),n.d(t,"e",(function(){return d.c})),n.d(t,"Q",(function(){return d.s})),n.d(t,"H",(function(){return d.n})),n.d(t,"q",(function(){return d.d})),n.d(t,"t",(function(){return d.f})),n.d(t,"C",(function(){return d.l})),n.d(t,"y",(function(){return d.g})),n.d(t,"M",(function(){return d.q})),n.d(t,"L",(function(){return d.p})),n.d(t,"E",(function(){return p})),n.d(t,"p",(function(){return h.d})),n.d(t,"m",(function(){return h.b})),n.d(t,"u",(function(){return h.e})),n.d(t,"l",(function(){return h.a})),n.d(t,"F",(function(){return h.f})),n.d(t,"o",(function(){return h.c})),n.d(t,"G",(function(){return h.g})),n.d(t,"n",(function(){return f}));var i=n(129),o=n(58);function a(e){return Math.abs(Math.sign(e.a)*Math.sqrt(Math.pow(e.a,2)+Math.pow(e.c,2)))}function r(e){return Math.abs(Math.sign(e.d)*Math.sqrt(Math.pow(e.b,2)+Math.pow(e.d,2)))}function s(e){return Math.atan2(-e.c,e.a)}function c(e,t,n){var i,a=(new DOMMatrix).translate(-e[0],-e[1]),r=(i=new DOMMatrix).translateSelf.apply(i,Object(o.a)(e));return[r,t,a,n].reduce((function(e,t){return e.multiplySelf(t)}),new DOMMatrix)}function l(e,t){return[e.a*t[0]+e.c*t[1]+e.e,e.b*t[0]+e.d*t[1]+e.f]}function u(e,t){return[e.a*t[0]+e.c*t[1],e.b*t[0]+e.d*t[1]]}var d=n(92);function p(e){return function(){return new Promise((function(t,n){try{e(),t()}catch(i){throw n(i),i}}))}}var h=n(135);function f(e){return new Promise((function(t,n){var i=new XMLHttpRequest;i.timeout=5e3,i.open("GET",e),i.onreadystatechange=function(){if(this.readyState===this.LOADING){var e=this.getResponseHeader("Content-Type");this.abort(),t(e)}},i.send()}))}},,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return re})),n.d(t,"a",(function(){return ce}));var i,o,a,r,s,c,l,u,p,h,f,m,v,g,b,y,A,S,E,O,C,j,T,k,_,R,I,w,D,P=n(14),M=n(58),N=n(8),x=n(25),L=n(34),F=n(33),B=n(23),U=n(6),V=n(10),J=(n(84),n(30)),G=n(26),H=n(49),z=n(51),Q=n(3),K=n(13),W=n(57),Y=n(44),q=n.n(Y),X=n(2),Z=n(41),$=n(90),ee=n(61),te=n.n(ee),ne=function(e){Object(L.a)(n,e);var t=Object(F.a)(n);function n(){var e;Object(U.a)(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).jitsiConnection=void 0,e.jitsiConference=void 0,e.localId="",e}return Object(N.a)(n,[{key:"init",value:function(){var e=this;return new Promise((function(t,n){e.initJitsiConnection().then((function(){e.jitsiConnection?(e.jitsiConference=e.jitsiConnection.initJitsiConference(J.b.conference.name,config),e.jitsiConference.on(te.a.events.conference.CONFERENCE_JOINED,(function(){e.localId=e.jitsiConference.myUserId(),e.jitsiConference.setPerceptibles({audibles:[],visibleContents:[],visibleParticipants:[]}),setTimeout((function(){e.jitsiConference.setPerceptibles({audibles:[],visibleContents:[],visibleParticipants:[]})}),1e3),t("")})),e.jitsiConference.setDisplayName($.b),e.jitsiConference.join(""),e.jitsiConference.setSenderVideoConstraint(1080)):n("No connection has been established.")}))}))}},{key:"addTrack",value:function(e){this.jitsiConference?this.jitsiConference.addTrack(e):console.error("Not joined to conference yet.")}},{key:"removeTrack",value:function(e){return this.jitsiConference?this.jitsiConference.removeTrack(e):(console.error("Not joined to conference yet."),Promise.reject())}},{key:"getParticipantId",value:function(){return Object(Q.b)(this.jitsiConference),this.localId}},{key:"getLocalTracks",value:function(){var e,t=null===(e=this.jitsiConference)||void 0===e?void 0:e.getLocalTracks();return t||[]}},{key:"initJitsiConnection",value:function(){var e=this;return new Promise((function(t,n){e.jitsiConnection=new te.a.JitsiConnection(null,void 0,config),e.jitsiConnection.addEventListener(te.a.events.connection.CONNECTION_ESTABLISHED,(function(){t(te.a.events.connection.CONNECTION_ESTABLISHED)})),e.jitsiConnection.addEventListener(te.a.events.connection.CONNECTION_FAILED,(function(){n(te.a.events.connection.CONNECTION_FAILED)})),e.jitsiConnection.connect()}))}},{key:"disconnect",value:function(){var e=this;return new Promise((function(t,n){var i;e.jitsiConnection?e.jitsiConference?e.jitsiConference.leave().then((function(){var n;null===(n=e.jitsiConnection)||void 0===n||n.disconnect().then((function(){t("")})).catch((function(t){console.log("ConnForCont: Fail to disconnect by ".concat(t,". I'm:").concat(e.localId))}))})).catch((function(t){console.log("ConnForCont: Fail to leave by ".concat(t,". I'm:").concat(e.localId))})):null===(i=e.jitsiConnection)||void 0===i||i.disconnect().then((function(){t("")})).catch((function(t){console.log("ConnForCont no conf: Fail to disconnect by ".concat(t,". I'm:").concat(e.localId))})):n("No connection has been established.")}))}}]),n}(W.EventEmitter),ie="mainScreen",oe=function(){},ae=(i=X.h.shallow,o=X.h.shallow,a=function(){function e(t){Object(U.a)(this,e),this.sharedContents=void 0,Object(B.a)(this,"carrierMap",r,this),this.remoteTrackPool=new Map,this.localMainConnection=void 0,Object(B.a)(this,"localMains",s,this),this.contentCarriers=new Map,Object(B.a)(this,"localContents",c,this),Object(B.a)(this,"remoteMains",l,this),Object(B.a)(this,"remoteContents",u,this),Object(X.g)(this),this.sharedContents=t}return Object(N.a)(e,[{key:"allContentStreams",value:function(){var e=[];return this.localContents.forEach((function(t,n){t.size&&e.push({cid:n,stream:new MediaStream(Array.from(t).map((function(e){return e.getTrack()})))})})),this.remoteContents.forEach((function(t,n){t.size&&e.push({cid:n,stream:new MediaStream(Array.from(t).map((function(e){return e.getTrack()})))})})),e}},{key:"clearConnection",value:function(){this.clearAllRemotes(),this.clearLocalContentCarriers()}},{key:"clearAllRemotes",value:function(){this.carrierMap.clear(),this.remoteTrackPool.clear(),this.remoteMains.clear(),this.remoteContents.clear()}},{key:"clearLocalContentCarriers",value:function(){var e;this.contentCarriers.forEach((function(e){return e.disconnect()})),this.contentCarriers.clear(),null===(e=this.localMainConnection)||void 0===e||e.disconnect(),this.localMainConnection=void 0}},{key:"restoreLocalCarriers",value:function(){var e=this;if(this.localContents.forEach((function(t,n){e.createConnectionForContent(n,Array.from(t))})),this.localMains.size){var t=this.localMains;this.localMains=new Set,this.addLocalMains(Array.from(t))}}},{key:"onUpdateContent",value:function(e){var t=this;if(oe("update SC: id:".concat(e.id," pid:").concat(e.url," cid in map:").concat(this.carrierMap.get(e.url))),e.url){Object(Q.b)(!this.carrierMap.has(e.url)||this.carrierMap.get(e.url)===e.id),this.carrierMap.set(e.url,e.id);var n=this.remoteTrackPool.get(e.url);this.remoteTrackPool.delete(e.url),null===n||void 0===n||n.forEach((function(e){t.addRemoteContent(e)}))}}},{key:"addRemoteTrack",value:function(e){var t=e.getParticipantId(),n=this.carrierMap.get(t);if(n)n===ie?this.addRemoteMain(e):config.bmRelayServer?this.contentCarriers.has(n)?oe("SC addRT:Local: cid:".concat(n," pid:").concat(e.getParticipantId()," track:").concat(e.toString())):(oe("SC addRT:cid:".concat(n," pid:").concat(e.getParticipantId()," track:").concat(e.toString())),this.addRemoteContent(e)):this.sharedContents.localParticipant.myContents.has(n)?oe("SC addRT:Local: cid:".concat(n," pid:").concat(e.getParticipantId()," track:").concat(e.toString())):(oe("SC addRT:cid:".concat(n," pid:").concat(e.getParticipantId()," track:").concat(e.toString())),this.addRemoteContent(e));else{var i=this.remoteTrackPool.get(t);i||(i=new Set,this.remoteTrackPool.set(t,i)),i.add(e)}}},{key:"removeRemoteTrack",value:function(e){var t=e.getParticipantId(),n=this.carrierMap.get(t);if(n===ie)this.removeRemoteMain(e);else if(n)this.removeRemoteContent(e);else{var i=this.remoteTrackPool.get(e.getParticipantId());null===i||void 0===i||i.delete(e),0===(null===i||void 0===i?void 0:i.size)&&this.remoteTrackPool.delete(e.getParticipantId())}}},{key:"onMainScreenCarrier",value:function(e,t){var n=this;if(t){this.carrierMap.set(e,ie);var i=this.remoteTrackPool.get(e);null===i||void 0===i||i.forEach((function(e){return n.addRemoteMain(e)})),this.remoteTrackPool.delete(e)}else this.remoteMains.delete(e),this.carrierMap.delete(e)}},{key:"addLocalMains",value:function(e){var t=this;Object(Q.b)(e.length),e.find((function(e){return t.localMains.has(e)}))?console.error("addLocalMain: one of track in ".concat(e," already in localMains.")):(e.forEach((function(e){return t.localMains.add(e)})),this.localMainConnection?e.forEach((function(e){return t.localMainConnection.addTrack(e)})):(this.localMainConnection=new ne,this.localMainConnection.init().then((function(){J.b.conference.sync.sendMainScreenCarrier(!0),e.forEach((function(e){return t.localMainConnection.addTrack(e)}))}))),e.forEach((function(e){return e.getTrack().onended=function(){oe("stop sharing screen of ",e),t.removeLocalMain(e)}})))}},{key:"removeLocalMain",value:function(e){var t=this;this.localMains.delete(e)?(J.b.conference.sync.sendMainScreenCarrier(!1),this.localMainConnection.removeTrack(e).then((function(){0===t.localMainConnection.getLocalTracks().length&&(t.localMainConnection.disconnect(),t.localMainConnection=void 0)}))):console.error("removeLocalMain: track ".concat(e," not found in localMains."))}},{key:"clearLocalMains",value:function(){var e,t=new Set(this.localMains),n=Object(P.a)(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;this.removeLocalMain(i)}}catch(o){n.e(o)}finally{n.f()}}},{key:"mainStream",get:function(){var e=[];if(this.localMains.size)e=Array.from(this.localMains.values()).filter((function(e){return"audio"!==e.getType()}));else{var t=Array.from(this.remoteMains.keys());if(t.length){t.sort();var n=this.remoteMains.get(t[t.length-1]);n&&(e=Array.from(n.values()))}}if(e.length){var i,o=new MediaStream,a=Object(P.a)(e);try{for(a.s();!(i=a.n()).done;){var r=i.value;o.addTrack(r.getTrack())}}catch(s){a.e(s)}finally{a.f()}return o}}},{key:"addRemoteMain",value:function(e){var t,n,i=e.getParticipantId(),o=null===(t=this.localMainConnection)||void 0===t?void 0:t.getParticipantId();i>(o||"")&&this.clearLocalMains(),this.remoteMains.has(e.getParticipantId())||this.remoteMains.set(e.getParticipantId(),new Set),null===(n=this.remoteMains.get(e.getParticipantId()))||void 0===n||n.add(e)}},{key:"removeRemoteMain",value:function(e){var t,n;null===(t=this.remoteMains.get(e.getParticipantId()))||void 0===t||t.delete(e),0===(null===(n=this.remoteMains.get(e.getParticipantId()))||void 0===n?void 0:n.size)&&(this.remoteMains.delete(e.getParticipantId()),this.carrierMap.delete(e.getParticipantId()))}},{key:"addLocalContent",value:function(e,t){Object(Q.b)(t.length);var n=new Set(this.localContents.get(e));t.forEach((function(e){return n.add(e)})),Object(Q.b)(!this.localContents.has(e)),this.localContents.set(e,n),this.createConnectionForContent(e,t)}},{key:"createConnectionForContent",value:function(e,t){var n=this,i=new ne;this.contentCarriers.set(e,i),i.init().then((function(){n.carrierMap.set(i.getParticipantId(),e);var o=n.sharedContents.find(e);Object(Q.b)(o),o.url=i.getParticipantId(),n.sharedContents.updateByLocal(Object.assign({},o)),t.forEach((function(e){return i.addTrack(e)})),t[0].getTrack().onended=function(t){n.sharedContents.removeByLocal(e)}}))}},{key:"clearLocalContent",value:function(e){var t=this.localContents.get(e);if(null===t||void 0===t||t.forEach((function(e){e.getTrack().onended=null,e.stopStream()})),t){var n=this.contentCarriers.get(e);Object(Q.b)(n),this.carrierMap.delete(n.getParticipantId()),t.forEach((function(e){return n.removeTrack(e).then((function(){0===n.getLocalTracks().length&&n.disconnect()}))}))}this.localContents.delete(e),this.contentCarriers.delete(e)}},{key:"addRemoteContent",value:function(e){var t=this.carrierMap.get(e.getParticipantId());if(t){var n=this.remoteContents.get(t),i=new Set(n);i.add(e),this.remoteContents.set(t,i)}else console.warn("No cid found for carrier ".concat(e.getParticipantId()," of track ").concat(e.toString()))}},{key:"removeRemoteContent",value:function(e){var t=this.carrierMap.get(e.getParticipantId());if(t){var n=this.remoteContents.get(t);null===n||void 0===n||n.delete(e),0===(null===n||void 0===n?void 0:n.size)&&(this.remoteContents.delete(t),this.carrierMap.delete(t))}else console.warn("No cid found for carrier ".concat(e.getParticipantId()," of track ").concat(e.toString()))}},{key:"clearRemoteContent",value:function(e){var t=this.sharedContents.find(e);t&&t.url?(this.carrierMap.delete(t.url),this.remoteContents.delete(e)):console.warn("No pid found for content ".concat(e))}},{key:"remoteMainTrack",value:function(){if(0===this.localMains.size){var e=Array.from(this.remoteMains.keys());if(e.length){e.sort();var t=this.remoteMains.get(e[e.length-1]);if(t){var n=Array.from(t);return[n.find((function(e){return e.isVideoTrack()})),n.find((function(e){return e.isAudioTrack()}))]}}}}}]),e}(),r=Object(V.a)(a.prototype,"carrierMap",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),s=Object(V.a)(a.prototype,"localMains",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),c=Object(V.a)(a.prototype,"localContents",[X.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),l=Object(V.a)(a.prototype,"remoteMains",[X.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),u=Object(V.a)(a.prototype,"remoteContents",[X.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),Object(V.a)(a.prototype,"addLocalMains",[X.b],Object.getOwnPropertyDescriptor(a.prototype,"addLocalMains"),a.prototype),Object(V.a)(a.prototype,"removeLocalMain",[X.b],Object.getOwnPropertyDescriptor(a.prototype,"removeLocalMain"),a.prototype),Object(V.a)(a.prototype,"clearLocalMains",[X.b],Object.getOwnPropertyDescriptor(a.prototype,"clearLocalMains"),a.prototype),Object(V.a)(a.prototype,"mainStream",[X.d],Object.getOwnPropertyDescriptor(a.prototype,"mainStream"),a.prototype),Object(V.a)(a.prototype,"addRemoteMain",[X.b],Object.getOwnPropertyDescriptor(a.prototype,"addRemoteMain"),a.prototype),Object(V.a)(a.prototype,"removeRemoteMain",[X.b],Object.getOwnPropertyDescriptor(a.prototype,"removeRemoteMain"),a.prototype),Object(V.a)(a.prototype,"addLocalContent",[X.b],Object.getOwnPropertyDescriptor(a.prototype,"addLocalContent"),a.prototype),Object(V.a)(a.prototype,"clearLocalContent",[X.b],Object.getOwnPropertyDescriptor(a.prototype,"clearLocalContent"),a.prototype),Object(V.a)(a.prototype,"addRemoteContent",[X.b],Object.getOwnPropertyDescriptor(a.prototype,"addRemoteContent"),a.prototype),Object(V.a)(a.prototype,"removeRemoteContent",[X.b],Object.getOwnPropertyDescriptor(a.prototype,"removeRemoteContent"),a.prototype),Object(V.a)(a.prototype,"clearRemoteContent",[X.b],Object.getOwnPropertyDescriptor(a.prototype,"clearRemoteContent"),a.prototype),a),re=function(e){},se=function(e){},ce=35;function le(e,t){return e.zorder-t.zorder}var ue=(p=X.h.shallow,h=function e(t){Object(U.a)(this,e),this.participantId="",Object(B.a)(this,"myContents",f,this),Object(Q.b)(!config.bmRelayServer),Object(X.g)(this),this.participantId=t},f=Object(V.a)(h.prototype,"myContents",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),h),de=new(m=X.h.shallow,v=X.h.shallow,g=X.h.shallow,b=X.h.shallow,y=X.h.shallow,A=X.h.shallow,S=X.h.ref,E=function(e){Object(L.a)(n,e);var t=Object(F.a)(n);function n(){var e;Object(U.a)(this,n),(e=t.call(this)).contentIdCounter=0,e.localId="",e.beforeChangeEditing=void 0,e.tracks=new ae(Object(x.a)(e)),Object(B.a)(e,"pasteEnabled",O,Object(x.a)(e)),Object(B.a)(e,"editing",C,Object(x.a)(e)),Object(B.a)(e,"all",j,Object(x.a)(e)),e.sorted=[],Object(B.a)(e,"zones",T,Object(x.a)(e)),Object(B.a)(e,"closedZones",k,Object(x.a)(e)),e.participants=new Map,e.pendToRemoves=new Map,Object(B.a)(e,"roomContents",_,Object(x.a)(e)),Object(B.a)(e,"roomContentsInfo",R,Object(x.a)(e)),Object(B.a)(e,"playbackContents",I,Object(x.a)(e)),Object(B.a)(e,"pasted",w,Object(x.a)(e)),e.owner=new Map,e.wallpapers="",e.oldWallPapers=[],Object(B.a)(e,"screenFps",D,Object(x.a)(e)),Object(X.g)(Object(x.a)(e)),Object(X.c)((function(){var t=K.a.localId;Array.from(e.owner.keys()).forEach((function(n){e.owner.get(n)===e.localId&&e.owner.set(n,t)}));var n=e.participants.get(e.localId);n&&(e.participants.delete(e.localId),n.participantId=t,e.participants.set(t,n)),e.localId=t,re("Set new local id ".concat(e.localId))}));var i=localStorage.getItem("screenFps");return i&&(e.screenFps=JSON.parse(i)),Object(X.c)((function(){localStorage.setItem("screenFps",JSON.stringify(e.screenFps))})),Object(X.c)((function(){var t=K.a.local.pose.position;K.a.local.zone=e.zones.find((function(e){return Object(Q.t)(t,.5*z.a,Object(Q.q)(e.pose,e.size))}))})),Object(X.c)((function(){var t=e.closedZones.map((function(e){return{content:e,rect:Object(Q.q)(e.pose,e.size)}}));K.a.remote.forEach((function(e){if(!e.muteAudio&&e.physics.located){var n=t.find((function(t){return Object(Q.t)(e.pose.position,.5*z.a,t.rect)}));e.closedZone=null===n||void 0===n?void 0:n.content}else e.closedZone=void 0}))})),e}return Object(N.a)(n,[{key:"setEditing",value:function(e){e!==this.editing&&this.beforeChangeEditing&&this.beforeChangeEditing(this.editing,e),this.editing=e}},{key:"setBeforeChangeEditing",value:function(e,t){t&&t!==this.editing||(this.beforeChangeEditing=e)}},{key:"getParticipant",value:function(e){Object(Q.b)(!config.bmRelayServer);var t=this.participants.get(e);return t||(t=new ue(e),this.participants.set(e,t)),t}},{key:"setPasted",value:function(e){console.log("setPasted:",e),this.pasted=e}},{key:"sharePasted",value:function(){this.shareContent(this.pasted),this.pasted=Object(Z.b)()}},{key:"shareContent",value:function(e){Object(Z.u)(e),this.addLocalContent(e)}},{key:"updatePlayback",value:function(e){e.playback=!0,this.playbackContents.set(e.id,e),this.updateAll()}},{key:"removePlayback",value:function(e){this.playbackContents.delete(e),this.updateAll()}},{key:"findPlayback",value:function(e){return this.playbackContents.get(e)}},{key:"localParticipant",get:function(){return this.getParticipant(this.localId)}},{key:"find",value:function(e){if(config.bmRelayServer)return this.roomContents.get(e);var t,n=this.owner.get(e);return n?null===(t=this.participants.get(n))||void 0===t?void 0:t.myContents.get(e):void 0}},{key:"removeSameWallpaper",value:function(e){var t=this;Object(Q.b)(!config.bmRelayServer);var n=!1;return this.localParticipant.myContents.forEach((function(i){if(Object(H.j)(i)){var o=e.find((function(e){return i.url===e.url&&q.a.isEqual(i.pose,e.pose)}));o&&o.id!==i.id&&o.zorder<=i.zorder&&(t.removeByLocal(i.id),n=!0,console.warn("My wallpapers id:".concat(i.id," url:").concat(i.url," removed.")))}})),n}},{key:"checkDuplicatedWallpaper",value:function(e,t){var n=this;if(Object(Q.b)(!config.bmRelayServer),!config.bmRelayServer){var i=t.filter(H.j);this.localParticipant.myContents.forEach((function(e){if(Object(H.j)(e)){var t=i.find((function(t){return e.url===t.url&&q.a.isEqual(e.pose,t.pose)}));t&&t.zorder<=e.zorder&&(n.removeByLocal(e.id),console.warn("My wallpapers id:".concat(e.id," url:").concat(e.url," removed.")))}}))}}},{key:"removeDuplicated",value:function(){var e=this;Object(Q.b)(!config.bmRelayServer);var t=!1;this.participants.forEach((function(n){if(n.participantId>e.localParticipant.participantId){var i=Object(Q.s)(n.myContents,e.localParticipant.myContents);i.forEach((function(t,n){e.disposeContent(t),e.localParticipant.myContents.delete(n)})),t=t||0!==i.size}})),t&&J.b.conference.sync.sendMyContents()}},{key:"updateAll",value:function(){var e=[];config.bmRelayServer?Object.assign(e,Array.from(this.roomContents.values())):(this.removeDuplicated(),this.participants.forEach((function(t){e.push.apply(e,Object(M.a)(t.myContents.values()))})),this.pendToRemoves.forEach((function(t){e.push.apply(e,Object(M.a)(t.myContents.values()))}))),e.push.apply(e,Object(M.a)(Array.from(this.playbackContents.values())));var t=Array.from(e).sort(le);t.forEach((function(e,t){e.zIndex=t+1})),this.all=e,this.sorted=t,this.zones=this.sorted.filter((function(e){return void 0!==e.zone})).reverse(),this.closedZones=this.zones.filter((function(e){return"close"===e.zone})),config.bmRelayServer||this.saveWallpaper()}},{key:"getWallpaper",value:function(){var e=this.sorted.findIndex((function(e){return!Object(H.j)(e)}));return e<0&&(e=this.sorted.length),this.sorted.slice(0,e)}},{key:"saveWallpaper",value:function(){var e=this;if(this.localId){this.wallpapers||this.loadWallpaper();var t=this.getWallpaper();if(t.find((function(t,n){return t!==e.oldWallPapers[n]}))||t.length!==this.oldWallPapers.length){this.oldWallPapers=t,this.removeSameWallpaper(t)&&(t=this.getWallpaper());var n={room:J.b.conference.name,contents:Object(Z.l)(t)},i=[],o=localStorage.getItem("wallpapers");o&&(i=JSON.parse(o));var a=i.findIndex((function(e){return e.room===n.room}));-1===a?i.push(n):i[a]=n,localStorage.setItem("wallpapers",JSON.stringify(i))}}}},{key:"loadWallpaper",value:function(){var e=this;if(!this.wallpapers){var t=this.getWallpaper();if(t.length)this.wallpapers=JSON.stringify(t);else{var n=localStorage.getItem("wallpapers");if(n){var i=JSON.parse(n).find((function(e){return e.room===J.b.conference.name}));i&&(i.contents.forEach((function(t){var n=Object(Z.b)();Object.assign(n,t),e.addLocalContent(n)})),this.wallpapers=JSON.stringify(this.getWallpaper()))}else this.wallpapers=JSON.stringify([])}}}},{key:"addLocalContent",value:function(e){if(config.bmRelayServer)e.id||(e.id=this.getUniqueId()),this.updateByLocal(e);else{if(!K.a.localId)return void console.error("addLocalContant() failed. Invalid Participant ID.");e.id||(e.id=this.getUniqueId()),this.localParticipant.myContents.set(e.id,e),this.owner.set(e.id,K.a.localId),this.updateAll(),J.b.conference.sync.sendMyContents()}}},{key:"takeContentsFromDead",value:function(e,t){var n=this,i=!1;return e.myContents.forEach((function(o,a){t&&t!==a||("screen"===o.type||"camera"===o.type?(e.myContents.delete(a),n.owner.delete(a),n.disposeContent(o)):(n.localParticipant.myContents.set(a,o),e.myContents.delete(a),n.owner.set(a,n.localId),i=!0,re("set owner for cid=",a," pid=",n.localId)))})),0===e.myContents.size&&(this.participants.delete(e.participantId),this.pendToRemoves.delete(e.participantId)),i}},{key:"getOrTakeContent",value:function(e,t){var n=this.owner.get(e);if(n){var i=this.participants.get(n);if(i)return n===this.localId||K.a.remote.has(n)?{pid:n,pc:i,take:!1}:(this.takeContentsFromDead(i),J.b.conference.sendMessage(G.b.PARTICIPANT_LEFT,[n]),{pid:this.localId,pc:this.participants.get(this.localId),take:!0});var o=this.pendToRemoves.get(n);if(o&&this.takeContentsFromDead(o,e))return{pid:this.localId,pc:this.participants.get(this.localId),take:!0}}return console.error("".concat(t,": No owner for cid=").concat(e)),{pid:n,pc:void 0,take:!1}}},{key:"checkAndGetContent",value:function(e,t){var n=this.owner.get(e);if(n){var i=n?this.participants.get(n):void 0;return i||console.error("".concat(t,": Owner does not have cid=").concat(e)),{pid:n,pc:i}}return console.error("".concat(t,": No owner for cid=").concat(e)),{pid:n,pc:void 0}}},{key:"updateLocalOnly",value:function(e){if(config.bmRelayServer)this.roomContents.set(e.id,e);else{var t=this.checkAndGetContent(e.id,"updateByLocal").pc;t&&t.myContents.set(e.id,e)}this.updateAll()}},{key:"updateByLocal",value:function(e){if(config.bmRelayServer)this.roomContents.set(e.id,e),J.b.conference.sync.sendContentUpdateRequest("",[e]),this.updateAll(),this.roomContentsInfo.set(e.id,e);else{var t=this.getOrTakeContent(e.id,"updateByLocal"),n=t.pid,i=t.pc;i&&(n===this.localId?(i.myContents.set(e.id,e),this.updateAll(),J.b.conference.sync.sendMyContents()):n&&J.b.conference.sync.sendContentUpdateRequest(n,[e]))}}},{key:"removeByLocal",value:function(e){if(config.bmRelayServer){var t=this.roomContents.get(e);t&&(this.disposeContent(t),this.roomContents.delete(e)),J.b.conference.sync.sendContentRemoveRequest("",[e]),this.roomContentsInfo.delete(e),this.updateAll()}else{var n,i=this.getOrTakeContent(e,"removeByLocal"),o=i.pid,a=i.pc,r=i.take;a?(r&&(console.log("sendLeftContentRemoveRequest of ".concat(e,".")),J.b.conference.sync.sendLeftContentRemoveRequest([e])),o===this.localId?(this.removeMyContent(e),J.b.conference.sync.sendMyContents()):o&&K.a.remote.has(o)&&J.b.conference.sync.sendContentRemoveRequest(o,[e])):o&&(null===(n=J.b.conference.bmRelaySocket)||void 0===n?void 0:n.readyState)===WebSocket.OPEN&&(K.a.remote.has(o)||J.b.conference.pushOrUpdateMessageViaRelay(G.b.PARTICIPANT_LEFT,[o]))}}},{key:"requestContent",value:function(e){config.bmRelayServer&&J.b.conference.pushOrUpdateMessageViaRelay(G.b.CONTENT_UPDATE_REQUEST_BY_ID,e)}},{key:"updateByRemoteRequest",value:function(e){if(config.bmRelayServer){var t,n=Object(P.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.roomContents.set(i.id,i),"screen"!==i.type&&"camera"!==i.type||this.tracks.onUpdateContent(i)}}catch(l){n.e(l)}finally{n.f()}}else{var o,a=this.getParticipant(this.localId),r=Object(P.a)(e);try{for(r.s();!(o=r.n()).done;){var s=o.value,c=this.owner.get(s.id);c===this.localId?a.myContents.set(s.id,s):console.error("Update request of ".concat(s.id," is for ").concat(c," and not for me."))}}catch(l){r.e(l)}finally{r.f()}J.b.conference.sync.sendMyContents()}this.updateAll()}},{key:"removeByRemoteRequest",value:function(e){if(config.bmRelayServer){var t,n=Object(P.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,o=this.roomContents.get(i);o?(this.disposeContent(o),this.roomContents.delete(i)):de.editing===i&&(de.editing=""),de.roomContentsInfo.delete(i)}}catch(u){n.e(u)}finally{n.f()}this.updateAll()}else{var a,r=Object(P.a)(e);try{for(r.s();!(a=r.n()).done;){var s=a.value,c=this.checkAndGetContent(s,"removeByRemoteRequest"),l=c.pid;c.pc&&(l===this.localId?this.removeMyContent(s):console.error("remote try to remove my content"))}}catch(u){r.e(u)}finally{r.f()}J.b.conference.sync.sendMyContents()}}},{key:"removeLeftContentByRemoteRequest",value:function(e){Object(Q.b)(!config.bmRelayServer);var t,n=Object(P.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,o=this.owner.get(i);if(o){var a=this.pendToRemoves.get(o);a||(a=this.participants.get(o)),a&&(a.myContents.delete(i),this.owner.delete(i),0===a.myContents.size&&(this.participants.delete(o),this.pendToRemoves.delete(o)))}}}catch(r){n.e(r)}finally{n.f()}}},{key:"removeMyContent",value:function(e,t){Object(Q.b)(!config.bmRelayServer),t||(t=this.localId);var n=this.getParticipant(t),i=n.myContents.get(e);i?(this.disposeContent(i),n.myContents.delete(e),this.owner.delete(e),this.updateAll(),t===this.localId&&J.b.conference.sync.sendMyContents()):console.log("I don't have ".concat(e," to remove."))}},{key:"replaceRemoteContents",value:function(e,t){Object(Q.b)(!config.bmRelayServer),t===de.localId&&console.error("A remote tries to replace local contents."),this.updateRemoteContents(e,t);var n=this.getParticipant(t);if(n){var i=new Map(e.map((function(e){return[e.id,e]}))),o=Object(Q.f)(n.myContents,i);this.removeRemoteContents(Array.from(o.keys()),t)}}},{key:"updateRemoteContents",value:function(e,t){var n=this;Object(Q.b)(!config.bmRelayServer),t===de.localId&&console.error("A remote tries to updates local contents."),e.forEach((function(e){n.pendToRemoves.forEach((function(t){return t.myContents.delete(e.id)}));var i=n.getParticipant(t);if(re("updateContents for participant:".concat(t)),se(" update ".concat(e.id," by ").concat(e)),se(" myContents=",JSON.stringify(null===i||void 0===i?void 0:i.myContents)),i.myContents.has(e.id)){var o=n.owner.get(e.id);o!==t&&console.error("Owner not match for cid=".concat(e.id," owner=").concat(o," pid=").concat(t,"."))}else n.owner.set(e.id,t);i.myContents.set(e.id,e),de.roomContentsInfo.set(e.id,Object(H.g)(e)),"screen"!==e.type&&"camera"!==e.type||n.tracks.onUpdateContent(e)})),this.pendToRemoves.forEach((function(e){0===e.myContents.size&&n.pendToRemoves.delete(e.participantId)})),this.updateAll()}},{key:"removeRemoteContents",value:function(e,t){var n=this;Object(Q.b)(!config.bmRelayServer),t===de.localId&&console.error("Remote removes local contents.");var i=this.getParticipant(t);e.forEach((function(e){var t=i.myContents.get(e);t?(n.disposeContent(t),i.myContents.delete(e),n.owner.delete(e),n.roomContentsInfo.delete(e)):console.error("removeByRemote: failed to find content cid=".concat(e))})),this.updateAll()}},{key:"onParticipantLeft",value:function(e){if(!config.bmRelayServer){re("onParticipantLeft called with pid = ",e);var t=this.participants.get(e);if(t){var n=Array.from(K.a.remote.keys());n.push(this.localId),n.sort();var i=n.findIndex((function(t){return t>e})),o=n[i>=0?i:0];re("next = ",o);var a=!1;o===this.localId?(re("Next is me"),a=this.takeContentsFromDead(t)||a,re("remove:",e," current:",JSON.stringify(n)),re("local contents sz:",this.localParticipant.myContents.size," json:",JSON.stringify(Array.from(this.localParticipant.myContents.keys())))):(re("Next is remote"),this.pendToRemoveParticipant(t)),this.updateAll(),a&&J.b.conference.sync.sendMyContents()}}}},{key:"pendToRemoveParticipant",value:function(e){var t=this;Object(Q.b)(!config.bmRelayServer),Array.from(e.myContents.values()).filter((function(e){return"camera"===e.type||"screen"===e.type})).forEach((function(n){e.myContents.delete(n.id),t.owner.delete(n.id)})),this.pendToRemoves.set(e.participantId,e),this.participants.delete(e.participantId)}},{key:"clearAllRemotes",value:function(){var e=this;config.bmRelayServer?(this.roomContents.clear(),this.roomContentsInfo.clear()):(Array.from(this.participants.keys()).filter((function(t){return t!==e.localId})).forEach((function(t){var n=e.participants.get(t);n&&n.myContents.forEach((function(t){return e.roomContentsInfo.delete(t.id)})),e.participants.delete(t)})),this.tracks.clearConnection())}},{key:"removeAllContents",value:function(){var e=this;if(config.bmRelayServer){var t=Array.from(this.roomContentsInfo.keys());J.b.conference.sync.sendContentRemoveRequest("",t),this.roomContents.clear(),this.roomContentsInfo.clear()}else this.participants.forEach((function(t,n){if(n!==e.localId){var i=Array.from(t.myContents.values());J.b.conference.sync.sendContentRemoveRequest(n,i.map((function(e){return e.id})))}})),this.pendToRemoves.forEach((function(e){var t=Array.from(e.myContents.values());J.b.conference.sync.sendLeftContentRemoveRequest(t.map((function(e){return e.id})))})),this.owner.clear(),this.participants.clear(),this.pendToRemoves.clear(),J.b.conference.sync.sendMyContents(),this.roomContentsInfo.clear();this.updateAll()}},{key:"getUniqueId",value:function(){for(var e=K.a.localId;;){this.contentIdCounter+=1;var t="".concat(e,"_").concat(this.contentIdCounter);if(config.bmRelayServer){if(!this.roomContents.has(t))return t}else if(!this.owner.has(t))return t}return""}},{key:"disposeContent",value:function(e){e.id===this.editing&&this.setEditing(""),"screen"!==e.type&&"camera"!==e.type||(this.tracks.contentCarriers.has(e.id)?this.tracks.clearLocalContent(e.id):this.tracks.clearRemoteContent(e.id))}},{key:"setScreenFps",value:function(e){this.screenFps=e}}]),n}(W.EventEmitter),Object(V.a)(E.prototype,"setEditing",[X.b],Object.getOwnPropertyDescriptor(E.prototype,"setEditing"),E.prototype),O=Object(V.a)(E.prototype,"pasteEnabled",[X.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),C=Object(V.a)(E.prototype,"editing",[X.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),j=Object(V.a)(E.prototype,"all",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),T=Object(V.a)(E.prototype,"zones",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),k=Object(V.a)(E.prototype,"closedZones",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_=Object(V.a)(E.prototype,"roomContents",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),R=Object(V.a)(E.prototype,"roomContentsInfo",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),I=Object(V.a)(E.prototype,"playbackContents",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),w=Object(V.a)(E.prototype,"pasted",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(Z.b)()}}),Object(V.a)(E.prototype,"setPasted",[X.b],Object.getOwnPropertyDescriptor(E.prototype,"setPasted"),E.prototype),Object(V.a)(E.prototype,"sharePasted",[X.b],Object.getOwnPropertyDescriptor(E.prototype,"sharePasted"),E.prototype),Object(V.a)(E.prototype,"shareContent",[X.b],Object.getOwnPropertyDescriptor(E.prototype,"shareContent"),E.prototype),Object(V.a)(E.prototype,"updatePlayback",[X.b],Object.getOwnPropertyDescriptor(E.prototype,"updatePlayback"),E.prototype),Object(V.a)(E.prototype,"removePlayback",[X.b],Object.getOwnPropertyDescriptor(E.prototype,"removePlayback"),E.prototype),Object(V.a)(E.prototype,"localParticipant",[X.d],Object.getOwnPropertyDescriptor(E.prototype,"localParticipant"),E.prototype),D=Object(V.a)(E.prototype,"screenFps",[X.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),Object(V.a)(E.prototype,"setScreenFps",[X.b],Object.getOwnPropertyDescriptor(E.prototype,"setScreenFps"),E.prototype),E);d.contents=de;t.c=de},,function(e,t){e.exports={ADD_ICE_CANDIDATE_FAILED:"xmpp.add_ice_candidate_failed",AUDIO_MUTED_BY_FOCUS:"xmpp.audio_muted_by_focus",VIDEO_MUTED_BY_FOCUS:"xmpp.video_muted_by_focus",AUTHENTICATION_REQUIRED:"xmpp.authentication_required",BRIDGE_DOWN:"xmpp.bridge_down",CALL_ACCEPTED:"xmpp.callaccepted.jingle",CALL_INCOMING:"xmpp.callincoming.jingle",CALL_ENDED:"xmpp.callended.jingle",CHAT_ERROR_RECEIVED:"xmpp.chat_error_received",CONFERENCE_PROPERTIES_CHANGED:"xmpp.conference_properties_changed",CONNECTION_ESTABLISHED:"xmpp.connection.connected",CONNECTION_FAILED:"xmpp.connection.failed",CONNECTION_INTERRUPTED:"xmpp.connection.interrupted",CONNECTION_RESTORED:"xmpp.connection.restored",CONNECTION_ICE_FAILED:"xmpp.connection.ice.failed",CONNECTION_RESTARTED:"xmpp.connection.restart",CONNECTION_STATUS_CHANGED:"xmpp.connection.status.changed",DISPLAY_NAME_CHANGED:"xmpp.display_name_changed",EMUC_ROOM_ADDED:"xmpp.emuc_room_added",EMUC_ROOM_REMOVED:"xmpp.emuc_room_removed",ETHERPAD:"xmpp.etherpad",FOCUS_DISCONNECTED:"xmpp.focus_disconnected",FOCUS_LEFT:"xmpp.focus_left",GRACEFUL_SHUTDOWN:"xmpp.graceful_shutdown",ICE_RESTARTING:"rtc.ice_restarting",ICE_RESTART_SUCCESS:"rtc.ice_restart_success",KICKED:"xmpp.kicked",LOCAL_ROLE_CHANGED:"xmpp.localrole_changed",MEETING_ID_SET:"xmpp.meeting_id_set",MESSAGE_RECEIVED:"xmpp.message_received",INVITE_MESSAGE_RECEIVED:"xmpp.invite_message_received",PRIVATE_MESSAGE_RECEIVED:"xmpp.private_message_received",MUC_MEMBER_BOT_TYPE_CHANGED:"xmpp.muc_member_bot_type_changed",MUC_DESTROYED:"xmpp.muc_destroyed",MUC_JOIN_IN_PROGRESS:"xmpp.muc_join_in_progress",MUC_JOINED:"xmpp.muc_joined",MUC_MEMBER_JOINED:"xmpp.muc_member_joined",MUC_MEMBER_LEFT:"xmpp.muc_member_left",MUC_LOBBY_MEMBER_JOINED:"xmpp.muc_lobby_member_joined",MUC_LOBBY_MEMBER_UPDATED:"xmpp.muc_lobby_member_updated",MUC_LOBBY_MEMBER_LEFT:"xmpp.muc_lobby_member_left",MUC_DENIED_ACCESS:"xmpp.muc_denied access",MUC_LEFT:"xmpp.muc_left",MUC_ROLE_CHANGED:"xmpp.muc_role_changed",MUC_LOCK_CHANGED:"xmpp.muc_lock_changed",MUC_MEMBERS_ONLY_CHANGED:"xmpp.muc_members_only_changed",PARTICIPANT_AUDIO_MUTED:"xmpp.audio_muted",PARTICIPANT_VIDEO_MUTED:"xmpp.video_muted",PARTICIPANT_VIDEO_TYPE_CHANGED:"xmpp.video_type",PARTICIPANT_FEATURES_CHANGED:"xmpp.participant_features_changed",PASSWORD_REQUIRED:"xmpp.password_required",PHONE_NUMBER_CHANGED:"conference.phoneNumberChanged",PRESENCE_RECEIVED:"xmpp.presence_received",PRESENCE_STATUS:"xmpp.presence_status",PROMPT_FOR_LOGIN:"xmpp.prompt_for_login",READY_TO_JOIN:"xmpp.ready_to_join",RECORDER_STATE_CHANGED:"xmpp.recorderStateChanged",REMOTE_STATS:"xmpp.remote_stats",RENEGOTIATION_FAILED:"xmpp.renegotiation_failed",RESERVATION_ERROR:"xmpp.room_reservation_error",ROOM_CONNECT_ERROR:"xmpp.room_connect_error",ROOM_CONNECT_NOT_ALLOWED_ERROR:"xmpp.room_connect_error.not_allowed",ROOM_JOIN_ERROR:"xmpp.room_join_error",ROOM_CONNECT_MEMBERS_ONLY_ERROR:"xmpp.room_connect_error.members_only",ROOM_MAX_USERS_ERROR:"xmpp.room_max_users_error",SENDING_CHAT_MESSAGE:"xmpp.sending_chat_message",SENDING_PRIVATE_CHAT_MESSAGE:"xmpp.sending_private_chat_message",SESSION_ACCEPT_TIMEOUT:"xmpp.session_accept_timeout",SPEAKER_STATS_RECEIVED:"xmpp.speaker_stats_received",CONFERENCE_TIMESTAMP_RECEIVED:"xmpp.conference_timestamp_received",AV_MODERATION_APPROVED:"xmpp.av_moderation.approved",AV_MODERATION_REJECTED:"xmpp.av_moderation.rejected",AV_MODERATION_RECEIVED:"xmpp.av_moderation.received",AV_MODERATION_CHANGED:"xmpp.av_moderation.changed",AV_MODERATION_PARTICIPANT_APPROVED:"xmpp.av_moderation.participant.approved",AV_MODERATION_PARTICIPANT_REJECTED:"xmpp.av_moderation.participant.rejected",BREAKOUT_ROOMS_MOVE_TO_ROOM:"xmpp.breakout-rooms.move-to-room",BREAKOUT_ROOMS_EVENT:"xmpp.breakout-rooms.event",BREAKOUT_ROOMS_UPDATED:"xmpp.breakout-rooms.updated",START_MUTED_FROM_FOCUS:"xmpp.start_muted_from_focus",SUBJECT_CHANGED:"xmpp.subject_changed",SUSPEND_DETECTED:"xmpp.suspend_detected",TRANSCRIPTION_STATUS_CHANGED:"xmpp.transcription_status_changed",TRANSPORT_INFO:"xmpp.transportinfo.jingle",VIDEO_SIP_GW_AVAILABILITY_CHANGED:"xmpp.videoSIPGWAvailabilityChanged",VIDEO_SIP_GW_SESSION_STATE_CHANGED:"xmpp.videoSIPGWSessionStateChanged",ICE_CONNECTION_STATE_CHANGED:"xmpp.ice_connection_state_changed",JSON_MESSAGE_RECEIVED:"xmmp.json_message_received"}},function(e,t,n){"use strict";n.r(t),n.d(t,"AUDIO_INPUT_STATE_CHANGE",(function(){return i})),n.d(t,"AUDIO_UNMUTE_PERMISSIONS_CHANGED",(function(){return o})),n.d(t,"AUTH_STATUS_CHANGED",(function(){return a})),n.d(t,"BEFORE_STATISTICS_DISPOSED",(function(){return r})),n.d(t,"CONFERENCE_ERROR",(function(){return s})),n.d(t,"CONFERENCE_FAILED",(function(){return c})),n.d(t,"CONFERENCE_JOIN_IN_PROGRESS",(function(){return l})),n.d(t,"CONFERENCE_JOINED",(function(){return u})),n.d(t,"CONFERENCE_LEFT",(function(){return d})),n.d(t,"CONFERENCE_UNIQUE_ID_SET",(function(){return p})),n.d(t,"CONNECTION_ESTABLISHED",(function(){return h})),n.d(t,"CONNECTION_INTERRUPTED",(function(){return f})),n.d(t,"CONNECTION_RESTORED",(function(){return m})),n.d(t,"DATA_CHANNEL_OPENED",(function(){return v})),n.d(t,"DISPLAY_NAME_CHANGED",(function(){return g})),n.d(t,"DOMINANT_SPEAKER_CHANGED",(function(){return b})),n.d(t,"CONFERENCE_CREATED_TIMESTAMP",(function(){return y})),n.d(t,"DTMF_SUPPORT_CHANGED",(function(){return A})),n.d(t,"ENDPOINT_MESSAGE_RECEIVED",(function(){return S})),n.d(t,"ENDPOINT_STATS_RECEIVED",(function(){return E})),n.d(t,"JVB121_STATUS",(function(){return O})),n.d(t,"KICKED",(function(){return C})),n.d(t,"PARTICIPANT_KICKED",(function(){return j})),n.d(t,"LAST_N_ENDPOINTS_CHANGED",(function(){return T})),n.d(t,"LOCK_STATE_CHANGED",(function(){return k})),n.d(t,"SERVER_REGION_CHANGED",(function(){return _})),n.d(t,"_MEDIA_SESSION_STARTED",(function(){return R})),n.d(t,"_MEDIA_SESSION_ACTIVE_CHANGED",(function(){return I})),n.d(t,"MEMBERS_ONLY_CHANGED",(function(){return w})),n.d(t,"MESSAGE_RECEIVED",(function(){return D})),n.d(t,"NO_AUDIO_INPUT",(function(){return P})),n.d(t,"NOISY_MIC",(function(){return M})),n.d(t,"NON_PARTICIPANT_MESSAGE_RECEIVED",(function(){return N})),n.d(t,"PRIVATE_MESSAGE_RECEIVED",(function(){return x})),n.d(t,"PARTICIPANT_CONN_STATUS_CHANGED",(function(){return L})),n.d(t,"PARTCIPANT_FEATURES_CHANGED",(function(){return F})),n.d(t,"PARTICIPANT_PROPERTY_CHANGED",(function(){return B})),n.d(t,"P2P_STATUS",(function(){return U})),n.d(t,"PHONE_NUMBER_CHANGED",(function(){return V})),n.d(t,"PROPERTIES_CHANGED",(function(){return J})),n.d(t,"RECORDER_STATE_CHANGED",(function(){return G})),n.d(t,"VIDEO_SIP_GW_AVAILABILITY_CHANGED",(function(){return H})),n.d(t,"VIDEO_SIP_GW_SESSION_STATE_CHANGED",(function(){return z})),n.d(t,"START_MUTED_POLICY_CHANGED",(function(){return Q})),n.d(t,"STARTED_MUTED",(function(){return K})),n.d(t,"SUBJECT_CHANGED",(function(){return W})),n.d(t,"SUSPEND_DETECTED",(function(){return Y})),n.d(t,"TALK_WHILE_MUTED",(function(){return q})),n.d(t,"TRACK_ADDED",(function(){return X})),n.d(t,"TRACK_AUDIO_LEVEL_CHANGED",(function(){return Z})),n.d(t,"TRACK_MUTE_CHANGED",(function(){return $})),n.d(t,"TRACK_REMOVED",(function(){return ee})),n.d(t,"TRANSCRIPTION_STATUS_CHANGED",(function(){return te})),n.d(t,"USER_JOINED",(function(){return ne})),n.d(t,"USER_LEFT",(function(){return ie})),n.d(t,"USER_ROLE_CHANGED",(function(){return oe})),n.d(t,"USER_STATUS_CHANGED",(function(){return ae})),n.d(t,"VIDEO_UNMUTE_PERMISSIONS_CHANGED",(function(){return re})),n.d(t,"BOT_TYPE_CHANGED",(function(){return se})),n.d(t,"LOBBY_USER_JOINED",(function(){return ce})),n.d(t,"LOBBY_USER_UPDATED",(function(){return le})),n.d(t,"LOBBY_USER_LEFT",(function(){return ue})),n.d(t,"AV_MODERATION_APPROVED",(function(){return de})),n.d(t,"AV_MODERATION_REJECTED",(function(){return pe})),n.d(t,"AV_MODERATION_CHANGED",(function(){return he})),n.d(t,"AV_MODERATION_PARTICIPANT_APPROVED",(function(){return fe})),n.d(t,"AV_MODERATION_PARTICIPANT_REJECTED",(function(){return me})),n.d(t,"FACIAL_EXPRESSION_ADDED",(function(){return ve})),n.d(t,"BREAKOUT_ROOMS_MOVE_TO_ROOM",(function(){return ge})),n.d(t,"BREAKOUT_ROOMS_UPDATED",(function(){return be}));var i="conference.audio_input_state_changed",o="conference.audio_unmute_permissions_changed",a="conference.auth_status_changed",r="conference.beforeStatisticsDisposed",s="conference.error",c="conference.failed",l="conference.join_in_progress",u="conference.joined",d="conference.left",p="conference.unique_id_set",h="conference.connectionEstablished",f="conference.connectionInterrupted",m="conference.connectionRestored",v="conference.dataChannelOpened",g="conference.displayNameChanged",b="conference.dominantSpeaker",y="conference.createdTimestamp",A="conference.dtmfSupportChanged",S="conference.endpoint_message_received",E="conference.endpoint_stats_received",O="conference.jvb121Status",C="conference.kicked",j="conference.participant_kicked",T="conference.lastNEndpointsChanged",k="conference.lock_state_changed",_="conference.server_region_changed",R="conference.media_session.started",I="conference.media_session.active_changed",w="conference.membersOnlyChanged",D="conference.messageReceived",P="conference.no_audio_input",M="conference.noisy_mic",N="conference.non_participant_message_received",x="conference.privateMessageReceived",L="conference.participant_conn_status_changed",F="conference.partcipant_features_changed",B="conference.participant_property_changed",U="conference.p2pStatus",V="conference.phoneNumberChanged",J="conference.propertiesChanged",G="conference.recorderStateChanged",H="conference.videoSIPGWAvailabilityChanged",z="conference.videoSIPGWSessionStateChanged",Q="conference.start_muted_policy_changed",K="conference.started_muted",W="conference.subjectChanged",Y="conference.suspendDetected",q="conference.talk_while_muted",X="conference.trackAdded",Z="conference.audioLevelsChanged",$="conference.trackMuteChanged",ee="conference.trackRemoved",te="conference.transcriptionStatusChanged",ne="conference.userJoined",ie="conference.userLeft",oe="conference.roleChanged",ae="conference.statusChanged",re="conference.video_unmute_permissions_changed",se="conference.bot_type_changed",ce="conference.lobby.userJoined",le="conference.lobby.userUpdated",ue="conference.lobby.userLeft",de="conference.av_moderation.approved",pe="conference.av_moderation.rejected",he="conference.av_moderation.changed",fe="conference.av_moderation.participant.approved",me="conference.av_moderation.participant.rejected",ve="conference.facial_expression.added",ge="conference.breakout-rooms.move-to-room",be="conference.breakout-rooms.updated"},function(e,t,n){"use strict";var i,o,a,r,s,c,l,u,p,h,f,m,v,g,b,y,A,S,E,O,C,j,T,k,_,R,I,w,D,P,M,N,x,L,F,B,U,V,J,G,H,z,Q,K,W,Y=n(23),q=n(6),X=n(8),Z=n(10),$=(n(84),n(51)),ee=n(2),te=n(69),ne=n(25),ie=n(34),oe=n(33),ae=n(59),re=n(3),se=n(349),ce=n.n(se),le=(i=function e(){Object(q.a)(this,e),Object(Y.a)(this,"audioInputDevice",o,this),Object(Y.a)(this,"videoInputDevice",a,this),Object(Y.a)(this,"audioOutputDevice",r,this),Object(ee.g)(this)},o=Object(Z.a)(i.prototype,"audioInputDevice",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),a=Object(Z.a)(i.prototype,"videoInputDevice",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),r=Object(Z.a)(i.prototype,"audioOutputDevice",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),i),ue=n(130),de=(s=ee.h.shallow,c=ee.h.ref,l=ee.h.ref,u=ee.b.bound,p=ee.b.bound,h=ee.b.bound,f=function(e){Object(ie.a)(n,e);var t=Object(oe.a)(n);function n(){var e;return Object(q.a)(this,n),(e=t.call(this,!0)).devicePreference=new le,Object(Y.a)(e,"tracks",m,Object(ne.a)(e)),Object(Y.a)(e,"useStereoAudio",v,Object(ne.a)(e)),Object(Y.a)(e,"emoticon",g,Object(ne.a)(e)),Object(Y.a)(e,"pingIcon",b,Object(ne.a)(e)),Object(Y.a)(e,"pingX",y,Object(ne.a)(e)),Object(Y.a)(e,"pingY",A,Object(ne.a)(e)),Object(Y.a)(e,"remoteID",S,Object(ne.a)(e)),Object(Y.a)(e,"remoteX",E,Object(ne.a)(e)),Object(Y.a)(e,"remoteY",O,Object(ne.a)(e)),Object(Y.a)(e,"thirdPersonView",C,Object(ne.a)(e)),Object(Y.a)(e,"soundLocalizationBase",j,Object(ne.a)(e)),Object(Y.a)(e,"uploaderPreference",T,Object(ne.a)(e)),Object(Y.a)(e,"zone",k,Object(ne.a)(e)),Object(Y.a)(e,"remoteVideoLimit",_,Object(ne.a)(e)),Object(Y.a)(e,"remoteAudioLimit",R,Object(ne.a)(e)),Object(Y.a)(e,"audioInputDevice",I,Object(ne.a)(e)),Object(Y.a)(e,"videoInputDevice",w,Object(ne.a)(e)),Object(Y.a)(e,"audioOutputDevice",D,Object(ne.a)(e)),e.information=e.information,Object(Y.a)(e,"informationToSend",P,Object(ne.a)(e)),e.informationToSend=void 0,Object(ee.g)(Object(ne.a)(e)),e.loadInformationFromStorage(),ae.a.name&&(e.information.name=ae.a.name),e.useStereoAudio=null!==ae.a.headphone,e.muteAudio=null!==ae.a.muteMic,e.muteVideo=null===ae.a.cameraOn,e.emoticon="",e.pingIcon=!1,e.pingX=0,e.pingY=0,e.remoteID="",e.remoteX=0,e.remoteY=0,e.loadMediaSettingsFromStorage(),e.loadPhysicsFromStorage(),Object(ee.c)((function(){var t="https://www.gravatar.com/avatar/",n=e.information.avatarSrc;if((!n||n.includes(t,0))&&e.information.email){var i=ce()(e.information.email.trim().toLowerCase());n="".concat(t).concat(i,"?d=404")}n&&Object(re.c)(n).then((function(t){e.information.avatarSrc=t})).catch((function(){e.information.avatarSrc=""}))})),e}return Object(X.a)(n,[{key:"setThirdPersonView",value:function(e){this.thirdPersonView=e}},{key:"trackStates",get:function(){return{micMuted:this.muteAudio,speakerMuted:this.muteSpeaker,headphone:this.useStereoAudio,emoticon:this.emoticon,pingIcon:this.pingIcon,pingX:this.pingX,pingY:this.pingY,remoteID:this.remoteID,remoteX:this.remoteX,remoteY:this.remoteY}}},{key:"info",get:function(){return this.information}},{key:"sendInformation",value:function(){var e=this.information,t=(e.email,Object(te.a)(e,["email"]));this.informationToSend=t}},{key:"saveInformationToStorage",value:function(e){var t=sessionStorage;e&&(t=localStorage),t.setItem("localParticipantInformation",JSON.stringify(this.information))}},{key:"loadInformationFromStorage",value:function(){var e=localStorage;sessionStorage.getItem("localParticipantInformation")&&(e=sessionStorage);var t=e.getItem("localParticipantInformation");t&&Object.assign(this.information,JSON.parse(t))}},{key:"updateViewpointCenter",value:function(e){var t=e.toWindow(this.pose.position);this.viewpoint.center=Object(re.N)(Object(re.A)(.5,e.screenSize),t)}},{key:"saveMediaSettingsToStorage",value:function(){var e={stream:{muteVideo:this.muteVideo,muteAudio:this.muteAudio,muteSpeaker:this.muteSpeaker},device:this.devicePreference,headphone:this.useStereoAudio,soundLocalizationBase:this.soundLocalizationBase,uploadPreference:this.uploaderPreference};localStorage.setItem("localParticipantStreamControl",JSON.stringify(e)),sessionStorage.setItem("localParticipantStreamControl",JSON.stringify(e))}},{key:"loadMediaSettingsFromStorage",value:function(e){var t=localStorage.getItem("localParticipantStreamControl"),n=sessionStorage.getItem("localParticipantStreamControl"),i=void 0,o=void 0;t&&(i=JSON.parse(t)),n&&(o=JSON.parse(n));var a=i;a&&(a.stream.muteVideo=!0,o&&(a.stream.muteVideo=o.stream.muteVideo),e?Object.assign(e,a):(Object.assign(this,a.stream),Object.assign(this.devicePreference,a.device),this.useStereoAudio=a.headphone,this.soundLocalizationBase=a.soundLocalizationBase))}},{key:"savePhysicsToStorage",value:function(e){var t=sessionStorage;e&&(t=localStorage);var n={pose:this.pose,physics:this.physics};t.setItem("localParticipantPhysics",JSON.stringify(n))}},{key:"loadPhysicsFromStorage",value:function(){var e=localStorage;sessionStorage.getItem("localParticipantPhysics")&&(e=sessionStorage);var t=e.getItem("localParticipantPhysics");if(t){var n=JSON.parse(t);Object.assign(this.physics,n.physics),Object.assign(this.pose,n.pose)}}}]),n}(ue.a),m=Object(Z.a)(f.prototype,"tracks",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ue.c}}),v=Object(Z.a)(f.prototype,"useStereoAudio",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g=Object(Z.a)(f.prototype,"emoticon",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),b=Object(Z.a)(f.prototype,"pingIcon",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),y=Object(Z.a)(f.prototype,"pingX",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),A=Object(Z.a)(f.prototype,"pingY",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),S=Object(Z.a)(f.prototype,"remoteID",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),E=Object(Z.a)(f.prototype,"remoteX",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),O=Object(Z.a)(f.prototype,"remoteY",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),C=Object(Z.a)(f.prototype,"thirdPersonView",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return config.thirdPersonView}}),j=Object(Z.a)(f.prototype,"soundLocalizationBase",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return config.soundLocalizationBase?config.soundLocalizationBase:"user"}}),T=Object(Z.a)(f.prototype,"uploaderPreference",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return config.uploaderPreference?config.uploaderPreference:"gyazo"}}),k=Object(Z.a)(f.prototype,"zone",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),_=Object(Z.a)(f.prototype,"remoteVideoLimit",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return config.remoteVideoLimit||-1}}),R=Object(Z.a)(f.prototype,"remoteAudioLimit",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return config.remoteAudioLimit||-1}}),I=Object(Z.a)(f.prototype,"audioInputDevice",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),w=Object(Z.a)(f.prototype,"videoInputDevice",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),D=Object(Z.a)(f.prototype,"audioOutputDevice",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),P=Object(Z.a)(f.prototype,"informationToSend",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(Z.a)(f.prototype,"setThirdPersonView",[ee.b],Object.getOwnPropertyDescriptor(f.prototype,"setThirdPersonView"),f.prototype),Object(Z.a)(f.prototype,"trackStates",[ee.d],Object.getOwnPropertyDescriptor(f.prototype,"trackStates"),f.prototype),Object(Z.a)(f.prototype,"sendInformation",[ee.b],Object.getOwnPropertyDescriptor(f.prototype,"sendInformation"),f.prototype),Object(Z.a)(f.prototype,"loadInformationFromStorage",[u],Object.getOwnPropertyDescriptor(f.prototype,"loadInformationFromStorage"),f.prototype),Object(Z.a)(f.prototype,"updateViewpointCenter",[ee.b],Object.getOwnPropertyDescriptor(f.prototype,"updateViewpointCenter"),f.prototype),Object(Z.a)(f.prototype,"loadMediaSettingsFromStorage",[p],Object.getOwnPropertyDescriptor(f.prototype,"loadMediaSettingsFromStorage"),f.prototype),Object(Z.a)(f.prototype,"loadPhysicsFromStorage",[h],Object.getOwnPropertyDescriptor(f.prototype,"loadPhysicsFromStorage"),f.prototype),f),pe=n(136),he=(M=ee.h.shallow,N=ee.h.ref,x=function(e){Object(ie.a)(n,e);var t=Object(oe.a)(n);function n(e){var i;return Object(q.a)(this,n),(i=t.call(this)).information=i.information,i.informationReceived=!1,Object(Y.a)(i,"tracks",L,Object(ne.a)(i)),Object(Y.a)(i,"trackStates",F,Object(ne.a)(i)),Object(Y.a)(i,"called",B,Object(ne.a)(i)),Object(Y.a)(i,"inLocalsZone",U,Object(ne.a)(i)),Object(Y.a)(i,"closedZone",V,Object(ne.a)(i)),i.lastDistance=0,Object(ee.g)(Object(ne.a)(i)),i.id=e,i}return Object(X.a)(n,[{key:"call",value:function(){this.called=!0}}]),n}(ue.a),L=Object(Z.a)(x.prototype,"tracks",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ue.c}}),F=Object(Z.a)(x.prototype,"trackStates",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ue.b}}),B=Object(Z.a)(x.prototype,"called",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),U=Object(Z.a)(x.prototype,"inLocalsZone",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),V=Object(Z.a)(x.prototype,"closedZone",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),Object(Z.a)(x.prototype,"call",[ee.b],Object.getOwnPropertyDescriptor(x.prototype,"call"),x.prototype),x),fe=new(J=ee.h.shallow,G=ee.h.shallow,H=function(){function e(){Object(q.a)(this,e),Object(Y.a)(this,"remote",z,this),this.local_=ee.h.box(new de),Object(Y.a)(this,"playback",Q,this),Object(Y.a)(this,"yarnPhones",K,this),Object(Y.a)(this,"yarnPhoneUpdated",W,this),Object(ee.g)(this)}return Object(X.a)(e,[{key:"count",get:function(){return this.remote.size}},{key:"local",get:function(){return this.local_.get()}},{key:"localId",get:function(){return this.local.id}},{key:"setLocalId",value:function(e){this.local.id=e}},{key:"join",value:function(e){var t=new he(e);t.physics.located=!1,this.remote.set(e,t)}},{key:"leave",value:function(e){this.remote.delete(e)}},{key:"leaveAll",value:function(){this.remote.clear(),this.setLocalId("")}},{key:"find",value:function(e){return e===this.localId?this.local:this.remote.get(e)}},{key:"getPlayback",value:function(e){var t=this.playback.get(e);return t||(t=new pe.a(e),this.playback.set(e,t)),t}},{key:"removePlayback",value:function(e){return this.playback.delete(e)}},{key:"addRemoteTrack",value:function(e){var t=this.remote.get(e.getParticipantId());return!!t&&(e.isAudioTrack()?t.tracks.audio=e:(t.tracks.avatar=e,e.getTrack().addEventListener("ended",(function(){t.tracks.avatar=void 0})),e.getTrack().addEventListener("mute",(function(){t.tracks.onMuteChanged(e,!0)})),e.getTrack().addEventListener("unmute",(function(){t.tracks.onMuteChanged(e,!1)}))),!0)}},{key:"removeRemoteTrack",value:function(e){var t=this.remote.get(e.getParticipantId());return!!t&&(e.isAudioTrack()?t.tracks.audio=void 0:t.tracks.avatar=void 0,!0)}},{key:"isLocal",value:function(e){return e===this.localId}},{key:"audibleArea",value:function(){return[this.local.pose.position[0],this.local.pose.position[1],7*$.a]}}]),e}(),z=Object(Z.a)(H.prototype,"remote",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),Q=Object(Z.a)(H.prototype,"playback",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),K=Object(Z.a)(H.prototype,"yarnPhones",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),W=Object(Z.a)(H.prototype,"yarnPhoneUpdated",[ee.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(Z.a)(H.prototype,"count",[ee.d],Object.getOwnPropertyDescriptor(H.prototype,"count"),H.prototype),Object(Z.a)(H.prototype,"local",[ee.d],Object.getOwnPropertyDescriptor(H.prototype,"local"),H.prototype),Object(Z.a)(H.prototype,"localId",[ee.d],Object.getOwnPropertyDescriptor(H.prototype,"localId"),H.prototype),Object(Z.a)(H.prototype,"setLocalId",[ee.b],Object.getOwnPropertyDescriptor(H.prototype,"setLocalId"),H.prototype),Object(Z.a)(H.prototype,"join",[ee.b],Object.getOwnPropertyDescriptor(H.prototype,"join"),H.prototype),Object(Z.a)(H.prototype,"leave",[ee.b],Object.getOwnPropertyDescriptor(H.prototype,"leave"),H.prototype),Object(Z.a)(H.prototype,"leaveAll",[ee.b],Object.getOwnPropertyDescriptor(H.prototype,"leaveAll"),H.prototype),H);d.participants=fe;t.a=fe},,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"AUDIO",(function(){return i})),n.d(t,"PRESENTER",(function(){return o})),n.d(t,"VIDEO",(function(){return a}));var i="audio",o="presenter",a="video"},function(e,t,n){"use strict";var i=n(353);t.a=new i.a},,,function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return p}));var i=n(302),o=n(472),a=n(743),r=n(201);function s(e,t){return i.a.t(e,t)}function c(){return Object(a.a)()}var l={en:{translation:{enAbout:"A video chat with a 2D map, where you will hear others' voices based on the location. It holds multiple conversations in a venue parallelly, and you may walk around between them. Sharing screens, cameras, texts, images, YouTube, and documents on google drive are supported. You may drop or paste on the map.",enTopPageUrl:"https://scrapbox.io/binaural-meet/Top_page",enMoreInfo:"... more info",YourName:"MY NAME",Venue:"MEETING SPACE",EnterTheVenue:"Enter the venue",Contents:"Contents","Create and Share":"Create and Share","Share Text":"Share Text","Share iframe":"Share web page (Can't display many sites)","Share image":"Share image","Share zone image":"Share zone image","Select video camera to share":"Select video camera to share","Meeting Space":"Meeting Space",shareImport:"_Load Meeting Space...",shareImportTip:"Load the shared content from the downloaded .json file.",meetingSpace:"_Meeting Space",meetingDesc:"Meeting Description",shareDownload:"_Save Meeting Space",shareDownloadTip:"Download all shared contents except screen sharing and cameras to a file.",shareIframe:"I_frame",settingPreference:"_Preferences...",shareIframeTip:"Web pages that can be displayed are limited to those that can be displayed in an iframe.",shareText:"_Text",sharePaste:"Paste from clipboard (_v)",sharePasteTip:"Ctrl+V / Cmd+V shortcut directly works on the map. URL to PDF, images, YouTube, Google Docs",shareImage:"_Image",shareZoneImage:"_Chat Zone",shareImageTip:"Image files will be uploaded to gyazo.com. You can also paste the URL of the image.",shareGDrive:"Import Files from Google Drive",shareGDriveTip:"Upload any available file from Google Drive",shareWhiteboard:"_Whiteboard",shareWhiteboardTip:"Place the wbo.ophir.dev whiteboard.",shareEditEnd:"Stop editing",shareCamera:"_Camera",shareScreenBackground:"Screen as the _background",stopScreenBackground:"Stop _background screen",shareScreenContent:"_Screen",shareScreenContentTip:"Reducing the screen update frequency (fps) will reduce the network load.",stopScreen:"C_lose all screen and camera windows",frameRateSetting:"Frame rate:",fps:"fps",shareMouse:"_Mouse cursor",shareMouseTip:"Show the mouse cursor to other participants. The avatar also always gazes at the mouse cursor.",stopMouse:"Stop sharing _Mouse cursor",ttCreateAndshare:"_Create and share",ttMicMute:"_Mic mute",headphoneL1Chrome:"Stereo headphone (Caution: no echo cancel)",headphoneL1:"Stereo headphone",headphoneL2:"Monaural speaker",etConnection:"No connection",emConnection:"Please check internet connection. Earshot chat uses https. If internet is OK, the server may have problems.",etMicPermission:"No permission to use microphone",emMicPermission:"Your browser does not permit to use microphone. Please give me the permission and reload your browser.",etNoMic:"No microphone",emNoMic:"Please check if your PC has a microphone. Earshot chat requires it.",emClose:"Close",emNeverShow:"Never show this in this session",etNoChannel:"No data channel",emNoChannel:"Please check firewall setting. Earshot chat connect to https (port 443/TCP) and port 8801-8810/UDP or 80/TCP.",etRetry:"Please reload",emRetry:"The connection had been cut off once. Please click the reload button of the browser.",imageDropzoneText:"Drag and drop images here or click",lsTitle:"Avatar and notification setting",lsName:"Name",lsColor:"Color",lsColorAvatar:"Avatar",lsColorText:"Text",lsAutoColor:"Auto",lsImage:"Avatar image",lsEmail:"Input email to use Gravatar's image",lsImageFile:"Upload file to use image file",btSave:"Save and close",btCancel:"Cancel change",lsNotifyCall:"Called",lsNotifyTouch:"Touched",lsNotifyNear:"Approached",lsNotifyYarn:"Yarn phone",rsCall:"Call",lsNotification:"Notification",rsConnectYarnPhone:"Connect yarn phone",rsCutYarnPhone:"Disconnect yarn phone",rsChatTo:"Send chat only to {{name}}",ctTitle:"Show Title",ctUnTitle:"Hide Title",ctPin:"Lock position and size",ctUnpin:"Unlock position and size",ctProximity:"Enable Chat Zone",ctUnProximity:"Disable Chat Zone",ctScaleRotate:"Enable Scale and Rotate",ctUnScaleRotate:"Disable Scale and Rotate",ctEdit:"Start editing (No view sync)",ctUploadZone:"Upload and share",ctStopWatchOn:"Start zone stopwatch",ctStopWatchOff:"Stop zone stopwatch",ctEndEdit:"End editing (Sync view)",ctEditIframe:"Browse page (No sync)",ctEndEditIframe:"End browse (No sync)",ctEditText:"Edit (No scroll sync)",ctEndEditText:"End edit (Sync scroll)",ctEditWhiteboard:"Edit (No scroll sync)",ctEndEditWhiteboard:"End edit (No scroll sync)",ctEditGDrive:"Edit/Update (No scroll sync)",ctEndEditGDrive:"End edit (No auto-update)",ctEndEditYoutube:"Sync play pos",ctEditYoutube:"No sync",ctMoveTop:"Move to the top",ctMoveBottom:"Move to the bottom",ctWallpaper:"Make this wallpaper",ctUnWallpaper:"Remove this from wallpaper",ctCopyToClipboard:"Copy to clipboard",ctMaximize:"Zoom and move to maximize this content",ctUnMaximize:"Unmaximize and restore the view",ctDelete:"Delete",ctClose:"Close",ctName:"Titile",ctFocus:"Show it in the center",ctFrameVisible:"Normal frame",ctFrameInvisible:"Invisible frame",ctOpenAudioZone:"Meeting space",ctClosedAudioZone:"Sound proof room",ctNotAudioZone:"Just an image",ctOpaque:"Opaque",ctTransparent:"Transparent",upload:"Upload",Save:"Save",Clear:"Clear",Cancel:"Cancel",broadcastMyVoice:"Broadcast my voice",broadcastMyVideo:"Broadcast my video",broadcastMySpeakVideo:"Speak & Show",stereoswitch:"Stereo sound (via headset)",soundLocalizationBasedOn:"Sound localization based on",slAvatar:"Avatar (avatar's direction)",slUser:"User (top is front)",usage:"How to use",cmJoined:"{{name}} joined.",cmLeft:"{{name}} Left.",cmNameChanged:"{{old}} changed its name to {{new}}.",cmCallBy:"{{name}} called you.",cmCallTo:"You called {{name}}.",cmToAll:"To all",cmToName:"To {{name}}",cmSend:"Send (CTRL+Enter)",cmPrivateFrom:"Private from {{name}}",cmPrivateTo:"Private to {{name}}",noCalled:"{{name}} called you.",noTouched:"{{name}} touched you.",noNear:"{{name}} approached you.",noYarn:"{{name}} connected yarn.",afkTitle:"In away from keyboard mode (L / Esc)",afkMessage:"Hit any key or click mouse to return.",gdFailed:"The file in Google Drive could not be accessed.\r\nChange the file-sharing settings so that everyone on the Internet can see it.",videoLimit:"Limit on the number of video streams",audioLimit:"Limit on the number of audio streams",connectionStatus:"Connection Status",deleteMsg:"Remove",deleteImageMsg:"Remove Image?",deleteZoneMsg:"Remove Chat Zone?",deleteTextMsg:"Remove Text?",deleteYes:"Remove",deleteNo:"Don't Remove",deleteAlert:"ALERT"}},ja:{translation:{enAbout:"\u4f4d\u7f6e\u306b\u5fdc\u3058\u3066\u58f0\u304c\u5c4a\u304f2D\u30de\u30c3\u30d7\u4ed8\u304d\u30d3\u30c7\u30aa\u30c1\u30e3\u30c3\u30c8\u3067\u3059\u3002\u4f1a\u5834\u5185\u306b\u8907\u6570\u306e\u4f1a\u8a71\u304c\u4e26\u7acb\u3057\u3001\u4f1a\u8a71\u9593\u3092\u6b69\u304d\u56de\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u753b\u9762\u3001\u30ab\u30e1\u30e9\u3001\u30c6\u30ad\u30b9\u30c8\u3001\u753b\u50cf\u3001YouTube\u3001Google\u30c9\u30e9\u30a4\u30d6\u306e\u6587\u66f8\u3092\u5171\u6709\u3067\u304d\u307e\u3059\u3002\u30de\u30c3\u30d7\u306bURL\u7b49\u3092\u30c9\u30ed\u30c3\u30d7/\u30da\u30fc\u30b9\u30c8\u3067\u304d\u307e\u3059\u3002",enTopPageUrl:"https://scrapbox.io/binaural-meet/%E3%83%88%E3%83%83%E3%83%97%E3%83%9A%E3%83%BC%E3%82%B8",enMoreInfo:"\u8a73\u7d30",YourName:"\u304a\u540d\u524d",Venue:"\u4f1a\u5834\u540d",EnterTheVenue:"\u5165\u5834",Contents:"\u5171\u6709","Create and Share":"\u5171\u6709 (c)","Share Text":"\u30c6\u30ad\u30b9\u30c8\u306e\u5171\u6709","Share iframe":"Web\u30da\u30fc\u30b8\u306e\u5171\u6709(\u591a\u304f\u306e\u30b5\u30a4\u30c8\u3092\u8868\u793a\u3067\u304d\u307e\u305b\u3093)","Share image":"\u753b\u50cf\u306e\u5171\u6709","Share zone image":"\u753b\u50cf\u306e\u5171\u6709","Select video camera to share":"\u5171\u6709\u3059\u308b\u30ab\u30e1\u30e9\u306e\u9078\u629e","Meeting Space":"\u753b\u50cf\u306e\u5171\u6709",shareImport:"\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u30a4\u30f3\u30dd\u30fc\u30c8 (_i)",shareImportTip:"\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u3001\u5171\u6709\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002",meetingSpace:"\u30d5\u30a1\u30a4\u30eb\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9 (_d)",meetingDesc:"\u30d5\u30a1\u30a4\u30eb\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9 (_d)",shareDownload:"\u30d5\u30a1\u30a4\u30eb\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9 (_d)",shareDownloadTip:"\u753b\u9762\u5171\u6709\u3068\u30ab\u30e1\u30e9\u4ee5\u5916\u306e\u5168\u5171\u6709\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u30d5\u30a1\u30a4\u30eb\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002",shareIframe:"Web\u30da\u30fc\u30b8 (_f)",settingPreference:"\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u30a4\u30f3\u30dd\u30fc\u30c8 (_i)",shareIframeTip:"\u8868\u793a\u3067\u304d\u308bWeb\u30da\u30fc\u30b8\u306fiframe\u3067\u8868\u793a\u3067\u304d\u308b\u3082\u306e\u306b\u9650\u3089\u308c\u307e\u3059\u3002",shareText:"\u30c6\u30ad\u30b9\u30c8 (_t / \u76f4\u63a5\u30da\u30fc\u30b9\u30c8\u53ef)",sharePaste:"\u30da\u30fc\u30b9\u30c8 (_v)",sharePasteTip:"\u30de\u30c3\u30d7\u4e0a\u3067 Ctrl+V / Cmd+V \u3067\u3082\u8cbc\u4ed8\u3051\u3067\u304d\u307e\u3059\u3002PDF\u3001\u753b\u50cf\u3001YouTube\u3001Google Docs\u3078\u306eURL\u3092\u8a8d\u8b58\u3057\u307e\u3059\u3002",shareImage:"\u753b\u50cf (_g)",shareZoneImage:"\u753b\u50cf (_g / \u76f4\u63a5\u30da\u30fc\u30b9\u30c8\u53ef)",shareImageTip:"\u30de\u30c3\u30d7\u4e0a\u3067 Ctrl+V / Cmd+V \u3067\u8cbc\u4ed8\u3051\u3067\u304d\u307e\u3059\u3002\u753b\u50cf\u306f gyazo.com \u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u307e\u3059\u3002\u753b\u50cf\u306eURL\u3082\u8cbc\u4ed8\u3051\u3067\u304d\u307e\u3059\u3002",shareGDrive:"Import Files from Google Drive",shareGDriveTip:"Upload any available file from Google Drive",shareWhiteboard:"\u30db\u30ef\u30a4\u30c8\u30dc\u30fc\u30c9 (_w)",shareWhiteboardTip:"wbo.ophir.dev \u306e\u30db\u30ef\u30a4\u30c8\u30dc\u30fc\u30c9\u3092\u7f6e\u304d\u307e\u3059\u3002",shareEditEnd:"\u7de8\u96c6\u7d42\u4e86",shareCamera:"\u30d3\u30c7\u30aa\u30ab\u30e1\u30e9 (_c)",shareScreenBackground:"\u80cc\u666f\u306b\u753b\u9762\u5171\u6709 (_b)",stopScreenBackground:"\u80cc\u666f\u306e\u753b\u9762\u5171\u6709\u3092\u505c\u6b62 (_b)",shareScreenContent:"\u753b\u9762\u5171\u6709 (_s)",shareScreenContentTip:"\u753b\u9762\u66f4\u65b0\u306e\u983b\u5ea6(fps)\u3092\u4e0b\u3052\u308b\u3068\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8ca0\u8377\u304c\u6e1b\u308a\u307e\u3059\u3002",stopScreen:"\u753b\u9762\u5171\u6709\u30fb\u30ab\u30e1\u30e9\u3092\u3059\u3079\u3066\u9589\u3058\u308b (_l)",shareMouse:"\u30de\u30a6\u30b9\u30ab\u30fc\u30bd\u30eb (_m)",shareMouseTip:"\u30de\u30a6\u30b9\u30ab\u30fc\u30bd\u30eb\u304c\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u3082\u898b\u3048\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\u30a2\u30d0\u30bf\u30fc\u306e\u76ee\u3082\u30de\u30a6\u30b9\u30ab\u30fc\u30bd\u30eb\u3092\u5411\u3044\u3066\u3044\u307e\u3059\u3002",fps:"fps",ttCreateAndshare:"\u4f5c\u6210\u3068\u5171\u6709 (_c)",stopMouse:"\u30de\u30a6\u30b9\u30ab\u30fc\u30bd\u30eb\u306e\u5171\u6709\u505c\u6b62 (_m)",frameRateSetting:"\u30d5\u30ec\u30fc\u30e0\u30ec\u30fc\u30c8",ttMicMute:"\u30de\u30a4\u30af\u306e\u30df\u30e5\u30fc\u30c8 (_m)",headphoneL1Chrome:"\u30d8\u30c3\u30c9\u30d5\u30a9\u30f3 (\u30b9\u30c6\u30ec\u30aa / \u6ce8\u610f:\u30a8\u30b3\u30ad\u30e3\u30f3\u306a\u3057)",headphoneL1:"\u30d8\u30c3\u30c9\u30d5\u30a9\u30f3 (\u30b9\u30c6\u30ec\u30aa)",headphoneL2:"\u30b9\u30d4\u30fc\u30ab\u30fc (\u30e2\u30ce\u30e9\u30eb)",etConnection:"\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a\u306a\u3057",emConnection:"\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002Earshot chat\u306f https \u3092\u4f7f\u3044\u307e\u3059\u3002\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a\u306e\u554f\u984c\u3067\u306a\u3051\u308c\u3070\u3001\u30b5\u30fc\u30d0\u306e\u554f\u984c\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002",etMicPermission:"\u30de\u30a4\u30af\u5229\u7528\u4e0d\u53ef",emMicPermission:"\u30d6\u30e9\u30a6\u30b6\u304c\u30de\u30a4\u30af\u306e\u5229\u7528\u3092\u8a31\u53ef\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u30d6\u30e9\u30a6\u30b6\u306eURL\u306e\u5de6\u306e\u9375\u306e\u30a2\u30a4\u30b3\u30f3\u304b\u3089\u8a31\u53ef\u3057\u3001\u30d6\u30e9\u30a6\u30b6\u3092\u30ea\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\u3002",etNoMic:"\u30de\u30a4\u30af\u304c\u3042\u308a\u307e\u305b\u3093",emNoMic:"Earshot chat\u306b\u306f\u30de\u30a4\u30af\u304c\u5fc5\u8981\u3067\u3059\u3002\u30d1\u30bd\u30b3\u30f3\u306b\u30de\u30a4\u30af\u304c\u3064\u3044\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002",emClose:"\u9589\u3058\u308b",emNeverShow:"\u3053\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u3067\u306f\u8868\u793a\u3057\u306a\u3044",etNoChannel:"\u30c7\u30fc\u30bf\u901a\u4fe1\u304c\u3067\u304d\u307e\u305b\u3093",emNoChannel:"\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002Earshot chat \u306f https(443\u756a)\u3068\u30018801-8810\u756a\u304b80\u756a\u306e\u30dd\u30fc\u30c8\u306b\u63a5\u7d9a\u3057\u307e\u3059\u3002",etRetry:"\u30d6\u30e9\u30a6\u30b6\u306e\u66f4\u65b0\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u304f\u3060\u3055\u3044",emRetry:"\u4e00\u5ea6\u63a5\u7d9a\u304c\u5207\u308c\u307e\u3057\u305f\u3002\u30d6\u30e9\u30a6\u30b6\u306e\u66f4\u65b0(\u30ea\u30ed\u30fc\u30c9)\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u304f\u3060\u3055\u3044\u3002",imageDropzoneText:"\u753b\u50cf\u3092\u30c9\u30e9\u30c3\u30b0\uff06\u30c9\u30ed\u30c3\u30d7\u3059\u308b\u304b\u3001\u30af\u30ea\u30c3\u30af\u3057\u3066\u304f\u3060\u3055\u3044",lsTitle:"\u30a2\u30d0\u30bf\u30fc\u3068\u901a\u77e5\u306e\u8a2d\u5b9a",lsColor:"\u8272",lsColorAvatar:"\u30a2\u30d0\u30bf\u30fc\u8272",lsColorText:"\u6587\u5b57\u8272",lsAutoColor:"\u81ea\u52d5",lsName:"\u304a\u540d\u524d",lsImage:"\u30a2\u30d0\u30bf\u30fc\u306e\u753b\u50cf",lsEmail:"Gravatar\u306e\u753b\u50cf\u3092\u4f7f\u3046\u5834\u5408\u306fEmail\u3092\u5165\u529b",lsImageFile:"\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u5408\u306f\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9",btSave:"\u4fdd\u5b58\u3057\u3066\u9589\u3058\u308b",btCancel:" \u3082\u3068\u306b\u623b\u3059 ",lsNotification:"\u901a\u77e5\u306e\u8a2d\u5b9a",lsNotifyCall:"\u547c\u51fa",lsNotifyTouch:"\u63a5\u89e6",lsNotifyNear:"\u63a5\u8fd1",lsNotifyYarn:"\u7cf8\u96fb\u8a71",rsCall:"\u547c\u3073\u51fa\u3059",rsConnectYarnPhone:"\u7cf8\u96fb\u8a71\u3092\u3064\u306a\u3050",rsCutYarnPhone:"\u7cf8\u96fb\u8a71\u3092\u5207\u308b",rsChatTo:"{{name}}\u3060\u3051\u306b\u30c1\u30e3\u30c3\u30c8\u3092\u9001\u308b",ctTitle:"\u4f4d\u7f6e/\u30b5\u30a4\u30ba\u3092\u56fa\u5b9a\u3059\u308b",ctUnTitle:"\u4f4d\u7f6e/\u30b5\u30a4\u30ba\u3092\u53ef\u5909\u306b\u3059\u308b",ctPin:"\u4f4d\u7f6e/\u30b5\u30a4\u30ba\u3092\u56fa\u5b9a\u3059\u308b",ctUnpin:"\u4f4d\u7f6e/\u30b5\u30a4\u30ba\u3092\u53ef\u5909\u306b\u3059\u308b",ctEditIframe:"\u30da\u30fc\u30b8\u3092\u30d6\u30e9\u30a6\u30ba (\u975e\u540c\u671f)",ctEndEditIframe:"\u30d6\u30e9\u30a6\u30ba\u3092\u7d42\u4e86 (\u540c\u671f\u306a\u3057)",ctEditText:"\u7de8\u96c6\u958b\u59cb (\u8868\u793a\u4f4d\u7f6e\u306f\u975e\u540c\u671f)",ctEndEditText:"\u7de8\u96c6\u7d42\u4e86 (\u8868\u793a\u4f4d\u7f6e\u3092\u540c\u671f)",ctEditWhiteboard:"\u7de8\u96c6\u958b\u59cb (\u8868\u793a\u4f4d\u7f6e\u306f\u975e\u540c\u671f)",ctEndEditWhiteboard:"\u7de8\u96c6\u7d42\u4e86 (\u8868\u793a\u4f4d\u7f6e\u306f\u975e\u540c\u671f)",ctEditGDrive:"\u7de8\u96c6\u958b\u59cb\u30fb\u8868\u793a\u66f4\u65b0 (\u8868\u793a\u4f4d\u7f6e\u306f\u975e\u540c\u671f)",ctEndEditGDrive:"\u7de8\u96c6\u7d42\u4e86 (\u81ea\u52d5\u66f4\u65b0\u306a\u3057)",ctEndEditYoutube:"\u518d\u751f\u4f4d\u7f6e\u3092\u540c\u671f",ctProximity:"\u4f4d\u7f6e/\u30b5\u30a4\u30ba\u3092\u56fa\u5b9a\u3059\u308b",ctUnProximity:"\u4f4d\u7f6e/\u30b5\u30a4\u30ba\u3092\u53ef\u5909\u306b\u3059\u308b",ctScaleRotate:"\u4f4d\u7f6e/\u30b5\u30a4\u30ba\u3092\u53ef\u5909\u306b\u3059\u308b",ctUnScaleRotate:"\u4f4d\u7f6e/\u30b5\u30a4\u30ba\u3092\u53ef\u5909\u306b\u3059\u308b",ctStopWatchOn:"\u4f4d\u7f6e/\u30b5\u30a4\u30ba\u3092\u53ef\u5909\u306b\u3059\u308b",ctStopWatchOff:"\u4f4d\u7f6e/\u30b5\u30a4\u30ba\u3092\u53ef\u5909\u306b\u3059\u308b",ctUploadZone:"\u4e0d\u900f\u660e",ctEditYoutube:"\u540c\u671f\u3057\u306a\u3044",ctMoveTop:"\u4e00\u756a\u4e0a\u306b\u79fb\u52d5",ctMoveBottom:"\u4e00\u756a\u4e0b\u306b\u79fb\u52d5",ctWallpaper:"\u58c1\u7d19\u306b\u3059\u308b",ctUnWallpaper:"\u58c1\u7d19\u304b\u3089\u306f\u305a\u3059",ctCopyToClipboard:"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc",ctMaximize:"\u6700\u5927\u5316\u3059\u308b\u3088\u3046\u306b\u62e1\u5927\u3059\u308b",ctUnMaximize:"\u6700\u5927\u5316\u3068\u62e1\u5927\u3092\u623b\u3059",ctFocus:"\u4e2d\u592e\u306b\u8868\u793a",ctDelete:"\u524a\u9664\u3059\u308b",ctClose:"\u9589\u3058\u308b",ctName:"\u30bf\u30a4\u30c8\u30eb",ctFrameVisible:"\u30d5\u30ec\u30fc\u30e0\u3042\u308a",ctFrameInvisible:"\u30d5\u30ec\u30fc\u30e0\u306a\u3057",ctOpenAudioZone:"\u4f1a\u8b70\u5834\u6240",ctClosedAudioZone:"\u9632\u97f3\u4f1a\u8b70\u5ba4",ctNotAudioZone:"\u305f\u3060\u306e\u753b\u50cf",ctOpaque:"\u4e0d\u900f\u660e",ctTransparent:"\u900f\u660e",upload:"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9",Save:"\u4fdd\u5b58",Clear:"\u30af\u30ea\u30a2",Cancel:"\u30ad\u30e3\u30f3\u30bb\u30eb",broadcastMyVoice:"\u58f0\u3092\u5168\u54e1\u306b\u5c4a\u3051\u308b",broadcastMyVideo:"\u58f0\u3092\u5168\u54e1\u306b\u5c4a\u3051\u308b",broadcastMySpeakVideo:"\u58f0\u3092\u5168\u54e1\u306b\u5c4a\u3051\u308b",stereoswitch:"\u58f0\u3092\u5168\u54e1\u306b\u5c4a\u3051\u308b",soundLocalizationBasedOn:"\u97f3\u50cf\u5b9a\u4f4d\u306e\u5411\u304d\u306e\u57fa\u6e96",slAvatar:"\u30a2\u30d0\u30bf\u30fc\u306e\u5411\u304d",slUser:"\u30e6\u30fc\u30b6\u30fc\u306e\u5411\u304d(\u4e0a\u304c\u524d)",usage:"\u4f7f\u3044\u65b9",cmJoined:"{{name}}\u304c\u53c2\u52a0\u3002",cmLeft:"{{name}}\u304c\u9000\u51fa\u3002",cmNameChanged:"{{old}} \u304c {{new}} \u306b\u540d\u524d\u3092\u5909\u66f4\u3002",cmCallBy:"{{name}}\u304c\u3042\u306a\u305f\u3092\u547c\u3073\u307e\u3057\u305f\u3002",cmCallTo:"\u3042\u306a\u305f\u304c{{name}}\u3092\u547c\u3073\u307e\u3057\u305f\u3002",cmToAll:"\u5168\u54e1\u3078",cmToName:"{{name}}\u3078",cmSend:"\u9001\u4fe1 (CTRL+Enter)",cmPrivateFrom:"{{name}}\u304b\u3089\u500b\u4eba\u5b9b",cmPrivateTo:"\u81ea\u5206\u304b\u3089{{name}}\u5b9b",noCalled:"{{name}}\u304c\u547c\u3073\u307e\u3057\u305f\u3002",noTouched:"{{name}}\u304c\u89e6\u308c\u307e\u3057\u305f\u3002",noNear:"{{name}}\u304c\u8fd1\u3065\u304d\u307e\u3057\u305f\u3002",noYarn:"{{name}}\u304c\u7cf8\u96fb\u8a71\u3092\u3064\u306a\u304e\u307e\u3057\u305f\u3002",afkTitle:"\u96e2\u5e2d\u4e2d\u30e2\u30fc\u30c9 (L / Esc)",afkMessage:"\u30ad\u30fc\u304b\u30de\u30a6\u30b9\u30af\u30ea\u30c3\u30af\u3067\u623b\u308a\u307e\u3059\u3002",gdFailed:"Google Drive\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\r\n\u30d5\u30a1\u30a4\u30eb\u3092\u5171\u6709\u8a2d\u5b9a\u3092\u5909\u3048\u3001\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u4e0a\u306e\u5168\u54e1\u304c\u95b2\u89a7\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002",videoLimit:"\u6620\u50cf\u30b9\u30c8\u30ea\u30fc\u30e0\u6570\u306e\u4e0a\u9650",audioLimit:"\u97f3\u58f0\u30b9\u30c8\u30ea\u30fc\u30e0\u6570\u306e\u4e0a\u9650",connectionStatus:"\u901a\u4fe1\u72b6\u614b",deleteMsg:"\u6620\u50cf\u30b9\u30c8\u30ea",deleteImageMsg:"\u6620\u50cf\u30b9\u30c8\u30ea\u30fc\u30e0\u6570\u306e\u4e0a\u9650?",deleteZoneMsg:"\u6620\u50cf\u30b9\u30c8\u30ea\u30fc\u30e0\u6570\u306e\u4e0a\u9650?",deleteTextMsg:"\u6620\u50cf\u30b9\u30c8\u30ea\u30fc\u30e0\u6570\u306e\u4e0a\u9650?",deleteYes:"\u901a\u4fe1\u72b6\u614b",deleteNo:"\u901a\u4fe1\u72b6\u614b",deleteAlert:"\u901a\u4fe1\u72b6\u614b"}}},u=Object.keys(l),d={resources:l,supportedLngs:u,fallbackLng:u[0],interpolation:{escapeValue:!1}};function p(){return i.a.use(r.e).use(o.a).init(d)}},,function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var i=n(5),o=Object(i.a)(Object(i.a)({},{PARTICIPANT_AFK:"p_afk",PARTICIPANT_TRACKSTATES:"p_trackSt",PARTICIPANT_VIEWPOINT:"p_viewpoint"}),{},{PARTICIPANT_INFO:"p_info",MAIN_SCREEN_CARRIER:"main_screen_carrier",MY_CONTENT:"my_content"}),a={PARTICIPANT_TRACKLIMITS:"m_track_limits",YARN_PHONE:"YARN_PHONE",CHAT_MESSAGE:"m_chat",CALL_REMOTE:"call_remote",MUTE_VIDEO:"m_mute_video",MUTE_AUDIO:"m_mute_audio",RELOAD_BROWSER:"m_reload",KICK:"m_kick",UPDATE_POSE:"m_update"},r=(new Set(Object.values(a)),{CONTENT_UPDATE_REQUEST:"c_update",CONTENT_INFO_UPDATE:"c_info_update"}),s=new Set(Object.values(r)),c={LEFT_CONTENT_REMOVE_REQUEST:"left_c_remove",CONTENT_REMOVE_REQUEST:"c_remove",PARTICIPANT_OUT:"p_out",MOUSE_OUT:"m_out",CONTENT_OUT:"c_out"},l=new Set(Object.values(c)),u={CONTENT_UPDATE_REQUEST_BY_ID:"c_update_by_id",REQUEST_ALL:"req_all",REQUEST_RANGE:"req_range",REQUEST_PARTICIPANT_STATES:"req_p_state"},d=Object(i.a)(Object(i.a)(Object(i.a)(Object(i.a)(Object(i.a)(Object(i.a)(Object(i.a)({},r),c),a),o),{PARTICIPANT_POSE:"mp",PARTICIPANT_MOUSE:"mm",PARTICIPANT_ON_STAGE:"p_onStage"}),u),{},{PARTICIPANT_LEFT:"m_participant_left",ROOM_PROP:"room_prop",REQUEST_TO:"req_to",FRAGMENT_HEAD:"frag_head",FRAGMENT_CONTENT:"frag_cont"})},,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return O}));var i,o=n(14),a=n(57),r=n.n(a),s=n(12),c=n(74),l=n(35),u=n(83),d=n(21),p=n(172),h=n.n(p),f=n(356),m=n(122),v=n(226),g=n(357),b=n(358),y=n(143),A=n(22).getLogger(e),S=!1;function E(e){m.a.isBackendInitialized()||m.a.initBackend({callStatsID:e.callStatsID,callStatsSecret:e.callStatsSecret,userName:e.userName,aliasName:e.aliasName,applicationName:e.applicationName,getWiFiStatsMethod:e.getWiFiStatsMethod,confID:e.confID,siteID:e.siteID,configParams:e.configParams})||A.error("CallStats Backend initialization failed bad")}function O(e,t){this.rtpStatsMap=new Map,this.eventEmitter=new r.a,this.xmpp=e,this.options=t||{},this.callStatsIntegrationEnabled=this.options.callStatsID&&this.options.callStatsSecret&&this.options.enableCallStats&&!0!==O.disableThirdPartyRequests,this.callStatsIntegrationEnabled&&(this.callStatsApplicationLogsDisabled=this.options.callStatsApplicationLogsDisabled,d.a.isReactNative()?E(this.options):function(e){S||(h.a.loadScript(e.customScriptUrl||y.a,!0,!0,void 0,(function(){return E(e)})),S=!0)}(this.options),this.options.confID||A.warn('"confID" is not defined')),this.callsStatsInstances=new Map,O.instances.add(this)}O.init=function(e){O.audioLevelsEnabled=!e.disableAudioLevels,"number"===typeof e.pcStatsInterval&&(O.pcStatsInterval=e.pcStatsInterval),"number"===typeof e.audioLevelsInterval&&(O.audioLevelsInterval=e.audioLevelsInterval),"number"===typeof e.longTasksStatsInterval&&(O.longTasksStatsInterval=e.longTasksStatsInterval),O.disableThirdPartyRequests=e.disableThirdPartyRequests},O.audioLevelsEnabled=!1,O.audioLevelsInterval=200,O.pcStatsInterval=1e4,O.disableThirdPartyRequests=!1,O.analytics=f.a,Object.defineProperty(O,"instances",{get:function(){return i||(i=new Set),i}}),O.prototype.startRemoteStats=function(e){this.stopRemoteStats(e);try{var t=new b.a(e,O.audioLevelsInterval,O.pcStatsInterval,this.eventEmitter);t.start(O.audioLevelsEnabled),this.rtpStatsMap.set(e.id,t)}catch(n){A.error("Failed to start collecting remote statistics: ".concat(n))}},O.localStats=[],O.startLocalStats=function(e,t){if(O.audioLevelsEnabled){var n=new v.a(e,O.audioLevelsInterval,t);this.localStats.push(n),n.start()}},O.prototype.addAudioLevelListener=function(e){O.audioLevelsEnabled&&this.eventEmitter.on(u.a,e)},O.prototype.removeAudioLevelListener=function(e){O.audioLevelsEnabled&&this.eventEmitter.removeListener(u.a,e)},O.prototype.addBeforeDisposedListener=function(e){this.eventEmitter.on(u.b,e)},O.prototype.removeBeforeDisposedListener=function(e){this.eventEmitter.removeListener(u.b,e)},O.prototype.addConnectionStatsListener=function(e){this.eventEmitter.on(u.d,e)},O.prototype.removeConnectionStatsListener=function(e){this.eventEmitter.removeListener(u.d,e)},O.prototype.addByteSentStatsListener=function(e){this.eventEmitter.on(u.c,e)},O.prototype.removeByteSentStatsListener=function(e){this.eventEmitter.removeListener(u.c,e)},O.prototype.addLongTasksStatsListener=function(e){this.eventEmitter.on(u.e,e)},O.prototype.attachLongTasksStats=function(e){var t=this;d.a.supportsPerformanceObserver()?(this.performanceObserverStats=new g.a(this.eventEmitter,O.longTasksStatsInterval),e.on(s.CONFERENCE_JOINED,(function(){return t.performanceObserverStats.startObserver()})),e.on(s.CONFERENCE_LEFT,(function(){return t.performanceObserverStats.stopObserver()}))):A.warn("Performance observer for long tasks not supported by browser!")},O.prototype.getLongTasksStats=function(){return this.performanceObserverStats?this.performanceObserverStats.getLongTasksStats():null},O.prototype.removeLongTasksStatsListener=function(e){this.eventEmitter.removeListener(u.e,e)},O.prototype.setSpeakerList=function(e){for(var t=0,n=Array.from(this.rtpStatsMap.values());t<n.length;t++){var i=n[t];i.peerconnection.isP2P||i.setSpeakerList(e)}},O.prototype.dispose=function(){try{this.callsStatsInstances.size||this.eventEmitter.emit(u.b);var e,t=Object(o.a)(this.callsStatsInstances.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;this.stopCallStats(n.tpc)}}catch(s){t.e(s)}finally{t.f()}var i,a=Object(o.a)(this.rtpStatsMap.keys());try{for(a.s();!(i=a.n()).done;){var r=i.value;this._stopRemoteStats(r)}}catch(s){a.e(s)}finally{a.f()}this.eventEmitter&&this.eventEmitter.removeAllListeners()}finally{O.instances.delete(this)}},O.stopLocalStats=function(e){if(O.audioLevelsEnabled)for(var t=0;t<O.localStats.length;t++)if(O.localStats[t].stream===e){O.localStats.splice(t,1)[0].stop();break}},O.prototype._stopRemoteStats=function(e){var t=this.rtpStatsMap.get(e);t&&(t.stop(),this.rtpStatsMap.delete(e))},O.prototype.stopRemoteStats=function(e){this._stopRemoteStats(e.id)},O.prototype.startCallStats=function(e,t){if(this.callStatsIntegrationEnabled)if(this.callsStatsInstances.has(e.id))A.error("CallStats instance for ${tpc} exists already");else{A.info("Starting CallStats for ".concat(e,"..."));var n=new m.a(e,{confID:this.options.confID,remoteUserID:t});this.callsStatsInstances.set(e.id,n)}},O._getAllCallStatsInstances=function(){var e,t=new Set,n=Object(o.a)(O.instances);try{for(n.s();!(e=n.n()).done;){var i,a=e.value,r=Object(o.a)(a.callsStatsInstances.values());try{for(r.s();!(i=r.n()).done;){var s=i.value;t.add(s)}}catch(c){r.e(c)}finally{r.f()}}}catch(c){n.e(c)}finally{n.f()}return t},O.prototype.stopCallStats=function(e){var t=this.callsStatsInstances.get(e.id);t&&(1===this.callsStatsInstances.size&&this.eventEmitter.emit(u.b),this.callsStatsInstances.delete(e.id),t.sendTerminateEvent())},O.prototype.isCallstatsEnabled=function(){return this.callStatsIntegrationEnabled},O.prototype.sendConnectionResumeOrHoldEvent=function(e,t){var n=this.callsStatsInstances.get(e.id);n&&n.sendResumeOrHoldEvent(t)},O.prototype.sendIceConnectionFailedEvent=function(e){var t=this.callsStatsInstances.get(e.id);t&&t.sendIceConnectionFailedEvent()},O.prototype.sendMuteEvent=function(e,t,n){var i=e&&this.callsStatsInstances.get(e.id);m.a.sendMuteEvent(t,n,i)},O.prototype.sendScreenSharingEvent=function(e,t){var n,i=Object(o.a)(this.callsStatsInstances.values());try{for(i.s();!(n=i.n()).done;){n.value.sendScreenSharingEvent(e,t)}}catch(a){i.e(a)}finally{i.f()}},O.prototype.sendDominantSpeakerEvent=function(e){var t,n=Object(o.a)(this.callsStatsInstances.values());try{for(n.s();!(t=n.n()).done;){t.value.sendDominantSpeakerEvent()}}catch(i){n.e(i)}finally{n.f()}this.xmpp.sendDominantSpeakerEvent(e)},O.sendActiveDeviceListEvent=function(e){var t=O._getAllCallStatsInstances();if(t.size){var n,i=Object(o.a)(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;m.a.sendActiveDeviceListEvent(e,a)}}catch(r){i.e(r)}finally{i.f()}}else m.a.sendActiveDeviceListEvent(e,null)},O.prototype.associateStreamWithVideoTag=function(e,t,n,i,o,a){var r=this.callsStatsInstances.get(e.id);r&&r.associateStreamWithVideoTag(t,n,i,o,a)},O.sendGetUserMediaFailed=function(e){var t=e instanceof c.a?function(e){var t=new Error;return t.stack=e.stack,t.name=(e.name||"Unknown error")+(e.gum&&e.gum.error&&e.gum.error.name?" - ".concat(e.gum.error.name):""),t.constraintName=e.gum&&e.gum.constraints?JSON.stringify(e.gum.constraints):"",t.message=e.message,t}(e):e,n=O._getAllCallStatsInstances();if(n.size){var i,a=Object(o.a)(n);try{for(a.s();!(i=a.n()).done;){var r=i.value;m.a.sendGetUserMediaFailed(t,r)}}catch(s){a.e(s)}finally{a.f()}}else m.a.sendGetUserMediaFailed(t,null)},O.prototype.sendCreateOfferFailed=function(e,t){var n=this.callsStatsInstances.get(t.id);n&&n.sendCreateOfferFailed(e)},O.prototype.sendCreateAnswerFailed=function(e,t){var n=this.callsStatsInstances.get(t.id);n&&n.sendCreateAnswerFailed(e)},O.prototype.sendSetLocalDescFailed=function(e,t){var n=this.callsStatsInstances.get(t.id);n&&n.sendSetLocalDescFailed(e)},O.prototype.sendSetRemoteDescFailed=function(e,t){var n=this.callsStatsInstances.get(t.id);n&&n.sendSetRemoteDescFailed(e)},O.prototype.sendAddIceCandidateFailed=function(e,t){var n=this.callsStatsInstances.get(t.id);n&&n.sendAddIceCandidateFailed(e)},O.sendLog=function(e){var t,n=new Set,i=Object(o.a)(O.instances);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a.callStatsApplicationLogsDisabled)return;a.callsStatsInstances.size&&n.add(a.callsStatsInstances.values().next().value)}}catch(l){i.e(l)}finally{i.f()}if(n.size){var r,s=Object(o.a)(n);try{for(s.s();!(r=s.n()).done;){var c=r.value;m.a.sendApplicationLog(e,c)}}catch(l){s.e(l)}finally{s.f()}}else m.a.sendApplicationLog(e,null)},O.prototype.sendFeedback=function(e,t){return O.analytics.sendEvent(l.n,{rating:e,comment:t}),m.a.sendFeedback(this.options.confID,e,t)},O.LOCAL_JID=n(507).LOCAL_JID,O.reportGlobalError=function(e){e instanceof c.a&&e.gum?O.sendGetUserMediaFailed(e):O.sendLog(e)},O.sendAnalyticsAndLog=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e?(t="object"===typeof e?e:{name:e,properties:n},A.log(JSON.stringify(t)),this.analytics.sendEvent(e,n)):A.warn("No event or event name given.")},O.sendAnalytics=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.analytics.sendEvent(e,t)}}).call(this,"/index.js")},,function(e,t,n){"use strict";var i=n(90);n.d(t,"a",(function(){return i.a}));n(166);var o=n(167);n.d(t,"b",(function(){return o.a}))},function(e,t){e.exports={CREATE_ANSWER_FAILED:"rtc.create_answer_failed",CREATE_OFFER_FAILED:"rtc.create_offer_failed",DATA_CHANNEL_OPEN:"rtc.data_channel_open",ENDPOINT_CONN_STATUS_CHANGED:"rtc.endpoint_conn_status_changed",DOMINANT_SPEAKER_CHANGED:"rtc.dominant_speaker_changed",LASTN_ENDPOINT_CHANGED:"rtc.lastn_endpoint_changed",PERCEPTIBLE_CHANGED:"rtc.perceptibles_changed",PERMISSIONS_CHANGED:"rtc.permissions_changed",SENDER_VIDEO_CONSTRAINTS_CHANGED:"rtc.sender_video_constraints_changed",LASTN_VALUE_CHANGED:"rtc.lastn_value_changed",LOCAL_TRACK_SSRC_UPDATED:"rtc.local_track_ssrc_updated",LOCAL_TRACK_MAX_ENABLED_RESOLUTION_CHANGED:"rtc.local_track_max_enabled_resolution_changed",TRACK_ATTACHED:"rtc.track_attached",REMOTE_TRACK_ADDED:"rtc.remote_track_added",REMOTE_TRACK_MUTE:"rtc.remote_track_mute",REMOTE_TRACK_REMOVED:"rtc.remote_track_removed",REMOTE_TRACK_UNMUTE:"rtc.remote_track_unmute",SET_LOCAL_DESCRIPTION_FAILED:"rtc.set_local_description_failed",SET_REMOTE_DESCRIPTION_FAILED:"rtc.set_remote_description_failed",AUDIO_OUTPUT_DEVICE_CHANGED:"rtc.audio_output_device_changed",DEVICE_LIST_CHANGED:"rtc.device_list_changed",DEVICE_LIST_WILL_CHANGE:"rtc.device_list_will_change",DEVICE_LIST_AVAILABLE:"rtc.device_list_available",ENDPOINT_MESSAGE_RECEIVED:"rtc.endpoint_message_received",ENDPOINT_STATS_RECEIVED:"rtc.endpoint_stats_received",LOCAL_UFRAG_CHANGED:"rtc.local_ufrag_changed",REMOTE_UFRAG_CHANGED:"rtc.remote_ufrag_changed"}},function(e,t,n){"use strict";(function(e){var i=n(58),o=n(14),a=n(22),r=n(68),s=n.n(r),c=n(39),l=n.n(c),u=n(21),d=n(126),p=n.n(d),h=Object(a.getLogger)(e),f={filterSpecialChars:function(e){return e?e.replace(/[\\\/\{,\}\+]/g,""):e},iceparams:function(e,t){var n,i,o=null;return(i=f.findLine(e,"a=ice-ufrag:",t))&&(n=f.findLine(e,"a=ice-pwd:",t))&&(o={ufrag:f.parseICEUfrag(i),pwd:f.parseICEPwd(n)}),o},parseICEUfrag:function(e){return e.substring(12)},buildICEUfrag:function(e){return"a=ice-ufrag:".concat(e)},parseICEPwd:function(e){return e.substring(10)},buildICEPwd:function(e){return"a=ice-pwd:".concat(e)},parseMID:function(e){return e.substring(6)},parseMSIDAttribute:function(e){var t=e.find((function(e){return e.indexOf(" msid:")>0}));if(t){var n=t.substring(t.indexOf(" msid:")+6);return f.filterSpecialChars(n)}},parseMLine:function(e){var t={},n=e.substring(2).split(" ");return t.media=n.shift(),t.port=n.shift(),t.proto=n.shift(),""===n[n.length-1]&&n.pop(),t.fmt=n,t},buildMLine:function(e){return"m=".concat(e.media," ").concat(e.port," ").concat(e.proto," ").concat(e.fmt.join(" "))},parseRTPMap:function(e){var t={},n=e.substring(9).split(" ");return t.id=n.shift(),n=n[0].split("/"),t.name=n.shift(),t.clockrate=n.shift(),t.channels=n.length?n.shift():"1",t},parseSCTPMap:function(e){var t=e.substring(10).split(" ");return[t[0],t[1],t.length>2?t[2]:null]},parseSCTPPort:function(e){return e.substring(12)},buildRTPMap:function(e){var t="a=rtpmap:".concat(e.getAttribute("id")," ").concat(e.getAttribute("name"),"/").concat(e.getAttribute("clockrate"));return e.getAttribute("channels")&&"1"!==e.getAttribute("channels")&&(t+="/".concat(e.getAttribute("channels"))),t},parseCrypto:function(e){var t={},n=e.substring(9).split(" ");return t.tag=n.shift(),t["crypto-suite"]=n.shift(),t["key-params"]=n.shift(),n.length&&(t["session-params"]=n.join(" ")),t},parseFingerprint:function(e){var t={},n=e.substring(14).split(" ");return t.hash=n.shift(),t.fingerprint=n.shift(),t},parseFmtp:function(e){var t=[],n=e.split(" ");n.shift(),n=n.join(" ").split(";");for(var i=0;i<n.length;i++){for(var o=n[i].split("=")[0];o.length&&" "===o[0];)o=o.substring(1);var a=n[i].split("=")[1];o&&a?t.push({name:o,value:a}):o&&t.push({name:"",value:o})}return t},parseICECandidate:function(e){var t={},n=e.split(" ");t.foundation=n[0].substring(12),t.component=n[1],t.protocol=n[2].toLowerCase(),t.priority=n[3],t.ip=n[4],t.port=n[5],t.type=n[7],t.generation=0;for(var i=8;i<n.length;i+=2)switch(n[i]){case"raddr":t["rel-addr"]=n[i+1];break;case"rport":t["rel-port"]=n[i+1];break;case"generation":t.generation=n[i+1];break;case"tcptype":t.tcptype=n[i+1];break;default:h.debug('parseICECandidate not translating "'.concat(n[i],'" = "').concat(n[i+1],'"'))}return t.network="1",t.id=Math.random().toString(36).substr(2,10),t},buildICECandidate:function(e){var t=["a=candidate:".concat(e.foundation),e.component,e.protocol,e.priority,e.ip,e.port,"typ",e.type].join(" ");switch(t+=" ",e.type){case"srflx":case"prflx":case"relay":e.hasOwnAttribute("rel-addr")&&e.hasOwnAttribute("rel-port")&&(t+="raddr",t+=" ",t+=e["rel-addr"],t+=" ",t+="rport",t+=" ",t+=e["rel-port"],t+=" ")}return e.hasOwnAttribute("tcptype")&&(t+="tcptype",t+=" ",t+=e.tcptype,t+=" "),t+="generation",t+=" ",t+=e.hasOwnAttribute("generation")?e.generation:"0"},parseSSRC:function(e){for(var t=new Map,n=e.split("\r\n"),i=0;i<n.length;i++)if("a=ssrc:"===n[i].substring(0,7)){var o=n[i].split("a=ssrc:")[1].split(" ")[0];t.get(o)||t.set(o,[]),t.get(o).push(n[i])}return t},parseSourceNameLine:function(e){var t=e.find((function(e){return e.indexOf(" name:")>0}));return null===t||void 0===t?void 0:t.substring(t.indexOf(" name:")+6)},parseRTCPFB:function(e){var t=e.substr(10).split(" "),n={};return n.pt=t.shift(),n.type=t.shift(),n.params=t,n},parseExtmap:function(e){var t=e.substr(9).split(" "),n={};return n.value=t.shift(),-1===n.value.indexOf("/")?n.direction="both":(n.direction=n.value.substr(n.value.indexOf("/")+1),n.value=n.value.substr(0,n.value.indexOf("/"))),n.uri=t.shift(),n.params=t,n},findLine:function(e,t,n){for(var i=e.split("\r\n"),o=0;o<i.length;o++)if(i[o].substring(0,t.length)===t)return i[o];if(!n)return!1;i=n.split("\r\n");for(var a=0;a<i.length;a++)if(i[a].substring(0,t.length)===t)return i[a];return!1},findLines:function(e,t,n){for(var i=e.split("\r\n"),o=[],a=0;a<i.length;a++)i[a].substring(0,t.length)===t&&o.push(i[a]);if(o.length||!n)return o;i=n.split("\r\n");for(var r=0;r<i.length;r++)i[r].substring(0,t.length)===t&&o.push(i[r]);return o},candidateToJingle:function(e){if(0===e.indexOf("candidate:"))e="a=".concat(e);else if("a=candidate:"!==e.substring(0,12))return h.warn("parseCandidate called with a line that is not a candidate line"),h.warn(e),null;"\r\n"===e.substring(e.length-2)&&(e=e.substring(0,e.length-2));var t={},n=e.split(" ");if("typ"!==n[6])return h.warn("did not find typ in the right place"),h.warn(e),null;t.foundation=n[0].substring(12),t.component=n[1],t.protocol=n[2].toLowerCase(),t.priority=n[3],t.ip=n[4],t.port=n[5],t.type=n[7],t.generation="0";for(var i=8;i<n.length;i+=2)switch(n[i]){case"raddr":t["rel-addr"]=n[i+1];break;case"rport":t["rel-port"]=n[i+1];break;case"generation":t.generation=n[i+1];break;case"tcptype":t.tcptype=n[i+1];break;default:h.debug('not translating "'.concat(n[i],'" = "').concat(n[i+1],'"'))}return t.network="1",t.id=Math.random().toString(36).substr(2,10),t},candidateFromJingle:function(e){var t="a=candidate:";t+=e.getAttribute("foundation"),t+=" ",t+=e.getAttribute("component"),t+=" ";var n=e.getAttribute("protocol");switch(u.a.isFirefox()&&"ssltcp"===n.toLowerCase()&&(n="tcp"),t+=n,t+=" ",t+=e.getAttribute("priority"),t+=" ",t+=e.getAttribute("ip"),t+=" ",t+=e.getAttribute("port"),t+=" ",t+="typ",t+=" ".concat(e.getAttribute("type")),t+=" ",e.getAttribute("type")){case"srflx":case"prflx":case"relay":e.getAttribute("rel-addr")&&e.getAttribute("rel-port")&&(t+="raddr",t+=" ",t+=e.getAttribute("rel-addr"),t+=" ",t+="rport",t+=" ",t+=e.getAttribute("rel-port"),t+=" ")}return"tcp"===n.toLowerCase()&&(t+="tcptype",t+=" ",t+=e.getAttribute("tcptype"),t+=" "),t+="generation",t+=" ",t+=e.getAttribute("generation")||"0","".concat(t,"\r\n")},parsePrimaryVideoSsrc:function(e){var t=e.ssrcs.map((function(e){return e.id})).filter((function(e,t,n){return n.indexOf(e)===t})).length,n=e.ssrcGroups&&e.ssrcGroups.length||0;if(!(t>1&&0===n)){var i=null;if(1===t)i=e.ssrcs[0].id;else if(2===t){var o=e.ssrcGroups.find((function(e){return"FID"===e.semantics}));o&&(i=o.ssrcs.split(" ")[0])}else if(t>=3){var a=e.ssrcGroups.find((function(e){return"SIM"===e.semantics}));a&&(i=a.ssrcs.split(" ")[0])}return i}},generateSsrc:function(){return p.a.randomInt(1,4294967295)},getSsrcAttribute:function(e,t,n){for(var i=0;i<e.ssrcs.length;++i){var o=e.ssrcs[i];if(o.id===t&&o.attribute===n)return o.value}},parseGroupSsrcs:function(e){return e.ssrcs.split(" ").map((function(e){return parseInt(e,10)}))},getMedia:function(e,t){return e.media.find((function(e){return e.type===t}))},getUfrag:function(e){var t=e.split("\n").filter((function(e){return e.startsWith("a=ice-ufrag:")}));if(t.length>0)return t[0].substr("a=ice-ufrag:".length)},preferCodec:function(e,t){if(e&&t){var n=e.rtp.filter((function(e){return e.codec&&e.codec.toLowerCase()===t.toLowerCase()})).map((function(e){return e.payload}));if(n){var i,a=e.payloads.toString().split(" ").map((function(e){return parseInt(e,10)})),r=Object(o.a)(n.reverse());try{for(r.s();!(i=r.n()).done;){var s=i.value,c=a.indexOf(s);a.splice(c,1),a.unshift(s)}}catch(l){r.e(l)}finally{r.f()}e.payloads=a.join(" ")}}},stripCodec:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e&&t){var a,r=[],c=[],u=t.toLowerCase()===s.a.H264&&n,d=Object(o.a)(e.rtp);try{for(d.s();!(a=d.n()).done;){var p=a.value;p.codec&&p.codec.toLowerCase()===t.toLowerCase()&&(u?r.push(p.payload):c.push(p.payload))}}catch(b){d.e(b)}finally{d.f()}if(u&&(c=e.fmtp.filter((function(e){return r.indexOf(e.payload)>-1&&e.config.includes("profile-level-id=64")})).map((function(e){return e.payload}))),c.length>0){var h,f=c.map((function(e){return"apt=".concat(e)})),m=e.fmtp.filter((function(e){return-1!==f.indexOf(e.config)}));(h=c).push.apply(h,Object(i.a)(m.map((function(e){return e.payload}))));var v=e.payloads.toString().split(" ").map(Number),g=v.filter((function(e){return-1===c.indexOf(e)}));0===g.length?(e.port=0,e.direction=l.a.INACTIVE,e.payloads="*"):e.payloads=g.join(" "),e.rtp=e.rtp.filter((function(e){return-1!==g.indexOf(e.payload)})),e.fmtp=e.fmtp.filter((function(e){return-1!==g.indexOf(e.payload)})),e.rtcpFb&&(e.rtcpFb=e.rtcpFb.filter((function(e){return-1!==g.indexOf(e.payload)})))}}}};t.a=f}).call(this,"/index.js")},,,function(e,t,n){"use strict";n.d(t,"t",(function(){return o})),n.d(t,"u",(function(){return a})),n.d(t,"v",(function(){return r})),n.d(t,"w",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return m})),n.d(t,"i",(function(){return v})),n.d(t,"j",(function(){return g})),n.d(t,"k",(function(){return b})),n.d(t,"l",(function(){return y})),n.d(t,"m",(function(){return A})),n.d(t,"n",(function(){return S})),n.d(t,"o",(function(){return E})),n.d(t,"p",(function(){return O})),n.d(t,"q",(function(){return C})),n.d(t,"r",(function(){return j})),n.d(t,"s",(function(){return T})),n.d(t,"z",(function(){return k})),n.d(t,"B",(function(){return _})),n.d(t,"A",(function(){return R})),n.d(t,"C",(function(){return I})),n.d(t,"D",(function(){return w})),n.d(t,"E",(function(){return D})),n.d(t,"F",(function(){return P})),n.d(t,"J",(function(){return M})),n.d(t,"G",(function(){return N})),n.d(t,"H",(function(){return x})),n.d(t,"I",(function(){return L})),n.d(t,"K",(function(){return F})),n.d(t,"L",(function(){return B})),n.d(t,"M",(function(){return U})),n.d(t,"x",(function(){return V})),n.d(t,"y",(function(){return J})),n.d(t,"N",(function(){return G}));var i=n(5),o="operational",a="page",r="track",s="ui",c="restart",l="session-accept.timeout",u="session-initiate.received",d="session-initiate.timeout",p="terminate",h="transport-replace.received",f="transport-replace.success",m="decline",v="established",g="failed",b="switch.to.jvb",y="available.device",A="connection.disconnected",S="feedback",E="ice.duration",O="ice.establishment.duration.diff",C="ice.state.changed",j="track.no-bytes-sent",T="track.unmuted",k=function(){var e="bridge.down";return{action:e,actionSubject:e,type:o}},_=function(e,t,n){return{type:o,action:"connection.failed",attributes:Object(i.a)({error_type:e,error_message:t},n)}};function R(e,t){return{action:e,attributes:t,source:"conference",type:o}}var I=function(e,t){var n="connection.stage.reached";return{action:n,actionSubject:e,attributes:t,source:n,type:o}},w=function(e,t,n){return{attributes:{participant_id:e,region:t,rtt:n},name:"e2e_rtt",type:o}},D=function(){var e="focus.left";return{action:e,actionSubject:e,type:o}},P=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:o,source:"get.user.media",action:e,attributes:t}},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="duration";return{type:o,source:"peer.conn.status",action:t,attributes:e}},N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:o,action:e,source:"jingle",attributes:t}},x=function(e,t){return{attributes:{media_type:e,value:t},action:"track.no.data.from.source",type:o}},L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:o,action:e,source:"p2p",attributes:t}},F=function(e){return{type:o,action:"remotely.muted",mediaType:e}},B=function(e){return{type:o,action:"rtp.stats",attributes:e}},U=function(e){return{type:o,action:"transport.stats",attributes:e}};function V(e,t,n){return{type:o,action:"audio.output.problem",attributes:{userID:e,localAudioLevels:t,remoteAudioLevels:n}}}var J=function(e,t){return{type:o,action:"bridge-channel.error",attributes:{code:e,reason:t}}},G=function(e){return I("ttfm",e)}},,,,function(e,t){e.exports={INACTIVE:"inactive",RECVONLY:"recvonly",SENDONLY:"sendonly",SENDRECV:"sendrecv"}},,function(e,t,n){"use strict";n.d(t,"s",(function(){return A})),n.d(t,"b",(function(){return O})),n.d(t,"d",(function(){return j})),n.d(t,"g",(function(){return k})),n.d(t,"e",(function(){return _})),n.d(t,"f",(function(){return R})),n.d(t,"h",(function(){return D})),n.d(t,"c",(function(){return P})),n.d(t,"i",(function(){return M})),n.d(t,"j",(function(){return x})),n.d(t,"l",(function(){return L})),n.d(t,"k",(function(){return B})),n.d(t,"a",(function(){return V})),n.d(t,"q",(function(){return J})),n.d(t,"m",(function(){return G})),n.d(t,"o",(function(){return H})),n.d(t,"p",(function(){return z})),n.d(t,"n",(function(){return Q})),n.d(t,"u",(function(){return K})),n.d(t,"t",(function(){return W})),n.d(t,"r",(function(){return Y}));var i=n(14),o=n(6),a=n(225),r=n(38),s=n.n(r),c=n(65),l=n(8),u=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"858773398697-vki2lito392c5dlss9s31ap077nn0qbd.apps.googleusercontent.com",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"binarual-meet",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"AIzaSyAADCXxUujmh0VqXIzJofwl03MA5O8v8EQ",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:["https://www.googleapis.com/auth/drive.file"];Object(o.a)(this,e),this.clientId=void 0,this.clientSecret=void 0,this.appId=void 0,this.apiToken=void 0,this.scopes=void 0,this.loadState=0,this.clientId=t,this.clientSecret=n,this.appId=i,this.apiToken=a,this.scopes=r}return Object(l.a)(e,[{key:"onAuthApiLoad",value:function(){this.loadState++,gapi.client.load("drive","v3",this.onDriveLoad.bind(this))}},{key:"onDriveLoad",value:function(){this.loadState++}},{key:"login",value:function(){var e=Object(c.a)(s.a.mark((function e(){var t,n=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){gapi.auth.authorize({client_id:n.clientId,scope:n.scopes,immediate:!1},(function(n){return n.error?t(n):e(n)}))}));case 2:t=e.sent,console.log(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"uploadFileToGoogleDrive",value:function(){var e=Object(c.a)(s.a.mark((function e(t){var n,i,o,a,r,c,l,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.login();case 2:return e.next=4,gapi.client.drive.files.list({q:"name='Binaural Meet Files' and mimeType='application/vnd.google-apps.folder' and not trashed=true"});case 4:if(n=e.sent,i=n.result.files,o="",null===i||void 0===i?void 0:i.length){e.next=15;break}return a={name:"Binaural Meet Files",mimeType:"application/vnd.google-apps.folder"},e.next=11,gapi.client.drive.files.create({resource:a});case 11:r=e.sent,o=JSON.parse(r.body).id,e.next=16;break;case 15:o=i[0].id||"";case 16:return c={name:t.name,mimeType:t.type,parents:[o]},(l=new FormData).append("metadata",new Blob([JSON.stringify(c)],{type:"application/json"})),l.append("file",t),e.next=22,fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",{method:"POST",headers:new Headers({Authorization:"Bearer "+gapi.auth.getToken().access_token}),body:l}).then((function(e){return e.json()}));case 22:return u=e.sent,e.next=25,gapi.client.drive.permissions.create({fileId:u.id,resource:{role:"reader",type:"anyone"}});case 25:return e.abrupt("return","https://drive.google.com/uc?export=view&id=".concat(u.id));case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}()),d=n(192),p=n(49),h=n(3),f=n(256),m=n(44),v=n.n(m),g=n(13),b=n(9),y=Object.assign({},f.b,{name:"",ownerName:"",color:[],textColor:[],type:"",url:"",size:[0,0],originalSize:[0,0],id:"",zorder:0,pinned:!1,shareType:"",showTitle:!1,contentDesc:"",showStopWatch:!1,stopWatchToggle:!1,stopWatchReset:!1,scaleRotateToggle:!1});function A(e){return e}var S,E=function e(){Object(o.a)(this,e),this.name=void 0,this.ownerName=void 0,this.color=void 0,this.textColor=void 0,this.type=void 0,this.url=void 0,this.id=void 0,this.zorder=void 0,this.pinned=void 0,this.pose=void 0,this.size=void 0,this.originalSize=void 0,this.noFrame=void 0,this.opacity=void 0,this.shareType=void 0,this.showTitle=void 0,this.contentDesc=void 0,this.showStopWatch=void 0,this.stopWatchToggle=void 0,this.stopWatchReset=void 0,this.scaleRotateToggle=void 0,Object.assign(this,v.a.cloneDeep(y))};function O(){var e=new E;return e.ownerName=g.a.local.information.name,e.color=g.a.local.information.color,e.textColor=g.a.local.information.textColor,e.zorder=Date.now(),e}function C(e,t,n){e.type="pdf",e.url=t,e.pose.position[0]=n.mouseOnMap[0],e.pose.position[1]=n.mouseOnMap[1],e.size[0]=500,e.size[1]=1.41421356*e.size[0]}function j(e,t,n,o,r){return new Promise((function(s,c){var l=O(),u=new URL(e);if("youtu.be"===u.hostname||"youtube.com"===u.hostname||"www.youtube.com"===u.hostname){var d=u.search.slice(1).split("&"),p=new Map(d.map((function(e){return e.split("=")})));"youtu.be"===u.hostname&&p.set("v",u.pathname.slice(1)),l.url="";var f,m=Object(i.a)(p);try{for(m.s();!(f=m.n()).done;){var v=f.value;""===l.url?l.url="".concat(v[0],"=").concat(v[1]):l.url="".concat(l.url,"&").concat(v[0],"=").concat(v[1])}}catch(A){m.e(A)}finally{m.f()}l.type="youtube","contextmenu"===r?(l.pose.position[0]=Number(n),l.pose.position[1]=Number(o)):(l.pose.position[0]=t.mouseOnMap[0],l.pose.position[1]=t.mouseOnMap[1]),l.size[0]=640,l.size[1]=380}else if("drive.google.com"===u.hostname||"docs.google.com"===u.hostname){l.type="gdrive";var g=u.pathname.slice(u.pathname.indexOf("/d/")+3),y=g.slice(0,g.indexOf("/"));l.url="id=".concat(y),l.pose.position[0]=t.mouseOnMap[0],l.pose.position[1]=t.mouseOnMap[1],l.size[0]=900,l.size[1]=700}else"wbo.ophir.dev"===u.hostname?(l.type="whiteboard",l.url=e,l.pose.position[0]=t.mouseOnMap[0],l.pose.position[1]=t.mouseOnMap[1],l.size[0]=700,l.size[1]=740):".pdf"===u.pathname.substring(u.pathname.length-4)||".PDF"===u.pathname.substring(u.pathname.length-4)?C(l,e,t):Object(h.n)(Object(a.a)(e)).then((function(n){"application/pdf"===n&&(C(l,e,t),s(l))})).finally((function(){l.type||(l.type="iframe",l.url=e,l.pose.position[0]=t.mouseOnMap[0],l.pose.position[1]=t.mouseOnMap[1],l.size[0]=600,l.size[1]=800,s(l))}));l.type&&(s(l),Object(b.b)("".concat(l.type," created url = ").concat(l.url)))}))}function T(e,t,n,i,o){var a=O();a.type="text";var r={messages:[{message:e,pid:g.a.localId,name:g.a.local.information.name,color:g.a.local.information.color,textColor:g.a.local.information.textColor,time:Date.now()}],scroll:[0,0]};a.url=JSON.stringify(r),"contextmenu"===o?(a.pose.position[0]=Number(n),a.pose.position[1]=Number(i)):(a.pose.position[0]=t.mouseOnMap[0],a.pose.position[1]=t.mouseOnMap[1]);var s=Math.ceil(Math.sqrt(e.length));return a.size[0]=Math.max(20*s,200),a.size[1]=Math.max(25*s,s?25:75),a}function k(e,t,n,i,o){var a=O();a.type="text",a.shareType="text",a.noFrame=!0;var r={messages:[{message:e,pid:g.a.localId,name:g.a.local.information.name,color:g.a.local.information.color,textColor:g.a.local.information.textColor,time:Date.now()}],scroll:[0,0]};a.url=JSON.stringify(r),"contextmenu"===o?(a.pose.position[0]=Number(n),a.pose.position[1]=Number(i)):(a.pose.position[0]=t.mouseOnMap[0],a.pose.position[1]=t.mouseOnMap[1]);var s=Math.ceil(Math.sqrt(e.length));return a.size[0]=Math.max(20*s,200),a.size[1]=Math.max(25*s,s?25:75),a}function _(e,t,n,i,o,a,r,s){return new Promise((function(c,l){"gyazo"===g.a.local.uploaderPreference?Object(d.b)(e).then((function(e){R(e,t,n,i,o,a,r,s).then(c)})).catch((function(d){"type"===d?u.uploadFileToGoogleDrive(e).then((function(e){R(e,t,n,i,o,a,r,s).then(c)})).catch(l):l(d)})):u.uploadFileToGoogleDrive(e).then((function(e){R(e,t,n,i,o,a,r,s).then(c).catch(l)}))}))}function R(e,t,n,i,o,a,r,s){return new Promise((function(c,l){Object(d.a)(e).then((function(l){var u=O();u.type="img","image"===i?u.shareType="img":"zoneimage"===i?u.shareType="zoneimg":"roomImage"===i&&(u.shareType="roomimg"),u.contentDesc=String(null===s||void 0===s?void 0:s.toString()),u.noFrame=!0,u.scaleRotateToggle=!0,u.url=e,u.size=[l[0],l[1]],u.originalSize=[l[0],l[1]];for(var d=0;d<u.pose.position.length;d+=1)n?"contextmenu"===r?(u.pose.position[0]=Number(o),u.pose.position[1]=Number(a)):u.pose.position[d]=t.mouseOnMap[d]+n[d]:u.pose.position[d]=t.mouseOnMap[d]-.5*u.size[d];c(u)}))}))}function I(e){}function w(e,t,n){return console.error("createContentOfPdf called."),new Promise((function(e,t){if(gapi){gapi.client.init({apiKey:"AIzaSyCE4B2cKycH0fVmBznwfr1ynnNf2qNEU9M",clientId:"188672642721-3f8u1671ecugbl2ukhjmb18nv283upm0.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/drive.appdata",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"]}).then((function(){console.log("Before getAuthInstance"),S=gapi.auth2.getAuthInstance(),console.log("Before listen updateSigninStatus"),S.isSignedIn.listen(I)}),(function(e){console.log("gapi.client.init failed:",e)}))}}))}function D(e,t,n,i,o,a){var r=O();r.type=n,r.url="","contextmenu"===a?(r.pose.position[0]=Number(i),r.pose.position[1]=Number(o)):(r.pose.position[0]=t.mouseOnMap[0],r.pose.position[1]=t.mouseOnMap[1]);var s=e.find((function(e){return"video"===e.getType()})),c=null===s||void 0===s?void 0:s.getTrack().getSettings();return r.originalSize=c?[c.width||0,c.height||0]:[0,0],r.size=[(r.originalSize[0]||640)/2,(r.originalSize[1]||360)/2],r}function P(e,t,n,i,o){return new Promise((function(a,r){var s=void 0;if(0===e.indexOf("http://")||0===e.indexOf("https://")){var c=new URL(e),l=e.slice(-4);Object(h.w)(c)?((s=T(e,t,n,i,o)).name="! recursive reference",a(s)):".jpg"===l||".JPG"===l||"jpeg"===l||"JPEG"===l||".png"===l||".PNG"===l||".gif"===l||".GIF"===l||".svg"===l||".SVG"===l?R(e,t).then((function(e){e.name=c.pathname,a(e)})).catch(r):j(e,t,n,i,o).then((function(r){"iframe"===r.type&&((r=T(e,t,n,i,o)).name="".concat(c.host).concat(c.pathname).concat(c.search)),"youtube"===r.type?r.name="".concat(c.search.substring(1)):r.name="".concat(c.host).concat(c.pathname).concat(c.search),a(r)})).catch(r)}else(s=T(e,t,n,i,o)).name=e.substring(0,20),a(s)}))}function M(e,t){return new Promise((function(n,i){(null===e||void 0===e?void 0:e.types.includes("Files"))?function(){for(var o=Array.from(e.items),a=[],r=[],s=function(){var e=l[c],s=e.getAsFile();if("file"===e.kind&&s){var u=void 0;-1!==e.type.indexOf("image")?u=_:"application/pdf"===e.type&&(u=w),u&&u(s,t).then((function(e){e.name=s.name,a.push(e),a.length+r.length===o.length&&(a.length?n(a):i(r))})).catch((function(e){r.push(e),a.length+r.length===o.length&&(a.length?n(a):i(r))}))}else r.push("Creator not found.")},c=0,l=o;c<l.length;c++)s()}():(null===e||void 0===e?void 0:e.types.includes("text/plain"))?e.items[0].getAsString((function(e){P(e,t,0,0,"").then((function(e){return n([e])})).catch(i)})):(console.error("Unhandled content types:",null===e||void 0===e?void 0:e.types),i("Unhandled content types:".concat(null===e||void 0===e?void 0:e.types)))}))}var N=Object(h.h)({zorder:!0,name:!0,ownerName:!0,color:!0,textColor:!0,type:!0,url:!0,pose:!0,size:!0,originalSize:!0,pinned:!0,noFrame:!0,opacity:!0,zone:!0,playback:!0,shareType:!0,showTitle:!0,contentDesc:!0,showStopWatch:!0,stopWatchToggle:!0,stopWatchReset:!0,scaleRotateToggle:!0});function x(e){return N(e)}function L(e){return e.map(x)}var F=Object(h.h)({zorder:!0,name:!0,ownerName:!0,color:!0,textColor:!0,type:!0,url:!0,pose:!0,size:!0,originalSize:!0,pinned:!0,noFrame:!0,opacity:!0,zone:!0,id:!0,playback:!0,shareType:!0,showTitle:!0,contentDesc:!0,showStopWatch:!0,stopWatchToggle:!0,stopWatchReset:!0,scaleRotateToggle:!0});function B(e){return e.map(F)}function U(e){var t=document.createElement("textarea");t.value=e,t.selectionStart=0,t.selectionEnd=t.value.length;var n=t.style;n.position="fixed",n.left="-100%",document.body.appendChild(t),t.focus();var i=document.execCommand("copy");return t.blur(),document.body.removeChild(t),i}function V(e){if("text"===e.type){var t=JSON.parse(e.url);U(t.messages.length?t.messages.map((function(e){return e.message})).reduce((function(e,t){return e?e+"\n":""+t})):"")}else if("youtube"===e.type){var n=e.url.split("&").filter((function(e){var t=e.split("=")[0];return"v"===t||"list"===t})),i=n.length?n.reduce((function(e,t){return(e?e+"&":"")+t})):"";U("https://www.youtube.com/watch?".concat(i))}else if("gdrive"===e.type){U(G(!0,H(e.url)))}else U(e.url)}function J(e){return!e||!("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e||"application/vnd.google-apps.presentation"===e||"application/vnd.google-apps.spreadsheet"===e||"image"===e.slice(0,5)||"video"===e.slice(0,5)||"audio"===e.slice(0,5))}function G(e,t){var n=t.get("id"),i=t.get("mimeType");i=i||"";var o="application/vnd.google-apps.",a="https://drive.google.com/file/d/".concat(n,"/preview");if(e||function(e){return!!e&&("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e||"application/vnd.google-apps.spreadsheet"===e||"application/vnd.google-apps.document"===e||"application/vnd.google-apps.presentation"===e)}(i))if(i.substr(0,o.length)===o){var r=i.substr(o.length);"failed"!==r&&("spreadsheet"===r&&(r="spreadsheets"),a="https://docs.google.com/".concat(r,"/d/").concat(n,"/edit"))}else if("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===i){a="https://docs.google.com/".concat("spreadsheets","/d/").concat(n,"/edit")}return a}function H(e){var t=e.indexOf("?"),n=t>=0?e.substr(t):e;return new Map(n.split("&").map((function(e){return e.split("=")})))}function z(e){var t="";return e.forEach((function(e,n){t="".concat(t).concat(t?"&":"").concat(n,"=").concat(e)})),t}function Q(e){return new Promise((function(t,n){gapi?(gapi.client.setApiKey("AIzaSyCE4B2cKycH0fVmBznwfr1ynnNf2qNEU9M"),gapi.client.load("drive","v3",(function(){gapi.client.drive.files.get({fileId:e,fields:"mimeType,name"}).then((function(e){var n=JSON.parse(e.body);t({mimeType:n.mimeType,name:n.name})})).catch((function(e){console.debug("GAPI error",e),n(e)}))}))):n("gapi is not loaded")}))}function K(e){if(Object(p.j)(e)){var t=b.c.sorted.findIndex((function(e){return e.zorder>p.b}));if(t<0&&(t=b.c.sorted.length),(t-=1)>=0){var n=b.c.sorted[t].zorder+1;e.zorder=n<=p.b?n:p.b}}else e.zorder=Math.floor(Date.now()/p.c)}function W(e){if(Object(p.j)(e)){var t=b.c.sorted[0];t!==e&&(e.zorder=t.zorder-1)}else{var n=b.c.sorted.find((function(e){return e.zorder>p.b}));n?e.zorder=n.zorder-1:K(e)}}function Y(e,t){if(t){var n=p.b-(Math.floor(Date.now()/p.c)-e.zorder);n<0&&(n=e.zorder%p.b),e.zorder=n}else e.zorder=e.zorder+p.b}},function(e,t,n){"use strict";(function(e){var i=n(69),o=n(6),a=n(8),r=n(34),s=n(33),c=n(22),l=n(57),u=n.n(l),d=n(145),p=n.n(d),h=n(74),f=n(53),m=n(160),v=n.n(m),g=n(31),b=n.n(g),y=n(232),A=n.n(y),S=n(45),E=n.n(S),O=n(35),C=n(21),j=n(32),T=n(28),k=n(43),_=n.n(k),R=n(72),I=n(116),w=Object(c.getLogger)(e);C.a.usesAdapter()&&n(667);var D,P=new u.a,M={video:{height:{ideal:720,max:720,min:180},width:{ideal:1280,max:1280,min:320}}},N="default",x=!1,L=!1,F=!1,B=!1,U=!1,V=null,J=document.createElement("audio"),G="undefined"!==typeof J.setSinkId,H=[];function z(){}function Q(e,t){var n=Boolean(t)&&t.getAudioTracks().length>0,i=Boolean(t)&&t.getVideoTracks().length>0,o={};-1!==e.indexOf("video")&&(o.video=i),-1!==e.indexOf("audio")&&(o.audio=n),P.emit(b.a.PERMISSIONS_CHANGED,o)}function K(e){var t=e.filter((function(e){return"audioinput"===e.kind})).length,n=e.filter((function(e){return"audiooutput"===e.kind})).length,i=e.filter((function(e){return"videoinput"===e.kind})).length,o=e.filter((function(e){return"videooutput"===e.kind})).length;e.forEach((function(e){var a={audio_input_device_count:t,audio_output_device_count:n,video_input_device_count:i,video_output_device_count:o,device_id:e.deviceId,device_group_id:e.groupId,device_kind:e.kind,device_label:e.label};T.a.sendAnalytics(O.l,a)}))}function W(e){(function(e){return e.length!==H.length||e.map(t).sort().join("")!==H.map(t).sort().join("");function t(e){return JSON.stringify({kind:e.kind,deviceId:e.deviceId,groupId:e.groupId,label:e.label,facing:e.facing})}})(e)&&(H=e.slice(0),w.info("list of media devices has changed:",H),K(H),P.emit(b.a.DEVICE_LIST_WILL_CHANGE,H),P.emit(b.a.DEVICE_LIST_CHANGED,H))}var Y=new(function(e){Object(r.a)(n,e);var t=Object(s.a)(n);function n(){return Object(o.a)(this,n),t.call(this,P)}return Object(a.a)(n,[{key:"init",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"boolean"===typeof n.disableAEC&&(F=n.disableAEC,w.info("Disable AEC: ".concat(F))),"boolean"===typeof n.disableNS&&(B=n.disableNS,w.info("Disable NS: ".concat(B))),"boolean"===typeof n.disableAP&&(L=n.disableAP,w.info("Disable AP: ".concat(L))),"boolean"===typeof n.disableAGC&&(U=n.disableAGC,w.info("Disable AGC: ".concat(U))),"boolean"===typeof(null===(e=n.audioQuality)||void 0===e?void 0:e.stereo)&&(V=n.audioQuality.stereo,w.info("Stereo: ".concat(V))),window.clearInterval(D),D=void 0,C.a.isReactNative()?(this.RTCPeerConnectionType=RTCPeerConnection,this.attachMediaStream=void 0,this.getStreamID=function(e){var t=e.id;return"number"===typeof t?t:j.a.filterSpecialChars(t)},this.getTrackID=function(e){return e.id}):(this.RTCPeerConnectionType=RTCPeerConnection,this.attachMediaStream=q((function(e,t){e&&(e.srcObject=t)})),this.getStreamID=function(e){return e.id},this.getTrackID=function(e){return e.id}),this.pcConstraints=C.a.isChromiumBased()||C.a.isReactNative()?{optional:[{googScreencastMinBitrate:100},{googCpuOveruseDetection:!0}]}:{},I.b.init(n),this.isDeviceListAvailable()&&this.enumerateDevices((function(e){H=e.slice(0),w.debug("Available devices: ",H),K(H),P.emit(b.a.DEVICE_LIST_AVAILABLE,H),C.a.supportsDeviceChangeEvent()?navigator.mediaDevices.addEventListener("devicechange",(function(){return t.enumerateDevices(z)})):D=window.setInterval((function(){return t.enumerateDevices(z)}),3e3)}))}},{key:"enumerateDevices",value:function(e){navigator.mediaDevices.enumerateDevices().then((function(t){W(t),e(t)})).catch((function(t){w.warn("Failed to  enumerate devices. ".concat(t)),W([]),e([])}))}},{key:"_getUserMedia",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return new Promise((function(i,o){var a,r=!1;"number"===typeof n&&!isNaN(n)&&n>0&&(a=setTimeout((function(){r=!0,a=void 0,o(new h.a(f.TIMEOUT))}),n)),navigator.mediaDevices.getUserMedia(t).then((function(t){w.log("onUserMediaSuccess"),Q(e,t),r||("undefined"!==typeof a&&clearTimeout(a),i(t))})).catch((function(n){w.warn("Failed to get access to local media. ".concat(n," ").concat(JSON.stringify(t)));var i=new h.a(n,t,e);r||("undefined"!==typeof a&&clearTimeout(a),o(n)),i.name===f.PERMISSION_DENIED&&Q(e,void 0)}))}))}},{key:"_getDesktopMedia",value:function(){return I.b.isSupported()?new Promise((function(e,t){I.b.obtainStream((function(t){e(t)}),(function(e){t(e)}))})):Promise.reject(new Error("Desktop sharing is not supported!"))}},{key:"_getMissingTracks",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=[],i=e.includes("audio"),o=t&&t.getAudioTracks().length>0;i&&!o&&n.push("audio");var a=e.includes("video"),r=t&&t.getVideoTracks().length>0;return a&&!r&&n.push("video"),n}},{key:"obtainAudioAndVideoPermissions",value:function(e){var t=this,n=e.timeout,o=Object(i.a)(e,["timeout"]),a=[],r=function(){if(!(-1!==(o.devices||[]).indexOf("desktop")))return Promise.resolve();var e=o.desktopSharingSourceDevice;if(e){var t=H&&H.find((function(t){return"videoinput"===t.kind&&(t.deviceId===e||t.label===e)}));if(!t)return Promise.reject(new h.a({name:"ConstraintNotSatisfiedError"},{},[e]));var i={video:{deviceId:t.deviceId}};return this._getUserMedia(["video"],i,n).then((function(e){return{sourceType:"device",stream:e}}))}return this._getDesktopMedia()}.bind(this),s=function(){var e=(o.devices||["audio","video"]).filter((function(e){return"audio"===e||"video"===e}));if(!e.length)return Promise.resolve();var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=p()(t.constraints||M);if(e.indexOf("video")>=0){if(A.a[t.resolution]){var i=A.a[t.resolution];n.video.height={ideal:i.height},n.video.width={ideal:i.width}}if(n.video||(n.video={}),C.a.isWebKitBased()&&(n.video.height&&n.video.height.ideal?n.video.height={ideal:n.video.height.ideal}:w.warn("Ideal camera height missing, camera may not start properly"),n.video.width&&n.video.width.ideal?n.video.width={ideal:n.video.width.ideal}:w.warn("Ideal camera width missing, camera may not start properly")),t.cameraDeviceId)n.video.deviceId=t.cameraDeviceId;else{var o=t.facingMode||v.a.USER;n.video.facingMode=o}}else n.video=!1;return e.indexOf("audio")>=0?(n.audio&&"boolean"!==typeof n.audio||(n.audio={}),n.audio={autoGainControl:!U&&!L,deviceId:t.micDeviceId,echoCancellation:!F&&!L,noiseSuppression:!B&&!L},V&&Object.assign(n.audio,{channelCount:2})):n.audio=!1,n}(e,o);return w.info("Got media constraints: ",JSON.stringify(t)),this._getUserMedia(e,t,n)}.bind(this);return r().then((function(e){if(e){var t=e.stream,n=e.sourceId,i=e.sourceType,o=t.getAudioTracks();if(o.length){var r=new MediaStream(o);a.push({stream:r,sourceId:n,sourceType:i,track:r.getAudioTracks()[0]})}var s=t.getVideoTracks();if(s.length){var c=new MediaStream(s);a.push({stream:c,sourceId:n,sourceType:i,track:c.getVideoTracks()[0],videoType:E.a.DESKTOP})}}})).then(s).then((function(e){if(e){var t=e.getAudioTracks();if(t.length){var n=new MediaStream(t);a.push({stream:n,track:n.getAudioTracks()[0],effects:o.effects})}var i=e.getVideoTracks();if(i.length){var r=new MediaStream(i);a.push({stream:r,track:r.getVideoTracks()[0],videoType:E.a.CAMERA,effects:o.effects})}}})).then((function(){return a})).catch((function(e){return a.forEach((function(e){var n=e.stream;t.stopMediaStream(n)})),Promise.reject(e)}))}},{key:"isDeviceListAvailable",value:function(){return Boolean(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)}},{key:"isDeviceChangeAvailable",value:function(e){return"output"===e||"audiooutput"===e?G:"audioinput"!==e&&"input"!==e||!C.a.isIosBrowser()}},{key:"stopMediaStream",value:function(e){e&&(e.getTracks().forEach((function(e){e.stop&&e.stop()})),e.stop&&e.stop(),e.release&&e.release())}},{key:"isDesktopSharingEnabled",value:function(){return I.b.isSupported()}},{key:"setAudioOutputDevice",value:function(e){return this.isDeviceChangeAvailable("output")?J.setSinkId(e).then((function(){N=e,x=!0,w.log("Audio output device set to ".concat(e)),P.emit(b.a.AUDIO_OUTPUT_DEVICE_CHANGED,e)})):Promise.reject(new Error("Audio output device change is not supported"))}},{key:"setDesktopSharingFrameRate",value:function(e){I.b.setDesktopSharingFrameRate(e)}},{key:"getAudioOutputDevice",value:function(){return N}},{key:"getCurrentlyAvailableMediaDevices",value:function(){return H}},{key:"arePermissionsGrantedForAvailableDevices",value:function(){return H.some((function(e){return Boolean(e.label)}))}},{key:"getEventDataForActiveDevice",value:function(e){var t=[],n={deviceId:e.deviceId,kind:e.kind,label:e.label,groupId:e.groupId};return t.push(n),{deviceList:t}}},{key:"setSuspendVideo",value:function(e,t){e.optional||(e.optional=[]),e.optional=e.optional.filter((function(e){return!e.hasOwnProperty("googSuspendBelowMinBitrate")})),t&&e.optional.push({googSuspendBelowMinBitrate:"true"})}}]),n}(R.a));function q(e){return function(t,n){var i=e.apply(Y,arguments);return n&&Y.isDeviceChangeAvailable("output")&&n.getAudioTracks&&n.getAudioTracks().length&&x&&t.setSinkId(Y.getAudioOutputDevice()).catch((function(e){var n=new h.a(e,null,["audiooutput"]);_.a.callUnhandledRejectionHandler({promise:this,reason:n}),w.warn("Failed to set audio output device for the element. Default audio output device will be used instead",t,n)})),i}}t.a=Y}).call(this,"/index.js")},function(e,t){var n=[],i=window.onerror;var o=window.onunhandledrejection;window.onerror=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];n.forEach((function(e){return e.apply(void 0,t)})),i&&i.apply(void 0,t)},window.onunhandledrejection=function(e){n.forEach((function(t){return t(null,null,null,null,e.reason)})),o&&o(e)};var a={addHandler:function(e){n.push(e)},callErrorHandler:function(e){var t=window.onerror;t&&t(null,null,null,null,e)},callUnhandledRejectionHandler:function(e){var t=window.onunhandledrejection;t&&t(e)}};e.exports=a},,function(e,t){e.exports={CAMERA:"camera",DESKTOP:"desktop"}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return w}));var i=n(14),o=n(6),a=n(8),r=n(25),s=n(34),c=n(33),l=n(22),u=n(12),d=n(179),p=n.n(d),h=n(20),f=n(31),m=n.n(f),v=n(21),g=n(73),b=n(28),y=n(43),A=n.n(y),S=n(72),E=n(103),O=n(384),C=n(195),j=n(42),T=n(385),k=Object(l.getLogger)(e),_=0,R=0;function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){var t=e.sourceId,n=e.sourceType,i=e.stream,o=e.track,a=e.videoType,r=e.effects,s=o.getSettings(),c=s.deviceId,l=s.facingMode;return R=Object(E.d)(R),new C.a({deviceId:c,facingMode:l,mediaType:o.kind,rtcId:R,sourceId:t,sourceType:n,stream:i,track:o,videoType:a||null,effects:r})}))}var w=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(o.a)(this,n),(i=t.call(this)).conference=e,i.peerConnections=new Map,i.localTracks=[],i.options=a,i._channel=null,i._lastN=void 0,i._lastNEndpoints=null,i._maxFrameHeight=void 0,i._selectedEndpoints=null,i._lastNChangeListener=i._onLastNChanged.bind(Object(r.a)(i)),i._onDeviceListChanged=i._onDeviceListChanged.bind(Object(r.a)(i)),i._updateAudioOutputForAudioTracks=i._updateAudioOutputForAudioTracks.bind(Object(r.a)(i)),i._videoType=p.a.NONE,j.a.isDeviceChangeAvailable("output")&&(j.a.addListener(m.a.AUDIO_OUTPUT_DEVICE_CHANGED,i._updateAudioOutputForAudioTracks),j.a.addListener(m.a.DEVICE_LIST_CHANGED,i._onDeviceListChanged)),i}return Object(a.a)(n,[{key:"destroy",value:function(){j.a.removeListener(m.a.AUDIO_OUTPUT_DEVICE_CHANGED,this._updateAudioOutputForAudioTracks),j.a.removeListener(m.a.DEVICE_LIST_CHANGED,this._onDeviceListChanged),this._channelOpenListener&&this.removeListener(m.a.DATA_CHANNEL_OPEN,this._channelOpenListener)}},{key:"initializeBridgeChannel",value:function(e,t){var n=this;this._channel=new O.a(e,t,this.eventEmitter),this._channelOpenListener=function(){var e=function(e,t,n){A.a.callErrorHandler(e),k.error("Cannot send ".concat(t,"(").concat(JSON.stringify(n),") endpoint message"),e)};if(n._receiverVideoConstraints)try{n._channel.sendNewReceiverVideoConstraintsMessage(n._receiverVideoConstraints)}catch(t){e(t,"ReceiverVideoConstraints",n._receiverVideoConstraints)}if(n._selectedEndpoints)try{n._channel.sendSelectedEndpointsMessage(n._selectedEndpoints)}catch(t){e(t,"SelectedEndpointsChangedEvent",n._selectedEndpoints)}if("undefined"!==typeof n._maxFrameHeight)try{n._channel.sendReceiverVideoConstraintMessage(n._maxFrameHeight)}catch(t){e(t,"ReceiverVideoConstraint",n._maxFrameHeight)}if("undefined"!==typeof n._lastN&&-1!==n._lastN)try{n._channel.sendSetLastNMessage(n._lastN)}catch(t){e(t,"LastNChangedEvent",n._lastN)}if(!g.a.isSourceNameSignalingEnabled())try{n._channel.sendVideoTypeMessage(n._videoType)}catch(t){e(t,"VideoTypeMessage",n._videoType)}n.removeListener(m.a.DATA_CHANNEL_OPEN,n._channelOpenListener),n._channelOpenListener=null},this.addListener(m.a.DATA_CHANNEL_OPEN,this._channelOpenListener),this.addListener(m.a.LASTN_ENDPOINT_CHANGED,this._lastNChangeListener)}},{key:"_onDeviceListChanged",value:function(){this._updateAudioOutputForAudioTracks(j.a.getAudioOutputDevice())}},{key:"_onLastNChanged",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=this._lastNEndpoints||[],i=[],o=[];this._lastNEndpoints=t,i=n.filter((function(t){return!e.isInLastN(t)})),o=t.filter((function(e){return-1===n.indexOf(e)})),this.conference.eventEmitter.emit(u.LAST_N_ENDPOINTS_CHANGED,i,o)}},{key:"onCallEnded",value:function(){this._channel&&(this._channel&&"websocket"===this._channel.mode&&this._channel.close(),this._channel=null)}},{key:"setDesktopSharingFrameRate",value:function(e){j.a.setDesktopSharingFrameRate(e)}},{key:"setNewReceiverVideoConstraints",value:function(e){this._receiverVideoConstraints=e,this._channel&&this._channel.isOpen()&&this._channel.sendNewReceiverVideoConstraintsMessage(e)}},{key:"setReceiverVideoConstraint",value:function(e){this._maxFrameHeight=e,this._channel&&this._channel.isOpen()&&this._channel.sendReceiverVideoConstraintMessage(e)}},{key:"setVideoType",value:function(e){this._videoType!==e&&(this._videoType=e,this._channel&&this._channel.isOpen()&&this._channel.sendVideoTypeMessage(e))}},{key:"sendSourceVideoType",value:function(e,t){this._channel&&this._channel.isOpen()&&this._channel.sendSourceVideoTypeMessage(e,t)}},{key:"selectEndpoints",value:function(e){this._selectedEndpoints=e,this._channel&&this._channel.isOpen()&&this._channel.sendSelectedEndpointsMessage(e)}},{key:"createPeerConnection",value:function(e,t,n,i){var o=JSON.parse(JSON.stringify(j.a.pcConstraints));"undefined"!==typeof i.abtestSuspendVideo&&(j.a.setSuspendVideo(o,i.abtestSuspendVideo),b.a.analytics.addPermanentProperties({abtestSuspendVideo:i.abtestSuspendVideo})),i.enableInsertableStreams&&(k.debug("E2EE - setting insertable streams constraints"),t.encodedInsertableStreams=!0),(v.a.isReactNative()||v.a.isChromiumBased()&&!i.usesUnifiedPlan)&&(k.debug("WebRTC application is running in plan-b mode"),t.sdpSemantics="plan-b"),i.forceTurnRelay&&(t.iceTransportPolicy="relay"),t.bundlePolicy="max-bundle",_=Object(E.d)(_);var a=new T.a(this,_,e,t,o,n,i);return this.peerConnections.set(a.id,a),a}},{key:"_removePeerConnection",value:function(e){var t=e.id;return!!this.peerConnections.has(t)&&(this.peerConnections.delete(t),!0)}},{key:"addLocalTrack",value:function(e){if(!e)throw new Error("track must not be null nor undefined");this.localTracks.push(e),e.conference=this.conference}},{key:"getLocalVideoTrack",value:function(){var e=this.getLocalTracks(h.VIDEO);return e.length?e[0]:void 0}},{key:"getLocalAudioTrack",value:function(){var e=this.getLocalTracks(h.AUDIO);return e.length?e[0]:void 0}},{key:"getLocalEndpointId",value:function(){return this.conference.myUserId()}},{key:"getLocalTracks",value:function(e){var t=this.localTracks.slice();return void 0!==e&&(t=t.filter((function(t){return t.getType()===e}))),t}},{key:"getRemoteTracks",value:function(e){var t,n=[],o=Object(i.a)(this.peerConnections.values());try{for(o.s();!(t=o.n()).done;){var a=t.value.getRemoteTracks(void 0,e);a&&(n=n.concat(a))}}catch(r){o.e(r)}finally{o.f()}return n}},{key:"setAudioMute",value:function(e){var t=[];return this.getLocalTracks(h.AUDIO).forEach((function(n){t.push(e?n.mute():n.unmute())})),Promise.all(t)}},{key:"setVideoMute",value:function(e){var t=[];return this.getLocalTracks(h.VIDEO).concat(this.getLocalTracks(h.PRESENTER)).forEach((function(n){t.push(e?n.mute():n.unmute())})),Promise.all(t)}},{key:"removeLocalTrack",value:function(e){var t=this.localTracks.indexOf(e);-1!==t&&this.localTracks.splice(t,1)}},{key:"closeBridgeChannel",value:function(){this._channel&&(this._channel.close(),this._channel=null,this.removeListener(m.a.LASTN_ENDPOINT_CHANGED,this._lastNChangeListener))}},{key:"setAudioLevel",value:function(e,t,n,i){var o=e.getTrackBySSRC(t);o&&(o.isAudioTrack()?(o.isLocal()!==i&&k.error("".concat(o," was expected to ").concat(i?"be":"not be"," local")),o.setAudioLevel(n,e)):k.warn("Received audio level for non-audio track: ".concat(t)))}},{key:"sendChannelMessage",value:function(e,t){if(!this._channel)throw new Error("Channel support is disabled!");this._channel.sendMessage(e,t)}},{key:"sendEndpointStatsMessage",value:function(e){this._channel&&this._channel.isOpen()&&this._channel.sendEndpointStatsMessage(e)}},{key:"setLastN",value:function(e){this._lastN!==e&&(this._lastN=e,this._channel&&this._channel.isOpen()&&this._channel.sendSetLastNMessage(e),this.eventEmitter.emit(m.a.LASTN_VALUE_CHANGED,e))}},{key:"setPerceptibles",value:function(e){this._channel&&this._channel.isOpen()&&this._channel.sendSetPerceptiblesEventMessage(e),this.eventEmitter.emit(m.a.PERCEPTIBLES_CHANGED,e)}},{key:"isInLastN",value:function(e){return!this._lastNEndpoints||this._lastNEndpoints.indexOf(e)>-1}},{key:"_updateAudioOutputForAudioTracks",value:function(e){var t,n=this.getRemoteTracks(h.AUDIO),o=Object(i.a)(n);try{for(o.s();!(t=o.n()).done;){t.value.setAudioOutput(e)}}catch(a){o.e(a)}finally{o.f()}}}],[{key:"createLocalTracks",value:function(e){return I(e)}},{key:"obtainAudioAndVideoPermissions",value:function(e){return j.a.obtainAudioAndVideoPermissions(e).then((function(e){return I(e)}))}},{key:"addListener",value:function(e,t){j.a.addListener(e,t)}},{key:"removeListener",value:function(e,t){j.a.removeListener(e,t)}},{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.options=e,j.a.init(this.options)}},{key:"attachMediaStream",value:function(e,t){return j.a.attachMediaStream(e,t)}},{key:"getStreamID",value:function(e){return j.a.getStreamID(e)}},{key:"getTrackID",value:function(e){return j.a.getTrackID(e)}},{key:"isDeviceListAvailable",value:function(){return j.a.isDeviceListAvailable()}},{key:"isDeviceChangeAvailable",value:function(e){return j.a.isDeviceChangeAvailable(e)}},{key:"isWebRtcSupported",value:function(){return v.a.isSupported()}},{key:"getAudioOutputDevice",value:function(){return j.a.getAudioOutputDevice()}},{key:"getCurrentlyAvailableMediaDevices",value:function(){return j.a.getCurrentlyAvailableMediaDevices()}},{key:"arePermissionsGrantedForAvailableDevices",value:function(){return j.a.arePermissionsGrantedForAvailableDevices()}},{key:"getEventDataForActiveDevice",value:function(e){return j.a.getEventDataForActiveDevice(e)}},{key:"setAudioOutputDevice",value:function(e){return j.a.setAudioOutputDevice(e)}},{key:"isUserStream",value:function(e){return n.isUserStreamById(j.a.getStreamID(e))}},{key:"isUserStreamById",value:function(e){return e&&"mixedmslabel"!==e&&"default"!==e}},{key:"enumerateDevices",value:function(e){j.a.enumerateDevices(e)}},{key:"stopMediaStream",value:function(e){j.a.stopMediaStream(e)}},{key:"isDesktopSharingEnabled",value:function(){return j.a.isDesktopSharingEnabled()}}]),n}(S.a)}).call(this,"/index.js")},,,function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"j",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"e",(function(){return p}));function i(e){return{id:e.id,name:e.name,ownerName:e.ownerName,color:e.color,textColor:e.textColor,type:e.type,shareType:e.shareType,contentDesc:e.contentDesc}}var o=100,a=31536e7/o;function r(e){return"text"===e.type||"pdf"===e.type}function s(e){return e&&"camera"!==e.type&&"screen"!==e.type}function c(e){return e&&("text"===e.type||"iframe"===e.type||"pdf"===e.type||"whiteboard"===e.type||"gdrive"===e.type||"youtube"===e.type)}function l(e){return e&&e.zorder<=a}var u=1048576;function d(e){return!e||e.pose.position[0]===u}function p(e,t){return e.time-t.time}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return l}));var i=n(135),o=60,a={name:"Anonymous",email:"",avatarSrc:"",color:[],textColor:[],notifyCall:!0,notifyTouch:!1,notifyNear:!1,notifyYarn:!1},r={name:"",avatarSrc:"",color:[],textColor:[]},s={located:!0,onStage:!1,awayFromKeyboard:!1},c={height:0,center:[0,0]};function l(e){var t=e.color;t.length||(t=e.name.length?Object(i.d)(e.name):[208,208,224]);var n=e.textColor;n.length||(n=Object(i.b)(t));var o=Object(i.a)(t);return[Object(i.f)(t),Object(i.f)(n),Object(i.f)(o)]}},,function(e,t,n){"use strict";n.r(t),n.d(t,"CONSTRAINT_FAILED",(function(){return i})),n.d(t,"ELECTRON_DESKTOP_PICKER_ERROR",(function(){return o})),n.d(t,"ELECTRON_DESKTOP_PICKER_NOT_FOUND",(function(){return a})),n.d(t,"GENERAL",(function(){return r})),n.d(t,"NOT_FOUND",(function(){return s})),n.d(t,"PERMISSION_DENIED",(function(){return c})),n.d(t,"SCREENSHARING_GENERIC_ERROR",(function(){return l})),n.d(t,"SCREENSHARING_USER_CANCELED",(function(){return u})),n.d(t,"TIMEOUT",(function(){return d})),n.d(t,"TRACK_IS_DISPOSED",(function(){return p})),n.d(t,"TRACK_NO_STREAM_FOUND",(function(){return h})),n.d(t,"UNSUPPORTED_RESOLUTION",(function(){return f}));var i="gum.constraint_failed",o="gum.electron_desktop_picker_error",a="gum.electron_desktop_picker_not_found",r="gum.general",s="gum.not_found",c="gum.permission_denied",l="gum.screensharing_generic_error",u="gum.screensharing_user_canceled",d="gum.timeout",p="track.track_is_disposed",h="track.no_stream_found",f="gum.unsupported_resolution"},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var i=5e3,o=[0,0]},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){var t=new URL(decodeURI(e)),n=["room","name","headphone","speaker","cameraOn","muteMic","testBot","skipEntrance"].reduce((function(e,n){return e[n]=t.searchParams.get(n),e}),{});return n.room=t.pathname.substr(1).replace(/[./@]/,"_")+(n.room?n.room:""),n}(window.location.href)},function(e,t,n){"use strict";var i=n(23),o=n(6),a=n(8),r=(n(84),n(10)),s=n(56),c=n(30),l=n(90),u=n(24),p=n(128),h=n(51),f=n(59),m=n(3),v=n(195);var g,b,y,A,S=n(97),E=n(13),O=n(2),C=new(g=function(){function e(){var t=this;Object(o.a)(this,e),Object(i.a)(this,"type",b,this),Object(i.a)(this,"types",y,this),Object(i.a)(this,"supressedTypes",A,this),this.reason="",this.name="",this.videoInputs=[],this.audioInputs=[],this.audioOutputs=[],this.canvas=void 0,this.oscillator=void 0,Object(O.g)(this),null!==f.a.testBot&&this.clear(),Object(O.c)((function(){t.show()?S.b.keyInputUsers.add("errorDialog"):S.b.keyInputUsers.delete("errorDialog")})),Object(O.c)((function(){E.a.local.physics.awayFromKeyboard&&t.setType("afk")}))}return Object(a.a)(e,[{key:"fatal",get:function(){return!this.type}},{key:"setType",value:function(e,t,n){this.type=e,this.types.add(e),this.reason=n,this.name=t}},{key:"title",get:function(){switch(this.type){case"connection":return Object(u.c)("etConnection");case"retry":return Object(u.c)("etRetry");case"noMic":return Object(u.c)("etNoMic");case"micPermission":return Object(u.c)("etMicPermission");case"channel":return Object(u.c)("etNoChannel");case"entrance":return"";case"afk":return Object(u.c)("afkTitle");case"kicked":return"Kicked by ".concat(this.name,". ").concat(this.reason)}return this.type}},{key:"message",get:function(){switch(this.type){case"connection":return Object(u.c)("emConnection");case"retry":return Object(u.c)("emRetry");case"noMic":return Object(u.c)("emNoMic");case"micPermission":return Object(u.c)("emMicPermission");case"channel":return Object(u.c)("emNoChannel");case"entrance":return"";case"afk":return Object(u.c)("afkMessage");case"kicked":return""}return"no message defined for ".concat(this.type)}},{key:"show",value:function(){if(""===this.type){var e=Object(m.g)(this.types,this.supressedTypes);e.size&&(this.type=e.values().next().value)}return""!==this.type&&!this.supressedTypes.has(this.type)}},{key:"enumerateDevices",value:function(){var e=this;navigator.mediaDevices.enumerateDevices().then((function(t){e.videoInputs=[],e.audioInputs=[],e.audioOutputs=[],t.forEach((function(t){"videoinput"===t.kind&&e.videoInputs.push(t),"audioinput"===t.kind&&e.audioInputs.push(t),"audiooutput"===t.kind&&e.audioOutputs.push(t)}))})).catch((function(){console.error("Device enumeration error")}))}},{key:"connectionStart",value:function(){var e=this;null!==f.a.skipEntrance&&(this.clear(),E.a.local.sendInformation()),this.enumerateDevices(),null===f.a.testBot?Object(O.j)((function(){return""===e.type}),(function(){setTimeout(e.checkConnection.bind(e),4e3)})):setTimeout(this.startTestBot.bind(this),3e3)}},{key:"clear",value:function(e){"afk"===this.type&&(E.a.local.physics.awayFromKeyboard=!1),e?(this.types.delete(e),this.type===e&&(this.type="")):(this.types.clear(),this.type="")}},{key:"checkConnection",value:function(){c.b.state!==l.a.CONNECTED?(this.setType("connection"),setTimeout(this.checkConnection.bind(this),5e3)):(this.clear("connection"),this.checkMic())}},{key:"checkMic",value:function(){!E.a.localId||E.a.local.muteAudio||c.b.conference.getLocalMicTrack()?(E.a.local.muteAudio&&setTimeout(this.checkMic.bind(this),5e3),this.clear("noMic"),this.clear("micPermission"),this.checkRemote()):(this.audioInputs.length?this.setType("micPermission"):(this.clear("micPermission"),this.setType("noMic")),setTimeout(this.checkMic.bind(this),5e3))}},{key:"checkRemote",value:function(){E.a.remote.size>0?setTimeout(this.checkChannel.bind(this),3e3):setTimeout(this.checkRemote.bind(this),1e3)}},{key:"checkChannel",value:function(){var e,t;E.a.remote.size>0?(null===(e=c.b.conference._jitsiConference)||void 0===e||null===(t=e.rtc._channel)||void 0===t?void 0:t.isOpen())?this.clear("channel"):(this.setType("channel"),setTimeout(this.checkChannel.bind(this),5e3)):this.checkRemote()}},{key:"startTestBot",value:function(){var e=this;E.a.local.muteAudio=!1,E.a.local.muteVideo=!1;var t=0,n=new AudioContext;this.oscillator=n.createOscillator(),this.oscillator.type="triangle";var i=n.createMediaStreamDestination();this.oscillator.connect(i),this.oscillator.start(),this.canvas=document.createElement("canvas");var o=240,a=240;this.canvas.style.width="".concat(o,"px"),this.canvas.style.height="".concat(a,"px");var r=this.canvas.getContext("2d"),l=[Math.random()*s.b/2,(Math.random()-.5)*s.b];setInterval((function(){var i,o;if(r&&n){null===(i=e.oscillator)||void 0===i||i.frequency.setValueAtTime(440+t%440,n.currentTime);var a=["green","blue"],s=p.a.tracksToAccept[0].length?E.a.remote.get(p.a.tracksToAccept[0][0].endpointId):void 0;s&&!(null===s||void 0===s?void 0:s.tracks.avatarOk)&&(a[0]="yellow"),s&&(null===s||void 0===s||null===(o=s.tracks.audio)||void 0===o?void 0:o.getTrack().muted)&&(a[1]="red"),r.fillStyle=a[0],r.beginPath(),r.ellipse(151.2,79.2,24,96,t/20,0,2*Math.PI),r.fill(),r.fillStyle=a[1],r.beginPath(),r.ellipse(151.2,79.2,24,96,-t/20,0,2*Math.PI),r.fill(),t+=1}}),50);var u="01234567890ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijlkmnopqrstuvwxyz",d=function(){return u.substr(Math.floor(Math.random()*u.length),1)};E.a.local.information=h.b,E.a.local.information.name="testBot ".concat(d()).concat(d()).concat(d()),E.a.local.sendInformation(),E.a.local.pose.position=l;var f=function(){E.a.local.pose.position=Object(m.a)(l,Object(m.A)(100,[Math.cos(t/60),Math.sin(t/60)]))},g=window;if(g.requestIdleCallback){!function e(){setTimeout((function(){f(),g.requestIdleCallback(e)}),50)}()}else setInterval(f,1e3);var b=this.canvas.captureStream(20),y=i.stream,A=new MediaStream;A.addTrack(y.getAudioTracks()[0]),A.addTrack(b.getVideoTracks()[0]);var S=function(e){var t=e.getVideoTracks()[0],n=e.getAudioTracks()[0],i=void 0,o=void 0;return n&&(i={videoType:null,mediaType:"audio",rtcId:0,stream:new MediaStream([n]),track:n,effects:void 0,resolution:n.getSettings().height,deviceId:"videofile_chrome",facingMode:"environment"}),t&&(o={videoType:"camera",mediaType:"video",rtcId:1,stream:new MediaStream([t]),track:t,effects:void 0,resolution:t.getSettings().height,deviceId:"videofile_chrome",facingMode:"environment"}),[o?new v.a(o):void 0,i?new v.a(i):void 0]}(A);c.b.conference.setLocalCameraTrack(S[0]),c.b.conference.setLocalMicTrack(S[1])}}]),e}(),Object(r.a)(g.prototype,"fatal",[O.d],Object.getOwnPropertyDescriptor(g.prototype,"fatal"),g.prototype),b=Object(r.a)(g.prototype,"type",[O.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"entrance"}}),y=Object(r.a)(g.prototype,"types",[O.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),A=Object(r.a)(g.prototype,"supressedTypes",[O.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),Object(r.a)(g.prototype,"setType",[O.b],Object.getOwnPropertyDescriptor(g.prototype,"setType"),g.prototype),Object(r.a)(g.prototype,"title",[O.d],Object.getOwnPropertyDescriptor(g.prototype,"title"),g.prototype),Object(r.a)(g.prototype,"message",[O.d],Object.getOwnPropertyDescriptor(g.prototype,"message"),g.prototype),Object(r.a)(g.prototype,"connectionStart",[O.b],Object.getOwnPropertyDescriptor(g.prototype,"connectionStart"),g.prototype),Object(r.a)(g.prototype,"clear",[O.b],Object.getOwnPropertyDescriptor(g.prototype,"clear"),g.prototype),Object(r.a)(g.prototype,"checkConnection",[O.b],Object.getOwnPropertyDescriptor(g.prototype,"checkConnection"),g.prototype),Object(r.a)(g.prototype,"checkMic",[O.b],Object.getOwnPropertyDescriptor(g.prototype,"checkMic"),g.prototype),Object(r.a)(g.prototype,"checkChannel",[O.b],Object.getOwnPropertyDescriptor(g.prototype,"checkChannel"),g.prototype),g);d.error=C;t.a=C},function(e,t,n){e.exports=n(503).default},,function(e,t,n){"use strict";n.r(t),n.d(t,"LOCAL_TRACK_STOPPED",(function(){return i})),n.d(t,"TRACK_AUDIO_LEVEL_CHANGED",(function(){return o})),n.d(t,"TRACK_AUDIO_OUTPUT_CHANGED",(function(){return a})),n.d(t,"TRACK_MUTE_CHANGED",(function(){return r})),n.d(t,"TRACK_VIDEOTYPE_CHANGED",(function(){return s})),n.d(t,"NO_DATA_FROM_SOURCE",(function(){return c})),n.d(t,"NO_AUDIO_INPUT",(function(){return l}));var i="track.stopped",o="track.audioLevelsChanged",a="track.audioOutputChanged",r="track.trackMuteChanged",s="track.videoTypeChanged",c="track.no_data_from_source",l="track.no_audio_input"},,,function(e,t,n){"use strict";n.r(t),n.d(t,"AUTHENTICATION_REQUIRED",(function(){return i})),n.d(t,"CHAT_ERROR",(function(){return o})),n.d(t,"CONFERENCE_DESTROYED",(function(){return a})),n.d(t,"CONFERENCE_MAX_USERS",(function(){return r})),n.d(t,"CONNECTION_ERROR",(function(){return s})),n.d(t,"CONFERENCE_RESTARTED",(function(){return c})),n.d(t,"NOT_ALLOWED_ERROR",(function(){return l})),n.d(t,"MEMBERS_ONLY_ERROR",(function(){return u})),n.d(t,"CONFERENCE_ACCESS_DENIED",(function(){return d})),n.d(t,"FOCUS_DISCONNECTED",(function(){return p})),n.d(t,"FOCUS_LEFT",(function(){return h})),n.d(t,"GRACEFUL_SHUTDOWN",(function(){return f})),n.d(t,"ICE_FAILED",(function(){return m})),n.d(t,"INCOMPATIBLE_SERVER_VERSIONS",(function(){return v})),n.d(t,"OFFER_ANSWER_FAILED",(function(){return g})),n.d(t,"PASSWORD_NOT_SUPPORTED",(function(){return b})),n.d(t,"PASSWORD_REQUIRED",(function(){return y})),n.d(t,"RESERVATION_ERROR",(function(){return A})),n.d(t,"VIDEOBRIDGE_NOT_AVAILABLE",(function(){return S}));var i="conference.authenticationRequired",o="conference.chatError",a="conference.destroyed",r="conference.max_users",s="conference.connectionError",c="conference.restarted",l="conference.connectionError.notAllowed",u="conference.connectionError.membersOnly",d="conference.connectionError.accessDenied",p="conference.focusDisconnected",h="conference.focusLeft",f="conference.gracefulShutdown",m="conference.iceFailed",v="conference.incompatible_server_versions",g="conference.offerAnswerFailed",b="conference.passwordNotSupported",y="conference.passwordRequired",A="conference.reservationError",S="conference.videobridgeNotAvailable"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n(19),o=n(14),a=n(39),r=n.n(a),s=n(21),c=n(73),l=n(32);function u(e){for(var t=e.split("\r\nm="),n=1,i=t.length;n<i;n++){var o="m=".concat(t[n]);n!==i-1&&(o+="\r\n"),t[n]=o}var a="".concat(t.shift(),"\r\n");this.media=t,this.raw=a+t.join(""),this.session=a}u.prototype.failICE=!1,u.prototype.removeTcpCandidates=!1,u.prototype.removeUdpCandidates=!1,u.prototype.getMediaSsrcMap=function(){for(var e=this,t={},n=function(n){var i={mediaindex:n,mid:l.a.parseMID(l.a.findLine(e.media[n],"a=mid:")),ssrcs:{},ssrcGroups:[]};t[n]=i,l.a.findLines(e.media[n],"a=ssrc:").forEach((function(e){var t=e.substring(7).split(" ")[0];i.ssrcs[t]||(i.ssrcs[t]={ssrc:t,lines:[]}),i.ssrcs[t].lines.push(e)})),l.a.findLines(e.media[n],"a=ssrc-group:").forEach((function(e){var t=e.indexOf(" "),n=e.substr(0,t).substr(13),o=e.substr(14+n.length).split(" ");o.length&&i.ssrcGroups.push({semantics:n,ssrcs:o})}))},i=0;i<this.media.length;i++)n(i);return t},u.prototype.containsSSRC=function(e){var t=this.getMediaSsrcMap(),n=!1;return Object.keys(t).forEach((function(i){n||t[i].ssrcs[e]&&(n=!0)})),n},u.prototype.toJingle=function(e,t){l.a.findLines(this.session,"a=group:").forEach((function(t){var n=t.split(" "),i=n.shift().substr(8);e.c("group",{xmlns:"urn:xmpp:jingle:apps:grouping:0",semantics:i});for(var o=0;o<n.length;o++)e.c("content",{name:n[o]}).up();e.up()}));for(var n=0;n<this.media.length;n++){var a=l.a.parseMLine(this.media[n].split("\r\n")[0]);if("audio"===a.media||"video"===a.media||"application"===a.media){var u=void 0,d=l.a.findLine(this.media[n],"a=ssrc:");u=!!d&&d.substring(7).split(" ")[0],e.c("content",{creator:t,name:a.media});var p=l.a.findLine(this.media[n],"a=mid:");if(p){var h=l.a.parseMID(p);e.attrs({name:h})}if("audio"===a.media||"video"===a.media){e.c("description",{xmlns:"urn:xmpp:jingle:apps:rtp:1",media:a.media}),u&&e.attrs({ssrc:u});for(var f=0;f<a.fmt.length;f++){var m=l.a.findLine(this.media[n],"a=rtpmap:".concat(a.fmt[f]));e.c("payload-type",l.a.parseRTPMap(m));var v=l.a.findLine(this.media[n],"a=fmtp:".concat(a.fmt[f]));if(v)for(var g=l.a.parseFmtp(v),b=0;b<g.length;b++)e.c("parameter",g[b]).up();this.rtcpFbToJingle(n,e,a.fmt[f]),e.up()}if(u){var y,A=l.a.parseSSRC(this.media[n]),S=Object(o.a)(A);try{for(S.s();!(y=S.n()).done;){var E=Object(i.a)(y.value,2),O=E[0],C=E[1],j=l.a.parseSourceNameLine(C);e.c("source",{ssrc:O,name:c.a.isSourceNameSignalingEnabled()?j:void 0,xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"});var T=l.a.parseMSIDAttribute(C);T&&(e.c("parameter"),e.attrs({name:"msid"}),e.attrs({value:T}),e.up()),e.up()}}catch(P){S.e(P)}finally{S.f()}l.a.findLines(this.media[n],"a=ssrc-group:").forEach((function(t){var n=t.indexOf(" "),i=t.substr(0,n).substr(13),o=t.substr(14+i.length).split(" ");o.length&&(e.c("ssrc-group",{semantics:i,xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"}),o.forEach((function(t){return e.c("source",{ssrc:t}).up()})),e.up())}))}var k=l.a.findLines(this.media[n],"a=rid:");if(k.length&&s.a.usesRidsForSimulcast()){var _=k.map((function(e){return e.split(":")[1]})).map((function(e){return e.split(" ")[0]}));_.forEach((function(t){e.c("source",{rid:t,xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"}),e.up()})),l.a.findLine(this.media[n],"a=simulcast:")&&(e.c("rid-group",{semantics:"SIM",xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"}),_.forEach((function(t){e.c("source",{rid:t}).up()})),e.up())}l.a.findLine(this.media[n],"a=rtcp-mux")&&e.c("rtcp-mux").up(),this.rtcpFbToJingle(n,e,"*");for(var R=l.a.findLines(this.media[n],"a=extmap:"),I=0;I<R.length;I++){var w=l.a.parseExtmap(R[I]);if(e.c("rtp-hdrext",{xmlns:"urn:xmpp:jingle:apps:rtp:rtp-hdrext:0",uri:w.uri,id:w.value}),w.hasOwnProperty("direction"))switch(w.direction){case r.a.SENDONLY:e.attrs({senders:"responder"});break;case r.a.RECVONLY:e.attrs({senders:"initiator"});break;case r.a.SENDRECV:e.attrs({senders:"both"});break;case r.a.INACTIVE:e.attrs({senders:"none"})}e.up()}e.up()}this.transportToJingle(n,e);var D=this.media[n];l.a.findLine(D,"a=".concat(r.a.SENDRECV),this.session)?e.attrs({senders:"both"}):l.a.findLine(D,"a=".concat(r.a.SENDONLY),this.session)?e.attrs({senders:"initiator"}):l.a.findLine(D,"a=".concat(r.a.RECVONLY),this.session)?e.attrs({senders:"responder"}):l.a.findLine(D,"a=".concat(r.a.INACTIVE),this.session)&&e.attrs({senders:"none"}),"0"!==a.port||l.a.findLine(D,"a=bundle-only",this.session)||e.attrs({senders:"rejected"}),e.up()}}return e.up(),e},u.prototype.transportToJingle=function(e,t){var n=this;t.c("transport");var i=l.a.findLine(this.media[e],"a=sctp-port:",this.session),o=l.a.findLine(this.media[e],"a=sctpmap:",this.session);if(i){var a=l.a.parseSCTPPort(i);t.c("sctpmap",{xmlns:"urn:xmpp:jingle:transports:dtls-sctp:1",number:a,protocol:"webrtc-datachannel"}),t.attrs({streams:0}),t.up()}else if(o){var r=l.a.parseSCTPMap(o);t.c("sctpmap",{xmlns:"urn:xmpp:jingle:transports:dtls-sctp:1",number:r[0],protocol:r[1]}),r.length>2?t.attrs({streams:r[2]}):t.attrs({streams:0}),t.up()}l.a.findLines(this.media[e],"a=fingerprint:",this.session).forEach((function(i){var o=l.a.parseFingerprint(i);o.xmlns="urn:xmpp:jingle:apps:dtls:0",t.c("fingerprint").t(o.fingerprint),delete o.fingerprint;var a=l.a.findLine(n.media[e],"a=setup:",n.session);a&&(o.setup=a.substr(8)),t.attrs(o),t.up()}));var s=l.a.iceparams(this.media[e],this.session);s&&(s.xmlns="urn:xmpp:jingle:transports:ice-udp:1",t.attrs(s),l.a.findLines(this.media[e],"a=candidate:",this.session).forEach((function(e){var i=l.a.candidateToJingle(e);n.failICE&&(i.ip="1.1.1.1");var o=i&&"string"===typeof i.protocol?i.protocol.toLowerCase():"";n.removeTcpCandidates&&("tcp"===o||"ssltcp"===o)||n.removeUdpCandidates&&"udp"===o||t.c("candidate",i).up()})));t.up()},u.prototype.rtcpFbToJingle=function(e,t,n){l.a.findLines(this.media[e],"a=rtcp-fb:".concat(n)).forEach((function(e){var n=l.a.parseRTCPFB(e);"trr-int"===n.type?(t.c("rtcp-fb-trr-int",{xmlns:"urn:xmpp:jingle:apps:rtp:rtcp-fb:0",value:n.params[0]}),t.up()):(t.c("rtcp-fb",{xmlns:"urn:xmpp:jingle:apps:rtp:rtcp-fb:0",type:n.type}),n.params.length>0&&t.attrs({subtype:n.params[0]}),t.up())}))},u.prototype.rtcpFbFromJingle=function(e,t){var n="",i=e.find('>rtcp-fb-trr-int[xmlns="urn:xmpp:jingle:apps:rtp:rtcp-fb:0"]');return i.length&&(n+="a=rtcp-fb:* trr-int ",i.attr("value")?n+=i.attr("value"):n+="0",n+="\r\n"),e.find('>rtcp-fb[xmlns="urn:xmpp:jingle:apps:rtp:rtcp-fb:0"]').each((function(e,i){n+="a=rtcp-fb:".concat(t," ").concat(i.getAttribute("type")),i.hasAttribute("subtype")&&(n+=" ".concat(i.getAttribute("subtype"))),n+="\r\n"})),n},u.prototype.fromJingle=function(e){var t=this,n=Date.now();this.raw="v=0\r\n"+"o=- ".concat(n," 2 IN IP4 0.0.0.0\r\n")+"s=-\r\nt=0 0\r\n";var i=$(e).find('>group[xmlns="urn:xmpp:jingle:apps:grouping:0"]');i.length&&i.each((function(e,n){var i=$(n).find(">content").map((function(e,t){return t.getAttribute("name")})).get();i.length>0&&(t.raw+="a=group:".concat(n.getAttribute("semantics")||n.getAttribute("type")," ").concat(i.join(" "),"\r\n"))})),this.session=this.raw,e.find(">content").each((function(e,n){var i=t.jingle2media($(n));t.media.push(i)})),this.raw=this.session+this.media.join("")},u.prototype.jingle2media=function(e){var t=this,n=e.find(">description"),i=e.find('>transport[xmlns="urn:xmpp:jingle:transports:ice-udp:1"]'),o="",a=i.find('>sctpmap[xmlns="urn:xmpp:jingle:transports:dtls-sctp:1"]'),s={media:n.attr("media"),port:"9"};switch("rejected"===e.attr("senders")&&(s.port="0"),i.find('>fingerprint[xmlns="urn:xmpp:jingle:apps:dtls:0"]').length?s.proto=a.length?"UDP/DTLS/SCTP":"UDP/TLS/RTP/SAVPF":s.proto="UDP/TLS/RTP/SAVPF",a.length?(o+="m=application ".concat(s.port," UDP/DTLS/SCTP webrtc-datachannel\r\n"),o+="a=sctp-port:".concat(a.attr("number"),"\r\n"),o+="a=max-message-size:262144\r\n"):(s.fmt=n.find(">payload-type").map((function(e,t){return t.getAttribute("id")})).get(),o+="".concat(l.a.buildMLine(s),"\r\n")),o+="c=IN IP4 0.0.0.0\r\n",a.length||(o+="a=rtcp:1 IN IP4 0.0.0.0\r\n"),i.length&&(i.attr("ufrag")&&(o+="".concat(l.a.buildICEUfrag(i.attr("ufrag")),"\r\n")),i.attr("pwd")&&(o+="".concat(l.a.buildICEPwd(i.attr("pwd")),"\r\n")),i.find('>fingerprint[xmlns="urn:xmpp:jingle:apps:dtls:0"]').each((function(e,t){o+="a=fingerprint:".concat(t.getAttribute("hash")),o+=" ".concat($(t).text()),o+="\r\n",t.hasAttribute("setup")&&(o+="a=setup:".concat(t.getAttribute("setup"),"\r\n"))}))),i.find(">candidate").each((function(e,n){var i=n.getAttribute("protocol");i="string"===typeof i?i.toLowerCase():"",t.removeTcpCandidates&&("tcp"===i||"ssltcp"===i)||t.removeUdpCandidates&&"udp"===i||(t.failICE&&n.setAttribute("ip","1.1.1.1"),o+=l.a.candidateFromJingle(n))})),e.attr("senders")){case"initiator":o+="a=".concat(r.a.SENDONLY,"\r\n");break;case"responder":o+="a=".concat(r.a.RECVONLY,"\r\n");break;case"none":o+="a=".concat(r.a.INACTIVE,"\r\n");break;case"both":o+="a=".concat(r.a.SENDRECV,"\r\n")}o+="a=mid:".concat(e.attr("name"),"\r\n"),n.find(">rtcp-mux").length&&(o+="a=rtcp-mux\r\n"),n.find(">payload-type").each((function(e,n){o+="".concat(l.a.buildRTPMap(n),"\r\n"),$(n).find(">parameter").length&&(o+="a=fmtp:".concat(n.getAttribute("id")," "),o+=$(n).find(">parameter").map((function(e,t){var n=t.getAttribute("name");return(n?"".concat(n,"="):"")+t.getAttribute("value")})).get().join("; "),o+="\r\n"),o+=t.rtcpFbFromJingle($(n),n.getAttribute("id"))})),o+=this.rtcpFbFromJingle(n,"*"),n.find('>rtp-hdrext[xmlns="urn:xmpp:jingle:apps:rtp:rtp-hdrext:0"]').each((function(e,t){o+="a=extmap:".concat(t.getAttribute("id")," ").concat(t.getAttribute("uri"),"\r\n")})),n.find('>ssrc-group[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]').each((function(e,t){var n=t.getAttribute("semantics"),i=$(t).find(">source").map((function(e,t){return t.getAttribute("ssrc")})).get();i.length&&(o+="a=ssrc-group:".concat(n," ").concat(i.join(" "),"\r\n"))}));var c="",u="";return n.find('>source[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]').each((function(e,t){var n=t.getAttribute("ssrc"),i=!0,o="";$(t).find(">parameter").each((function(e,t){var a,r=t.getAttribute("name"),s=t.getAttribute("value");s=l.a.filterSpecialChars(s),o+="a=ssrc:".concat(n," ").concat(r),s&&s.length&&(o+=":".concat(s)),o+="\r\n",null!==(a=s)&&void 0!==a&&a.includes("mixedmslabel")&&(i=!1)})),i?c+=o:u+=o})),o+=u+c}},function(e,t){e.exports={H264:"h264",OPUS:"opus",VP8:"vp8",VP9:"vp9"}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(6),o=n(8),a=n(57),r=n.n(a),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new r.a;Object(i.a)(this,e),this.eventEmitter=t,this.addEventListener=this.on=this.addListener,this.removeEventListener=this.off=this.removeListener}return Object(o.a)(e,[{key:"addListener",value:function(e,t){var n=this;return this.eventEmitter.addListener(e,t),function(){return n.removeEventListener(e,t)}}},{key:"removeListener",value:function(e,t){this.eventEmitter.removeListener(e,t)}}]),e}()},function(e,t,n){"use strict";var i=n(6),o=n(8),a=n(22),r=Object(a.getLogger)("FeatureFlags"),s=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,[{key:"init",value:function(e){this._sourceNameSignaling=Boolean(e.sourceNameSignaling),r.info("Source name signaling: ".concat(this._sourceNameSignaling))}},{key:"isSourceNameSignalingEnabled",value:function(){return this._sourceNameSignaling}}]),e}();t.a=new s},function(e,t,n){"use strict";var i=n(53),o={};function a(e,t,n){if("object"===typeof e&&"undefined"!==typeof e.name)switch(this.gum={error:e,constraints:t,devices:n&&Array.isArray(n)?n.slice(0):void 0},e.name){case"NotAllowedError":case"PermissionDeniedError":case"SecurityError":this.name=i.PERMISSION_DENIED,this.message=o[this.name]+(this.gum.devices||[]).join(", ");break;case"DevicesNotFoundError":case"NotFoundError":this.name=i.NOT_FOUND,this.message=o[this.name]+(this.gum.devices||[]).join(", ");break;case"ConstraintNotSatisfiedError":case"OverconstrainedError":var a=e.constraintName||e.constraint;t&&t.video&&(!n||n.indexOf("video")>-1)&&("minWidth"===a||"maxWidth"===a||"minHeight"===a||"maxHeight"===a||"width"===a||"height"===a||"deviceId"===a)?(this.name=i.UNSUPPORTED_RESOLUTION,this.message=o[this.name]+function(e,t){if(t&&t.video&&t.video.mandatory)switch(e){case"width":return t.video.mandatory.minWidth;case"height":return t.video.mandatory.minHeight;default:return t.video.mandatory[e]||""}return""}(a,t)):(this.name=i.CONSTRAINT_FAILED,this.message=o[this.name]+e.constraintName);break;default:this.name=i.GENERAL,this.message=e.message||o[this.name]}else{if("string"!==typeof e)throw new Error("Invalid arguments");o[e]?(this.name=e,this.message=t||o[e]):this.message=e}this.stack=e.stack||(new Error).stack}o[i.UNSUPPORTED_RESOLUTION]="Video resolution is not supported: ",o[i.SCREENSHARING_USER_CANCELED]="User canceled screen sharing prompt",o[i.SCREENSHARING_GENERIC_ERROR]="Unknown error from screensharing",o[i.ELECTRON_DESKTOP_PICKER_ERROR]="Unkown error from desktop picker",o[i.ELECTRON_DESKTOP_PICKER_NOT_FOUND]="Failed to detect desktop picker",o[i.GENERAL]="Generic getUserMedia error",o[i.PERMISSION_DENIED]="User denied permission to use device(s): ",o[i.NOT_FOUND]="Requested device(s) was/were not found: ",o[i.CONSTRAINT_FAILED]="Constraint could not be satisfied: ",o[i.TIMEOUT]="Could not start media source. Timeout occured!",o[i.TRACK_IS_DISPOSED]="Track has been already disposed",o[i.TRACK_NO_STREAM_FOUND]="Track does not have an associated Media Stream",a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,t.a=a},,,function(e,t,n){"use strict";n.r(t),n.d(t,"DETECTOR_STATE_CHANGE",(function(){return i})),n.d(t,"AUDIO_INPUT_STATE_CHANGE",(function(){return o})),n.d(t,"NO_AUDIO_INPUT",(function(){return a})),n.d(t,"VAD_NOISY_DEVICE",(function(){return r})),n.d(t,"VAD_REPORT_PUBLISHED",(function(){return s})),n.d(t,"VAD_SCORE_PUBLISHED",(function(){return c})),n.d(t,"VAD_TALK_WHILE_MUTED",(function(){return l}));var i="detector_state_change",o="audio_input_state_changed",a="no_audio_input_detected",r="detection.vad_noise_device",s="vad-report-published",c="detection.vad_score_published",l="detection.vad_talk_while_muted"},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return I})),n.d(t,"d",(function(){return w})),n.d(t,"c",(function(){return D})),n.d(t,"b",(function(){return P})),n.d(t,"e",(function(){return M}));var i=n(6),o=n(8),a=n(34),r=n(33),s=n(22),c=n(15),l=(n(508),n(131)),u=n(82),d=n(11),p=n.n(d),h=n(21),f=n(200),m=n(28),v=n(43),g=n.n(v),b=n(72),y=n(126),A=n.n(y),S=n(292),E=n(137),O=n(368),C=n(374),j=n(380),T=n(381),k=n(382),_=Object(s.getLogger)(e),R=/<failure.*><not-allowed\/><text>(.*)<\/text><\/failure>/gi;var I=[{urls:"stun:meet-jit-si-turnrelay.jitsi.net:443"}],w="type",D="http://jitsi.org/protocol/jigasi",P="https://jitsi.org/meet/e2ee",M=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e,o){var a,r;Object(i.a)(this,n),(r=t.call(this)).connection=null,r.disconnectInProgress=!1,r.connectionTimes={},r.options=e,r.token=o,r.authenticatedUser=!1,Object(k.a)(),Object(j.a)();var s=e.xmppPing||{};return s.domain=e.hosts.domain,r.connection=function(e){var t=e.enableWebsocketResume,n=e.serviceUrl,i=void 0===n?"/http-bind":n,o=e.shard,a=e.token,r=e.websocketKeepAlive,s=e.websocketKeepAliveUrl,c=e.xmppPing;return a&&(i+="".concat(-1===i.indexOf("?")?"?":"&","token=").concat(a)),new E.a({enableWebsocketResume:t,serviceUrl:i,websocketKeepAlive:r,websocketKeepAliveUrl:s,xmppPing:c,shard:o})}({enableWebsocketResume:e.enableWebsocketResume,serviceUrl:e.serviceUrl||e.bosh,token:o,websocketKeepAlive:e.websocketKeepAlive,websocketKeepAliveUrl:e.websocketKeepAliveUrl,xmppPing:s,shard:null===(a=e.deploymentInfo)||void 0===a?void 0:a.shard}),r.connection.on(E.a.Events.CONN_SHARD_CHANGED,(function(){var e={shard_changed:!0,suspend_time:r.connection.ping.getPingSuspendTime(),time_since_last_success:r.connection.getTimeSinceLastSuccess()};r.eventEmitter.emit(u.CONNECTION_FAILED,l.OTHER_ERROR,void 0,void 0,e)})),r._initStrophePlugins(),r.caps=new S.a(r.connection,"https://jitsi.org/jitsi-meet"),r.initFeaturesList(),$(window).on("".concat(r.options.disableBeforeUnloadHandlers?"":"beforeunload ","unload"),(function(e){r.disconnect(e).catch((function(){}))})),r}return Object(o.a)(n,[{key:"initFeaturesList",value:function(){this.caps.addFeature("urn:xmpp:jingle:1"),this.caps.addFeature("urn:xmpp:jingle:apps:rtp:1"),this.caps.addFeature("urn:xmpp:jingle:transports:ice-udp:1"),this.caps.addFeature("urn:xmpp:jingle:apps:dtls:0"),this.caps.addFeature("urn:xmpp:jingle:transports:dtls-sctp:1"),this.caps.addFeature("urn:xmpp:jingle:apps:rtp:audio"),this.caps.addFeature("urn:xmpp:jingle:apps:rtp:video"),this.caps.addFeature("http://jitsi.org/json-encoded-sources"),!this.options.disableRtx&&h.a.supportsRTX()&&this.caps.addFeature("urn:ietf:rfc:4588"),!0===this.options.enableOpusRed&&h.a.supportsAudioRed()&&this.caps.addFeature("http://jitsi.org/opus-red"),("undefined"===typeof this.options.enableRemb||this.options.enableRemb)&&this.caps.addFeature("http://jitsi.org/remb"),h.a.isFirefox()||"undefined"!==typeof this.options.enableTcc&&!this.options.enableTcc||this.caps.addFeature("http://jitsi.org/tcc"),this.caps.addFeature("urn:ietf:rfc:5761"),this.caps.addFeature("urn:ietf:rfc:5888"),h.a.isChromiumBased()&&!0===this.options.enableLipSync&&(_.info("Lip-sync enabled !"),this.caps.addFeature("http://jitsi.org/meet/lipsync")),this.connection.rayo&&this.caps.addFeature("urn:xmpp:rayo:client:1"),f.a.isSupported(this.options)&&this.caps.addFeature(P,!1,!0)}},{key:"getConnection",value:function(){return this.connection}},{key:"connectionHandler",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,o=window.performance.now(),a=c.Strophe.getStatusString(n).toLowerCase();if(this.connectionTimes[a]=o,_.log("(TIME) Strophe ".concat(a).concat(i?"[".concat(i,"]"):"",":\t"),o),this.eventEmitter.emit(p.a.CONNECTION_STATUS_CHANGED,t,n,i),this._maybeSendDeploymentInfoStat(),n===c.Strophe.Status.CONNECTED||n===c.Strophe.Status.ATTACHED)this._sysMessageHandler&&(this.connection._stropheConn.deleteHandler(this._sysMessageHandler),this._sysMessageHandler=null),this.sendDiscoInfo&&this.connection.jingle.getStunAndTurnCredentials(),_.info("My Jabber ID: ".concat(this.connection.jid)),this._resetState(),this.sendDeploymentInfo=!1,this.sendDiscoInfo&&this.caps.getFeaturesAndIdentities(this.options.hosts.domain).then((function(t){var n=t.features,i=t.identities;n.has(c.Strophe.NS.PING)||_.error("Ping NOT supported by ".concat(e.options.hosts.domain," - please enable ping in your XMPP server config")),e._processDiscoInfoIdentities(i,void 0)})).catch((function(t){var n="Feature discovery error";g.a.callErrorHandler(new Error("".concat(n,": ").concat(t))),_.error(n,t),e._maybeSendDeploymentInfoStat(!0)})),this.sendDiscoInfo=!1,t.password&&(this.authenticatedUser=!0),this.connection&&this.connection.connected&&c.Strophe.getResourceFromJid(this.connection.jid)&&this.eventEmitter.emit(u.CONNECTION_ESTABLISHED,c.Strophe.getResourceFromJid(this.connection.jid));else if(n===c.Strophe.Status.CONNFAIL)"x-strophe-bad-non-anon-jid"===i?this.anonymousConnectionFailed=!0:this.connectionFailed=!0,this.lastErrorMsg=i,"giving-up"===i&&this.eventEmitter.emit(u.CONNECTION_FAILED,l.OTHER_ERROR,i);else if(n===c.Strophe.Status.ERROR)this.lastErrorMsg=i;else if(n===c.Strophe.Status.DISCONNECTED){this.connection.ping.stopInterval();var r=Boolean(this.disconnectInProgress),s=i||this.lastErrorMsg;if(this.anonymousConnectionFailed)this.eventEmitter.emit(u.CONNECTION_FAILED,l.PASSWORD_REQUIRED);else if(this.connectionFailed)this.eventEmitter.emit(u.CONNECTION_FAILED,l.OTHER_ERROR,s,void 0,this._getConnectionFailedReasonDetails());else if(r)this.eventEmitter.emit(u.CONNECTION_DISCONNECTED,s);else{_.error("XMPP connection dropped!");var d=c.Strophe.getLastErrorStatus();d>=500&&d<600?this.eventEmitter.emit(u.CONNECTION_FAILED,l.SERVER_ERROR,s||"server-error",void 0,this._getConnectionFailedReasonDetails()):this.eventEmitter.emit(u.CONNECTION_FAILED,l.CONNECTION_DROPPED_ERROR,s||"connection-dropped-error",void 0,this._getConnectionFailedReasonDetails())}}else if(n===c.Strophe.Status.AUTHFAIL){var h=this.getConnection().getLastFailedMessage();this.eventEmitter.emit(u.CONNECTION_FAILED,l.PASSWORD_REQUIRED,i||this._parseConnectionFailedMessage(h),t)}}},{key:"_processDiscoInfoIdentities",value:function(e,t){var n=this;e.forEach((function(e){if("av_moderation"===e.type&&(n.avModerationComponentAddress=e.name),"speakerstats"===e.type&&(n.speakerStatsComponentAddress=e.name),"conference_duration"===e.type&&(n.conferenceDurationComponentAddress=e.name),"lobbyrooms"===e.type){n.lobbySupported=!0;var i=function(e){e.forEach((function(e){e.endsWith("#displayname_required")&&n.eventEmitter.emit(u.DISPLAY_NAME_REQUIRED)}))};t?i(t):e.name&&n.caps.getFeaturesAndIdentities(e.name,e.type).then((function(e){var t=e.features;return i(t)})).catch((function(e){return _.warn("Error getting features from lobby.",e&&e.message)}))}"shard"===e.type&&(n.options.deploymentInfo.shard=n.connection.shard=e.name),"region"===e.type&&(n.options.deploymentInfo.region=n.connection.region=e.name),"breakout_rooms"===e.type&&(n.breakoutRoomsComponentAddress=e.name)})),this._maybeSendDeploymentInfoStat(!0),(this.avModerationComponentAddress||this.speakerStatsComponentAddress||this.conferenceDurationComponentAddress)&&this.connection.addHandler(this._onPrivateMessage.bind(this),null,"message",null,null)}},{key:"_parseConnectionFailedMessage",value:function(e){if(!e)return null;var t=R.exec(e);return t?t[1]:null}},{key:"_connect",value:function(e,t){this._resetState(),this.sendDiscoInfo=!0,this.sendDeploymentInfo=!0,this.connection._stropheConn&&this.connection._stropheConn._addSysHandler?this._sysMessageHandler=this.connection._stropheConn._addSysHandler(this._onSystemMessage.bind(this),null,"message"):_.warn("Cannot attach strophe system handler, jiconop cannot operate"),this.connection.connect(e,t,this.connectionHandler.bind(this,{jid:e,password:t}))}},{key:"_onSystemMessage",value:function(e){if(0!==$(e).find(">services").length||0!==$(e).find(">query").length){this.sendDiscoInfo=!1;var t=this.connection.jingle.onReceiveStunAndTurnCredentials(e),n=Object(S.b)(e),i=n.features,o=n.identities;this._processDiscoInfoIdentities(o,i),(t||o.size>0||i.size>0)&&(this.connection._stropheConn.deleteHandler(this._sysMessageHandler),this._sysMessageHandler=null)}}},{key:"attach",value:function(e){this._resetState(),this.sendDiscoInfo=!0;var t=this.connectionTimes.attaching=window.performance.now();_.log("(TIME) Strophe Attaching:\t",t),this.connection.attach(e.jid,e.sid,parseInt(e.rid,10)+1,this.connectionHandler.bind(this,{jid:e.jid,password:e.password}))}},{key:"_resetState",value:function(){this.anonymousConnectionFailed=!1,this.connectionFailed=!1,this.lastErrorMsg=void 0,this.disconnectInProgress=void 0}},{key:"connect",value:function(e,t){if(!e){var n=this.options.hosts,i=n.anonymousdomain,o=n.domain,a=i||o,r=window.location;if(i){var s=r&&r.search;(s&&-1!==s.indexOf("login=true")||this.token)&&(a=o)}e=a||r&&r.hostname}return this._connect(e,t)}},{key:"createRoom",value:function(e,t,n){var i=e.domain||t.customDomain,o="".concat(this.getRoomJid(e,i),"/"),a=n?n(this.connection.jid,this.authenticatedUser):A.a.randomHexString(8).toLowerCase();return _.info("JID ".concat(this.connection.jid," using MUC nickname ").concat(a)),o+=a,this.connection.emuc.createRoom(o,null,t)}},{key:"getRoomJid",value:function(e,t){return"".concat(e,"@").concat(t||this.options.hosts.muc.toLowerCase())}},{key:"isRoomCreated",value:function(e,t){return this.connection.emuc.isRoomCreated(this.getRoomJid(e,t))}},{key:"getJid",value:function(){return this.connection.jid}},{key:"getJingleLog",value:function(){var e=this.connection.jingle;return e?e.getLog():{}}},{key:"getXmppLog",value:function(){return(this.connection.logger||{}).log||null}},{key:"dial",value:function(){var e;(e=this.connection.rayo).dial.apply(e,arguments)}},{key:"ping",value:function(e){var t=this;return new Promise((function(n,i){t.connection.ping.ping(t.connection.pingDomain,n,i,e)}))}},{key:"getSessions",value:function(){return this.connection.jingle.sessions}},{key:"disconnect",value:function(e){var t=this;return this.disconnectInProgress?this.disconnectInProgress:this.connection?(this.disconnectInProgress=new Promise((function(e){t.eventEmitter.on(p.a.CONNECTION_STATUS_CHANGED,(function n(i,o){o===c.Strophe.Status.DISCONNECTED&&(e(),t.eventEmitter.removeListener(p.a.CONNECTION_STATUS_CHANGED,n))}))})),this._cleanupXmppConnection(e),this.disconnectInProgress):Promise.resolve()}},{key:"_cleanupXmppConnection",value:function(e){if(!this.connection.isUsingWebSocket&&this.connection.flush(),!this.connection.isUsingWebSocket&&null!==e&&"undefined"!==typeof e){var t=e.type;if(("beforeunload"===t||"unload"===t)&&(this.connection.options.sync=!0,this.connection.sendUnavailableBeacon()))return}this.connection.disconnect(),!0!==this.connection.options.sync&&this.connection.flush()}},{key:"_initStrophePlugins",value:function(){var e={jvb:{iceServers:[]},p2p:{iceServers:[]}},t=this.options.p2p&&this.options.p2p.stunServers||I;Array.isArray(t)&&(_.info("P2P STUN servers: ",t),e.p2p.iceServers=t),this.options.p2p&&this.options.p2p.iceTransportPolicy&&(_.info("P2P ICE transport policy: ",this.options.p2p.iceTransportPolicy),e.p2p.iceTransportPolicy=this.options.p2p.iceTransportPolicy),this.connection.addConnectionPlugin("emuc",new O.a(this)),this.connection.addConnectionPlugin("jingle",new C.a(this,this.eventEmitter,e)),this.connection.addConnectionPlugin("rayo",new T.a)}},{key:"_getConnectionFailedReasonDetails",value:function(){var e={};if(this.options.deploymentInfo&&this.options.deploymentInfo.shard&&this.connection.lastResponseHeaders){var t=this.connection.lastResponseHeaders.trim().split(/[\r\n]+/),n={};t.forEach((function(e){var t=e.split(": "),i=t.shift(),o=t.join(": ");n[i]=o})),e.shard_changed=this.options.deploymentInfo.shard!==n["x-jitsi-shard"]}return e.suspend_time=this.connection.ping.getPingSuspendTime(),e.time_since_last_success=this.connection.getTimeSinceLastSuccess(),e}},{key:"sendDominantSpeakerEvent",value:function(e){if(this.speakerStatsComponentAddress&&e){var t=Object(c.$msg)({to:this.speakerStatsComponentAddress});t.c("speakerstats",{xmlns:"http://jitsi.org/jitmeet",room:e}).up(),this.connection.send(t)}}},{key:"sendFacialExpressionEvent",value:function(e,t){if(this.speakerStatsComponentAddress&&e){var n=Object(c.$msg)({to:this.speakerStatsComponentAddress});n.c("facialExpression",{xmlns:"http://jitsi.org/jitmeet",room:e,expression:t.facialExpression,duration:t.duration}).up(),this.connection.send(n)}}},{key:"tryParseJSONAndVerify",value:function(e){if(!e)return!1;try{var t=JSON.parse(e);if(t&&"object"===typeof t){var n=t[w];if("undefined"!==typeof n)return t;_.debug("parsing valid json but does not have correct structure","topic: ",n)}}catch(i){return _.error("Error parsing json ".concat(e),i),!1}return!1}},{key:"_onPrivateMessage",value:function(e){var t=e.getAttribute("from");if(t!==this.speakerStatsComponentAddress&&t!==this.conferenceDurationComponentAddress&&t!==this.avModerationComponentAddress&&t!==this.breakoutRoomsComponentAddress)return!0;var n=$(e).find(">json-message").text(),i=this.tryParseJSONAndVerify(n);return!i||("speakerstats"===i[w]&&i.users?this.eventEmitter.emit(p.a.SPEAKER_STATS_RECEIVED,i.users):"conference_duration"===i[w]&&i.created_timestamp?this.eventEmitter.emit(p.a.CONFERENCE_TIMESTAMP_RECEIVED,i.created_timestamp):"av_moderation"===i[w]?this.eventEmitter.emit(p.a.AV_MODERATION_RECEIVED,i):"breakout_rooms"===i[w]&&this.eventEmitter.emit(p.a.BREAKOUT_ROOMS_EVENT,i),!0)}},{key:"_maybeSendDeploymentInfoStat",value:function(e){var t=[c.Strophe.Status.ERROR,c.Strophe.Status.CONNFAIL,c.Strophe.Status.AUTHFAIL,c.Strophe.Status.DISCONNECTED,c.Strophe.Status.CONNTIMEOUT];if(e||t.includes(this.connection.status)&&this.sendDeploymentInfo){var n=this.options.deploymentInfo;if(n&&Object.keys(n).length>0){var i={id:"deployment_info"};for(var o in n)n.hasOwnProperty(o)&&(i[o]=n[o]);m.a.sendLog(JSON.stringify(i))}this.sendDeploymentInfo=!1}}}]),n}(b.a)}).call(this,"/index.js")},,function(e,t,n){"use strict";n.r(t),n.d(t,"STATUS_AVAILABLE",(function(){return i})),n.d(t,"STATUS_UNDEFINED",(function(){return o})),n.d(t,"STATUS_BUSY",(function(){return a})),n.d(t,"STATE_ON",(function(){return r})),n.d(t,"STATE_OFF",(function(){return s})),n.d(t,"STATE_PENDING",(function(){return c})),n.d(t,"STATE_RETRYING",(function(){return l})),n.d(t,"STATE_FAILED",(function(){return u})),n.d(t,"ERROR_NO_CONNECTION",(function(){return d})),n.d(t,"ERROR_SESSION_EXISTS",(function(){return p}));var i="available",o="undefined",a="busy",r="on",s="off",c="pending",l="retrying",u="failed",d="error_no_connection",p="error_session_already_exists"},,function(e,t,n){"use strict";n.r(t),n.d(t,"CONNECTION_DISCONNECTED",(function(){return i})),n.d(t,"CONNECTION_ESTABLISHED",(function(){return o})),n.d(t,"CONNECTION_FAILED",(function(){return a})),n.d(t,"WRONG_STATE",(function(){return r})),n.d(t,"DISPLAY_NAME_REQUIRED",(function(){return s}));var i="connection.connectionDisconnected",o="connection.connectionEstablished",a="connection.connectionFailed",r="connection.wrongState",s="connection.display_name_required"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return s}));var i="statistics.audioLevel",o="statistics.before_disposed",a="statistics.byte_sent_stats",r="statistics.connectionstats",s="statistics.long_tasks_stats"},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i,o,a,r=n(23),s=n(8),c=n(10),l=(n(84),n(6)),u=n(24),d=n(13),p=n(2),h=function e(t,n,i,o,a,r,s){Object(l.a)(this,e),this.type="text",this.text=void 0,this.pid=void 0,this.name=void 0,this.avatarUrl=void 0,this.timestamp=void 0,this.colors=void 0,this.text=t,this.pid=n,this.name=i,this.avatarUrl=o,this.colors=a,this.timestamp=r,this.type=s},f=new(i=function(){function e(){Object(l.a)(this,e),Object(r.a)(this,"messages",o,this),Object(r.a)(this,"sendTo",a,this),Object(p.g)(this)}return Object(s.a)(e,[{key:"limitMessages",value:function(){f.messages.length>1e3&&f.messages.splice(0,f.messages.length-1e3)}},{key:"addMessage",value:function(e){this.messages.push(e),this.limitMessages()}},{key:"participantNameChanged",value:function(e,t){var n=d.a.find(e);if(n){var i=new h("",n.id,n.information.name,n.information.avatarSrc,n.getColor(),Date.now(),"log");i.text=Object(u.c)("cmNameChanged",{old:t,new:i.name}),this.addMessage(i)}}},{key:"participantJoined",value:function(e){var t=d.a.find(e);if(t){var n=new h("",t.id,t.information.name,t.information.avatarSrc,t.getColor(),Date.now(),"log");n.text=Object(u.c)("cmJoined",{name:n.name}),this.addMessage(n)}}},{key:"participantLeft",value:function(e){var t=d.a.find(e);if(t){var n=new h("",t.id,t.information.name,t.information.avatarSrc,t.getColor(),Date.now(),"log");n.text=Object(u.c)("cmLeft",{name:n.name}),this.addMessage(n)}}},{key:"calledBy",value:function(e){var t=new h("",e.id,e.information.name,e.information.avatarSrc,e.getColor(),Date.now(),"called");t.text=Object(u.c)("cmCallBy",{name:t.name}),this.addMessage(t)}},{key:"callTo",value:function(e){var t=new h("",e.id,e.information.name,e.information.avatarSrc,e.getColor(),Date.now(),"callTo");t.text=Object(u.c)("cmCallTo",{name:t.name}),this.addMessage(t)}}]),e}(),o=Object(c.a)(i.prototype,"messages",[p.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),a=Object(c.a)(i.prototype,"sendTo",[p.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Object(c.a)(i.prototype,"limitMessages",[p.b],Object.getOwnPropertyDescriptor(i.prototype,"limitMessages"),i.prototype),Object(c.a)(i.prototype,"addMessage",[p.b],Object.getOwnPropertyDescriptor(i.prototype,"addMessage"),i.prototype),i);t.b=f},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a}));var i={DISCONNECTED:"disconnected",CONNECTING:"connecting",CONNECTED:"connected"},o="_contentTrackCarrier",a="_roomInfoPeeper"},,function(e,t,n){"use strict";function i(e,t){return[e[0]+t[0],e[1]+t[1]]}function o(e,t){return[e[0]-t[0],e[1]-t[1]]}function a(e,t){return t.map((function(t){return e*t}))}function r(e,t){return[e*t[0],e*t[1]]}function s(e,t){return[e*t[0],e*t[1],e*t[2]]}function c(e){var t=0;return e.forEach((function(e){return t+=e*e})),Math.sqrt(t)}function l(e){return e*Math.PI/180}function u(e){return 180*e/Math.PI}function d(e,t){var n=l(e.orientation),i=Math.sin(n),o=Math.cos(n),a=[t.position[0]-e.position[0],t.position[1]-e.position[1]],r=[a[1]*i+a[0]*o,a[1]*o-a[0]*i],s=t.orientation-e.orientation;return{position:r,orientation:s<0?s+360:s}}function p(e){var t=l(e.orientation);return{position:[e.position[0],0,-e.position[1]],orientation:[Math.sin(t),0,Math.cos(t)]}}function h(e,t){var n=e*(Math.PI/180),i=Math.cos(n),o=Math.sin(n);return[i*t[0]-o*t[1],o*t[0]+i*t[1]]}function f(e,t){return e[0]*t[0]+e[1]*t[1]}function m(e){return Math.sqrt(e.reduce((function(e,t){return e+t*t}),0))}function v(e){return[e[1],-e[0]]}function g(e,t){if(0===e.orientation)return[e.position[1],e.position[0]+t[0],e.position[1]+t[1],e.position[0]];var n=h(e.orientation,e.position),i=h(e.orientation,[t[0],0]),o=h(e.orientation,[0,t[1]]),a=[n[0],n[0]+i[0],n[0]+o[0],n[0]+i[0]+o[0]],r=[n[1],n[1]+i[1],n[1]+o[1],n[1]+i[1]+o[1]];return a.sort((function(e,t){return e-t})),r.sort((function(e,t){return e-t})),[r[0],a[3],r[3],a[0]]}function b(e,t,n){return n[3]<=e[0]-t&&e[0]+t<=n[1]&&n[0]<=e[1]-t&&e[1]+t<=n[2]}function y(e){return Math.round(100*e)/100}function A(e){return"".concat(y(e.position[0]),",").concat(y(e.position[1]),",").concat(y(e.orientation))}function S(e){return"".concat(e.position[0],",").concat(e.position[1],",").concat(e.show?"t":"")}function E(e){var t=e.split(",");return{position:[Number(t[0]),Number(t[1])],orientation:Number(t[2])}}function O(e){var t=e.split(",");return{position:[Number(t[0]),Number(t[1])],show:!!t[2]}}n.d(t,"a",(function(){return i})),n.d(t,"r",(function(){return o})),n.d(t,"h",(function(){return a})),n.d(t,"i",(function(){return r})),n.d(t,"j",(function(){return s})),n.d(t,"k",(function(){return c})),n.d(t,"m",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"o",(function(){return h})),n.d(t,"c",(function(){return f})),n.d(t,"s",(function(){return m})),n.d(t,"n",(function(){return v})),n.d(t,"d",(function(){return g})),n.d(t,"f",(function(){return b})),n.d(t,"l",(function(){return A})),n.d(t,"g",(function(){return S})),n.d(t,"q",(function(){return E})),n.d(t,"p",(function(){return O}))},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var i,o,a,r,s,c,l,u,p=n(23),h=n(6),f=n(8),m=n(10),v=(n(84),n(51)),g=n(3),b=n(9),y=n(2),A=n(174),S={minScale:.2,maxScale:5},E=.5,O=new(i=function(){function e(){Object(h.a)(this,e),Object(p.a)(this,"matrix",o,this),Object(p.a)(this,"committedMatrix",a,this),Object(p.a)(this,"matrixBeforeZoom",r,this),Object(p.a)(this,"screenSize",s,this),Object(p.a)(this,"left",c,this),Object(p.a)(this,"mouse",l,this),Object(p.a)(this,"mouseOnMap",u,this),this.keyInputUsers=new Set,Object(y.g)(this),this.loadMatrixFromStorage()}return Object(f.a)(e,[{key:"offset",get:function(){return[-(this.left+this.screenSize[0]*E),-this.screenSize[1]*E]}},{key:"offsetFromElement",get:function(){return[-this.screenSize[0]*E,-this.screenSize[1]*E]}},{key:"rotation",get:function(){return Object(g.D)(Object(g.i)(this.committedMatrix))}},{key:"setMatrix",value:function(e){this.matrix=e,this.updateViewpoint(e)}},{key:"updateViewpoint",value:function(e){var t=Object(g.j)(e),n=this.screenSize[0]/t;A.b.local.viewpoint.height=n,A.b.local.updateViewpointCenter(this)}},{key:"setCommittedMatrix",value:function(e){var t=this.toWindow(this.mouseOnMap);this.committedMatrix=e,this.mouseOnMap=this.fromWindow(t),this.saveMatrixToStorage(!1),this.matrixBeforeZoom=void 0,this.updateViewpoint(e)}},{key:"setScreenSize",value:function(e){this.screenSize[0]=e[0],this.screenSize[1]=e[1],this.updateViewpoint(this.committedMatrix)}},{key:"setLeft",value:function(e){this.left=e}},{key:"setMouse",value:function(e){this.mouse=Object(g.a)(e,this.offset),this.mouseOnMap=Object(g.O)(this.matrix.inverse(),this.mouse)}},{key:"focusOn",value:function(e){var t=this.matrix.inverse(),n=Object(g.N)(e.pose.position,[t.e,t.f]),i=(new DOMMatrix).translate(-n[0],-n[1]).preMultiplySelf(this.matrix);this.setMatrix(i),this.setCommittedMatrix(i)}},{key:"zoomTo",value:function(e){var t=this.matrix,n=Array.from(e.size);n[1]+=b.a;var i=[O.screenSize[0]/n[0],O.screenSize[1]/n[1]],o=Math.max(Math.min(i[0],i[1],S.maxScale),S.minScale),a=Object(g.j)(t),r=t.inverse(),s=Object(g.N)(e.pose.position,[r.e,r.f]),c=n[0]/2,l=this.screenSize[1]/o/2-b.a,u=(new DOMMatrix).translate(-s[0]-c,-s[1]-l).preMultiplySelf(t).preMultiplySelf((new DOMMatrix).scale(o/a));console.log("newScale:".concat(o," old").concat(a,"  newMat scaleX=").concat(Object(g.j)(u))),this.setMatrix(u),this.setCommittedMatrix(u),this.matrixBeforeZoom=t,console.log("zoomTo: before: ".concat(this.matrixBeforeZoom))}},{key:"restoreZoom",value:function(){this.matrixBeforeZoom&&(this.setMatrix(this.matrixBeforeZoom),this.setCommittedMatrix(this.matrixBeforeZoom))}},{key:"zoomed",get:function(){return void 0!==this.matrixBeforeZoom}},{key:"centerOnMap",get:function(){return Object(g.O)(this.matrix.inverse(),[0,0])}},{key:"toWindow",value:function(e){return Object(g.N)(Object(g.O)(this.matrix,e),this.offset)}},{key:"fromWindow",value:function(e){return Object(g.O)(this.matrix.inverse(),Object(g.a)(e,this.offset))}},{key:"toElement",value:function(e){return Object(g.N)(Object(g.O)(this.matrix,e),this.offsetFromElement)}},{key:"rotateFromWindow",value:function(e){return Object(g.I)(this.matrix.inverse(),e)}},{key:"rotateToWindow",value:function(e){return Object(g.I)(this.matrix,e)}},{key:"visibleArea",value:function(){var e=this.fromWindow([0,0]),t=this.fromWindow(this.screenSize),n=v.a;return[e[1]-n,t[0]+n,t[1]+n,e[0]-n]}},{key:"saveMatrixToStorage",value:function(e){var t=sessionStorage;e&&(t=localStorage);var n=[this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f];t.setItem("mapMatrix",JSON.stringify(n))}},{key:"loadMatrixFromStorage",value:function(){var e=localStorage;sessionStorage.getItem("mapMatrix")&&(e=sessionStorage);var t=e.getItem("mapMatrix");if(t){var n=JSON.parse(t),i=new DOMMatrix;i.a=n[0],i.b=n[1],i.c=n[2],i.d=n[3],i.e=n[4],i.f=n[5],this.setMatrix(i),this.setCommittedMatrix(i),console.log("loadMatrixFromStorage() loaded.")}}}]),e}(),o=Object(m.a)(i.prototype,"matrix",[y.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new DOMMatrixReadOnly}}),a=Object(m.a)(i.prototype,"committedMatrix",[y.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new DOMMatrixReadOnly}}),r=Object(m.a)(i.prototype,"matrixBeforeZoom",[y.h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=Object(m.a)(i.prototype,"screenSize",[y.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[0,0]}}),Object(m.a)(i.prototype,"offset",[y.d],Object.getOwnPropertyDescriptor(i.prototype,"offset"),i.prototype),Object(m.a)(i.prototype,"offsetFromElement",[y.d],Object.getOwnPropertyDescriptor(i.prototype,"offsetFromElement"),i.prototype),Object(m.a)(i.prototype,"rotation",[y.d],Object.getOwnPropertyDescriptor(i.prototype,"rotation"),i.prototype),c=Object(m.a)(i.prototype,"left",[y.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),l=Object(m.a)(i.prototype,"mouse",[y.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[0,0]}}),u=Object(m.a)(i.prototype,"mouseOnMap",[y.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[0,0]}}),Object(m.a)(i.prototype,"setMatrix",[y.b],Object.getOwnPropertyDescriptor(i.prototype,"setMatrix"),i.prototype),Object(m.a)(i.prototype,"setCommittedMatrix",[y.b],Object.getOwnPropertyDescriptor(i.prototype,"setCommittedMatrix"),i.prototype),Object(m.a)(i.prototype,"setScreenSize",[y.b],Object.getOwnPropertyDescriptor(i.prototype,"setScreenSize"),i.prototype),Object(m.a)(i.prototype,"setLeft",[y.b],Object.getOwnPropertyDescriptor(i.prototype,"setLeft"),i.prototype),Object(m.a)(i.prototype,"setMouse",[y.b],Object.getOwnPropertyDescriptor(i.prototype,"setMouse"),i.prototype),Object(m.a)(i.prototype,"focusOn",[y.b],Object.getOwnPropertyDescriptor(i.prototype,"focusOn"),i.prototype),Object(m.a)(i.prototype,"zoomTo",[y.b],Object.getOwnPropertyDescriptor(i.prototype,"zoomTo"),i.prototype),Object(m.a)(i.prototype,"restoreZoom",[y.b],Object.getOwnPropertyDescriptor(i.prototype,"restoreZoom"),i.prototype),Object(m.a)(i.prototype,"zoomed",[y.d],Object.getOwnPropertyDescriptor(i.prototype,"zoomed"),i.prototype),Object(m.a)(i.prototype,"centerOnMap",[y.d],Object.getOwnPropertyDescriptor(i.prototype,"centerOnMap"),i.prototype),Object(m.a)(i.prototype,"loadMatrixFromStorage",[y.b],Object.getOwnPropertyDescriptor(i.prototype,"loadMatrixFromStorage"),i.prototype),i);d.map=O,t.b=O},function(e,t,n){"use strict";(function(e){var i,o,a=n(198),r=n(22),s=n(373),c=n.n(s),l=Object(r.getLogger)(e);function u(){return"".concat(Math.random().toString(16),"000000000").substr(2,8)}t.a={_storage:a.b,init:function(e){this._storage=e||a.b},get callStatsUserName(){return i||(i=this._storage.getItem("callStatsUserName"))||(i=function(){var e=c.a.generateUsername();return l.log("generated callstats uid",e),e}(),this._storage.setItem("callStatsUserName",i)),i},get machineId(){if(!o){var e=this._storage.getItem("billingId");o=e||this._storage.getItem("jitsiMeetId"),e?this._storage.setItem("jitsiMeetId",e):o||(o=function(){var e=u()+u()+u()+u();return l.log("generated id",e),e}(),this._storage.setItem("jitsiMeetId",o))}return o},get sessionId(){return this._storage.getItem("sessionId")},set sessionId(e){e?this._storage.setItem("sessionId",e):this._storage.removeItem("sessionId")}}}).call(this,"/index.js")},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return d}));var i=n(14),o=n(6),a=n(8),r=n(79);function s(e){return parseInt(e.ssrcs.split(" ")[0],10)}function c(e){return parseInt(e.ssrcs.split(" ")[1],10)}function l(e){return e.ssrcs?e.ssrcs.map((function(e){return e.id})).filter((function(e,t,n){return n.indexOf(e)===t})).length:0}var u=function(){function e(t){if(Object(o.a)(this,e),!t)throw new Error("mLine is undefined");this.mLine=t}return Object(a.a)(e,[{key:"ssrcs",get:function(){return this.mLine.ssrcs||(this.mLine.ssrcs=[]),this.mLine.ssrcs},set:function(e){this.mLine.ssrcs=e}},{key:"direction",get:function(){return this.mLine.direction},set:function(e){this.mLine.direction=e}},{key:"ssrcGroups",get:function(){return this.mLine.ssrcGroups||(this.mLine.ssrcGroups=[]),this.mLine.ssrcGroups},set:function(e){this.mLine.ssrcGroups=e}},{key:"getSSRCAttrValue",value:function(e,t){var n=this.ssrcs.find((function(n){return n.id===e&&n.attribute===t}));return n&&n.value}},{key:"removeSSRC",value:function(e){this.mLine.ssrcs&&this.mLine.ssrcs.length&&(this.mLine.ssrcs=this.mLine.ssrcs.filter((function(t){return t.id!==e})))}},{key:"addSSRCAttribute",value:function(e){this.ssrcs.push(e)}},{key:"findGroup",value:function(e,t){return this.ssrcGroups.find((function(n){return n.semantics===e&&(!t||t===n.ssrcs)}))}},{key:"findGroups",value:function(e){return this.ssrcGroups.filter((function(t){return t.semantics===e}))}},{key:"findGroupByPrimarySSRC",value:function(e,t){return this.ssrcGroups.find((function(n){return n.semantics===e&&s(n)===t}))}},{key:"findSSRCByMSID",value:function(e){return this.ssrcs.find((function(t){return"msid"===t.attribute&&(null===e||t.value===e)}))}},{key:"getSSRCCount",value:function(){return l(this.mLine)}},{key:"containsAnySSRCGroups",value:function(){return void 0!==this.mLine.ssrcGroups}},{key:"getPrimaryVideoSsrc",value:function(){var e=this.mLine.type;if("video"!==e)throw new Error("getPrimarySsrc doesn't work with '".concat(e,"'"));if(1===l(this.mLine))return this.mLine.ssrcs[0].id;if(this.mLine.ssrcGroups){var t=this.findGroup("SIM");if(t)return s(t);var n=this.findGroup("FID");if(n)return s(n);var i=this.findGroup("FEC-FR");if(i)return s(i)}}},{key:"getRtxSSRC",value:function(e){var t=this.findGroupByPrimarySSRC("FID",e);return t&&c(t)}},{key:"getSSRCs",value:function(){return this.ssrcs.map((function(e){return e.id})).filter((function(e,t,n){return n.indexOf(e)===t}))}},{key:"getPrimaryVideoSSRCs",value:function(){var e=this.mLine.type;if("video"!==e)throw new Error("getPrimaryVideoSSRCs doesn't work with ".concat(e));var t,n=this.getSSRCs(),o=Object(i.a)(this.ssrcGroups);try{for(o.s();!(t=o.n()).done;){var a=t.value;if("FID"===a.semantics||"FEC-FR"===a.semantics){var r=c(a);n.splice(n.indexOf(r),1)}}}catch(s){o.e(s)}finally{o.f()}return n}},{key:"dumpSSRCGroups",value:function(){return JSON.stringify(this.mLine.ssrcGroups)}},{key:"removeGroupsWithSSRC",value:function(e){this.mLine.ssrcGroups&&(this.mLine.ssrcGroups=this.mLine.ssrcGroups.filter((function(t){return-1===t.ssrcs.indexOf("".concat(e))})))}},{key:"removeGroupsBySemantics",value:function(e){this.mLine.ssrcGroups&&(this.mLine.ssrcGroups=this.mLine.ssrcGroups.filter((function(t){return t.semantics!==e})))}},{key:"replaceSSRC",value:function(e,t){this.mLine.ssrcs&&this.mLine.ssrcs.forEach((function(n){n.id===e&&(n.id=t)}))}},{key:"addSSRCGroup",value:function(e){this.ssrcGroups.push(e)}}]),e}(),d=function(){function e(t){Object(o.a)(this,e),this.parsedSDP=r.parse(t)}return Object(a.a)(e,[{key:"selectMedia",value:function(e){var t=this.parsedSDP.media.find((function(t){return t.type===e}));return t?new u(t):null}},{key:"toRawSDP",value:function(){return r.write(this.parsedSDP)}}]),e}()},,,,function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return c}));var i=n(6),o=n(8);function a(e){var t=e;return e>=Number.MAX_SAFE_INTEGER&&(t=0),t+1}function r(e){return e.length>0?e.reduce((function(e,t){return e+t}))/e.length:0}function s(e){return e.filter((function(e){return e>=0}))}var c=function(){function e(){Object(i.a)(this,e),this.average=0,this.n=0}return Object(o.a)(e,[{key:"addNext",value:function(e){"number"===typeof e&&(this.n+=1,this.average=this.average+(e-this.average)/this.n)}},{key:"getAverage",value:function(){return this.average}}]),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"LOCAL_STATS_UPDATED",(function(){return i})),n.d(t,"REMOTE_STATS_UPDATED",(function(){return o}));var i="cq.local_stats_updated",o="cq.remote_stats_updated"},function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return A}));var i=n(14),o=n(58),a=n(6),r=n(8),s=n(3),c=n(13),l=n(41),u=n(9),p=n(2),h=n(26),f=function(){function e(t,n,i){Object(a.a)(this,e),this.startTime=0,this.endTime=0,this.media=void 0,this.pid=void 0,this.cid=void 0,this.role=void 0,this.blobs=[],this.onData=function(){},this.role=n,this.pid=null===i||void 0===i?void 0:i.pid,this.cid=null===i||void 0===i?void 0:i.cid,this.media=new MediaRecorder(t),this.media.addEventListener("dataavailable",this.onDataAvailable.bind(this)),this.media.addEventListener("stop",this.onStop.bind(this))}return Object(r.a)(e,[{key:"state",get:function(){return this.media.state}},{key:"start",value:function(){"inactive"===this.media.state?(this.media.start(),this.startTime=Date.now()):console.error("Failed to start. Media for cid:".concat(this.cid," pid:").concat(this.pid)+" is already in ".concat(this.media.state,"."),this)}},{key:"stop",value:function(){"inactive"!==this.media.state&&this.media.stop()}},{key:"onStop",value:function(){this.endTime=Date.now()}},{key:"onDataAvailable",value:function(e){var t=e.data;this.blobs.push(t),this.onData(this)}}]),e}(),m=function e(t,n){Object(a.a)(this,e),this.msg=void 0,this.time=void 0,this.msg=t,this.time=n||Date.now()},v=function(){function e(){Object(a.a)(this,e),this.medias=new Map,this.messages=[],this.recording=!1,this.startTime=0,this.endTime=0,this.MessageTypesToRecord=new Set([h.b.PARTICIPANT_INFO,h.b.PARTICIPANT_POSE,h.b.PARTICIPANT_MOUSE,h.b.PARTICIPANT_AFK,h.b.PARTICIPANT_TRACKSTATES,h.b.PARTICIPANT_VIEWPOINT,h.b.PARTICIPANT_ON_STAGE,h.b.CONTENT_UPDATE_REQUEST,h.b.CONTENT_REMOVE_REQUEST]),this.lastMessageValues=new Map,this.stoppedMedias=[],this.disposers=[]}return Object(r.a)(e,[{key:"recordMessage",value:function(e){this.recording&&this.MessageTypesToRecord.has(e.t)&&(e.t===h.b.PARTICIPANT_MOUSE||e.t===h.b.PARTICIPANT_POSE?this.lastMessageValues.get(e.t)!==e.v&&(this.lastMessageValues.set(e.t,e.v),this.messages.push(new m(e))):this.messages.push(new m(e)))}},{key:"clear",value:function(){this.medias.clear(),this.messages=[],this.stoppedMedias=[],this.startTime=0,this.endTime=0,this.lastMessageValues.clear()}},{key:"start",value:function(e){var t=this;this.clear(),this.recording=!0,this.startTime=Date.now(),this.disposers.push(Object(p.c)((function(){t.updateMediaRecorders()})));var n=Object(l.k)(e.contents.all);this.messages.push({msg:{t:h.b.CONTENT_UPDATE_REQUEST,v:JSON.stringify(n)},time:Date.now()});var i=Array.from(e.participants.remote.values());i.unshift(e.participants.local);for(var o=0,a=i;o<a.length;o++){var r=a[o];this.messages.push({msg:{t:h.b.PARTICIPANT_INFO,p:r.id,v:JSON.stringify(r.information)},time:Date.now()}),this.messages.push({msg:{t:h.b.PARTICIPANT_POSE,p:r.id,v:JSON.stringify(Object(s.C)(r.pose))},time:Date.now()}),this.messages.push({msg:{t:h.b.PARTICIPANT_MOUSE,p:r.id,v:JSON.stringify(Object(s.y)(r.mouse))},time:Date.now()})}}},{key:"stopMediaRecordings",value:function(){var e=this;this.recording=!1;var t=0;return new Promise((function(n,a){var r=function(){++t===s.length&&n(s)},s=e.stoppedMedias;if(s.push.apply(s,Object(o.a)(e.medias.values())),s.length){var c,l=Object(i.a)(s);try{for(l.s();!(c=l.n()).done;){var u=c.value;"inactive"===u.state?r():(u.onData=function(){r()},u.stop())}}catch(d){l.e(d)}finally{l.f()}}else n(s)}))}},{key:"stop",value:function(){var e,t=this,n=Object(i.a)(this.disposers);try{for(n.s();!(e=n.n()).done;){(0,e.value)()}}catch(o){n.e(o)}finally{n.f()}return this.disposers=[],new Promise((function(e){t.stopMediaRecordings().then((function(n){t.endTime=Date.now();var a=[],r=[],s={startTime:t.startTime,endTime:t.endTime,messages:t.messages},c=new Blob([JSON.stringify(s)],{type:"application/json"}),l={role:"message",size:c.size,type:c.type};a.push(c),r.push(l);var u,d=Object(i.a)(n);try{for(d.s();!(u=d.n()).done;){var p=u.value;if(p.blobs.length){var h=new Blob(p.blobs),f={pid:p.pid,cid:p.cid,role:p.role,size:h.size,type:p.blobs[0].type,time:p.startTime,duration:p.endTime-p.startTime};a.push(h),r.push(f)}}}catch(o){d.e(o)}finally{d.f()}a.unshift(new Blob([JSON.stringify(r)],{type:"application/json"}));var m=new Uint32Array(1);m[0]=a[0].size,a.unshift(new Blob([m]));var v=new Blob(a,{type:"application/octet-stream"});e(v)}))}))}},{key:"updateMediaRecorders",value:function(){var e=new Set(this.medias.keys()),t=Array.from(c.a.remote.values());t.push(c.a.local);for(var n=0,o=t;n<o.length;n++){var a=o[n],r="pv_".concat(a.id);if(e.delete(r),a.tracks.avatarStream){if(!this.medias.has(r)){var s=new f(a.tracks.avatarStream,"avatar",{pid:a.id});this.medias.set(r,s),s.start()}}else{var l=this.medias.get(r);l&&(l.stop(),this.stoppedMedias.push(l),this.medias.delete(r))}var d="pa_".concat(a.id);if(a.tracks.audioStream){if(!this.medias.has(d)){var p=new f(a.tracks.audioStream,"mic",{pid:a.id});this.medias.set(d,p),p.start()}}else{var h=this.medias.get(d);h&&(h.stop(),this.stoppedMedias.push(h),this.medias.delete(d))}}var m,v=u.c.tracks.allContentStreams(),g=Object(i.a)(v);try{for(g.s();!(m=g.n()).done;){var b=m.value,y=u.c.find(b.cid);if(!y||"screen"!==y.type&&"camera"!==y.type)console.error("Failed to find content cid=".concat(b.cid,"."));else{var A="c_".concat(y.id);if(e.delete(A),!this.medias.has(A)){var S=new f(b.stream,y.type,{cid:y.id});this.medias.set(A,S),S.start()}}}}catch(T){g.e(T)}finally{g.f()}var E,O=Object(i.a)(e);try{for(O.s();!(E=O.n()).done;){var C=E.value,j=this.medias.get(C);j&&(j.stop(),this.stoppedMedias.push(j),this.medias.delete(C))}}catch(T){O.e(T)}finally{O.f()}}}]),e}(),g=function e(t,n){Object(a.a)(this,e),this.blob=void 0,this.time=void 0,this.duration=void 0,this.cid=void 0,this.pid=void 0,this.role=void 0,this.blob=t,this.time=n.time,this.duration=n.duration,this.cid=n.cid,this.pid=n.pid,this.role=n.role},b=function(){function e(){Object(a.a)(this,e),this.messages=[],this.medias=[],this.startTime=0,this.endTime=0,this.pids=new Set,this.cids=new Set,this.contentMeidas=new Map}return Object(r.a)(e,[{key:"clear",value:function(){this.messages=[],this.medias=[],this.startTime=0,this.endTime=0}},{key:"load",value:function(e){var t=this;return this.clear(),new Promise((function(n){var o=0;e.slice(o,o+4).arrayBuffer().then((function(a){o+=4;var r=new Int32Array(a)[0],s=0;e.slice(o,o+r).text().then((function(a){o+=r;var c,l=JSON.parse(a),u=Object(i.a)(l);try{var d=function(){var i=c.value;"message"===i.role?e.slice(o,o+i.size).text().then((function(e){var i=JSON.parse(e);t.messages=i.messages,t.startTime=i.startTime,t.endTime=i.endTime,++s===l.length&&n(t)})):e.slice(o,o+i.size).arrayBuffer().then((function(e){var o=new Blob([e],{type:i.type});t.medias.push(new g(o,i)),++s===l.length&&n(t)})),o+=i.size};for(u.s();!(c=u.n()).done;)d()}catch(p){u.e(p)}finally{u.f()}e.size!==o&&console.error("archive size ".concat(e.size," not matched to end of blobs ").concat(o,"."))}))}))}))}},{key:"play",value:function(){var e=this,t=Array.from(this.messages),n=Array.from(this.medias);t.sort((function(e,t){return e.time-t.time})),n.sort((function(e,t){return e.time-t.time}));var i=this.startTime,o=Date.now()-this.startTime;!function a(){for(i=Date.now()-o;t.length&&t[0].time<i;){var r=t.shift();A.playMessage(r.msg)}for(var s=function(){var t=n.shift();A.playMedia(t),t.duration&&setTimeout((function(){e.stopMedia(t)}),t.duration)};n.length&&n[0].time<i;)s();i<A.endTime?setTimeout((function(){a()}),30):e.cleanup()}()}},{key:"cleanup",value:function(){this.pids.forEach((function(e){c.a.removePlayback(e)})),this.cids.forEach((function(e){u.c.removePlayback(e)}))}},{key:"stopMedia",value:function(e){if(e.pid&&"avatar"===e.role){var t="p_".concat(e.pid);c.a.getPlayback(t).videoBlob=void 0}}},{key:"playMedia",value:function(e){if(e.pid){var t="p_".concat(e.pid);this.pids.add(t);var n=c.a.getPlayback(t);"mic"===e.role?n.audioBlob=e.blob:"avatar"===e.role&&(n.videoBlob=e.blob)}else if(e.cid){var i="p_".concat(e.cid);if(!this.contentMeidas.has(i)&&(this.contentMeidas.set(i,e),this.cids.has(i))){var o=u.c.findPlayback(i);o&&(o.url=URL.createObjectURL(e.blob),u.c.updatePlayback(Object.assign({},o)))}}}},{key:"playMessage",value:function(e){var t=e.p?"p_".concat(e.p):"";t&&this.pids.add(t);var n=t?c.a.getPlayback(t):void 0,i=!1,o=JSON.parse(e.v);if(n)switch(e.t){case h.b.PARTICIPANT_INFO:n.information=o;break;case h.b.PARTICIPANT_POSE:n.pose=Object(s.M)(o);break;case h.b.PARTICIPANT_MOUSE:n.mouse=Object(s.L)(o);break;case h.b.PARTICIPANT_AFK:n.physics.awayFromKeyboard=o;break;case h.b.PARTICIPANT_TRACKSTATES:Object.assign(n.trackStates,o);break;case h.b.PARTICIPANT_VIEWPOINT:Object.assign(n.viewpoint,o);break;case h.b.PARTICIPANT_ON_STAGE:n.physics.onStage=o;break;default:i=!0}if(i)switch(i=!1,e.t){case h.b.CONTENT_UPDATE_REQUEST:this.onUpdateRequest(e);break;case h.b.CONTENT_REMOVE_REQUEST:this.onRemoveRequest(e);break;default:i=!0}i&&console.warn("Playback did not handle message:",e)}},{key:"onUpdateRequest",value:function(e){var t,n=JSON.parse(e.v),o=Object(i.a)(n);try{for(o.s();!(t=o.n()).done;){var a=t.value;if(a.id="p_".concat(a.id),"camera"===a.type||"screen"===a.type){a.type="camera"===a.type?"playbackCamera":"playbackScreen",a.url="";var r=this.contentMeidas.get(a.id);r&&(a.url=URL.createObjectURL(r.blob)),u.c.updatePlayback(a),this.cids.add(a.id)}else u.c.updatePlayback(a),this.cids.add(a.id)}}catch(s){o.e(s)}finally{o.f()}}},{key:"onRemoveRequest",value:function(e){var t,n=JSON.parse(e.v),o=Object(i.a)(n);try{for(o.s();!(t=o.n()).done;){var a=t.value;u.c.removePlayback("p_".concat(a))}}catch(r){o.e(r)}finally{o.f()}}}]),e}(),y=new v,A=new b;d.recorder=y,d.player=A},,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var i="pending",o="active",a="ended"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i={ACCEPT:"session-accept",CONNECTION_ERROR:"connection-error-encountered",INITIATE:"session-initiate",TERMINATE:"session-terminate",TRANSPORT_INFO:"transport-info",UNAVAILABLE:"unavailable"}},,,,,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return s}));var i=n(74),o=n(53),a=n(21),r=n(22).getLogger(e),s=5,c={obtainStream:null,init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,this.obtainStream=this._createObtainStreamMethod(),this.obtainStream||r.info("Desktop sharing disabled")},_createObtainStreamMethod:function(){return a.a.isNWJS()?function(e,t){window.JitsiMeetNW.obtainDesktopStream(e,(function(e,n){var a;a=e&&"InvalidStateError"===e.name?new i.a(o.SCREENSHARING_USER_CANCELED):new i.a(e,n,["desktop"]),"function"===typeof t&&t(a)}))}:a.a.isElectron()?this.obtainScreenOnElectron:a.a.isReactNative()&&a.a.supportsGetDisplayMedia()?this.obtainScreenFromGetDisplayMediaRN:a.a.supportsGetDisplayMedia()?this.obtainScreenFromGetDisplayMedia:(r.log("Screen sharing not supported on ",a.a.getName()),null)},_getAudioConstraints:function(){var e=this.options.audioQuality;return null===e||void 0===e||!e.stereo||{autoGainControl:!1,channelCount:2,echoCancellation:!1,noiseSuppression:!1}},isSupported:function(){return null!==this.obtainStream},obtainScreenOnElectron:function(e,t){var n=this;if(window.JitsiMeetScreenObtainer&&window.JitsiMeetScreenObtainer.openDesktopPicker){var a=this.options,r=a.desktopSharingFrameRate,c=a.desktopSharingSources;window.JitsiMeetScreenObtainer.openDesktopPicker({desktopSharingSources:c||["screen","window"]},(function(a,c){var l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(a){var u,d,p=!1;if(l){p={};var h=n._getAudioConstraints();"boolean"!==typeof h&&(p={optional:h}),"screen"===c&&(p.mandatory={chromeMediaSource:"desktop"})}var f={audio:p,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:a,minFrameRate:null!==(u=null===r||void 0===r?void 0:r.min)&&void 0!==u?u:s,maxFrameRate:null!==(d=null===r||void 0===r?void 0:r.max)&&void 0!==d?d:s,maxWidth:window.screen.width,maxHeight:window.screen.height}}};navigator.mediaDevices.getUserMedia(f).then((function(t){return e({stream:t,sourceId:a,sourceType:c})}),t)}else t(new i.a(o.SCREENSHARING_USER_CANCELED))}),(function(e){return t(new i.a(o.ELECTRON_DESKTOP_PICKER_ERROR,e))}))}else t(new i.a(o.ELECTRON_DESKTOP_PICKER_NOT_FOUND))},obtainScreenFromGetDisplayMedia:function(e,t){var n;n=navigator.getDisplayMedia?navigator.getDisplayMedia.bind(navigator):navigator.mediaDevices.getDisplayMedia.bind(navigator.mediaDevices);var a=this.options.desktopSharingFrameRate,s="object"!==typeof a||{frameRate:a},c=this._getAudioConstraints();s.frameRate&&delete s.frameRate.min;var l={video:s,audio:c,cursor:"always"};r.info("Using getDisplayMedia for screen sharing",l),n(l).then((function(t){e({stream:t,sourceId:t.id})})).catch((function(e){var n={errorName:e&&e.name,errorMsg:e&&e.message,errorStack:e&&e.stack};r.error("getDisplayMedia error",l,n),n.errorMsg&&-1!==n.errorMsg.indexOf("denied by system")?t(new i.a(o.PERMISSION_DENIED)):t(new i.a(o.SCREENSHARING_USER_CANCELED))}))},obtainScreenFromGetDisplayMediaRN:function(e,t){r.info("Using getDisplayMedia for screen sharing"),navigator.mediaDevices.getDisplayMedia({video:!0}).then((function(t){e({stream:t,sourceId:t.id})})).catch((function(){t(new i.a(o.SCREENSHARING_USER_CANCELED))}))},setDesktopSharingFrameRate:function(e){r.info("Setting the desktop capture rate to ".concat(e)),this.options.desktopSharingFrameRate={min:s,max:e}}};t.b=c}).call(this,"/index.js")},function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d}));var i=n(6),o=n(8),a=n(34),r=n(33),s=n(72),c=n(20);function l(e,t,n){var i=t.substring(0,1);return"".concat(e,"-").concat(i).concat(n)}function u(e){var t=e.indexOf("-")+1;if(t<=0)throw new Error("Invalid source name: ".concat(e));for(var n=e.substr(t,1),i=0,o=Object.values(c);i<o.length;i++){var a=o[i];if(a.substr(0,1)===n)return a}throw new Error("Invalid source name: ".concat(e))}var d=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"getSSRCOwner",value:function(e){throw new Error("not implemented")}},{key:"getPeerMediaInfo",value:function(e,t){throw new Error("not implemented")}},{key:"getPeerSourceInfo",value:function(e,t){throw new Error("not implemented")}},{key:"getTrackSourceName",value:function(e){throw new Error("not implemented")}}]),n}(s.a)},,function(e,t,n){"use strict";var i=n(13);n.d(t,"a",(function(){return i.a}))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var i="signaling.peerMuted",o="signaling.peerVideoType"},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return P}));var i,o=n(5),a=n(14),r=n(6),s=n(8),c=n(21),l=n(43),u=n.n(l),d=n(22).getLogger(e),p="createOffer",h="createAnswer",f="setLocalDescription",m="setRemoteDescription",v="addIceCandidate",g="getUserMedia",b="iceConnectionFailure",y="applicationLog",A="fabricHold",S="fabricResume",E="audioMute",O="audioUnmute",C="videoPause",j="videoResume",T="screenShareStart",k="screenShareStop",_="dominantSpeaker",R="activeDeviceList",I="error",w="event",D="mstWithUserID",P=function(){function e(t,n){Object(r.a)(this,e),this.confID=n.confID,this.tpc=t,this.peerconnection=t.peerconnection,this.remoteUserID=n.remoteUserID||"jitsi",this.hasFabric=!1,e.fabrics.add(this),e.backendInitialized&&(this._addNewFabric(),1===e.fabrics.size&&e._emptyReportQueue(this))}return Object(s.a)(e,[{key:"_addNewFabric",value:function(){d.info("addNewFabric",this.remoteUserID);try{var t={remoteEndpointType:this.tpc.isP2P?e.backend.endpointType.peer:e.backend.endpointType.server},n=e.backend.addNewFabric(this.peerconnection,this.remoteUserID,e.backend.fabricUsage.multiplex,this.confID,t,e._addNewFabricCallback);this.hasFabric=!0;var i="success"===n.status;return i||d.error("callstats fabric not initilized",n.message),i}catch(o){return u.a.callErrorHandler(o),!1}}},{key:"associateStreamWithVideoTag",value:function(t,n,i,o,a){if(e.backend){var r=n?e.userID:i;e.backendInitialized?e.backend.associateMstWithUserID(this.peerconnection,r,this.confID,t,o,a):e.reportsQueue.push({type:D,pc:this.peerconnection,data:{callStatsId:r,containerId:a,ssrc:t,usageLabel:o}})}}},{key:"sendDominantSpeakerEvent",value:function(){e._reportEvent(this,_)}},{key:"sendTerminateEvent",value:function(){e.backendInitialized&&e.backend.sendFabricEvent(this.peerconnection,e.backend.fabricEvent.fabricTerminated,this.confID),e.fabrics.delete(this)}},{key:"sendIceConnectionFailedEvent",value:function(){e._reportError(this,b,null,this.peerconnection)}},{key:"sendCreateOfferFailed",value:function(t){e._reportError(this,p,t,this.peerconnection)}},{key:"sendCreateAnswerFailed",value:function(t){e._reportError(this,h,t,this.peerconnection)}},{key:"sendResumeOrHoldEvent",value:function(t){e._reportEvent(this,t?S:A)}},{key:"sendScreenSharingEvent",value:function(t,n){var i;n&&(i={ssrc:n}),e._reportEvent(this,t?T:k,i)}},{key:"sendSetLocalDescFailed",value:function(t){e._reportError(this,f,t,this.peerconnection)}},{key:"sendSetRemoteDescFailed",value:function(t){e._reportError(this,m,t,this.peerconnection)}},{key:"sendAddIceCandidateFailed",value:function(t){e._reportError(this,v,t,this.peerconnection)}}],[{key:"_addNewFabricCallback",value:function(t,n){e.backend&&"success"!==t&&d.error("Monitoring status: ".concat(t," msg: ").concat(n))}},{key:"_initCallback",value:function(t,n){if(d.log("CallStats Status: err=".concat(t," msg=").concat(n)),"success"===t){e.backendInitialized=!0;var i,o=!1,r=null,s=Object(a.a)(e.fabrics.values());try{for(s.s();!(i=s.n()).done;){var c=i.value;c.hasFabric||(d.debug("addNewFabric - initCallback"),c._addNewFabric()&&(o=!0,r||(r=c)))}}catch(l){s.e(l)}finally{s.f()}o&&e._emptyReportQueue(r)}}},{key:"_emptyReportQueue",value:function(t){var n,i=t.confID,o=t.peerconnection,r=Object(a.a)(e.reportsQueue);try{for(r.s();!(n=r.n()).done;){var s=n.value;if(s.type===I){var c=s.data;e._reportError(t,c.type,c.error,c.pc||o)}else if(s.type===w){var l=s.data;e.backend.sendFabricEvent(s.pc||o,l.event,i,l.eventData)}else if(s.type===D){var u=s.data;e.backend.associateMstWithUserID(s.pc||o,u.callStatsId,i,u.ssrc,u.usageLabel,u.containerId)}}}catch(d){r.e(d)}finally{r.f()}e.reportsQueue.length=0}},{key:"_reportError",value:function(t,n,i,o){var a=i;a||(d.warn("No error is passed!"),a=new Error("Unknown error")),e.backendInitialized&&t?e.backend.reportError(o,t.confID,n,a):e.reportsQueue.push({type:I,data:{error:a,pc:o,type:n}})}},{key:"_reportEvent",value:function(t,n,i){var o=t&&t.peerconnection,a=t&&t.confID;e.backendInitialized&&t?e.backend.sendFabricEvent(o,n,a,i):e.reportsQueue.push({confID:a,pc:o,type:w,data:{event:n,eventData:i}})}},{key:"_traceAndCatchBackendCalls",value:function(e){for(var t=function(){var t=i[n],o=e[t];e[t]=function(){try{for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return o.apply(e,n)}catch(a){u.a.callErrorHandler(a)}}},n=0,i=["associateMstWithUserID","sendFabricEvent","sendUserFeedback"];n<i.length;n++)t();for(var o=function(){var t=r[a],n=e[t];e[t]=function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];d.debug(t,o),n.apply(e,o)}},a=0,r=["associateMstWithUserID","sendFabricEvent","sendUserFeedback"];a<r.length;a++)o();var s=e.reportError;e.reportError=function(t,n,i){for(var o=arguments.length,a=new Array(o>3?o-3:0),r=3;r<o;r++)a[r-3]=arguments[r];i===y?c.a.isReactNative()||console&&console.debug("reportError",t,n,i):d.debug.apply(d,["reportError",t,n,i].concat(a));try{s.call.apply(s,[e,t,n,i].concat(a))}catch(l){i===y?console&&console.error("reportError",l):u.a.callErrorHandler(l)}}}},{key:"fabrics",get:function(){return i||(i=new Set),i}},{key:"initBackend",value:function(t){if(e.backend)throw new Error("CallStats backend has been initialized already!");try{var n=callstats;e.backend=new n,e._traceAndCatchBackendCalls(e.backend),e.userID={aliasName:t.aliasName,userName:t.userName},e.callStatsID=t.callStatsID,e.callStatsSecret=t.callStatsSecret;var i=Object(o.a)({},t.configParams);if(t.applicationName&&(i.applicationVersion="".concat(t.applicationName," (").concat(c.a.getName(),")")),t.confID){var a=t.confID.match(/.*\/(.*)\/.*/);i.siteID=t.siteID||a&&a[1]||"/"}e.backend.initialize(e.callStatsID,e.callStatsSecret,e.userID,e._initCallback,void 0,i);var r=t.getWiFiStatsMethod;return r&&(e.backend.attachWifiStatsHandler(r),r().then((function(e){e&&d.info("Reported wifi addresses:",JSON.parse(e).addresses)})).catch((function(){}))),!0}catch(s){return u.a.callErrorHandler(s),e.backend=null,d.error(s),!1}}},{key:"isBackendInitialized",value:function(){return Boolean(e.backend)}},{key:"sendActiveDeviceListEvent",value:function(t,n){e._reportEvent(n,R,t)}},{key:"sendApplicationLog",value:function(t,n){try{e._reportError(n,y,t,n&&n.peerconnection)}catch(i){console&&"function"===typeof console.error&&console.error("sendApplicationLog failed",i)}}},{key:"sendFeedback",value:function(t,n,i){return new Promise((function(o,a){if(e.backend)e.backend.sendUserFeedback(t,{userID:e.userID,overall:n,comment:i},(function(e,t){"success"===e?o(t):a(t)}));else{var r="Failed to submit feedback to CallStats - no backend";d.error(r),a(r)}}))}},{key:"sendGetUserMediaFailed",value:function(t,n){e._reportError(n,g,t,null)}},{key:"sendMuteEvent",value:function(t,n,i){var o;o="video"===n?t?C:j:t?E:O,e._reportEvent(i,o)}}]),e}();P.backend=null,P.reportsQueue=[],P.backendInitialized=!1,P.callStatsID=null,P.callStatsSecret=null,P.userID=null}).call(this,"/index.js")},,,,function(e,t){function n(e,t){return Math.floor(Math.random()*(t-e+1))+e}function i(e){return e[n(0,e.length-1)]}var o={randomHexDigit:function(){return i("0123456789abcdef")},randomHexString:function(e){for(var t="";e--;)t+=this.randomHexDigit();return t},randomElement:i,randomAlphanumStr:function(e){for(var t="",n=0;n<e;n+=1)t+=i("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ");return t},randomInt:n};e.exports=o},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(8),o=n(34),a=n(33),r=n(6),s=n(72);function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return function e(){Object(r.a)(this,e)}}();return function(e){Object(o.a)(n,e);var t=Object(a.a)(n);function n(){var e;Object(r.a)(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).connection=null,e}return Object(i.a)(n,[{key:"init",value:function(e){this.connection=e}}]),n}(e)}t.b=c();var l=c(s.a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var i,o,a=n(30),r=n(58),s=n(14),c=n(23),l=n(6),u=n(8),p=n(10),h=(n(84),n(5)),f=n(49),m=n(51),v=n(3),g=n(119),b=n(9),y=n(2),A=function(e){};function S(e){return{endpointId:e.getParticipantId(),onStage:!0,pose:{position:[0,0],orientation:0},size:[0,0],offset:100*-m.a,priority:0,muted:!1}}function E(e){return{pose:Object(h.a)({},e.pose),onStage:!1}}var O=(i=function(){function e(){Object(l.a)(this,e),this.local=void 0,this.updateAll=!0,this.updateSet=new Set,this.limits=[-1,-1],this.limitUpdated=!1,this.priorityMapForContent=new Map,this.priorityMaps=[new Map,new Map],this.lastContentVideos=[],this.lastParticipantVideos=[],this.lastAudios=[],Object(c.a)(this,"tracksToAccept",o,this),this.disposers=[],this._enabled=!1,this.local=E(g.a.local),Object(y.g)(this)}return Object(u.a)(e,[{key:"clear",value:function(){this.disable(),this.updateAll=!0,this.updateSet.clear(),this.priorityMaps.forEach((function(e){return e.clear()})),this.priorityMapForContent.clear(),this.tracksToAccept=[[],[]],this.lastContentVideos=[],this.lastParticipantVideos=[],this.lastAudios=[]}},{key:"setLimits",value:function(e){this.limits[0]=e[0],this.limits[1]=e[1],this.limitUpdated=!0}},{key:"onRemoteTrackAdded",value:function(e){this.updateSet.add(e.getParticipantId())}},{key:"enabled",get:function(){return this._enabled}},{key:"enable",value:function(){var e=this;this.updateAll=!0;var t=Object(y.c)((function(){var t=g.a.local;e.local=E(t),e.updateAll=!0})),n=new Map,i=Object(y.c)((function(){var e=new Map(g.a.remote),t=Object(v.f)(e,n);Object(v.f)(n,e).forEach(s),t.forEach(l),n=e})),o=new Map,a=Object(y.c)((function(){var e=new Map(b.c.tracks.remoteContents),t=Object(v.f)(e,o);Object(v.f)(o,e).forEach(c),t.forEach(u),o=e})),r=new Map,s=function(t){var n=r.get(t.id);if(void 0===n)throw new Error("Cannot find disposer for remote participant with id: ".concat(t.id));n(),e.priorityMaps.forEach((function(e){return e.delete(t.id)})),r.delete(t.id),e.updateSet.add(t.id),A("onRemoveParticipant:",t,e.priorityMaps[0])},c=function(t,n){var i=r.get(n);if(void 0===i)throw new Error("Cannot find disposer for remote participant with id: ".concat(n));i(),e.priorityMapForContent.delete(n),e.priorityMaps[1].delete(n),r.delete(n),e.updateSet.add(n),A("onRemoveContent:",n,e.priorityMapForContent)},l=function(t){r.set(t.id,Object(y.c)((function(){if(t.tracks.audio||t.tracks.avatar){t.physics.onStage||g.a.yarnPhones.has(t.id),t.pose.position;e.updateSet.add(t.id)}}))),A("onAddParticipant:",t,e.priorityMaps[0])},u=function(t,n){r.set(n,Object(y.c)((function(){if(t.size){b.c.find(n);e.updateSet.add(t.values().next().value.getParticipantId())}}))),A("onAddContent:",n,e.priorityMapForContent)};this.disposers=[t,i,a],this._enabled=!0}},{key:"disable",value:function(){this.disposers.forEach((function(e){return e()})),this._enabled=!1}},{key:"update",value:function(){this.haveUpdates&&(this.calcPriority(),this.updateAll=!1,this.updateSet.clear(),this.limitUpdated=!1)}},{key:"calcPriority",value:function(){var e,t=this,n=Array.from(g.a.remote.values()),i=this.updateAll?n:n.filter((function(e){return t.updateSet.has(e.id)})),o=Object(s.a)(i);try{var a=function(){var n=e.value;[n.tracks.avatar,n.tracks.audio].forEach((function(e,i){if(e){var o=function(e,t){return{endpointId:e.id,onStage:t.isAudioTrack()&&(e.physics.onStage||g.a.yarnPhones.has(e.id)||e.inLocalsZone),pose:Object(h.a)({},e.pose),size:[0,0],offset:0,priority:0,muted:t.isAudioTrack()?e.muteAudio:e.muteVideo}}(n,e);o.priority=t.calcPriorityValue(t.local,o),t.priorityMaps[i].set(n.id,o)}}))};for(o.s();!(e=o.n()).done;)a()}catch(O){o.e(O)}finally{o.f()}Array.from(b.c.tracks.remoteContents.values()).map((function(e){var t=e.values().next();return t.done?void 0:t.value.getParticipantId()})).filter((function(e){return e&&(!!t.updateAll||t.updateSet.has(e))})).forEach((function(e){var n=b.c.tracks.carrierMap.get(e),i=n?b.c.find(n):void 0;if(i&&!Object(f.i)(i)){var o=Array.from(b.c.tracks.remoteContents.get(i.id)),a=[o.find((function(e){return e.isVideoTrack()})),o.find((function(e){return e.isAudioTrack()}))],r=[];a.forEach((function(e,n){e&&(r[n]=function(e,t){return{endpointId:t.getParticipantId(),onStage:!1,pose:Object(h.a)({},e.pose),size:e.size,offset:10*-m.a,priority:0,muted:!1}}(i,e),r[n].priority=t.calcPriorityValue(t.local,r[n]))})),r[0]&&t.priorityMapForContent.set(i.id,r[0]),r[1]&&t.priorityMaps[1].set(i.id,r[1])}}));var c=Array.from(this.priorityMapForContent.values()).sort((function(e,t){return e.priority-t.priority})),l=this.priorityMaps.map((function(e){return Array.from(e.values()).sort((function(e,t){return e.priority-t.priority}))})),u=b.c.tracks.remoteMainTrack();if(u){if(u[0]){var d=S(u[0]);c.unshift(d)}if(u[1]){var p=S(u[1]);l[1].unshift(p)}}var v=c.filter((function(e){return!e.muted})),y=l[0].filter((function(e){return!e.muted}));v.length>this.limits[0]?(v.splice(this.limits[0]),y.splice(0)):y.splice(this.limits[0]-v.length);var A=l[1],E=l[1].filter((function(e){return e.muted})).length;A.splice(Math.min(this.limits[0]+E,A.length)),this.tracksToAccept=[[].concat(Object(r.a)(v),Object(r.a)(y)),A],this.lastContentVideos=v.map((function(e){return e.endpointId})),this.lastParticipantVideos=y.map((function(e){return e.endpointId})),this.lastAudios=A.map((function(e){return e.endpointId}))}},{key:"calcPriorityValue",value:function(e,t){if(t.onStage)return 0;var n=t.size.map((function(n,i){var o=t.pose.position[i]-e.pose.position[i];return o<0&&(o+=n)>0&&(o=0),o}));return Math.sqrt(n[0]*n[0]+n[1]*n[1])+t.offset}},{key:"haveUpdates",get:function(){return this.updateAll||0!==this.updateSet.size||this.limitUpdated}}]),e}(),o=Object(p.a)(i.prototype,"tracksToAccept",[y.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[[],[]]}}),i),C=n(174),j=n(44),T=n.n(j),k=new O;d.priorityCalculator=k;var _=void 0;Object(y.c)((function(){var e=C.a.state;"connected"===e?(k.enable(),_=window.setInterval(R,1e3)):"disconnected"===e&&(k.disable(),void 0!==_&&clearInterval(_))})),Object(y.c)((function(){var e=g.a.local;k.setLimits([e.remoteVideoLimit,e.remoteAudioLimit])}));var R=function(){var e=void 0;return function(){k.update();var t=[k.lastContentVideos,k.lastParticipantVideos,k.lastAudios];if(!T.a.isEqual(t,e)){var n={audibles:k.lastAudios,visibleContents:k.lastContentVideos,visibleParticipants:k.lastParticipantVideos};a.b.conference.setPerceptibles(n),A("setPerceptibles:",t),e=T.a.cloneDeep(t)}}}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"j",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return h})),n.d(t,"b",(function(){return f}));var i=n(19),o=n(14);function a(e){if(!e)throw new Error("Not a truthy value")}/Chrome/.test(navigator.userAgent),/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor);function r(e,t){var n;if(e.size!==t.size)return!1;var a,r=Object(o.a)(e);try{for(r.s();!(a=r.n()).done;){var s=Object(i.a)(a.value,2),c=s[0],l=s[1];if((n=t.get(c))!==l||void 0===n&&!t.has(c))return!1}}catch(u){r.e(u)}finally{r.f()}return!0}function s(e,t){var n,i=new Map(e),a=Object(o.a)(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;i.delete(r[0])}}catch(s){a.e(s)}finally{a.f()}return i}function c(e,t){var n,i=new Set(e),a=Object(o.a)(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;i.delete(r)}}catch(s){a.e(s)}finally{a.f()}return i}function l(e,t){var n=new Map;return e.forEach((function(e,i){t.has(i)&&n.set(i,e)})),n}function u(e){return function(t){var n,i={},a=Object(o.a)(Object.keys(e));try{for(a.s();!(n=a.n()).done;){var r=n.value;i[r]=t[r]}}catch(s){a.e(s)}finally{a.f()}return i}}function d(){return!!navigator.userAgent.match(/iPhone|Android.+Mobile/)}function p(){return window.parent.screen.width<window.parent.screen.height}function h(e){return e.host===window.location.host&&e.pathname===window.location.pathname}function f(e){var t=new Image;return t.src=e,new Promise((function(n,i){t.onload=function(){n(e)},t.onerror=function(){i("")}}))}},function(e,t,n){"use strict";n.d(t,"c",(function(){return Y})),n.d(t,"b",(function(){return q})),n.d(t,"a",(function(){return X}));var i,o,a,r,s,c,l,u,d,p,h,f,m,v,g,b,y,A,S,E,O,C,j,T,k,_,R,I,w,D,P,M,N,x,L,F=n(25),B=n(34),U=n(33),V=n(23),J=n(6),G=n(8),H=n(10),z=(n(84),n(51)),Q=n(3),K=n(256),W=n(2),Y=(i=W.h.ref,o=W.h.ref,a=function(){function e(){Object(J.a)(this,e),Object(V.a)(this,"audio",r,this),Object(V.a)(this,"avatar",s,this),Object(V.a)(this,"avatarOk",c,this),Object(W.g)(this)}return Object(G.a)(e,[{key:"audioStream",get:function(){var e;return null===(e=this.audio)||void 0===e?void 0:e.getOriginalStream()}},{key:"avatarStream",get:function(){var e;return this.avatarOk?null===(e=this.avatar)||void 0===e?void 0:e.getOriginalStream():void 0}},{key:"onMuteChanged",value:function(e,t){e===this.avatar&&(this.avatarOk=!t)}}]),e}(),r=Object(H.a)(a.prototype,"audio",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),s=Object(H.a)(a.prototype,"avatar",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),c=Object(H.a)(a.prototype,"avatarOk",[W.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!this.avatar||!this.avatar.getTrack().muted}}),Object(H.a)(a.prototype,"audioStream",[W.d],Object.getOwnPropertyDescriptor(a.prototype,"audioStream"),a.prototype),Object(H.a)(a.prototype,"avatarStream",[W.d],Object.getOwnPropertyDescriptor(a.prototype,"avatarStream"),a.prototype),Object(H.a)(a.prototype,"onMuteChanged",[W.b],Object.getOwnPropertyDescriptor(a.prototype,"onMuteChanged"),a.prototype),a),q=(l=function e(){Object(J.a)(this,e),Object(V.a)(this,"micMuted",u,this),Object(V.a)(this,"speakerMuted",d,this),Object(V.a)(this,"headphone",p,this),Object(V.a)(this,"emoticon",h,this),Object(V.a)(this,"pingIcon",f,this),Object(V.a)(this,"pingX",m,this),Object(V.a)(this,"pingY",v,this),Object(V.a)(this,"remoteID",g,this),Object(V.a)(this,"remoteX",b,this),Object(V.a)(this,"remoteY",y,this),Object(W.g)(this)},u=Object(H.a)(l.prototype,"micMuted",[W.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=Object(H.a)(l.prototype,"speakerMuted",[W.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),p=Object(H.a)(l.prototype,"headphone",[W.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),h=Object(H.a)(l.prototype,"emoticon",[W.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),f=Object(H.a)(l.prototype,"pingIcon",[W.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m=Object(H.a)(l.prototype,"pingX",[W.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),v=Object(H.a)(l.prototype,"pingY",[W.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),g=Object(H.a)(l.prototype,"remoteID",[W.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),b=Object(H.a)(l.prototype,"remoteX",[W.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),y=Object(H.a)(l.prototype,"remoteY",[W.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),l),X=(A=W.h.shallow,S=W.h.shallow,E=W.h.shallow,O=W.h.shallow,C=W.h.ref,j=W.b.bound,T=function(e){Object(B.a)(n,e);var t=Object(U.a)(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(J.a)(this,n),e=t.call(this),Object(V.a)(e,"id",k,Object(F.a)(e)),Object(V.a)(e,"physics",_,Object(F.a)(e)),Object(V.a)(e,"viewpoint",R,Object(F.a)(e)),Object(V.a)(e,"mouse",I,Object(F.a)(e)),Object(V.a)(e,"information",w,Object(F.a)(e)),Object(V.a)(e,"muteAudio",D,Object(F.a)(e)),Object(V.a)(e,"muteSpeaker",P,Object(F.a)(e)),Object(V.a)(e,"muteVideo",M,Object(F.a)(e)),Object(V.a)(e,"audioLevel",N,Object(F.a)(e)),Object(V.a)(e,"quality",x,Object(F.a)(e)),Object(V.a)(e,"recording",L,Object(F.a)(e)),Object(W.g)(Object(F.a)(e)),e.information=i?z.b:z.d,e}return Object(G.a)(n,[{key:"setAudioLevel",value:function(e){this.audioLevel=e}},{key:"showAudio",get:function(){return!this.muteAudio}},{key:"showVideo",get:function(){return!this.muteVideo}},{key:"getColor",value:function(){var e=this.information.color;e.length||(e=this.information.name.length?Object(Q.p)(this.information.name):[208,208,224]);var t=this.information.textColor;t.length||(t=Object(Q.m)(e));var n=Object(Q.l)(e);return[Object(Q.F)(e),Object(Q.F)(t),Object(Q.F)(n)]}},{key:"getColorRGB",value:function(){return this.information.color.length?this.information.color:Object(Q.p)(this.information.name)}},{key:"getTextColorRGB",value:function(){var e=this.information.textColor;if(!e.length){var t=this.information.color;t.length||(t=Object(Q.p)(this.information.name)),e=Object(Q.m)(t)}return e}},{key:"setPhysics",value:function(e){Object.assign(this.physics,e)}}]),n}(K.a),k=Object(H.a)(T.prototype,"id",[W.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),_=Object(H.a)(T.prototype,"physics",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return z.c}}),R=Object(H.a)(T.prototype,"viewpoint",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return z.e}}),I=Object(H.a)(T.prototype,"mouse",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{position:[0,0],show:!1}}}),w=Object(H.a)(T.prototype,"information",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=Object(H.a)(T.prototype,"muteAudio",[W.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),P=Object(H.a)(T.prototype,"muteSpeaker",[W.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),M=Object(H.a)(T.prototype,"muteVideo",[W.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),N=Object(H.a)(T.prototype,"audioLevel",[W.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),x=Object(H.a)(T.prototype,"quality",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),Object(H.a)(T.prototype,"setAudioLevel",[W.b],Object.getOwnPropertyDescriptor(T.prototype,"setAudioLevel"),T.prototype),L=Object(H.a)(T.prototype,"recording",[W.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(H.a)(T.prototype,"showAudio",[W.d],Object.getOwnPropertyDescriptor(T.prototype,"showAudio"),T.prototype),Object(H.a)(T.prototype,"showVideo",[W.d],Object.getOwnPropertyDescriptor(T.prototype,"showVideo"),T.prototype),Object(H.a)(T.prototype,"setPhysics",[j],Object.getOwnPropertyDescriptor(T.prototype,"setPhysics"),T.prototype),T)},function(e,t,n){"use strict";n.r(t),n.d(t,"CONNECTION_DROPPED_ERROR",(function(){return i})),n.d(t,"OTHER_ERROR",(function(){return o})),n.d(t,"PASSWORD_REQUIRED",(function(){return a})),n.d(t,"SERVER_ERROR",(function(){return r}));var i="connection.droppedError",o="connection.otherError",a="connection.passwordRequired",r="connection.serverError"},,,,function(e,t,n){"use strict";function i(e){for(var t=0,n=0;n!==e.length;n+=1)t=e.charCodeAt(n)+13*t;var i=t%4096;return[17*(Math.floor(i/256)%16),17*(Math.floor(i/16)%16),17*(Math.floor(i)%16)]}function o(e){return a(e)?[255,255,136]:[0,0,136]}function a(e){return e[0]+e[1]+.2*e[2]<340}function r(e){return[255-e[0],255-e[1],255-e[2]]}function s(e){var t=[Math.floor(e[0]),Math.floor(e[1]),Math.floor(e[2])],n=t[1],i=t[2];return"#".concat("0".concat(t[0].toString(16)).slice(-2)).concat("0".concat(n.toString(16)).slice(-2)).concat("0".concat(i.toString(16)).slice(-2))}function c(e){return function(e){var t=e[0]/17,n=e[1]/17,i=e[2]/17,o=a(e)?"#FF8":"#008";return["#".concat(t.toString(16)).concat(n.toString(16)).concat(i.toString(16)),o,"#".concat((15-t).toString(16)).concat((15-n).toString(16)).concat((15-i).toString(16))]}(i(e))}function l(e,t){return"rgba(".concat(e[0],",").concat(e[1],",").concat(e[2],",").concat(t,")")}n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"f",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"g",(function(){return l}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var i,o,a,r,s,c,l,u,d=n(23),p=n(6),h=n(8),f=n(25),m=n(34),v=n(33),g=n(10),b=(n(84),n(2)),y=n(130),A=(i=b.h.ref,o=function(e){Object(m.a)(n,e);var t=Object(v.a)(n);function n(e){var i;return Object(p.a)(this,n),(i=t.call(this)).information=i.information,i.informationReceived=!1,Object(d.a)(i,"trackStates",a,Object(f.a)(i)),Object(d.a)(i,"called",r,Object(f.a)(i)),Object(d.a)(i,"inLocalsZone",s,Object(f.a)(i)),Object(d.a)(i,"closedZone",c,Object(f.a)(i)),Object(d.a)(i,"videoBlob",l,Object(f.a)(i)),Object(d.a)(i,"audioBlob",u,Object(f.a)(i)),i.lastDistance=0,Object(b.g)(Object(f.a)(i)),i.id=e,i}return Object(h.a)(n,[{key:"call",value:function(){this.called=!0}}]),n}(y.a),a=Object(g.a)(o.prototype,"trackStates",[b.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new y.b}}),r=Object(g.a)(o.prototype,"called",[b.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=Object(g.a)(o.prototype,"inLocalsZone",[b.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=Object(g.a)(o.prototype,"closedZone",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),l=Object(g.a)(o.prototype,"videoBlob",[b.h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=Object(g.a)(o.prototype,"audioBlob",[b.h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(g.a)(o.prototype,"call",[b.b],Object.getOwnPropertyDescriptor(o.prototype,"call"),o.prototype),o)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return v}));var i=n(14),o=n(6),a=n(8),r=n(25),s=n(34),c=n(33),l=n(22),u=n(15),d=(n(509),n(72)),p=n(364),h=n(366),f=n(367),m=Object(l.getLogger)(e),v=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var i,a=e.enableWebsocketResume,s=e.websocketKeepAlive,c=e.websocketKeepAliveUrl,l=e.serviceUrl,d=e.shard,m=e.xmppPing;return Object(o.a)(this,n),(i=t.call(this))._options={enableWebsocketResume:"undefined"===typeof a||a,pingOptions:m,shard:d,websocketKeepAlive:"undefined"===typeof s?6e4:Number(s),websocketKeepAliveUrl:c},i._stropheConn=new u.Strophe.Connection(l),i._usesWebsocket=l.startsWith("ws:")||l.startsWith("wss:"),i._stropheConn.maxRetries=3,i._rawInputTracker=new h.a,i._rawInputTracker.startTracking(Object(r.a)(i),i._stropheConn),i._resumeTask=new p.a(i._stropheConn),i._deferredIQs=[],i.addConnectionPlugin("ping",new f.a({getTimeSinceLastServerResponse:function(){return i.getTimeSinceLastSuccess()},onPingThresholdExceeded:function(){return i._onPingErrorThresholdExceeded()},pingOptions:m})),i._oneSuccessfulConnect=!1,i}return Object(a.a)(n,[{key:"connected",get:function(){var e=this._stropheConn&&this._stropheConn._proto&&this._stropheConn._proto.socket;return(this._status===u.Strophe.Status.CONNECTED||this._status===u.Strophe.Status.ATTACHED)&&(!this.isUsingWebSocket||e&&e.readyState===WebSocket.OPEN)}},{key:"disco",get:function(){return this._stropheConn.disco}},{key:"disconnecting",get:function(){return!0===this._stropheConn.disconnecting}},{key:"domain",get:function(){return this._stropheConn.domain}},{key:"isUsingWebSocket",get:function(){return this._usesWebsocket}},{key:"jid",get:function(){return this._stropheConn.jid}},{key:"lastResponseHeaders",get:function(){return this._stropheConn._proto&&this._stropheConn._proto.lastResponseHeaders}},{key:"logger",get:function(){return this._stropheConn.logger}},{key:"options",get:function(){return this._stropheConn.options}},{key:"pingDomain",get:function(){var e;return(null===(e=this._options.pingOptions)||void 0===e?void 0:e.domain)||this.domain}},{key:"service",get:function(){return this._stropheConn.service}},{key:"shard",set:function(e){this._options.shard=e,this._oneSuccessfulConnect&&this._maybeStartWSKeepAlive()}},{key:"status",get:function(){return this._status}},{key:"addConnectionPlugin",value:function(e,t){this[e]=t,t.init(this)}},{key:"addHandler",value:function(){var e;(e=this._stropheConn).addHandler.apply(e,arguments)}},{key:"attach",value:function(e,t,n,i){for(var o,a=arguments.length,r=new Array(a>4?a-4:0),s=4;s<a;s++)r[s-4]=arguments[s];(o=this._stropheConn).attach.apply(o,[e,t,n,this._stropheConnectionCb.bind(this,i)].concat(r))}},{key:"connect",value:function(e,t,n){for(var i,o=arguments.length,a=new Array(o>3?o-3:0),r=3;r<o;r++)a[r-3]=arguments[r];(i=this._stropheConn).connect.apply(i,[e,t,this._stropheConnectionCb.bind(this,n)].concat(a))}},{key:"_stropheConnectionCb",value:function(e,t){this._status=t;var i,o=!1;t===u.Strophe.Status.CONNECTED||t===u.Strophe.Status.ATTACHED?(this._maybeEnableStreamResume(),this._usesWebsocket&&this._oneSuccessfulConnect&&this._keepAliveAndCheckShard(),this._oneSuccessfulConnect=!0,this._maybeStartWSKeepAlive(),this._processDeferredIQs(),this._resumeTask.cancel(),this.ping.startInterval((null===(i=this._options.pingOptions)||void 0===i?void 0:i.domain)||this.domain)):t===u.Strophe.Status.DISCONNECTED&&(this.ping.stopInterval(),(o=this._tryResumingConnection())||clearTimeout(this._wsKeepAlive));if(!o){for(var a=arguments.length,r=new Array(a>2?a-2:0),s=2;s<a;s++)r[s-2]=arguments[s];e.apply(void 0,[t].concat(r)),this.eventEmitter.emit(n.Events.CONN_STATUS_CHANGED,t)}}},{key:"_clearDeferredIQs",value:function(){var e,t=Object(i.a)(this._deferredIQs);try{for(t.s();!(e=t.n()).done;){e.value.reject(new Error("disconnect"))}}catch(n){t.e(n)}finally{t.f()}this._deferredIQs=[]}},{key:"closeWebsocket",value:function(){this._stropheConn&&this._stropheConn._proto&&(this._stropheConn._proto._closeSocket(),this._stropheConn._proto._onClose(null))}},{key:"disconnect",value:function(){var e;this._resumeTask.cancel(),clearTimeout(this._wsKeepAlive),this._clearDeferredIQs(),(e=this._stropheConn).disconnect.apply(e,arguments)}},{key:"flush",value:function(){var e;(e=this._stropheConn).flush.apply(e,arguments)}},{key:"getTimeSinceLastSuccess",value:function(){return this._rawInputTracker.getTimeSinceLastSuccess()}},{key:"getLastFailedMessage",value:function(){return this._rawInputTracker.getLastFailedMessage()}},{key:"_maybeEnableStreamResume",value:function(){if(this._options.enableWebsocketResume){var e=this._stropheConn.streamManagement;this.isUsingWebSocket?e?e.isSupported()?e.getResumeToken()||(m.info("Enabling XEP-0198 stream management"),e.enable(!0)):m.warn("Stream resume enabled, but XEP-0198 is not supported by the server"):m.warn("Stream resume enabled, but Strophe streamManagement plugin is not installed"):m.warn("Stream resume enabled, but WebSockets are not enabled")}}},{key:"_maybeStartWSKeepAlive",value:function(){var e=this,t=this._options.websocketKeepAlive;if(this._usesWebsocket&&t>0){this._wsKeepAlive||m.info("WebSocket keep alive interval: ".concat(t,"ms")),clearTimeout(this._wsKeepAlive);var n=t+60*Math.random()*1e3;m.debug("Scheduling next WebSocket keep-alive in ".concat(n,"ms")),this._wsKeepAlive=setTimeout((function(){return e._keepAliveAndCheckShard().then((function(){return e._maybeStartWSKeepAlive()}))}),n)}}},{key:"_keepAliveAndCheckShard",value:function(){var e=this,t=this._options,i=t.shard,o=t.websocketKeepAliveUrl,a=o||this.service.replace("wss://","https://").replace("ws://","http://");return fetch(a).then((function(t){if(i){var o=t.headers.get("x-jitsi-shard");o!==i&&(m.error("Detected that shard changed from ".concat(i," to ").concat(o)),e.eventEmitter.emit(n.Events.CONN_SHARD_CHANGED))}})).catch((function(e){m.error("Websocket Keep alive failed for url: ".concat(a),{error:e})}))}},{key:"_processDeferredIQs",value:function(){var e,t=this,n=Object(i.a)(this._deferredIQs);try{var o=function(){var n=e.value;if(n.iq){clearTimeout(n.timeout);var i=Date.now()-n.start;t.sendIQ(n.iq,(function(e){return n.resolve(e)}),(function(e){return n.reject(e)}),i)}};for(n.s();!(e=n.n()).done;)o()}catch(a){n.e(a)}finally{n.f()}this._deferredIQs=[]}},{key:"send",value:function(e){if(!this.connected)throw new Error("Not connected");this._stropheConn.send(e)}},{key:"sendIQ",value:function(e,t,n,i){if(this.connected)return this._stropheConn.sendIQ(e,t,n,i);n("Not connected")}},{key:"sendIQ2",value:function(e,t){var n=this,i=t.timeout;return new Promise((function(t,o){if(n.connected)n.sendIQ(e,(function(e){return t(e)}),(function(e){return o(e)}),i);else{var a={iq:e,resolve:t,reject:o,start:Date.now(),timeout:setTimeout((function(){a.iq=void 0,o(void 0)}),i)};n._deferredIQs.push(a)}}))}},{key:"_onPingErrorThresholdExceeded",value:function(){this.isUsingWebSocket&&(m.warn("Ping error threshold exceeded - killing the WebSocket"),this.closeWebsocket())}},{key:"sendPresence",value:function(e,t,n,i){this.connected?this._stropheConn.sendPresence(e,t,n,i):n("Not connected")}},{key:"sendUnavailableBeacon",value:function(){if(!navigator.sendBeacon||this._stropheConn.disconnecting||!this._stropheConn.connected)return!1;this._stropheConn._changeConnectStatus(u.Strophe.Status.DISCONNECTING),this._stropheConn.disconnecting=!0;var e=this._stropheConn._proto._buildBody().attrs({type:"terminate"}),t=Object(u.$pres)({xmlns:u.Strophe.NS.CLIENT,type:"unavailable"});e.cnode(t.tree());var n=navigator.sendBeacon(-1===this.service.indexOf("https://")?"https:".concat(this.service):this.service,u.Strophe.serialize(e.tree()));return m.info("Successfully send unavailable beacon ".concat(n)),this._stropheConn._proto._abortAllRequests(),this._stropheConn._doDisconnect(),!0}},{key:"_tryResumingConnection",value:function(){var e=this._stropheConn.streamManagement;return!(!e||!e.getResumeToken())&&(this._resumeTask.schedule(),!0)}}],[{key:"Events",get:function(){return{CONN_STATUS_CHANGED:"CONN_STATUS_CHANGED",CONN_SHARD_CHANGED:"CONN_SHARD_CHANGED"}}},{key:"Status",get:function(){return u.Strophe.Status}}]),n}(d.a)}).call(this,"/index.js")},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var i="https://api.callstats.io/static/callstats-ws.min.js",o=5},,,function(e,t,n){"use strict";function i(){"granted"!==Notification.permission&&"denied"!==Notification.permission&&Notification.requestPermission()}function o(e,t){"granted"===Notification.permission&&new Notification(e,t)}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}))},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return b}));var i=n(6),o=n(8),a=n(22),r=n(79),s=n.n(r),c=n(39),l=n.n(c),u=n(20),d=n(45),p=n.n(d),h=n(21),f=Object(a.getLogger)(e),m=25e5,v=1,g=["1"],b=function(){function e(t){var n,o,a;Object(i.a)(this,e),this.pc=t;var r=null===(n=this.pc.options)||void 0===n||null===(o=n.videoQuality)||void 0===o?void 0:o.maxBitratesVideo,s={low:2e5,standard:7e5,high:m};this.videoBitrates=null!==r&&void 0!==r?r:s;var c=null!==(a=this.videoBitrates.VP8)&&void 0!==a?a:this.videoBitrates;this.localStreamEncodingsConfig=[{active:!0,maxBitrate:h.a.isFirefox()?c.high:c.low,rid:"1",scaleResolutionDownBy:h.a.isFirefox()?v:4}]}return Object(o.a)(e,[{key:"_getStreamEncodings",value:function(e){return this.pc.isSimulcastOn()&&e.isVideoTrack()?this.localStreamEncodingsConfig:e.isVideoTrack()?[{active:!0,maxBitrate:this.videoBitrates.high}]:[{active:!0}]}},{key:"ensureCorrectOrderOfSsrcs",value:function(e){var t=s.a.parse(e.sdp);return t.media.forEach((function(e){if(e.type!==u.AUDIO&&e.ssrcGroups&&e.ssrcGroups.length){var t=[],n=new Set;e.ssrcGroups.map((function(e){return e.ssrcs.split(" ").filter(Boolean).forEach((function(e){return n.add(e)}))})),n.forEach((function(n){var i=e.ssrcs.filter((function(e){return e.id.toString()===n}));t=t.concat(i)})),e.ssrcs=t}})),new RTCSessionDescription({type:e.type,sdp:s.a.write(t)})}},{key:"findTransceiver",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=null!==t&&void 0!==t&&t.track&&t.getOriginalStream()?this.pc.peerconnection.getTransceivers().find((function(e){var n,i;return(null===(n=e.sender)||void 0===n||null===(i=n.track)||void 0===i?void 0:i.id)===t.getTrackId()})):this.pc.peerconnection.getTransceivers().find((function(t){var n,i;return(null===(n=t.receiver)||void 0===n||null===(i=n.track)||void 0===i?void 0:i.kind)===e}));return n}},{key:"insertUnifiedPlanSimulcastReceive",value:function(e){if(h.a.usesSdpMungingForSimulcast())return e;var t=s.a.parse(e.sdp),n=t.media.findIndex((function(e){return e.type===u.VIDEO}));if(t.media[n].rids&&(t.media[n].simulcast_03||t.media[n].simulcast))return t.media.forEach((function(e,i){e.type===u.VIDEO&&i!==n&&(t.media[i].rids=void 0,t.media[i].simulcast=void 0,t.media[i].simulcast_03=void 0)})),new RTCSessionDescription({type:e.type,sdp:s.a.write(t)});t.media[n].rids=[{id:"1",direction:"recv"},{id:SIM_LAYER_2_RID,direction:"recv"},{id:SIM_LAYER_3_RID,direction:"recv"}];var i=h.a.isFirefox()&&h.a.isVersionGreaterThan(71)?"recv ".concat(g.join(";")):"recv rid=".concat(g.join(";"));return t.media[n].simulcast_03={value:i},new RTCSessionDescription({type:e.type,sdp:s.a.write(t)})}},{key:"addTrack",value:function(e,t){var n=e.getTrack();if(t){var i={direction:l.a.SENDRECV,streams:[e.getOriginalStream()],sendEncodings:[]};h.a.isFirefox()||(i.sendEncodings=this._getStreamEncodings(e)),this.pc.peerconnection.addTransceiver(n,i)}else this.pc.peerconnection.addTrack(n)}},{key:"calculateEncodingsActiveState",value:function(e,t){var n=this,i=e.getTrack().getSettings().height;return this.localStreamEncodingsConfig.map((function(e){return i/e.scaleResolutionDownBy})).map((function(i,o){var a,r=e.getVideoType()!==p.a.CAMERA||(t>0&&4===(null===(a=n.localStreamEncodingsConfig[o])||void 0===a?void 0:a.scaleResolutionDownBy)||i<=t);return n.pc.isSharingLowFpsScreen()&&n.pc.usesUnifiedPlan()&&!h.a.isWebKitBased()&&n.localStreamEncodingsConfig[o].scaleResolutionDownBy!==v&&(r=!1),r}))}},{key:"calculateEncodingsBitrates",value:function(e){var t,n,i=this,o=e.getVideoType(),a=(null===(t=this.pc.options)||void 0===t||null===(n=t.videoQuality)||void 0===n?void 0:n.desktopBitrate)||5e5,r=e._originalStream&&e._originalStream.id!==e.getStreamId();return this.localStreamEncodingsConfig.map((function(e){return i.pc.isSharingLowFpsScreen()&&!h.a.isWebKitBased()?r?m:a:o===p.a.DESKTOP&&h.a.isChromiumBased()&&!i.pc.usesUnifiedPlan()?void 0:e.maxBitrate}))}},{key:"replaceTrack",value:function(e,t){var n,i,o=null!==(n=null===t||void 0===t?void 0:t.getType())&&void 0!==n?n:null===e||void 0===e?void 0:e.getType(),a=this.findTransceiver(o,e),r=null!==(i=null===t||void 0===t?void 0:t.getTrack())&&void 0!==i?i:null;return a?(f.debug("".concat(this.pc," Replacing ").concat(e," with ").concat(t)),a.sender.replaceTrack(r)):Promise.reject(new Error("replace track failed"))}},{key:"setAudioTransferActive",value:function(e){this.setMediaTransferActive(u.AUDIO,e)}},{key:"setEncodings",value:function(e){var t,n,i=e.getType(),o=this.findTransceiver(i,e),a=null===o||void 0===o||null===(t=o.sender)||void 0===t?void 0:t.getParameters();return null!==a&&void 0!==a&&null!==(n=a.encodings)&&void 0!==n&&n.length?(a.encodings=this._getStreamEncodings(e),o.sender.setParameters(a)):Promise.resolve()}},{key:"setMediaTransferActive",value:function(e,t){var n=this.pc.peerconnection.getTransceivers().filter((function(t){return t.receiver&&t.receiver.track&&t.receiver.track.kind===e})),i=this.pc.getLocalTracks(e);f.info("".concat(this.pc," ").concat(t?"Enabling":"Suspending"," ").concat(e," media transfer.")),n.forEach((function(e,n){t?0===n&&i.length?e.direction=l.a.SENDRECV:e.direction=l.a.RECVONLY:e.direction=l.a.INACTIVE}))}},{key:"setVideoTransferActive",value:function(e){this.setMediaTransferActive(u.VIDEO,e)}},{key:"updateEncodingsResolution",value:function(e){var t=this;if(h.a.isWebKitBased()&&e.encodings&&Array.isArray(e.encodings)){var n;(n=e.encodings).every((function(e){return"undefined"!==typeof e.scaleResolutionDownBy&&e.scaleResolutionDownBy===n[0].scaleResolutionDownBy}))&&e.encodings.forEach((function(e,n){e.scaleResolutionDownBy=t.localStreamEncodingsConfig[n].scaleResolutionDownBy}))}}}]),e}()}).call(this,"/index.js")},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(6),o=n(8),a=function(){function e(){var t=this;Object(i.a)(this,e),this.promise=new Promise((function(e,n){t.resolve=function(){t.clearRejectTimeout(),e.apply(void 0,arguments)},t.reject=function(){t.clearRejectTimeout(),n.apply(void 0,arguments)}})),this.then=this.promise.then.bind(this.promise),this.catch=this.promise.catch.bind(this.promise)}return Object(o.a)(e,[{key:"clearRejectTimeout",value:function(){clearTimeout(this._timeout)}},{key:"setRejectTimeout",value:function(e){var t=this;this._timeout=setTimeout((function(){t.reject(new Error("timeout"))}),e)}}]),e}()},function(e,t){e.exports={ENVIRONMENT:"environment",USER:"user"}},,function(e,t,n){"use strict";n.r(t),n.d(t,"DEVICE_LIST_CHANGED",(function(){return i})),n.d(t,"PERMISSIONS_CHANGED",(function(){return o})),n.d(t,"PERMISSION_PROMPT_IS_SHOWN",(function(){return a})),n.d(t,"SLOW_GET_USER_MEDIA",(function(){return r}));var i="mediaDevices.devicechange",o="rtc.permissions_changed",a="mediaDevices.permissionPromptIsShown",r="mediaDevices.slowGetUserMedia"},,,,function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return A})),n.d(t,"a",(function(){return S}));var i=n(6),o=n(8),a=n(34),r=n(33),s=n(128),c=n(59),l=n(60),u=n(13),d=n(9),p=n(57),h=n(296),f=n.n(h),m=n(61),v=n.n(m),g=n(474),b=n(90),y=function(e){};e.$=f.a,e.jQuery=f.a;var A={useIPv6:!1,disableSimulcast:!0,enableWindowOnErrorHandler:!0,enableAnalyticsLogging:!1,disableThiredPartyRequests:!1,disableAudioLevels:!1,desktopSharingChromeExtId:"mbocklcggfhnbahlnepmldehdhpjfcjp",desktopSharingChromeDisabled:!1,desktopSharingChromeSources:["screen","window"],desktopSharingChromeMinExtVersion:"0.1",desktopSharingFirefoxDisabled:!1,desktopSharingFrameRate:{min:.3,max:30}},S=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(i.a)(this,n);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a)))._jitsiConnection=void 0,e._store=void 0,e.conference=new g.a,e.version="0.0.1",e.state=b.a.DISCONNECTED,e}return Object(o.a)(n,[{key:"Store",set:function(e){this._store=e}},{key:"init",value:function(){var e=this;return Object.assign(A,config.rtc.screenOptions),new Promise((function(t,n){v.a.init(A),v.a.setLogLevel("warn"),e._jitsiConnection=new v.a.JitsiConnection(null,void 0,config),e._jitsiConnection.addEventListener(v.a.events.connection.CONNECTION_ESTABLISHED,(function(){e.onStateChanged(b.a.CONNECTED),t(v.a.events.connection.CONNECTION_ESTABLISHED)})),e._jitsiConnection.addEventListener(v.a.events.connection.CONNECTION_FAILED,(function(){e.onStateChanged(b.a.DISCONNECTED),n(v.a.events.connection.CONNECTION_FAILED)})),e._jitsiConnection.addEventListener(v.a.events.connection.CONNECTION_DISCONNECTED,(function(){e.onStateChanged(b.a.DISCONNECTED)})),e._jitsiConnection.connect(),e.onStateChanged(b.a.CONNECTING)}))}},{key:"joinConference",value:function(e){var t=this;if(!this._jitsiConnection)throw new Error("No connection has been established.");this.conference.init(e,(function(){var n;return null===(n=t._jitsiConnection)||void 0===n?void 0:n.initJitsiConference(e.toLowerCase(),config)}))}},{key:"leaveConference",value:function(){return this.conference.uninit()}},{key:"disconnect",value:function(){var e;return this._jitsiConnection?(y("Disconnection order has been sent."),null===(e=this._jitsiConnection)||void 0===e?void 0:e.disconnect()):Promise.reject("No connection has been established.")}},{key:"reconnect",value:function(){var e=this;l.a.setType("retry"),u.a.leaveAll(),d.c.clearAllRemotes(),s.a.clear(),this.leaveConference().then((function(){console.log("Disconnected but succeed in leaving... strange ... try to join again.")})).catch((function(){var t;console.log("Disconnected and failed to leave... try to join again"),null===(t=e.conference.bmRelaySocket)||void 0===t||t.close()})).finally((function(){null!==c.a.testBot&&window.location.reload()}))}},{key:"onStateChanged",value:function(e){var t=this;this.state!==e&&e===b.a.DISCONNECTED&&setTimeout((function(){t._jitsiConnection.disconnect().finally((function(){setTimeout(t.reconnect.bind(t),1e3)}))}),1e3),this.state=e,this._store&&this._store.changeState(this.state)}}]),n}(p.EventEmitter)}).call(this,n(95))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(222),o=new(n(166).a);o.Store=i.a,d.connection=o},,,,,function(e,t,n){var i=n(506),o={loadScript:function(e,t,n,o,a,r){var s=document,c="script",l=s.createElement(c),u=s.getElementsByTagName(c)[0];if(l.async=t,o){var d=i();if(d){var p=d.src,h=p.substring(0,p.lastIndexOf("/")+1);p&&h&&(e=h+e)}}a&&(l.onload=a),r&&(l.onerror=r),l.src=e,n?u.parentNode.insertBefore(l,u):u.parentNode.appendChild(l)}};e.exports=o},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return b}));var i=n(5),o=n(14),a=n(6),r=n(8),s=n(22),c=n(12),l=n(63),u=n(20),d=n(31),p=n.n(d),h=n(35),f=n(21),m=n(28),v=Object(s.getLogger)(e),g={ACTIVE:"active",INACTIVE:"inactive",INTERRUPTED:"interrupted",RESTORING:"restoring"},b=function(){function e(t,n,i){Object(a.a)(this,e),this.rtc=t,this.conference=n,this.trackTimers={},this.connStatusFromJvb={},this.outOfLastNTimeout="number"===typeof i.outOfLastNTimeout?i.outOfLastNTimeout:500,this.p2pRtcMuteTimeout="number"===typeof i.p2pRtcMuteTimeout?i.p2pRtcMuteTimeout:2500,this.rtcMuteTimeout="number"===typeof i.rtcMuteTimeout?i.rtcMuteTimeout:1e4,this.rtcMutedTimestamp={},v.info("RtcMuteTimeout set to: ".concat(this.rtcMuteTimeout)),this.enteredLastNTimestamp=new Map,this.restoringTimers=new Map,this.connectionStatusMap=new Map}return Object(r.a)(e,[{key:"_getVideoFrozenTimeout",value:function(e){return this.rtc.isInLastN(e)?this.rtcMuteTimeout:this.conference.isP2PActive()?this.p2pRtcMuteTimeout:this.outOfLastNTimeout}},{key:"init",value:function(){this._onEndpointConnStatusChanged=this.onEndpointConnStatusChanged.bind(this),this.rtc.addListener(p.a.ENDPOINT_CONN_STATUS_CHANGED,this._onEndpointConnStatusChanged),this._onP2PStatus=this.refreshConnectionStatusForAll.bind(this),this.conference.on(c.P2P_STATUS,this._onP2PStatus),this._onUserLeft=this.onUserLeft.bind(this),this.conference.on(c.USER_LEFT,this._onUserLeft),f.a.supportsVideoMuteOnConnInterrupted()&&(this._onTrackRtcMuted=this.onTrackRtcMuted.bind(this),this.rtc.addListener(p.a.REMOTE_TRACK_MUTE,this._onTrackRtcMuted),this._onTrackRtcUnmuted=this.onTrackRtcUnmuted.bind(this),this.rtc.addListener(p.a.REMOTE_TRACK_UNMUTE,this._onTrackRtcUnmuted),this._onRemoteTrackAdded=this.onRemoteTrackAdded.bind(this),this.conference.on(c.TRACK_ADDED,this._onRemoteTrackAdded),this._onRemoteTrackRemoved=this.onRemoteTrackRemoved.bind(this),this.conference.on(c.TRACK_REMOVED,this._onRemoteTrackRemoved),this._onSignallingMuteChanged=this.onSignallingMuteChanged.bind(this),this._onTrackVideoTypeChanged=this.onTrackVideoTypeChanged.bind(this)),this._onLastNChanged=this._onLastNChanged.bind(this),this.conference.on(c.LAST_N_ENDPOINTS_CHANGED,this._onLastNChanged),this._onLastNValueChanged=this.refreshConnectionStatusForAll.bind(this),this.rtc.on(p.a.LASTN_VALUE_CHANGED,this._onLastNValueChanged)}},{key:"dispose",value:function(){this.rtc.removeListener(p.a.ENDPOINT_CONN_STATUS_CHANGED,this._onEndpointConnStatusChanged),f.a.supportsVideoMuteOnConnInterrupted()&&(this.rtc.removeListener(p.a.REMOTE_TRACK_MUTE,this._onTrackRtcMuted),this.rtc.removeListener(p.a.REMOTE_TRACK_UNMUTE,this._onTrackRtcUnmuted),this.conference.off(c.TRACK_ADDED,this._onRemoteTrackAdded),this.conference.off(c.TRACK_REMOVED,this._onRemoteTrackRemoved)),this.conference.off(c.LAST_N_ENDPOINTS_CHANGED,this._onLastNChanged),this.rtc.removeListener(p.a.LASTN_VALUE_CHANGED,this._onLastNValueChanged),this.conference.off(c.P2P_STATUS,this._onP2PStatus),this.conference.off(c.USER_LEFT,this._onUserLeft);for(var e=0,t=Object.keys(this.trackTimers);e<t.length;e++){var n=t[e];this.clearTimeout(n),this.clearRtcMutedTimestamp(n)}for(var i in this.connectionStatusMap)this.connectionStatusMap.hasOwnProperty(i)&&this.onUserLeft(i);this.connStatusFromJvb={}}},{key:"onEndpointConnStatusChanged",value:function(e,t){v.debug("Detector RTCEvents.ENDPOINT_CONN_STATUS_CHANGED(".concat(Date.now(),"): ").concat(e,": ").concat(t)),e!==this.conference.myUserId()&&(this.connStatusFromJvb[e]=t,this.figureOutConnectionStatus(e))}},{key:"_changeConnectionStatus",value:function(e,t){if(e.getConnectionStatus()!==t){var n=e.getId();e._setConnectionStatus(t),v.debug("Emit endpoint conn status(".concat(Date.now(),") ").concat(n,": ").concat(t)),m.a.sendLog(JSON.stringify({id:"peer.conn.status",participant:n,status:t})),this.conference.eventEmitter.emit(c.PARTICIPANT_CONN_STATUS_CHANGED,n,t)}}},{key:"clearTimeout",value:function(e){this.trackTimers[e]&&(window.clearTimeout(this.trackTimers[e]),this.trackTimers[e]=null)}},{key:"clearRtcMutedTimestamp",value:function(e){this.rtcMutedTimestamp[e]=null}},{key:"onRemoteTrackAdded",value:function(e){var t=this;e.isLocal()||e.getType()!==u.VIDEO||(v.debug("Detector on remote track added for: ".concat(e.getParticipantId())),e.on(l.TRACK_MUTE_CHANGED,this._onSignallingMuteChanged),e.on(l.TRACK_VIDEOTYPE_CHANGED,(function(n){return t._onTrackVideoTypeChanged(e,n)})))}},{key:"onRemoteTrackRemoved",value:function(e){if(!e.isLocal()&&e.getType()===u.VIDEO){var t=e.getParticipantId();v.debug("Detector on remote track removed: ".concat(t)),e.off(l.TRACK_MUTE_CHANGED,this._onSignallingMuteChanged),this.clearTimeout(t),this.clearRtcMutedTimestamp(t),this.figureOutConnectionStatus(t)}}},{key:"isVideoTrackFrozen",value:function(e){if(!f.a.supportsVideoMuteOnConnInterrupted())return!1;var t=e.getId(),n=e.hasAnyVideoTrackWebRTCMuted(),i=this.rtcMutedTimestamp[t],o=this._getVideoFrozenTimeout(t);return n&&"number"===typeof i&&Date.now()-i>=o}},{key:"refreshConnectionStatusForAll",value:function(){var e,t=this.conference.getParticipants(),n=Object(o.a)(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;this.figureOutConnectionStatus(i.getId())}}catch(a){n.e(a)}finally{n.f()}}},{key:"figureOutConnectionStatus",value:function(t){var n=this.conference.getParticipantById(t);if(n){var o=this.conference.isP2PActive(),a=this._isRestoringTimedout(t),r=0===this.conference.getLastN(),s=n.isVideoMuted()||r,c=this.isVideoTrackFrozen(n),l=this.rtc.isInLastN(t),d=this.connStatusFromJvb[t];"boolean"!==typeof d&&(d=!0);var p=o?e._getNewStateForP2PMode(s,c):e._getNewStateForJvbMode(d,l,a,s,c);p!==g.RESTORING&&this._clearRestoringTimer(t),v.debug("Figure out conn status for ".concat(t,", is video muted: ").concat(s," is active(jvb): ").concat(d," video track frozen: ").concat(c," p2p mode: ").concat(o," is in last N: ").concat(l," currentStatus => newStatus: ").concat(n.getConnectionStatus()," => ").concat(p));var h=this.connectionStatusMap[t]||{};if(!("p2p"in h)||!("connectionStatus"in h)||h.p2p!==o||h.connectionStatus!==p){var f=Date.now();if(this.maybeSendParticipantConnectionStatusEvent(t,f),this.connectionStatusMap[t]=Object(i.a)(Object(i.a)({},h),{},{connectionStatus:p,p2p:o,startedMs:f}),!("videoType"in this.connectionStatusMap[t])){var m=n.getTracksByMediaType(u.VIDEO);Array.isArray(m)&&0!==m.length&&(this.connectionStatusMap[t].videoType=m[0].videoType)}}this._changeConnectionStatus(n,p)}else v.debug("figure out conn status - no participant for: ".concat(t))}},{key:"maybeSendParticipantConnectionStatusEvent",value:function(e,t){var n=this.connectionStatusMap[e];n&&"startedMs"in n&&"videoType"in n&&"connectionStatus"in n&&"p2p"in n&&(n.value=t-n.startedMs,m.a.sendAnalytics(Object(h.J)(n)))}},{key:"_onLastNChanged",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Date.now();v.debug("LastN endpoints changed leaving=".concat(e,", entering=").concat(t," at ").concat(n)),f.a.supportsVideoMuteOnConnInterrupted()||this.refreshConnectionStatusForAll();var i,a=Object(o.a)(e);try{for(a.s();!(i=a.n()).done;){var r=i.value;this.enteredLastNTimestamp.delete(r),this._clearRestoringTimer(r),f.a.supportsVideoMuteOnConnInterrupted()&&this.figureOutConnectionStatus(r)}}catch(u){a.e(u)}finally{a.f()}var s,c=Object(o.a)(t);try{for(c.s();!(s=c.n()).done;){var l=s.value;this.enteredLastNTimestamp.set(l,n),f.a.supportsVideoMuteOnConnInterrupted()&&this.figureOutConnectionStatus(l)}}catch(u){c.e(u)}finally{c.f()}}},{key:"_clearRestoringTimer",value:function(e){var t=this.restoringTimers.get(e);t&&(clearTimeout(t),this.restoringTimers.delete(e))}},{key:"_isRestoringTimedout",value:function(e){var t=this,n=this.enteredLastNTimestamp.get(e);return!!(n&&Date.now()-n>=1e4)||(this.restoringTimers.get(e)||this.restoringTimers.set(e,setTimeout((function(){return t.figureOutConnectionStatus(e)}),1e4)),!1)}},{key:"onUserLeft",value:function(e){this.maybeSendParticipantConnectionStatusEvent(e,Date.now()),delete this.connectionStatusMap[e]}},{key:"onTrackRtcMuted",value:function(e){var t=this,n=e.getParticipantId(),i=this.conference.getParticipantById(n);if(v.debug("Detector track RTC muted: ".concat(n),Date.now()),i){if(this.rtcMutedTimestamp[n]=Date.now(),!i.isVideoMuted()){this.clearTimeout(n);var o=this._getVideoFrozenTimeout(n);this.trackTimers[n]=window.setTimeout((function(){v.debug("Set RTC mute timeout for: ".concat(n,"                     of ").concat(o," ms")),t.clearTimeout(n),t.figureOutConnectionStatus(n)}),o)}}else v.error("No participant for id: ".concat(n))}},{key:"onTrackRtcUnmuted",value:function(e){var t=e.getParticipantId();v.debug("Detector track RTC unmuted: ".concat(t),Date.now()),this.clearTimeout(t),this.clearRtcMutedTimestamp(t),this.figureOutConnectionStatus(t)}},{key:"onSignallingMuteChanged",value:function(e){var t=e.getParticipantId();v.debug("Detector on track signalling mute changed: ".concat(t),e.isMuted()),this.figureOutConnectionStatus(t)}},{key:"onTrackVideoTypeChanged",value:function(e,t){var n=e.getParticipantId(),o=Date.now();this.maybeSendParticipantConnectionStatusEvent(n,o),this.connectionStatusMap[n]=Object(i.a)(Object(i.a)({},this.connectionStatusMap[n]||{}),{},{videoType:t,startedMs:o})}}],[{key:"_getNewStateForJvbMode",value:function(e,t,n,i,o){return e?i?g.ACTIVE:f.a.supportsVideoMuteOnConnInterrupted()?o?t?n?g.INTERRUPTED:g.RESTORING:g.INACTIVE:g.ACTIVE:t?g.ACTIVE:g.INACTIVE:g.INTERRUPTED}},{key:"_getNewStateForP2PMode",value:function(e,t){return f.a.supportsVideoMuteOnConnInterrupted()?e||!t?g.ACTIVE:g.INTERRUPTED:g.ACTIVE}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";var i=n(222);n.d(t,"a",(function(){return i.a}));var o=n(13);n.d(t,"b",(function(){return o.a}))},function(e,t,n){"use strict";var i,o,a,r,s,c,l,u,d=n(23),p=n(6),h=n(8),f=n(10),m=(n(84),n(2)),v=(i=function(){function e(){Object(p.a)(this,e),this.defaultBackgroundFill=[255,255,255],this.defaultBackgroundColor=[255,255,255],Object(d.a)(this,"roomProps",o,this),Object(d.a)(this,"password",a,this),Object(d.a)(this,"newPassword",r,this),Object(d.a)(this,"passMatched",s,this),Object(d.a)(this,"backgroundFill",c,this),Object(d.a)(this,"backgroundColor",l,this),Object(d.a)(this,"roomDetails",u,this),Object(m.g)(this)}return Object(h.a)(e,[{key:"onUpdateProp",value:function(e,t){switch(void 0===t?this.roomProps.delete(e):this.roomProps.set(e,t),e){case"backgroundFill":this.backgroundFill=t?JSON.parse(t):this.defaultBackgroundFill;break;case"backgroundColor":this.backgroundColor=t?JSON.parse(t):this.defaultBackgroundColor;break;case"roomDetails":this.roomDetails=t?JSON.parse(t):this.roomDetails}}}]),e}(),o=Object(f.a)(i.prototype,"roomProps",[m.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),a=Object(f.a)(i.prototype,"password",[m.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),r=Object(f.a)(i.prototype,"newPassword",[m.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),s=Object(f.a)(i.prototype,"passMatched",[m.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=Object(f.a)(i.prototype,"backgroundFill",[m.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.defaultBackgroundFill}}),l=Object(f.a)(i.prototype,"backgroundColor",[m.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.defaultBackgroundColor}}),u=Object(f.a)(i.prototype,"roomDetails",[m.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return JSON.stringify({name:"",image:"",desc:""})}}),Object(f.a)(i.prototype,"onUpdateProp",[m.b],Object.getOwnPropertyDescriptor(i.prototype,"onUpdateProp"),i.prototype),i);t.a=new v},,,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var i=n(6),o=n(8),a=n(34),r=n(33),s=n(22),c=n(72),l="NETWORK_INFO_CHANGED",u=Object(s.getLogger)(e),d=new(function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.call(this))._current={isOnline:!0},e}return Object(o.a)(n,[{key:"updateNetworkInfo",value:function(e){var t=e.isOnline;u.debug("updateNetworkInfo",{isOnline:t}),this._current={isOnline:!0===t},this.eventEmitter.emit(l,this._current)}},{key:"isOnline",value:function(){return!0===this._current.isOnline}}]),n}(c.a));t.b=d}).call(this,"/index.js")},function(e,t){e.exports={CAMERA:"camera",DESKTOP:"desktop",DESKTOP_HIGH_FPS:"desktop_high_fps",NONE:"none"}},function(e,t,n){"use strict";t.a={getFocusRecordingUpdate:function(e){var t=e&&e.getElementsByTagName("jibri-recording-status")[0];if(t)return{error:t.getAttribute("failure_reason"),initiator:t.getAttribute("initiator"),recordingMode:t.getAttribute("recording_mode"),sessionID:t.getAttribute("session_id"),status:t.getAttribute("status")}},getHiddenDomainUpdate:function(e){var t=e.getElementsByTagName("live-stream-view-url")[0],n=t&&t.textContent,i=e.getElementsByTagName("mode")[0],o=i&&i.textContent&&i.textContent.toLowerCase(),a=e.getElementsByTagName("session_id")[0];return{liveStreamViewURL:n,mode:o,sessionID:a&&a.textContent}},getSessionIdFromIq:function(e){var t=e&&e.getElementsByTagName("jibri")[0];return t&&t.getAttribute("session_id")},getSessionId:function(e){var t=e.getElementsByTagName("session_id")[0];return t&&t.textContent},isFromFocus:function(e){return e.getAttribute("from").includes("focus")}}},,,,,,,,,,,,function(e,t,n){"use strict";function i(e){return new Promise((function(t,n){var i=new FormData;i.append("access_token","e9889a51fca19f2712ec046016b7ec0808953103e32cd327b91f11bfddaa8533"),i.append("imagedata",e),fetch("https://upload.gyazo.com/api/upload",{method:"POST",body:i}).then((function(e){return e.json()})).then((function(e){t(e.url)})).catch((function(e){"TypeError: Failed to fetch"==="".concat(e)?n("type"):(console.error(e),n(""))}))}))}function o(e){return new Promise((function(t,n){var i=new Image;i.src=e,i.onload=function(){var e=[i.width,i.height];t(e)},i.onerror=function(){n([0,0])}}))}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}))},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return D}));var i=n(55),o=n(38),a=n.n(o),r=n(14),s=n(65),c=n(6),l=n(8),u=n(25),d=n(34),p=n(33),h=n(22),f=n(202),m=n.n(f),v=n(109),g=n.n(v),b=n(304),y=n(12),A=n(159),S=n(72),E=n(78),O=Object(h.getLogger)(e),C="olm",j="error",T="key-info",k="key-info-ack",_="session-ack",R="session-init",I=Symbol("OlmData"),w={OLM_ID_KEY_READY:"olm.id_key_ready",PARTICIPANT_E2EE_CHANNEL_READY:"olm.participant_e2ee_channel_ready",PARTICIPANT_KEY_UPDATED:"olm.partitipant_key_updated"},D=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var i;return Object(c.a)(this,n),(i=t.call(this))._conf=e,i._init=new A.a,i._key=void 0,i._keyIndex=-1,i._reqs=new Map,i._sessionInitialization=void 0,n.isSupported()?(i._bootstrapOlm(),i._conf.on(y.ENDPOINT_MESSAGE_RECEIVED,i._onEndpointMessageReceived.bind(Object(u.a)(i))),i._conf.on(y.CONFERENCE_LEFT,i._onConferenceLeft.bind(Object(u.a)(i))),i._conf.on(y.USER_LEFT,i._onParticipantLeft.bind(Object(u.a)(i))),i._conf.on(y.PARTICIPANT_PROPERTY_CHANGED,i._onParticipantPropertyChanged.bind(Object(u.a)(i)))):i._init.reject(new Error("Olm not supported")),i}return Object(l.a)(n,[{key:"initSessions",value:function(){var e=Object(s.a)(a.a.mark((function e(){var t,n,i,o,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._sessionInitialization){e.next=4;break}throw new Error("OlmAdapter initSessions called multiple times");case 4:return this._sessionInitialization=new A.a,e.next=7,this._init;case 7:t=[],n=this._conf.myUserId(),i=Object(r.a)(this._conf.getParticipants());try{for(i.s();!(o=i.n()).done;)(s=o.value).hasFeature(E.b)&&n<s.getId()&&t.push(this._sendSessionInit(s))}catch(a){i.e(a)}finally{i.f()}return e.next=13,Promise.allSettled(t);case 13:this._sessionInitialization.resolve(),this._sessionInitialization=void 0;case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateKey",value:function(){var e=Object(s.a)(a.a.mark((function e(t){var n,o,s,c,l=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._key=t,this._keyIndex++,n=[],o=Object(r.a)(this._conf.getParticipants()),e.prev=4,c=function(){var e,t=s.value,o=t.getId(),a=l._getParticipantOlmData(t);if(!a.session)return O.warn("Tried to send key to participant ".concat(o," but we have no session")),"continue";var r=Object(b.a)(),c=(e={},Object(i.a)(e,E.d,C),Object(i.a)(e,"olm",{type:T,data:{ciphertext:l._encryptKeyInfo(a.session),uuid:r}}),e),u=new A.a;u.setRejectTimeout(5e3),u.catch((function(){l._reqs.delete(r)})),l._reqs.set(r,u),n.push(u),l._sendMessage(c,o)},o.s();case 7:if((s=o.n()).done){e.next=13;break}if("continue"!==c()){e.next=11;break}return e.abrupt("continue",11);case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),o.e(e.t0);case 18:return e.prev=18,o.f(),e.finish(18);case 21:return e.next=23,Promise.allSettled(n);case 23:return e.abrupt("return",this._keyIndex);case 24:case"end":return e.stop()}}),e,this,[[4,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"updateCurrentKey",value:function(e){return this._key=e,this._keyIndex}},{key:"clearParticipantSession",value:function(e){var t=this._getParticipantOlmData(e);t.session&&(t.session.free(),t.session=void 0)}},{key:"clearAllParticipantsSessions",value:function(){var e,t=Object(r.a)(this._conf.getParticipants());try{for(t.s();!(e=t.n()).done;){var n=e.value;this.clearParticipantSession(n)}}catch(i){t.e(i)}finally{t.f()}}},{key:"_bootstrapOlm",value:function(){var e=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O.debug("Initializing Olm..."),e.prev=1,e.next=4,Olm.init();case 4:this._olmAccount=new Olm.Account,this._olmAccount.create(),t=JSON.parse(this._olmAccount.identity_keys()),this._idKey=t.curve25519,O.debug("Olm ".concat(Olm.get_library_version().join(".")," initialized")),this._init.resolve(),this._onIdKeyReady(this._idKey),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),O.error("Failed to initialize Olm",e.t0),this._init.reject(e.t0);case 17:case"end":return e.stop()}}),e,this,[[1,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"_onIdKeyReady",value:function(e){O.debug("Olm id key ready: ".concat(e)),this._conf.setLocalParticipantProperty("e2ee.idKey",e)}},{key:"_onParticipantE2EEChannelReady",value:function(e){O.debug("E2EE channel with participant ".concat(e," is ready"))}},{key:"_encryptKeyInfo",value:function(e){var t={};return void 0!==this._key&&(t.key=!!this._key&&m.a.fromByteArray(this._key),t.keyIndex=this._keyIndex),e.encrypt(JSON.stringify(t))}},{key:"_getParticipantOlmData",value:function(e){return e[I]=e[I]||{},e[I]}},{key:"_onConferenceLeft",value:function(){var e=Object(s.a)(a.a.mark((function e(){var t,n,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O.debug("Conference left"),e.next=3,this._init;case 3:t=Object(r.a)(this._conf.getParticipants());try{for(t.s();!(n=t.n()).done;)i=n.value,this._onParticipantLeft(i.getId(),i)}catch(o){t.e(o)}finally{t.f()}this._olmAccount&&(this._olmAccount.free(),this._olmAccount=void 0);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_onEndpointMessageReceived",value:function(){var e=Object(s.a)(a.a.mark((function e(t,n){var o,r,s,c,l,u,d,p,h,f,v,b,y,A,S,I,D,M,N,x,L,F,B,U,V,J;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n[E.d]===C){e.next=2;break}return e.abrupt("return");case 2:if(n.olm){e.next=5;break}return O.warn("Incorrectly formatted message"),e.abrupt("return");case 5:return e.next=7,this._init;case 7:o=n.olm,r=t.getId(),s=this._getParticipantOlmData(t),e.t0=o.type,e.next=e.t0===R?13:e.t0===_?15:e.t0===j?17:e.t0===T?19:e.t0===k?21:23;break;case 13:return s.session?(O.warn("Participant ".concat(r," already has a session")),this._sendError(t,"Session already established")):((l=new Olm.Session).create_outbound(this._olmAccount,o.data.idKey,o.data.otKey),s.session=l,c={},Object(i.a)(c,E.d,C),Object(i.a)(c,"olm",{type:_,data:{ciphertext:this._encryptKeyInfo(l),uuid:o.data.uuid}}),u=c,this._sendMessage(u,r),this._onParticipantE2EEChannelReady(r)),e.abrupt("break",23);case 15:return s.session?(O.warn("Participant ".concat(r," already has a session")),this._sendError(t,"No session found")):o.data.uuid===s.pendingSessionUuid?(d=o.data.ciphertext,p=this._reqs.get(o.data.uuid),(h=new Olm.Session).create_inbound(this._olmAccount,d.body),this._olmAccount.remove_one_time_keys(h),f=h.decrypt(d.type,d.body),s.session=h,s.pendingSessionUuid=void 0,this._onParticipantE2EEChannelReady(r),this._reqs.delete(o.data.uuid),p.resolve(),(v=P(f)).key&&(b=m.a.toByteArray(v.key),y=v.keyIndex,s.lastKey=b,this.eventEmitter.emit(w.PARTICIPANT_KEY_UPDATED,r,b,y))):(O.warn("Received ACK with the wrong UUID"),this._sendError(t,"Invalid UUID")),e.abrupt("break",23);case 17:return O.error(o.data.error),e.abrupt("break",23);case 19:return s.session?(A=o.data.ciphertext,S=s.session.decrypt(A.type,A.body),void 0!==(I=P(S)).key&&void 0!==I.keyIndex&&(M=!!I.key&&m.a.toByteArray(I.key),N=I.keyIndex,g()(s.lastKey,M)||(s.lastKey=M,this.eventEmitter.emit(w.PARTICIPANT_KEY_UPDATED,r,M,N)),D={},Object(i.a)(D,E.d,C),Object(i.a)(D,"olm",{type:k,data:{ciphertext:this._encryptKeyInfo(s.session),uuid:o.data.uuid}}),x=D,this._sendMessage(x,r))):(O.debug("Received key info message from ".concat(r," but we have no session for them!")),this._sendError(t,"No session found while processing key-info")),e.abrupt("break",23);case 21:return s.session?(L=o.data.ciphertext,F=s.session.decrypt(L.type,L.body),void 0!==(B=P(F)).key&&void 0!==B.keyIndex&&(U=!!B.key&&m.a.toByteArray(B.key),V=B.keyIndex,g()(s.lastKey,U)||(s.lastKey=U,this.eventEmitter.emit(w.PARTICIPANT_KEY_UPDATED,r,U,V))),J=this._reqs.get(o.data.uuid),this._reqs.delete(o.data.uuid),J.resolve()):(O.debug("Received key info ack message from ".concat(r," but we have no session for them!")),this._sendError(t,"No session found while processing key-info-ack")),e.abrupt("break",23);case 23:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_onParticipantLeft",value:function(e,t){O.debug("Participant ".concat(e," left")),this.clearParticipantSession(t)}},{key:"_onParticipantPropertyChanged",value:function(){var e=Object(s.a)(a.a.mark((function e(t,n,o,r){var s,c,l,u,d,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n,e.next="e2ee.enabled"===e.t0?3:20;break;case 3:if(!r||!this._conf.isE2EEEnabled()){e.next=19;break}return s=this._conf.myUserId(),c=t.getId(),e.next=8,t.getFeatures();case 8:if(!(e.sent.has(E.b)&&s<c)){e.next=19;break}if(!this._sessionInitialization){e.next=13;break}return e.next=13,this._sessionInitialization;case 13:return e.next=15,this._sendSessionInit(t);case 15:u=this._getParticipantOlmData(t),d=Object(b.a)(),l={},Object(i.a)(l,E.d,C),Object(i.a)(l,"olm",{type:T,data:{ciphertext:this._encryptKeyInfo(u.session),uuid:d}}),p=l,this._sendMessage(p,c);case 19:return e.abrupt("break",20);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,i,o){return e.apply(this,arguments)}}()},{key:"_sendError",value:function(e,t){var n,o=e.getId(),a=(n={},Object(i.a)(n,E.d,C),Object(i.a)(n,"olm",{type:j,data:{error:t}}),n);this._sendMessage(a,o)}},{key:"_sendMessage",value:function(e,t){this._conf.sendMessage(e,t)}},{key:"_sendSessionInit",value:function(e){var t,n=this,o=e.getId(),a=this._getParticipantOlmData(e);if(a.session)return O.warn("Tried to send session-init to ".concat(o," but we already have a session")),Promise.reject();if(void 0!==a.pendingSessionUuid)return O.warn("Tried to send session-init to ".concat(o," but we already have a pending session")),Promise.reject();this._olmAccount.generate_one_time_keys(1);var r=JSON.parse(this._olmAccount.one_time_keys()),s=Object.values(r.curve25519)[0];if(!s)return Promise.reject(new Error("No one-time-keys generated"));this._olmAccount.mark_keys_as_published();var c=Object(b.a)(),l=(t={},Object(i.a)(t,E.d,C),Object(i.a)(t,"olm",{type:R,data:{idKey:this._idKey,otKey:s,uuid:c}}),t),u=new A.a;return u.setRejectTimeout(5e3),u.catch((function(){n._reqs.delete(c),a.pendingSessionUuid=void 0})),this._reqs.set(c,u),this._sendMessage(l,o),a.pendingSessionUuid=c,u}}],[{key:"isSupported",value:function(){return"undefined"!==typeof window.Olm}}]),n}(S.a);function P(e){try{return JSON.parse(e)}catch(t){return{}}}D.events=w}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return M}));var i=n(14),o=n(6),a=n(8),r=n(25),s=n(34),c=n(33),l=n(22),u=n(15),d=n(68),p=n(39),h=n.n(p),f=n(35),m=n(11),v=n.n(m),g=n(116),b=n(73),y=n(67),A=n(203),S=n(32),E=n(28),O=n(376),C=n(43),j=n.n(C),T=n(378),k=n(21),_=n(379),R=n(110),I=n(230),w=n(137),D=Object(l.getLogger)(e),P=1e4;var M=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e,i,a,s,c,l,u,d){var p;return Object(o.a)(this,n),(p=t.call(this,e,i,a,s,c,l,d))._bridgeSessionId=null,p._cachedOldLocalSdp=void 0,p._cachedNewLocalSdp=void 0,p._iceCheckingStartedTimestamp=null,p._gatheringStartedTimestamp=null,p.localRecvMaxFrameHeight=void 0,p._localVideoActive=!0,p._remoteVideoActive=!0,p._gatheringReported=!1,p.lasticecandidate=!1,p.closed=!1,p.isP2P=u,p.remoteRecvMaxFrameHeight=void 0,p.modificationQueue=new O.a,p.wasConnected=!1,p.establishmentDuration=void 0,p._xmppListeners=[],p._xmppListeners.push(s.addEventListener(w.a.Events.CONN_STATUS_CHANGED,p.onXmppStatusChanged.bind(Object(r.a)(p)))),p._removeSenderVideoConstraintsChangeListener=void 0,p}return Object(a.a)(n,[{key:"_assertNotEnded",value:function(){return this.state!==R.b}},{key:"doInitialize",value:function(e){var t,n,i,o=this;this.failICE=Boolean(e.failICE),this.lasticecandidate=!1,this.options=e,this.isReconnect=!1,this.wasstable=!1,this.webrtcIceUdpDisable=Boolean(e.webrtcIceUdpDisable),this.webrtcIceTcpDisable=Boolean(e.webrtcIceTcpDisable);var a={disableRtx:e.disableRtx};if(e.gatherStats&&(a.maxstats=300),a.capScreenshareBitrate=!1,a.enableInsertableStreams=e.enableInsertableStreams,a.videoQuality=e.videoQuality,a.forceTurnRelay=e.forceTurnRelay,a.audioQuality=e.audioQuality,a.usesUnifiedPlan=this.usesUnifiedPlan=k.a.supportsUnifiedPlan()&&(k.a.isFirefox()||k.a.isWebKitBased()||(k.a.isChromiumBased()&&this.isP2P?null===(t=null===(n=e.p2p)||void 0===n?void 0:n.enableUnifiedOnChrome)||void 0===t||t:null===(i=e.enableUnifiedOnChrome)||void 0===i||i)),this.isP2P){a.disableSimulcast=!0;var r=this._abtestSuspendVideoEnabled(e);"undefined"!==typeof r&&(a.abtestSuspendVideo=r)}else{var s,c;a.disableSimulcast=e.disableSimulcast||e.preferH264&&!e.disableH264||e.videoQuality&&e.videoQuality.preferredCodec===d.H264,a.capScreenshareBitrate=a.disableSimulcast||!("number"===typeof(null===(s=e.desktopSharingFrameRate)||void 0===s?void 0:s.max)&&(null===(c=e.desktopSharingFrameRate)||void 0===c?void 0:c.max)>g.a),E.a.analytics.addPermanentProperties({capScreenshareBitrate:a.capScreenshareBitrate})}e.startSilent&&(a.startSilent=!0),this.peerconnection=this.rtc.createPeerConnection(this._signalingLayer,this.pcConfig,this.isP2P,a),this.peerconnection.onicecandidate=function(e){if(e){var t=e.candidate,n=window.performance.now();if(t){null===o._gatheringStartedTimestamp&&(o._gatheringStartedTimestamp=n);var i=t.protocol;if("string"===typeof i)if("tcp"===(i=i.toLowerCase())||"ssltcp"===i){if(o.webrtcIceTcpDisable)return}else if("udp"===i&&o.webrtcIceUdpDisable)return}else o._gatheringReported||(E.a.sendAnalytics(f.o,{phase:"gathering",value:n-o._gatheringStartedTimestamp,p2p:o.isP2P,initiator:o.isInitiator}),o._gatheringReported=!0);o.sendIceCandidate(t)}},this.peerconnection.onsignalingstatechange=function(){"stable"===o.peerconnection.signalingState?o.wasstable=!0:"closed"!==o.peerconnection.signalingState&&"closed"!==o.peerconnection.connectionState||o.room.eventEmitter.emit(v.a.SUSPEND_DETECTED,o)},this.peerconnection.oniceconnectionstatechange=function(){var e=window.performance.now(),t=!1;switch(o.isP2P||(o.room.connectionTimes["ice.state.".concat(o.peerconnection.iceConnectionState)]=e),D.log("(TIME) ICE ".concat(o.peerconnection.iceConnectionState," ").concat(o.isP2P?"P2P":"JVB",":\t"),e),E.a.sendAnalytics(f.q,{p2p:o.isP2P,state:o.peerconnection.iceConnectionState,signaling_state:o.peerconnection.signalingState,reconnect:o.isReconnect,value:e}),o.room.eventEmitter.emit(v.a.ICE_CONNECTION_STATE_CHANGED,o,o.peerconnection.iceConnectionState),o.peerconnection.iceConnectionState){case"checking":o._iceCheckingStartedTimestamp=e;break;case"connected":if("stable"===o.peerconnection.signalingState){t=!0;var n=!o.options.enableIceRestart&&o.room.supportsRestartByTerminate();(o.isReconnect||n)&&o.room.eventEmitter.emit(v.a.CONNECTION_RESTORED,o)}if(!o.wasConnected&&(o.wasstable||t||o.usesUnifiedPlan&&o.isInitiator&&k.a.isChromiumBased())){E.a.sendAnalytics(f.o,{phase:"checking",value:e-o._iceCheckingStartedTimestamp,p2p:o.isP2P,initiator:o.isInitiator});var i=Math.min(o._iceCheckingStartedTimestamp,o._gatheringStartedTimestamp);o.establishmentDuration=e-i,E.a.sendAnalytics(f.o,{phase:"establishment",value:o.establishmentDuration,p2p:o.isP2P,initiator:o.isInitiator}),o.wasConnected=!0,o.room.eventEmitter.emit(v.a.CONNECTION_ESTABLISHED,o)}o.isReconnect=!1;break;case"disconnected":o.isReconnect=!0,o.wasstable&&o.room.eventEmitter.emit(v.a.CONNECTION_INTERRUPTED,o);break;case"failed":o.room.eventEmitter.emit(v.a.CONNECTION_ICE_FAILED,o)}},this.peerconnection.onconnectionstatechange=function(){var e=o.peerconnection.iceConnectionState;switch(o.peerconnection.connectionState){case"failed":"disconnected"===e&&o.room.eventEmitter.emit(v.a.CONNECTION_ICE_FAILED,o)}},this.peerconnection.onnegotiationneeded=function(){var e=o.peerconnection.signalingState,t=o.peerconnection.remoteDescription;if(o.usesUnifiedPlan&&!o.isP2P&&"stable"===e&&t&&"string"===typeof t.sdp){D.info("".concat(o," onnegotiationneeded fired on ").concat(o.peerconnection));o.modificationQueue.push((function(e){var t=new y.a(o.peerconnection.localDescription.sdp);o._renegotiate().then((function(){return o.peerconnection.configureSenderVideoEncodings()})).then((function(){var e=new y.a(o.peerconnection.localDescription.sdp);o.notifyMySSRCUpdate(t,e)})).then((function(){return e()}),(function(t){return e(t)}))}),(function(e){e?D.error("".concat(o," onnegotiationneeded error"),e):D.debug("".concat(o," onnegotiationneeded executed - OK"))}))}}}},{key:"getRemoteRecvMaxFrameHeight",value:function(){if(this.isP2P)return this.remoteRecvMaxFrameHeight}},{key:"sendIceCandidate",value:function(e){var t=this,n=new y.a(this.peerconnection.localDescription.sdp);if(e&&e.candidate.length&&!this.lasticecandidate){var i=S.a.iceparams(n.media[e.sdpMLineIndex],n.session),o=S.a.candidateToJingle(e.candidate);if(!i||!o){var a="failed to get ice && jcand";return j.a.callErrorHandler(new Error(a)),void D.error(a)}i.xmlns="urn:xmpp:jingle:transports:ice-udp:1",this.usedrip?(0===this.dripContainer.length&&setTimeout((function(){0!==t.dripContainer.length&&(t.sendIceCandidates(t.dripContainer),t.dripContainer=[])}),150),this.dripContainer.push(e)):this.sendIceCandidates([e])}else D.log("".concat(this," sendIceCandidate: last candidate")),this.lasticecandidate=!0}},{key:"sendIceCandidates",value:function(e){var t=this;if(this._assertNotEnded("sendIceCandidates")){D.log("".concat(this," sendIceCandidates ").concat(JSON.stringify(e)));for(var n=Object(u.$iq)({to:this.remoteJid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"transport-info",initiator:this.initiatorJid,sid:this.sid}),i=new y.a(this.peerconnection.localDescription.sdp),o=function(o){var a=e.filter((function(e){return e.sdpMLineIndex===o})),r=S.a.parseMLine(i.media[o].split("\r\n")[0]);if(a.length>0){var s=S.a.iceparams(i.media[o],i.session);s.xmlns="urn:xmpp:jingle:transports:ice-udp:1",n.c("content",{creator:t.initiatorJid===t.localJid?"initiator":"responder",name:a[0].sdpMid?a[0].sdpMid:r.media}).c("transport",s);for(var c=0;c<a.length;c++){var l=S.a.candidateToJingle(a[c].candidate);t.failICE&&(l.ip="1.1.1.1"),n.c("candidate",l).up()}var u=S.a.findLine(i.media[o],"a=fingerprint:",i.session);if(u){var d=S.a.parseFingerprint(u);d.required=!0,n.c("fingerprint",{xmlns:"urn:xmpp:jingle:apps:dtls:0"}).t(d.fingerprint),delete d.fingerprint,n.attrs(d),n.up()}n.up(),n.up()}},a=0;a<i.media.length;a++)o(a);this.connection.sendIQ(n,null,this.newJingleErrorHandler(n),P)}}},{key:"sendIceFailedNotification",value:function(){var e=Object(u.$iq)({to:this.remoteJid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-info",initiator:this.initiatorJid,sid:this.sid}).c("ice-state",{xmlns:"http://jitsi.org/protocol/focus"}).t("failed").up();this._bridgeSessionId&&e.c("bridge-session",{xmlns:"http://jitsi.org/protocol/focus",id:this._bridgeSessionId}),this.connection.sendIQ2(e,{timeout:65}).catch(this.newJingleErrorHandler(e))}},{key:"addIceCandidates",value:function(e){var t=this;if("closed"!==this.peerconnection.signalingState){var n=[];if(e.find(">content>transport>candidate").each((function(e,t){var i=S.a.candidateFromJingle(t);i=i.replace("\r\n","").replace("a=","");var o=new RTCIceCandidate({sdpMLineIndex:0,sdpMid:"",candidate:i});n.push(o)})),n.length){D.debug("".concat(this," Queued add (").concat(n.length,") ICE candidates task")),this.modificationQueue.push((function(e){var o,a=Object(i.a)(n);try{for(a.s();!(o=a.n()).done;){var r=o.value;t.peerconnection.addIceCandidate(r).then((function(){return D.debug("".concat(t," addIceCandidate ok!"))}),(function(e){return D.error("".concat(t," addIceCandidate failed!"),e)}))}}catch(s){a.e(s)}finally{a.f()}e(),D.debug("".concat(t," ICE candidates task finished"))}))}else D.error("".concat(this," No ICE candidates to add ?"),e[0]&&e[0].outerHTML)}else D.warn("".concat(this," Ignored add ICE candidate when in closed state"))}},{key:"readSsrcInfo",value:function(e){var t=this;$(e).find('>description>source[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]').each((function(e,n){var i=Number(n.getAttribute("ssrc"));if(t.isP2P)t._signalingLayer.setSSRCOwner(i,u.Strophe.getResourceFromJid(t.remoteJid));else{if(b.a.isSourceNameSignalingEnabled()&&n.hasAttribute("name")){var o=n.getAttribute("name");t._signalingLayer.setTrackSourceName(i,o)}$(n).find('>ssrc-info[xmlns="http://jitsi.org/jitmeet"]').each((function(e,n){var o,a=n.getAttribute("owner");a&&a.length&&(isNaN(i)||i<0?D.warn("".concat(t," Invalid SSRC ").concat(i," value received for ").concat(a)):t._signalingLayer.setSSRCOwner(i,(o=a,u.Strophe.getResourceFromJid(o)||o)))}))}}))}},{key:"generateRecvonlySsrc",value:function(){this.peerconnection?this.peerconnection.generateRecvonlySsrc():D.error("".concat(this," Unable to generate recvonly SSRC - no peerconnection"))}},{key:"getConfiguredVideoCodec",value:function(){return this.peerconnection.getConfiguredVideoCodec()}},{key:"acceptOffer",value:function(e,t,n,i){var o=this;this.setOfferAnswerCycle(e,(function(){o.sendSessionAccept(t,n)}),n,i)}},{key:"invite",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!this.isInitiator)throw new Error("Trying to invite from the responder session");var n=function(n){var o,a=[],r=Object(i.a)(t);try{for(r.s();!(o=r.n()).done;){var s=o.value;a.push(e.peerconnection.addTrack(s,e.isInitiator))}}catch(c){r.e(c)}finally{r.f()}Promise.all(a).then((function(){return e.peerconnection.createOffer(e.mediaConstraints)})).then((function(t){return e.peerconnection.setLocalDescription(t)})).then((function(){e.sendSessionInitiate(e.peerconnection.localDescription.sdp)})).then((function(){return n()}),(function(e){return n(e)}))};D.debug("".concat(this," Queued invite task")),this.modificationQueue.push(n,(function(t){t?D.error("".concat(e," invite error"),t):D.debug("".concat(e," invite executed - OK"))}))}},{key:"sendSessionInitiate",value:function(e){var t=this,n=Object(u.$iq)({to:this.remoteJid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-initiate",initiator:this.initiatorJid,sid:this.sid});new y.a(e).toJingle(n,this.isInitiator?"initiator":"responder"),n=n.tree(),D.debug("".concat(this," Session-initiate: "),n),this.connection.sendIQ(n,(function(){D.info("".concat(t,' Got RESULT for "session-initiate"'))}),(function(e){D.error("".concat(t,' "session-initiate" error'),e)}),P)}},{key:"setAnswer",value:function(e){var t=this;if(!this.isInitiator)throw new Error("Trying to set an answer on the responder session");this.setOfferAnswerCycle(e,(function(){if(D.info("".concat(t," setAnswer - succeeded")),t.usesUnifiedPlan&&k.a.isChromiumBased()){var e=t.peerconnection.remoteDescription.sdp,n=new RTCSessionDescription({type:"offer",sdp:e});t._responderRenegotiate(n)}}),(function(e){D.error("".concat(t," setAnswer failed: "),e)}))}},{key:"setOfferAnswerCycle",value:function(e,t,n){var o=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=function(t){var n,r=[],s=Object(i.a)(a);try{for(s.s();!(n=s.n()).done;){var c=n.value;r.push(o.peerconnection.addTrack(c,o.isInitiator))}}catch(p){s.e(p)}finally{s.f()}var l=o._processNewJingleOfferIq(e),u=o.peerconnection.localDescription.sdp,d=$(e).find('>bridge-session[xmlns="http://jitsi.org/protocol/focus"]').attr("id");d!==o._bridgeSessionId&&(o._bridgeSessionId=d),Promise.all(r).then((function(){return o._renegotiate(l.raw)})).then((function(){if(o.state===R.c&&(o.state=R.a,!o.isP2P||o._localVideoActive&&!o.localRecvMaxFrameHeight||o.sendContentModify()),u){var e=new y.a(o.peerconnection.localDescription.sdp);o.notifyMySSRCUpdate(new y.a(u),e)}})).then((function(){return t()}),(function(e){return t(e)}))};D.debug("".concat(this," Queued setOfferAnswerCycle task")),this.modificationQueue.push(r,(function(e){e?(D.error("".concat(o," setOfferAnswerCycle task failed: ").concat(e)),n(e)):(D.debug("".concat(o," setOfferAnswerCycle task done")),t())}))}},{key:"setVideoCodecs",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.peerconnection.getConfiguredVideoCodec();if(this._assertNotEnded()&&t!==i){D.info("".concat(this," Switching video codec from ").concat(i," to ").concat(t)),this.peerconnection.setVideoCodecs(t,n);var o=function(t){e._renegotiate().then((function(){return D.debug("".concat(e," setVideoCodecs task is done")),t()}),(function(n){return D.error("".concat(e," setVideoCodecs task failed: ").concat(n)),t(n)}))};D.debug("".concat(this," Queued setVideoCodecs task")),this.modificationQueue.push(o)}}},{key:"replaceTransport",value:function(e,t,n){var i=this;if(this.options.enableForcedReload){var o=new y.a(this.peerconnection.localDescription.sdp);return this.sendTransportAccept(o,t,n),void this.room.eventEmitter.emit(v.a.CONNECTION_RESTARTED,this)}this.room.eventEmitter.emit(v.a.ICE_RESTARTING,this);var a=e.clone();e.find(">content[name='data']").attr("senders","rejected"),e.find(">content>description>source").remove(),e.find(">content>description>ssrc-group").remove();var r=e.find(">content>transport>fingerprint");r.attr("hash","sha-1"),r.text("00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00"),this.setOfferAnswerCycle(e,(function(){i.setOfferAnswerCycle(a,(function(){var e=new y.a(i.peerconnection.localDescription.sdp);i.sendTransportAccept(e,t,n),i.room.eventEmitter.emit(v.a.ICE_RESTART_SUCCESS,i,a)}),n)}),n)}},{key:"sendSessionAccept",value:function(e,t){var n=this,i=new y.a(this.peerconnection.localDescription.sdp),o=Object(u.$iq)({to:this.remoteJid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-accept",initiator:this.initiatorJid,responder:this.responderJid,sid:this.sid});this.webrtcIceTcpDisable&&(i.removeTcpCandidates=!0),this.webrtcIceUdpDisable&&(i.removeUdpCandidates=!0),this.failICE&&(i.failICE=!0),i.toJingle(o,this.initiatorJid===this.localJid?"initiator":"responder"),D.info("".concat(this," Sending session-accept")),D.debug(o.tree()),this.connection.sendIQ(o,e,this.newJingleErrorHandler(o,(function(e){t(e),n.room.eventEmitter.emit(v.a.SESSION_ACCEPT_TIMEOUT,n)})),P)}},{key:"sendContentModify",value:function(){var e=this.localRecvMaxFrameHeight,t=this._localVideoActive?"both":"none",n=Object(u.$iq)({to:this.remoteJid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"content-modify",initiator:this.initiatorJid,sid:this.sid}).c("content",{name:"video",senders:t});"undefined"!==typeof e&&(n=n.c("max-frame-height",{xmlns:"http://jitsi.org/jitmeet/video"}).t(e)),D.info("".concat(this," sending content-modify, video senders: ").concat(t,", max frame height: ").concat(e)),D.debug(n.tree()),this.connection.sendIQ(n,null,this.newJingleErrorHandler(n),P)}},{key:"setReceiverVideoConstraint",value:function(e){D.info("".concat(this," setReceiverVideoConstraint - max frame height: ").concat(e)),this.localRecvMaxFrameHeight=e,this.isP2P?this.state===R.a&&this.sendContentModify():this.rtc.setReceiverVideoConstraint(e)}},{key:"sendTransportAccept",value:function(e,t,n){var i=this,o=Object(u.$iq)({to:this.remoteJid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"transport-accept",initiator:this.initiatorJid,sid:this.sid});e.media.forEach((function(t,n){var a=S.a.parseMLine(t.split("\r\n")[0]);o.c("content",{creator:i.initiatorJid===i.localJid?"initiator":"responder",name:a.media}),e.transportToJingle(n,o),o.up()})),D.info("".concat(this," Sending transport-accept")),D.debug(o.tree()),this.connection.sendIQ(o,t,this.newJingleErrorHandler(o,n),P)}},{key:"sendTransportReject",value:function(e,t){var n=Object(u.$iq)({to:this.remoteJid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"transport-reject",initiator:this.initiatorJid,sid:this.sid});D.info("".concat(this," Sending 'transport-reject'")),D.debug(n.tree()),this.connection.sendIQ(n,e,this.newJingleErrorHandler(n,t),P)}},{key:"setSenderVideoConstraint",value:function(e){if(this._assertNotEnded()){if(D.info("".concat(this," setSenderVideoConstraint: ").concat(e)),!this.isP2P&&k.a.isReactNative()&&"undefined"!==typeof e){var t=e>0;return this.setMediaTransferActive(!0,t)}return"undefined"===typeof e?this.peerconnection.configureSenderVideoEncodings():this.peerconnection.setSenderVideoConstraints(e)}return Promise.resolve()}},{key:"terminate",value:function(e,t,n){if(this.state!==R.b){if(!n||Boolean(n.sendSessionTerminate)){var i=Object(u.$iq)({to:this.remoteJid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-terminate",initiator:this.initiatorJid,sid:this.sid}).c("reason").c(n&&n.reason||"success").up();n&&n.reasonDescription?i.c("text").t(n.reasonDescription).up().up():i.up(),this._bridgeSessionId&&i.c("bridge-session",{xmlns:"http://jitsi.org/protocol/focus",id:this._bridgeSessionId,restart:n&&!0===n.requestRestart}).up(),D.info("".concat(this," Sending session-terminate")),D.debug(i.tree()),this.connection.sendIQ(i,e,this.newJingleErrorHandler(i,t),P)}else D.info("".concat(this," Skipped sending session-terminate"));this.connection.jingle.terminate(this.sid)}}},{key:"onTerminated",value:function(e,t){D.info("".concat(this," Session terminated"),e,t),this._xmppListeners.forEach((function(e){return e()})),this._xmppListeners=[],this._removeSenderVideoConstraintsChangeListener&&this._removeSenderVideoConstraintsChangeListener(),this.close()}},{key:"onXmppStatusChanged",value:function(e){e===w.a.Status.CONNECTED&&this._cachedOldLocalSdp&&(D.info("".concat(this," Sending SSRC update on reconnect")),this.notifyMySSRCUpdate(this._cachedOldLocalSdp,this._cachedNewLocalSdp))}},{key:"_parseSsrcInfoFromSourceAdd",value:function(e,t){var n=[],i=this;return $(e).each((function(e,o){var a=$(o).attr("name"),r="";$(o).find('ssrc-group[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]').each((function(){var e=this.getAttribute("semantics"),t=$(this).find(">source").map((function(){return this.getAttribute("ssrc")})).get();t.length&&(r+="a=ssrc-group:".concat(e," ").concat(t.join(" "),"\r\n"))})),$(o).find('source[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]').each((function(){var e=$(this).attr("ssrc");t.containsSSRC(e)?(!i.usesUnifiedPlan||!i.isP2P)&&D.warn("".concat(i," Source-add request for existing SSRC: ").concat(e)):$(this).find(">parameter").each((function(){r+="a=ssrc:".concat(e," ").concat($(this).attr("name")),$(this).attr("value")&&$(this).attr("value").length&&(r+=":".concat($(this).attr("value"))),r+="\r\n"}))})),t.media.forEach((function(e,t){S.a.findLine(e,"a=mid:".concat(a))&&(n[t]||(n[t]=""),n[t]+=r)}))})),n}},{key:"addRemoteStream",value:function(e){this._addOrRemoveRemoteStream(!0,e)}},{key:"removeRemoteStream",value:function(e){this._addOrRemoveRemoteStream(!1,e)}},{key:"removeRemoteStreamsOnLeave",value:function(e){var t=this;D.debug("".concat(this," Queued removeRemoteStreamsOnLeave task for participant ").concat(e)),this.modificationQueue.push((function(n){var i=t.peerconnection.getRemoteSourceInfoByParticipant(e);if(i.length){t.peerconnection.removeRemoteTracks(e);var o=new y.a(t.peerconnection.localDescription.sdp),a=t._processRemoteRemoveSource(i);t._renegotiate(a.raw).then((function(){var e=new y.a(t.peerconnection.localDescription.sdp);t.notifyMySSRCUpdate(o,e),n()})).catch((function(e){return n(e)}))}else n()}),(function(e){e?D.error("".concat(t," removeRemoteStreamsOnLeave error:"),e):D.info("".concat(t," removeRemoteStreamsOnLeave done!"))}))}},{key:"_addOrRemoveRemoteStream",value:function(e,t){var n=this,i=e?"addRemoteStream":"removeRemoteStream";e&&this.readSsrcInfo(t);D.debug("".concat(this," Queued ").concat(i," task")),this.modificationQueue.push((function(o){if(!n.peerconnection.localDescription||!n.peerconnection.localDescription.sdp){var a="".concat(i," - localDescription not ready yet");return D.error(a),void o(a)}D.log("".concat(n," Processing ").concat(i));var r=new y.a(n.peerconnection.localDescription.sdp),s=new y.a(n.peerconnection.remoteDescription.sdp),c=e?n._parseSsrcInfoFromSourceAdd(t,s):n._parseSsrcInfoFromSourceRemove(t,s),l=e?n._processRemoteAddSource(c):n._processRemoteRemoveSource(c),u=new RTCSessionDescription({type:"offer",sdp:l.raw});(e&&n.usesUnifiedPlan&&n.isP2P&&k.a.isChromiumBased()?n._responderRenegotiate(u):n._renegotiate(l.raw)).then((function(){var e=new y.a(n.peerconnection.localDescription.sdp);D.log("".concat(n," ").concat(i," - OK")),n.notifyMySSRCUpdate(r,e),o()}),(function(e){D.error("".concat(n," ").concat(i," failed:"),e),o(e)}))}))}},{key:"_processNewJingleOfferIq",value:function(e){var t=new y.a("");return this.webrtcIceTcpDisable&&(t.removeTcpCandidates=!0),this.webrtcIceUdpDisable&&(t.removeUdpCandidates=!0),this.failICE&&(t.failICE=!0),t.fromJingle(e),this.readSsrcInfo($(e).find(">content")),t}},{key:"_processRemoteRemoveSource",value:function(e){var t=this,n=this.usesUnifiedPlan?new y.a(this.peerconnection.peerconnection.remoteDescription.sdp):new y.a(this.peerconnection.remoteDescription.sdp);return e.forEach((function(e,i){(e=e.split("\r\n")).pop(),t.usesUnifiedPlan?e.forEach((function(e){var i=n.media.findIndex((function(t){return t.includes(e)}));if(i>-1)if(t.isP2P){var o,a=null===(o=S.a.parseMLine(n.media[i].split("\r\n")[0]))||void 0===o?void 0:o.media,r=t.peerconnection.getDesiredMediaDirection(a,!1);[h.a.SENDRECV,h.a.SENDONLY].forEach((function(e){n.media[i]=n.media[i].replace("a=".concat(e),"a=".concat(r))}))}else n.media[i]=n.media[i].replace("".concat(e,"\r\n"),""),n.media[i]=n.media[i].replace("a=".concat(h.a.SENDONLY),"a=".concat(h.a.INACTIVE))})):e.forEach((function(e){n.media[i]=n.media[i].replace("".concat(e,"\r\n"),"")}))})),n.raw=n.session+n.media.join(""),n}},{key:"_processRemoteAddSource",value:function(e){var t=this,n=new y.a(this.peerconnection.remoteDescription.sdp);return e.forEach((function(e,i){if(n.media[i]+=e,t.isP2P&&t.usesUnifiedPlan){var o,a=null===(o=S.a.parseMLine(n.media[i].split("\r\n")[0]))||void 0===o?void 0:o.media,r=t.peerconnection.getDesiredMediaDirection(a,!0);[h.a.RECVONLY,h.a.INACTIVE].forEach((function(e){n.media[i]=n.media[i].replace("a=".concat(e),"a=".concat(r))}))}})),n.raw=n.session+n.media.join(""),n}},{key:"_renegotiate",value:function(e){if("closed"===this.peerconnection.signalingState){var t=new Error("Attempted to renegotiate in state closed");return this.room.eventEmitter.emit(v.a.RENEGOTIATION_FAILED,t,this),Promise.reject(t)}var n=e||this.peerconnection.remoteDescription.sdp;if(!n){var i=new Error("Can not renegotiate without remote description, current state: ".concat(this.state));return this.room.eventEmitter.emit(v.a.RENEGOTIATION_FAILED,i,this),Promise.reject(i)}var o=new RTCSessionDescription({type:this.isInitiator?"answer":"offer",sdp:n});return this.isInitiator?this._initiatorRenegotiate(o):this._responderRenegotiate(o)}},{key:"_responderRenegotiate",value:function(e){var t=this;return D.debug("".concat(this," Renegotiate: setting remote description")),this.peerconnection.setRemoteDescription(e).then((function(){return D.debug("".concat(t," Renegotiate: creating answer")),t.peerconnection.createAnswer(t.mediaConstraints).then((function(e){return D.debug("".concat(t," Renegotiate: setting local description")),t.peerconnection.setLocalDescription(e)}))}))}},{key:"_initiatorRenegotiate",value:function(e){var t=this;return D.debug("".concat(this," Renegotiate: creating offer")),this.peerconnection.createOffer(this.mediaConstraints).then((function(n){return D.debug("".concat(t," Renegotiate: setting local description")),t.peerconnection.setLocalDescription(n).then((function(){return D.debug("".concat(t," Renegotiate: setting remote description")),t.peerconnection.setRemoteDescription(e)}))}))}},{key:"replaceTrack",value:function(e,t){var n=this,i=function(i){D.debug("".concat(n," replaceTrack worker started. oldTrack = ").concat(e,", newTrack = ").concat(t));var o=n.peerconnection.localDescription.sdp;n.usesUnifiedPlan||(n.peerconnection.options.capScreenshareBitrate&&e&&t&&t.isVideoTrack()&&n.peerconnection.clearRecvonlySsrc(),!e&&t&&t.isVideoTrack()?n.peerconnection.clearRecvonlySsrc():e&&e.isVideoTrack()&&!t&&(n.peerconnection.clearRecvonlySsrc(),n.peerconnection.generateRecvonlySsrc())),n.peerconnection.replaceTrack(e,t).then((function(i){var a=Promise.resolve();return D.debug("".concat(n," TPC.replaceTrack finished. shouldRenegotiate = ").concat(i,", JingleSessionState = ").concat(n.state)),i&&(e||t)&&n.state===R.a&&(a=n._renegotiate().then((function(){var e=new y.a(n.peerconnection.localDescription.sdp);n.notifyMySSRCUpdate(new y.a(o),e)}))),a.then((function(){if(null!==t&&void 0!==t&&t.isVideoTrack())return D.debug("".concat(n," replaceTrack worker: configuring video stream")),n.peerconnection.configureSenderVideoEncodings()}))})).then((function(){return i()}),(function(e){return i(e)}))};return new Promise((function(o,a){D.debug("".concat(n," Queued replaceTrack task. Old track = ").concat(e,", new track = ").concat(t)),n.modificationQueue.push(i,(function(e){e?(D.error("".concat(n," Replace track error:"),e),a(e)):(D.info("".concat(n,"  Replace track done!")),o())}))}))}},{key:"_parseSsrcInfoFromSourceRemove",value:function(e,t){var n=[];return $(e).each((function(e,i){var o=$(i).attr("name"),a="";$(i).find('ssrc-group[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]').each((function(){var e=this.getAttribute("semantics"),t=$(this).find(">source").map((function(){return this.getAttribute("ssrc")})).get();t.length&&(a+="a=ssrc-group:".concat(e," ").concat(t.join(" "),"\r\n"))}));var r=[];$(i).find('source[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]').each((function(){var e=$(this).attr("ssrc");r.push(e)})),t.media.forEach((function(e,t){S.a.findLine(e,"a=mid:".concat(o))&&(n[t]||(n[t]=""),r.forEach((function(i){var o=S.a.findLines(e,"a=ssrc:".concat(i));o.length&&(n[t]+="".concat(o.join("\r\n"),"\r\n"))})),n[t]+=a)}))})),n}},{key:"_verifyNoSSRCChanged",value:function(e,t){var n=new y.a(this.peerconnection.localDescription.sdp),i=new A.a(t,n),o=i.getNewMedia();if(Object.keys(o).length)return D.error("".concat(this," - some SSRC were added on ").concat(e),o),!1;var a=(i=new A.a(n,t)).getNewMedia();return!Object.keys(a).length||(D.error("".concat(this," - some SSRCs were removed on ").concat(e),a),!1)}},{key:"addTrackAsUnmute",value:function(e){var t=this;return this._addRemoveTrackAsMuteUnmute(!1,e).then((function(){if(e.isVideoTrack())return t.peerconnection.configureSenderVideoEncodings()}))}},{key:"removeTrackAsMute",value:function(e){return this._addRemoveTrackAsMuteUnmute(!0,e)}},{key:"_addRemoveTrackAsMuteUnmute",value:function(e,t){var n=this;if(!t)return Promise.reject('invalid "track" argument value');var i=e?"removeTrackMute":"addTrackUnmute",o=function(o){var a=n.peerconnection;if(a){var r=a.localDescription.sdp;(e?a.removeTrackMute(t):a.addTrackUnmute(t)).then((function(e){e&&r&&a.remoteDescription.sdp?n._renegotiate().then((function(){!n.usesUnifiedPlan&&n._verifyNoSSRCChanged(i,new y.a(r));var e=a.localDescription.sdp;n.notifyMySSRCUpdate(new y.a(r),new y.a(e)),o()})):o()}),o)}else o("Error:  tried ".concat(i," track with no active peer")+"connection")};return D.debug("".concat(this," Queued ").concat(i," task")),new Promise((function(e,t){n.modificationQueue.push(o,(function(o){o?(D.error("".concat(n," ").concat(i," failed")),t(o)):(D.debug("".concat(n," ").concat(i," done")),e())}))}))}},{key:"setMediaTransferActive",value:function(e,t){var n=this;if(!this.peerconnection)return Promise.reject('Can not modify transfer active state, before "initialize" is called');var i=e?"audio active":"audio inactive",o=t?"video active":"video inactive";D.info("".concat(this," Queued make ").concat(o,", ").concat(i," task"));var a=function(i){var o=n.state===R.a,a=n.peerconnection.setAudioTransferActive(e);n._localVideoActive!==t&&(n._localVideoActive=t,n.isP2P&&o&&n.sendContentModify());var r=n.peerconnection.setVideoTransferActive(n._localVideoActive&&n._remoteVideoActive);o&&(a||r)?n._renegotiate().then(i,i):i()};return new Promise((function(e,t){n.modificationQueue.push(a,(function(a){a?(D.error("".concat(n," Make ").concat(o,", ").concat(i," task failed!")),t(a)):(D.debug("".concat(n," Make ").concat(o,", ").concat(i," task done!")),e())}))}))}},{key:"modifyContents",value:function(e){var t=this,i=n.parseVideoSenders(e),o=n.parseMaxFrameHeight(e);if(o&&(D.info("".concat(this," received remote max frame height: ").concat(o)),this.remoteRecvMaxFrameHeight=o,this.eventEmitter.emit(I.a.REMOTE_VIDEO_CONSTRAINTS_CHANGED,this)),null!==i){D.debug("".concat(this,' queued "content-modify" task(video senders="').concat(i,'")')),this.modificationQueue.push((function(e){t._assertNotEnded("content-modify")&&t._modifyRemoteVideoActive(i)?t._renegotiate().then(e,e):e()}),(function(e){e?D.error("".concat(t,' "content-modify" failed'),e):D.debug("".concat(t,' "content-modify" task(video senders="').concat(i,'") done'))}))}else D.error("".concat(this,' - failed to parse video "senders" attribute in')+'"content-modify" action')}},{key:"_modifyRemoteVideoActive",value:function(e){var t="both"===e||"initiator"===e&&this.isInitiator||"responder"===e&&!this.isInitiator;return t!==this._remoteVideoActive&&(D.debug("".concat(this," new remote video active: ").concat(t)),this._remoteVideoActive=t),this.peerconnection.setVideoTransferActive(this._localVideoActive&&this._remoteVideoActive)}},{key:"notifyMySSRCUpdate",value:function(e,t){if(this.state===R.a){if(!this.connection.connected)return this._cachedOldLocalSdp||(this._cachedOldLocalSdp=e),this._cachedNewLocalSdp=t,void D.warn("".concat(this," Not sending SSRC update while the signaling is disconnected"));this._cachedOldLocalSdp=void 0,this._cachedNewLocalSdp=void 0;var n=new A.a(t,e),i=Object(u.$iq)({to:this.remoteJid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"source-remove",initiator:this.initiatorJid,sid:this.sid});n.toJingle(i)&&(D.info("".concat(this," Sending source-remove")),D.debug(i.tree()),this.connection.sendIQ(i,null,this.newJingleErrorHandler(i),P)),n=new A.a(e,t);var o=Object(u.$iq)({to:this.remoteJid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"source-add",initiator:this.initiatorJid,sid:this.sid});n.toJingle(o)&&(D.info("".concat(this," Sending source-add")),D.debug(o.tree()),this.connection.sendIQ(o,null,this.newJingleErrorHandler(o),P))}else D.warn("".concat(this," Skipping SSRC update in '").concat(this.state," ' state."))}},{key:"newJingleErrorHandler",value:function(e,t){var n=this;return function(e){var i={},o=$(e).find("error");if(o.length){i.code=o.attr("code");var a=$(e).find("error :first");a.length&&(i.reason=a[0].tagName);var r=o.find(">text");r.length&&(i.msg=r.text())}e||(i.reason="timeout"),i.session=n.toString(),t?t(i):n.state===R.b&&"item-not-found"===i.reason?D.debug("".concat(n," Jingle error: ").concat(JSON.stringify(i))):j.a.callErrorHandler(new Error("Jingle error: ".concat(JSON.stringify(i))))}}},{key:"getIceConnectionState",value:function(){return this.peerconnection.getConnectionState()}},{key:"close",value:function(){var e=this;this.state=R.b,this.establishmentDuration=void 0,this.peerconnection&&(this.peerconnection.onicecandidate=null,this.peerconnection.oniceconnectionstatechange=null,this.peerconnection.onnegotiationneeded=null,this.peerconnection.onsignalingstatechange=null),D.debug("".concat(this," Clearing modificationQueue")),this.modificationQueue.clear(),D.debug("".concat(this," Queued PC close task")),this.modificationQueue.push((function(t){e.peerconnection&&e.peerconnection.close(),t(),D.debug("".concat(e," PC close task done!"))})),D.debug("".concat(this," Shutdown modificationQueue!")),this.modificationQueue.shutdown()}},{key:"toString",value:function(){return"JingleSessionPC[session=".concat(this.isP2P?"P2P":"JVB",",initiator=").concat(this.isInitiator,",sid=").concat(this.sid,"]")}},{key:"_abtestSuspendVideoEnabled",value:function(e){var t=e.abTesting;if(t&&t.enableSuspendVideoTest){var n=this._getInitiatorJid();return Object(T.integerHash)(n)%2===0}}}],[{key:"parseVideoSenders",value:function(e){var t=e.find('>content[name="video"]');if(t.length){var n=t[0].getAttribute("senders");if("both"===n||"initiator"===n||"responder"===n||"none"===n)return n}return null}},{key:"parseMaxFrameHeight",value:function(e){var t=e.find('>content[name="video"]>max-frame-height');return t.length?Number(t.text()):null}}]),n}(_.a)}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return _}));var i=n(5),o=n(6),a=n(8),r=n(25),s=n(107),c=n(87),l=n(34),u=n(33),d=n(22),p=n(74),h=n(53),f=n(63),m=n(160),v=n.n(m),g=n(20),b=n(31),y=n.n(b),A=n(45),S=n.n(A),E=n(35),O=n(21),C=n(28),j=n(231),T=n(42),k=Object(d.getLogger)(e),_=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a,s=e.deviceId,c=e.facingMode,l=e.mediaType,u=e.resolution,d=e.rtcId,p=e.sourceId,h=e.sourceType,m=e.stream,v=e.track,g=e.videoType,b=e.effects,A=void 0===b?[]:b;Object(o.a)(this,n),(a=t.call(this,null,m,v,(function(){return a.emit(f.LOCAL_TRACK_STOPPED)}),l,g))._setEffectInProgress=!1;var E=A.find((function(e){return e.isEnabled(Object(r.a)(a))}));E&&a._startStreamEffect(E);var O=g===S.a.DESKTOP?v.getSettings().displaySurface:null;return a.metadata=Object(i.a)({timestamp:Date.now()},O?{displaySurface:O}:{}),a.rtcId=d,a.sourceId=p,a.sourceType=h,a.resolution=v.getSettings().height,a.maxEnabledResolution=u,a._constraints=v.getConstraints(),Object.keys(a._constraints).length||g!==S.a.CAMERA||(a._constraints={height:v.getSettings().height,width:v.getSettings().width}),a.deviceId=s,a._prevSetMuted=Promise.resolve(),a._facingMode=c,a._trackEnded=!1,a._hasSentData=!1,a._testDataSent=!0,a._realDeviceId=""===a.deviceId?void 0:a.deviceId,a._trackMutedTS=0,a._onDeviceListWillChange=function(e){var t=a._realDeviceId;a._setRealDeviceIdFromDeviceList(e),("undefined"===typeof a.getTrack().readyState&&"undefined"!==typeof a._realDeviceId&&!e.find((function(e){return e.deviceId===a._realDeviceId}))||"undefined"!==typeof t&&"undefined"===typeof a._realDeviceId)&&(a._trackEnded=!0)},a.isAudioTrack()&&T.a.isDeviceChangeAvailable("output")&&(a._onAudioOutputDeviceChanged=a.setAudioOutput.bind(Object(r.a)(a)),T.a.addListener(y.a.AUDIO_OUTPUT_DEVICE_CHANGED,a._onAudioOutputDeviceChanged)),T.a.addListener(y.a.DEVICE_LIST_WILL_CHANGE,a._onDeviceListWillChange),a._initNoDataFromSourceHandlers(),a}return Object(a.a)(n,[{key:"getDuration",value:function(){return Date.now()/1e3-this.metadata.timestamp/1e3}},{key:"isEnded",value:function(){return this.isVideoTrack()&&this.isMuted()?this._trackEnded:"ended"===this.getTrack().readyState||this._trackEnded}},{key:"_initNoDataFromSourceHandlers",value:function(){var e=this;this._isNoDataFromSourceEventsEnabled()&&(this._setHandler("track_mute",(function(){e._trackMutedTS=window.performance.now(),e._fireNoDataFromSourceEvent()})),this._setHandler("track_unmute",(function(){e._fireNoDataFromSourceEvent(),C.a.sendAnalyticsAndLog(E.s,{media_type:e.getType(),track_type:"local",value:window.performance.now()-e._trackMutedTS})})),this.isVideoTrack()&&this.videoType===S.a.CAMERA&&this._setHandler("track_ended",(function(){e.isReceivingData()||e._fireNoDataFromSourceEvent()})))}},{key:"_isNoDataFromSourceEventsEnabled",value:function(){return!this.isVideoTrack()||this.videoType!==S.a.DESKTOP}},{key:"_fireNoDataFromSourceEvent",value:function(){var e=!this.isReceivingData();this.emit(f.NO_DATA_FROM_SOURCE,e),C.a.sendAnalytics(Object(E.H)(this.getType(),e)),C.a.sendLog(JSON.stringify({name:f.NO_DATA_FROM_SOURCE,log:e}))}},{key:"_setRealDeviceIdFromDeviceList",value:function(e){var t=this.getTrack(),n="".concat(t.kind,"input"),i=e.find((function(e){return e.kind===n&&e.label===t.label}));if(!i&&"default"===this._realDeviceId){var o=(t.label||"").replace("Default - ","");i=e.find((function(e){return e.kind===n&&e.label===o}))}this._realDeviceId=i?i.deviceId:void 0}},{key:"_setStream",value:function(e){Object(s.a)(Object(c.a)(n.prototype),"_setStream",this).call(this,e),e?(this.storedMSID=this.getMSID(),k.debug("Setting new MSID: ".concat(this.storedMSID," on ").concat(this))):k.debug("Setting 'null' stream on ".concat(this))}},{key:"_startStreamEffect",value:function(e){this._streamEffect=e,this._originalStream=this.stream,this._setStream(this._streamEffect.startEffect(this._originalStream)),this.track=this.stream.getTracks()[0]}},{key:"_stopStreamEffect",value:function(){this._streamEffect&&(this._streamEffect.stopEffect(),this._setStream(this._originalStream),this._originalStream=null,this.track=this.stream?this.stream.getTracks()[0]:null)}},{key:"_switchStreamEffect",value:function(e){this._streamEffect&&(this._stopStreamEffect(),this._streamEffect=void 0),e&&this._startStreamEffect(e)}},{key:"setEffect",value:function(e){var t=this;if("undefined"===typeof this._streamEffect&&"undefined"===typeof e)return Promise.resolve();if("undefined"!==typeof e&&!e.isEnabled(this))return Promise.reject(new Error("Incompatible effect instance!"));if(!0===this._setEffectInProgress)return Promise.reject(new Error("setEffect already in progress!"));if(this.isMuted()&&!this.isAudioTrack())return this._streamEffect=e,Promise.resolve();var n=this.conference;return n?(this._setEffectInProgress=!0,n.removeTrack(this).then((function(){return t._switchStreamEffect(e),t.isVideoTrack()&&t.containers.forEach((function(e){return T.a.attachMediaStream(e,t.stream)})),n.addTrack(t)})).then((function(){t._setEffectInProgress=!1})).catch((function(e){throw t._setEffectInProgress=!1,t._switchStreamEffect(),k.error("Failed to switch to the new stream!",e),e}))):(this._switchStreamEffect(e),this.isVideoTrack()&&this.containers.forEach((function(e){return T.a.attachMediaStream(e,t.stream)})),Promise.resolve())}},{key:"mute",value:function(){return this._queueSetMuted(!0)}},{key:"unmute",value:function(){return this._queueSetMuted(!1)}},{key:"_queueSetMuted",value:function(e){var t=this._setMuted.bind(this,e);return this._prevSetMuted=this._prevSetMuted.then(t,t),this._prevSetMuted}},{key:"_setMuted",value:function(e){var t=this;if(this.isMuted()===e)return Promise.resolve();if(this.disposed)return Promise.reject(new p.a(h.TRACK_IS_DISPOSED));var n=Promise.resolve(),i=function(){return k.info("Mute ".concat(t,": ").concat(e))};if(this.isAudioTrack()||this.videoType===S.a.DESKTOP||!O.a.doesVideoMuteByStreamRemove())i(),this._streamEffect&&this._streamEffect.setMuted?this._streamEffect.setMuted(e):this.track&&(this.track.enabled=!e);else if(e)n=new Promise((function(e,n){i(),t._removeStreamFromConferenceAsMute((function(){t._streamEffect&&t._stopStreamEffect(),t._unregisterHandlers(),t.stopStream(),t._setStream(null),e()}),n)}));else{i();var o={cameraDeviceId:this.getDeviceId(),devices:[g.VIDEO],effects:this._streamEffect?[this._streamEffect]:[],facingMode:this.getCameraFacingMode()};n=(n=T.a.obtainAudioAndVideoPermissions(Object.assign({},o,{constraints:{video:this._constraints}}))).then((function(e){var n=t.getType()===g.PRESENTER?g.VIDEO:t.getType(),i=e.find((function(e){return e.track.kind===n}));if(!i)throw new p.a(h.TRACK_NO_STREAM_FOUND);return t._setStream(i.stream),t.track=i.track,t.videoType!==i.videoType&&(k.warn("".concat(t,": video type has changed after unmute!"),t.videoType,i.videoType),t.videoType=i.videoType),t._streamEffect&&t._startStreamEffect(t._streamEffect),t.containers.map((function(e){return T.a.attachMediaStream(e,t.stream)})),t._addStreamToConferenceAsUnmute()}))}return n.then((function(){t._sendMuteStatus(e),t.emit(f.TRACK_MUTE_CHANGED,t)}))}},{key:"_addStreamToConferenceAsUnmute",value:function(){var e=this;return this.conference?new Promise((function(t,n){e.conference._addLocalTrackAsUnmute(e).then(t,(function(e){return n(new Error(e))}))})):Promise.resolve()}},{key:"_removeStreamFromConferenceAsMute",value:function(e,t){this.conference?this.conference._removeLocalTrackAsMute(this).then(e,(function(e){return t(new Error(e))})):e()}},{key:"_sendMuteStatus",value:function(e){this.conference&&this.conference._setTrackMuteStatus(this,e)&&this.conference.room.sendPresence()}},{key:"dispose",value:function(){var e=this,t=Promise.resolve();return this._streamEffect&&(t=this.setEffect()),this.conference&&(t=t.then((function(){return e.conference.removeTrack(e)}))),this.stream&&(this.stopStream(),this.detach()),T.a.removeListener(y.a.DEVICE_LIST_WILL_CHANGE,this._onDeviceListWillChange),this._onAudioOutputDeviceChanged&&T.a.removeListener(y.a.AUDIO_OUTPUT_DEVICE_CHANGED,this._onAudioOutputDeviceChanged),t.then((function(){return Object(s.a)(Object(c.a)(n.prototype),"dispose",e).call(e)}))}},{key:"isMuted",value:function(){return!this.stream||(!(!this.isVideoTrack()||this.isActive())||(this._streamEffect&&this._streamEffect.isMuted?this._streamEffect.isMuted():!this.track||!this.track.enabled))}},{key:"_setConference",value:function(e){this.conference=e;for(var t=0;t<this.containers.length;t++)this._maybeFireTrackAttached(this.containers[t])}},{key:"isLocal",value:function(){return!0}},{key:"getDeviceId",value:function(){return this._realDeviceId||this.deviceId}},{key:"getParticipantId",value:function(){return this.conference&&this.conference.myUserId()}},{key:"_onByteSentStatsReceived",value:function(e,t){var n=this;t>0&&(this._hasSentData=!0);var i=e.getConnectionState();this._testDataSent&&"connected"===i&&(setTimeout((function(){n._hasSentData||(k.warn("".concat(n," 'bytes sent' <= 0:                         ").concat(t)),C.a.analytics.sendEvent(E.r,{media_type:n.getType()}))}),3e3),this._testDataSent=!1)}},{key:"getCameraFacingMode",value:function(){if(this.isVideoTrack()&&this.videoType===S.a.CAMERA){var e,t,n=null===(e=(t=this.track).getSettings)||void 0===e?void 0:e.call(t);return n&&"facingMode"in n?n.facingMode:"undefined"!==typeof this._facingMode?this._facingMode:v.a.USER}}},{key:"stopStream",value:function(){this._stopStreamInProgress=!0;try{T.a.stopMediaStream(this.stream)}finally{this._stopStreamInProgress=!1}}},{key:"_switchCamera",value:function(){this.isVideoTrack()&&this.videoType===S.a.CAMERA&&"function"===typeof this.track._switchCamera&&(this.track._switchCamera(),this._facingMode=this._facingMode===v.a.ENVIRONMENT?v.a.USER:v.a.ENVIRONMENT)}},{key:"isReceivingData",value:function(){return!(!this.isVideoTrack()||!this.isMuted()&&!this._stopStreamInProgress&&this.videoType!==S.a.DESKTOP)||!!this.stream&&(this._effectEnabled?this._originalStream:this.stream).getTracks().some((function(e){return(!("readyState"in e)||"live"===e.readyState)&&(!("muted"in e)||!0!==e.muted)}))}},{key:"toString",value:function(){return"LocalTrack[".concat(this.rtcId,",").concat(this.getType(),"]")}}]),n}(j.a)}).call(this,"/index.js")},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n(38),o=n.n(i),a=n(65),r=n(6),s=n(8),c=n(21),l=n(34),u=n(33),d=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(r.a)(this,n),t.call(this,e,{sharedKey:!0})}return Object(s.a)(n,[{key:"setKey",value:function(e){this.e2eeCtx.setKey(void 0,{encryptionKey:e.encryptionKey},e.index)}}]),n}(n(227).a),p=n(363),h=n(193),f=function(){function e(t){Object(r.a)(this,e);var n=t.options.config.e2ee,i=void 0===n?{}:n;this._externallyManaged=i.externallyManagedKey,this._externallyManaged?this._keyHandler=new d(t):this._keyHandler=new p.a(t)}return Object(s.a)(e,[{key:"isEnabled",value:function(){return this._keyHandler.isEnabled()}},{key:"setEnabled",value:function(){var e=Object(a.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._keyHandler.setEnabled(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setEncryptionKey",value:function(e){this._keyHandler.setKey(e)}}],[{key:"isSupported",value:function(e){var t=e.e2ee;return!(!(void 0===t?{}:t).externallyManagedKey&&!h.a.isSupported())&&(!(e.testing&&e.testing.disableE2EE)&&(c.a.supportsInsertableStreams()||e.enableEncodedTransformSupport&&c.a.supportsEncodedTransform()))}}]),e}()},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(73),o=n(32);function a(e,t){if(!t)return!1;if(e.length!==t.length)return!1;for(var n=0,i=e.length;n<i;n++)if(e[n]instanceof Array&&t[n]instanceof Array){if(!e[n].equals(t[n]))return!1}else if(e[n]!==t[n])return!1;return!0}function r(e,t){if(this.mySDP=e,this.otherSDP=t,!e)throw new Error('"mySDP" is undefined!');if(!t)throw new Error('"otherSDP" is undefined!')}r.prototype.getNewMedia=function(){var e=this.mySDP.getMediaSsrcMap(),t=this.otherSDP.getMediaSsrcMap(),n={};return Object.keys(t).forEach((function(i){var o=e[i],r=t[i];o||!r?(Object.keys(r.ssrcs).forEach((function(e){if(-1===Object.keys(o.ssrcs).indexOf(e))n[i]||(n[i]={mediaindex:r.mediaindex,mid:r.mid,ssrcs:{},ssrcGroups:[]}),n[i].ssrcs[e]=r.ssrcs[e];else if(r.ssrcs[e].lines&&o.ssrcs[e].lines){void 0!==o.ssrcs[e].lines.find((function(e){return-1!==e.indexOf("msid")}))!==(void 0!==r.ssrcs[e].lines.find((function(e){return-1!==e.indexOf("msid")})))&&(n[i]||(n[i]={mediaindex:r.mediaindex,mid:r.mid,ssrcs:{},ssrcGroups:[]}),n[i].ssrcs[e]=r.ssrcs[e])}})),r.ssrcGroups.forEach((function(e){for(var t=!1,s=0;s<o.ssrcGroups.length;s++){var c=o.ssrcGroups[s];if(e.semantics===c.semantics&&a(e.ssrcs,c.ssrcs)){t=!0;break}}t||(n[i]||(n[i]={mediaindex:r.mediaindex,mid:r.mid,ssrcs:{},ssrcGroups:[]}),n[i].ssrcGroups.push(e))}))):n[i]=r})),n},r.prototype.toJingle=function(e){var t=this.getNewMedia(),n=!1;return Object.keys(t).forEach((function(a){n=!0;var r=t[a];e.c("content",{name:r.mid}),e.c("description",{xmlns:"urn:xmpp:jingle:apps:rtp:1",media:r.mid}),Object.keys(r.ssrcs).forEach((function(t){var n=r.ssrcs[t],a=n.lines,s=o.a.parseSourceNameLine(a);e.c("source",{xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"}),e.attrs({name:i.a.isSourceNameSignalingEnabled()?s:void 0,ssrc:n.ssrc});var c=o.a.parseMSIDAttribute(a);c&&(e.c("parameter"),e.attrs({name:"msid"}),e.attrs({value:c}),e.up()),e.up()})),r.ssrcGroups.forEach((function(t){t.ssrcs.length&&(e.c("ssrc-group",{semantics:t.semantics,xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"}),t.ssrcs.forEach((function(t){e.c("source",{ssrc:t}).up()})),e.up())})),e.up(),e.up()})),n}},,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i,o,a=n(23),r=n(6),s=n(8),c=n(10),l=(n(84),n(30)),u=n(2),d=(i=function(){function e(){Object(r.a)(this,e),this.apiVersion=void 0,Object(a.a)(this,"state",o,this),Object(u.g)(this),this.apiVersion="INVALID",this.state=l.a.DISCONNECTED}return Object(s.a)(e,[{key:"changeState",value:function(e){this.state=e}}]),e}(),o=Object(c.a)(i.prototype,"state",[u.h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(c.a)(i.prototype,"changeState",[u.b],Object.getOwnPropertyDescriptor(i.prototype,"changeState"),i.prototype),i);t.a=new d},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=config.corsProxyUrl||"https://binaural.me/cors_proxy/";function o(e){var t=e;return["http://","https://"].forEach((function(n){e.substring(0,n.length)===n&&(t=e.substring(n.length))})),t="".concat(i).concat(t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));window.AudioContext=window.AudioContext||window.webkitAudioContext;var i=null;function o(e,t,n){this.stream=e,this.intervalId=null,this.intervalMilis=t,this.audioLevel=0,this.callback=n}window.AudioContext&&(i=new AudioContext).suspend&&i.suspend(),o.prototype.start=function(){var e=this;if(o.isLocalStatsSupported()){i.resume();var t=i.createAnalyser();t.smoothingTimeConstant=.8,t.fftSize=2048,i.createMediaStreamSource(this.stream).connect(t),this.intervalId=setInterval((function(){var n=new Uint8Array(t.frequencyBinCount);t.getByteTimeDomainData(n);var i=function(e){for(var t=0,n=e.length,i=0;i<n;i++)t<e[i]&&(t=e[i]);return parseFloat(((t-127)/128).toFixed(3))}(n);e.audioLevel=function(e,t){var n=t-e;return parseFloat((n>.2?t-.2:n<-.4?t+.4:e).toFixed(3))}(i,e.audioLevel),e.callback(e.audioLevel)}),this.intervalMilis)}},o.prototype.stop=function(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)},o.isLocalStatsSupported=function(){return Boolean(i)}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return S}));var i=n(14),o=n(38),a=n.n(o),r=n(65),s=n(6),c=n(8),l=n(25),u=n(34),d=n(33),p=n(22),h=n(12),f=n(31),m=n.n(f),v=n(21),g=n(159),b=n(72),y=n(362),A=Object(p.getLogger)(e),S=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(s.a)(this,n),(i=t.call(this)).conference=e,i.e2eeCtx=new y.a(o),i.enabled=!1,i._enabling=void 0,i.conference.on(h._MEDIA_SESSION_STARTED,i._onMediaSessionStarted.bind(Object(l.a)(i))),i.conference.on(h.TRACK_ADDED,(function(e){return e.isLocal()&&i._onLocalTrackAdded(e)})),i.conference.rtc.on(m.a.REMOTE_TRACK_ADDED,(function(e,t){return i._setupReceiverE2EEForTrack(t,e)})),i.conference.on(h.TRACK_MUTE_CHANGED,i._trackMuteChanged.bind(Object(l.a)(i))),i}return Object(c.a)(n,[{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(){var e=Object(r.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==this.enabled){e.next=2;break}return e.abrupt("return");case 2:if(e.t0=this._enabling,!e.t0){e.next=6;break}return e.next=6,this._enabling;case 6:if(this._enabling=new g.a,this.enabled=t,t||this.e2eeCtx.cleanupAll(),e.t1=this._setEnabled,!e.t1){e.next=13;break}return e.next=13,this._setEnabled(t);case 13:this.conference.setLocalParticipantProperty("e2ee.enabled",t),this.conference._restartMediaSessions(),this._enabling.resolve();case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setEncryptionKey",value:function(){throw new Error("Not implemented by subclass")}},{key:"_onLocalTrackAdded",value:function(e){var t,n=Object(i.a)(this.conference._getMediaSessions());try{for(n.s();!(t=n.n()).done;){var o=t.value;this._setupSenderE2EEForTrack(o,e)}}catch(a){n.e(a)}finally{n.f()}}},{key:"_onMediaSessionStarted",value:function(e){var t,n=this.conference.getLocalTracks(),o=Object(i.a)(n);try{for(o.s();!(t=o.n()).done;){var a=t.value;this._setupSenderE2EEForTrack(e,a)}}catch(r){o.e(r)}finally{o.f()}}},{key:"_setupReceiverE2EEForTrack",value:function(e,t){if(this.enabled){var n=e.findReceiverForTrack(t.track);n?this.e2eeCtx.handleReceiver(n,t.getType(),t.getParticipantId()):A.warn("Could not handle E2EE for ".concat(t,": receiver not found in: ").concat(e))}}},{key:"_setupSenderE2EEForTrack",value:function(e,t){if(this.enabled){var n=e.peerconnection,i=n&&n.findSenderForTrack(t.track);i?this.e2eeCtx.handleSender(i,t.getType(),t.getParticipantId()):A.warn("Could not handle E2EE for ".concat(t,": sender not found in ").concat(n))}}},{key:"_trackMuteChanged",value:function(e){if(v.a.doesVideoMuteByStreamRemove()&&e.isLocal()&&e.isVideoTrack()&&!e.isMuted()){var t,n=Object(i.a)(this.conference._getMediaSessions());try{for(n.s();!(t=n.n()).done;){var o=t.value;this._setupSenderE2EEForTrack(o,e)}}catch(a){n.e(a)}finally{n.f()}}}}]),n}(b.a)}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return T})),n.d(t,"a",(function(){return _}));var i=n(6),o=n(8),a=n(25),r=n(34),s=n(33),c=n(22),l=n(109),u=n.n(l),d=n(15),p=n(229),h=n(20),f=n(11),m=n.n(f),v=n(43),g=n.n(v),b=n(72),y=n(369),A=n(370),S=n(371),E=n(137),O=n(372),C=Object(c.getLogger)(e),j={packet2JSON:function(e,t){for(var n=0,i=Array.from(e.children);n<i.length;n++){for(var o=i[n],a={attributes:{},children:[],tagName:o.tagName},r=0,s=Array.from(o.attributes);r<s.length;r++){var c=s[r];a.attributes[c.name]=c.value}var l=d.Strophe.getText(o);l&&(a.value=d.Strophe.xmlunescape(l)),t.push(a),this.packet2JSON(o,a.children)}},json2packet:function(e,t){for(var n=0;n<e.length;n++){var i=e[n];i&&(t.c(i.tagName,i.attributes),i.value&&t.t(i.value),i.children&&this.json2packet(i.children,t),t.up())}}};function T(e,t){for(var n=[],i=0;i<e.length;i++)e[i].tagName===t&&n.push(e[i]);return n}var k=["owner","admin","member"],_=function(e){Object(r.a)(n,e);var t=Object(s.a)(n);function n(e,o,r,s,c){var l;return Object(i.a)(this,n),(l=t.call(this)).xmpp=s,l.connection=e,l.roomjid=d.Strophe.getBareJidFromJid(o),l.myroomjid=o,l.password=r,l.replaceParticipant=!1,C.info("Joined MUC as ".concat(l.myroomjid)),l.members={},l.presMap={},l.presHandlers={},l._removeConnListeners=[],l.joined=!1,l.inProgressEmitted=!1,l.role=null,l.focusMucJid=null,l.noBridgeAvailable=!1,l.options=c||{},l.moderator=new O.a(l.roomjid,l.xmpp,l.eventEmitter,{connection:l.xmpp.options,conference:l.options}),("undefined"===typeof l.options.enableLobby||l.options.enableLobby)&&(l.lobby=new S.a(Object(a.a)(l))),l.avModeration=new y.a(Object(a.a)(l)),l.breakoutRooms=new A.a(Object(a.a)(l)),l.initPresenceMap(c),l.lastPresences={},l.phoneNumber=null,l.phonePin=null,l.connectionTimes={},l.participantPropertyListener=null,l.locked=!1,l.transcriptionStatus=p.OFF,l}return Object(o.a)(n,[{key:"initPresenceMap",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.presMap.to=this.myroomjid,this.presMap.xns="http://jabber.org/protocol/muc",this.presMap.nodes=[],e.statsId&&this.presMap.nodes.push({tagName:"stats-id",value:e.statsId}),e.deploymentInfo&&e.deploymentInfo.userRegion&&this.presMap.nodes.push({tagName:"region",attributes:{id:e.deploymentInfo.userRegion,xmlns:"http://jitsi.org/jitsi-meet"}}),this.presenceUpdateTime=Date.now()}},{key:"join",value:function(e,t){var n=this;return this.password=e,this.replaceParticipant=t,new Promise((function(e){n.options.disableFocus&&C.info("Conference focus disabled for ".concat(n.roomjid)),(n.options.disableFocus?Promise.resolve():n.moderator.allocateConferenceFocus()).then((function(){n.sendPresence(!0),n._removeConnListeners.push(n.connection.addEventListener(E.a.Events.CONN_STATUS_CHANGED,n.onConnStatusChanged.bind(n))),e()}))}))}},{key:"sendPresence",value:function(e){var t=this.presMap.to;if(this.connection&&this.connection.connected&&t&&(this.joined||e)){var n=Object(d.$pres)({to:t});e&&(this.replaceParticipant&&n.c("flip_device").up(),n.c("x",{xmlns:this.presMap.xns}),this.password&&n.c("password").t(this.password).up(),this.options.billingId&&n.c("billingid").t(this.options.billingId).up(),n.up()),j.json2packet(this.presMap.nodes,n),this.presenceSyncTime=Date.now(),this.connection.send(n),e&&this.connection.flush()}}},{key:"doLeave",value:function(){C.log("do leave",this.myroomjid);var e=Object(d.$pres)({to:this.myroomjid,type:"unavailable"});this.presMap.length=0,!this.connection.isUsingWebSocket&&this.connection.flush(),this.connection.send(e),this.connection.flush()}},{key:"discoRoomInfo",value:function(){var e=this,t=Object(d.$iq)({type:"get",to:this.roomjid}).c("query",{xmlns:d.Strophe.NS.DISCO_INFO});this.connection.sendIQ(t,(function(t){var n=1===$(t).find('>query>feature[var="muc_passwordprotected"]').length;n!==e.locked&&(e.eventEmitter.emit(m.a.MUC_LOCK_CHANGED,n),e.locked=n);var i=$(t).find('>query>x[type="result"]>field[var="muc#roominfo_meetingId"]>value');i.length?e.setMeetingId(i.text()):C.warn("No meeting ID from backend");var o=1===$(t).find('>query>feature[var="muc_membersonly"]').length,a=$(t).find('>query>x[type="result"]>field[var="muc#roominfo_lobbyroom"]>value');e.lobby&&e.lobby.setLobbyRoomJid(a&&a.length?a.text():void 0);var r=$(t).find('>query>x[type="result"]>field[var="muc#roominfo_isbreakout"]>value'),s=Boolean(null===r||void 0===r?void 0:r.text());e.breakoutRooms._setIsBreakoutRoom(s);var c=$(t).find('>query>x[type="result"]>field[var="muc#roominfo_breakout_main_room"]>value');null!==c&&void 0!==c&&c.length&&e.breakoutRooms._setMainRoomJid(c.text()),o!==e.membersOnlyEnabled&&(e.membersOnlyEnabled=o,e.eventEmitter.emit(m.a.MUC_MEMBERS_ONLY_CHANGED,o))}),(function(e){g.a.callErrorHandler(e),C.error("Error getting room info: ",e)}))}},{key:"setMeetingId",value:function(e){this.meetingId!==e&&(this.meetingId&&C.warn("Meeting Id changed from:".concat(this.meetingId," to:").concat(e)),this.meetingId=e,this.eventEmitter.emit(m.a.MEETING_ID_SET,e))}},{key:"createNonAnonymousRoom",value:function(){var e=this;if(!this.options.disableDiscoInfo){var t=Object(d.$iq)({type:"get",to:this.roomjid}).c("query",{xmlns:"http://jabber.org/protocol/muc#owner"}).c("x",{xmlns:"jabber:x:data",type:"submit"});this.connection.sendIQ(t,(function(t){if(!$(t).find('>query>x[xmlns="jabber:x:data"]>field[var="muc#roomconfig_whois"]').length){var n="non-anonymous rooms not supported";return g.a.callErrorHandler(new Error(n)),void C.error(n)}var i=Object(d.$iq)({to:e.roomjid,type:"set"}).c("query",{xmlns:"http://jabber.org/protocol/muc#owner"});i.c("x",{xmlns:"jabber:x:data",type:"submit"}),i.c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#roomconfig").up().up(),i.c("field",{var:"muc#roomconfig_whois"}).c("value").t("anyone").up().up(),e.connection.sendIQ(i)}),(function(e){g.a.callErrorHandler(e),C.error("Error getting room configuration form: ",e)}))}}},{key:"onConnStatusChanged",value:function(e){e===E.a.Status.CONNECTED&&this.sendPresence()}},{key:"onPresence",value:function(e){var t=e.getAttribute("from"),n={},i=e.getElementsByTagName("status")[0];i&&(n.status=i.textContent||"");var o=!1,a=!1,r=e.getElementsByTagNameNS("http://jabber.org/protocol/muc#user","x")[0],s=r&&r.getElementsByTagName("item")[0];n.isReplaceParticipant=e.getElementsByTagName("flip_device").length,n.affiliation=s&&s.getAttribute("affiliation"),n.role=s&&s.getAttribute("role");var c=s&&s.getAttribute("jid");n.jid=c,n.isFocus=c&&0===c.indexOf("".concat(this.moderator.getFocusUserJid(),"/")),n.isHiddenDomain=c&&c.indexOf("@")>0&&this.options.hiddenDomain===c.substring(c.indexOf("@")+1,c.indexOf("/")),this.eventEmitter.emit(m.a.PRESENCE_RECEIVED,{fromHiddenDomain:n.isHiddenDomain,presence:e});var l=e.querySelector("x");l&&l.remove();var p=[];j.packet2JSON(e,p),this.lastPresences[t]=p;for(var h=function(e){var t={},n=e.children.find((function(e){return"user"===e.tagName}));if(n){t.user={};for(var i=function(){var e=a[o],i=n.children.find((function(t){return t.tagName===e}));i&&(t.user[e]=i.value)},o=0,a=["id","name","avatar"];o<a.length;o++)i()}var r=e.children.find((function(e){return"group"===e.tagName}));return r&&(t.group=r.value),t},f=0;f<p.length;f++){var v=p[f];switch(v.tagName){case"bot":var g=v.attributes;if(!g)break;var b=g.type;n.botType=b;break;case"nick":n.nick=v.value;break;case"userId":n.id=v.value;break;case"stats-id":n.statsID=v.value;break;case"identity":n.identity=h(v);break;case"features":n.features=this._extractFeatures(v);break;case"stat":var y=v.attributes;if(!y)break;"version"===y.name&&(n.version=y.value)}}if(!this.joined&&!this.inProgressEmitted){var A=this.connectionTimes["muc.join.started"]=window.performance.now();C.log("(TIME) MUC join started:\t",A),this.eventEmitter.emit(m.a.MUC_JOIN_IN_PROGRESS),this.inProgressEmitted=!0}if(t===this.myroomjid){var S="owner"===n.affiliation?n.role:"none";if(this.role!==S&&(this.role=S,this.eventEmitter.emit(m.a.LOCAL_ROLE_CHANGED,this.role)),!this.joined){this.joined=!0;var E=this.connectionTimes["muc.joined"]=window.performance.now();C.log("(TIME) MUC joined:\t",E),this.password&&(this.locked=!0),this.presenceUpdateTime>=this.presenceSyncTime&&this.sendPresence(),this.eventEmitter.emit(m.a.MUC_JOINED),!this.options.disableDiscoInfo&&this.discoRoomInfo()}}else if(void 0===c)C.info("Ignoring member with undefined JID");else if(void 0===this.members[t])this.members[t]=n,C.log("entered",t,n),o=void 0!==n.status,a=void 0!==n.version,n.isFocus?this._initFocus(t,n.features):(this.eventEmitter.emit(m.a.MUC_MEMBER_JOINED,t,n.nick,n.role,n.isHiddenDomain,n.statsID,n.status,n.identity,n.botType,n.jid,n.features,n.isReplaceParticipant),o=!1);else{var O=this.members[t];O.role!==n.role&&(O.role=n.role,this.eventEmitter.emit(m.a.MUC_ROLE_CHANGED,t,n.role)),O.affiliation!==n.affiliation&&(O.affiliation=n.affiliation),O.botType!==n.botType&&(O.botType=n.botType,this.eventEmitter.emit(m.a.MUC_MEMBER_BOT_TYPE_CHANGED,t,n.botType)),n.isFocus&&(O.isFocus=!0,this._initFocus(t,n.features)),n.displayName&&(O.displayName=n.displayName),O.status!==n.status&&(o=!0,O.status=n.status),O.version!==n.version&&(a=!0,O.version=n.version),u()(O.features,n.features)||(O.features=n.features,this.eventEmitter.emit(m.a.PARTICIPANT_FEATURES_CHANGED,t,n.features))}for(var T=0;T<p.length;T++){var k=p[T];switch(k.tagName){case"nick":if(!n.isFocus){var _=this.xmpp.options.displayJids?d.Strophe.getResourceFromJid(t):n.nick;this.eventEmitter.emit(m.a.DISPLAY_NAME_CHANGED,t,_)}break;case"bridgeNotAvailable":n.isFocus&&!this.noBridgeAvailable&&(this.noBridgeAvailable=!0,this.eventEmitter.emit(m.a.BRIDGE_DOWN));break;case"conference-properties":if(n.isFocus){for(var R={},I=0;I<k.children.length;I++){var w=k.children[I].attributes;w&&w.key&&(R[w.key]=w.value)}this.eventEmitter.emit(m.a.CONFERENCE_PROPERTIES_CHANGED,R),"undefined"===typeof this.restartByTerminateSupported&&(this.restartByTerminateSupported="true"===R["support-terminate-restart"],C.info("Jicofo supports restart by terminate: ".concat(this.supportsRestartByTerminate())))}break;case"transcription-status":var D=k.attributes;if(!D)break;var P=D.status;P&&P!==this.transcriptionStatus&&(this.transcriptionStatus=P,this.eventEmitter.emit(m.a.TRANSCRIPTION_STATUS_CHANGED,P));break;case"call-control":var M=k.attributes;if(!M)break;this.phoneNumber=M.phone||null,this.phonePin=M.pin||null,this.eventEmitter.emit(m.a.PHONE_NUMBER_CHANGED);break;default:this.processNode(k,t)}}o&&this.eventEmitter.emit(m.a.PRESENCE_STATUS,t,n.status),a&&C.info("Received version for ".concat(c,": ").concat(n.version))}},{key:"_extractFeatures",value:function(e){for(var t=new Set,n=0;n<e.children.length;n++){var i=e.children[n].attributes;i&&i.var&&t.add(i.var)}return t}},{key:"_initFocus",value:function(e,t){this.focusMucJid=e,this.focusFeatures=t}},{key:"setParticipantPropertyListener",value:function(e){this.participantPropertyListener=e}},{key:"supportsRestartByTerminate",value:function(){return this.restartByTerminateSupported}},{key:"processNode",value:function(e,t){try{var n=this.presHandlers[e.tagName];e.tagName.startsWith("jitsi_participant_")&&(n=[this.participantPropertyListener]),n&&n.forEach((function(n){n(e,d.Strophe.getResourceFromJid(t),t)}))}catch(i){g.a.callErrorHandler(i),C.error("Error processing:".concat(e.tagName," node."),i)}}},{key:"sendMessage",value:function(e,t){var n=Object(d.$msg)({to:this.roomjid,type:"groupchat"});"body"===t?n.c(t,{},e):n.c(t,{xmlns:"http://jitsi.org/jitmeet"},e),this.connection.send(n),this.eventEmitter.emit(m.a.SENDING_CHAT_MESSAGE,e)}},{key:"sendPrivateMessage",value:function(e,t,n){var i=Object(d.$msg)({to:"".concat(this.roomjid,"/").concat(e),type:"chat"});"body"===n?i.c(n,t).up():i.c(n,{xmlns:"http://jitsi.org/jitmeet"},t).up(),this.connection.send(i),this.eventEmitter.emit(m.a.SENDING_PRIVATE_CHAT_MESSAGE,t)}},{key:"setSubject",value:function(e){var t=Object(d.$msg)({to:this.roomjid,type:"groupchat"});t.c("subject",e),this.connection.send(t)}},{key:"onParticipantLeft",value:function(e,t){delete this.lastPresences[e],t||(this.eventEmitter.emit(m.a.MUC_MEMBER_LEFT,e),this.moderator.onMucMemberLeft(e))}},{key:"onPresenceUnavailable",value:function(e,t){var n=this;if($(e).find('>ignore[xmlns="http://jitsi.org/jitmeet/"]').length)return!0;var i=$(e).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>destroy');if(i.length){var o,a=$(e).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>destroy>reason');return a.length&&(o=a.text()),this.eventEmitter.emit(m.a.MUC_DESTROYED,o,i.attr("jid")),this.connection.emuc.doLeave(this.roomjid),!0}var r=$(e).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>status[code="110"]').length,s=$(e).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>status[code="307"]').length,c=Object.keys(this.members),l=$(e).find("flip_device").length;if(s){var u,p,h=$(e).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>item>actor');h.length&&(u=h.attr("nick"));var f=$(e).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>item>reason');f.length&&(p=f.text()),this.eventEmitter.emit(m.a.KICKED,r,u,d.Strophe.getResourceFromJid(t),p,l)}r?(c.forEach((function(e){var t=n.members[e];delete n.members[e],n.onParticipantLeft(e,t.isFocus)})),this.connection.emuc.doLeave(this.roomjid),s||this.eventEmitter.emit(m.a.MUC_LEFT)):(delete this.members[t],this.onParticipantLeft(t,!1))}},{key:"onMessage",value:function(e,t){var n=e.getAttribute("type");if("error"===n){var i=$(e).find(">error>text").text();return this.eventEmitter.emit(m.a.CHAT_ERROR_RECEIVED,i),!0}var o=$(e).find(">body").text(),a=$(e).find(">subject");if(a.length){var r=a.text();(r||""===r)&&(this.eventEmitter.emit(m.a.SUBJECT_CHANGED,r),C.log("Subject is changed to ".concat(r)))}var s,c=$(e).find(">delay").attr("stamp");if(!c&&(c=$(e).find('>[xmlns="jabber:x:delay"]').attr("stamp"))){var l=c.match(/(\d{4})(\d{2})(\d{2}T\d{2}:\d{2}:\d{2})/);c="".concat(l[1],"-").concat(l[2],"-").concat(l[3],"Z")}if(t===this.roomjid)if($(e).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>status[code="104"]').length)this.discoRoomInfo();else if((s=$(e).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>invite'))&&s.length){var u,d=$(e).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>password');d&&d.length&&(u=d.text()),this.eventEmitter.emit(m.a.INVITE_MESSAGE_RECEIVED,t,s.attr("from"),o,u)}var p=$(e).find(">json-message").text();if(p){var h=this.xmpp.tryParseJSONAndVerify(p);if(h&&void 0===c)return void this.eventEmitter.emit(m.a.JSON_MESSAGE_RECEIVED,t,h)}o&&("chat"===n?this.eventEmitter.emit(m.a.PRIVATE_MESSAGE_RECEIVED,t,o,this.myroomjid,c):"groupchat"===n&&this.eventEmitter.emit(m.a.MESSAGE_RECEIVED,t,o,this.myroomjid,c))}},{key:"onPresenceError",value:function(e,t){if($(e).find('>error[type="auth"]>not-authorized[xmlns="urn:ietf:params:xml:ns:xmpp-stanzas"]').length)C.log("on password required",t),this.eventEmitter.emit(m.a.PASSWORD_REQUIRED);else if($(e).find('>error[type="cancel"]>not-allowed[xmlns="urn:ietf:params:xml:ns:xmpp-stanzas"]').length){d.Strophe.getDomainFromJid(e.getAttribute("to"))===this.xmpp.options.hosts.anonymousdomain?this.eventEmitter.emit(m.a.ROOM_JOIN_ERROR):(C.warn("onPresError ",e),this.eventEmitter.emit(m.a.ROOM_CONNECT_NOT_ALLOWED_ERROR))}else if($(e).find(">error>service-unavailable").length)C.warn("Maximum users limit for the room has been reached",e),this.eventEmitter.emit(m.a.ROOM_MAX_USERS_ERROR);else if($(e).find('>error[type="auth"]>registration-required[xmlns="urn:ietf:params:xml:ns:xmpp-stanzas"]').length){var n,i=$(e).find(">lobbyroom");i.length&&(n=i.text()),this.eventEmitter.emit(m.a.ROOM_CONNECT_MEMBERS_ONLY_ERROR,n)}else C.warn("onPresError ",e),this.eventEmitter.emit(m.a.ROOM_CONNECT_ERROR)}},{key:"setAffiliation",value:function(e,t){var n=Object(d.$iq)({to:this.roomjid,type:"set"}).c("query",{xmlns:"http://jabber.org/protocol/muc#admin"}).c("item",{affiliation:t,nick:d.Strophe.getResourceFromJid(e)}).c("reason").t("Your affiliation has been changed to '".concat(t,"'.")).up().up().up();this.connection.sendIQ(n,(function(n){return C.log("Set affiliation of participant with jid: ",e,"to",t,n)}),(function(e){return C.log("Set affiliation of participant error: ",e)}))}},{key:"kick",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"You have been kicked.",n=Object(d.$iq)({to:this.roomjid,type:"set"}).c("query",{xmlns:"http://jabber.org/protocol/muc#admin"}).c("item",{nick:d.Strophe.getResourceFromJid(e),role:"none"}).c("reason").t(t).up().up().up();this.connection.sendIQ(n,(function(t){return C.log("Kick participant with jid: ",e,t)}),(function(e){return C.log("Kick participant error: ",e)}))}},{key:"lockRoom",value:function(e,t,n,i){var o=this;this.connection.sendIQ(Object(d.$iq)({to:this.roomjid,type:"get"}).c("query",{xmlns:"http://jabber.org/protocol/muc#owner"}),(function(a){if($(a).find('>query>x[xmlns="jabber:x:data"]>field[var="muc#roomconfig_roomsecret"]').length){var r=Object(d.$iq)({to:o.roomjid,type:"set"}).c("query",{xmlns:"http://jabber.org/protocol/muc#owner"});r.c("x",{xmlns:"jabber:x:data",type:"submit"}),r.c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#roomconfig").up().up(),r.c("field",{var:"muc#roomconfig_roomsecret"}).c("value").t(e).up().up(),r.c("field",{var:"muc#roomconfig_passwordprotectedroom"}).c("value").t(null===e||0===e.length?"0":"1").up().up(),o.membersOnlyEnabled&&r.c("field",{var:"muc#roomconfig_membersonly"}).c("value").t("true").up().up(),r.c("field",{var:"muc#roomconfig_whois"}).c("value").t("anyone").up().up(),o.connection.sendIQ(r,(function(){o.password=e,t()}),n)}else i()}),n)}},{key:"setMembersOnly",value:function(e,t,n){var i=this;e&&Object.values(this.members).filter((function(e){return!e.isFocus})).length&&Object.values(this.members).forEach((function(e){e.jid&&!k.includes(e.affiliation)&&i.xmpp.connection.sendIQ(Object(d.$iq)({to:i.roomjid,type:"set"}).c("query",{xmlns:"http://jabber.org/protocol/muc#admin"}).c("item",{affiliation:"member",jid:e.jid}).up().up())}));var o=n||function(){};this.xmpp.connection.sendIQ(Object(d.$iq)({to:this.roomjid,type:"get"}).c("query",{xmlns:"http://jabber.org/protocol/muc#owner"}),(function(n){if($(n).find('>query>x[xmlns="jabber:x:data"]>field[var="muc#roomconfig_membersonly"]').length){var a=Object(d.$iq)({to:i.roomjid,type:"set"}).c("query",{xmlns:"http://jabber.org/protocol/muc#owner"});a.c("x",{xmlns:"jabber:x:data",type:"submit"}),a.c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#roomconfig").up().up(),a.c("field",{var:"muc#roomconfig_membersonly"}).c("value").t(e?"true":"false").up().up(),i.locked&&a.c("field",{var:"muc#roomconfig_passwordprotectedroom"}).c("value").t("1").up().up(),i.xmpp.connection.sendIQ(a,t,o)}else o(new Error("Setting members only room not supported!"))}),o)}},{key:"addToPresence",value:function(e,t){return this.addOrReplaceInPresence(e,t)}},{key:"addOrReplaceInPresence",value:function(e,t){t.tagName=e;var n=this.presMap.nodes.filter((function(t){return e===t.tagName}));return(1!==n.length||!u()(n[0],t))&&(this.removeFromPresence(e),this.presMap.nodes.push(t),this.presenceUpdateTime=Date.now(),!0)}},{key:"getFromPresence",value:function(e){return this.presMap.nodes.find((function(t){return e===t.tagName}))}},{key:"removeFromPresence",value:function(e){var t=this.presMap.nodes.filter((function(t){return e!==t.tagName}));this.presMap.nodes=t,this.presenceUpdateTime=Date.now()}},{key:"addPresenceListener",value:function(e,t){if("function"!==typeof t)throw new Error('"handler" is not a function');var n=this.presHandlers[e];n||(this.presHandlers[e]=n=[]),-1===n.indexOf(t)?n.push(t):C.warn("Trying to add the same handler more than once for: ".concat(e))}},{key:"removePresenceListener",value:function(e,t){var n=this.presHandlers[e],i=n?n.indexOf(t):-1;-1!==i?n.splice(i,1):C.warn("Handler for: ".concat(e," was not registered"))}},{key:"isFocus",value:function(e){var t=this.members[e];return t?t.isFocus:null}},{key:"isModerator",value:function(){return"moderator"===this.role}},{key:"getMemberRole",value:function(e){return this.members[e]?this.members[e].role:null}},{key:"setVideoMute",value:function(e){this.sendVideoInfoPresence(e)}},{key:"setAudioMute",value:function(e){this.sendAudioInfoPresence(e)}},{key:"addAudioInfoToPresence",value:function(e){var t="audiomuted";return!(e&&!this.getFromPresence(t))&&this.addOrReplaceInPresence(t,{value:e.toString()})}},{key:"sendAudioInfoPresence",value:function(e){this.addAudioInfoToPresence(e)&&this.sendPresence()}},{key:"addVideoInfoToPresence",value:function(e){var t="videomuted";return!(e&&!this.getFromPresence(t))&&this.addOrReplaceInPresence(t,{value:e.toString()})}},{key:"sendVideoInfoPresence",value:function(e){this.addVideoInfoToPresence(e)&&this.sendPresence()}},{key:"getMediaPresenceInfo",value:function(e,t){var n=this.lastPresences["".concat(this.roomjid,"/").concat(e)];if(!n)return null;var i={muted:!0,videoType:void 0},o=null;if(t===h.AUDIO)o=T(n,"audiomuted");else{if(t!==h.VIDEO)return C.error("Unsupported media type: ".concat(t)),null;o=T(n,"videomuted");var a=T(n,"jitsi_participant_codecType"),r=T(n,"videoType");r.length>0&&(i.videoType=r[0].value),a.length>0&&(i.codecType=a[0].value)}return o.length>0&&(i.muted="true"===o[0].value),i}},{key:"getLastPresence",value:function(e){return this.lastPresences["".concat(this.roomjid,"/").concat(e)]}},{key:"isSIPCallingSupported",value:function(){return!!this.moderator&&this.moderator.isSipGatewayEnabled()}},{key:"dial",value:function(e){return this.connection.rayo.dial(e,"fromnumber",d.Strophe.getBareJidFromJid(this.myroomjid),this.password,this.focusMucJid)}},{key:"hangup",value:function(){return this.connection.rayo.hangup()}},{key:"getLobby",value:function(){return this.lobby}},{key:"getAVModeration",value:function(){return this.avModeration}},{key:"getBreakoutRooms",value:function(){return this.breakoutRooms}},{key:"getPhoneNumber",value:function(){return this.phoneNumber}},{key:"getPhonePin",value:function(){return this.phonePin}},{key:"getMeetingId",value:function(){return this.meetingId}},{key:"muteParticipant",value:function(e,t,n){C.info("set mute",t,e);var i=Object(d.$iq)({to:this.focusMucJid,type:"set"}).c("mute",{xmlns:"http://jitsi.org/jitmeet/".concat(n),jid:e}).t(t.toString()).up();this.connection.sendIQ(i,(function(e){return C.log("set mute",e)}),(function(e){return C.log("set mute error",e)}))}},{key:"onMute",value:function(e){if(e.getAttribute("from")===this.focusMucJid){var t=$(e).find("mute");t.length&&"true"===t.text()?this.eventEmitter.emit(m.a.AUDIO_MUTED_BY_FOCUS,t.attr("actor")):C.warn("Ignoring a mute request which does not explicitly specify a positive mute command.")}else C.warn("Ignored mute from non focus peer")}},{key:"onMuteVideo",value:function(e){if(e.getAttribute("from")===this.focusMucJid){var t=$(e).find("mute");t.length&&"true"===t.text()?this.eventEmitter.emit(m.a.VIDEO_MUTED_BY_FOCUS,t.attr("actor")):C.warn("Ignoring a mute request which does not explicitly specify a positive mute command.")}else C.warn("Ignored mute from non focus peer")}},{key:"clean",value:function(){this._removeConnListeners.forEach((function(e){return e()})),this._removeConnListeners=[],this.joined=!1,this.inProgressEmitted=!1}},{key:"leave",value:function(){var e,t=this;this.avModeration.dispose(),this.breakoutRooms.dispose();var n=[];return(null===(e=this.lobby)||void 0===e?void 0:e.lobbyRoom)&&n.push(this.lobby.leave()),n.push(new Promise((function(e,n){var i=-1,o=function o(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.eventEmitter.removeListener(m.a.MUC_LEFT,o),clearTimeout(i),a?(t.connection.emuc.doLeave(t.roomjid),n(new Error("The timeout for the confirmation about leaving the room expired."))):e()};i=setTimeout((function(){return o(!0)}),5e3),t.clean(),t.eventEmitter.on(m.a.MUC_LEFT,o),t.doLeave()}))),Promise.allSettled(n)}}]),n}(b.a)}).call(this,"/index.js")},function(e,t,n){"use strict";n.r(t),n.d(t,"ON",(function(){return i})),n.d(t,"OFF",(function(){return o}));var i="on",o="off"},function(e,t,n){"use strict";t.a={REMOTE_VIDEO_CONSTRAINTS_CHANGED:"media_session.REMOTE_VIDEO_CONSTRAINTS_CHANGED"}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return g}));var i=n(14),o=n(6),a=n(8),r=n(34),s=n(33),c=n(22),l=n(57),u=n.n(l),d=n(63),p=n(20),h=n(21),f=n(42),m=Object(c.getLogger)(e),v={track_mute:"onmute",track_unmute:"onunmute",track_ended:"onended"},g=function(e){Object(r.a)(n,e);var t=Object(s.a)(n);function n(e,i,a,r,s,c){var l;return Object(o.a)(this,n),(l=t.call(this)).addEventListener=l.addListener,l.removeEventListener=l.off=l.removeListener,l.containers=[],l.conference=e,l.audioLevel=-1,l.type=s,l.track=a,l.videoType=c,l.handlers=new Map,l.disposed=!1,l._streamInactiveHandler=r,l._setStream(i),l}return Object(a.a)(n,[{key:"_addMediaStreamInactiveHandler",value:function(e){h.a.isFirefox()?this.track.onended=e:this.stream.oninactive=e}},{key:"_setHandler",value:function(e,t){if(v.hasOwnProperty(e)){if(t?this.handlers.set(e,t):this.handlers.delete(e),this.stream){var n,o=Object(i.a)(this.stream.getTracks());try{for(o.s();!(n=o.n()).done;){n.value[v[e]]=t}}catch(a){o.e(a)}finally{o.f()}}}else m.error("Invalid handler type ".concat(e))}},{key:"_unregisterHandlers",value:function(){if(this.stream){var e,t=Object(i.a)(this.handlers.keys());try{for(t.s();!(e=t.n()).done;){var n,o=e.value,a=Object(i.a)(this.stream.getVideoTracks());try{for(a.s();!(n=a.n()).done;){n.value[v[o]]=void 0}}catch(r){a.e(r)}finally{a.f()}}}catch(r){t.e(r)}finally{t.f()}this._streamInactiveHandler&&this._addMediaStreamInactiveHandler(void 0)}else m.warn("".concat(this,": unable to unregister handlers - no stream object"))}},{key:"_setStream",value:function(e){if(this.stream!==e&&(this.stream=e,this.stream)){var t,n=Object(i.a)(this.handlers.keys());try{for(n.s();!(t=n.n()).done;){var o=t.value;this._setHandler(o,this.handlers.get(o))}}catch(a){n.e(a)}finally{n.f()}this._streamInactiveHandler&&this._addMediaStreamInactiveHandler(this._streamInactiveHandler)}}},{key:"getVideoType",value:function(){return this.videoType}},{key:"getType",value:function(){return this.type}},{key:"isAudioTrack",value:function(){return this.getType()===p.AUDIO}},{key:"isWebRTCTrackMuted",value:function(){return this.track&&this.track.muted}},{key:"isVideoTrack",value:function(){return this.getType()===p.VIDEO}},{key:"isLocal",value:function(){throw new Error("Not implemented by subclass")}},{key:"isLocalAudioTrack",value:function(){return this.isAudioTrack()&&this.isLocal()}},{key:"getOriginalStream",value:function(){return this.stream}},{key:"getStreamId",value:function(){return this.stream?this.stream.id:null}},{key:"getTrack",value:function(){return this.track}},{key:"getTrackLabel",value:function(){return this.track.label}},{key:"getTrackId",value:function(){return this.track?this.track.id:null}},{key:"getUsageLabel",value:function(){return this.isAudioTrack()?"mic":this.videoType?this.videoType:"default"}},{key:"_maybeFireTrackAttached",value:function(e){this.conference&&e&&this.conference._onTrackAttach(this,e)}},{key:"attach",value:function(e){this.stream&&(this._onTrackAttach(e),f.a.attachMediaStream(e,this.stream)),this.containers.push(e),this._maybeFireTrackAttached(e),this._attachTTFMTracker(e)}},{key:"detach",value:function(e){for(var t=this.containers,n=t.length-1;n>=0;--n){var i=t[n];e||(this._onTrackDetach(i),f.a.attachMediaStream(i,null)),e&&i!==e||t.splice(n,1)}e&&(this._onTrackDetach(e),f.a.attachMediaStream(e,null))}},{key:"_onTrackAttach",value:function(e){}},{key:"_onTrackDetach",value:function(e){}},{key:"_attachTTFMTracker",value:function(e){}},{key:"dispose",value:function(){return this.removeAllListeners(),this.disposed=!0,Promise.resolve()}},{key:"isScreenSharing",value:function(){}},{key:"getId",value:function(){return this.stream?f.a.getStreamID(this.stream):null}},{key:"isActive",value:function(){return"undefined"===typeof this.stream.active||this.stream.active}},{key:"setAudioLevel",value:function(e,t){var n=e;h.a.supportsReceiverStats()&&"undefined"!==typeof t&&this.isMuted()&&(n=0),this.audioLevel!==n?(this.audioLevel=n,this.emit(d.TRACK_AUDIO_LEVEL_CHANGED,n,t)):0===this.audioLevel&&0===n&&this.isLocal()&&!this.isWebRTCTrackMuted()&&this.emit(d.NO_AUDIO_INPUT,n)}},{key:"getMSID",value:function(){var e=this.getStreamId(),t=this.getTrackId();return e&&t?"".concat(e," ").concat(t):null}},{key:"setAudioOutput",value:function(e){var t=this;return f.a.isDeviceChangeAvailable("output")?this.isVideoTrack()?Promise.resolve():Promise.all(this.containers.map((function(t){return t.setSinkId(e).catch((function(e){throw m.warn("Failed to change audio output device on element. Default or previously set audio output device will be used.",t,e),e}))}))).then((function(){t.emit(d.TRACK_AUDIO_OUTPUT_CHANGED,e)})):Promise.reject(new Error("Audio output device change is not supported"))}}]),n}(u.a)}).call(this,"/index.js")},function(e,t){e.exports={2160:{width:3840,height:2160},"4k":{width:3840,height:2160},1080:{width:1920,height:1080},fullhd:{width:1920,height:1080},720:{width:1280,height:720},hd:{width:1280,height:720},540:{width:960,height:540},qhd:{width:960,height:540},480:{width:640,height:480},vga:{width:640,height:480},360:{width:640,height:360},240:{width:320,height:240},180:{width:320,height:180}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n(58),o=n(6),a=n(8),r=n(25),s=n(34),c=n(33),l=n(57),u=n.n(l),d=n(46),p=n(234),h=n(77),f=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e,i,a){var s;return Object(o.a)(this,n),(s=t.call(this))._procNodeSampleRate=e,s._vadProcessor=i,s._localTrack=a,s._bufferResidue=new Float32Array([]),s._audioContext=Object(p.a)({sampleRate:i.getRequiredPCMFrequency()}),s._vadSampleSize=i.getSampleLength(),s._onAudioProcess=s._onAudioProcess.bind(Object(r.a)(s)),s._initializeAudioContext(),s}return Object(a.a)(n,[{key:"_initializeAudioContext",value:function(){this._audioSource=this._audioContext.createMediaStreamSource(this._localTrack.stream),this._audioProcessingNode=this._audioContext.createScriptProcessor(this._procNodeSampleRate,1,1)}},{key:"_onAudioProcess",value:function(e){for(var t=e.inputBuffer.getChannelData(0),n=[].concat(Object(i.a)(this._bufferResidue),Object(i.a)(t)),o=Date.now(),a=0;a+this._vadSampleSize<n.length;a+=this._vadSampleSize){var r=n.slice(a,a+this._vadSampleSize),s=this._vadProcessor.calculateAudioFrameVAD(r.slice());this.emit(h.VAD_SCORE_PUBLISHED,{timestamp:o,score:s,pcmData:r,deviceId:this._localTrack.getDeviceId()})}this._bufferResidue=n.slice(a,n.length)}},{key:"_connectAudioGraph",value:function(){this._audioProcessingNode.onaudioprocess=this._onAudioProcess,this._audioSource.connect(this._audioProcessingNode),this._audioProcessingNode.connect(this._audioContext.destination)}},{key:"_disconnectAudioGraph",value:function(){this._audioProcessingNode.onaudioprocess=function(){},this._audioProcessingNode.disconnect(),this._audioSource.disconnect()}},{key:"_cleanupResources",value:function(){this._disconnectAudioGraph(),this._localTrack.stopStream()}},{key:"getDeviceId",value:function(){return this._localTrack.getDeviceId()}},{key:"getTrackLabel",value:function(){return this._localTrack.getDeviceLabel()}},{key:"start",value:function(){this._connectAudioGraph()}},{key:"stop",value:function(){this._disconnectAudioGraph(),this._bufferResidue=[]}},{key:"destroy",value:function(){this._destroyed||(this._cleanupResources(),this._destroyed=!0)}}],[{key:"create",value:function(e,t,i){return d.a.obtainAudioAndVideoPermissions({devices:["audio"],micDeviceId:e}).then((function(o){if(!o[0])throw new Error("Failed to create jitsi local track for device id: ".concat(e));return new n(t,i,o[0])}))}}]),n}(u.a)},function(e,t,n){"use strict";function i(e){var t=window.AudioContext||window.webkitAudioContext;if(t)return new t(e)}n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";n.r(t),n.d(t,"E2E_RTT_CHANGED",(function(){return i}));var i="e2eping.e2e_rtt_changed"},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return E}));var i=n(19),o=n(14),a=n(6),r=n(8),s=n(34),c=n(33),l=n(22),u=n(15),d=n(20),p=n(121),h=n(117),f=n(45),m=n.n(f),v=n(11),g=n.n(v),b=n(73),y=n(228),A=Object(l.getLogger)(e),S="SourceInfo",E=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.call(this)).ssrcOwners=new Map,e.chatRoom=null,e._localSourceState={},e._remoteSourceState={},e._sourceNames=new Map,e}return Object(r.a)(n,[{key:"_addLocalSourceInfoToPresence",value:function(){this.chatRoom&&this.chatRoom.addOrReplaceInPresence(S,{value:JSON.stringify(this._localSourceState)})}},{key:"_doesEndpointSendNewSourceInfo",value:function(e){var t,n=null===(t=this.chatRoom)||void 0===t?void 0:t.getLastPresence(e);return Boolean(n&&n.find((function(e){return e.tagName===S})))}},{key:"setChatRoom",value:function(e){var t=this,n=this.chatRoom;this.chatRoom=e,n&&(n.removePresenceListener("audiomuted",this._audioMuteHandler),n.removePresenceListener("videomuted",this._videoMuteHandler),n.removePresenceListener("videoType",this._videoTypeHandler),b.a.isSourceNameSignalingEnabled()&&(this._sourceInfoHandler&&n.removePresenceListener(S,this._sourceInfoHandler),this._memberLeftHandler&&n.removeEventListener(g.a.MUC_MEMBER_LEFT,this._memberLeftHandler))),e&&(b.a.isSourceNameSignalingEnabled()?(this._bindChatRoomEventHandlers(e),this._addLocalSourceInfoToPresence()):(this._audioMuteHandler=function(e,n){t.eventEmitter.emit(p.a,n,d.AUDIO,"true"===e.value)},e.addPresenceListener("audiomuted",this._audioMuteHandler),this._videoMuteHandler=function(e,n){t.eventEmitter.emit(p.a,n,d.VIDEO,"true"===e.value)},e.addPresenceListener("videomuted",this._videoMuteHandler),this._videoTypeHandler=function(e,n){t.eventEmitter.emit(p.b,n,e.value)},e.addPresenceListener("videoType",this._videoTypeHandler)))}},{key:"_bindChatRoomEventHandlers",value:function(e){var t=this,n=function(e,n){t.eventEmitter.emit(p.a,e,d.AUDIO,n)},a=function(e,n){t.eventEmitter.emit(p.a,e,d.VIDEO,n)};this._audioMuteHandler=function(e,i){t._doesEndpointSendNewSourceInfo(i)||n(i,"true"===e.value)},e.addPresenceListener("audiomuted",this._audioMuteHandler),this._videoMuteHandler=function(e,n){t._doesEndpointSendNewSourceInfo(n)||a(n,"true"===e.value)},e.addPresenceListener("videomuted",this._videoMuteHandler);var r=function(e,n){t.eventEmitter.emit(p.b,e,n)};this._videoTypeHandler=function(e,n){t._doesEndpointSendNewSourceInfo(n)||r(n,e.value)},e.addPresenceListener("videoType",this._videoTypeHandler),this._sourceInfoHandler=function(e,i){for(var o=i,s=e.value,c=JSON.parse(s),l=t._doesEndpointSendNewSourceInfo(o),u=t._remoteSourceState[o]||(t._remoteSourceState[o]={}),p=0,f=Object.keys(c);p<f.length;p++){var m=f[p],v=Object(h.b)(m),g=Boolean(c[m].muted),b=u[m]||(u[m]={sourceName:m});b.muted!==g&&(b.muted=g,l&&v===d.AUDIO?n(o,g):a(o,g));var y=c[m].videoType;b.videoType!==y&&(b.videoType=y,l&&r(o,y))}for(var A=Object.keys(c),S=0,E=Object.keys(u);S<E.length;S++){var O=E[S];-1===A.indexOf(O)&&delete u[O]}},e.addPresenceListener("SourceInfo",this._sourceInfoHandler),this._memberLeftHandler=function(e){var n=u.Strophe.getResourceFromJid(e);if(delete t._remoteSourceState[n],b.a.isSourceNameSignalingEnabled()){var a,r=Object(o.a)(t.ssrcOwners.entries());try{for(r.s();!(a=r.n()).done;){var s=Object(i.a)(a.value,2),c=s[0];s[1]===n&&delete t._sourceNames[c]}}catch(l){r.e(l)}finally{r.f()}}},e.addEventListener(g.a.MUC_MEMBER_LEFT,this._memberLeftHandler)}},{key:"_findEndpointSourceInfoForMediaType",value:function(e,t){var n=this._remoteSourceState[e];if(!n)return null;for(var i=0,o=Object.values(n);i<o.length;i++){var a=o[i];if(Object(h.b)(a.sourceName)===t)return a}return null}},{key:"getPeerMediaInfo",value:function(e,t){var n=this,i=function(){if(n.chatRoom)return n.chatRoom.getMediaPresenceInfo(e,t);A.error("Requested peer media info, before room was set")};if(b.a.isSourceNameSignalingEnabled()){var o=this.chatRoom.getLastPresence(e);if(!o)throw new Error("getPeerMediaInfo - no presence stored for: ".concat(e));if(!this._doesEndpointSendNewSourceInfo(e))return i();var a={},r=this._findEndpointSourceInfoForMediaType(e,t);if(t===d.AUDIO)a.muted=!r||r.muted;else{if(t!==d.VIDEO)throw new Error("Unsupported media type: ".concat(t));a.muted=!r||r.muted,a.videoType=r?r.videoType:void 0;var s=Object(y.b)(o,"jitsi_participant_codecType");s.length>0&&(a.codecType=s[0].value)}return a}return i()}},{key:"getPeerSourceInfo",value:function(e,t){return this._remoteSourceState[e]?this._remoteSourceState[e][t]:void 0}},{key:"getSSRCOwner",value:function(e){return this.ssrcOwners.get(e)}},{key:"setSSRCOwner",value:function(e,t){if("number"!==typeof e)throw new TypeError("SSRC(".concat(e,") must be a number"));var n=this.ssrcOwners.get(e);n&&n!==t&&A.error("SSRC owner re-assigned from ".concat(n," to ").concat(t)),this.ssrcOwners.set(e,t)}},{key:"setTrackMuteStatus",value:function(e,t){this._localSourceState[e]||(this._localSourceState[e]={}),this._localSourceState[e].muted=t,this.chatRoom&&this._addLocalSourceInfoToPresence()}},{key:"setTrackVideoType",value:function(e,t){this._localSourceState[e]||(this._localSourceState[e]={}),this._localSourceState[e].videoType!==t&&(this._localSourceState[e].videoType=t===m.a.CAMERA?void 0:t,this._addLocalSourceInfoToPresence())}},{key:"getTrackSourceName",value:function(e){return this._sourceNames.get(e)}},{key:"setTrackSourceName",value:function(e,t){if("number"!==typeof e)throw new TypeError("SSRC(".concat(e,") must be a number"));var n=this._sourceNames.get(e);n&&n!==t&&A.error("SSRC(".concat(e,") sourceName re-assigned from ").concat(n," to ").concat(t)),this._sourceNames.set(e,t)}}]),n}(h.a)}).call(this,"/index.js")},,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return f}));var i,o,a=n(23),r=n(6),s=n(8),c=n(10),l=(n(84),n(56)),u=n(44),d=n.n(u),p=n(2);var h={pose:{position:[l.a[0],l.a[1]],orientation:0}},f=(i=function(){function e(){Object(r.a)(this,e),Object(a.a)(this,"pose",o,this),this.pose=d.a.cloneDeep(h.pose),Object(p.g)(this)}return Object(s.a)(e,null,[{key:"fromPlain",value:function(t){(new e).pose=function(e){return Object(p.h)(e,void 0,{deep:!1})}(d.a.cloneDeep(t.pose))}}]),e}(),o=Object(c.a)(i.prototype,"pose",[p.h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i)},,function(e,t,n){var i=n(318),o=n(319),a=function(){"use strict";function e(t,n,o){i(this,e),this._userId=t,this.setDisplayName(n),this._isLocalStats=o||!1,this.setDominantSpeaker(!1),this.totalDominantSpeakerTime=0,this._dominantSpeakerStart=0,this._hasLeft=!1,this._facialExpressions={happy:0,neutral:0,surprised:0,angry:0,fearful:0,disgusted:0,sad:0}}return o(e,[{key:"getUserId",value:function(){return this._userId}},{key:"getDisplayName",value:function(){return this.displayName}},{key:"setDisplayName",value:function(e){this.displayName=e}},{key:"isLocalStats",value:function(){return this._isLocalStats}},{key:"isDominantSpeaker",value:function(){return this._dominantSpeakerStart>0}},{key:"setDominantSpeaker",value:function(e){if(!this.isDominantSpeaker()&&e)this._dominantSpeakerStart=Date.now();else if(this.isDominantSpeaker()&&!e){var t=Date.now()-this._dominantSpeakerStart;this.totalDominantSpeakerTime+=t,this._dominantSpeakerStart=0}}},{key:"getTotalDominantSpeakerTime",value:function(){var e=this.totalDominantSpeakerTime;return this.isDominantSpeaker()&&(e+=Date.now()-this._dominantSpeakerStart),e}},{key:"hasLeft",value:function(){return this._hasLeft}},{key:"markAsHasLeft",value:function(){this._hasLeft=!0,this.setDominantSpeaker(!1)}},{key:"getFacialExpressions",value:function(){return this._facialExpressions}},{key:"setFacialExpressions",value:function(e){this._facialExpressions=e}},{key:"addFacialExpression",value:function(e,t){this._facialExpressions[e]+=t}}]),e}();e.exports=a},function(e,t,n){"use strict";var i=n(5),o=n(55),a=n(6),r=n(8),s=n(57),c=n.n(s),l=n(162),u=n(46),d=n(21),p=n(28),h=n(20),f=n(31),m=n.n(f),v="microphone",g="granted",b="camera",y=function(){function e(){var t=this;Object(a.a)(this,e),this._eventEmitter=new c.a,this._permissions={},u.a.addListener(m.a.DEVICE_LIST_CHANGED,(function(e){return t._eventEmitter.emit(l.DEVICE_LIST_CHANGED,e)})),u.a.addListener(m.a.DEVICE_LIST_AVAILABLE,(function(e){return t._logOutputDevice(t.getAudioOutputDevice(),e)})),u.a.addListener(m.a.PERMISSIONS_CHANGED,(function(e){return t._handlePermissionsChange(e)})),this._permissionsApiSupported=new Promise((function(e){if(navigator.permissions){var n=t,i=[];i.push(navigator.permissions.query({name:b}).then((function(e){return t._handlePermissionsChange(Object(o.a)({},h.VIDEO,t._parsePermissionState(e))),e.onchange=function(){try{n._handlePermissionsChange(Object(o.a)({},h.VIDEO,n._parsePermissionState(this)))}catch(e){}},!0})).catch((function(){return!1}))),i.push(navigator.permissions.query({name:v}).then((function(e){return t._handlePermissionsChange(Object(o.a)({},h.AUDIO,t._parsePermissionState(e))),e.onchange=function(){try{n._handlePermissionsChange(Object(o.a)({},h.AUDIO,n._parsePermissionState(this)))}catch(e){}},!0})).catch((function(){return!1}))),Promise.all(i).then((function(t){return e(t.every((function(e){return e})))}))}else e(!1)}))}return Object(r.a)(e,[{key:"_parsePermissionState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.state||e.status;if("string"!==typeof t)throw new TypeError;return t===g}},{key:"_handlePermissionsChange",value:function(e){var t=this;[h.AUDIO,h.VIDEO].some((function(n){return n in e&&e[n]!==t._permissions[n]}))&&(this._permissions=Object(i.a)(Object(i.a)({},this._permissions),e),this._eventEmitter.emit(l.PERMISSIONS_CHANGED,this._permissions),(this._permissions[h.AUDIO]||this._permissions[h.VIDEO])&&this.enumerateDevices((function(){})))}},{key:"_logOutputDevice",value:function(e,t){var n=t.find((function(t){return"audiooutput"===t.kind&&t.deviceId===e}));n&&p.a.sendActiveDeviceListEvent(u.a.getEventDataForActiveDevice(n))}},{key:"enumerateDevices",value:function(e){u.a.enumerateDevices(e)}},{key:"isDeviceListAvailable",value:function(){return u.a.isDeviceListAvailable()}},{key:"isDeviceChangeAvailable",value:function(e){return u.a.isDeviceChangeAvailable(e)}},{key:"isDevicePermissionGranted",value:function(e){var t=this;return new Promise((function(n){e in t._permissions?n(t._permissions[e]):t._permissionsApiSupported.then((function(i){if(i){var o=[];switch(e){case h.VIDEO:o.push(navigator.permissions.query({name:b}));break;case h.AUDIO:o.push(navigator.permissions.query({name:v}));break;default:o.push(navigator.permissions.query({name:b})),o.push(navigator.permissions.query({name:v}))}Promise.all(o).then((function(e){return n(e.every((function(e){try{return t._parsePermissionState(e)}catch(n){return!1}})))}),(function(){return n(!1)}))}else n(!1)}))}))}},{key:"isMultipleAudioInputSupported",value:function(){return!(d.a.isFirefox()||d.a.isIosBrowser())}},{key:"getAudioOutputDevice",value:function(){return u.a.getAudioOutputDevice()}},{key:"setAudioOutputDevice",value:function(e){return u.a.getCurrentlyAvailableMediaDevices().length>0&&this._logOutputDevice(e,u.a.getCurrentlyAvailableMediaDevices()),u.a.setAudioOutputDevice(e)}},{key:"addEventListener",value:function(e,t){this._eventEmitter.addListener(e,t)}},{key:"removeEventListener",value:function(e,t){this._eventEmitter.removeListener(e,t)}},{key:"emitEvent",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(t=this._eventEmitter).emit.apply(t,[e].concat(i))}}]),e}();t.a=new y},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports={IDENTITY_UPDATED:"authentication.identity_updated"}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return c}));var i=n(38),o=n.n(i),a=n(65);function r(e){return s.apply(this,arguments)}function s(){return(s=Object(a.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new TextEncoder,e.abrupt("return",crypto.subtle.deriveBits({name:"HKDF",salt:n.encode("JFrameRatchetKey"),hash:"SHA-256",info:new ArrayBuffer},t,256));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(e){return l.apply(this,arguments)}function l(){return(l=Object(a.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",crypto.subtle.importKey("raw",t,"HKDF",!1,["deriveBits","deriveKey"]));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return m}));var i=n(6),o=n(8),a=n(34),r=n(33),s=n(15),c=n(11),l=n.n(c),u=n(72),d=["category","type","lang","name"],p=["category","type","lang"];function h(e,t){var n=0;return p.some((function(i){return 0!==(n=e[i]>t[i]?1:e[i]<t[i]&&-1)})),n}function f(e){var t=new Set,n=new Set;return $(e).find(">query>feature").each((function(e,n){return t.add(n.getAttribute("var"))})),$(e).find(">query>identity").each((function(e,t){return n.add({type:t.getAttribute("type"),name:t.getAttribute("name"),category:t.getAttribute("category")})})),{features:t,identities:n}}var m=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"http://jitsi.org/jitsimeet";if(Object(i.a)(this,n),(e=t.call(this)).node=a,e.disco=o.disco,!e.disco)throw new Error("Missing strophe-plugins (disco plugin is required)!");e.version="",e.rooms=new Set,e.externalFeatures=new Set;var r=o.emuc;return r.addListener(l.a.EMUC_ROOM_ADDED,(function(t){return e._addChatRoom(t)})),r.addListener(l.a.EMUC_ROOM_REMOVED,(function(t){return e._removeChatRoom(t)})),Object.keys(r.rooms).forEach((function(t){e._addChatRoom(r.rooms[t])})),s.Strophe.addNamespace("CAPS","http://jabber.org/protocol/caps"),e.disco.addFeature(s.Strophe.NS.CAPS),e}return Object(o.a)(n,[{key:"addFeature",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.disco.addFeature(e),this._generateVersion(),i&&!this.externalFeatures.has(e)&&(this.externalFeatures.add(e),this.rooms.forEach((function(e){return t._updateRoomWithExternalFeatures(e)}))),n&&this.submit()}},{key:"removeFeature",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.disco.removeFeature(e),this._generateVersion(),i&&this.externalFeatures.has(e)&&(this.externalFeatures.delete(e),this.rooms.forEach((function(e){return t._updateRoomWithExternalFeatures(e)}))),n&&this.submit()}},{key:"submit",value:function(){this.rooms.forEach((function(e){return e.sendPresence()}))}},{key:"_updateRoomWithExternalFeatures",value:function(e){if(0===this.externalFeatures.size)e.removeFromPresence("features");else{var t=[];this.externalFeatures.forEach((function(e){t.push({tagName:"feature",attributes:{var:e}})})),e.addOrReplaceInPresence("features",{children:t})}}},{key:"getFeaturesAndIdentities",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3;return this._getDiscoInfo(e,t,n)}},{key:"_getDiscoInfo",value:function(e,t,n){var i=this;return new Promise((function(o,a){return i.disco.info(e,t,(function(e){o(f(e))}),a,n)}))}},{key:"_addChatRoom",value:function(e){this.rooms.add(e),this._fixChatRoomPresenceMap(e),this._updateRoomWithExternalFeatures(e)}},{key:"_removeChatRoom",value:function(e){this.rooms.delete(e)}},{key:"_fixChatRoomPresenceMap",value:function(e){e.addOrReplaceInPresence("c",{attributes:{xmlns:s.Strophe.NS.CAPS,hash:"sha-1",node:this.node,ver:this.version}})}},{key:"_notifyVersionChanged",value:function(){var e=this;this.rooms.forEach((function(t){return e._fixChatRoomPresenceMap(t)}))}},{key:"_generateVersion",value:function(){this.version=function(e,t){var n=e.sort(h).reduce((function(e,t){return"".concat(d.reduce((function(e,n,i){return e+(0===i?"":"/")+(t[n]?t[n]:"")}),""),"<")}),""),i=t.sort().reduce((function(e,t){return"".concat(e+t,"<")}),"");return Object(s.b64_sha1)(n+i)}(this.disco._identities,this.disco._features),this._notifyVersionChanged()}}]),n}(u.a)},,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return m}));var i=n(14),o=n(6),a=n(8),r=n(25),s=n(34),c=n(33),l=n(22),u=n(57),d=n(12),p=n(77),h=n(233),f=Object(l.getLogger)(e),m=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e,i){var a;return Object(o.a)(this,n),(a=t.call(this))._createVADProcessor=i,a._vadEmitter=null,a._isVADEmitterRunning=!1,a._detectionServices=[],a._vadInitTracker=Promise.resolve(),a._processVADScore=a._processVADScore.bind(Object(r.a)(a)),e.on(d.TRACK_ADDED,a._trackAdded.bind(Object(r.a)(a))),e.on(d.TRACK_REMOVED,a._trackRemoved.bind(Object(r.a)(a))),e.on(d.TRACK_MUTE_CHANGED,a._trackMuteChanged.bind(Object(r.a)(a))),a}return Object(a.a)(n,[{key:"addVADDetectionService",value:function(e){var t=this;this._detectionServices.push(e),e.on(p.DETECTOR_STATE_CHANGE,(function(){!t._detectionServices.filter((function(e){return!0===e.isActive()})).length&&t._isVADEmitterRunning?t._stopVADEmitter():t._isVADEmitterRunning||t._startVADEmitter()}))}},{key:"_startVADEmitter",value:function(){this._vadEmitter&&(this._vadEmitter.on(p.VAD_SCORE_PUBLISHED,this._processVADScore),this._vadEmitter.start(),this._isVADEmitterRunning=!0)}},{key:"_stopVADEmitter",value:function(){this._vadEmitter&&(this._vadEmitter.removeListener(p.VAD_SCORE_PUBLISHED,this._processVADScore),this._vadEmitter.stop()),this._isVADEmitterRunning=!1}},{key:"_processVADScore",value:function(e){var t,n=Object(i.a)(this._detectionServices);try{for(n.s();!(t=n.n()).done;){t.value.processVADScore(e)}}catch(o){n.e(o)}finally{n.f()}}},{key:"_changeDetectorsMuteState",value:function(e){var t,n=Object(i.a)(this._detectionServices);try{for(n.s();!(t=n.n()).done;){t.value.changeMuteState(e)}}catch(o){n.e(o)}finally{n.f()}}},{key:"_trackAdded",value:function(e){var t=this;e.isLocalAudioTrack()&&(this._vadInitTracker=this._vadInitTracker.then((function(){return t._createVADProcessor()})).then((function(t){return h.a.create(e.getDeviceId(),4096,t)})).then((function(n){f.debug("Created VAD emitter for track: ",e.getTrackLabel()),t._vadEmitter=n,t._changeDetectorsMuteState(e.isMuted())})).catch((function(e){f.warn("Failed to start VADAudioAnalyser",e)})))}},{key:"_trackMuteChanged",value:function(e){var t=this;e.isLocalAudioTrack()&&(this._vadInitTracker=this._vadInitTracker.then((function(){t._changeDetectorsMuteState(e.isMuted())})))}},{key:"_trackRemoved",value:function(e){var t=this;e.isLocalAudioTrack()&&(this._vadInitTracker=this._vadInitTracker.then((function(){f.debug("Removing track from VAD detection - ",e.getTrackLabel()),t._vadEmitter&&(t._stopVADEmitter(),t._vadEmitter.destroy(),t._vadEmitter=null);var n,o=Object(i.a)(t._detectionServices);try{for(o.s();!(n=o.n()).done;){n.value.reset()}}catch(a){o.e(a)}finally{o.f()}})))}}]),n}(u.EventEmitter)}).call(this,"/index.js")},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(6),o=n(8),a=n(15),r=n(180),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(i.a)(this,e),this._connection=t.connection,this._mode=t.mode,this._setSessionID(t.sessionID),this.setStatus(t.status)}return Object(o.a)(e,[{key:"getError",value:function(){return this._error}},{key:"getID",value:function(){return this._sessionID}},{key:"getInitiator",value:function(){return this._initiator}},{key:"getLiveStreamViewURL",value:function(){return this._liveStreamViewURL}},{key:"getStatus",value:function(){return this._status}},{key:"getTerminator",value:function(){return this._terminator}},{key:"getMode",value:function(){return this._mode}},{key:"setError",value:function(e){this._error=e}},{key:"setLiveStreamViewURL",value:function(e){this._liveStreamViewURL=e}},{key:"setStatus",value:function(e){this._status=e}},{key:"setInitiator",value:function(e){this._initiator=e}},{key:"setTerminator",value:function(e){this._terminator=e}},{key:"start",value:function(e){var t=this,n=e.appData,i=e.broadcastId,o=e.focusMucJid,a=e.streamId;return new Promise((function(e,s){t._connection.sendIQ(t._createIQ({action:"start",appData:n,focusMucJid:o,broadcastId:i,streamId:a}),(function(n){t.setStatus("pending"),t._setSessionID(r.a.getSessionIdFromIq(n)),e()}),(function(e){t._setErrorFromIq(e),s(e)}))}))}},{key:"stop",value:function(e){var t=this,n=e.focusMucJid;return new Promise((function(e,i){t._connection.sendIQ(t._createIQ({action:"stop",focusMucJid:n}),e,i)}))}},{key:"_createIQ",value:function(e){var t=e.action,n=e.appData,i=e.broadcastId,o=e.focusMucJid,r=e.streamId;return Object(a.$iq)({to:o,type:"set"}).c("jibri",{xmlns:"http://jitsi.org/protocol/jibri",action:t,app_data:n,recording_mode:this._mode,streamid:r,you_tube_broadcast_id:i}).up()}},{key:"_setErrorFromIq",value:function(e){var t=e.getElementsByTagName("error")[0];this.setError(t.children[0].tagName)}},{key:"_setSessionID",value:function(e){this._sessionID=e}}]),e}()},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var i=n(520),o="audio/webm",a="audio/ogg",r=function(e){this.track=e,this.recorder=null,this.data=null,this.name=null,this.startTime=null};function s(e){if(void 0===e.recorder)throw new Error("Passed an object to startRecorder which is not a TrackRecorder object");e.recorder.start(),e.startTime=new Date}function c(e){if(void 0===e.recorder)throw new Error("Passed an object to stopRecorder which is not a TrackRecorder object");e.recorder.stop()}function l(){if(MediaRecorder.isTypeSupported(o))return o;if(MediaRecorder.isTypeSupported(a))return a;throw new Error("unable to create a MediaRecorder with the right mimetype!")}function u(e){this.recorders=[],this.fileType=l(),this.isRecording=!1,this.jitsiConference=e}u.determineCorrectFileType=l,u.prototype.addTrack=function(e){if(e.isAudioTrack()){var t=this.instantiateTrackRecorder(e);this.recorders.push(t),this.updateNames(),this.isRecording&&s(t)}},u.prototype.instantiateTrackRecorder=function(e){var t=new r(e),n=t.track.getOriginalStream(),i=new MediaStream;return n.getAudioTracks().forEach((function(e){return i.addTrack(e)})),t.recorder=new MediaRecorder(i,{mimeType:this.fileType}),t.data=[],t.recorder.ondataavailable=function(e){e.data.size>0&&t.data.push(e.data)},t},u.prototype.removeTrack=function(e){if(!e.isVideoTrack()){var t,n=this.recorders;for(t=0;t<n.length;t++)if(n[t].track.getParticipantId()===e.getParticipantId()){var i=n[t];this.isRecording?c(i):n.splice(t,1)}this.updateNames()}},u.prototype.updateNames=function(){var e=this.jitsiConference;this.recorders.forEach((function(t){if(t.track.isLocal())t.name="the transcriber";else{var n=t.track.getParticipantId(),i=e.getParticipantById(n).getDisplayName();"undefined"!==i&&(t.name=i)}}))},u.prototype.start=function(){if(this.isRecording)throw new Error("audiorecorder is already recording");this.isRecording=!0,this.recorders.forEach((function(e){return s(e)})),console.log("Started the recording of the audio. There are currently ".concat(this.recorders.length," recorders active."))},u.prototype.stop=function(){this.isRecording=!1,this.recorders.forEach((function(e){return c(e)})),console.log("stopped recording")},u.prototype.download=function(){var e=this;this.recorders.forEach((function(t){var n=new Blob(t.data,{type:e.fileType}),i=URL.createObjectURL(n),o=document.createElement("a");document.body.appendChild(o),o.style="display: none",o.href=i,o.download="test.".concat(e.fileType.split("/")[1]),o.click(),window.URL.revokeObjectURL(i)}))},u.prototype.getRecordingResults=function(){var e=this;if(this.isRecording)throw new Error("cannot get blobs because the AudioRecorder is still recording!");this.updateNames();var t=[];return this.recorders.forEach((function(n){return t.push(new i(new Blob(n.data,{type:e.fileType}),n.name,n.startTime))})),t},u.prototype.getFileType=function(){return this.fileType},e.exports=u},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(351),o=n(82),a=n(28),r=n(78),s=n(35);function c(e,t,n){this.appID=e,this.token=t,this.options=n,this.xmpp=new r.e(n,t),this.addEventListener(o.CONNECTION_FAILED,(function(e,t,n,i){a.a.sendAnalyticsAndLog(Object(s.B)(e,t,i))})),this.addEventListener(o.CONNECTION_DISCONNECTED,(function(e){e&&a.a.sendAnalytics(s.m,{message:e}),a.a.sendLog(JSON.stringify({id:s.m,msg:e}))}))}c.prototype.connect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.xmpp.connect(e.id,e.password)},c.prototype.attach=function(e){this.xmpp.attach(e)},c.prototype.disconnect=function(){var e;return(e=this.xmpp).disconnect.apply(e,arguments)},c.prototype.getJid=function(){return this.xmpp.getJid()},c.prototype.setToken=function(e){this.token=e},c.prototype.initJitsiConference=function(e,t){return new i.a({name:e,config:t,connection:this})},c.prototype.addEventListener=function(e,t){this.xmpp.addListener(e,t)},c.prototype.removeEventListener=function(e,t){this.xmpp.removeListener(e,t)},c.prototype.getConnectionTimes=function(){return this.xmpp.connectionTimes},c.prototype.addFeature=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.xmpp.caps.addFeature(e,t,!0)},c.prototype.removeFeature=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.xmpp.caps.removeFeature(e,t,!0)},c.prototype.getLogs=function(){var e=this.xmpp.getJingleLog(),t={};t.time=new Date,t.url=window.location.href,t.ua=navigator.userAgent;var n=this.xmpp.getXmppLog();return n&&(t.xmpp=n),e.metadata=t,e}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return Ae}));var i=n(55),o=n(58),a=n(14),r=n(38),s=n.n(r),c=n(65),l=n(5),u=n(22),d=n(57),p=n.n(d),h=n(109),f=n.n(h),m=n(15),v=n(66),g=n(352),b=n(12),y=n(360),A=n(74),S=n(53),E=n(63),O=n(361),C=n(383),j=n(46),T=n(116),k=n(21),_=n(390),R=n(391),I=n(173),w=n(77),D=n(392),P=n(393),M=n(294),N=n(394),x=n(395),L=n(200),F=n(396),B=n(397),U=n(73),V=n(398),J=n(399),G=n(400),H=n(98),z=n(401),Q=n(402),K=n(403),W=n(28),Y=n(404),q=n.n(Y),X=n(43),Z=n.n(X),ee=n(126),te=n.n(ee),ne=n(405),ie=n(406),oe=n(80),ae=n(236),re=n(78),se=n(179),ce=n.n(se),le=n(68),ue=n.n(le),de=n(20),pe=n(31),he=n.n(pe),fe=n(117),me=n(45),ve=n.n(me),ge=n(35),be=n(11),ye=Object(u.getLogger)(e);function Ae(e){var t;if(!e.name||e.name.toLowerCase()!==e.name.toString()){var n="Invalid conference name (no conference name passed or it contains invalid characters like capital letters)!";throw ye.error(n),new Error(n)}if(this.connection=e.connection,this.xmpp=null===(t=this.connection)||void 0===t?void 0:t.xmpp,this.xmpp.isRoomCreated(e.name,e.customDomain)){var i="A coference with the same name has already been created!";throw delete this.connection,delete this.xmpp,ye.error(i),new Error(i)}this.eventEmitter=new p.a,this.options=e,this.eventManager=new g.a(this),this.participants={},this._signalingLayer=new ae.a,this._init(e),this.componentsVersions=new ne.a(this),this.jvbJingleSession=null,this.lastDominantSpeaker=null,this.dtmfManager=null,this.somebodySupportsDTMF=!1,this.authEnabled=!1,this.startAudioMuted=!1,this.startVideoMuted=!1,this.startMutedPolicy={audio:!1,video:!1},this.isMutedByFocus=!1,this.mutedByFocusActor=null,this.isVideoMutedByFocus=!1,this.mutedVideoByFocusActor=null,this.wasStopped=!1,this.properties={},this.connectionQuality=new _.a(this,this.eventEmitter,e),this.avgRtpStatsReporter=new Q.a(this,e.config.avgRtpStatsN||15),e.config.disableAudioLevels||(this._audioOutputProblemDetector=new z.a(this)),this.isJvbConnectionInterrupted=!1,this.speakerStatsCollector=new K.a(this),this.deferredStartP2PTask=null;var o=parseInt(e.config.p2p&&e.config.p2p.backToP2PDelay,10);this.backToP2PDelay=isNaN(o)?5:o,ye.info("backToP2PDelay: ".concat(this.backToP2PDelay)),this.isP2PConnectionInterrupted=!1,this.p2p=!1,this.p2pJingleSession=null,this.videoSIPGWHandler=new ie.a(this.room),this.recordingManager=new G.a(this.room),this._conferenceJoinAnalyticsEventSent=void 0,this.isE2EESupported()&&(ye.info("End-to-End Encryption is supported"),this._e2eEncryption=new L.a(this)),this._audioSenderLimitReached=void 0,this._videoSenderLimitReached=void 0}Ae.prototype.constructor=Ae,Ae.resourceCreator=function(e,t){var n;if(t)n=te.a.randomHexString(8).toLowerCase();else{n=m.Strophe.getNodeFromJid(e).substr(0,8).toLowerCase();/[0-9a-f]{8}/g.test(n)||(n=te.a.randomHexString(8).toLowerCase())}return n},Ae.prototype._init=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.eventManager.setupXMPPListeners();var n=this.options.config,i={disabledCodec:n.videoQuality?n.videoQuality.disabledCodec:n.p2p&&n.p2p.disableH264&&ue.a.H264,enforcePreferredCodec:n.videoQuality&&n.videoQuality.enforcePreferredCodec,jvbCodec:n.videoQuality&&n.videoQuality.preferredCodec||n.preferH264&&ue.a.H264,p2pCodec:n.p2p?n.p2p.preferredCodec||n.p2p.preferH264&&ue.a.H264:ue.a.VP8};this.codecSelection=new C.a(this,i),this._statsCurrentId=n.statisticsId?n.statisticsId:H.a.callStatsUserName,this.room=this.xmpp.createRoom(this.options.name,Object(l.a)(Object(l.a)({},n),{},{statsId:this._statsCurrentId}),Ae.resourceCreator),this._signalingLayer.setChatRoom(this.room),this._onIceConnectionInterrupted=this._onIceConnectionInterrupted.bind(this),this.room.addListener(be.CONNECTION_INTERRUPTED,this._onIceConnectionInterrupted),this._onIceConnectionRestored=this._onIceConnectionRestored.bind(this),this.room.addListener(be.CONNECTION_RESTORED,this._onIceConnectionRestored),this._onIceConnectionEstablished=this._onIceConnectionEstablished.bind(this),this.room.addListener(be.CONNECTION_ESTABLISHED,this._onIceConnectionEstablished),this._updateProperties=this._updateProperties.bind(this),this.room.addListener(be.CONFERENCE_PROPERTIES_CHANGED,this._updateProperties),this._sendConferenceJoinAnalyticsEvent=this._sendConferenceJoinAnalyticsEvent.bind(this),this.room.addListener(be.MEETING_ID_SET,this._sendConferenceJoinAnalyticsEvent),this.e2eping=new F.a(this,n,(function(t,n){try{e.sendMessage(t,n,!0)}catch(i){ye.warn("Failed to send E2E ping request or response to ".concat(n,"."),i&&i.msg)}})),this.rtc||(this.rtc=new j.a(this,t),this.eventManager.setupRTCListeners(),U.a.isSourceNameSignalingEnabled()&&this._registerRtcListeners(this.rtc)),this.receiveVideoController=new V.a(this,this.rtc),this.sendVideoController=new J.a(this,this.rtc),this.participantConnectionStatus=new I.b(this.rtc,this,{p2pRtcMuteTimeout:n._p2pConnStatusRtcMuteTimeout,rtcMuteTimeout:n._peerConnStatusRtcMuteTimeout,outOfLastNTimeout:n._peerConnStatusOutOfLastNTimeout}),this.participantConnectionStatus.init();var o=!0;if(n.testing&&n.testing.callStatsThreshold&&(o=100*Math.random()<=n.testing.callStatsThreshold),this.statistics||(this.statistics=new W.a(this.xmpp,{aliasName:this._statsCurrentId,userName:n.statisticsDisplayName?n.statisticsDisplayName:this.myUserId(),confID:n.confID||"".concat(this.connection.options.hosts.domain,"/").concat(this.options.name),siteID:n.siteID,customScriptUrl:n.callStatsCustomScriptUrl,callStatsID:n.callStatsID,callStatsSecret:n.callStatsSecret,callStatsApplicationLogsDisabled:n.callStatsApplicationLogsDisabled,enableCallStats:o,roomName:this.options.name,applicationName:n.applicationName,getWiFiStatsMethod:n.getWiFiStatsMethod,configParams:n.callStatsConfigParams}),W.a.analytics.addPermanentProperties({callstats_name:this._statsCurrentId}),n.longTasksStatsInterval&&this.statistics.attachLongTasksStats(this)),this.eventManager.setupChatRoomListeners(),this.eventManager.setupStatisticsListeners(),n.enableTalkWhileMuted&&k.a.supportsVADDetection())if(n.createVADProcessor){ye.info("Using VAD detection for generating talk while muted events"),this._audioAnalyser||(this._audioAnalyser=new M.a(this,n.createVADProcessor));var a=new x.a;a.on(w.VAD_TALK_WHILE_MUTED,(function(){return e.eventEmitter.emit(b.TALK_WHILE_MUTED)})),this._audioAnalyser.addVADDetectionService(a)}else ye.warn("No VAD Processor was provided. Talk while muted detection service was not initialized!");if(n.enableNoisyMicDetection&&k.a.supportsVADDetection())if(n.createVADProcessor){this._audioAnalyser||(this._audioAnalyser=new M.a(this,n.createVADProcessor));var r=new N.a;r.on(w.VAD_NOISY_DEVICE,(function(){return e.eventEmitter.emit(b.NOISY_MIC)})),this._audioAnalyser.addVADDetectionService(r)}else ye.warn("No VAD Processor was provided. Noisy microphone detection service was not initialized!");n.enableNoAudioDetection&&(this._noAudioSignalDetection=new D.a(this),this._noAudioSignalDetection.on(w.NO_AUDIO_INPUT,(function(){e.eventEmitter.emit(b.NO_AUDIO_INPUT)})),this._noAudioSignalDetection.on(w.AUDIO_INPUT_STATE_CHANGE,(function(t){e.eventEmitter.emit(b.AUDIO_INPUT_STATE_CHANGE,t)}))),"channelLastN"in n&&this.setLastN(n.channelLastN),this.jvb121Status=new B.a(this),this.p2pDominantSpeakerDetection=new P.a(this),n&&n.deploymentInfo&&n.deploymentInfo.userRegion&&this.setLocalParticipantProperty("region",n.deploymentInfo.userRegion),this.setLocalParticipantProperty("codecType",this.codecSelection.getPreferredCodec()),n&&n.transcriptionLanguage&&"en-US"!==n.transcriptionLanguage&&this.setLocalParticipantProperty("transcription_language",n.transcriptionLanguage)},Ae.prototype.join=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.room&&this.room.join(e,n).then((function(){return t._maybeSetSITimeout()}))},Ae.prototype.authenticateAndUpgradeRole=function(e){return O.a.call(this,Object(l.a)(Object(l.a)({},e),{},{onCreateResource:Ae.resourceCreator}))},Ae.prototype.isJoined=function(){return this.room&&this.room.joined},Ae.prototype.isP2PEnabled=function(){return Boolean(this.options.config.p2p&&this.options.config.p2p.enabled)||"undefined"===typeof this.options.config.p2p},Ae.prototype.isP2PTestModeEnabled=function(){return Boolean(this.options.config.testing&&this.options.config.testing.p2pTestMode)},Ae.prototype.leave=Object(c.a)(s.a.mark((function e(){var t,n,i=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.participantConnectionStatus&&(this.participantConnectionStatus.dispose(),this.participantConnectionStatus=null),this.avgRtpStatsReporter&&(this.avgRtpStatsReporter.dispose(),this.avgRtpStatsReporter=null),this._audioOutputProblemDetector&&(this._audioOutputProblemDetector.dispose(),this._audioOutputProblemDetector=null),this.e2eping&&(this.e2eping.stop(),this.e2eping=null),this.getLocalTracks().forEach((function(e){return i.onLocalTrackRemoved(e)})),this.rtc.closeBridgeChannel(),this._sendConferenceLeftAnalyticsEvent(),this.statistics&&this.statistics.dispose(),this._delayedIceFailed&&this._delayedIceFailed.cancel(),this._maybeClearSITimeout(),this.jvbJingleSession&&(this.jvbJingleSession.close(),this.jvbJingleSession=null),this.p2pJingleSession&&(this.p2pJingleSession.close(),this.p2pJingleSession=null),this.room){e.next=14;break}throw new Error("The conference is has been already left");case 14:return(t=this.room).removeListener(be.CONNECTION_INTERRUPTED,this._onIceConnectionInterrupted),t.removeListener(be.CONNECTION_RESTORED,this._onIceConnectionRestored),t.removeListener(be.CONNECTION_ESTABLISHED,this._onIceConnectionEstablished),t.removeListener(be.CONFERENCE_PROPERTIES_CHANGED,this._updateProperties),t.removeListener(be.MEETING_ID_SET,this._sendConferenceJoinAnalyticsEvent),this.eventManager.removeXMPPListeners(),this._signalingLayer.setChatRoom(null),this.room=null,e.prev=23,e.next=26,t.leave();case 26:e.next=32;break;case 28:e.prev=28,e.t0=e.catch(23),n=e.t0,this.getParticipants().forEach((function(e){return i.onMemberLeft(e.getJid())}));case 32:if(this.rtc&&this.rtc.destroy(),!n){e.next=35;break}throw n;case 35:case"end":return e.stop()}}),e,this,[[23,28]])}))),Ae.prototype._getActiveMediaSession=function(){return this.isP2PActive()?this.p2pJingleSession:this.jvbJingleSession},Ae.prototype._getMediaSessions=function(){var e=[];return this.jvbJingleSession&&e.push(this.jvbJingleSession),this.p2pJingleSession&&e.push(this.p2pJingleSession),e},Ae.prototype._registerRtcListeners=function(e){var t=this;e.addListener(he.a.DATA_CHANNEL_OPEN,(function(){var e,n=Object(a.a)(t.rtc.localTracks);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.isVideoTrack()&&t._sendBridgeVideoTypeMessage(i)}}catch(o){n.e(o)}finally{n.f()}}))},Ae.prototype._sendBridgeVideoTypeMessage=function(e){var t=!e||e.isMuted()?ce.a.NONE:e.getVideoType();t===ce.a.DESKTOP&&this._desktopSharingFrameRate>T.a&&(t=ce.a.DESKTOP_HIGH_FPS),U.a.isSourceNameSignalingEnabled()?this.rtc.sendSourceVideoType(Object(fe.c)(this.myUserId(),de.VIDEO,0),t):this.rtc.setVideoType(t)},Ae.prototype.getName=function(){return this.options.name.toString()},Ae.prototype.getConnection=function(){return this.connection},Ae.prototype.isAuthEnabled=function(){return this.authEnabled},Ae.prototype.isLoggedIn=function(){return Boolean(this.authIdentity)},Ae.prototype.getAuthLogin=function(){return this.authIdentity},Ae.prototype.isExternalAuthEnabled=function(){return this.room&&this.room.moderator.isExternalAuthEnabled()},Ae.prototype.getExternalAuthUrl=function(e){var t=this;return new Promise((function(n,i){t.isExternalAuthEnabled()?e?t.room.moderator.getPopupLoginUrl(n,i):t.room.moderator.getLoginUrl(n,i):i()}))},Ae.prototype.getLocalTracks=function(e){var t=[];return this.rtc&&(t=this.rtc.getLocalTracks(e)),t},Ae.prototype.getLocalAudioTrack=function(){return this.rtc?this.rtc.getLocalAudioTrack():null},Ae.prototype.getLocalVideoTrack=function(){return this.rtc?this.rtc.getLocalVideoTrack():null},Ae.prototype.getPerformanceStats=function(){return{longTasksStats:this.statistics.getLongTasksStats()}},Ae.prototype.on=function(e,t){this.eventEmitter&&this.eventEmitter.on(e,t)},Ae.prototype.off=function(e,t){this.eventEmitter&&this.eventEmitter.removeListener(e,t)},Ae.prototype.addEventListener=Ae.prototype.on,Ae.prototype.removeEventListener=Ae.prototype.off,Ae.prototype.addCommandListener=function(e,t){this.room&&this.room.addPresenceListener(e,t)},Ae.prototype.removeCommandListener=function(e,t){this.room&&this.room.removePresenceListener(e,t)},Ae.prototype.sendTextMessage=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"body";this.room&&this.room.sendMessage(e,t)},Ae.prototype.sendPrivateTextMessage=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"body";this.room&&this.room.sendPrivateMessage(e,t,n)},Ae.prototype.sendCommand=function(e,t){this.room?this.room.addOrReplaceInPresence(e,t)&&this.room.sendPresence():ye.warn("Not sending a command, room not initialized.")},Ae.prototype.sendCommandOnce=function(e,t){this.sendCommand(e,t),this.removeCommand(e)},Ae.prototype.removeCommand=function(e){this.room&&this.room.removeFromPresence(e)},Ae.prototype.setDisplayName=function(e){if(this.room){var t="nick";if(!e&&!this.room.getFromPresence(t))return;this.room.addOrReplaceInPresence(t,{attributes:{xmlns:"http://jabber.org/protocol/nick"},value:e})&&this.room.sendPresence()}},Ae.prototype.setSubject=function(e){this.room&&this.isModerator()?this.room.setSubject(e):ye.warn("Failed to set subject, ".concat(this.room?"":"not in a room, ").concat(this.isModerator()?"":"participant is not a moderator"))},Ae.prototype.getTranscriber=function(){if(void 0===this.transcriber){this.transcriber=new q.a;var e,t=this.getLocalTracks(de.AUDIO),n=Object(a.a)(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;this.transcriber.addTrack(i)}}catch(l){n.e(l)}finally{n.f()}var o,r=this.rtc.getRemoteTracks(de.AUDIO),s=Object(a.a)(r);try{for(s.s();!(o=s.n()).done;){var c=o.value;this.transcriber.addTrack(c)}}catch(l){s.e(l)}finally{s.f()}}return this.transcriber},Ae.prototype.getTranscriptionStatus=function(){return this.room.transcriptionStatus},Ae.prototype.addTrack=function(e){var t=e.getType(),n=this.rtc.getLocalTracks(t);return n.length>0?e===n[0]?Promise.resolve(e):Promise.reject(new Error("Cannot add second ".concat(t," track to the conference"))):this.replaceTrack(null,e)},Ae.prototype._fireAudioLevelChangeEvent=function(e,t){var n=this.getActivePeerConnection();t&&n!==t||this.eventEmitter.emit(b.TRACK_AUDIO_LEVEL_CHANGED,this.myUserId(),e)},Ae.prototype._fireMuteChangeEvent=function(e){var t;if(this.isMutedByFocus&&e.isAudioTrack()&&!e.isMuted()?(this.isMutedByFocus=!1,this.room.muteParticipant(this.room.myroomjid,!1,de.AUDIO)):this.isVideoMutedByFocus&&e.isVideoTrack()&&!e.isMuted()&&(this.isVideoMutedByFocus=!1,this.room.muteParticipant(this.room.myroomjid,!1,de.VIDEO)),this.mutedByFocusActor&&e.isAudioTrack()){var n=m.Strophe.getResourceFromJid(this.mutedByFocusActor);t=this.participants[n]}else if(this.mutedVideoByFocusActor&&e.isVideoTrack()){var i=m.Strophe.getResourceFromJid(this.mutedVideoByFocusActor);t=this.participants[i]}e.isVideoTrack()&&!k.a.doesVideoMuteByStreamRemove()&&this._sendBridgeVideoTypeMessage(e),this.eventEmitter.emit(b.TRACK_MUTE_CHANGED,e,t)},Ae.prototype._getInitialLocalTracks=function(){var e=this;return this.getLocalTracks().filter((function(t){var n=t.getType();return!(n!==de.AUDIO||e.isStartAudioMuted()&&!k.a.isWebKitBased()&&!k.a.isReactNative())||n===de.VIDEO&&!e.isStartVideoMuted()}))},Ae.prototype.onLocalTrackRemoved=function(e){e._setConference(null),this.rtc.removeLocalTrack(e),e.removeEventListener(E.TRACK_MUTE_CHANGED,e.muteHandler),e.removeEventListener(E.TRACK_AUDIO_LEVEL_CHANGED,e.audioLevelHandler),e.isVideoTrack()&&e.videoType===ve.a.DESKTOP&&this.statistics.sendScreenSharingEvent(!1),this.eventEmitter.emit(b.TRACK_REMOVED,e)},Ae.prototype.removeTrack=function(e){return this.replaceTrack(e,null)},Ae.prototype.replaceTrack=function(e,t){var n=this,i=this===(null===e||void 0===e?void 0:e.conference);return i&&e.disposed||t&&t.disposed?Promise.reject(new A.a(S.TRACK_IS_DISPOSED)):(e&&!i&&ye.warn("JitsiConference.replaceTrack oldTrack (".concat(e," does not belong to this conference")),this._doReplaceTrack(i?e:null,t).then((function(){return i&&n.onLocalTrackRemoved(e),t&&n._setupNewTrack(t),(i&&null!==e&&void 0!==e&&e.isVideoTrack()||null!==t&&void 0!==t&&t.isVideoTrack())&&n._sendBridgeVideoTypeMessage(t),null!==t&&(n.isMutedByFocus||n.isVideoMutedByFocus)&&n._fireMuteChangeEvent(t),Promise.resolve()})).catch((function(e){return ye.error("replaceTrack failed: ".concat(null===e||void 0===e?void 0:e.stack)),Promise.reject(e)})))},Ae.prototype._doReplaceTrack=function(e,t){var n=[];return this.jvbJingleSession?n.push(this.jvbJingleSession.replaceTrack(e,t)):ye.info("_doReplaceTrack - no JVB JingleSession"),this.p2pJingleSession?n.push(this.p2pJingleSession.replaceTrack(e,t)):ye.info("_doReplaceTrack - no P2P JingleSession"),Promise.all(n)},Ae.prototype._setupNewTrack=function(e){if(e.isAudioTrack()||e.isVideoTrack()&&e.videoType!==ve.a.DESKTOP){var t=j.a.getCurrentlyAvailableMediaDevices().find((function(t){return t.kind==="".concat(e.getTrack().kind,"input")&&t.label===e.getTrack().label}));t&&W.a.sendActiveDeviceListEvent(j.a.getEventDataForActiveDevice(t))}var n=!1;e.isVideoTrack()&&(n=this._setNewVideoType(e)),this.rtc.addLocalTrack(e),(this._setTrackMuteStatus(e,e.isMuted())||n)&&this.room.sendPresence(),e.muteHandler=this._fireMuteChangeEvent.bind(this,e),e.audioLevelHandler=this._fireAudioLevelChangeEvent.bind(this),e.addEventListener(E.TRACK_MUTE_CHANGED,e.muteHandler),e.addEventListener(E.TRACK_AUDIO_LEVEL_CHANGED,e.audioLevelHandler),e._setConference(this),this.eventEmitter.emit(b.TRACK_ADDED,e)},Ae.prototype._setNewVideoType=function(e){if(U.a.isSourceNameSignalingEnabled())return this._signalingLayer.setTrackVideoType(Object(fe.c)(this.myUserId(),e.getType(),0),e.videoType),!0;var t="videoType";return!(e.videoType===ve.a.CAMERA&&!this.room.getFromPresence(t))&&this.room.addOrReplaceInPresence(t,{value:e.videoType})},Ae.prototype._setTrackMuteStatus=function(e,t){return U.a.isSourceNameSignalingEnabled()&&this._signalingLayer.setTrackMuteStatus(Object(fe.c)(this.myUserId(),e.getType(),0),t),!!this.room&&(e.isAudioTrack()?this.room.addAudioInfoToPresence(t):this.room.addVideoInfoToPresence(t))},Ae.prototype._addLocalTrackAsUnmute=function(e){var t=this,n=[];return this.jvbJingleSession?n.push(this.jvbJingleSession.addTrackAsUnmute(e)):ye.debug("Add local MediaStream as unmute - no JVB Jingle session started yet"),this.p2pJingleSession?n.push(this.p2pJingleSession.addTrackAsUnmute(e)):ye.debug("Add local MediaStream as unmute - no P2P Jingle session started yet"),Promise.allSettled(n).then((function(){e.isVideoTrack()&&t._sendBridgeVideoTypeMessage(e)}))},Ae.prototype._removeLocalTrackAsMute=function(e){var t=this,n=[];return this.jvbJingleSession?n.push(this.jvbJingleSession.removeTrackAsMute(e)):ye.debug("Remove local MediaStream - no JVB JingleSession started yet"),this.p2pJingleSession?n.push(this.p2pJingleSession.removeTrackAsMute(e)):ye.debug("Remove local MediaStream - no P2P JingleSession started yet"),Promise.allSettled(n).then((function(){e.isVideoTrack()&&t._sendBridgeVideoTypeMessage()}))},Ae.prototype.getRole=function(){return this.room.role},Ae.prototype.isHidden=function(){return this.connection?m.Strophe.getDomainFromJid(this.connection.getJid())===this.options.config.hiddenDomain:null},Ae.prototype.isModerator=function(){return this.room?this.room.isModerator():null},Ae.prototype.lock=function(e){var t=this;return this.isModerator()?new Promise((function(n,i){t.room.lockRoom(e||"",(function(){return n()}),(function(e){return i(e)}),(function(){return i(v.PASSWORD_NOT_SUPPORTED)}))})):Promise.reject(new Error("You are not moderator."))},Ae.prototype.unlock=function(){return this.lock()},Ae.prototype.selectParticipant=function(e){this.selectParticipants([e])},Ae.prototype.selectParticipants=function(e){if(!Array.isArray(e))throw new Error("Invalid argument; participantIds must be an array.");this.receiveVideoController.selectEndpoints(e)},Ae.prototype.getLastN=function(){return this.receiveVideoController.getLastN()},Ae.prototype.setLastN=function(e){if(!Number.isInteger(e)&&!Number.parseInt(e,10))throw new Error("Invalid value for lastN: ".concat(e));var t=Number(e);if(t<-1)throw new RangeError("lastN cannot be smaller than -1");if(this.receiveVideoController.setLastN(t),this.p2pJingleSession){var n=0!==t;this.p2pJingleSession.setMediaTransferActive(!0,n).catch((function(e){ye.error("Failed to adjust video transfer status (".concat(n,")"),e)}))}},Ae.prototype.setPerceptibles=function(e){this.rtc.setPerceptibles(e)},Ae.prototype.isInLastN=function(e){return this.rtc.isInLastN(e)},Ae.prototype.getParticipants=function(){return Object.values(this.participants)},Ae.prototype.getParticipantCount=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.getParticipants();return e||(t=t.filter((function(e){return!e.isHidden()}))),t.length+1},Ae.prototype.getParticipantById=function(e){return this.participants[e]},Ae.prototype.grantOwner=function(e){var t=this.getParticipantById(e);t&&this.room.setAffiliation(t.getJid(),"owner")},Ae.prototype.revokeOwner=function(e){var t=this.getParticipantById(e),n=this.myUserId()===e,i=this.isMembersOnly()?"member":"none";n?this.room.setAffiliation(this.room.myroomjid,i):t&&this.room.setAffiliation(t.getJid(),i)},Ae.prototype.kickParticipant=function(e,t){var n=this.getParticipantById(e);n&&this.room.kick(n.getJid(),t)},Ae.prototype._maybeClearSITimeout=function(){this._sessionInitiateTimeout&&(this.jvbJingleSession||this.getParticipantCount()<2)&&(window.clearTimeout(this._sessionInitiateTimeout),this._sessionInitiateTimeout=null)},Ae.prototype._maybeSetSITimeout=function(){var e=this;!this.jvbJingleSession&&this.getParticipantCount()>=2&&!this._sessionInitiateTimeout&&(this._sessionInitiateTimeout=window.setTimeout((function(){e._sessionInitiateTimeout=null,W.a.sendAnalytics(Object(ge.G)(ge.d,{p2p:!1,value:5e3}))}),5e3))},Ae.prototype.muteParticipant=function(e,t){var n=t||de.AUDIO;if(n===de.AUDIO||n===de.VIDEO){var i=this.getParticipantById(e);i&&this.room.muteParticipant(i.getJid(),!0,n)}else ye.error("Unsupported media type: ".concat(n))},Ae.prototype.onMemberJoined=function(e,t,n,i,o,a,r,s,c,l,u){var d=m.Strophe.getResourceFromJid(e);if("focus"!==d&&this.myUserId()!==d){var p=new y.a(e,this,t,i,o,a,r);p.setRole(n),p.setBotType(s),p.setFeatures(l),p.setIsReplacing(u),this.participants[d]=p,this.eventEmitter.emit(b.USER_JOINED,d,p),this._updateFeatures(p),this.isJoined()&&this._maybeStartOrStopP2P(),this._maybeSetSITimeout()}},Ae.prototype._onMucJoined=function(){this._maybeStartOrStopP2P()},Ae.prototype._updateFeatures=function(e){var t=this;e.getFeatures().then((function(n){e._supportsDTMF=n.has("urn:xmpp:jingle:dtmf:0"),t.updateDTMFSupport(),n.has(re.c)&&e.setProperty("features_jigasi",!0),n.has(re.b)&&e.setProperty("features_e2ee",!0)})).catch((function(){return!1}))},Ae.prototype._onMemberBotTypeChanged=function(e,t){var n=this.getParticipants().find((function(t){return t.getJid()===e}));if(n){n.setBotType(t);var i=m.Strophe.getResourceFromJid(e);this.eventEmitter.emit(b.BOT_TYPE_CHANGED,i,t)}n.getBotType()||this._maybeStartOrStopP2P()},Ae.prototype.onMemberLeft=function(e){var t=this,n=m.Strophe.getResourceFromJid(e);if("focus"!==n&&this.myUserId()!==n){var i,r=this.participants[n],s=this._getMediaSessions(),c=[],l=Object(a.a)(s);try{for(l.s();!(i=l.n()).done;){var u=i.value,d=u.peerconnection.getRemoteTracks(n);d&&(c=[].concat(Object(o.a)(c),Object(o.a)(d))),u.removeRemoteStreamsOnLeave(n)}}catch(p){l.e(p)}finally{l.f()}c.forEach((function(e){t.eventEmitter.emit(b.TRACK_REMOVED,e)})),r&&(delete this.participants[n],this.eventEmitter.emit(b.USER_LEFT,n,r)),null!==this.room&&(this._maybeStartOrStopP2P(!0),this._maybeClearSITimeout())}},Ae.prototype.onMemberKicked=function(e,t,n,i,o){if(t!==this.myUserId()){var a=this.participants[t];if(e)return this.eventEmitter.emit(b.KICKED,a,i,o),void this.leave();var r=this.participants[n];r.setIsReplaced(o),this.eventEmitter.emit(b.PARTICIPANT_KICKED,a,r,i)}},Ae.prototype.onLocalRoleChanged=function(e){this.eventEmitter.emit(b.USER_ROLE_CHANGED,this.myUserId(),e)},Ae.prototype.onUserRoleChanged=function(e,t){var n=m.Strophe.getResourceFromJid(e),i=this.getParticipantById(n);i&&(i.setRole(t),this.eventEmitter.emit(b.USER_ROLE_CHANGED,n,t))},Ae.prototype.onDisplayNameChanged=function(e,t){var n=m.Strophe.getResourceFromJid(e),i=this.getParticipantById(n);i&&i._displayName!==t&&(i._displayName=t,this.eventEmitter.emit(b.DISPLAY_NAME_CHANGED,n,t))},Ae.prototype.onRemoteTrackAdded=function(e){var t=this;if(!e.isP2P||this.isP2PActive())if(e.isP2P||!this.isP2PActive()){var n=e.getParticipantId(),i=this.getParticipantById(n);if(i){i._tracks.push(e),this.transcriber&&this.transcriber.addTrack(e);var o=this.eventEmitter;e.addEventListener(E.TRACK_MUTE_CHANGED,(function(){return o.emit(b.TRACK_MUTE_CHANGED,e)})),e.addEventListener(E.TRACK_AUDIO_LEVEL_CHANGED,(function(e,i){t.getActivePeerConnection()===i&&o.emit(b.TRACK_AUDIO_LEVEL_CHANGED,n,e)})),o.emit(b.TRACK_ADDED,e)}else ye.error("No participant found for id: ".concat(n))}else ye.info("Trying to add remote JVB track, when in P2P - IGNORED");else ye.info("Trying to add remote P2P track, when not in P2P - IGNORED")},Ae.prototype.onCallAccepted=function(e,t){this.p2pJingleSession===e&&(ye.info("P2P setAnswer"),this.p2pJingleSession.setAnswer(t),this.eventEmitter.emit(b._MEDIA_SESSION_STARTED,this.p2pJingleSession))},Ae.prototype.onTransportInfo=function(e,t){this.p2pJingleSession===e&&(ye.info("P2P addIceCandidates"),this.p2pJingleSession.addIceCandidates(t))},Ae.prototype.onRemoteTrackRemoved=function(e){var t=this;this.getParticipants().forEach((function(n){for(var i=n.getTracks(),o=0;o<i.length;o++)if(i[o]===e){n._tracks.splice(o,1),t.eventEmitter.emit(b.TRACK_REMOVED,e),t.transcriber&&t.transcriber.removeTrack(e);break}}),this)},Ae.prototype._onIncomingCallP2P=function(e,t){var n;!this.isP2PEnabled()&&!this.isP2PTestModeEnabled()||k.a.isFirefox()||k.a.isWebKitBased()?n={reason:"decline",reasonDescription:"P2P disabled",errorMsg:"P2P mode disabled in the configuration"}:this.p2pJingleSession?n={reason:"busy",reasonDescription:"P2P already in progress",errorMsg:'Duplicated P2P "session-initiate"'}:this._shouldBeInP2PMode()||(n={reason:"decline",reasonDescription:"P2P requirements not met",errorMsg:'Received P2P "session-initiate" when should not be in P2P mode'},W.a.sendAnalytics(Object(ge.G)(ge.h))),n?this._rejectIncomingCall(e,n):this._acceptP2PIncomingCall(e,t)},Ae.prototype.onIncomingCall=function(e,t,n){if(e.isP2P)this._onIncomingCallP2P(e,t);else{if(!this.isFocus(e.remoteJid)){var i="Rejecting session-initiate from non-focus.";return void this._rejectIncomingCall(e,{reason:"security-error",reasonDescription:i,errorMsg:i})}this._acceptJvbIncomingCall(e,t,n)}},Ae.prototype._acceptJvbIncomingCall=function(e,t,n){var i=this;this.jvbJingleSession=e,this.room.connectionTimes["session.initiate"]=n,this._sendConferenceJoinAnalyticsEvent(),this.wasStopped&&W.a.sendAnalyticsAndLog(Object(ge.G)(ge.a,{p2p:!1}));var o=$(t).find('>bridge-session[xmlns="http://jitsi.org/protocol/focus"]').attr("region");this.eventEmitter.emit(b.SERVER_REGION_CHANGED,o),this._maybeClearSITimeout(),W.a.sendAnalytics(Object(ge.G)(ge.c,{p2p:!1,value:n}));try{e.initialize(this.room,this.rtc,this._signalingLayer,Object(l.a)(Object(l.a)({},this.options.config),{},{enableInsertableStreams:this.isE2EEEnabled()}))}catch(r){return Z.a.callErrorHandler(r),void ye.error(r)}this._setBridgeChannel(t,e.peerconnection);var a=this._getInitialLocalTracks();try{e.acceptOffer(t,(function(){i.isP2PActive()&&i.jvbJingleSession&&i._suspendMediaTransferForJvbConnection(),i.eventEmitter.emit(b._MEDIA_SESSION_STARTED,e),i.isP2PActive()||i.eventEmitter.emit(b._MEDIA_SESSION_ACTIVE_CHANGED,e)}),(function(e){Z.a.callErrorHandler(e),ye.error("Failed to accept incoming Jingle session",e)}),a),this._desktopSharingFrameRate&&e.peerconnection.setDesktopSharingFrameRate(this._desktopSharingFrameRate),ye.info("Starting CallStats for JVB connection..."),this.statistics.startCallStats(this.jvbJingleSession.peerconnection,"jitsi"),this.statistics.startRemoteStats(this.jvbJingleSession.peerconnection)}catch(s){Z.a.callErrorHandler(s),ye.error(s)}},Ae.prototype._setBridgeChannel=function(e,t){var n=null,i=$(e).find(">content>transport>web-socket").first();1===i.length&&(n=i[0].getAttribute("url")),n?this.rtc.initializeBridgeChannel(null,n):this.rtc.initializeBridgeChannel(t,null)},Ae.prototype._rejectIncomingCall=function(e,t){t&&t.errorMsg&&Z.a.callErrorHandler(new Error(t.errorMsg)),e.terminate(null,(function(e){ye.warn("An error occurred while trying to terminate invalid Jingle session",e)}),{reason:t&&t.reason,reasonDescription:t&&t.reasonDescription,sendSessionTerminate:!0})},Ae.prototype.onCallEnded=function(e,t,n){if(ye.info("Call ended: ".concat(t," - ").concat(n," P2P ?").concat(e.isP2P)),e===this.jvbJingleSession)this.wasStopped=!0,W.a.sendAnalytics(Object(ge.G)(ge.e,{p2p:!1})),this.statistics&&(this.statistics.stopRemoteStats(this.jvbJingleSession.peerconnection),ye.info("Stopping JVB CallStats"),this.statistics.stopCallStats(this.jvbJingleSession.peerconnection)),this.jvbJingleSession=null,this.rtc.onCallEnded();else if(e===this.p2pJingleSession){var i={};"decline"===t&&"force JVB121"===n?(ye.info("In forced JVB 121 mode..."),W.a.analytics.addPermanentProperties({forceJvb121:!0})):"connectivity-error"===t&&"ICE FAILED"===n?W.a.analytics.addPermanentProperties({p2pFailed:!0}):"success"===t&&"restart"===n&&(i.requestRestart=!0),this._stopP2PSession(i)}else ye.error("Received onCallEnded for invalid session",e.sid,e.remoteJid,t,n)},Ae.prototype.onSuspendDetected=function(e){e.isP2P||(this.leave(),this.eventEmitter.emit(b.SUSPEND_DETECTED))},Ae.prototype.updateDTMFSupport=function(){for(var e=!1,t=this.getParticipants(),n=0;n<t.length;n+=1)if(t[n].supportsDTMF()){e=!0;break}e!==this.somebodySupportsDTMF&&(this.somebodySupportsDTMF=e,this.eventEmitter.emit(b.DTMF_SUPPORT_CHANGED,e))},Ae.prototype.isDTMFSupported=function(){return this.somebodySupportsDTMF},Ae.prototype.myUserId=function(){return this.room&&this.room.myroomjid?m.Strophe.getResourceFromJid(this.room.myroomjid):null},Ae.prototype.sendTones=function(e,t,n){var i=this.getActivePeerConnection();i?i.sendTones(e,t,n):ye.warn("cannot sendTones: no peer connection")},Ae.prototype.startRecording=function(e){return this.room?this.recordingManager.startRecording(e):Promise.reject(new Error("The conference is not created yet!"))},Ae.prototype.stopRecording=function(e){return this.room?this.recordingManager.stopRecording(e):Promise.reject(new Error("The conference is not created yet!"))},Ae.prototype.isSIPCallingSupported=function(){return!!this.room&&this.room.isSIPCallingSupported()},Ae.prototype.dial=function(e){return this.room?this.room.dial(e):new Promise((function(e,t){t(new Error("The conference is not created yet!"))}))},Ae.prototype.hangup=function(){return this.room?this.room.hangup():new Promise((function(e,t){t(new Error("The conference is not created yet!"))}))},Ae.prototype.startTranscriber=function(){return this.dial("jitsi_meet_transcribe")},Ae.prototype.stopTranscriber=Ae.prototype.hangup,Ae.prototype.getPhoneNumber=function(){return this.room?this.room.getPhoneNumber():null},Ae.prototype.getPhonePin=function(){return this.room?this.room.getPhonePin():null},Ae.prototype.getMeetingUniqueId=function(){if(this.room)return this.room.getMeetingId()},Ae.prototype.getActivePeerConnection=function(){var e=this.isP2PActive()?this.p2pJingleSession:this.jvbJingleSession;return e?e.peerconnection:null},Ae.prototype.getConnectionState=function(){var e=this.getActivePeerConnection();return e?e.getConnectionState():null},Ae.prototype.setStartMutedPolicy=function(e){this.isModerator()?(this.startMutedPolicy=e,this.room.addOrReplaceInPresence("startmuted",{attributes:{audio:e.audio,video:e.video,xmlns:"http://jitsi.org/jitmeet/start-muted"}})&&this.room.sendPresence()):ye.warn("Failed to set start muted policy, ".concat(this.room?"":"not in a room, ").concat(this.isModerator()?"":"participant is not a moderator"))},Ae.prototype.getStartMutedPolicy=function(){return this.startMutedPolicy},Ae.prototype.isStartAudioMuted=function(){return this.startAudioMuted},Ae.prototype.isStartVideoMuted=function(){return this.startVideoMuted},Ae.prototype.getConnectionTimes=function(){return this.room.connectionTimes},Ae.prototype.setLocalParticipantProperty=function(e,t){this.sendCommand("jitsi_participant_".concat(e),{value:t})},Ae.prototype.removeLocalParticipantProperty=function(e){this.removeCommand("jitsi_participant_".concat(e)),this.room.sendPresence()},Ae.prototype.getLocalParticipantProperty=function(e){var t=this.room.presMap.nodes.find((function(t){return t.tagName==="jitsi_participant_".concat(e)}));return t?t.value:void 0},Ae.prototype.sendFeedback=function(e,t){return this.statistics.sendFeedback(e,t)},Ae.prototype.isCallstatsEnabled=function(){return this.statistics.isCallstatsEnabled()},Ae.prototype.getSsrcByTrack=function(e){var t;return e.isLocal()?null===(t=this.getActivePeerConnection())||void 0===t?void 0:t.getLocalSSRC(e):e.getSSRC()},Ae.prototype._onTrackAttach=function(e,t){var n=e.isLocal(),i=null,o=e.isP2P,a=o?e.getParticipantId():"jitsi",r=o?this.p2pJingleSession&&this.p2pJingleSession.peerconnection:this.jvbJingleSession&&this.jvbJingleSession.peerconnection;n?r&&(i=r.getLocalSSRC(e)):i=e.getSSRC(),t.id&&i&&r&&this.statistics.associateStreamWithVideoTag(r,i,n,a,e.getUsageLabel(),t.id)},Ae.prototype.sendApplicationLog=function(e){W.a.sendLog(e)},Ae.prototype.isFocus=function(e){return this.room?this.room.isFocus(e):null},Ae.prototype._fireIncompatibleVersionsEvent=function(){this.eventEmitter.emit(b.CONFERENCE_FAILED,v.INCOMPATIBLE_SERVER_VERSIONS)},Ae.prototype.sendEndpointMessage=function(e,t){this.rtc.sendChannelMessage(e,t)},Ae.prototype.sendEndpointStatsMessage=function(e){this.rtc.sendEndpointStatsMessage(e)},Ae.prototype.broadcastEndpointMessage=function(e){this.sendEndpointMessage("",e)},Ae.prototype.sendMessage=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=typeof e;if("object"===i||!n&&"string"===i)if(n)this.sendEndpointMessage(t,e);else{var o=e,a="body";if("object"===i){a="json-message",o.hasOwnProperty(re.d)||(o[re.d]="");try{o=JSON.stringify(o)}catch(r){return void ye.error("Can not send a message, stringify failed: ",r)}}t?this.sendPrivateTextMessage(t,o,a):this.sendTextMessage(o,a)}else ye.error("Can not send a message of type ".concat(i))},Ae.prototype.isConnectionInterrupted=function(){return this.isP2PActive()?this.isP2PConnectionInterrupted:this.isJvbConnectionInterrupted},Ae.prototype._onConferenceRestarted=function(e){!e.isP2P&&this.options.config.enableForcedReload&&this.eventEmitter.emit(b.CONFERENCE_FAILED,v.CONFERENCE_RESTARTED)},Ae.prototype._onIceConnectionInterrupted=function(e){e.isP2P?this.isP2PConnectionInterrupted=!0:this.isJvbConnectionInterrupted=!0,e.isP2P===this.isP2PActive()&&this.eventEmitter.emit(b.CONNECTION_INTERRUPTED)},Ae.prototype._onIceConnectionFailed=function(e){e.isP2P?(W.a.analytics.addPermanentProperties({p2pFailed:!0}),this.p2pJingleSession&&W.a.sendAnalyticsAndLog(Object(ge.I)(ge.j,{initiator:this.p2pJingleSession.isInitiator})),this._stopP2PSession({reason:"connectivity-error",reasonDescription:"ICE FAILED"})):e&&this.jvbJingleSession===e&&(this._delayedIceFailed=new R.a(this),this._delayedIceFailed.start(e))},Ae.prototype._onIceConnectionRestored=function(e){e.isP2P?this.isP2PConnectionInterrupted=!1:(this.isJvbConnectionInterrupted=!1,this._delayedIceFailed&&this._delayedIceFailed.cancel()),e.isP2P===this.isP2PActive()&&this.eventEmitter.emit(b.CONNECTION_RESTORED)},Ae.prototype._acceptP2PIncomingCall=function(e,t){var n=this;this.isP2PConnectionInterrupted=!1,this.p2pJingleSession=e,this._sendConferenceJoinAnalyticsEvent(),this.p2pJingleSession.initialize(this.room,this.rtc,this._signalingLayer,Object(l.a)(Object(l.a)({},this.options.config),{},{enableInsertableStreams:this.isE2EEEnabled()})),ye.info("Starting CallStats for P2P connection...");var i=m.Strophe.getResourceFromJid(this.p2pJingleSession.remoteJid),o=this.participants[i];o&&(i=o.getStatsID()||i),this.statistics.startCallStats(this.p2pJingleSession.peerconnection,i);var a=this.getLocalTracks();this.p2pJingleSession.acceptOffer(t,(function(){ye.debug('Got RESULT for P2P "session-accept"'),n.eventEmitter.emit(b._MEDIA_SESSION_STARTED,e)}),(function(e){ye.error("Failed to accept incoming P2P Jingle session",e)}),a)},Ae.prototype._addRemoteJVBTracks=function(){this._addRemoteTracks("JVB",this.jvbJingleSession.peerconnection.getRemoteTracks())},Ae.prototype._addRemoteP2PTracks=function(){this._addRemoteTracks("P2P",this.p2pJingleSession.peerconnection.getRemoteTracks())},Ae.prototype._addRemoteTracks=function(e,t){var n,i=Object(a.a)(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;ye.info("Adding remote ".concat(e," track: ").concat(o)),this.onRemoteTrackAdded(o)}}catch(r){i.e(r)}finally{i.f()}},Ae.prototype._onIceConnectionEstablished=function(e){null!==this.p2pJingleSession&&(this.p2pEstablishmentDuration=this.p2pJingleSession.establishmentDuration),null!==this.jvbJingleSession&&(this.jvbEstablishmentDuration=this.jvbJingleSession.establishmentDuration);var t=!1,n=this.options.config.forceJVB121Ratio;if(e.isP2P?this.p2pJingleSession!==e?(ye.error("CONNECTION_ESTABLISHED - wrong P2P session instance ?!"),t=!0):!e.isInitiator&&"number"===typeof n&&Math.random()<n&&(ye.info("Forcing JVB 121 mode (ratio=".concat(n,")...")),W.a.analytics.addPermanentProperties({forceJvb121:!0}),this._stopP2PSession({reason:"decline",reasonDescription:"force JVB121"}),t=!0):t=!0,!isNaN(this.p2pEstablishmentDuration)&&!isNaN(this.jvbEstablishmentDuration)){var i=this.p2pEstablishmentDuration-this.jvbEstablishmentDuration;W.a.sendAnalytics(ge.p,{value:i})}e.isP2P===this.isP2PActive()&&this.eventEmitter.emit(b.CONNECTION_ESTABLISHED),t||(this._setP2PStatus(!0),this.jvbJingleSession?this._removeRemoteJVBTracks():ye.info("Not removing remote JVB tracks - no session yet"),this._addRemoteP2PTracks(),this.jvbJingleSession&&this._suspendMediaTransferForJvbConnection(),ye.info("Starting remote stats with p2p connection"),this.statistics.startRemoteStats(this.p2pJingleSession.peerconnection),W.a.sendAnalyticsAndLog(Object(ge.I)(ge.i,{initiator:this.p2pJingleSession.isInitiator})))},Ae.prototype._updateProperties=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!f()(e,this.properties);if(this.properties=e,t){this.eventEmitter.emit(b.PROPERTIES_CHANGED,this.properties);var n="true"===this.properties["audio-limit-reached"],o="true"===this.properties["video-limit-reached"];this._audioSenderLimitReached!==n&&(this._audioSenderLimitReached=n,this.eventEmitter.emit(b.AUDIO_UNMUTE_PERMISSIONS_CHANGED,n),ye.info("Audio unmute permissions set by Jicofo to ".concat(n))),this._videoSenderLimitReached!==o&&(this._videoSenderLimitReached=o,this.eventEmitter.emit(b.VIDEO_UNMUTE_PERMISSIONS_CHANGED,o),ye.info("Video unmute permissions set by Jicofo to ".concat(o)));var a=["bridge-count","created-ms"];a.forEach((function(t){void 0!==e[t]&&W.a.analytics.addPermanentProperties(Object(i.a)({},t.replace("-","_"),e[t]))}))}},Ae.prototype.getProperty=function(e){return this.properties[e]},Ae.prototype._maybeClearDeferredStartP2P=function(){this.deferredStartP2PTask&&(ye.info("Cleared deferred start P2P task"),clearTimeout(this.deferredStartP2PTask),this.deferredStartP2PTask=null)},Ae.prototype._removeRemoteJVBTracks=function(){this._removeRemoteTracks("JVB",this.jvbJingleSession.peerconnection.getRemoteTracks())},Ae.prototype._removeRemoteP2PTracks=function(){this._removeRemoteTracks("P2P",this.p2pJingleSession.peerconnection.getRemoteTracks())},Ae.prototype._removeRemoteTracks=function(e,t){var n,i=Object(a.a)(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;ye.info("Removing remote ".concat(e," track: ").concat(o)),this.onRemoteTrackRemoved(o)}}catch(r){i.e(r)}finally{i.f()}},Ae.prototype._resumeMediaTransferForJvbConnection=function(){ye.info("Resuming media transfer over the JVB connection..."),this.jvbJingleSession.setMediaTransferActive(!0,!0).then((function(){ye.info("Resumed media transfer over the JVB connection!")}),(function(e){ye.error("Failed to resume media transfer over the JVB connection:",e)}))},Ae.prototype._setP2PStatus=function(e){if(this.p2p!==e){if(this.p2p=e,e){ye.info("Peer to peer connection established!"),W.a.analytics.addPermanentProperties({p2pFailed:!1,forceJvb121:!1});var t=0!==this.getLastN();this.p2pJingleSession.setMediaTransferActive(!0,t).catch((function(e){ye.error("Failed to sync up P2P video transfer status"+"(".concat(t,")"),e)}))}else ye.info("Peer to peer connection closed!");this.jvbJingleSession&&this.statistics.sendConnectionResumeOrHoldEvent(this.jvbJingleSession.peerconnection,!e),this.dtmfManager=null,this.eventEmitter.emit(b.P2P_STATUS,this,this.p2p),this.eventEmitter.emit(b._MEDIA_SESSION_ACTIVE_CHANGED,this._getActiveMediaSession()),this.eventEmitter.emit(this.isConnectionInterrupted()?b.CONNECTION_INTERRUPTED:b.CONNECTION_RESTORED)}else ye.debug("Called _setP2PStatus with the same status: ".concat(e))},Ae.prototype._startP2PSession=function(e){if(this._maybeClearDeferredStartP2P(),this.p2pJingleSession)ye.error("P2P session already started!");else{this.isP2PConnectionInterrupted=!1,this.p2pJingleSession=this.xmpp.connection.jingle.newP2PJingleSession(this.room.myroomjid,e),ye.info("Created new P2P JingleSession",this.room.myroomjid,e),this._sendConferenceJoinAnalyticsEvent(),this.p2pJingleSession.initialize(this.room,this.rtc,this._signalingLayer,Object(l.a)(Object(l.a)({},this.options.config),{},{enableInsertableStreams:this.isE2EEEnabled()})),ye.info("Starting CallStats for P2P connection...");var t=m.Strophe.getResourceFromJid(this.p2pJingleSession.remoteJid),n=this.participants[t];n&&(t=n.getStatsID()||t),this.statistics.startCallStats(this.p2pJingleSession.peerconnection,t);var i=this.getLocalTracks();this.p2pJingleSession.invite(i)}},Ae.prototype._suspendMediaTransferForJvbConnection=function(){ye.info("Suspending media transfer over the JVB connection..."),this.jvbJingleSession.setMediaTransferActive(!1,!1).then((function(){ye.info("Suspended media transfer over the JVB connection !")}),(function(e){ye.error("Failed to suspend media transfer over the JVB connection:",e)}))},Ae.prototype._maybeStartOrStopP2P=function(e){if(!this.isP2PEnabled()||this.isP2PTestModeEnabled()||k.a.isFirefox()||k.a.isWebKitBased()||this.isE2EEEnabled())ye.info("Auto P2P disabled");else{var t=this.getParticipants(),n=t.length,i=this._shouldBeInP2PMode();if(!i&&this.deferredStartP2PTask&&this._maybeClearDeferredStartP2P(),!this.p2pJingleSession&&i){var o=n&&t[0],a=this.myUserId(),r=o.getId();if(a>r)return void ye.debug("I'm the bigger peersId - the other peer should start P2P",a,r);if(a===r)return void ye.error("The same IDs ? ",a,r);var s=o.getJid();if(e){if(this.deferredStartP2PTask)return void ye.error("Deferred start P2P task's been set already!");ye.info("Will start P2P with: ".concat(s," after ").concat(this.backToP2PDelay," seconds...")),this.deferredStartP2PTask=setTimeout(this._startP2PSession.bind(this,s),1e3*this.backToP2PDelay)}else ye.info("Will start P2P with: ".concat(s)),this._startP2PSession(s)}else this.p2pJingleSession&&!i&&(ye.info("Will stop P2P with: ".concat(this.p2pJingleSession.remoteJid)),this.p2pJingleSession.isInitiator&&n>1&&W.a.sendAnalyticsAndLog(Object(ge.I)(ge.k)),this._stopP2PSession())}},Ae.prototype._shouldBeInP2PMode=function(){var e=this.getParticipants(),t=e.length,n=void 0!==e.find((function(e){return"poltergeist"===e.getBotType()||e.hasFeature(re.c)})),i=1===t&&!n;return ye.debug("P2P? peerCount: ".concat(t,", hasBotPeer: ").concat(n," => ").concat(i)),i},Ae.prototype._stopP2PSession=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.reason,n=void 0===t?"success":t,i=e.reasonDescription,o=void 0===i?"Turning off P2P session":i,a=e.requestRestart,r=void 0!==a&&a;if(this.p2pJingleSession){var s=this.isP2PActive();s&&(this.jvbJingleSession&&!r&&this._resumeMediaTransferForJvbConnection(),this._removeRemoteP2PTracks()),ye.info("Stopping remote stats for P2P connection"),this.statistics.stopRemoteStats(this.p2pJingleSession.peerconnection),ye.info("Stopping CallStats for P2P connection"),this.statistics.stopCallStats(this.p2pJingleSession.peerconnection),this.p2pJingleSession.terminate((function(){ye.info("P2P session terminate RESULT")}),(function(e){n&&ye.error("An error occurred while trying to terminate P2P Jingle session",e)}),{reason:n,reasonDescription:o,sendSessionTerminate:this.room&&this.getParticipantById(m.Strophe.getResourceFromJid(this.p2pJingleSession.remoteJid))}),this.p2pJingleSession=null,this._setP2PStatus(!1),s&&(this.jvbJingleSession&&!r?this._addRemoteJVBTracks():ye.info("Not adding remote JVB tracks - no session yet"))}else ye.error("No P2P session to be stopped!")},Ae.prototype.isP2PActive=function(){return this.p2p},Ae.prototype.getP2PConnectionState=function(){return this.isP2PActive()?this.p2pJingleSession.peerconnection.getConnectionState():null},Ae.prototype.setDesktopSharingFrameRate=function(e){return"number"!==typeof e||isNaN(e)?(ye.error("Invalid value ".concat(e," specified for desktop capture frame rate")),!1):(this._desktopSharingFrameRate=e,this.jvbJingleSession&&this.jvbJingleSession.peerconnection.setDesktopSharingFrameRate(e),this.rtc.setDesktopSharingFrameRate(e),!0)},Ae.prototype.startP2PSession=function(){var e=this.getParticipants();if(1!==e.length)throw new Error("There must be exactly 1 participant to start the P2P session !");var t=e[0].getJid();this._startP2PSession(t)},Ae.prototype.stopP2PSession=function(e){this._stopP2PSession(e)},Ae.prototype.getSpeakerStats=function(){return this.speakerStatsCollector.getStats()},Ae.prototype.sendFacialExpression=function(e){this.xmpp.sendFacialExpressionEvent(this.room.roomjid,e)},Ae.prototype.setReceiverConstraints=function(e){this.receiveVideoController.setReceiverConstraints(e)},Ae.prototype.setReceiverVideoConstraint=function(e){this.receiveVideoController.setPreferredReceiveMaxFrameHeight(e)},Ae.prototype.setSenderVideoConstraint=function(e){return this.sendVideoController.setPreferredSendMaxFrameHeight(e)},Ae.prototype.createVideoSIPGWSession=function(e,t){return this.room?this.videoSIPGWHandler.createVideoSIPGWSession(e,t):new Error(oe.ERROR_NO_CONNECTION)},Ae.prototype._sendConferenceJoinAnalyticsEvent=function(){var e=this.getMeetingUniqueId();!this._conferenceJoinAnalyticsEventSent&&e&&null!==this.getActivePeerConnection()&&(W.a.sendAnalytics(Object(ge.A)("joined",{meetingId:e,participantId:"".concat(e,".").concat(this._statsCurrentId)})),this._conferenceJoinAnalyticsEventSent=Date.now())},Ae.prototype._sendConferenceLeftAnalyticsEvent=function(){var e=this.getMeetingUniqueId();e&&this._conferenceJoinAnalyticsEventSent&&W.a.sendAnalytics(Object(ge.A)("left",{meetingId:e,participantId:"".concat(e,".").concat(this._statsCurrentId),stats:{duration:Math.floor((Date.now()-this._conferenceJoinAnalyticsEventSent)/1e3),perf:this.getPerformanceStats()}}))},Ae.prototype._restartMediaSessions=function(){this.p2pJingleSession&&this._stopP2PSession({reasonDescription:"restart",requestRestart:!0}),this.jvbJingleSession&&this.jvbJingleSession.terminate(null,(function(e){ye.warn("An error occurred while trying to terminate the JVB session",e)}),{reason:"success",reasonDescription:"restart required",requestRestart:!0,sendSessionTerminate:!0}),this._maybeStartOrStopP2P(!1)},Ae.prototype.isE2EEEnabled=function(){return Boolean(this._e2eEncryption&&this._e2eEncryption.isEnabled())},Ae.prototype.isE2EESupported=function(){return L.a.isSupported(this.options.config)},Ae.prototype.toggleE2EE=function(e){this.isE2EESupported()?this._e2eEncryption.setEnabled(e):ye.warn("Cannot enable / disable E2EE: platform is not supported.")},Ae.prototype.setMediaEncryptionKey=function(e){this._e2eEncryption.setEncryptionKey(e)},Ae.prototype.isLobbySupported=function(){return Boolean(this.room&&this.room.getLobby().isSupported())},Ae.prototype.isMembersOnly=function(){return Boolean(this.room&&this.room.membersOnlyEnabled)},Ae.prototype.enableLobby=function(){return this.room&&this.isModerator()?this.room.getLobby().enable():Promise.reject(new Error("The conference not started or user is not moderator"))},Ae.prototype.disableLobby=function(){this.room&&this.isModerator()?this.room.getLobby().disable():ye.warn("Failed to disable lobby, ".concat(this.room?"":"not in a room, ").concat(this.isModerator()?"":"participant is not a moderator"))},Ae.prototype.joinLobby=function(e,t){return this.room?this.room.getLobby().join(e,t):Promise.reject(new Error("The conference not started"))},Ae.prototype.lobbyDenyAccess=function(e){this.room&&this.room.getLobby().denyAccess(e)},Ae.prototype.lobbyApproveAccess=function(e){this.room&&this.room.getLobby().approveAccess(e)},Ae.prototype.isAVModerationSupported=function(){return Boolean(this.room&&this.room.getAVModeration().isSupported())},Ae.prototype.enableAVModeration=function(e){this.room&&this.isModerator()&&(e===de.AUDIO||e===de.VIDEO)?this.room.getAVModeration().enable(!0,e):ye.warn("Failed to enable AV moderation, ".concat(this.room?"":"not in a room, ").concat(this.isModerator()?"":"participant is not a moderator, ").concat(this.room&&this.isModerator()?"wrong media type passed":""))},Ae.prototype.disableAVModeration=function(e){this.room&&this.isModerator()&&(e===de.AUDIO||e===de.VIDEO)?this.room.getAVModeration().enable(!1,e):ye.warn("Failed to disable AV moderation, ".concat(this.room?"":"not in a room, ").concat(this.isModerator()?"":"participant is not a moderator, ").concat(this.room&&this.isModerator()?"wrong media type passed":""))},Ae.prototype.avModerationApprove=function(e,t){if(this.room&&this.isModerator()&&(e===de.AUDIO||e===de.VIDEO)){var n=this.getParticipantById(t);if(!n)return;this.room.getAVModeration().approve(e,n.getJid())}else ye.warn("AV moderation approve skipped , ".concat(this.room?"":"not in a room, ").concat(this.isModerator()?"":"participant is not a moderator, ").concat(this.room&&this.isModerator()?"wrong media type passed":""))},Ae.prototype.avModerationReject=function(e,t){if(this.room&&this.isModerator()&&(e===de.AUDIO||e===de.VIDEO)){var n=this.getParticipantById(t);if(!n)return;this.room.getAVModeration().reject(e,n.getJid())}else ye.warn("AV moderation reject skipped , ".concat(this.room?"":"not in a room, ").concat(this.isModerator()?"":"participant is not a moderator, ").concat(this.room&&this.isModerator()?"wrong media type passed":""))},Ae.prototype.getBreakoutRooms=function(){var e;return null===(e=this.room)||void 0===e?void 0:e.getBreakoutRooms()}}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return E}));var i=n(22),o=n(15),a=n(66),r=n(12),s=n(143),c=n(28),l=n(359),u=n.n(l),d=n(20),p=n(31),h=n.n(p),f=n(45),m=n.n(f),v=n(289),g=n.n(v),b=n(35),y=n(11),A=n.n(y),S=Object(i.getLogger)(e);function E(e){this.conference=e,this.xmppListeners={},e.on(r.TRACK_MUTE_CHANGED,(function(t){if(t.isLocal()&&e.statistics){var n=t.isP2P?e.p2pJingleSession:e.jvbJingleSession,i=n&&n.peerconnection||null;e.statistics.sendMuteEvent(i,t.isMuted(),t.getType())}}))}E.prototype.setupChatRoomListeners=function(){var e=this,t=this.conference,n=t.room;this.chatRoomForwarder=new u.a(n,this.conference.eventEmitter),n.addListener(A.a.ICE_RESTARTING,(function(e){e.isP2P||t.rtc.closeBridgeChannel()})),n.addListener(A.a.PARTICIPANT_FEATURES_CHANGED,(function(e,n){var i=t.getParticipantById(o.Strophe.getResourceFromJid(e));i&&(i.setFeatures(n),t.eventEmitter.emit(r.PARTCIPANT_FEATURES_CHANGED,i))})),n.addListener(A.a.ICE_RESTART_SUCCESS,(function(e,n){!e.isP2P&&t._setBridgeChannel(n,e.peerconnection)})),n.addListener(A.a.AUDIO_MUTED_BY_FOCUS,(function(e){c.a.sendAnalytics(Object(b.K)(d.AUDIO)),t.mutedByFocusActor=e,t.rtc.setAudioMute(!0).then((function(){t.isMutedByFocus=!0,t.mutedByFocusActor=null})).catch((function(e){t.mutedByFocusActor=null,S.warn("Error while audio muting due to focus request",e)}))})),n.addListener(A.a.VIDEO_MUTED_BY_FOCUS,(function(e){c.a.sendAnalytics(Object(b.K)(d.VIDEO)),t.mutedVideoByFocusActor=e,t.rtc.setVideoMute(!0).then((function(){t.isVideoMutedByFocus=!0,t.mutedVideoByFocusActor=null})).catch((function(e){t.mutedVideoByFocusActor=null,S.warn("Error while video muting due to focus request",e)}))})),this.chatRoomForwarder.forward(A.a.SUBJECT_CHANGED,r.SUBJECT_CHANGED),this.chatRoomForwarder.forward(A.a.MUC_JOINED,r.CONFERENCE_JOINED),this.chatRoomForwarder.forward(A.a.MUC_JOIN_IN_PROGRESS,r.CONFERENCE_JOIN_IN_PROGRESS),this.chatRoomForwarder.forward(A.a.MEETING_ID_SET,r.CONFERENCE_UNIQUE_ID_SET),n.addListener(A.a.MUC_JOINED,(function(){e.conference._onMucJoined(),e.conference.isJvbConnectionInterrupted=!1,Object.keys(n.connectionTimes).forEach((function(e){var t=Object(b.C)("conference_".concat(e),{value:n.connectionTimes[e]});c.a.sendAnalytics(t)})),Object.keys(n.xmpp.connectionTimes).forEach((function(e){var t=Object(b.C)("xmpp_".concat(e),{value:n.xmpp.connectionTimes[e]});c.a.sendAnalytics(t)}))})),n.addListener(A.a.RENEGOTIATION_FAILED,(function(e,n){n.isP2P||t.eventEmitter.emit(r.CONFERENCE_FAILED,a.OFFER_ANSWER_FAILED,e)})),this.chatRoomForwarder.forward(A.a.ROOM_JOIN_ERROR,r.CONFERENCE_FAILED,a.CONNECTION_ERROR),this.chatRoomForwarder.forward(A.a.ROOM_CONNECT_ERROR,r.CONFERENCE_FAILED,a.CONNECTION_ERROR),this.chatRoomForwarder.forward(A.a.ROOM_CONNECT_NOT_ALLOWED_ERROR,r.CONFERENCE_FAILED,a.NOT_ALLOWED_ERROR),this.chatRoomForwarder.forward(A.a.ROOM_CONNECT_MEMBERS_ONLY_ERROR,r.CONFERENCE_FAILED,a.MEMBERS_ONLY_ERROR),this.chatRoomForwarder.forward(A.a.ROOM_MAX_USERS_ERROR,r.CONFERENCE_FAILED,a.CONFERENCE_MAX_USERS),this.chatRoomForwarder.forward(A.a.PASSWORD_REQUIRED,r.CONFERENCE_FAILED,a.PASSWORD_REQUIRED),this.chatRoomForwarder.forward(A.a.AUTHENTICATION_REQUIRED,r.CONFERENCE_FAILED,a.AUTHENTICATION_REQUIRED),this.chatRoomForwarder.forward(A.a.BRIDGE_DOWN,r.CONFERENCE_FAILED,a.VIDEOBRIDGE_NOT_AVAILABLE),n.addListener(A.a.BRIDGE_DOWN,(function(){return c.a.sendAnalytics(Object(b.z)())})),n.addListener(A.a.CONNECTION_RESTARTED,(function(e){t._onConferenceRestarted(e)})),this.chatRoomForwarder.forward(A.a.RESERVATION_ERROR,r.CONFERENCE_FAILED,a.RESERVATION_ERROR),this.chatRoomForwarder.forward(A.a.GRACEFUL_SHUTDOWN,r.CONFERENCE_FAILED,a.GRACEFUL_SHUTDOWN),n.addListener(A.a.CONNECTION_ICE_FAILED,(function(e){t._onIceConnectionFailed(e)})),this.chatRoomForwarder.forward(A.a.MUC_DESTROYED,r.CONFERENCE_FAILED,a.CONFERENCE_DESTROYED),this.chatRoomForwarder.forward(A.a.CHAT_ERROR_RECEIVED,r.CONFERENCE_ERROR,a.CHAT_ERROR),this.chatRoomForwarder.forward(A.a.FOCUS_DISCONNECTED,r.CONFERENCE_FAILED,a.FOCUS_DISCONNECTED),n.addListener(A.a.FOCUS_LEFT,(function(){c.a.sendAnalytics(Object(b.E)()),t.eventEmitter.emit(r.CONFERENCE_FAILED,a.FOCUS_LEFT)})),n.addListener(A.a.SESSION_ACCEPT_TIMEOUT,(function(e){c.a.sendAnalyticsAndLog(Object(b.G)(b.b,{p2p:e.isP2P}))})),n.addListener(A.a.RECORDER_STATE_CHANGED,(function(e,n){if(n){var i=o.Strophe.getResourceFromJid(n),a=t.getParticipantById(i)||i;"off"===e.getStatus()?e.setTerminator(a):"on"===e.getStatus()&&e.setInitiator(a)}t.eventEmitter.emit(r.RECORDER_STATE_CHANGED,e)})),this.chatRoomForwarder.forward(A.a.TRANSCRIPTION_STATUS_CHANGED,r.TRANSCRIPTION_STATUS_CHANGED),this.chatRoomForwarder.forward(A.a.VIDEO_SIP_GW_AVAILABILITY_CHANGED,r.VIDEO_SIP_GW_AVAILABILITY_CHANGED),this.chatRoomForwarder.forward(A.a.VIDEO_SIP_GW_SESSION_STATE_CHANGED,r.VIDEO_SIP_GW_SESSION_STATE_CHANGED),this.chatRoomForwarder.forward(A.a.PHONE_NUMBER_CHANGED,r.PHONE_NUMBER_CHANGED),n.setParticipantPropertyListener((function(e,n){var i=t.getParticipantById(n);i&&i.setProperty(e.tagName.substring("jitsi_participant_".length),e.value)})),n.addListener(A.a.KICKED,t.onMemberKicked.bind(t)),n.addListener(A.a.SUSPEND_DETECTED,t.onSuspendDetected.bind(t)),this.chatRoomForwarder.forward(A.a.MUC_LOCK_CHANGED,r.LOCK_STATE_CHANGED),this.chatRoomForwarder.forward(A.a.MUC_MEMBERS_ONLY_CHANGED,r.MEMBERS_ONLY_CHANGED),n.addListener(A.a.MUC_MEMBER_JOINED,t.onMemberJoined.bind(t)),this.chatRoomForwarder.forward(A.a.MUC_LOBBY_MEMBER_JOINED,r.LOBBY_USER_JOINED),this.chatRoomForwarder.forward(A.a.MUC_LOBBY_MEMBER_UPDATED,r.LOBBY_USER_UPDATED),this.chatRoomForwarder.forward(A.a.MUC_LOBBY_MEMBER_LEFT,r.LOBBY_USER_LEFT),n.addListener(A.a.MUC_MEMBER_BOT_TYPE_CHANGED,t._onMemberBotTypeChanged.bind(t)),n.addListener(A.a.MUC_MEMBER_LEFT,t.onMemberLeft.bind(t)),this.chatRoomForwarder.forward(A.a.MUC_LEFT,r.CONFERENCE_LEFT),this.chatRoomForwarder.forward(A.a.MUC_DENIED_ACCESS,r.CONFERENCE_FAILED,a.CONFERENCE_ACCESS_DENIED),n.addListener(A.a.DISPLAY_NAME_CHANGED,t.onDisplayNameChanged.bind(t)),n.addListener(A.a.LOCAL_ROLE_CHANGED,(function(e){t.onLocalRoleChanged(e),t.statistics&&t.isModerator()&&t.on(r.RECORDER_STATE_CHANGED,(function(e){var t={error:e.getError(),id:"recorder_status",status:e.getStatus()};c.a.sendLog(JSON.stringify(t))}))})),n.addListener(A.a.MUC_ROLE_CHANGED,t.onUserRoleChanged.bind(t)),n.addListener(g.a.IDENTITY_UPDATED,(function(e,n){t.authEnabled=e,t.authIdentity=n,t.eventEmitter.emit(r.AUTH_STATUS_CHANGED,e,n)})),n.addListener(A.a.MESSAGE_RECEIVED,(function(e,n,i,a){var s=o.Strophe.getResourceFromJid(e);t.eventEmitter.emit(r.MESSAGE_RECEIVED,s,n,a)})),n.addListener(A.a.PRIVATE_MESSAGE_RECEIVED,(function(e,n,i,a){var s=o.Strophe.getResourceFromJid(e);t.eventEmitter.emit(r.PRIVATE_MESSAGE_RECEIVED,s,n,a)})),n.addListener(A.a.PRESENCE_STATUS,(function(e,n){var i=o.Strophe.getResourceFromJid(e),a=t.getParticipantById(i);a&&a._status!==n&&(a._status=n,t.eventEmitter.emit(r.USER_STATUS_CHANGED,i,n))})),n.addListener(A.a.JSON_MESSAGE_RECEIVED,(function(e,n){var i=o.Strophe.getResourceFromJid(e),a=t.getParticipantById(i);a&&(t.eventEmitter.emit(r.ENDPOINT_MESSAGE_RECEIVED,a,n),t.eventEmitter.emit(r.NON_PARTICIPANT_MESSAGE_RECEIVED,i,n))})),n.addPresenceListener("startmuted",(function(e,n){var i=!1;if(t.myUserId()===n&&t.isModerator())i=!0;else{var o=t.getParticipantById(n);o&&o.isModerator()&&(i=!0)}if(i){var a="true"===e.attributes.audio,s="true"===e.attributes.video,c=!1;a!==t.startMutedPolicy.audio&&(t.startMutedPolicy.audio=a,c=!0),s!==t.startMutedPolicy.video&&(t.startMutedPolicy.video=s,c=!0),c&&t.eventEmitter.emit(r.START_MUTED_POLICY_CHANGED,t.startMutedPolicy)}})),t.statistics&&(n.addListener(A.a.CONNECTION_ICE_FAILED,(function(e){t.statistics.sendIceConnectionFailedEvent(e.peerconnection)})),n.addListener(A.a.ADD_ICE_CANDIDATE_FAILED,(function(e,n){t.statistics.sendAddIceCandidateFailed(e,n)}))),this.chatRoomForwarder.forward(A.a.BREAKOUT_ROOMS_MOVE_TO_ROOM,r.BREAKOUT_ROOMS_MOVE_TO_ROOM),this.chatRoomForwarder.forward(A.a.BREAKOUT_ROOMS_UPDATED,r.BREAKOUT_ROOMS_UPDATED)},E.prototype.setupRTCListeners=function(){var e=this.conference,t=e.rtc;t.addListener(h.a.REMOTE_TRACK_ADDED,e.onRemoteTrackAdded.bind(e)),t.addListener(h.a.REMOTE_TRACK_REMOVED,e.onRemoteTrackRemoved.bind(e)),t.addListener(h.a.DOMINANT_SPEAKER_CHANGED,(function(t,n){if(e.lastDominantSpeaker!==t&&e.room){if(e.lastDominantSpeaker=t,e.eventEmitter.emit(r.DOMINANT_SPEAKER_CHANGED,t,n),n&&n.length){var i=n.slice(0);e.myUserId!==t&&i.splice(0,0,t),i.length>s.b&&i.splice(s.b,i.length-s.b),e.statistics&&e.statistics.setSpeakerList(i)}e.statistics&&e.myUserId()===t&&e.statistics.sendDominantSpeakerEvent(e.room.roomjid)}})),t.addListener(h.a.DATA_CHANNEL_OPEN,(function(){var t=window.performance.now(),n="data.channel.opened";S.log("(TIME) ".concat(n,":\t"),t),e.room.connectionTimes[n]=t,c.a.sendAnalytics(Object(b.C)(n,{value:t})),e.eventEmitter.emit(r.DATA_CHANNEL_OPENED)})),t.addListener(h.a.ENDPOINT_MESSAGE_RECEIVED,(function(t,n){var i=e.getParticipantById(t);i&&e.eventEmitter.emit(r.ENDPOINT_MESSAGE_RECEIVED,i,n)})),t.addListener(h.a.ENDPOINT_STATS_RECEIVED,(function(t,n){var i=e.getParticipantById(t);i?e.eventEmitter.emit(r.ENDPOINT_STATS_RECEIVED,i,n):S.warn("Ignoring ENDPOINT_STATS_RECEIVED for a non-existant participant: ".concat(t))})),t.addListener(h.a.LOCAL_UFRAG_CHANGED,(function(e,t){e.isP2P||c.a.sendLog(JSON.stringify({id:"local_ufrag",value:t}))})),t.addListener(h.a.REMOTE_UFRAG_CHANGED,(function(e,t){e.isP2P||c.a.sendLog(JSON.stringify({id:"remote_ufrag",value:t}))})),t.addListener(h.a.CREATE_ANSWER_FAILED,(function(t,n){e.statistics.sendCreateAnswerFailed(t,n),n.isP2P||e.eventEmitter.emit(r.CONFERENCE_FAILED,a.OFFER_ANSWER_FAILED,t)})),t.addListener(h.a.CREATE_OFFER_FAILED,(function(t,n){e.statistics.sendCreateOfferFailed(t,n),n.isP2P||e.eventEmitter.emit(r.CONFERENCE_FAILED,a.OFFER_ANSWER_FAILED,t)})),t.addListener(h.a.SET_LOCAL_DESCRIPTION_FAILED,(function(t,n){e.statistics.sendSetLocalDescFailed(t,n),n.isP2P||e.eventEmitter.emit(r.CONFERENCE_FAILED,a.OFFER_ANSWER_FAILED,t)})),t.addListener(h.a.SET_REMOTE_DESCRIPTION_FAILED,(function(t,n){e.statistics.sendSetRemoteDescFailed(t,n),n.isP2P||e.eventEmitter.emit(r.CONFERENCE_FAILED,a.OFFER_ANSWER_FAILED,t)})),t.addListener(h.a.LOCAL_TRACK_SSRC_UPDATED,(function(t,n){t.isVideoTrack()&&t.videoType===m.a.DESKTOP&&e.statistics.sendScreenSharingEvent(!0,n)}))},E.prototype.removeXMPPListeners=function(){var e=this,t=this.conference;Object.keys(this.xmppListeners).forEach((function(n){t.xmpp.removeListener(n,e.xmppListeners[n])})),this.xmppListeners={}},E.prototype.setupXMPPListeners=function(){var e=this.conference;this._addConferenceXMPPListener(A.a.CALL_INCOMING,e.onIncomingCall.bind(e)),this._addConferenceXMPPListener(A.a.CALL_ACCEPTED,e.onCallAccepted.bind(e)),this._addConferenceXMPPListener(A.a.TRANSPORT_INFO,e.onTransportInfo.bind(e)),this._addConferenceXMPPListener(A.a.CALL_ENDED,e.onCallEnded.bind(e)),this._addConferenceXMPPListener(A.a.START_MUTED_FROM_FOCUS,(function(t,n){e.options.config.ignoreStartMuted||(e.startAudioMuted=t,e.startVideoMuted=n,e.getLocalTracks().forEach((function(t){switch(t.getType()){case d.AUDIO:e.startAudioMuted&&t.mute();break;case d.VIDEO:e.startVideoMuted&&t.mute()}})),e.eventEmitter.emit(r.STARTED_MUTED))})),this._addConferenceXMPPListener(A.a.CONFERENCE_TIMESTAMP_RECEIVED,(function(t){e.eventEmitter.emit(r.CONFERENCE_CREATED_TIMESTAMP,t)})),this._addConferenceXMPPListener(A.a.AV_MODERATION_CHANGED,(function(t,n,i){var o=e.getParticipants().find((function(e){return e.getJid()===i}));e.eventEmitter.emit(r.AV_MODERATION_CHANGED,{enabled:t,mediaType:n,actor:o})})),this._addConferenceXMPPListener(A.a.AV_MODERATION_PARTICIPANT_APPROVED,(function(t,n){var i=e.getParticipantById(o.Strophe.getResourceFromJid(n));i&&e.eventEmitter.emit(r.AV_MODERATION_PARTICIPANT_APPROVED,{participant:i,mediaType:t})})),this._addConferenceXMPPListener(A.a.AV_MODERATION_PARTICIPANT_REJECTED,(function(t,n){var i=e.getParticipantById(o.Strophe.getResourceFromJid(n));i&&e.eventEmitter.emit(r.AV_MODERATION_PARTICIPANT_REJECTED,{participant:i,mediaType:t})})),this._addConferenceXMPPListener(A.a.AV_MODERATION_APPROVED,(function(t){return e.eventEmitter.emit(r.AV_MODERATION_APPROVED,{mediaType:t})})),this._addConferenceXMPPListener(A.a.AV_MODERATION_REJECTED,(function(t){e.eventEmitter.emit(r.AV_MODERATION_REJECTED,{mediaType:t})}))},E.prototype._addConferenceXMPPListener=function(e,t){this.xmppListeners[e]=t,this.conference.xmpp.addListener(e,t)},E.prototype.setupStatisticsListeners=function(){var e=this.conference;e.statistics&&(e.statistics.addAudioLevelListener((function(t,n,i,o){e.rtc.setAudioLevel(t,n,i,o)})),e.statistics.addBeforeDisposedListener((function(){e.eventEmitter.emit(r.BEFORE_STATISTICS_DISPOSED)})),e.options.config.startSilent||e.statistics.addByteSentStatsListener((function(t,n){e.getLocalTracks(d.AUDIO).forEach((function(e){var i=t.getLocalSSRC(e);i&&n.hasOwnProperty(i)&&e._onByteSentStatsReceived(t,n[i])}))})))}}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e,i){n.d(t,"a",(function(){return d}));var o=n(6),a=n(8),r=n(34),s=n(33),c=n(198),l=n(22),u=Object(l.getLogger)(e),d=function(e){Object(r.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(o.a)(this,n),e=t.call(this),u.info("This appears to be ".concat(e.getName(),", ver: ").concat(e.getVersion())),e}return Object(a.a)(n,[{key:"doesVideoMuteByStreamRemove",value:function(){return this.isChromiumBased()||this.isWebKitBased()||this.isFirefox()}},{key:"isChromiumBased",value:function(){return(this.isChrome()||this.isElectron()||this.isNWJS()||this.isOpera())&&!this.isWebKitBased()}},{key:"isIosBrowser",value:function(){var e=navigator,t=e.userAgent,n=e.maxTouchPoints,i=e.platform;return Boolean(t.match(/iP(ad|hone|od)/i))||n&&n>2&&/MacIntel/.test(i)}},{key:"isWebKitBased",value:function(){return this._bowser.isEngine("webkit")&&"undefined"!==typeof navigator.mediaDevices&&"undefined"!==typeof navigator.mediaDevices.getUserMedia&&"undefined"!==typeof window.RTCRtpTransceiver&&Object.keys(RTCRtpTransceiver.prototype).indexOf("currentDirection")>-1}},{key:"isTwa",value:function(){return"matchMedia"in window&&window.matchMedia("(display-mode:standalone)").matches}},{key:"isSupported",value:function(){return!(this.isSafari()&&this._getSafariVersion()<14)&&(this.isChromiumBased()&&this._getChromiumBasedVersion()>=72||this.isFirefox()||this.isReactNative()||this.isWebKitBased())}},{key:"isUserInteractionRequiredForUnmute",value:function(){return this.isFirefox()&&this.isVersionLessThan("68")}},{key:"supportsVideoMuteOnConnInterrupted",value:function(){return this.isChromiumBased()||this.isReactNative()}},{key:"supportsBandwidthStatistics",value:function(){return!this.isFirefox()&&!this.isWebKitBased()}},{key:"supportsCodecPreferences",value:function(){return Boolean(window.RTCRtpTransceiver&&"setCodecPreferences"in window.RTCRtpTransceiver.prototype&&window.RTCRtpReceiver&&"undefined"!==typeof window.RTCRtpReceiver.getCapabilities)&&!this.isWebKitBased()}},{key:"supportsDeviceChangeEvent",value:function(){return navigator.mediaDevices&&"undefined"!==typeof navigator.mediaDevices.ondevicechange&&"undefined"!==typeof navigator.mediaDevices.addEventListener}},{key:"supportsLocalCandidateRttStatistics",value:function(){return this.isChromiumBased()||this.isReactNative()||this.isWebKitBased()}},{key:"supportsPerformanceObserver",value:function(){return"undefined"!==typeof window.PerformanceObserver&&PerformanceObserver.supportedEntryTypes.indexOf("longtask")>-1}},{key:"supportsReceiverStats",value:function(){return"undefined"!==typeof window.RTCRtpReceiver&&Object.keys(RTCRtpReceiver.prototype).indexOf("getSynchronizationSources")>-1&&!this.isWebKitBased()}},{key:"supportsRTTStatistics",value:function(){return!this.isFirefox()}},{key:"supportsVP9",value:function(){return this.isChromiumBased()||this.isReactNative()}},{key:"usesSdpMungingForSimulcast",value:function(){return this.isChromiumBased()||this.isReactNative()||this.isWebKitBased()}},{key:"usesAdapter",value:function(){return!this.isReactNative()}},{key:"usesRidsForSimulcast",value:function(){return!1}},{key:"supportsGetDisplayMedia",value:function(){return"undefined"!==typeof navigator.getDisplayMedia||"undefined"!==typeof navigator.mediaDevices&&"undefined"!==typeof navigator.mediaDevices.getDisplayMedia}},{key:"supportsEncodedTransform",value:function(){return Boolean(window.RTCRtpScriptTransform)}},{key:"supportsInsertableStreams",value:function(){if("undefined"===typeof window.RTCRtpSender||!window.RTCRtpSender.prototype.createEncodedStreams)return!1;var e=new ReadableStream;try{return window.postMessage(e,"*",[e]),!0}catch(t){return!1}}},{key:"supportsAudioRed",value:function(){return Boolean(window.RTCRtpSender&&window.RTCRtpSender.getCapabilities&&window.RTCRtpSender.getCapabilities("audio").codecs.some((function(e){return"audio/red"===e.mimeType}))&&window.RTCRtpReceiver&&window.RTCRtpReceiver.getCapabilities&&window.RTCRtpReceiver.getCapabilities("audio").codecs.some((function(e){return"audio/red"===e.mimeType})))}},{key:"supportsUnifiedPlan",value:function(){return!this.isReactNative()}},{key:"supportsVADDetection",value:function(){return this.isChromiumBased()}},{key:"supportsRTX",value:function(){return!(this.isFirefox()&&this.isVersionLessThan("96"))}},{key:"_getChromiumBasedVersion",value:function(){if(this.isChromiumBased()){if(this.isNWJS())return Number.parseInt(i.versions.chromium,10);var e=navigator.userAgent;if(e.match(/Chrome/))return Number.parseInt(e.match(/Chrome\/([\d.]+)/)[1],10)}return-1}},{key:"_getSafariVersion",value:function(){return this.isSafari()?Number.parseInt(this.getVersion(),10):-1}}]),n}(c.a)}).call(this,"/index.js",n(187))},,,function(e,t,n){"use strict";(function(e){var i=n(5),o=n(6),a=n(8),r=n(22),s=n(35),c=n(21),l=Object(r.getLogger)(e),u=function(){function e(){Object(o.a)(this,e),this.reset()}return Object(a.a)(e,[{key:"reset",value:function(){this.disposed=!1,this.analyticsHandlers=new Set,this.cache=[],this.permanentProperties={},this.conferenceName="",this.addPermanentProperties({user_agent:navigator.userAgent,browser_name:c.a.getName()})}},{key:"dispose",value:function(){l.warn("Disposing of analytics adapter."),this.analyticsHandlers&&this.analyticsHandlers.size>0&&this.analyticsHandlers.forEach((function(e){"function"===typeof e.dispose&&e.dispose()})),this.setAnalyticsHandlers([]),this.disposed=!0}},{key:"setAnalyticsHandlers",value:function(e){var t=this;if(!this.disposed){this.analyticsHandlers=new Set(e),this._setUserProperties();var n=this.cache;this.cache=null,n&&n.forEach((function(e){return t._sendEvent(e)}))}}},{key:"_setUserProperties",value:function(){var e=this;this.analyticsHandlers.forEach((function(t){try{t.setUserProperties(e.permanentProperties)}catch(n){l.warn("Error in setUserProperties method of one of the "+"analytics handlers: ".concat(n))}}))}},{key:"addPermanentProperties",value:function(e){this.permanentProperties=Object(i.a)(Object(i.a)({},this.permanentProperties),e),this._setUserProperties()}},{key:"setConferenceName",value:function(e){this.conferenceName=e,this.addPermanentProperties({conference_name:e})}},{key:"sendEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.disposed){var n=null;"string"===typeof e?n={type:s.t,action:e,actionSubject:e,source:e,attributes:t}:"object"===typeof e&&(n=e),this._verifyRequiredFields(n)?this._sendEvent(n):l.error("Dropping a mis-formatted event: ".concat(JSON.stringify(n)))}}},{key:"_verifyRequiredFields",value:function(e){if(!e)return!1;e.type||(e.type=s.t);var t=e.type;return t!==s.t&&t!==s.u&&t!==s.w&&t!==s.v?(l.error("Unknown event type: ".concat(t)),!1):t===s.u?Boolean(e.name):(e.action=e.action||e.name||e.actionSubject,e.actionSubject=e.actionSubject||e.name||e.action,e.source=e.source||e.name||e.action||e.actionSubject,e.action&&e.actionSubject&&e.source?!!(t!==s.v||(e.objectType=e.objectType||"generic-object-type",e.containerType=e.containerType||"conference","conference"!==e.containerType||e.containerId||(e.containerId=this.conferenceName),e.objectType&&e.objectId&&e.containerType&&e.containerId))||(l.error("Required field missing (containerId, containerType, objectId or objectType)"),!1):(l.error("Required field missing (action, actionSubject or source)"),!1))}},{key:"_maybeCacheEvent",value:function(e){return!!this.cache&&(this.cache.push(e),this.cache.length>100&&this.cache.splice(0,1),!0)}},{key:"_sendEvent",value:function(e){this._maybeCacheEvent(e)||this.analyticsHandlers.forEach((function(t){try{t.sendEvent(e)}catch(n){l.warn("Error sending analytics event: ".concat(n))}}))}}]),e}();t.a=new u}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return u}));var i=n(14),o=n(6),a=n(8),r=n(22),s=n(83),c=n(103),l=Object(r.getLogger)(e),u=function(){function e(t,n){Object(o.a)(this,e),this.eventEmitter=t,this.longTasks=0,this.maxDuration=0,this.performanceStatsInterval=n,this.stats=new c.a}return Object(a.a)(e,[{key:"getLongTasksStats",value:function(){return{avgRatePerMinute:(60*this.stats.getAverage()).toFixed(2),maxDurationMs:this.maxDuration}}},{key:"startObserver",value:function(){var e=this;this.longTaskEventHandler=function(t){var n,o=t.getEntries(),a=Object(i.a)(o);try{for(a.s();!(n=a.n()).done;){var r=n.value;e.longTasks++,e.maxDuration=Math.max(e.maxDuration,r.duration).toFixed(3)}}catch(s){a.e(s)}finally{a.f()}},l.info("Creating a Performance Observer for monitoring Long Tasks"),this.observer=new PerformanceObserver(this.longTaskEventHandler),this.observer.observe({type:"longtask",buffered:!0});var t=Date.now();this.longTasksIntervalId=setInterval((function(){var n=Date.now(),i=e._lastTimeStamp?(n-e._lastTimeStamp)/1e3:(n-t)/1e3,o=e.longTasks/i;e.stats.addNext(o),e.eventEmitter.emit(s.e,e.getLongTasksStats()),e.longTasks=0,e._lastTimeStamp=Date.now()}),this.performanceStatsInterval)}},{key:"stopObserver",value:function(){this.observer&&this.observer.disconnect(),this.longTaskEventHandler=null,this.longTasksIntervalId&&(clearInterval(this.longTasksIntervalId),this.longTasksIntervalId=null)}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var i=n(19),o=n(14),a=n(22),r=n(20),s=n(83),c=n(21),l=n(43),u=Object(a.getLogger)(e);function d(e,t){return!t||t<=0||!e||e<=0?0:Math.round(e/t*100)}function p(){this.loss={},this.bitrate={download:0,upload:0},this.resolution={},this.framerate=0,this.codec=""}function h(){this.bandwidth={},this.bitrate={},this.packetLoss=null,this.transport=[]}function f(e,t,n,i){this.peerconnection=e,this.baselineAudioLevelsReport=null,this.currentAudioLevelsReport=null,this.currentStatsReport=null,this.previousStatsReport=null,this.audioLevelReportHistory={},this.audioLevelsIntervalId=null,this.eventEmitter=i,this.conferenceStats=new h,this.audioLevelsIntervalMilis=t,this.speakerList=[],this.statsIntervalId=null,this.statsIntervalMilis=n,this.ssrc2stats=new Map}p.prototype.setLoss=function(e){this.loss=e||{}},p.prototype.setResolution=function(e){this.resolution=e||{}},p.prototype.addBitrate=function(e){this.bitrate.download+=e.download,this.bitrate.upload+=e.upload},p.prototype.resetBitrate=function(){this.bitrate.download=0,this.bitrate.upload=0},p.prototype.setFramerate=function(e){this.framerate=e||0},p.prototype.setCodec=function(e){this.codec=e||""},f.prototype.setSpeakerList=function(e){this.speakerList=e},f.prototype.stop=function(){this.audioLevelsIntervalId&&(clearInterval(this.audioLevelsIntervalId),this.audioLevelsIntervalId=null),this.statsIntervalId&&(clearInterval(this.statsIntervalId),this.statsIntervalId=null)},f.prototype.errorCallback=function(e){l.callErrorHandler(e),u.error("Get stats error",e),this.stop()},f.prototype.start=function(e){var t=this;e&&(c.a.supportsReceiverStats()&&u.info("Using RTCRtpSynchronizationSource for remote audio levels"),this.audioLevelsIntervalId=setInterval((function(){if(c.a.supportsReceiverStats()){var e=t.peerconnection.getAudioLevels(t.speakerList);for(var n in e)if(e.hasOwnProperty(n)){var i=2.5*e[n];t.eventEmitter.emit(s.a,t.peerconnection,Number.parseInt(n,10),i,!1)}}else t.peerconnection.getStats().then((function(e){t.currentAudioLevelsReport="function"===typeof(null===e||void 0===e?void 0:e.result)?e.result():e,t.processAudioLevelReport(),t.baselineAudioLevelsReport=t.currentAudioLevelsReport})).catch((function(e){return t.errorCallback(e)}))}),this.audioLevelsIntervalMilis));var n=function(){t.peerconnection.getStats().then((function(e){t.currentStatsReport="function"===typeof(null===e||void 0===e?void 0:e.result)?e.result():e;try{t.processStatsReport()}catch(n){l.callErrorHandler(n),u.error("Processing of RTP stats failed:",n)}t.previousStatsReport=t.currentStatsReport})).catch((function(e){return t.errorCallback(e)}))};n(),this.statsIntervalId=setInterval(n,this.statsIntervalMilis)},f.prototype._processAndEmitReport=function(){var e,t,n,a=this,r={download:0,upload:0},c={download:0,upload:0},l=0,p=0,h={},f={},m={},v=0,g=0,b=0,y=0,A=Object(o.a)(this.ssrc2stats);try{for(A.s();!(n=A.n()).done;){var S=Object(i.a)(n.value,2),E=S[0],O=S[1],C=O.loss,j=C.isDownloadStream?"download":"upload";r[j]+=C.packetsTotal,c[j]+=C.packetsLost,l+=O.bitrate.download,p+=O.bitrate.upload;var T=this.peerconnection.getTrackBySSRC(E);if(T){T.isAudioTrack()?(v+=O.bitrate.download,g+=O.bitrate.upload,e=O.codec):(b+=O.bitrate.download,y+=O.bitrate.upload,t=O.codec);var k=T.getParticipantId();if(k){var _=O.resolution;if(_.width&&_.height&&-1!==_.width&&-1!==_.height){var R=h[k]||{};R[E]=_,h[k]=R}if(0!==O.framerate){var I=f[k]||{};I[E]=O.framerate,f[k]=I}if(e&&t){var w={audio:e,video:t},D=m[k]||{};D[E]=w,m[k]=D}}else u.error("No participant ID returned by ".concat(T))}O.resetBitrate()}}catch(N){A.e(N)}finally{A.f()}this.conferenceStats.bitrate={upload:p,download:l},this.conferenceStats.bitrate.audio={upload:g,download:v},this.conferenceStats.bitrate.video={upload:y,download:b},this.conferenceStats.packetLoss={total:d(c.download+c.upload,r.download+r.upload),download:d(c.download,r.download),upload:d(c.upload,r.upload)};var P,M={};Object.keys(this.audioLevelReportHistory).forEach((function(e){var t=a.audioLevelReportHistory[e],n=t.data,i=t.isLocal,o=n.reduce((function(e,t){return e+t}))/n.length;if(i)P=o;else{var r=a.peerconnection.getTrackBySSRC(Number(e));if(r){var s=r.getParticipantId();s&&(M[s]=o)}}})),this.audioLevelReportHistory={},this.eventEmitter.emit(s.d,this.peerconnection,{bandwidth:this.conferenceStats.bandwidth,bitrate:this.conferenceStats.bitrate,packetLoss:this.conferenceStats.packetLoss,resolution:h,framerate:f,codec:m,transport:this.conferenceStats.transport,localAvgAudioLevels:P,avgAudioLevels:M}),this.conferenceStats.transport=[]},f.prototype.getNonNegativeValue=function(e){var t=e;return"number"!==typeof t&&(t=Number(t)),isNaN(t)?0:Math.max(0,t)},f.prototype._calculateBitrate=function(e,t,n){var i=this.getNonNegativeValue(e[n]),o=this.getNonNegativeValue(t[n]),a=Math.max(0,i-o),r=e.timestamp-t.timestamp,s=0;return r>0&&(s=Math.round(8*a/r)),s},f.prototype.processStatsReport=function(){var e=this;if(this.previousStatsReport){var t={};this.currentStatsReport.forEach((function(n){if("candidate-pair"===n.type&&n.nominated&&"succeeded"===n.state){var i=n.availableIncomingBitrate,o=n.availableOutgoingBitrate;(i||o)&&(e.conferenceStats.bandwidth={download:Math.round(i/1e3),upload:Math.round(o/1e3)});var a=e.currentStatsReport.get(n.remoteCandidateId),s=e.currentStatsReport.get(n.localCandidateId);if(a&&s){var l=c.a.isChromiumBased()?a.ip:a.address,u=a.port,d="".concat(l,":").concat(u),h=c.a.isChromiumBased()?s.ip:s.address,f=s.port,m="".concat(h,":").concat(f),v=a.protocol,g=e.conferenceStats.transport;g.some((function(e){return e.ip===d&&e.type===v&&e.localip===m}))||g.push({ip:d,type:v,localip:m,p2p:e.peerconnection.isP2P,localCandidateType:s.candidateType,remoteCandidateType:a.candidateType,networkType:s.networkType,rtt:1e3*n.currentRoundTripTime})}}else if("inbound-rtp"===n.type||"outbound-rtp"===n.type){var b=e.previousStatsReport.get(n.id),y=e.getNonNegativeValue(n.ssrc);if(!b||!y)return;var A=e.ssrc2stats.get(y);A||(A=new p,e.ssrc2stats.set(y,A));var S=!0,E="packetsReceived";"outbound-rtp"===n.type&&(S=!1,E="packetsSent");var O=n[E];(!O||O<0)&&(O=0);var C=e.getNonNegativeValue(b[E]),j=Math.max(0,O-C),T=e.getNonNegativeValue(n.packetsLost),k=e.getNonNegativeValue(b.packetsLost),_=Math.max(0,T-k);if(A.setLoss({packetsTotal:j+_,packetsLost:_,isDownloadStream:S}),"inbound-rtp"===n.type){var R={height:n.frameHeight,width:n.frameWidth},I=n.framesPerSecond;R.height&&R.width&&A.setResolution(R),A.setFramerate(Math.round(I||0)),A.addBitrate({download:e._calculateBitrate(n,b,"bytesReceived"),upload:0})}else t[y]=e.getNonNegativeValue(n.bytesSent),A.addBitrate({download:0,upload:e._calculateBitrate(n,b,"bytesSent")});var w=e.currentStatsReport.get(n.codecId);if(w){var D=w.mimeType.split("/")[1];D&&A.setCodec(D)}}else if("track"===n.type&&n.kind===r.VIDEO&&!n.remoteSource){var P={height:n.frameHeight,width:n.frameWidth},M=e.peerconnection.getLocalTracks(r.VIDEO);if(null===M||void 0===M||!M.length)return;var N=e.peerconnection.getLocalSSRC(M[0]);if(!N)return;var x=e.ssrc2stats.get(N);x||(x=new p,e.ssrc2stats.set(N,x)),P.height&&P.width&&x.setResolution(P);var L=n.framesPerSecond;if(!L){var F=e.previousStatsReport.get(n.id);if(F){var B=n.timestamp-F.timestamp;if(B>0&&n.framesSent)L=(n.framesSent-F.framesSent)/B*1e3}if(!L)return}var U=e.peerconnection.getActiveSimulcastStreams();L=U?Math.round(L/U):0,x.setFramerate(L)}})),this.eventEmitter.emit(s.c,this.peerconnection,t),this._processAndEmitReport()}},f.prototype.processAudioLevelReport=function(){var e=this;this.baselineAudioLevelsReport&&this.currentAudioLevelsReport.forEach((function(t){if("track"===t.type){var n=t.audioLevel;if(n){var i=t.trackIdentifier,o=e.peerconnection.getSsrcByTrackId(i);if(o){var a=o===e.peerconnection.getLocalSSRC(e.peerconnection.getLocalTracks(r.AUDIO));e.eventEmitter.emit(s.a,e.peerconnection,o,n,a)}}}}))}}).call(this,"/index.js")},function(e,t){function n(e,t){if(!e||!t||"function"!==typeof e.addListener||"function"!==typeof t.emit)throw new Error("Invalid arguments passed to EventEmitterForwarder");this.src=e,this.dest=t}n.prototype.forward=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[0];t[0]=this.dest,this.src.addListener(i,Function.prototype.bind.apply(this.dest.emit,t))},e.exports=n},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(6),o=n(8),a=n(15),r=n(12),s=n(173),c=n(20),l=function(){function e(t,n,o,r,c,l,u,d,p){Object(i.a)(this,e),this._jid=t,this._id=a.Strophe.getResourceFromJid(t),this._conference=n,this._displayName=o,this._supportsDTMF=!1,this._tracks=[],this._role="none",this._status=l,this._hidden=r,this._statsID=c,this._connectionStatus=s.a.ACTIVE,this._properties={},this._identity=u,this._isReplacing=d,this._isReplaced=p,this._features=new Set}return Object(o.a)(e,[{key:"getConference",value:function(){return this._conference}},{key:"getProperty",value:function(e){return this._properties[e]}},{key:"hasAnyVideoTrackWebRTCMuted",value:function(){return this.getTracks().some((function(e){return e.getType()===c.VIDEO&&e.isWebRTCTrackMuted()}))}},{key:"_setConnectionStatus",value:function(e){this._connectionStatus=e}},{key:"getConnectionStatus",value:function(){return this._connectionStatus}},{key:"setProperty",value:function(e,t){var n=this._properties[e];t!==n&&(this._properties[e]=t,this._conference.eventEmitter.emit(r.PARTICIPANT_PROPERTY_CHANGED,this,e,n,t))}},{key:"getTracks",value:function(){return this._tracks.slice()}},{key:"getTracksByMediaType",value:function(e){return this.getTracks().filter((function(t){return t.getType()===e}))}},{key:"getId",value:function(){return this._id}},{key:"getJid",value:function(){return this._jid}},{key:"getDisplayName",value:function(){return this._displayName}},{key:"getStatsID",value:function(){return this._statsID}},{key:"getStatus",value:function(){return this._status}},{key:"isModerator",value:function(){return"moderator"===this._role}},{key:"isHidden",value:function(){return this._hidden}},{key:"isReplacing",value:function(){return this._isReplacing}},{key:"isReplaced",value:function(){return this._isReplaced}},{key:"isAudioMuted",value:function(){return this._isMediaTypeMuted(c.AUDIO)}},{key:"_isMediaTypeMuted",value:function(e){return this.getTracks().reduce((function(t,n){return t&&(n.getType()!==e||n.isMuted())}),!0)}},{key:"isVideoMuted",value:function(){return this._isMediaTypeMuted(c.VIDEO)}},{key:"getRole",value:function(){return this._role}},{key:"setRole",value:function(e){this._role=e}},{key:"setIsReplacing",value:function(e){this._isReplacing=e}},{key:"setIsReplaced",value:function(e){this._isReplaced=e}},{key:"supportsDTMF",value:function(){return this._supportsDTMF}},{key:"getFeatures",value:function(){return Promise.resolve(this._features)}},{key:"hasFeature",value:function(e){return this._features.has(e)}},{key:"setFeatures",value:function(e){this._features=e||new Set}},{key:"getBotType",value:function(){return this._botType}},{key:"setBotType",value:function(e){this._botType=e}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(82),o=n(78);function a(e){var t,n=this,a=e.id,r=e.password,s=e.onCreateResource,c=e.onLoginSuccessful,l=e.roomPassword,u=!1,d=new o.e(this.connection.options),p=new Promise((function(e,o){t=o,d.addListener(i.CONNECTION_DISCONNECTED,(function(){d=void 0})),d.addListener(i.CONNECTION_ESTABLISHED,(function(){u||(c&&c(),d.createRoom(n.options.name,n.options.config,s).moderator.authenticate().then((function(){d&&d.disconnect(),u||(n.join(l),e())})).catch((function(e){var t=e.error,n=e.message;d.disconnect(),o({authenticationError:t,message:n})})))})),d.addListener(i.CONNECTION_FAILED,(function(e,t,n){o({connectionError:e,credentials:n,message:t}),d=void 0})),u||d.connect(a,r)}));return p.cancel=function(){u=!0,t({}),d&&d.disconnect()},p}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(6),o=n(8),a=n(22),r=Object(a.getLogger)(e),s=Symbol("kJitsiE2EE"),c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.sharedKey;Object(i.a)(this,e);var o="",a=document.querySelector('script[src*="lib-jitsi-meet"]');if(a){var s=a.src.lastIndexOf("/");o="".concat(a.src.substring(0,s),"/")}var c="".concat(o,"lib-jitsi-meet.e2ee-worker.js");if(o&&"/"!==o){var l=new Blob(['importScripts("'.concat(c,'");')],{type:"application/javascript"});c=window.URL.createObjectURL(l)}this._worker=new Worker(c,{name:"E2EE Worker"}),this._worker.onerror=function(e){return r.error(e)},this._worker.postMessage({operation:"initialize",sharedKey:n})}return Object(o.a)(e,[{key:"cleanup",value:function(e){this._worker.postMessage({operation:"cleanup",participantId:e})}},{key:"cleanupAll",value:function(){this._worker.postMessage({operation:"cleanupAll"})}},{key:"handleReceiver",value:function(e,t,n){if(!e[s])if(e[s]=!0,window.RTCRtpScriptTransform){var i={operation:"decode",participantId:n};e.transform=new RTCRtpScriptTransform(this._worker,i)}else{var o=e.createEncodedStreams();this._worker.postMessage({operation:"decode",readableStream:o.readable,writableStream:o.writable,participantId:n},[o.readable,o.writable])}}},{key:"handleSender",value:function(e,t,n){if(!e[s])if(e[s]=!0,window.RTCRtpScriptTransform){var i={operation:"encode",participantId:n};e.transform=new RTCRtpScriptTransform(this._worker,i)}else{var o=e.createEncodedStreams();this._worker.postMessage({operation:"encode",readableStream:o.readable,writableStream:o.writable,participantId:n},[o.readable,o.writable])}}},{key:"setKey",value:function(e,t,n){this._worker.postMessage({operation:"setKey",key:t,keyIndex:n,participantId:e})}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return y}));var i=n(38),o=n.n(i),a=n(65),r=n(6),s=n(8),c=n(25),l=n(34),u=n(33),d=n(22),p=n(290),h=n.n(p),f=n(12),m=n(227),v=n(193),g=n(291),b=Object(d.getLogger)(e),y=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(r.a)(this,n),(i=t.call(this,e))._key=void 0,i._conferenceJoined=!1,i._olmAdapter=new v.a(e),i._rotateKey=h()(i._rotateKeyImpl,5e3),i._ratchetKey=h()(i._ratchetKeyImpl,5e3),i._olmAdapter.on(v.a.events.PARTICIPANT_KEY_UPDATED,i._onParticipantKeyUpdated.bind(Object(c.a)(i))),i.conference.on(f.PARTICIPANT_PROPERTY_CHANGED,i._onParticipantPropertyChanged.bind(Object(c.a)(i))),i.conference.on(f.USER_JOINED,i._onParticipantJoined.bind(Object(c.a)(i))),i.conference.on(f.USER_LEFT,i._onParticipantLeft.bind(Object(c.a)(i))),i.conference.on(f.CONFERENCE_JOINED,(function(){i._conferenceJoined=!0})),i}return Object(s.a)(n,[{key:"_setEnabled",value:function(){var e=Object(a.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,this._olmAdapter.initSessions();case 3:e.next=6;break;case 5:this._olmAdapter.clearAllParticipantsSessions();case 6:return this._key=!!t&&this._generateKey(),e.next=9,this._olmAdapter.updateKey(this._key);case 9:n=e.sent,this.e2eeCtx.setKey(this.conference.myUserId(),this._key,n);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_onParticipantPropertyChanged",value:function(){var e=Object(a.a)(o.a.mark((function e(t,n,i,a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n,e.next="e2ee.idKey"===e.t0?3:"e2ee.enabled"===e.t0?5:7;break;case 3:return b.debug("Participant ".concat(t.getId()," updated their id key: ").concat(a)),e.abrupt("break",7);case 5:return!a&&this.enabled&&this._olmAdapter.clearParticipantSession(t),e.abrupt("break",7);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,i,o){return e.apply(this,arguments)}}()},{key:"_onParticipantJoined",value:function(){this._conferenceJoined&&this.enabled&&this._ratchetKey()}},{key:"_onParticipantLeft",value:function(e){this.e2eeCtx.cleanup(e),this.enabled&&this._rotateKey()}},{key:"_rotateKeyImpl",value:function(){var e=Object(a.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b.debug("Rotating key"),this._key=this._generateKey(),e.next=4,this._olmAdapter.updateKey(this._key);case 4:t=e.sent,this.e2eeCtx.setKey(this.conference.myUserId(),this._key,t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_ratchetKeyImpl",value:function(){var e=Object(a.a)(o.a.mark((function e(){var t,n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b.debug("Ratchetting key"),e.next=3,Object(g.a)(this._key);case 3:return t=e.sent,e.next=6,Object(g.b)(t);case 6:n=e.sent,this._key=new Uint8Array(n),i=this._olmAdapter.updateCurrentKey(this._key),this.e2eeCtx.setKey(this.conference.myUserId(),this._key,i);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_onParticipantKeyUpdated",value:function(e,t,n){b.debug("Participant ".concat(e," updated their key")),this.e2eeCtx.setKey(e,t,n)}},{key:"_generateKey",value:function(){return window.crypto.getRandomValues(new Uint8Array(32))}}]),n}(m.a)}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var i=n(6),o=n(8),a=n(22),r=n(178),s=n(365),c=Object(a.getLogger)(e),l=function(){function e(t){Object(i.a)(this,e),this._stropheConn=t,this._resumeRetryN=0,this._retryDelay=void 0}return Object(o.a)(e,[{key:"retryDelay",get:function(){return this._retryDelay}},{key:"schedule",value:function(){var e=this;this._cancelResume(),this._resumeRetryN+=1,this._networkOnlineListener=r.b.addEventListener(r.a,(function(t){t.isOnline?e._scheduleResume():e._cancelResume()})),r.b.isOnline()&&this._scheduleResume()}},{key:"_scheduleResume",value:function(){var e=this;this._resumeTimeout||(this._resumeRetryN=Math.min(3,this._resumeRetryN),this._retryDelay=Object(s.a)(this._resumeRetryN,1500*this._resumeRetryN,3),c.info("Will try to resume the XMPP connection in ".concat(this.retryDelay,"ms")),this._resumeTimeout=setTimeout((function(){return e._resumeConnection()}),this.retryDelay))}},{key:"_cancelResume",value:function(){this._resumeTimeout&&(c.info("Canceling connection resume task"),clearTimeout(this._resumeTimeout),this._resumeTimeout=void 0,this._retryDelay=void 0)}},{key:"_resumeConnection",value:function(){var e=this._stropheConn.streamManagement,t=e.getResumeToken();if(t){c.info("Trying to resume the XMPP connection");var n=new URL(this._stropheConn.service),i=n.search,o=/(previd=)([\w-]+)/,a=i.match(o);a&&-1===a.indexOf(t)?i=i.replace(o,"$1".concat(t)):a||(i+=-1===i.indexOf("?")?"?previd=".concat(t):"&previd=".concat(t)),n.search=i,this._stropheConn.service=n.toString(),e.resume()}}},{key:"cancel",value:function(){this._cancelResume(),this._resumeRetryN=0,this._networkOnlineListener&&(this._networkOnlineListener(),this._networkOnlineListener=null)}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return Math.floor(Math.random()*(1e3*Math.pow(n,e)-t)+t)}n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(6),o=n(8),a=function(){function e(){Object(i.a)(this,e),this._lastSuccess=null,this._lastFailedMessage=null}return Object(o.a)(e,[{key:"startTracking",value:function(e,t){var n=this,i=t.rawInput;t.rawInput=function(){for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];var s=a[0];s.includes("failure")&&(n._lastFailedMessage=s),e.connected&&(n._lastSuccess=Date.now()),i.apply(t,a)}}},{key:"getLastFailedMessage",value:function(){return this._lastFailedMessage}},{key:"getTimeSinceLastSuccess",value:function(){return this._lastSuccess?Date.now()-this._lastSuccess:null}}]),e}()},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return m}));var i=n(6),o=n(8),a=n(107),r=n(87),s=n(34),c=n(33),l=n(22),u=n(15),d=n(43),p=n.n(d),h=n(127),f=Object(l.getLogger)(e),m=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var o,a=e.getTimeSinceLastServerResponse,r=e.onPingThresholdExceeded,s=e.pingOptions,c=void 0===s?{}:s;return Object(i.a)(this,n),(o=t.call(this)).failedPings=0,o._onPingThresholdExceeded=r,o._getTimeSinceLastServerResponse=a,o.pingInterval="number"===typeof c.interval?c.interval:1e4,o.pingTimeout="number"===typeof c.timeout?c.timeout:5e3,o.pingThreshold="number"===typeof c.threshold?c.threshold:2,o.pingTimestampsToKeep=Math.round(12e4/o.pingInterval),o.pingExecIntervals=new Array(o.pingTimestampsToKeep),o}return Object(o.a)(n,[{key:"init",value:function(e){Object(a.a)(Object(r.a)(n.prototype),"init",this).call(this,e),u.Strophe.addNamespace("PING","urn:xmpp:ping")}},{key:"ping",value:function(e,t,n,i){this._addPingExecutionTimestamp();var o=Object(u.$iq)({type:"get",to:e});o.c("ping",{xmlns:u.Strophe.NS.PING}),this.connection.sendIQ2(o,{timeout:i}).then(t,n)}},{key:"startInterval",value:function(e){var t=this;clearInterval(this.intervalId),this.intervalId=window.setInterval((function(){var n=Date.now();if(t._getTimeSinceLastServerResponse()<n-t._lastServerCheck)return t._addPingExecutionTimestamp(),t._lastServerCheck=n,void(t.failedPings=0);t.ping(e,(function(){t._lastServerCheck=t._getTimeSinceLastServerResponse()+Date.now(),t.failedPings=0}),(function(e){t.failedPings+=1;var n="Ping ".concat(e?"error":"timeout");t.failedPings>=t.pingThreshold?(p.a.callErrorHandler(new Error(n)),f.error(n,e),t._onPingThresholdExceeded&&t._onPingThresholdExceeded()):f.warn(n,e)}),t.pingTimeout)}),this.pingInterval),f.info("XMPP pings will be sent every ".concat(this.pingInterval," ms"))}},{key:"stopInterval",value:function(){this.intervalId&&(window.clearInterval(this.intervalId),this.intervalId=null,this.failedPings=0,f.info("Ping interval cleared"))}},{key:"_addPingExecutionTimestamp",value:function(){this.pingExecIntervals.push((new Date).getTime()),this.pingExecIntervals.length>this.pingTimestampsToKeep&&this.pingExecIntervals.shift()}},{key:"getPingSuspendTime",value:function(){var e=this.pingExecIntervals.slice();e.push((new Date).getTime());var t=0,n=e[0];return e.forEach((function(e){var i=e-n;i>t&&(t=i),n=e})),t-=this.pingInterval,Math.max(t,0)}}]),n}(h.b)}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return v}));var i=n(6),o=n(8),a=n(107),r=n(87),s=n(34),c=n(33),l=n(22),u=n(15),d=n(11),p=n.n(d),h=n(228),f=n(127),m=Object(l.getLogger)(e),v=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var o;return Object(i.a)(this,n),(o=t.call(this)).xmpp=e,o.rooms={},o}return Object(o.a)(n,[{key:"init",value:function(e){Object(a.a)(Object(r.a)(n.prototype),"init",this).call(this,e),this.connection.addHandler(this.onPresence.bind(this),null,"presence",null,null,null,null),this.connection.addHandler(this.onPresenceUnavailable.bind(this),null,"presence","unavailable",null),this.connection.addHandler(this.onPresenceError.bind(this),null,"presence","error",null),this.connection.addHandler(this.onMessage.bind(this),null,"message",null,null),this.connection.addHandler(this.onMute.bind(this),"http://jitsi.org/jitmeet/audio","iq","set",null,null),this.connection.addHandler(this.onMuteVideo.bind(this),"http://jitsi.org/jitmeet/video","iq","set",null,null)}},{key:"createRoom",value:function(e,t,n){var i=u.Strophe.getBareJidFromJid(e);if(this.isRoomCreated(i)){var o="You are already in the room!";throw m.error(o),new Error(o)}return this.rooms[i]=new h.a(this.connection,e,t,this.xmpp,n),this.eventEmitter.emit(p.a.EMUC_ROOM_ADDED,this.rooms[i]),this.rooms[i]}},{key:"isRoomCreated",value:function(e){return e in this.rooms}},{key:"doLeave",value:function(e){this.eventEmitter.emit(p.a.EMUC_ROOM_REMOVED,this.rooms[e]),delete this.rooms[e]}},{key:"onPresence",value:function(e){var t=e.getAttribute("from");if(e.getAttribute("type"))return!0;var n=this.rooms[u.Strophe.getBareJidFromJid(t)];return!n||($(e).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>status[code="201"]').length&&n.createNonAnonymousRoom(),n.onPresence(e),!0)}},{key:"onPresenceUnavailable",value:function(e){var t=e.getAttribute("from"),n=this.rooms[u.Strophe.getBareJidFromJid(t)];return!n||(n.onPresenceUnavailable(e,t),!0)}},{key:"onPresenceError",value:function(e){var t=e.getAttribute("from"),n=this.rooms[u.Strophe.getBareJidFromJid(t)];return!n||(n.onPresenceError(e,t),!0)}},{key:"onMessage",value:function(e){var t=e.getAttribute("from"),n=this.rooms[u.Strophe.getBareJidFromJid(t)];return!n||(n.onMessage(e,t),!0)}},{key:"onMute",value:function(e){var t=e.getAttribute("from"),n=this.rooms[u.Strophe.getBareJidFromJid(t)];return!n||(n.onMute(e),!0)}},{key:"onMuteVideo",value:function(e){var t=e.getAttribute("from"),n=this.rooms[u.Strophe.getBareJidFromJid(t)];return!n||(n.onMuteVideo(e),!0)}}]),n}(f.a)}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p}));var i=n(55),o=n(6),a=n(8),r=n(22),s=n(15),c=n(20),l=n(11),u=n.n(l),d=Object(r.getLogger)(e),p=function(){function e(t){var n;Object(o.a)(this,e),this._xmpp=t.xmpp,this._mainRoom=t,this._moderationEnabledByType=(n={},Object(i.a)(n,c.AUDIO,!1),Object(i.a)(n,c.VIDEO,!1),n),this._whitelistAudio=[],this._whitelistVideo=[],this._onMessage=this._onMessage.bind(this),this._xmpp.addListener(u.a.AV_MODERATION_RECEIVED,this._onMessage)}return Object(a.a)(e,[{key:"dispose",value:function(){this._xmpp.removeListener(u.a.AV_MODERATION_RECEIVED,this._onMessage)}},{key:"isSupported",value:function(){return Boolean(this._xmpp.avModerationComponentAddress)}},{key:"enable",value:function(e,t){if(this.isSupported()&&this._mainRoom.isModerator())if(e!==this._moderationEnabledByType[t]){var n=Object(s.$msg)({to:this._xmpp.avModerationComponentAddress});n.c("av_moderation",{enable:e,mediaType:t}).up(),this._xmpp.connection.send(n)}else d.warn("Moderation already in state:".concat(e," for mediaType:").concat(t));else d.error("Cannot enable:".concat(e," AV moderation supported:").concat(this.isSupported(),", \n                moderator:").concat(this._mainRoom.isModerator()))}},{key:"approve",value:function(e,t){if(this.isSupported()&&this._mainRoom.isModerator()){var n=Object(s.$msg)({to:this._xmpp.avModerationComponentAddress});n.c("av_moderation",{mediaType:e,jidToWhitelist:t}).up(),this._xmpp.connection.send(n)}else d.error("Cannot approve in AV moderation supported:".concat(this.isSupported(),", \n                moderator:").concat(this._mainRoom.isModerator()))}},{key:"reject",value:function(e,t){if(this.isSupported()&&this._mainRoom.isModerator()){var n=Object(s.$msg)({to:this._xmpp.avModerationComponentAddress});n.c("av_moderation",{mediaType:e,jidToBlacklist:t}).up(),this._xmpp.connection.send(n)}else d.error("Cannot reject in AV moderation supported:".concat(this.isSupported(),",\n                moderator:").concat(this._mainRoom.isModerator()))}},{key:"_onMessage",value:function(e){var t=this,n=e.removed,i=e.mediaType,o=e.enabled,a=e.approved,r=e.actor,s=e.whitelists;if(s){var l=i===c.AUDIO?this._whitelistAudio:this._whitelistVideo,d=Array.isArray(s[i])?s[i]:[];n?l.filter((function(e){return!d.includes(e)})).forEach((function(e){return t._xmpp.eventEmitter.emit(u.a.AV_MODERATION_PARTICIPANT_REJECTED,i,e)})):d.filter((function(e){return!l.includes(e)})).forEach((function(e){return t._xmpp.eventEmitter.emit(u.a.AV_MODERATION_PARTICIPANT_APPROVED,i,e)})),i===c.AUDIO?this._whitelistAudio=d:this._whitelistVideo=d}else void 0!==o&&this._moderationEnabledByType[i]!==o?(this._moderationEnabledByType[i]=o,this._xmpp.eventEmitter.emit(u.a.AV_MODERATION_CHANGED,o,i,r)):n?this._xmpp.eventEmitter.emit(u.a.AV_MODERATION_REJECTED,i):a&&this._xmpp.eventEmitter.emit(u.a.AV_MODERATION_APPROVED,i)}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var i=n(6),o=n(8),a=n(22),r=n(15),s=n(11),c=n.n(s),l="features/breakout-rooms",u={ADD:"".concat(l,"/add"),REMOVE:"".concat(l,"/remove"),MOVE_TO_ROOM:"".concat(l,"/move-to-room")},d="".concat(l,"/move-to-room"),p="".concat(l,"/update"),h=Object(a.getLogger)(e),f=function(){function e(t){Object(i.a)(this,e),this.room=t,this._handleMessages=this._handleMessages.bind(this),this.room.xmpp.addListener(c.a.BREAKOUT_ROOMS_EVENT,this._handleMessages),this._rooms={}}return Object(o.a)(e,[{key:"dispose",value:function(){this.room.xmpp.removeListener(c.a.BREAKOUT_ROOMS_EVENT,this._handleMessages)}},{key:"createBreakoutRoom",value:function(e){if(this.isSupported()&&this.room.isModerator()){var t={type:u.ADD,subject:e};this._sendMessage(t)}else h.error("Cannot create breakout room - supported:".concat(this.isSupported(),", \n                moderator:").concat(this.room.isModerator()))}},{key:"removeBreakoutRoom",value:function(e){if(this.isSupported()&&this.room.isModerator()){var t={type:u.REMOVE,breakoutRoomJid:e};this._sendMessage(t)}else h.error("Cannot remove breakout room - supported:".concat(this.isSupported(),", \n                moderator:").concat(this.room.isModerator()))}},{key:"sendParticipantToRoom",value:function(e,t){if(this.isSupported()&&this.room.isModerator()){var n={type:u.MOVE_TO_ROOM,participantJid:e,roomJid:t};this._sendMessage(n)}else h.error("Cannot send participant to room - supported:".concat(this.isSupported(),", \n                moderator:").concat(this.room.isModerator()))}},{key:"isSupported",value:function(){return Boolean(this.getComponentAddress())}},{key:"getComponentAddress",value:function(){return this.room.xmpp.breakoutRoomsComponentAddress}},{key:"_setIsBreakoutRoom",value:function(e){this._isBreakoutRoom=e}},{key:"isBreakoutRoom",value:function(){return this._isBreakoutRoom}},{key:"_setMainRoomJid",value:function(e){this._mainRoomJid=e}},{key:"getMainRoomJid",value:function(){return this._mainRoomJid}},{key:"_handleMessages",value:function(e){switch(e.event){case d:this.room.eventEmitter.emit(c.a.BREAKOUT_ROOMS_MOVE_TO_ROOM,e.roomJid);break;case p:this._rooms=e.rooms,this.room.eventEmitter.emit(c.a.BREAKOUT_ROOMS_UPDATED,e)}}},{key:"_sendMessage",value:function(e){var t=Object(r.$msg)({to:this.getComponentAddress()});t.c("breakout_rooms",e).up(),this.room.xmpp.connection.send(t)}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return d}));var i=n(6),o=n(8),a=n(22),r=n(15),s=n(11),c=n.n(s),l=Object(a.getLogger)(e),u="email",d=function(){function e(t){var n=this;Object(i.a)(this,e),this.xmpp=t.xmpp,this.mainRoom=t;var o=this._maybeJoinLobbyRoom.bind(this);this.mainRoom.addEventListener(c.a.LOCAL_ROLE_CHANGED,o),this.mainRoom.addEventListener(c.a.MUC_MEMBERS_ONLY_CHANGED,o),this.mainRoom.addEventListener(c.a.ROOM_CONNECT_MEMBERS_ONLY_ERROR,(function(e){n.lobbyRoomJid=e}))}return Object(o.a)(e,[{key:"isSupported",value:function(){return this.xmpp.lobbySupported}},{key:"enable",value:function(){var e=this;return this.isSupported()?new Promise((function(t,n){e.mainRoom.setMembersOnly(!0,t,n)})):Promise.reject(new Error("Lobby not supported!"))}},{key:"disable",value:function(){this.isSupported()&&this.mainRoom.isModerator()&&this.lobbyRoom&&this.mainRoom.membersOnlyEnabled&&this.mainRoom.setMembersOnly(!1)}},{key:"leave",value:function(){var e=this;return this.lobbyRoom?this.lobbyRoom.leave().then((function(){e.lobbyRoom=void 0,l.info("Lobby room left!")})).catch((function(){})):Promise.reject(new Error("The lobby has already been left"))}},{key:"setLobbyRoomJid",value:function(e){this.lobbyRoomJid=e}},{key:"_maybeJoinLobbyRoom",value:function(){this.isSupported()&&(this.mainRoom.joined&&this.mainRoom.isModerator()&&this.mainRoom.membersOnlyEnabled&&!this.lobbyRoom&&this.join().then((function(){return l.info("Joined lobby room")})).catch((function(e){return l.error("Failed joining lobby",e)})))}},{key:"join",value:function(e,t){var n=this,i=this.mainRoom.joined&&this.mainRoom.isModerator();if(!this.lobbyRoomJid)return Promise.reject(new Error("Missing lobbyRoomJid, cannot join lobby room."));var o=r.Strophe.getNodeFromJid(this.lobbyRoomJid),a=r.Strophe.getDomainFromJid(this.lobbyRoomJid);return this.lobbyRoom=this.xmpp.createRoom(o,{customDomain:a,disableDiscoInfo:!0,disableFocus:!0,enableLobby:!1}),e&&this.lobbyRoom.addOrReplaceInPresence("nick",{attributes:{xmlns:"http://jabber.org/protocol/nick"},value:e}),i?(this.lobbyRoom.addPresenceListener(u,(function(e,t){n.mainRoom.eventEmitter.emit(c.a.MUC_LOBBY_MEMBER_UPDATED,t,{email:e.value})})),this.lobbyRoom.addEventListener(c.a.MUC_MEMBER_JOINED,(function(e,t,i,o,a,s,l,u,d){if(!Object.values(n.mainRoom.members).find((function(e){return e.jid===d}))){for(var p=0,h=Object.values(n.mainRoom.getBreakoutRooms()._rooms);p<h.length;p++){var f=h[p];if(Object.values(f.participants).find((function(e){return e.jid===d})))return}n.mainRoom.eventEmitter.emit(c.a.MUC_LOBBY_MEMBER_JOINED,r.Strophe.getResourceFromJid(e),t,l?l.avatar:void 0)}})),this.lobbyRoom.addEventListener(c.a.MUC_MEMBER_LEFT,(function(e){n.mainRoom.eventEmitter.emit(c.a.MUC_LOBBY_MEMBER_LEFT,r.Strophe.getResourceFromJid(e))})),this.lobbyRoom.addEventListener(c.a.MUC_DESTROYED,(function(){Object.keys(n.lobbyRoom.members).forEach((function(e){return n.mainRoom.eventEmitter.emit(c.a.MUC_LOBBY_MEMBER_LEFT,r.Strophe.getResourceFromJid(e))})),n.lobbyRoom.clean(),n.lobbyRoom=void 0,l.info("Lobby room left(destroyed)!")}))):(this.lobbyRoom.addEventListener(c.a.KICKED,(function(e){if(e)return n.mainRoom.eventEmitter.emit(c.a.MUC_DENIED_ACCESS),void n.lobbyRoom.clean()})),this.mainRoom.addEventListener(c.a.INVITE_MESSAGE_RECEIVED,(function(e,t,i,o){l.debug("Received approval to join ".concat(e," ").concat(t," ").concat(i)),e===n.mainRoom.roomjid&&n.mainRoom.join(o)})),this.lobbyRoom.addEventListener(c.a.MUC_DESTROYED,(function(e,t){t?n.mainRoom.join():(n.lobbyRoom.clean(),n.mainRoom.eventEmitter.emit(c.a.MUC_DESTROYED,e))})),this.mainRoom.addEventListener(c.a.MUC_JOINED,(function(){n.leave()}))),new Promise((function(e,o){n.lobbyRoom.addEventListener(c.a.MUC_JOINED,(function(){e(),t&&!i&&n.lobbyRoom.addOrReplaceInPresence(u,{value:t})&&n.lobbyRoom.sendPresence()})),n.lobbyRoom.addEventListener(c.a.ROOM_JOIN_ERROR,o),n.lobbyRoom.addEventListener(c.a.ROOM_CONNECT_NOT_ALLOWED_ERROR,o),n.lobbyRoom.addEventListener(c.a.ROOM_CONNECT_ERROR,o),n.lobbyRoom.join()}))}},{key:"denyAccess",value:function(e){if(this.isSupported()&&this.mainRoom.isModerator()){var t=Object.keys(this.lobbyRoom.members).find((function(t){return r.Strophe.getResourceFromJid(t)===e}));t?this.lobbyRoom.kick(t):l.error("Not found member for ".concat(e," in lobby room."))}}},{key:"approveAccess",value:function(e){if(this.isSupported()&&this.mainRoom.isModerator()){var t=this.mainRoom.roomjid;this.mainRoom.getBreakoutRooms().isBreakoutRoom()&&(t=this.mainRoom.getBreakoutRooms().getMainRoomJid());var n=Object.keys(this.lobbyRoom.members).find((function(t){return r.Strophe.getResourceFromJid(t)===e}));if(n){var i=this.lobbyRoom.members[n].jid,o=Object(r.$msg)({to:t}).c("x",{xmlns:"http://jabber.org/protocol/muc#user"}).c("invite",{to:i});this.xmpp.connection.sendIQ(o,(function(){}),(function(e){l.error("Error sending invite for ".concat(i),e)}))}else l.error("Not found member for ".concat(n," in lobby room."))}}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return d}));var i=n(22),o=n(15),a=n(98),r=n(289),s=n(11),c=n(43),l=Object(i.getLogger)(e);function u(e){var t=1;return function(n){if(!n){var i=Math.pow(2,t-1);return t+=1,i*e}t=1}}function d(e,t,n,i){function o(e){if(e.data&&e.data.sessionId){if(e.origin!==window.location.origin)return void l.warn("Ignoring sessionId from different origin: ".concat(e.origin));a.a.sessionId=e.data.sessionId}}this.roomName=e,this.xmppService=t,this.getNextTimeout=u(1e3),this.getNextErrorTimeout=u(1e3),this.externalAuthEnabled=!1,this.options=i,this.sipGatewayEnabled=!1,this.eventEmitter=n,this.connection=this.xmppService.connection,window.addEventListener?window.addEventListener("message",o,!1):window.attachEvent("onmessage",o)}d.prototype.isExternalAuthEnabled=function(){return this.externalAuthEnabled},d.prototype.isSipGatewayEnabled=function(){return this.sipGatewayEnabled},d.prototype.onMucMemberLeft=function(e){"focus"===o.Strophe.getResourceFromJid(e)&&(l.info("Focus has left the room - leaving conference"),this.eventEmitter.emit(s.FOCUS_LEFT))},d.prototype.setFocusUserJid=function(e){this.focusUserJid||(this.focusUserJid=e,l.info("Focus jid set to:  ".concat(this.focusUserJid)))},d.prototype.getFocusUserJid=function(){return this.focusUserJid},d.prototype.getFocusComponent=function(){var e=this.options.connection.hosts.focus;return e||(e="focus.".concat(this.options.connection.hosts.domain)),e},d.prototype.createConferenceIq=function(){var e,t,n,i,r=Object(o.$iq)({to:this.getFocusComponent(),type:"set"}),s=a.a.sessionId,c=a.a.machineId,u=this.options.conference;switch(l.info("Session ID: ".concat(s," machine UID: ").concat(c)),r.c("conference",{xmlns:"http://jitsi.org/protocol/focus",room:this.roomName,"machine-uid":c}),s&&r.attrs({"session-id":s}),r.c("property",{name:"disableRtx",value:Boolean(u.disableRtx)}).up(),void 0!==u.audioPacketDelay&&r.c("property",{name:"audioPacketDelay",value:u.audioPacketDelay}).up(),u.startBitrate&&r.c("property",{name:"startBitrate",value:u.startBitrate}).up(),u.minBitrate&&r.c("property",{name:"minBitrate",value:u.minBitrate}).up(),u.testing&&u.testing.octo&&"number"===typeof u.testing.octo.probability&&Math.random()<u.testing.octo.probability&&r.c("property",{name:"octo",value:!0}).up(),this.options.conference.openBridgeChannel){case"datachannel":case!0:case void 0:i=!0;break;case"websocket":i=!1}r.c("property",{name:"openSctp",value:i}).up(),void 0!==this.options.conference.startAudioMuted&&r.c("property",{name:"startAudioMuted",value:this.options.conference.startAudioMuted}).up(),void 0!==this.options.conference.startVideoMuted&&r.c("property",{name:"startVideoMuted",value:this.options.conference.startVideoMuted}).up();var d=null!==(e=null===(t=this.options.conference)||void 0===t||null===(n=t.analytics)||void 0===n?void 0:n.rtcstatsEnabled)&&void 0!==e&&e;d||r.c("property",{name:"rtcstatsEnabled",value:d}).up();var p=!this.options.callStatsID||!this.options.callStatsSecret||!this.options.enableCallStats||!0===this.options.disableThirdPartyRequests;return p&&r.c("property",{name:"callstatsEnabled",value:!p}).up(),r.up(),r},d.prototype.parseSessionId=function(e){var t=$(e).find("conference").attr("session-id");t&&(l.info("Received sessionId:  ".concat(t)),a.a.sessionId=t)},d.prototype.parseConfigOptions=function(e){this.setFocusUserJid($(e).find("conference").attr("focusjid"));var t=$(e).find(">conference>property[name='authentication'][value='true']").length>0;l.info("Authentication enabled: ".concat(t)),this.externalAuthEnabled=$(e).find(">conference>property[name='externalAuth'][value='true']").length>0,l.info("External authentication enabled: ".concat(this.externalAuthEnabled)),this.externalAuthEnabled||this.parseSessionId(e);var n=$(e).find(">conference").attr("identity");this.eventEmitter.emit(r.IDENTITY_UPDATED,t,n),$(e).find(">conference>property[name='sipGatewayEnabled'][value='true']").length&&(this.sipGatewayEnabled=!0),l.info("Sip gateway enabled:  ".concat(this.sipGatewayEnabled))},d.prototype.allocateConferenceFocus=function(){var e=this;return new Promise((function(t){e.setFocusUserJid(e.options.connection.focusUserJid),e.connection.sendIQ(e.createConferenceIq(),(function(n){return e._allocateConferenceFocusSuccess(n,t)}),(function(n){return e._allocateConferenceFocusError(n,t)})),e.connection.flush()}))},d.prototype._allocateConferenceFocusError=function(e,t){var n=this,i=$(e).find(">error>session-invalid").length||$(e).find(">error>not-acceptable").length;if(i&&(l.info("Session expired! - removing"),a.a.sessionId=void 0),$(e).find(">error>graceful-shutdown").length)this.eventEmitter.emit(s.GRACEFUL_SHUTDOWN);else{var r=$(e).find(">error>reservation-error");if(r.length){var u,d=r.attr("error-code"),p=$(e).find(">error>text");return p&&(u=p.text()),void this.eventEmitter.emit(s.RESERVATION_ERROR,d,u)}if($(e).find(">error>not-authorized").length)return l.warn("Unauthorized to start the conference",e),o.Strophe.getDomainFromJid(e.getAttribute("to"))!==this.options.connection.hosts.anonymousdomain&&(this.externalAuthEnabled=!0),void this.eventEmitter.emit(s.AUTHENTICATION_REQUIRED);var h=this.getNextErrorTimeout(),f="Focus error, retry after ".concat(h);c.callErrorHandler(new Error(f)),l.error(f,e);var m=this.getFocusComponent(),v=h/1e3;i||this.eventEmitter.emit(s.FOCUS_DISCONNECTED,m,v),this.getNextTimeout(!0),window.setTimeout((function(){return n.allocateConferenceFocus().then(t)}),h)}},d.prototype._allocateConferenceFocusSuccess=function(e,t){var n=this;if(this.parseConfigOptions(e),this.getNextErrorTimeout(!0),"true"===$(e).find("conference").attr("ready"))this.getNextTimeout(!0),t();else{var i=this.getNextTimeout();l.info("Waiting for the focus... ".concat(i)),window.setTimeout((function(){return n.allocateConferenceFocus().then(t)}),i)}},d.prototype.authenticate=function(){var e=this;return new Promise((function(t,n){e.connection.sendIQ(e.createConferenceIq(),(function(n){e.parseSessionId(n),t()}),(function(e){return n({error:$(e).find("iq>error :first").prop("tagName"),message:$(e).find("iq>error>text").text()})}))}))},d.prototype.getLoginUrl=function(e,t){this._getLoginUrl(!1,e,t)},d.prototype._getLoginUrl=function(e,t,n){var i=Object(o.$iq)({to:this.getFocusComponent(),type:"get"}),r={xmlns:"http://jitsi.org/protocol/focus",room:this.roomName,"machine-uid":a.a.machineId},s="auth url";function u(e,t){c.callErrorHandler(new Error(e)),l.error(e,t),n(t)}e&&(r.popup=!0,s="POPUP ".concat(s)),i.c("login-url",r),this.connection.sendIQ(i,(function(e){var n=$(e).find("login-url").attr("url");(n=decodeURIComponent(n))?(l.info("Got ".concat(s,": ").concat(n)),t(n)):u("Failed to get ".concat(s," from the focus"),e)}),u.bind(void 0,"Get ".concat(s," error")))},d.prototype.getPopupLoginUrl=function(e,t){this._getLoginUrl(!0,e,t)},d.prototype.logout=function(e){var t=Object(o.$iq)({to:this.getFocusComponent(),type:"set"}),n=a.a.sessionId;n?(t.c("logout",{xmlns:"http://jitsi.org/protocol/focus","session-id":n}),this.connection.sendIQ(t,(function(t){var n=$(t).find("logout").attr("logout-url");n&&(n=decodeURIComponent(n)),l.info("Log out OK, url: ".concat(n),t),a.a.sessionId=void 0,e(n)}),(function(e){var t="Logout error";c.callErrorHandler(new Error(t)),l.error(t,e)}))):e()}}).call(this,"/index.js")},function(e,t,n){var i=n(126),o=["Aaliyah","Aaron","Abagail","Abbey","Abbie","Abbigail","Abby","Abdiel","Abdul","Abdullah","Abe","Abel","Abelardo","Abigail","Abigale","Abigayle","Abner","Abraham","Ada","Adah","Adalberto","Adaline","Adam","Adan","Addie","Addison","Adela","Adelbert","Adele","Adelia","Adeline","Adell","Adella","Adelle","Aditya","Adolf","Adolfo","Adolph","Adolphus","Adonis","Adrain","Adrian","Adriana","Adrianna","Adriel","Adrien","Adrienne","Afton","Aglae","Agnes","Agustin","Agustina","Ahmad","Ahmed","Aida","Aidan","Aiden","Aileen","Aisha","Aiyana","Akeem","Al","Alaina","Alan","Alana","Alanis","Alanna","Alayna","Alba","Albert","Alberta","Albertha","Alberto","Albin","Albina","Alda","Alden","Alec","Aleen","Alejandra","Alejandrin","Alek","Alena","Alene","Alessandra","Alessandro","Alessia","Aletha","Alex","Alexa","Alexander","Alexandra","Alexandre","Alexandrea","Alexandria","Alexandrine","Alexandro","Alexane","Alexanne","Alexie","Alexis","Alexys","Alexzander","Alf","Alfonso","Alfonzo","Alford","Alfred","Alfreda","Alfredo","Ali","Alia","Alice","Alicia","Alisa","Alisha","Alison","Alivia","Aliya","Aliyah","Aliza","Alize","Allan","Allen","Allene","Allie","Allison","Ally","Alphonso","Alta","Althea","Alva","Alvah","Alvena","Alvera","Alverta","Alvina","Alvis","Alyce","Alycia","Alysa","Alysha","Alyson","Alysson","Amalia","Amanda","Amani","Amara","Amari","Amaya","Amber","Ambrose","Amelia","Amelie","Amely","America","Americo","Amie","Amina","Amir","Amira","Amiya","Amos","Amparo","Amy","Amya","Ana","Anabel","Anabelle","Anahi","Anais","Anastacio","Anastasia","Anderson","Andre","Andreane","Andreanne","Andres","Andrew","Andy","Angel","Angela","Angelica","Angelina","Angeline","Angelita","Angelo","Angie","Angus","Anibal","Anika","Anissa","Anita","Aniya","Aniyah","Anjali","Anna","Annabel","Annabell","Annabelle","Annalise","Annamae","Annamarie","Anne","Annetta","Annette","Annie","Ansel","Ansley","Anthony","Antoinette","Antone","Antonetta","Antonette","Antonia","Antonietta","Antonina","Antonio","Antwan","Antwon","Anya","April","Ara","Araceli","Aracely","Arch","Archibald","Ardella","Arden","Ardith","Arely","Ari","Ariane","Arianna","Aric","Ariel","Arielle","Arjun","Arlene","Arlie","Arlo","Armand","Armando","Armani","Arnaldo","Arne","Arno","Arnold","Arnoldo","Arnulfo","Aron","Art","Arthur","Arturo","Arvel","Arvid","Arvilla","Aryanna","Asa","Asha","Ashlee","Ashleigh","Ashley","Ashly","Ashlynn","Ashton","Ashtyn","Asia","Assunta","Astrid","Athena","Aubree","Aubrey","Audie","Audra","Audreanne","Audrey","August","Augusta","Augustine","Augustus","Aurelia","Aurelie","Aurelio","Aurore","Austen","Austin","Austyn","Autumn","Ava","Avery","Avis","Axel","Ayana","Ayden","Ayla","Aylin","Baby","Bailee","Bailey","Barbara","Barney","Baron","Barrett","Barry","Bart","Bartholome","Barton","Baylee","Beatrice","Beau","Beaulah","Bell","Bella","Belle","Ben","Benedict","Benjamin","Bennett","Bennie","Benny","Benton","Berenice","Bernadette","Bernadine","Bernard","Bernardo","Berneice","Bernhard","Bernice","Bernie","Berniece","Bernita","Berry","Bert","Berta","Bertha","Bertram","Bertrand","Beryl","Bessie","Beth","Bethany","Bethel","Betsy","Bette","Bettie","Betty","Bettye","Beulah","Beverly","Bianka","Bill","Billie","Billy","Birdie","Blair","Blaise","Blake","Blanca","Blanche","Blaze","Bo","Bobbie","Bobby","Bonita","Bonnie","Boris","Boyd","Brad","Braden","Bradford","Bradley","Bradly","Brady","Braeden","Brain","Brandi","Brando","Brandon","Brandt","Brandy","Brandyn","Brannon","Branson","Brant","Braulio","Braxton","Brayan","Breana","Breanna","Breanne","Brenda","Brendan","Brenden","Brendon","Brenna","Brennan","Brennon","Brent","Bret","Brett","Bria","Brian","Briana","Brianne","Brice","Bridget","Bridgette","Bridie","Brielle","Brigitte","Brionna","Brisa","Britney","Brittany","Brock","Broderick","Brody","Brook","Brooke","Brooklyn","Brooks","Brown","Bruce","Bryana","Bryce","Brycen","Bryon","Buck","Bud","Buddy","Buford","Bulah","Burdette","Burley","Burnice","Buster","Cade","Caden","Caesar","Caitlyn","Cale","Caleb","Caleigh","Cali","Calista","Callie","Camden","Cameron","Camila","Camilla","Camille","Camren","Camron","Camryn","Camylle","Candace","Candelario","Candice","Candida","Candido","Cara","Carey","Carissa","Carlee","Carleton","Carley","Carli","Carlie","Carlo","Carlos","Carlotta","Carmel","Carmela","Carmella","Carmelo","Carmen","Carmine","Carol","Carolanne","Carole","Carolina","Caroline","Carolyn","Carolyne","Carrie","Carroll","Carson","Carter","Cary","Casandra","Casey","Casimer","Casimir","Casper","Cassandra","Cassandre","Cassidy","Cassie","Catalina","Caterina","Catharine","Catherine","Cathrine","Cathryn","Cathy","Cayla","Ceasar","Cecelia","Cecil","Cecile","Cecilia","Cedrick","Celestine","Celestino","Celia","Celine","Cesar","Chad","Chadd","Chadrick","Chaim","Chance","Chandler","Chanel","Chanelle","Charity","Charlene","Charles","Charley","Charlie","Charlotte","Chase","Chasity","Chauncey","Chaya","Chaz","Chelsea","Chelsey","Chelsie","Chesley","Chester","Chet","Cheyanne","Cheyenne","Chloe","Chris","Christ","Christa","Christelle","Christian","Christiana","Christina","Christine","Christop","Christophe","Christopher","Christy","Chyna","Ciara","Cicero","Cielo","Cierra","Cindy","Citlalli","Clair","Claire","Clara","Clarabelle","Clare","Clarissa","Clark","Claud","Claude","Claudia","Claudie","Claudine","Clay","Clemens","Clement","Clementina","Clementine","Clemmie","Cleo","Cleora","Cleta","Cletus","Cleve","Cleveland","Clifford","Clifton","Clint","Clinton","Clotilde","Clovis","Cloyd","Clyde","Coby","Cody","Colby","Cole","Coleman","Colin","Colleen","Collin","Colt","Colten","Colton","Columbus","Concepcion","Conner","Connie","Connor","Conor","Conrad","Constance","Constantin","Consuelo","Cooper","Cora","Coralie","Corbin","Cordelia","Cordell","Cordia","Cordie","Corene","Corine","Cornelius","Cornell","Corrine","Cortez","Cortney","Cory","Coty","Courtney","Coy","Craig","Crawford","Creola","Cristal","Cristian","Cristina","Cristobal","Cristopher","Cruz","Crystal","Crystel","Cullen","Curt","Curtis","Cydney","Cynthia","Cyril","Cyrus","Dagmar","Dahlia","Daija","Daisha","Daisy","Dakota","Dale","Dallas","Dallin","Dalton","Damaris","Dameon","Damian","Damien","Damion","Damon","Dan","Dana","Dandre","Dane","D'angelo","Dangelo","Danial","Daniela","Daniella","Danielle","Danika","Dannie","Danny","Dante","Danyka","Daphne","Daphnee","Daphney","Darby","Daren","Darian","Dariana","Darien","Dario","Darion","Darius","Darlene","Daron","Darrel","Darrell","Darren","Darrick","Darrin","Darrion","Darron","Darryl","Darwin","Daryl","Dashawn","Dasia","Dave","David","Davin","Davion","Davon","Davonte","Dawn","Dawson","Dax","Dayana","Dayna","Dayne","Dayton","Dean","Deangelo","Deanna","Deborah","Declan","Dedric","Dedrick","Dee","Deion","Deja","Dejah","Dejon","Dejuan","Delaney","Delbert","Delfina","Delia","Delilah","Dell","Della","Delmer","Delores","Delpha","Delphia","Delphine","Delta","Demarco","Demarcus","Demario","Demetris","Demetrius","Demond","Dena","Denis","Dennis","Deon","Deondre","Deontae","Deonte","Dereck","Derek","Derick","Deron","Derrick","Deshaun","Deshawn","Desiree","Desmond","Dessie","Destany","Destin","Destinee","Destiney","Destini","Destiny","Devan","Devante","Deven","Devin","Devon","Devonte","Devyn","Dewayne","Dewitt","Dexter","Diamond","Diana","Dianna","Diego","Dillan","Dillon","Dimitri","Dina","Dino","Dion","Dixie","Dock","Dolly","Dolores","Domenic","Domenica","Domenick","Domenico","Domingo","Dominic","Dominique","Don","Donald","Donato","Donavon","Donna","Donnell","Donnie","Donny","Dora","Dorcas","Dorian","Doris","Dorothea","Dorothy","Dorris","Dortha","Dorthy","Doug","Douglas","Dovie","Doyle","Drake","Drew","Duane","Dudley","Dulce","Duncan","Durward","Dustin","Dusty","Dwight","Dylan","Earl","Earlene","Earline","Earnest","Earnestine","Easter","Easton","Ebba","Ebony","Ed","Eda","Edd","Eddie","Eden","Edgar","Edgardo","Edison","Edmond","Edmund","Edna","Eduardo","Edward","Edwardo","Edwin","Edwina","Edyth","Edythe","Effie","Efrain","Efren","Eileen","Einar","Eino","Eladio","Elaina","Elbert","Elda","Eldon","Eldora","Eldred","Eldridge","Eleanora","Eleanore","Eleazar","Electa","Elena","Elenor","Elenora","Eleonore","Elfrieda","Eli","Elian","Eliane","Elias","Eliezer","Elijah","Elinor","Elinore","Elisa","Elisabeth","Elise","Eliseo","Elisha","Elissa","Eliza","Elizabeth","Ella","Ellen","Ellie","Elliot","Elliott","Ellis","Ellsworth","Elmer","Elmira","Elmo","Elmore","Elna","Elnora","Elody","Eloisa","Eloise","Elouise","Eloy","Elroy","Elsa","Else","Elsie","Elta","Elton","Elva","Elvera","Elvie","Elvis","Elwin","Elwyn","Elyse","Elyssa","Elza","Emanuel","Emelia","Emelie","Emely","Emerald","Emerson","Emery","Emie","Emil","Emile","Emilia","Emiliano","Emilie","Emilio","Emily","Emma","Emmalee","Emmanuel","Emmanuelle","Emmet","Emmett","Emmie","Emmitt","Emmy","Emory","Ena","Enid","Enoch","Enola","Enos","Enrico","Enrique","Ephraim","Era","Eriberto","Eric","Erica","Erich","Erick","Ericka","Erik","Erika","Erin","Erling","Erna","Ernest","Ernestina","Ernestine","Ernesto","Ernie","Ervin","Erwin","Eryn","Esmeralda","Esperanza","Esta","Esteban","Estefania","Estel","Estell","Estella","Estelle","Estevan","Esther","Estrella","Etha","Ethan","Ethel","Ethelyn","Ethyl","Ettie","Eudora","Eugene","Eugenia","Eula","Eulah","Eulalia","Euna","Eunice","Eusebio","Eva","Evalyn","Evan","Evangeline","Evans","Eve","Eveline","Evelyn","Everardo","Everett","Everette","Evert","Evie","Ewald","Ewell","Ezekiel","Ezequiel","Ezra","Fabian","Fabiola","Fae","Fannie","Fanny","Fatima","Faustino","Fausto","Favian","Fay","Faye","Federico","Felicia","Felicita","Felicity","Felipa","Felipe","Felix","Felton","Fermin","Fern","Fernando","Ferne","Fidel","Filiberto","Filomena","Finn","Fiona","Flavie","Flavio","Fleta","Fletcher","Flo","Florence","Florencio","Florian","Florida","Florine","Flossie","Floy","Floyd","Ford","Forest","Forrest","Foster","Frances","Francesca","Francesco","Francis","Francisca","Francisco","Franco","Frank","Frankie","Franz","Fred","Freda","Freddie","Freddy","Frederic","Frederick","Frederik","Frederique","Fredrick","Fredy","Freeda","Freeman","Freida","Frida","Frieda","Friedrich","Fritz","Furman","Gabe","Gabriel","Gabriella","Gabrielle","Gaetano","Gage","Gail","Gardner","Garett","Garfield","Garland","Garnet","Garnett","Garret","Garrett","Garrick","Garrison","Garry","Garth","Gaston","Gavin","Gay","Gayle","Gaylord","Gene","General","Genesis","Genevieve","Gennaro","Genoveva","Geo","Geoffrey","George","Georgette","Georgiana","Georgianna","Geovanni","Geovanny","Geovany","Gerald","Geraldine","Gerard","Gerardo","Gerda","Gerhard","Germaine","German","Gerry","Gerson","Gertrude","Gia","Gianni","Gideon","Gilbert","Gilberto","Gilda","Giles","Gillian","Gina","Gino","Giovani","Giovanna","Giovanni","Giovanny","Gisselle","Giuseppe","Gladyce","Gladys","Glen","Glenda","Glenna","Glennie","Gloria","Godfrey","Golda","Golden","Gonzalo","Gordon","Grace","Gracie","Graciela","Grady","Graham","Grant","Granville","Grayce","Grayson","Green","Greg","Gregg","Gregoria","Gregorio","Gregory","Greta","Gretchen","Greyson","Griffin","Grover","Guadalupe","Gudrun","Guido","Guillermo","Guiseppe","Gunnar","Gunner","Gus","Gussie","Gust","Gustave","Guy","Gwen","Gwendolyn","Hadley","Hailee","Hailey","Hailie","Hal","Haleigh","Haley","Halie","Halle","Hallie","Hank","Hanna","Hannah","Hans","Hardy","Harley","Harmon","Harmony","Harold","Harrison","Harry","Harvey","Haskell","Hassan","Hassie","Hattie","Haven","Hayden","Haylee","Hayley","Haylie","Hazel","Hazle","Heath","Heather","Heaven","Heber","Hector","Heidi","Helen","Helena","Helene","Helga","Hellen","Helmer","Heloise","Henderson","Henri","Henriette","Henry","Herbert","Herman","Hermann","Hermina","Herminia","Herminio","Hershel","Herta","Hertha","Hester","Hettie","Hilario","Hilbert","Hilda","Hildegard","Hillard","Hillary","Hilma","Hilton","Hipolito","Hiram","Hobart","Holden","Hollie","Hollis","Holly","Hope","Horace","Horacio","Hortense","Hosea","Houston","Howard","Howell","Hoyt","Hubert","Hudson","Hugh","Hulda","Humberto","Hunter","Hyman","Ian","Ibrahim","Icie","Ida","Idell","Idella","Ignacio","Ignatius","Ike","Ila","Ilene","Iliana","Ima","Imani","Imelda","Immanuel","Imogene","Ines","Irma","Irving","Irwin","Isaac","Isabel","Isabell","Isabella","Isabelle","Isac","Isadore","Isai","Isaiah","Isaias","Isidro","Ismael","Isobel","Isom","Israel","Issac","Itzel","Iva","Ivah","Ivory","Ivy","Izabella","Izaiah","Jabari","Jace","Jacey","Jacinthe","Jacinto","Jack","Jackeline","Jackie","Jacklyn","Jackson","Jacky","Jaclyn","Jacquelyn","Jacques","Jacynthe","Jada","Jade","Jaden","Jadon","Jadyn","Jaeden","Jaida","Jaiden","Jailyn","Jaime","Jairo","Jakayla","Jake","Jakob","Jaleel","Jalen","Jalon","Jalyn","Jamaal","Jamal","Jamar","Jamarcus","Jamel","Jameson","Jamey","Jamie","Jamil","Jamir","Jamison","Jammie","Jan","Jana","Janae","Jane","Janelle","Janessa","Janet","Janice","Janick","Janie","Janis","Janiya","Jannie","Jany","Jaquan","Jaquelin","Jaqueline","Jared","Jaren","Jarod","Jaron","Jarred","Jarrell","Jarret","Jarrett","Jarrod","Jarvis","Jasen","Jasmin","Jason","Jasper","Jaunita","Javier","Javon","Javonte","Jay","Jayce","Jaycee","Jayda","Jayde","Jayden","Jaydon","Jaylan","Jaylen","Jaylin","Jaylon","Jayme","Jayne","Jayson","Jazlyn","Jazmin","Jazmyn","Jazmyne","Jean","Jeanette","Jeanie","Jeanne","Jed","Jedediah","Jedidiah","Jeff","Jefferey","Jeffery","Jeffrey","Jeffry","Jena","Jenifer","Jennie","Jennifer","Jennings","Jennyfer","Jensen","Jerad","Jerald","Jeramie","Jeramy","Jerel","Jeremie","Jeremy","Jermain","Jermaine","Jermey","Jerod","Jerome","Jeromy","Jerrell","Jerrod","Jerrold","Jerry","Jess","Jesse","Jessica","Jessie","Jessika","Jessy","Jessyca","Jesus","Jett","Jettie","Jevon","Jewel","Jewell","Jillian","Jimmie","Jimmy","Jo","Joan","Joana","Joanie","Joanne","Joannie","Joanny","Joany","Joaquin","Jocelyn","Jodie","Jody","Joe","Joel","Joelle","Joesph","Joey","Johan","Johann","Johanna","Johathan","John","Johnathan","Johnathon","Johnnie","Johnny","Johnpaul","Johnson","Jolie","Jon","Jonas","Jonatan","Jonathan","Jonathon","Jordan","Jordane","Jordi","Jordon","Jordy","Jordyn","Jorge","Jose","Josefa","Josefina","Joseph","Josephine","Josh","Joshua","Joshuah","Josiah","Josiane","Josianne","Josie","Josue","Jovan","Jovani","Jovanny","Jovany","Joy","Joyce","Juana","Juanita","Judah","Judd","Jude","Judge","Judson","Judy","Jules","Julia","Julian","Juliana","Julianne","Julie","Julien","Juliet","Julio","Julius","June","Junior","Junius","Justen","Justice","Justina","Justine","Juston","Justus","Justyn","Juvenal","Juwan","Kacey","Kaci","Kacie","Kade","Kaden","Kadin","Kaela","Kaelyn","Kaia","Kailee","Kailey","Kailyn","Kaitlin","Kaitlyn","Kale","Kaleb","Kaleigh","Kaley","Kali","Kallie","Kameron","Kamille","Kamren","Kamron","Kamryn","Kane","Kara","Kareem","Karelle","Karen","Kari","Kariane","Karianne","Karina","Karine","Karl","Karlee","Karley","Karli","Karlie","Karolann","Karson","Kasandra","Kasey","Kassandra","Katarina","Katelin","Katelyn","Katelynn","Katharina","Katherine","Katheryn","Kathleen","Kathlyn","Kathryn","Kathryne","Katlyn","Katlynn","Katrina","Katrine","Kattie","Kavon","Kay","Kaya","Kaycee","Kayden","Kayla","Kaylah","Kaylee","Kayleigh","Kayley","Kayli","Kaylie","Kaylin","Keagan","Keanu","Keara","Keaton","Keegan","Keeley","Keely","Keenan","Keira","Keith","Kellen","Kelley","Kelli","Kellie","Kelly","Kelsi","Kelsie","Kelton","Kelvin","Ken","Kendall","Kendra","Kendrick","Kenna","Kennedi","Kennedy","Kenneth","Kennith","Kenny","Kenton","Kenya","Kenyatta","Kenyon","Keon","Keshaun","Keshawn","Keven","Kevin","Kevon","Keyon","Keyshawn","Khalid","Khalil","Kian","Kiana","Kianna","Kiara","Kiarra","Kiel","Kiera","Kieran","Kiley","Kim","Kimberly","King","Kip","Kira","Kirk","Kirsten","Kirstin","Kitty","Kobe","Koby","Kody","Kolby","Kole","Korbin","Korey","Kory","Kraig","Kris","Krista","Kristian","Kristin","Kristina","Kristofer","Kristoffer","Kristopher","Kristy","Krystal","Krystel","Krystina","Kurt","Kurtis","Kyla","Kyle","Kylee","Kyleigh","Kyler","Kylie","Kyra","Lacey","Lacy","Ladarius","Lafayette","Laila","Laisha","Lamar","Lambert","Lamont","Lance","Landen","Lane","Laney","Larissa","Laron","Larry","Larue","Laura","Laurel","Lauren","Laurence","Lauretta","Lauriane","Laurianne","Laurie","Laurine","Laury","Lauryn","Lavada","Lavern","Laverna","Laverne","Lavina","Lavinia","Lavon","Lavonne","Lawrence","Lawson","Layla","Layne","Lazaro","Lea","Leann","Leanna","Leanne","Leatha","Leda","Lee","Leif","Leila","Leilani","Lela","Lelah","Leland","Lelia","Lempi","Lemuel","Lenna","Lennie","Lenny","Lenora","Lenore","Leo","Leola","Leon","Leonard","Leonardo","Leone","Leonel","Leonie","Leonor","Leonora","Leopold","Leopoldo","Leora","Lera","Lesley","Leslie","Lesly","Lessie","Lester","Leta","Letha","Letitia","Levi","Lew","Lewis","Lexi","Lexie","Lexus","Lia","Liam","Liana","Libbie","Libby","Lila","Lilian","Liliana","Liliane","Lilla","Lillian","Lilliana","Lillie","Lilly","Lily","Lilyan","Lina","Lincoln","Linda","Lindsay","Lindsey","Linnea","Linnie","Linwood","Lionel","Lisa","Lisandro","Lisette","Litzy","Liza","Lizeth","Lizzie","Llewellyn","Lloyd","Logan","Lois","Lola","Lolita","Loma","Lon","London","Lonie","Lonnie","Lonny","Lonzo","Lora","Loraine","Loren","Lorena","Lorenz","Lorenza","Lorenzo","Lori","Lorine","Lorna","Lottie","Lou","Louie","Louisa","Lourdes","Louvenia","Lowell","Loy","Loyal","Loyce","Lucas","Luciano","Lucie","Lucienne","Lucile","Lucinda","Lucio","Lucious","Lucius","Lucy","Ludie","Ludwig","Lue","Luella","Luigi","Luis","Luisa","Lukas","Lula","Lulu","Luna","Lupe","Lura","Lurline","Luther","Luz","Lyda","Lydia","Lyla","Lynn","Lyric","Lysanne","Mabel","Mabelle","Mable","Mac","Macey","Maci","Macie","Mack","Mackenzie","Macy","Madaline","Madalyn","Maddison","Madeline","Madelyn","Madelynn","Madge","Madie","Madilyn","Madisen","Madison","Madisyn","Madonna","Madyson","Mae","Maegan","Maeve","Mafalda","Magali","Magdalen","Magdalena","Maggie","Magnolia","Magnus","Maia","Maida","Maiya","Major","Makayla","Makenna","Makenzie","Malachi","Malcolm","Malika","Malinda","Mallie","Mallory","Malvina","Mandy","Manley","Manuel","Manuela","Mara","Marc","Marcel","Marcelina","Marcelino","Marcella","Marcelle","Marcellus","Marcelo","Marcia","Marco","Marcos","Marcus","Margaret","Margarete","Margarett","Margaretta","Margarette","Margarita","Marge","Margie","Margot","Margret","Marguerite","Maria","Mariah","Mariam","Marian","Mariana","Mariane","Marianna","Marianne","Mariano","Maribel","Marie","Mariela","Marielle","Marietta","Marilie","Marilou","Marilyne","Marina","Mario","Marion","Marisa","Marisol","Maritza","Marjolaine","Marjorie","Marjory","Mark","Markus","Marlee","Marlen","Marlene","Marley","Marlin","Marlon","Marques","Marquis","Marquise","Marshall","Marta","Martin","Martina","Martine","Marty","Marvin","Mary","Maryam","Maryjane","Maryse","Mason","Mateo","Mathew","Mathias","Mathilde","Matilda","Matilde","Matt","Matteo","Mattie","Maud","Maude","Maudie","Maureen","Maurice","Mauricio","Maurine","Maverick","Mavis","Max","Maxie","Maxime","Maximilian","Maximillia","Maximillian","Maximo","Maximus","Maxine","Maxwell","May","Maya","Maybell","Maybelle","Maye","Maymie","Maynard","Mayra","Mazie","Mckayla","Mckenna","Mckenzie","Meagan","Meaghan","Meda","Megane","Meggie","Meghan","Mekhi","Melany","Melba","Melisa","Melissa","Mellie","Melody","Melvin","Melvina","Melyna","Melyssa","Mercedes","Meredith","Merl","Merle","Merlin","Merritt","Mertie","Mervin","Meta","Mia","Micaela","Micah","Michael","Michaela","Michale","Micheal","Michel","Michele","Michelle","Miguel","Mikayla","Mike","Mikel","Milan","Miles","Milford","Miller","Millie","Milo","Milton","Mina","Minerva","Minnie","Miracle","Mireille","Mireya","Misael","Missouri","Misty","Mitchel","Mitchell","Mittie","Modesta","Modesto","Mohamed","Mohammad","Mohammed","Moises","Mollie","Molly","Mona","Monica","Monique","Monroe","Monserrat","Monserrate","Montana","Monte","Monty","Morgan","Moriah","Morris","Mortimer","Morton","Mose","Moses","Moshe","Mossie","Mozell","Mozelle","Muhammad","Muriel","Murl","Murphy","Murray","Mustafa","Mya","Myah","Mylene","Myles","Myra","Myriam","Myrl","Myrna","Myron","Myrtice","Myrtie","Myrtis","Myrtle","Nadia","Nakia","Name","Nannie","Naomi","Naomie","Napoleon","Narciso","Nash","Nasir","Nat","Natalia","Natalie","Natasha","Nathan","Nathanael","Nathanial","Nathaniel","Nathen","Nayeli","Neal","Ned","Nedra","Neha","Neil","Nelda","Nella","Nelle","Nellie","Nels","Nelson","Neoma","Nestor","Nettie","Neva","Newell","Newton","Nia","Nicholas","Nicholaus","Nichole","Nick","Nicklaus","Nickolas","Nico","Nicola","Nicolas","Nicole","Nicolette","Nigel","Nikita","Nikki","Nikko","Niko","Nikolas","Nils","Nina","Noah","Noble","Noe","Noel","Noelia","Noemi","Noemie","Noemy","Nola","Nolan","Nona","Nora","Norbert","Norberto","Norene","Norma","Norris","Norval","Norwood","Nova","Novella","Nya","Nyah","Nyasia","Obie","Oceane","Ocie","Octavia","Oda","Odell","Odessa","Odie","Ofelia","Okey","Ola","Olaf","Ole","Olen","Oleta","Olga","Olin","Oliver","Ollie","Oma","Omari","Omer","Ona","Onie","Opal","Ophelia","Ora","Oral","Oran","Oren","Orie","Orin","Orion","Orland","Orlando","Orlo","Orpha","Orrin","Orval","Orville","Osbaldo","Osborne","Oscar","Osvaldo","Oswald","Oswaldo","Otha","Otho","Otilia","Otis","Ottilie","Ottis","Otto","Ova","Owen","Ozella","Pablo","Paige","Palma","Pamela","Pansy","Paolo","Paris","Parker","Pascale","Pasquale","Pat","Patience","Patricia","Patrick","Patsy","Pattie","Paul","Paula","Pauline","Paxton","Payton","Pearl","Pearlie","Pearline","Pedro","Peggie","Penelope","Percival","Percy","Perry","Pete","Peter","Petra","Peyton","Philip","Phoebe","Phyllis","Pierce","Pierre","Pietro","Pink","Pinkie","Piper","Polly","Porter","Precious","Presley","Preston","Price","Prince","Princess","Priscilla","Providenci","Prudence","Queen","Queenie","Quentin","Quincy","Quinn","Quinten","Quinton","Rachael","Rachel","Rachelle","Rae","Raegan","Rafael","Rafaela","Raheem","Rahsaan","Rahul","Raina","Raleigh","Ralph","Ramiro","Ramon","Ramona","Randal","Randall","Randi","Randy","Ransom","Raoul","Raphael","Raphaelle","Raquel","Rashad","Rashawn","Rasheed","Raul","Raven","Ray","Raymond","Raymundo","Reagan","Reanna","Reba","Rebeca","Rebecca","Rebeka","Rebekah","Reece","Reed","Reese","Regan","Reggie","Reginald","Reid","Reilly","Reina","Reinhold","Remington","Rene","Renee","Ressie","Reta","Retha","Retta","Reuben","Reva","Rex","Rey","Reyes","Reymundo","Reyna","Reynold","Rhea","Rhett","Rhianna","Rhiannon","Rhoda","Ricardo","Richard","Richie","Richmond","Rick","Rickey","Rickie","Ricky","Rico","Rigoberto","Riley","Rita","River","Robb","Robbie","Robert","Roberta","Roberto","Robin","Robyn","Rocio","Rocky","Rod","Roderick","Rodger","Rodolfo","Rodrick","Rodrigo","Roel","Rogelio","Roger","Rogers","Rolando","Rollin","Roma","Romaine","Roman","Ron","Ronaldo","Ronny","Roosevelt","Rory","Rosa","Rosalee","Rosalia","Rosalind","Rosalinda","Rosalyn","Rosamond","Rosanna","Rosario","Roscoe","Rose","Rosella","Roselyn","Rosemarie","Rosemary","Rosendo","Rosetta","Rosie","Rosina","Roslyn","Ross","Rossie","Rowan","Rowena","Rowland","Roxane","Roxanne","Roy","Royal","Royce","Rozella","Ruben","Rubie","Ruby","Rubye","Rudolph","Rudy","Rupert","Russ","Russel","Russell","Rusty","Ruth","Ruthe","Ruthie","Ryan","Ryann","Ryder","Rylan","Rylee","Ryleigh","Ryley","Sabina","Sabrina","Sabryna","Sadie","Sadye","Sage","Saige","Sallie","Sally","Salma","Salvador","Salvatore","Sam","Samanta","Samantha","Samara","Samir","Sammie","Sammy","Samson","Sandra","Sandrine","Sandy","Sanford","Santa","Santiago","Santina","Santino","Santos","Sarah","Sarai","Sarina","Sasha","Saul","Savanah","Savanna","Savannah","Savion","Scarlett","Schuyler","Scot","Scottie","Scotty","Seamus","Sean","Sebastian","Sedrick","Selena","Selina","Selmer","Serena","Serenity","Seth","Shad","Shaina","Shakira","Shana","Shane","Shanel","Shanelle","Shania","Shanie","Shaniya","Shanna","Shannon","Shanny","Shanon","Shany","Sharon","Shaun","Shawn","Shawna","Shaylee","Shayna","Shayne","Shea","Sheila","Sheldon","Shemar","Sheridan","Sherman","Sherwood","Shirley","Shyann","Shyanne","Sibyl","Sid","Sidney","Sienna","Sierra","Sigmund","Sigrid","Sigurd","Silas","Sim","Simeon","Simone","Sincere","Sister","Skye","Skyla","Skylar","Sofia","Soledad","Solon","Sonia","Sonny","Sonya","Sophia","Sophie","Spencer","Stacey","Stacy","Stan","Stanford","Stanley","Stanton","Stefan","Stefanie","Stella","Stephan","Stephania","Stephanie","Stephany","Stephen","Stephon","Sterling","Steve","Stevie","Stewart","Stone","Stuart","Summer","Sunny","Susan","Susana","Susanna","Susie","Suzanne","Sven","Syble","Sydnee","Sydney","Sydni","Sydnie","Sylvan","Sylvester","Sylvia","Tabitha","Tad","Talia","Talon","Tamara","Tamia","Tania","Tanner","Tanya","Tara","Taryn","Tate","Tatum","Tatyana","Taurean","Tavares","Taya","Taylor","Teagan","Ted","Telly","Terence","Teresa","Terrance","Terrell","Terrence","Terrill","Terry","Tess","Tessie","Tevin","Thad","Thaddeus","Thalia","Thea","Thelma","Theo","Theodora","Theodore","Theresa","Therese","Theresia","Theron","Thomas","Thora","Thurman","Tia","Tiana","Tianna","Tiara","Tierra","Tiffany","Tillman","Timmothy","Timmy","Timothy","Tina","Tito","Titus","Tobin","Toby","Tod","Tom","Tomas","Tomasa","Tommie","Toney","Toni","Tony","Torey","Torrance","Torrey","Toy","Trace","Tracey","Tracy","Travis","Travon","Tre","Tremaine","Tremayne","Trent","Trenton","Tressa","Tressie","Treva","Trever","Trevion","Trevor","Trey","Trinity","Trisha","Tristian","Tristin","Triston","Troy","Trudie","Trycia","Trystan","Turner","Twila","Tyler","Tyra","Tyree","Tyreek","Tyrel","Tyrell","Tyrese","Tyrique","Tyshawn","Tyson","Ubaldo","Ulices","Ulises","Una","Unique","Urban","Uriah","Uriel","Ursula","Vada","Valentin","Valentina","Valentine","Valerie","Vallie","Van","Vance","Vanessa","Vaughn","Veda","Velda","Vella","Velma","Velva","Vena","Verda","Verdie","Vergie","Verla","Verlie","Vern","Verna","Verner","Vernice","Vernie","Vernon","Verona","Veronica","Vesta","Vicenta","Vicente","Vickie","Vicky","Victor","Victoria","Vida","Vidal","Vilma","Vince","Vincent","Vincenza","Vincenzo","Vinnie","Viola","Violet","Violette","Virgie","Virgil","Virginia","Virginie","Vita","Vito","Viva","Vivian","Viviane","Vivianne","Vivien","Vivienne","Vladimir","Wade","Waino","Waldo","Walker","Wallace","Walter","Walton","Wanda","Ward","Warren","Watson","Wava","Waylon","Wayne","Webster","Weldon","Wellington","Wendell","Wendy","Werner","Westley","Weston","Whitney","Wilber","Wilbert","Wilburn","Wiley","Wilford","Wilfred","Wilfredo","Wilfrid","Wilhelm","Wilhelmine","Will","Willa","Willard","William","Willie","Willis","Willow","Willy","Wilma","Wilmer","Wilson","Wilton","Winfield","Winifred","Winnifred","Winona","Winston","Woodrow","Wyatt","Wyman","Xander","Xavier","Xzavier","Yadira","Yasmeen","Yasmin","Yasmine","Yazmin","Yesenia","Yessenia","Yolanda","Yoshiko","Yvette","Yvonne","Zachariah","Zachary","Zachery","Zack","Zackary","Zackery","Zakary","Zander","Zane","Zaria","Zechariah","Zelda","Zella","Zelma","Zena","Zetta","Zion","Zita","Zoe","Zoey","Zoie","Zoila","Zola","Zora","Zula"];e.exports={generateUsername:function(){var e=i.randomElement(o),t=i.randomAlphanumStr(3);return"".concat(e,"-").concat(t)}}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return T}));var i=n(14),o=n(6),a=n(8),r=n(107),s=n(87),c=n(34),l=n(33),u=n(22),d=n(15),p=n(20),h=n(35),f=n(11),m=n.n(f),v=n(28),g=n(43),b=n.n(g),y=n(126),A=n.n(y),S=n(127),E=n(375),O=n(194),C=Object(u.getLogger)(e);function j(e){var t=$(e).find(">candidate"),n=[];return t.each((function(e,t){for(var i=t.attributes,o=[],a=0;a<i.length;a++){var r=i[a];o.push("".concat(r.name,": ").concat(r.value))}n.push(o.join(" "))})),n}var T=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e,i,a){var r;return Object(o.a)(this,n),(r=t.call(this)).xmpp=e,r.eventEmitter=i,r.sessions={},r.jvbIceConfig=a.jvb,r.p2pIceConfig=a.p2p,r.mediaConstraints={offerToReceiveAudio:!0,offerToReceiveVideo:!0},r}return Object(a.a)(n,[{key:"init",value:function(e){Object(r.a)(Object(s.a)(n.prototype),"init",this).call(this,e),this.connection.addHandler(this.onJingle.bind(this),"urn:xmpp:jingle:1","iq","set",null,null)}},{key:"onJingle",value:function(e){var t=$(e).find("jingle").attr("sid"),n=$(e).find("jingle").attr("action"),o=e.getAttribute("from"),a=Object(d.$iq)({type:"result",to:o,id:e.getAttribute("id")}),r=this.sessions[t];if("session-initiate"!==n){if(!r)return a.attrs({type:"error"}),a.c("error",{type:"cancel"}).c("item-not-found",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up().c("unknown-session",{xmlns:"urn:xmpp:jingle:errors:1"}),C.warn("invalid session id: ".concat(t)),C.debug(e),this.connection.send(a),!0;if(o!==r.remoteJid)return C.warn("jid mismatch for session id",t,r.remoteJid,e),a.attrs({type:"error"}),a.c("error",{type:"cancel"}).c("item-not-found",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up().c("unknown-session",{xmlns:"urn:xmpp:jingle:errors:1"}),this.connection.send(a),!0}else if(void 0!==r)return a.attrs({type:"error"}),a.c("error",{type:"cancel"}).c("service-unavailable",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up(),C.warn("duplicate session id",t,e),this.connection.send(a),!0;var s=window.performance.now(),c="focus"!==d.Strophe.getResourceFromJid(o),l=$(e).find("jingle>json-message");if(null!==l&&void 0!==l&&l.length){var u,f;C.info("Found a JSON-encoded element in ".concat(n,", translating to standard Jingle."));for(var g=0;g<l.length;g++)f=Object(E.a)(e,l[g]);if(null!==(u=f)&&void 0!==u&&u.size){var y,A=[],S=Object(i.a)(f.keys());try{for(S.s();!(y=S.n()).done;){var T=y.value;A.push("".concat(T,":[").concat(f.get(T),"]"))}}catch(K){S.e(K)}finally{S.f()}C.debug("Received ".concat(n," from ").concat(o," with sources=").concat(A.join(", ")))}}switch(n){case"session-initiate":C.log("(TIME) received session-initiate:\t",s);var k=$(e).find("jingle>startmuted");if(c&&C.debug("Received ".concat(n," from ").concat(o)),null!==k&&void 0!==k&&k.length){var _=k.attr(p.AUDIO),R=k.attr(p.VIDEO);this.eventEmitter.emit(m.a.START_MUTED_FROM_FOCUS,"true"===_,"true"===R)}var I=c?this.p2pIceConfig:this.jvbIceConfig;r=new O.a($(e).find("jingle").attr("sid"),$(e).attr("to"),o,this.connection,this.mediaConstraints,JSON.parse(JSON.stringify(I)),c,!1),this.sessions[r.sid]=r,this.eventEmitter.emit(m.a.CALL_INCOMING,r,$(e).find(">jingle"),s);break;case"session-accept":var w,D=[],P=$(e).find("jingle>content"),M=Object(i.a)(P);try{for(M.s();!(w=M.n()).done;){var N=w.value,x=$(N).find("description").attr("ssrc");x&&D.push(x)}}catch(K){M.e(K)}finally{M.f()}C.debug("Received ".concat(n," from ").concat(o," with ssrcs=").concat(D)),this.eventEmitter.emit(m.a.CALL_ACCEPTED,r,$(e).find(">jingle"));break;case"content-modify":var L=$(e).find('jingle>content[name="video"]>max-frame-height');C.debug("Received ".concat(n," from ").concat(o," with a max-frame-height=").concat(null===L||void 0===L?void 0:L.text())),r.modifyContents($(e).find(">jingle"));break;case"transport-info":var F=j($(e).find("jingle>content>transport"));C.debug("Received ".concat(n," from ").concat(o," for candidates=").concat(F.join(", "))),this.eventEmitter.emit(m.a.TRANSPORT_INFO,r,$(e).find(">jingle"));break;case"session-terminate":C.log("terminating...",r.sid);var B=null,U=null;$(e).find(">jingle>reason").length&&(B=$(e).find(">jingle>reason>:first")[0].tagName,U=$(e).find(">jingle>reason>text").text()),C.debug("Received ".concat(n," from ").concat(o," disconnect reason=").concat(U)),this.terminate(r.sid,B,U),this.eventEmitter.emit(m.a.CALL_ENDED,r,B,U);break;case"transport-replace":var V;C.info("(TIME) Start transport replace:\t",s);var J=$(e).find("jingle>content>transport"),G=j(J),H=$(J).attr("ufrag"),z=$(J).attr("pwd"),Q=null===(V=$(J).find(">fingerprint"))||void 0===V?void 0:V.text();C.debug("Received ".concat(n," from ").concat(o," with iceUfrag=").concat(H,",")+" icePwd=".concat(z,", DTLS fingerprint=").concat(Q,", candidates=").concat(G.join(", "))),v.a.sendAnalytics(Object(h.G)(h.f,{p2p:c,value:s})),r.replaceTransport($(e).find(">jingle"),(function(){var e=window.performance.now();C.info("(TIME) Transport replace success:\t",e),v.a.sendAnalytics(Object(h.G)(h.g,{p2p:c,value:e}))}),(function(e){b.a.callErrorHandler(e),C.error("Transport replace failed",e),r.sendTransportReject()}));break;case"source-add":r.addRemoteStream($(e).find(">jingle>content"));break;case"source-remove":r.removeRemoteStream($(e).find(">jingle>content"));break;default:C.warn("jingle action not implemented",n),a.attrs({type:"error"}),a.c("error",{type:"cancel"}).c("bad-request",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up()}return this.connection.send(a),!0}},{key:"newP2PJingleSession",value:function(e,t){var n=new O.a(A.a.randomHexString(12),e,t,this.connection,this.mediaConstraints,this.p2pIceConfig,!0,!0);return this.sessions[n.sid]=n,n}},{key:"terminate",value:function(e,t,n){this.sessions.hasOwnProperty(e)&&("ended"!==this.sessions[e].state&&this.sessions[e].onTerminated(t,n),delete this.sessions[e])}},{key:"getStunAndTurnCredentials",value:function(){var e=this;this.connection.sendIQ(Object(d.$iq)({type:"get",to:this.xmpp.options.hosts.domain}).c("services",{xmlns:"urn:xmpp:extdisco:2"}),(function(t){return e.onReceiveStunAndTurnCredentials(t)}),(function(){C.warn("getting turn credentials with extdisco:2 failed, trying extdisco:1"),e.connection.sendIQ(Object(d.$iq)({type:"get",to:e.xmpp.options.hosts.domain}).c("services",{xmlns:"urn:xmpp:extdisco:1"}),(function(t){return e.onReceiveStunAndTurnCredentials(t)}),(function(){C.warn("getting turn credentials failed"),C.warn("is mod_turncredentials or similar installed and configured?")}))}))}},{key:"onReceiveStunAndTurnCredentials",value:function(e){var t=[];$(e).find(">services>service").each((function(e,n){var i={},o=(n=$(n)).attr("type");switch(o){case"stun":i.urls="stun:".concat(n.attr("host")),n.attr("port")&&(i.urls+=":".concat(n.attr("port"))),t.push(i);break;case"turn":case"turns":i.urls="".concat(o,":"),i.username=n.attr("username"),i.urls+=n.attr("host"),n.attr("port")&&(i.urls+=":".concat(n.attr("port")));var a=n.attr("transport");a&&"udp"!==a&&(i.urls+="?transport=".concat(a)),i.credential=n.attr("password")||i.credential,t.push(i)}}));for(var n,i=this.xmpp.options,o=t.length-1;o>0;o--){var a=Math.floor(Math.random()*(o+1)),r=t[o];t[o]=t[a],t[a]=r}return n=i.useTurnUdp?function(e){return e.urls.startsWith("turn")}:function(e){return e.urls.startsWith("turn")&&e.urls.indexOf("transport=tcp")>=0},this.jvbIceConfig.iceServers=t.filter(n),this.p2pIceConfig.iceServers=t,t.length>0}},{key:"getLog",value:function(){var e=this,t={};return Object.keys(this.sessions).forEach((function(n){var i=e.sessions[n].peerconnection;i&&i.updateLog&&(t["jingle_".concat(n)]={updateLog:i.updateLog,stats:i.stats,url:window.location.href})})),t}}]),n}(S.b)}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p}));var i=n(22),o=n(15),a=n(20),r=n(73),s=Object(i.getLogger)(e);function c(e,t){var n=Object(o.$build)("source",{xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0",ssrc:t.s,name:r.a.isSourceNameSignalingEnabled()?t.n:void 0});return t.m&&n.c("parameter",{name:"msid",value:t.m}).up(),n.c("ssrc-info",{xmlns:"http://jitsi.org/jitmeet",owner:e}).up(),n.node}function l(e){for(var t=Object(o.$build)("ssrc-group",{xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0",semantics:d(e[0])}),n=1;n<e.length;n++)t.c("source",{xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0",ssrc:e[n]}).up();return t.node}function u(e,t){var n,i=$(e).find("jingle")[0],a=$(i).find('content[name="'.concat(t,'"]'));return a.length?a=a[0]:(a=Object(o.$build)("content",{name:t}).node,i.appendChild(a)),(n=$(a).find("description")).length?n=n[0]:(n=Object(o.$build)("description",{xmlns:"urn:xmpp:jingle:apps:rtp:1",media:t}).node,a.appendChild(n)),n}function d(e){return"f"===e?"FID":"s"===e?"SIM":null}function p(e,t){var n,i;try{i=JSON.parse(t.textContent)}catch(j){return s.error("json-message XML contained invalid JSON, ignoring: ".concat(t.textContent)),null}if(null===(n=i)||void 0===n||!n.sources)return null;var o=u(e,a.AUDIO),r=u(e,a.VIDEO),d=new Map;for(var p in i.sources)if(i.sources.hasOwnProperty(p)){var h=[],f=i.sources[p],m=(null===f||void 0===f?void 0:f.length)&&f[0],v=(null===f||void 0===f?void 0:f.length)>1&&f[1],g=(null===f||void 0===f?void 0:f.length)>2&&f[2],b=(null===f||void 0===f?void 0:f.length)>3&&f[3];if(null!==m&&void 0!==m&&m.length){for(var y,A=0;A<m.length;A++)r.appendChild(c(p,m[A]));h.push(null===(y=m[0])||void 0===y?void 0:y.s)}if(null!==v&&void 0!==v&&v.length)for(var S=0;S<v.length;S++)r.appendChild(l(v[S]));if(null!==g&&void 0!==g&&g.length){for(var E,O=0;O<g.length;O++)o.appendChild(c(p,g[O]));h.push(null===(E=g[0])||void 0===E?void 0:E.s)}if(null!==b&&void 0!==b&&b.length)for(var C=0;C<b.length;C++)o.appendChild(l(b[C]));d.set(p,h)}return d}}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var i=n(6),o=n(8),a=n(22),r=n(377),s=n.n(r),c=Object(a.getLogger)(e),l=function(){function e(){Object(i.a)(this,e),this._queue=s.a.queue(this._processQueueTasks.bind(this),1),this._stopped=!1}return Object(o.a)(e,[{key:"clear",value:function(){this._queue.kill()}},{key:"_processQueueTasks",value:function(e,t){try{e(t)}catch(n){c.error("Task failed: ".concat(null===n||void 0===n?void 0:n.stack)),t(n)}}},{key:"push",value:function(e,t){this._stopped?t&&t(new Error("The queue has been stopped")):this._queue.push(e,t)}},{key:"shutdown",value:function(){this._stopped=!0}}]),e}()}).call(this,"/index.js")},,function(e,t){e.exports={integerHash:function(e){if(!e)return 0;var t,n=0;for(t=0;t<e.length;t++)n+=e.charCodeAt(t)*Math.pow(31,e.length-1-t),n=Math.abs(0|n);return n}}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return d}));var i=n(6),o=n(8),a=n(34),r=n(33),s=n(22),c=n(72),l=n(110),u=Object(s.getLogger)(e),d=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e,o,a,r,s,c,l){var u;return Object(i.a)(this,n),(u=t.call(this)).sid=e,u.localJid=o,u.remoteJid=a,u.connection=r,u.mediaConstraints=s,u.pcConfig=c,u.isInitiator=l,u.usedrip=!0,u.dripContainer=[],u.room=null,u._signalingLayer=null,u.state=null,u.rtc=null,u}return Object(o.a)(n,[{key:"initiatorJid",get:function(){return this.isInitiator?this.localJid:this.remoteJid}},{key:"responderJid",get:function(){return this.isInitiator?this.remoteJid:this.localJid}},{key:"initialize",value:function(e,t,n,i){if(null!==this.state){var o="attempt to initiate on session ".concat(this.sid,"\n                   in state ").concat(this.state);throw u.error(o),new Error(o)}this.room=e,this.rtc=t,this._signalingLayer=n,this.state=l.c,this.doInitialize(i)}},{key:"doInitialize",value:function(e){}},{key:"addIceCandidates",value:function(e){}},{key:"getState",value:function(){return this.state}},{key:"addSources",value:function(e){}},{key:"removeSources",value:function(e){}},{key:"terminate",value:function(e,t,n){}},{key:"acceptOffer",value:function(e,t,n){}},{key:"_getInitiatorJid",value:function(){return this.isInitiator?this.localJid:this.remoteJid}}]),n}(c.a)}).call(this,"/index.js")},function(e,t,n){"use strict";var i=n(6),o=n(8),a=n(107),r=n(87),s=n(34),c=n(33),l=n(15),u=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.call(this)).log=[],e}return Object(o.a)(n,[{key:"init",value:function(e){Object(a.a)(Object(r.a)(n.prototype),"init",this).call(this,e),this.connection.rawInput=this.logIncoming.bind(this),this.connection.rawOutput=this.logOutgoing.bind(this)}},{key:"logIncoming",value:function(e){this.log.push([(new Date).getTime(),"incoming",e])}},{key:"logOutgoing",value:function(e){this.log.push([(new Date).getTime(),"outgoing",e])}}]),n}(n(127).b);t.a=function(){l.Strophe.addConnectionPlugin("logger",new u)}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var i=n(6),o=n(8),a=n(107),r=n(87),s=n(34),c=n(33),l=n(22),u=n(15),d=n(127),p=Object(l.getLogger)(e),h="urn:xmpp:rayo:1",f=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"init",value:function(e){Object(a.a)(Object(r.a)(n.prototype),"init",this).call(this,e),this.connection.addHandler(this.onRayo.bind(this),h,"iq","set",null,null)}},{key:"onRayo",value:function(e){p.info("Rayo IQ",e)}},{key:"dial",value:function(e,t,n,i,o){var a=this;return new Promise((function(r,s){if(o){var c=Object(u.$iq)({type:"set",to:o});c.c("dial",{xmlns:h,to:e,from:t}),c.c("header",{name:"JvbRoomName",value:n}).up(),i&&i.length&&c.c("header",{name:"JvbRoomPassword",value:i}).up(),a.connection.sendIQ(c,(function(e){p.info("Dial result ",e);var t=$(e).find("ref").attr("uri");a.callResource=t.substr("xmpp:".length),p.info("Received call resource: ".concat(a.callResource)),r()}),(function(e){p.info("Dial error ",e),s(e)}))}else s(new Error("Internal error!"))}))}},{key:"hangup",value:function(){var e=this;return new Promise((function(t,n){if(!e.callResource)return n(new Error("No call in progress")),void p.warn("No call in progress");var i=Object(u.$iq)({type:"set",to:e.callResource});i.c("hangup",{xmlns:h}),e.connection.sendIQ(i,(function(n){p.info("Hangup result ",n),e.callResource=null,t()}),(function(t){p.info("Hangup error ",t),e.callResource=null,n(new Error("Hangup error "))}))}))}}]),n}(d.b)}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){var i=n(22),o=n(15),a=n(43),r=n.n(a),s=Object(i.getLogger)(e),c=-1,l=/request id \d+.\d+ got 200/,u=/request errored, status: (\d+), number of errors: \d+/;t.a=function(){o.Strophe.log=function(e,t){switch(s.trace("Strophe",e,t),"string"===typeof t&&-1!==t.indexOf("Request ")&&-1!==t.indexOf("timed out (secondary), restarting")&&(e=o.Strophe.LogLevel.WARN),e){case o.Strophe.LogLevel.DEBUG:-1!==c&&l.test(t)&&(s.debug("Reset lastErrorStatus"),c=-1);break;case o.Strophe.LogLevel.WARN:s.warn("Strophe: ".concat(t));var n=u.exec(t);n&&2===n.length&&(c=parseInt(n[1],10),s.debug("lastErrorStatus set to: ".concat(c)));break;case o.Strophe.LogLevel.ERROR:case o.Strophe.LogLevel.FATAL:t="Strophe: ".concat(t),r.a.callErrorHandler(new Error(t)),s.error(t)}},o.Strophe.getLastErrorStatus=function(){return c},o.Strophe.getStatusString=function(e){switch(e){case o.Strophe.Status.BINDREQUIRED:return"BINDREQUIRED";case o.Strophe.Status.ERROR:return"ERROR";case o.Strophe.Status.CONNECTING:return"CONNECTING";case o.Strophe.Status.CONNFAIL:return"CONNFAIL";case o.Strophe.Status.AUTHENTICATING:return"AUTHENTICATING";case o.Strophe.Status.AUTHFAIL:return"AUTHFAIL";case o.Strophe.Status.CONNECTED:return"CONNECTED";case o.Strophe.Status.DISCONNECTED:return"DISCONNECTED";case o.Strophe.Status.DISCONNECTING:return"DISCONNECTING";case o.Strophe.Status.ATTACHED:return"ATTACHED";default:return"unknown"}}}}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var i=n(14),o=n(6),a=n(8),r=n(22),s=n(12),c=n(68),l=n.n(c),u=n(20),d=n(21),p=Object(r.getLogger)(e),h=function(){function e(t,n){var i=this;Object(o.a)(this,e),this.conference=t,this.options=n,this.disabledCodec=n.disabledCodec===l.a.VP8?void 0:this._getCodecMimeType(n.disabledCodec);var a=this._getCodecMimeType(n.jvbCodec),r=this._getCodecMimeType(n.p2pCodec);this.jvbPreferredCodec=a&&this._isCodecSupported(a)?a:l.a.VP8,this.p2pPreferredCodec=r&&this._isCodecSupported(r)?r:l.a.VP8,p.debug("Codec preferences for the conference are JVB: ".concat(this.jvbPreferredCodec,",\n            P2P: ").concat(this.p2pPreferredCodec)),this.jvbPreferredCodec!==l.a.VP9||d.a.supportsVP9()||(this.jvbPreferredCodec=l.a.VP8),this.conference.on(s.USER_JOINED,(function(){return i._selectPreferredCodec()})),this.conference.on(s.USER_LEFT,(function(){return i._selectPreferredCodec()})),this.conference.on(s._MEDIA_SESSION_STARTED,(function(e){return i._onMediaSessionStared(e)}))}return Object(a.a)(e,[{key:"_getCodecMimeType",value:function(e){return"string"===typeof e?Object.values(l.a).find((function(t){return t===e.toLowerCase()})):null}},{key:"_isCodecSupported",value:function(e){return!(!d.a.isFirefox()&&!d.a.isReactNative())||window.RTCRtpReceiver&&window.RTCRtpReceiver.getCapabilities&&window.RTCRtpReceiver.getCapabilities("video").codecs.some((function(t){return t.mimeType.toLowerCase()==="video/".concat(e)}))}},{key:"_onMediaSessionStared",value:function(e){var t=e.isP2P?this.p2pPreferredCodec:this.jvbPreferredCodec,n=this.disabledCodec&&this._isCodecSupported(this.disabledCodec)?this.disabledCodec:null;this._selectPreferredCodec(e,t,n)}},{key:"_selectPreferredCodec",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=e||this.conference.jvbJingleSession,a=t||this.jvbPreferredCodec,r=a;if(o&&!o.isP2P&&!this.options.enforcePreferredCodec){var s,c=this.conference.getParticipants().map((function(e){return e.getId()})),p=Object(i.a)(c);try{for(p.s();!(s=p.n()).done;){var h=s.value,f=o._signalingLayer.getPeerMediaInfo(h,u.VIDEO),m=null===f||void 0===f?void 0:f.codecType;m&&m!==a&&(m!==l.a.VP9||d.a.supportsVP9())&&(r=m)}}catch(v){p.e(v)}finally{p.f()}}o&&o.setVideoCodecs(r,n)}},{key:"getPreferredCodec",value:function(){return this.jvbPreferredCodec}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var i=n(5),o=n(6),a=n(8),r=n(22),s=n(31),c=n.n(s),l=n(35),u=n(28),d=n(43),p=n.n(d),h=Object(r.getLogger)(e),f=function(){function e(t,n,i){if(Object(o.a)(this,e),!t&&!n)throw new TypeError("At least peerconnection or wsUrl must be given");if(t&&n)throw new TypeError("Just one of peerconnection or wsUrl must be given");if(t?h.debug("constructor() with peerconnection"):h.debug('constructor() with wsUrl:"'.concat(n,'"')),this._channel=null,this._eventEmitter=i,this._mode=null,this._areRetriesEnabled=!1,this._closedFromClient=!1,t){var a=t.createDataChannel("JVB data channel",{protocol:"http://jitsi.org/protocols/colibri"});this._handleChannel(a),this._mode="datachannel"}else n&&(this._areRetriesEnabled=!0,this._wsUrl=n,this._initWebSocket())}return Object(a.a)(e,[{key:"_initWebSocket",value:function(){var e=new WebSocket(this._wsUrl);this._handleChannel(e),this._mode="websocket"}},{key:"_startConnectionRetries",value:function(){var e=this,t=1;this._retryTimeout=setTimeout((function n(){e.isOpen()||(e._initWebSocket(e._wsUrl),t=Math.min(2*t,60),e._retryTimeout=setTimeout(n,1e3*t))}),1e3*t)}},{key:"_stopConnectionRetries",value:function(){this._retryTimeout&&(clearTimeout(this._retryTimeout),this._retryTimeout=void 0)}},{key:"_retryWebSocketConnection",value:function(e){var t=this;if(this._areRetriesEnabled){var n=e.code,i=e.reason;u.a.sendAnalytics(Object(l.y)(n,i)),this._areRetriesEnabled=!1,this._eventEmitter.once(c.a.DATA_CHANNEL_OPEN,(function(){t._stopConnectionRetries(),t._areRetriesEnabled=!0})),this._startConnectionRetries()}}},{key:"mode",get:function(){return this._mode}},{key:"close",value:function(){if(this._closedFromClient=!0,this._stopConnectionRetries(),this._areRetriesEnabled=!1,this._channel){try{this._channel.close()}catch(e){}this._channel=null}}},{key:"isOpen",value:function(){return this._channel&&("open"===this._channel.readyState||this._channel.readyState===WebSocket.OPEN)}},{key:"sendEndpointStatsMessage",value:function(e){this._send(Object(i.a)({colibriClass:"EndpointStats"},e))}},{key:"sendMessage",value:function(e,t){this._send({colibriClass:"EndpointMessage",msgPayload:t,to:e})}},{key:"sendSetLastNMessage",value:function(e){h.log("Sending lastN=".concat(e,".")),this._send({colibriClass:"LastNChangedEvent",lastN:e})}},{key:"sendSetPerceptiblesEventMessage",value:function(e){var t=Object(i.a)({colibriClass:"PerceptiblesEvent"},e);this._send(t),h.log("Channel PerceptiblesEvent peceptibles set to:",e)}},{key:"sendSelectedEndpointsMessage",value:function(e){h.log("Sending selected endpoints: ".concat(e,".")),this._send({colibriClass:"SelectedEndpointsChangedEvent",selectedEndpoints:e})}},{key:"sendReceiverVideoConstraintMessage",value:function(e){h.log("Sending ReceiverVideoConstraint with maxFrameHeight=".concat(e,"px")),this._send({colibriClass:"ReceiverVideoConstraint",maxFrameHeight:e})}},{key:"sendNewReceiverVideoConstraintsMessage",value:function(e){h.log("Sending ReceiverVideoConstraints with ".concat(JSON.stringify(e))),this._send(Object(i.a)({colibriClass:"ReceiverVideoConstraints"},e))}},{key:"sendVideoTypeMessage",value:function(e){h.debug("Sending VideoTypeMessage with video type as ".concat(e)),this._send({colibriClass:"VideoTypeMessage",videoType:e})}},{key:"sendSourceVideoTypeMessage",value:function(e,t){h.info("Sending SourceVideoTypeMessage with video type ".concat(e,": ").concat(t)),this._send({colibriClass:"SourceVideoTypeMessage",sourceName:e,videoType:t})}},{key:"_handleChannel",value:function(e){var t=this,n=this._eventEmitter;e.onopen=function(){h.info("".concat(t._mode," channel opened")),n.emit(c.a.DATA_CHANNEL_OPEN)},e.onerror=function(e){"websocket"!==t._mode&&h.error("Channel error: ".concat(e.message))},e.onmessage=function(e){var t,i=e.data;try{t=JSON.parse(i)}catch(v){return p.a.callErrorHandler(v),void h.error("Failed to parse channel message as JSON: ",i,v)}var o=t.colibriClass;switch(o){case"DominantSpeakerEndpointChangeEvent":var a=t,r=a.dominantSpeakerEndpoint,s=a.previousSpeakers,l=void 0===s?[]:s;h.debug("Dominant speaker: ".concat(r,", previous speakers: ").concat(l)),n.emit(c.a.DOMINANT_SPEAKER_CHANGED,r,l);break;case"EndpointConnectivityStatusChangeEvent":var u=t.endpoint,d="true"===t.active;h.info("Endpoint connection status changed: ".concat(u," active=").concat(d)),n.emit(c.a.ENDPOINT_CONN_STATUS_CHANGED,u,d);break;case"EndpointMessage":n.emit(c.a.ENDPOINT_MESSAGE_RECEIVED,t.from,t.msgPayload);break;case"EndpointStats":n.emit(c.a.ENDPOINT_STATS_RECEIVED,t.from,t);break;case"LastNEndpointsChangeEvent":var f=t.lastNEndpoints;h.info("New forwarded endpoints: ".concat(f)),n.emit(c.a.LASTN_ENDPOINT_CHANGED,f);break;case"SenderVideoConstraints":var m=t.videoConstraints;m&&(h.info("SenderVideoConstraints: ".concat(JSON.stringify(m))),n.emit(c.a.SENDER_VIDEO_CONSTRAINTS_CHANGED,m));break;case"ServerHello":h.info("Received ServerHello, version=".concat(t.version,"."));break;default:h.debug("Channel JSON-formatted message: ",t),n.emit("rtc.datachannel.".concat(o),t)}},e.onclose=function(e){h.info("Channel closed by ".concat(t._closedFromClient?"client":"server")),"websocket"===t._mode&&(t._closedFromClient||(h.error("Channel closed: ".concat(e.code," ").concat(e.reason)),t._retryWebSocketConnection(e))),t._channel=null},this._channel=e}},{key:"_send",value:function(e){var t=this._channel;if(!this.isOpen())throw h.error("Bridge Channel send: no opened channel."),new Error("No opened channel");t.send(JSON.stringify(e))}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return P}));var i=n(58),o=n(14),a=n(22),r=n(473),s=n(79),c=n.n(s),l=n(68),u=n(39),d=n.n(u),p=n(20),h=n(31),f=n.n(h),m=n(121),v=n(117),g=n(45),b=n(116),y=n(21),A=n(73),S=n(386),E=n(387),O=n(67),C=n(32),j=n(388),T=n(99),k=n(43),_=n(389),R=n(46),I=n(42),w=n(147),D=Object(a.getLogger)(e);function P(e,t,i,o,a,s,c){var l=this;this.audioTransferActive=!(!0===c.startSilent),this._dtmfSender=void 0,this._dtmfTonesQueue=[],this.videoTransferActive=!0,this.rtc=e,this.id=t,this.isP2P=s,this.remoteTracks=new Map,this.localTracks=new Map,this._addedStreams=[],this.localSSRCs=new Map,this.localUfrag=null,this.remoteUfrag=null,this.signalingLayer=i,this._peerVideoTypeChanged=this._peerVideoTypeChanged.bind(this),this.signalingLayer.on(m.b,this._peerVideoTypeChanged),this._peerMutedChanged=this._peerMutedChanged.bind(this),this.signalingLayer.on(m.a,this._peerMutedChanged),this.options=c;var u=a||{};u.optional=u.optional||[],Array.isArray(u.optional)?u.optional.push({rtcStatsSFUP2P:this.isP2P}):D.warn("Optional param is not an array, rtcstats p2p data is omitted."),this.peerconnection=new I.a.RTCPeerConnectionType(o,u),this.tpcUtils=new w.d(this),this.updateLog=[],this.stats={},this.statsinterval=null,this._capScreenshareBitrate=this.options.capScreenshareBitrate,this._usesUnifiedPlan=c.usesUnifiedPlan,this._usesTransceiverCodecPreferences=y.a.supportsCodecPreferences()&&this._usesUnifiedPlan,this._usesTransceiverCodecPreferences&&D.info("Using RTCRtpTransceiver#setCodecPreferences for codec selection"),this.maxstats=c.maxstats,this.interop=new r.a;var d=n(518);this.simulcast=new d({numOfLayers:w.c.length,explodeRemoteSimulcast:!1,usesUnifiedPlan:this._usesUnifiedPlan}),this.sdpConsistency=new j.a(this.toString()),this.localSdpMunger=new S.a(this,this.rtc.getLocalEndpointId()),this.eventEmitter=e.eventEmitter,this.rtxModifier=new E.a,this._senderVideoMaxHeight=2160,this.trace=function(e,t){D.debug(e,t),l.updateLog.push({time:new Date,type:e,value:t||""})},this.onicecandidate=null,this.peerconnection.onicecandidate=function(e){l.trace("onicecandidate",JSON.stringify(e.candidate,null," ")),null!==l.onicecandidate&&l.onicecandidate(e)},this._usesUnifiedPlan?(this.onTrack=function(e){var t=e.streams[0];l._remoteTrackAdded(t,e.track,e.transceiver),t.addEventListener("removetrack",(function(e){l._remoteTrackRemoved(t,e.track)}))},this.peerconnection.addEventListener("track",this.onTrack)):(this.peerconnection.onaddstream=function(e){return l._remoteStreamAdded(e.stream)},this.peerconnection.onremovestream=function(e){return l._remoteStreamRemoved(e.stream)}),this.onsignalingstatechange=null,this.peerconnection.onsignalingstatechange=function(e){l.trace("onsignalingstatechange",l.signalingState),null!==l.onsignalingstatechange&&l.onsignalingstatechange(e)},this.oniceconnectionstatechange=null,this.peerconnection.oniceconnectionstatechange=function(e){l.trace("oniceconnectionstatechange",l.iceConnectionState),null!==l.oniceconnectionstatechange&&l.oniceconnectionstatechange(e)},this.onnegotiationneeded=null,this.peerconnection.onnegotiationneeded=function(e){l.trace("onnegotiationneeded"),null!==l.onnegotiationneeded&&l.onnegotiationneeded(e)},this.onconnectionstatechange=null,this.peerconnection.onconnectionstatechange=function(e){l.trace("onconnectionstatechange",l.connectionState),null!==l.onconnectionstatechange&&l.onconnectionstatechange(e)},this.ondatachannel=null,this.peerconnection.ondatachannel=function(e){l.trace("ondatachannel"),null!==l.ondatachannel&&l.ondatachannel(e)},this.maxstats&&(this.statsinterval=window.setInterval((function(){l.getStats().then((function(e){if("function"===typeof(null===e||void 0===e?void 0:e.result))for(var t=e.result(),n=function(e){var n=t[e];n.names().forEach((function(e){l._processStat(n,e,n.stat(e))}))},i=0;i<t.length;++i)n(i);else e.forEach((function(e){return l._processStat(e,"",e)}))}))}),1e3)),D.info("Create new ".concat(this))}P.prototype._processStat=function(e,t,n){var i="".concat(e.id,"-").concat(t),o=this.stats[i],a=new Date;o||(this.stats[i]=o={startTime:a,endTime:a,values:[],times:[]}),o.values.push(n),o.times.push(a.getTime()),o.values.length>this.maxstats&&(o.values.shift(),o.times.shift()),o.endTime=a};var M=function(e){return"undefined"===typeof e||null===e?"":"type: ".concat(e.type,"\r\n").concat(e.sdp)};P.prototype.getConnectionState=function(){var e=this.peerconnection.iceConnectionState;return"completed"===e?"connected":e},P.prototype.getDesiredMediaDirection=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.hasAnyTracksOfType(e);if(this._usesUnifiedPlan)return t?n?d.a.SENDRECV:d.a.SENDONLY:n?d.a.RECVONLY:d.a.INACTIVE;var i=e===p.AUDIO?this.audioTransferActive:this.videoTransferActive;return i?n?d.a.SENDRECV:d.a.RECVONLY:d.a.INACTIVE},P.prototype._getReceiversByEndpointIds=function(e,t){var n,i=[],a=Object(o.a)(e);try{for(a.s();!(n=a.n()).done;){var r=n.value;i=i.concat(this.getRemoteTracks(r,t))}}catch(c){a.e(c)}finally{a.f()}var s=i.map((function(e){var t;return null===(t=e.track)||void 0===t?void 0:t.id}));return this.peerconnection.getReceivers().filter((function(e){return e.track&&e.track.kind===t&&s.find((function(t){return t===e.track.id}))}))},P.prototype.isSimulcastOn=function(){return!this.options.disableSimulcast},P.prototype._peerVideoTypeChanged=function(e,t){if(e){var n=this.getRemoteTracks(e,p.VIDEO);n.length&&n[0]._setVideoType(t)}else D.error("".concat(this," No endpointID on peerVideoTypeChanged"))},P.prototype._peerMutedChanged=function(e,t,n){if(e){var i=this.getRemoteTracks(e,t);i.length&&i[0].setMute(n)}else D.error("".concat(this," On peerMuteChanged - no endpoint ID"))},P.prototype.getAudioLevels=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={},n=e.length?this._getReceiversByEndpointIds(e,p.AUDIO):this.peerconnection.getReceivers().filter((function(e){return e.track&&e.track.kind===p.AUDIO&&e.track.enabled}));return n.forEach((function(e){var n=e.getSynchronizationSources();n&&n.length&&(t[n[0].source]=n[0].audioLevel)})),t},P.prototype.getLocalTracks=function(e){var t=Array.from(this.localTracks.values());return void 0!==e&&(t=t.filter((function(t){return t.getType()===e}))),t},P.prototype.getLocalVideoTrack=function(){return this.getLocalTracks(p.VIDEO)[0]},P.prototype.hasAnyTracksOfType=function(e){if(!e)throw new Error('"mediaType" is required');return this.getLocalTracks(e).length>0},P.prototype.getRemoteTracks=function(e,t){var n,i=[],a=e?[e]:this.remoteTracks.keys(),r=Object(o.a)(a);try{for(r.s();!(n=r.n()).done;){var s=n.value,c=this.remoteTracks.get(s);if(c){var l,u=Object(o.a)(c.keys());try{for(u.s();!(l=u.n()).done;){var d=l.value;if(!t||t===d){var p=c.get(d);p&&i.push(p)}}}catch(h){u.e(h)}finally{u.f()}}}}catch(h){r.e(h)}finally{r.f()}return i},P.prototype.getRemoteSourceInfoByParticipant=function(e){var t=[],n=this.getRemoteTracks(e);if(null===n||void 0===n||!n.length)return t;var i=n.map((function(e){return e.getSSRC()})),a=new O.a(this.remoteDescription.sdp);return i.forEach((function(e,n){var i,r=Object(o.a)(a.media);try{for(r.s();!(i=r.n()).done;){var s=i.value,c="",l=C.a.findLines(s,"a=ssrc:".concat(e));if(l.length){t[n]||(t[n]="");var u=C.a.findLines(s,"a=ssrc-group:FID ".concat(e));if(u.length){var d=u[0].split(" ")[2];c+="".concat(u[0],"\r\n"),l=l.concat(C.a.findLines(s,"a=ssrc:".concat(d)))}t[n]+="".concat(l.join("\r\n"),"\r\n"),t[n]+=c}}}catch(p){r.e(p)}finally{r.f()}})),t},P.prototype.getTargetVideoBitrates=function(){var e=this.getConfiguredVideoCodec();return this.tpcUtils.videoBitrates[e.toUpperCase()]||this.tpcUtils.videoBitrates},P.prototype.getTrackBySSRC=function(e){if("number"!==typeof e)throw new Error("SSRC ".concat(e," is not a number"));var t,n=Object(o.a)(this.localTracks.values());try{for(n.s();!(t=n.n()).done;){var i=t.value;if(this.getLocalSSRC(i)===e)return i}}catch(c){n.e(c)}finally{n.f()}var a,r=Object(o.a)(this.getRemoteTracks());try{for(r.s();!(a=r.n()).done;){var s=a.value;if(s.getSSRC()===e)return s}}catch(c){r.e(c)}finally{r.f()}return null},P.prototype.getSsrcByTrackId=function(e){var t=function(t){return t.getTrack().id===e},n=this.getLocalTracks().find(t);if(n)return this.getLocalSSRC(n);var i=this.getRemoteTracks().find(t);return i?i.getSSRC():null},P.prototype._remoteStreamAdded=function(e){var t=this,n=R.a.getStreamID(e);if(R.a.isUserStreamById(n)){y.a.isChromiumBased()&&(e.onaddtrack=function(n){t._remoteTrackAdded(e,n.track)},e.onremovetrack=function(n){t._remoteTrackRemoved(e,n.track)});var i,a=e.getAudioTracks(),r=Object(o.a)(a);try{for(r.s();!(i=r.n()).done;){var s=i.value;this._remoteTrackAdded(e,s)}}catch(p){r.e(p)}finally{r.f()}var c,l=e.getVideoTracks(),u=Object(o.a)(l);try{for(u.s();!(c=u.n()).done;){var d=c.value;this._remoteTrackAdded(e,d)}}catch(p){u.e(p)}finally{u.f()}}else D.info("".concat(this," ignored remote 'stream added' event for non-user stream[id=").concat(n,"]"))},P.prototype._remoteTrackAdded=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=R.a.getStreamID(e),o=t.kind;if(this.isP2P||R.a.isUserStreamById(i))if(D.info("".concat(this," adding remote track for stream[id=").concat(i,",type=").concat(o,"]")),o){var a,r=this._usesUnifiedPlan?new O.a(this.peerconnection.remoteDescription.sdp):new O.a(this.remoteDescription.sdp);if(this._usesUnifiedPlan)if(n&&n.mid){var s=n.mid;a=r.media.filter((function(e){return C.a.findLine(e,"a=mid:".concat(s))}))}else a=r.media.filter((function(e){var t=C.a.findLine(e,"a=msid:");return"undefined"!==typeof t&&i===t.substring(7).split(" ")[0]}));else a=r.media.filter((function(e){return e.startsWith("m=".concat(o))}));if(a.length){var c=C.a.findLines(a[0],"a=ssrc:");if((c=c.filter((function(e){return-1!==e.indexOf("msid:".concat(i))}))).length){var l=c[0].substring(7).split(" ")[0],u=Number(l),d=this.signalingLayer.getSSRCOwner(u);if(isNaN(u)||u<0)k.callErrorHandler(new Error("Invalid SSRC for remote stream[ssrc=".concat(u,",id=").concat(i,",type=").concat(o,"]")));else if(d){var p;A.a.isSourceNameSignalingEnabled()&&((p=this.signalingLayer.getTrackSourceName(u))||(p=Object(v.c)(d,o,0))),D.info("".concat(this," creating remote track[endpoint=").concat(d,",ssrc=").concat(u,",")+"type=".concat(o,",sourceName=").concat(p,"]"));var h=this.signalingLayer.getPeerMediaInfo(d,o);if(h){var f=h.muted,m=h.videoType;this._createRemoteTrack(d,e,t,o,m,u,f,p)}else k.callErrorHandler(new Error("".concat(this,": no peer media info available for ").concat(d)))}else k.callErrorHandler(new Error("No SSRC owner known for remote stream[ssrc=".concat(u,",id=").concat(i,",type=").concat(o,"]")))}else k.callErrorHandler(new Error("No SSRC lines found in remote SDP for remote stream[msid=".concat(i,",type=").concat(o,"]")))}else k.callErrorHandler(new Error("No media lines found in remote SDP for remote stream[id=".concat(i,",type=").concat(o,"]")))}else k.callErrorHandler(new Error("MediaType undefined for remote track, stream id: ".concat(i)));else D.info("".concat(this," ignored remote 'stream added' event for non-user stream[id=").concat(i,"]"))},P.prototype._createRemoteTrack=function(e,t,n,i,o,a,r,s){var c=this.remoteTracks.get(e);c||(c=new Map,this.remoteTracks.set(e,c));var l=c.get(i);if(l&&l.getTrack()===n)D.info("".concat(this," ignored duplicated track event for track[endpoint=").concat(e,",type=").concat(i,"]"));else{l&&(D.error("".concat(this," received a second remote track for track[endpoint=").concat(e,",type=").concat(i,"]")+"deleting the existing track"),this._remoteTrackRemoved(l.getOriginalStream(),l.getTrack()));var u=new _.a(this.rtc,this.rtc.conference,e,t,n,i,o,a,r,this.isP2P,s);c.set(i,u),this.eventEmitter.emit(f.a.REMOTE_TRACK_ADDED,u,this)}},P.prototype._remoteStreamRemoved=function(e){if(R.a.isUserStream(e)){var t,n=e.getVideoTracks(),i=Object(o.a)(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;this._remoteTrackRemoved(e,a)}}catch(d){i.e(d)}finally{i.f()}var r,s=e.getAudioTracks(),c=Object(o.a)(s);try{for(c.s();!(r=c.n()).done;){var l=r.value;this._remoteTrackRemoved(e,l)}}catch(d){c.e(d)}finally{c.f()}}else{var u=R.a.getStreamID(e);D.info("Ignored remote 'stream removed' event for stream[id=".concat(u,"]"))}},P.prototype._remoteTrackRemoved=function(e,t){var n=R.a.getStreamID(e),i=t&&R.a.getTrackID(t);R.a.isUserStreamById(n)?(D.info("".concat(this," remote track removed stream[id=").concat(n,",trackId=").concat(i,"]")),n?i?this._removeRemoteTrackById(n,i)||D.warn("".concat(this," Removed track not found for stream[id=").concat(n,",trackId=").concat(i,"]")):k.callErrorHandler(new Error("".concat(this," remote track removal failed - no track ID"))):k.callErrorHandler(new Error("".concat(this," remote track removal failed - no stream ID")))):D.info("".concat(this," ignored remote 'stream removed' event for non-user stream[id=").concat(n,"]"))},P.prototype._getRemoteTrackById=function(e,t){var n,i=Object(o.a)(this.remoteTracks.values());try{for(i.s();!(n=i.n()).done;){var a,r=n.value,s=Object(o.a)(r.values());try{for(s.s();!(a=s.n()).done;){var c=a.value;if(c.getStreamId()==e&&c.getTrackId()==t)return c}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}},P.prototype.removeRemoteTracks=function(e){var t=[],n=this.remoteTracks.get(e);if(n){var i=n.get(p.AUDIO),o=n.get(p.VIDEO);i&&t.push(i),o&&t.push(o),this.remoteTracks.delete(e)}return D.debug("".concat(this," removed remote tracks[endpoint=").concat(e,",count=").concat(t.length)),t},P.prototype._removeRemoteTrack=function(e){e.dispose();var t=e.getParticipantId(),n=this.remoteTracks.get(t);n?n.delete(e.getType())||D.error("".concat(this," Failed to remove ").concat(e," - type mapping messed up ?")):D.error("".concat(this," removeRemoteTrack: no remote tracks map for endpoint=").concat(t)),this.eventEmitter.emit(f.a.REMOTE_TRACK_REMOVED,e)},P.prototype._removeRemoteTrackById=function(e,t){var n=this._getRemoteTrackById(e,t);return n&&this._removeRemoteTrack(n),n},P.prototype._extractSSRCMap=function(e){var t=new Map,n=new Map;if("object"!==typeof e||null===e||"string"!==typeof e.sdp)return D.warn("An empty description was passed as an argument"),t;var i=c.a.parse(e.sdp);if(!Array.isArray(i.media))return t;var a=i.media;this._usesUnifiedPlan&&(a=[],[p.AUDIO,p.VIDEO].forEach((function(e){var t=i.media.find((function(t){return t.type===e}));t&&a.push(t)})));var r,s=Object(o.a)(a);try{for(s.s();!(r=s.n()).done;){var l=r.value;if(Array.isArray(l.ssrcs)){if(Array.isArray(l.ssrcGroups)){var u,d=Object(o.a)(l.ssrcGroups);try{for(d.s();!(u=d.n()).done;){var h=u.value;if("undefined"!==typeof h.semantics&&"undefined"!==typeof h.ssrcs){var f=h.ssrcs.split(" ").map((function(e){return parseInt(e,10)})),m=f[0];h.ssrcs=f,n.has(m)||n.set(m,[]),n.get(m).push(h)}}}catch(k){d.e(k)}finally{d.f()}}var v=l.ssrcs;v=this._usesUnifiedPlan?v.filter((function(e){return"cname"===e.attribute})):v.filter((function(e){return"msid"===e.attribute}));var g,b=Object(o.a)(v);try{for(b.s();!(g=b.n()).done;){var y=g.value,A=this._usesUnifiedPlan?l.type:y.value,S=y.id,E=t.get(A);if(E||(E={ssrcs:[],groups:[],msid:A},t.set(A,E)),E.ssrcs.push(S),n.has(S)){var O,C=n.get(S),j=Object(o.a)(C);try{for(j.s();!(O=j.n()).done;){var T=O.value;E.groups.push(T)}}catch(k){j.e(k)}finally{j.f()}}}}catch(k){b.e(k)}finally{b.f()}}}}catch(k){s.e(k)}finally{s.f()}return t};var N=function(e){if("object"!==typeof e||null===e||"string"!==typeof e.sdp)return D.warn("An empty description was passed as an argument"),e;var t=n(79),o=t.parse(e.sdp);"undefined"!==typeof o&&"undefined"!==typeof o.media&&Array.isArray(o.media)&&o.media.forEach((function(e){var t=[],n=[];if("undefined"!==typeof e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&e.ssrcGroups.forEach((function(e){"undefined"!==typeof e.semantics&&"FID"===e.semantics&&"undefined"!==typeof e.ssrcs&&t.push(Number(e.ssrcs.split(" ")[0]))})),Array.isArray(e.ssrcs)){var o;for(o=0;o<e.ssrcs.length;o++)"object"===typeof e.ssrcs[o]&&"undefined"!==typeof e.ssrcs[o].id&&t.indexOf(e.ssrcs[o].id)>=0&&(n.push(e.ssrcs[o]),delete e.ssrcs[o]);for(o=0;o<e.ssrcs.length;o++)"undefined"!==typeof e.ssrcs[o]&&n.push(e.ssrcs[o]);e.ssrcs=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!y.a.isChrome()||!y.a.isVersionGreaterThan(70))return e;var t=Object(i.a)(e);return e.filter((function(e){return e.attribute==="mslabel"&&e.value==="-"})).map((function(e){return e.id})).forEach((function(e){var n=t.find((function(t){return t.id===e&&"cname"===t.attribute}));n.value="".concat(d.a.RECVONLY,"-").concat(e),(t=t.filter((function(t){return t.id!==e}))).push(n)})),t}(n)}}));var a=t.write(o);return new RTCSessionDescription({type:e.type,sdp:a})};P.prototype.getLocalSSRC=function(e){var t=this._getSSRC(e.rtcId);return t&&t.ssrcs[0]},P.prototype._injectSsrcGroupForUnifiedSimulcast=function(e){var t=c.a.parse(e.sdp),n=t.media.find((function(e){return"video"===e.type}));n.ssrcGroups=n.ssrcGroups||[];var i=n.ssrcGroups.filter((function(e){return"FID"===e.semantics}));if(n.simulcast||n.simulcast_03){var o=[];if(i&&i.length?i.forEach((function(e){o.push(e.ssrcs.split(" ")[0])})):n.ssrcs.forEach((function(e){"msid"===e.attribute&&o.push(e.id)})),n.ssrcGroups.find((function(e){return"SIM"===e.semantics})))return e;n.ssrcGroups.push({semantics:"SIM",ssrcs:o.join(" ")})}return new RTCSessionDescription({type:e.type,sdp:c.a.write(t)})};var x={signalingState:function(){return this.peerconnection.signalingState},iceConnectionState:function(){return this.peerconnection.iceConnectionState},connectionState:function(){return this.peerconnection.connectionState},localDescription:function(){var e=this.peerconnection.localDescription;return e?(this.trace("getLocalDescription::preTransform",M(e)),this._usesUnifiedPlan&&!this.isP2P?(e=this.interop.toPlanB(e),this.trace("getLocalDescription::postTransform (Plan B)",M(e)),e=this._injectSsrcGroupForUnifiedSimulcast(e),this.trace("getLocalDescription::postTransform (inject ssrc group)",M(e))):this._usesUnifiedPlan||(y.a.doesVideoMuteByStreamRemove()&&(e=this.localSdpMunger.maybeAddMutedLocalVideoTracksToSDP(e),D.debug("getLocalDescription::postTransform (munge local SDP)",e)),e=function(e,t){if(!e)throw new Error("No local description passed in.");var n=new T.a(e.sdp),i=n.selectMedia(p.AUDIO),o=!1;i&&i.direction!==d.a.SENDRECV&&(t.startSilent?i.direction=d.a.INACTIVE:i.direction=d.a.SENDRECV,o=!0);var a=n.selectMedia(p.VIDEO);return a&&a.direction!==d.a.SENDRECV&&(a.direction=d.a.SENDRECV,o=!0),o?new RTCSessionDescription({type:e.type,sdp:n.toRawSDP()}):e}(e,this.options)),e=this.localSdpMunger.transformStreamIdentifiers(e)):(D.debug("".concat(this," getLocalDescription no localDescription found")),{})},remoteDescription:function(){var e=this.peerconnection.remoteDescription;return e?(this.trace("getRemoteDescription::preTransform",M(e)),this._usesUnifiedPlan&&(this.isP2P?e=this._adjustRemoteMediaDirection(e):(e=this.interop.toPlanB(e),this.trace("getRemoteDescription::postTransform (Plan B)",M(e)))),e):(D.debug("".concat(this," getRemoteDescription no remoteDescription found")),{})}};Object.keys(x).forEach((function(e){Object.defineProperty(P.prototype,e,{get:x[e]})})),P.prototype._getSSRC=function(e){return this.localSSRCs.get(e)},P.prototype.isSharingLowFpsScreen=function(){return this._isSharingScreen()&&this._capScreenshareBitrate},P.prototype._isSharingScreen=function(){var e=this.getLocalVideoTrack();return e&&e.videoType===g.DESKTOP},P.prototype._mungeCodecOrder=function(e){var t=this;if(!this.codecPreference)return e;var n=c.a.parse(e.sdp),i=n.media.find((function(e){return e.type===t.codecPreference.mediaType}));if(!i)return e;if(this.codecPreference.enable)if(C.a.preferCodec(i,this.codecPreference.mimeType),this.codecPreference.mimeType===l.H264&&y.a.isReactNative()&&this.isP2P&&C.a.stripCodec(i,this.codecPreference.mimeType,!0),this.codecPreference.mimeType===l.VP9&&this.getConfiguredVideoCodec()===l.VP9){var o=this.tpcUtils.videoBitrates.VP9||this.tpcUtils.videoBitrates,a=o.high?o.high:w.a,r=Math.floor((this._isSharingScreen()?w.a:a)/1e3);i.bandwidth=[{type:"AS",limit:r}]}else i.bandwidth=void 0;else C.a.stripCodec(i,this.codecPreference.mimeType);return new RTCSessionDescription({type:e.type,sdp:c.a.write(n)})},P.prototype.containsTrack=function(e){if(e.isLocal())return this.localTracks.has(e.rtcId);var t=e.getParticipantId(),n=this.remoteTracks.get(t);return Boolean(n&&n.get(e.getType())===e)},P.prototype.addTrack=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.rtcId;if(D.info("".concat(this," adding ").concat(e)),this.localTracks.has(i))return Promise.reject(new Error("".concat(e," is already in ").concat(this)));this.localTracks.set(i,e);var o=e.getOriginalStream();if(this._usesUnifiedPlan){if(D.debug("".concat(this," TPC.addTrack using unified plan")),o)try{this.tpcUtils.addTrack(e,n)}catch(u){return D.error("".concat(this," Adding track=").concat(e," failed: ").concat(null===u||void 0===u?void 0:u.message)),Promise.reject(u)}}else{if(o)this._addStream(o);else if(!y.a.doesVideoMuteByStreamRemove()||e.isAudioTrack()||e.isVideoTrack()&&!e.isMuted())return Promise.reject(new Error("".concat(this," no WebRTC stream for track=").concat(e)));if(y.a.doesVideoMuteByStreamRemove()&&e.isVideoTrack()&&e.isMuted()){var a=this.generateNewStreamSSRCInfo(e);this.sdpConsistency.setPrimarySsrc(a.ssrcs[0]);var r=a.groups.find((function(e){return"SIM"===e.semantics}));r&&this.simulcast.setSsrcCache(r.ssrcs);var s=a.groups.filter((function(e){return"FID"===e.semantics}));if(s){var c=new Map;s.forEach((function(e){var t=e.ssrcs[0],n=e.ssrcs[1];c.set(t,n)})),this.rtxModifier.setSsrcCache(c)}}}var l=Promise.resolve();return y.a.isFirefox()&&(l=l.then((function(){return o&&t.tpcUtils.setEncodings(e)}))),l},P.prototype.addTrackUnmute=function(e){var t=this;if(D.info("".concat(this," Adding track=").concat(e," as unmute")),!this._assertTrackBelongs("addTrackUnmute",e))return Promise.reject("Track not found on the peerconnection");var n=e.getOriginalStream();return n?this._usesUnifiedPlan?this.tpcUtils.replaceTrack(null,e).then((function(){return t.isP2P})):(this._addStream(n),Promise.resolve(!0)):(D.error("".concat(this," Unable to add track=").concat(e," as unmute - no WebRTC stream")),Promise.reject("Stream not found"))},P.prototype._addStream=function(e){this.peerconnection.addStream(e),this._addedStreams.push(e)},P.prototype._removeStream=function(e){this.peerconnection.removeStream(e),this._addedStreams=this._addedStreams.filter((function(t){return t!==e}))},P.prototype._assertTrackBelongs=function(e,t){var n=this.localTracks.has(null===t||void 0===t?void 0:t.rtcId);return n||D.error("".concat(this," ").concat(e,": track=").concat(t," does not belong to pc")),n},P.prototype.getConfiguredVideoCodec=function(){var e,t=null===(e=this.peerconnection.localDescription)||void 0===e?void 0:e.sdp,n=l.VP8;if(!t)return n;var i=c.a.parse(t).media.find((function(e){return e.type===p.VIDEO})).rtp[0].codec;return i?Object.values(l).find((function(e){return e===i.toLowerCase()})):n},P.prototype.setDesktopSharingFrameRate=function(e){var t=e<=b.a;this._capScreenshareBitrate=this.isSimulcastOn()&&t},P.prototype.setVideoCodecs=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=null===t,i=t||e;this.codecPreference&&(e||t)?(this.codecPreference.enable=n,this.codecPreference.mimeType=i):e||t?this.codecPreference={enable:n,mediaType:p.VIDEO,mimeType:i}:D.warn("".concat(this," Invalid codec settings[preferred=").concat(e,",disabled=").concat(t,"],\n            atleast one value is needed"))},P.prototype.isMediaStreamInPc=function(e){return this._addedStreams.indexOf(e)>-1},P.prototype.removeTrack=function(e){var t=e.getOriginalStream();this.trace("removeStream",e.rtcId,t?t.id:void 0),this._assertTrackBelongs("removeStream",e)&&(this.localTracks.delete(e.rtcId),this.localSSRCs.delete(e.rtcId),t&&this.peerconnection.removeStream(t))},P.prototype.findSenderByKind=function(e){return this.peerconnection.getSenders().find((function(t){return t.track&&t.track.kind===e}))},P.prototype.findReceiverForTrack=function(e){return this.peerconnection.getReceivers().find((function(t){return t.track===e}))},P.prototype.findSenderForTrack=function(e){return this.peerconnection.getSenders().find((function(t){return t.track===e}))},P.prototype.replaceTrack=function(e,t){var n=this;if(!e&&!t)return D.info("".concat(this," replaceTrack called with no new track and no old track")),Promise.resolve();var i=Boolean(!e||!this.localTracks.has(null===e||void 0===e?void 0:e.rtcId));if(this._usesUnifiedPlan){var o;D.debug("".concat(this," TPC.replaceTrack using unified plan"));var a=null!==(o=null===t||void 0===t?void 0:t.getType())&&void 0!==o?o:null===e||void 0===e?void 0:e.getType(),r=null===t||void 0===t?void 0:t.getOriginalStream(),s=t&&!r?Promise.resolve():this.tpcUtils.replaceTrack(e,t),c=this.tpcUtils.findTransceiver(a,e);return s.then((function(){return e&&n.localTracks.delete(e.rtcId),t&&n.localTracks.set(t.rtcId,t),c&&(c.direction=t?d.a.SENDRECV:d.a.RECVONLY),(y.a.usesSdpMungingForSimulcast()||!t?Promise.resolve():n.tpcUtils.setEncodings(t)).then((function(){return n.isP2P||i}))}))}D.debug("".concat(this," TPC.replaceTrack using plan B"));var l=Promise.resolve();return e&&this.removeTrack(e),t&&(l=this.addTrack(t)),l.then((function(){return!0}))},P.prototype.removeTrackMute=function(e){var t=e.getOriginalStream();return this.trace("removeStreamMute",e.rtcId,t?t.id:null),this._assertTrackBelongs("removeStreamMute",e)?this._usesUnifiedPlan?this.tpcUtils.replaceTrack(e,null):t?(D.info("".concat(this," Removing track=").concat(e," as mute")),this._removeStream(t),Promise.resolve(!0)):(D.error("".concat(this," removeStreamMute - no WebRTC stream for track=").concat(e)),Promise.reject("Stream not found")):Promise.reject("Track not found in the peerconnection")},P.prototype.createDataChannel=function(e,t){return this.trace("createDataChannel",e,t),this.peerconnection.createDataChannel(e,t)},P.prototype._ensureSimulcastGroupIsLast=function(e){var t=e.sdp,n=t.indexOf("m=video"),i=t.indexOf("a=ssrc-group:SIM",n),o=t.lastIndexOf("a=ssrc-group");if(-1===i||-1===o||o===i)return e;var a=t.indexOf("\r\n",i),r=t.substring(i,a+2);o=(t=t.replace(r,"")).lastIndexOf("a=ssrc-group");var s=t.indexOf("\r\n",o),c=t.slice(0,s),l=r.trim(),u=t.slice(s);return t="".concat(c,"\r\n").concat(l).concat(u),new RTCSessionDescription({type:e.type,sdp:t})},P.prototype._adjustLocalMediaDirection=function(e){var t=new T.a(e.sdp),n=!1,i=t.selectMedia(p.AUDIO);if(i){var o=this.getDesiredMediaDirection(p.AUDIO);i.direction!==o&&(i.direction=o,D.info("".concat(this," Adjusted local audio direction to ").concat(o)),n=!0)}else D.warn("".concat(this,' No "audio" media found in the local description'));var a=t.selectMedia(p.VIDEO);if(a){var r=this.getDesiredMediaDirection(p.VIDEO);a.direction!==r&&(a.direction=r,D.info("".concat(this," Adjusted local video direction to ").concat(r)),n=!0)}else D.warn("".concat(this,' No "video" media found in the local description'));return n?new RTCSessionDescription({type:e.type,sdp:t.toRawSDP()}):e},P.prototype._adjustRemoteMediaDirection=function(e){var t=this,n=new T.a(e.sdp);return[p.AUDIO,p.VIDEO].forEach((function(e){var i=n.selectMedia(e),o=t.hasAnyTracksOfType(e),a=t.getRemoteTracks(null,e).length>0;i.direction=o&&a?d.a.SENDRECV:o?d.a.RECVONLY:a?d.a.SENDONLY:d.a.INACTIVE})),new RTCSessionDescription({type:e.type,sdp:n.toRawSDP()})},P.prototype._mungeOpus=function(e){var t=this.options.audioQuality;if((null===t||void 0===t||!t.stereo)&&(null===t||void 0===t||!t.opusMaxAverageBitrate))return e;var n,i=c.a.parse(e.sdp),a=i.media,r=Object(o.a)(a);try{for(r.s();!(n=r.n()).done;){var s=n.value;if("audio"===s.type)if("continue"===function(){var e=s.rtp.find((function(e){return e.codec===l.OPUS})).payload;if(!e)return"continue";var n=s.fmtp.find((function(t){return t.payload===e}));n||(n={payload:e,config:""});var i=c.a.parseParams(n.config),o=!1;if(null!==t&&void 0!==t&&t.stereo&&(i.stereo=1,o=!0),null!==t&&void 0!==t&&t.opusMaxAverageBitrate&&(i.maxaveragebitrate=t.opusMaxAverageBitrate,o=!0),!o)return"continue";for(var a="",r=0,u=Object.keys(i);r<u.length;r++){var d=u[r];a+="".concat(d,"=").concat(i[d],"; ")}n.config=a.trim()}())continue}}catch(u){r.e(u)}finally{r.f()}return new RTCSessionDescription({type:e.type,sdp:c.a.write(i)})},P.prototype.configureSenderVideoEncodings=function(){return this.setSenderVideoConstraints(this._senderVideoMaxHeight)},P.prototype.setLocalDescription=function(e){var t=this,n=e;return this.trace("setLocalDescription::preTransform",M(n)),n=this._mungeOpus(n),this._usesUnifiedPlan?this.isP2P||(n=this.interop.toUnifiedPlan(n),this.trace("setLocalDescription::postTransform (Unified Plan)",M(n))):(n=this._adjustLocalMediaDirection(n),n=this._ensureSimulcastGroupIsLast(n)),this._usesTransceiverCodecPreferences||(n=this._mungeCodecOrder(n)),new Promise((function(e,i){t.peerconnection.setLocalDescription(n).then((function(){t.trace("setLocalDescriptionOnSuccess");var i=C.a.getUfrag(n.sdp);i!==t.localUfrag&&(t.localUfrag=i,t.eventEmitter.emit(f.a.LOCAL_UFRAG_CHANGED,t,i)),e()}),(function(e){t.trace("setLocalDescriptionOnFailure",e),t.eventEmitter.emit(f.a.SET_LOCAL_DESCRIPTION_FAILED,e,t),i(e)}))}))},P.prototype.setAudioTransferActive=function(e){D.debug("".concat(this," audio transfer active: ").concat(e));var t=this.audioTransferActive!==e;return this.audioTransferActive=e,this._usesUnifiedPlan?(this.tpcUtils.setAudioTransferActive(e),!1):t},P.prototype.setRemoteDescription=function(e){var t=this;if(this.trace("setRemoteDescription::preTransform",M(e)),e=this._mungeOpus(e),this._usesUnifiedPlan){if(!this.isP2P){var n=this.peerconnection.remoteDescription;e=this.interop.toUnifiedPlan(e,n),this.trace("setRemoteDescription::postTransform (Unified)",M(e)),this.isSimulcastOn()&&(e=this.simulcast.mungeRemoteDescription(e),e=this.tpcUtils.insertUnifiedPlanSimulcastReceive(e),this.trace("setRemoteDescription::postTransform (sim receive)",M(e)))}}else this.isSimulcastOn()&&(e=this.simulcast.mungeRemoteDescription(e,!0),this.trace("setRemoteDescription::postTransform (simulcast)",M(e))),e=N(e);return e=this._mungeCodecOrder(e),this._usesUnifiedPlan&&(e=this.tpcUtils.ensureCorrectOrderOfSsrcs(e)),new Promise((function(n,i){t.peerconnection.setRemoteDescription(e).then((function(){t.trace("setRemoteDescriptionOnSuccess");var i=C.a.getUfrag(e.sdp);i!==t.remoteUfrag&&(t.remoteUfrag=i,t.eventEmitter.emit(f.a.REMOTE_UFRAG_CHANGED,t,i)),n()}),(function(e){t.trace("setRemoteDescriptionOnFailure",e),t.eventEmitter.emit(f.a.SET_REMOTE_DESCRIPTION_FAILED,e,t),i(e)}))}))},P.prototype.setSenderVideoConstraints=function(e){var t,n=this;if(e<0)throw new Error("Invalid frameHeight: ".concat(e));if(y.a.isReactNative())return Promise.resolve();this._senderVideoMaxHeight=e;var i=this.getLocalVideoTrack();if(!i||i.isMuted())return Promise.resolve();var o=this.findSenderByKind(p.VIDEO);if(!o)return Promise.resolve();var a=o.getParameters();if(null===a||void 0===a||null===(t=a.encodings)||void 0===t||!t.length)return Promise.resolve();var r=this.isSharingLowFpsScreen()?"maintain-resolution":"maintain-framerate";a.degradationPreference=r,D.info("".concat(this," Setting degradation preference [preference=").concat(r,",track=").concat(i)),this.encodingsEnabledState=this.tpcUtils.calculateEncodingsActiveState(i,e);var s=this.tpcUtils.calculateEncodingsBitrates(i),c=i.getVideoType();if(this.isSimulcastOn()){for(var u in a.encodings){var d,h;if(a.encodings.hasOwnProperty(u))a.encodings[u].active=this.encodingsEnabledState[u],y.a.isFirefox()&&(a.encodings[u].degradationPreference=r),this.getConfiguredVideoCodec()===l.VP8&&(null!==(d=this.options)&&void 0!==d&&null!==(h=d.videoQuality)&&void 0!==h&&h.maxBitratesVideo||this.isSharingLowFpsScreen()||this._usesUnifiedPlan)&&(a.encodings[u].maxBitrate=s[u])}this.tpcUtils.updateEncodingsResolution(a)}else if(e>0){var m,v,b=w.b;if(c===g.CAMERA&&i.resolution>e&&(b=Math.floor(i.resolution/e)),a.encodings[0].active=!0,a.encodings[0].scaleResolutionDownBy=b,y.a.isFirefox()&&(a.encodings[0].degradationPreference=r),this.getConfiguredVideoCodec()===l.VP8&&null!==(m=this.options)&&void 0!==m&&null!==(v=m.videoQuality)&&void 0!==v&&v.maxBitratesVideo){var A,S,E,O=null===(A=this.getTargetVideoBitrates())||void 0===A?void 0:A.high;if(c===g.CAMERA)O=null!==(S=null===(E=this.tpcUtils.localStreamEncodingsConfig.find((function(e){return e.scaleResolutionDownBy===b})))||void 0===E?void 0:E.maxBitrate)&&void 0!==S?S:O;a.encodings[0].maxBitrate=O}}else a.encodings[0].active=!1;return D.info("".concat(this," setting max height=").concat(e,",encodings=").concat(JSON.stringify(a.encodings))),o.setParameters(a).then((function(){i.maxEnabledResolution=e,n.eventEmitter.emit(f.a.LOCAL_TRACK_MAX_ENABLED_RESOLUTION_CHANGED,i)}))},P.prototype.setVideoTransferActive=function(e){D.debug("".concat(this," video transfer active: ").concat(e));var t=this.videoTransferActive!==e;return this.videoTransferActive=e,this._usesUnifiedPlan?(this.tpcUtils.setVideoTransferActive(e),!1):t},P.prototype.sendTones=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200;if(!this._dtmfSender){if(this.peerconnection.getSenders){var i=this.peerconnection.getSenders().find((function(e){return e.dtmf}));this._dtmfSender=i&&i.dtmf,this._dtmfSender&&D.info("".concat(this," initialized DTMFSender using getSenders"))}if(!this._dtmfSender){var o=Array.from(this.localTracks.values()).find((function(e){return e.isAudioTrack()}));this.peerconnection.createDTMFSender&&o&&(this._dtmfSender=this.peerconnection.createDTMFSender(o.getTrack())),this._dtmfSender&&D.info("".concat(this," initialized DTMFSender using deprecated createDTMFSender"))}this._dtmfSender&&(this._dtmfSender.ontonechange=this._onToneChange.bind(this))}if(this._dtmfSender){if(this._dtmfSender.toneBuffer)return void this._dtmfTonesQueue.push({tones:e,duration:t,interToneGap:n});this._dtmfSender.insertDTMF(e,t,n)}else D.warn("".concat(this," sendTones - failed to select DTMFSender"))},P.prototype._onToneChange=function(e){if(this._dtmfSender&&""===e.tone&&this._dtmfTonesQueue.length){var t=this._dtmfTonesQueue.shift(),n=t.tones,i=t.duration,o=t.interToneGap;this._dtmfSender.insertDTMF(n,i,o)}},P.prototype.generateRecvonlySsrc=function(){var e=C.a.generateSsrc();D.info("".concat(this," generated new recvonly SSRC=").concat(e)),this.sdpConsistency.setPrimarySsrc(e)},P.prototype.clearRecvonlySsrc=function(){D.info("".concat(this," Clearing primary video SSRC!")),this.sdpConsistency.clearVideoSsrcCache()},P.prototype.close=function(){this.trace("stop"),this.signalingLayer.off(m.a,this._peerMutedChanged),this.signalingLayer.off(m.b,this._peerVideoTypeChanged),this._usesUnifiedPlan&&this.peerconnection.removeEventListener("track",this.onTrack);var e,t=Object(o.a)(this.remoteTracks.values());try{for(t.s();!(e=t.n()).done;){var n,i=e.value,a=Object(o.a)(i.values());try{for(a.s();!(n=a.n()).done;){var r=n.value;this._removeRemoteTrack(r)}}catch(s){a.e(s)}finally{a.f()}}}catch(s){t.e(s)}finally{t.f()}this.remoteTracks.clear(),this._addedStreams=[],this._dtmfSender=null,this._dtmfTonesQueue=[],this.rtc._removePeerConnection(this)||D.error("".concat(this," RTC._removePeerConnection returned false")),null!==this.statsinterval&&(window.clearInterval(this.statsinterval),this.statsinterval=null),D.info("".concat(this," Closing peerconnection")),this.peerconnection.close()},P.prototype.createAnswer=function(e){return this._createOfferOrAnswer(!1,e)},P.prototype.createOffer=function(e){return this._createOfferOrAnswer(!0,e)},P.prototype._createOfferOrAnswer=function(e,t){var n=this,i=e?"Offer":"Answer";this.trace("create".concat(i),JSON.stringify(t,null," "));if(this._usesTransceiverCodecPreferences){var o=this.peerconnection.getTransceivers().find((function(e){var t,n;return e.receiver&&(null===(t=e.receiver)||void 0===t||null===(n=t.track)||void 0===n?void 0:n.kind)===p.VIDEO}));if(o){var a,r,s,c=null===(a=RTCRtpReceiver.getCapabilities(p.VIDEO))||void 0===a?void 0:a.codecs,u=null===(r=this.codecPreference)||void 0===r?void 0:r.mimeType,d=null===(s=this.codecPreference)||void 0===s?void 0:s.enable;c&&u&&d?c.sort((function(e){return e.mimeType.toLowerCase()==="".concat(p.VIDEO,"/").concat(u)?-1:1})):c&&u&&(c=c.filter((function(e){return e.mimeType.toLowerCase()!=="".concat(p.VIDEO,"/").concat(u)}))),y.a.isChromiumBased()&&y.a.isVersionEqualTo("96")&&(c=c.filter((function(e){return e.mimeType.toLowerCase()!=="".concat(p.VIDEO,"/").concat(l.ULPFEC)})));try{o.setCodecPreferences(c)}catch(h){D.warn("".concat(this," Setting codec[preference=").concat(u,",enable=").concat(d,"] failed"),h)}}}return new Promise((function(o,a){(e?n.peerconnection.createOffer(t):n.peerconnection.createAnswer(t)).then((function(e){return function(e,t,o){try{n.trace("create".concat(i,"OnSuccess::preTransform"),M(e)),n._usesUnifiedPlan||(n.hasAnyTracksOfType(p.VIDEO)||n.sdpConsistency.hasPrimarySsrcCached()||n.generateRecvonlySsrc(),e=new RTCSessionDescription({type:e.type,sdp:n.sdpConsistency.makeVideoPrimarySsrcsConsistent(e.sdp)}),n.trace("create".concat(i,"OnSuccess::postTransform ")+"(make primary audio/video ssrcs consistent)",M(e)));var a=n.getLocalVideoTrack();n.isSimulcastOn()&&y.a.usesSdpMungingForSimulcast()&&((null===a||void 0===a?void 0:a.getVideoType())===g.CAMERA||n._usesUnifiedPlan||!n.isSharingLowFpsScreen())&&(e=n.simulcast.mungeLocalDescription(e),n.trace("create".concat(i)+"OnSuccess::postTransform (simulcast)",M(e))),!n.options.disableRtx&&y.a.usesSdpMungingForSimulcast()&&(e=new RTCSessionDescription({type:e.type,sdp:n.rtxModifier.modifyRtxSsrcs(e.sdp)}),n.trace("create".concat(i)+"OnSuccess::postTransform (rtx modifier)",M(e)));var r=n._extractSSRCMap(e);n._processLocalSSRCsMap(r),t(e)}catch(s){n.trace("create".concat(i,"OnError"),s),n.trace("create".concat(i,"OnError"),M(e)),D.error("".concat(n," create").concat(i,"OnError"),s,M(e)),o(s)}}(e,o,a)}),(function(t){return function(t,o){n.trace("create".concat(i,"OnFailure"),t);var a=e?f.a.CREATE_OFFER_FAILED:f.a.CREATE_ANSWER_FAILED;n.eventEmitter.emit(a,t,n),o(t)}(t,a)}))}))},P.prototype._extractPrimarySSRC=function(e){return e&&e.groups&&e.groups.length?e.groups[0].ssrcs[0]:e&&e.ssrcs&&e.ssrcs.length?e.ssrcs[0]:null},P.prototype._processLocalSSRCsMap=function(e){var t,n=Object(o.a)(this.localTracks.values());try{for(n.s();!(t=n.n()).done;){var i=t.value,a=this._usesUnifiedPlan?i.getType():i.storedMSID;if(e.has(a)){var r=e.get(a);if(!r)return void D.error("".concat(this," No SSRC found for stream=").concat(a));var s=this.localSSRCs.get(i.rtcId),c=this._extractPrimarySSRC(r),l=this._extractPrimarySSRC(s);c!==l&&(l&&D.error("".concat(this," Overwriting SSRC for track=").concat(i,"] with ssrc=").concat(r)),this.localSSRCs.set(i.rtcId,r),this.eventEmitter.emit(f.a.LOCAL_TRACK_SSRC_UPDATED,i,c))}else i.isVideoTrack()||i.isMuted()||D.warn("".concat(this," No SSRCs found in the local SDP for track=").concat(i,", stream=").concat(a))}}catch(u){n.e(u)}finally{n.f()}},P.prototype.addIceCandidate=function(e){return this.trace("addIceCandidate",JSON.stringify({candidate:e.candidate,sdpMid:e.sdpMid,sdpMLineIndex:e.sdpMLineIndex,usernameFragment:e.usernameFragment},null," ")),this.peerconnection.addIceCandidate(e)},P.prototype.getActiveSimulcastStreams=function(){var e,t=1;this.isSimulcastOn()&&this.encodingsEnabledState?t=null===(e=this.encodingsEnabledState.filter((function(e){return Boolean(e)})))||void 0===e?void 0:e.length:this.isSimulcastOn()&&(t=w.c.length);return t},P.prototype.getStats=function(){return this.peerconnection.getStats()},P.prototype.generateNewStreamSSRCInfo=function(e){var t=e.rtcId,n=this._getSSRC(t);if(n&&D.error("".concat(this," Overwriting local SSRCs for track id=").concat(t)),!this.isSimulcastOn()||e.getVideoType()!==g.CAMERA&&this.isSharingLowFpsScreen())n={ssrcs:[C.a.generateSsrc()],groups:[]};else{n={ssrcs:[],groups:[]};for(var i=0;i<w.c.length;i++)n.ssrcs.push(C.a.generateSsrc());n.groups.push({ssrcs:n.ssrcs.slice(),semantics:"SIM"})}if(!this.options.disableRtx)for(var o=n.ssrcs.length,a=0;a<o;++a){var r=n.ssrcs[a],s=C.a.generateSsrc();n.ssrcs.push(s),n.groups.push({ssrcs:[r,s],semantics:"FID"})}return n.msid=e.storedMSID,this.localSSRCs.set(t,n),n},P.prototype.usesUnifiedPlan=function(){return this._usesUnifiedPlan},P.prototype.toString=function(){return"TPC[id=".concat(this.id,",type=").concat(this.isP2P?"P2P":"JVB","]")}}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return g}));var i=n(58),o=n(14),a=n(6),r=n(8),s=n(22),c=n(39),l=n.n(c),u=n(20),d=n(117),p=n(45),h=n.n(p),f=n(73),m=n(99),v=Object(s.getLogger)(e),g=function(){function e(t,n){Object(a.a)(this,e),this.tpc=t,this.localEndpointId=n}return Object(r.a)(e,[{key:"_addMutedLocalVideoTracksToSDP",value:function(e){var t=this.tpc.getLocalTracks(u.VIDEO);if(!t.length)return!1;1!==t.length&&v.error("".concat(this.tpc," there is more than 1 video track ! ")+"Strange things may happen !",t);var n=e.selectMedia("video");if(!n)return v.debug("".concat(this.tpc," unable to hack local video track SDP")+'- no "video" media'),!1;var i,a=!1,r=Object(o.a)(t);try{for(r.s();!(i=r.n()).done;){var s=i.value,c=s.isMuted(),d=s.getOriginalStream(),p=s.videoType===h.a.CAMERA,f=d&&this.tpc.isMediaStreamInPc(d);if(p&&(c||!f)){var m=this.tpc.isSimulcastOn()?this.tpc.simulcast.ssrcCache:[this.tpc.sdpConsistency.cachedPrimarySsrc];if(m.length){a=!0,n.direction=l.a.SENDRECV;var g,b=m[0],y="injected-".concat(b),A=Object(o.a)(m);try{for(A.s();!(g=A.n()).done;){var S=g.value;n.removeSSRC(S),n.addSSRCAttribute({id:S,attribute:"cname",value:y}),n.addSSRCAttribute({id:S,attribute:"msid",value:s.storedMSID})}}catch(O){A.e(O)}finally{A.f()}if(m.length>1){var E={ssrcs:m.join(" "),semantics:"SIM"};n.findGroup(E.semantics,E.ssrcs)||n.addSSRCGroup(E)}this.tpc.options.disableRtx||this.tpc.rtxModifier.modifyRtxSsrcs2(n)}else v.error("No SSRCs stored for: ".concat(s," in ").concat(this.tpc))}}}catch(O){r.e(O)}finally{r.f()}return a}},{key:"_generateMsidAttribute",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e||!t)return v.warn("Unable to munge local MSID - track id=".concat(t," or media type=").concat(e," is missing")),null;var i=this.tpc.id;return"-"!==n&&n?"".concat(n,"-").concat(i," ").concat(t,"-").concat(i):"".concat(this.localEndpointId,"-").concat(e,"-").concat(i," ").concat(t,"-").concat(i)}},{key:"_transformMediaIdentifiers",value:function(e){var t,n,a=this,r=this.tpc.id,s=Object(o.a)(e.ssrcs);try{for(s.s();!(n=s.n()).done;){var c=n.value;switch(c.attribute){case"cname":case"label":case"mslabel":c.value=c.value&&"".concat(c.value,"-").concat(r);break;case"msid":if(c.value){var u,d=c.value.split(" ");if(2===d.length)c.value=this._generateMsidAttribute(null===(u=e.mLine)||void 0===u?void 0:u.type,d[1],d[0]);else v.warn("Unable to munge local MSID - weird format detected: ".concat(c.value))}}}}catch(O){s.e(O)}finally{s.f()}if(this.tpc.usesUnifiedPlan()){var p=null===(t=e.mLine)||void 0===t?void 0:t.direction;if(p===l.a.RECVONLY||p===l.a.INACTIVE)e.ssrcs=void 0,e.ssrcGroups=void 0;else{var h,f,m,g,b=null===(h=e.mLine)||void 0===h?void 0:h.msid,y=b&&b.split(" ")[1],A=Object(i.a)(new Set(null===(f=e.mLine)||void 0===f||null===(m=f.ssrcs)||void 0===m?void 0:m.map((function(e){return e.id})))),S=Object(o.a)(A);try{var E=function(){var t=g.value;if(!e.ssrcs.find((function(e){return e.id===t&&"msid"===e.attribute}))){var n,i=a._generateMsidAttribute(null===(n=e.mLine)||void 0===n?void 0:n.type,y);e.ssrcs.push({id:t,attribute:"msid",value:i})}};for(S.s();!(g=S.n()).done;)E()}catch(O){S.e(O)}finally{S.f()}}}}},{key:"maybeAddMutedLocalVideoTracksToSDP",value:function(e){if(!e)throw new Error("No local description passed in.");var t=new m.a(e.sdp);return this._addMutedLocalVideoTracksToSDP(t)?new RTCSessionDescription({type:e.type,sdp:t.toRawSDP()}):e}},{key:"transformStreamIdentifiers",value:function(e){if(!e||!e.sdp||!e.type)return e;var t=new m.a(e.sdp),n=t.selectMedia("audio");n&&(this._transformMediaIdentifiers(n),this._injectSourceNames(n));var i=t.selectMedia("video");return i&&(this._transformMediaIdentifiers(i),this._injectSourceNames(i)),new RTCSessionDescription({type:e.type,sdp:t.toRawSDP()})}},{key:"_injectSourceNames",value:function(e){var t,n,a,r=this;if(f.a.isSourceNameSignalingEnabled()){var s=Object(i.a)(new Set(null===(t=e.mLine)||void 0===t||null===(n=t.ssrcs)||void 0===n?void 0:n.map((function(e){return e.id})))),c=null===(a=e.mLine)||void 0===a?void 0:a.type;if(!c)throw new Error("_transformMediaIdentifiers - no media type in mediaSection");var l,u=Object(o.a)(s);try{var p=function(){var t=l.value;e.ssrcs.find((function(e){return e.id===t&&"name"===e.attribute}))||e.ssrcs.push({id:t,attribute:"name",value:Object(d.c)(r.localEndpointId,c,0)})};for(u.s();!(l=u.n()).done;)p()}catch(h){u.e(h)}finally{u.f()}}}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return d}));var i=n(14),o=n(6),a=n(8),r=n(22),s=n(32),c=n(99),l=Object(r.getLogger)(e);function u(e,t,n){var i=t.id,o=t.msid,a=t.cname,r=e.getRtxSSRC(i);r!==n&&(r&&(e.removeSSRC(r),e.removeGroupsWithSSRC(r)),e.addSSRCAttribute({id:n,attribute:"cname",value:a}),e.addSSRCAttribute({id:n,attribute:"msid",value:o}),e.addSSRCGroup({semantics:"FID",ssrcs:"".concat(i," ").concat(n)}))}var d=function(){function e(){Object(o.a)(this,e),this.correspondingRtxSsrcs=new Map}return Object(a.a)(e,[{key:"clearSsrcCache",value:function(){this.correspondingRtxSsrcs.clear()}},{key:"setSsrcCache",value:function(e){l.debug("Setting ssrc cache to ",e),this.correspondingRtxSsrcs=e}},{key:"modifyRtxSsrcs",value:function(e){var t=new c.a(e),n=t.selectMedia("video");return n?this.modifyRtxSsrcs2(n)?t.toRawSDP():e:(l.debug("No 'video' media found in the sdp: ".concat(e)),e)}},{key:"modifyRtxSsrcs2",value:function(e){if("recvonly"===e.direction)return!1;if(e.getSSRCCount()<1)return!1;var t,n=e.getPrimaryVideoSSRCs(),o=Object(i.a)(n);try{for(o.s();!(t=o.n()).done;){var a=t.value,r=e.getSSRCAttrValue(a,"msid"),c=e.getSSRCAttrValue(a,"cname"),l=this.correspondingRtxSsrcs.get(a);if(!l){var d=e.getRtxSSRC(a);l=d||s.a.generateSsrc(),this.correspondingRtxSsrcs.set(a,l)}u(e,{id:a,cname:c,msid:r},l)}}catch(p){o.e(p)}finally{o.f()}return!0}},{key:"stripRtx",value:function(e){var t=new c.a(e),n=t.selectMedia("video");if(!n)return l.debug("No 'video' media found in the sdp: ".concat(e)),e;if("recvonly"===n.direction)return l.debug("RtxModifier doing nothing, video m line is recvonly"),e;if(n.getSSRCCount()<1)return l.debug("RtxModifier doing nothing, no video ssrcs present"),e;if(!n.containsAnySSRCGroups())return l.debug("RtxModifier doing nothing, no video ssrcGroups present"),e;var o=n.findGroups("FID");n.removeGroupsBySemantics("FID");var a,r=Object(i.a)(o);try{for(r.s();!(a=r.n()).done;){var s=a.value,u=Object(c.c)(s);n.removeSSRC(u)}}catch(d){r.e(d)}finally{r.f()}return t.toRawSDP()}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var i=n(14),o=n(6),a=n(8),r=n(22),s=n(99),c=Object(r.getLogger)(e),l=function(){function e(t){Object(o.a)(this,e),this.clearVideoSsrcCache(),this.logPrefix=t}return Object(a.a)(e,[{key:"clearVideoSsrcCache",value:function(){this.cachedPrimarySsrc=null,this.injectRecvOnly=!1}},{key:"setPrimarySsrc",value:function(e){if("number"!==typeof e)throw new Error("Primary SSRC must be a number!");this.cachedPrimarySsrc=e}},{key:"hasPrimarySsrcCached",value:function(){return Boolean(this.cachedPrimarySsrc)}},{key:"makeVideoPrimarySsrcsConsistent",value:function(e){var t=new s.a(e),n=t.selectMedia("video");if(!n)return c.debug("".concat(this.logPrefix," no 'video' media found in the sdp: ").concat(e)),e;if("recvonly"===n.direction)this.cachedPrimarySsrc&&this.injectRecvOnly?n.addSSRCAttribute({id:this.cachedPrimarySsrc,attribute:"cname",value:"recvonly-".concat(this.cachedPrimarySsrc)}):c.info("".concat(this.logPrefix," no SSRC found for the recvonly video stream!"));else{var o=n.getPrimaryVideoSsrc();if(!o)return c.info("".concat(this.logPrefix," sdp-consistency couldn't parse new primary ssrc")),e;if(this.cachedPrimarySsrc){n.replaceSSRC(o,this.cachedPrimarySsrc);var a,r=Object(i.a)(n.ssrcGroups);try{for(r.s();!(a=r.n()).done;){var l=a.value;if("FID"===l.semantics){var u=Object(s.b)(l),d=Object(s.c)(l);u===o&&(l.ssrcs="".concat(this.cachedPrimarySsrc," ").concat(d))}}}catch(p){r.e(p)}finally{r.f()}}else this.cachedPrimarySsrc=o;this.injectRecvOnly=!0}return t.toRawSDP()}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return g}));var i=n(6),o=n(8),a=n(25),r=n(34),s=n(33),c=n(63),l=n(35),u=n(28),d=n(231),p=n(22).getLogger(e),h=n(31),f=!1,m=!1,v=["abort","canplaythrough","ended","error"],g=function(e){Object(r.a)(n,e);var t=Object(s.a)(n);function n(e,o,r,s,c,l,u,d,h,f,m){var g;if(Object(i.a)(this,n),(g=t.call(this,o,s,c,(function(){}),l,u)).rtc=e,"number"!==typeof d)throw new TypeError("SSRC ".concat(d," is not a number"));return g.ssrc=d,g.ownerEndpointId=r,g.muted=h,g.isP2P=f,g._sourceName=m,p.debug("New remote track added: ".concat(Object(a.a)(g))),g.hasBeenMuted=h,g.rtc&&g.track&&g._bindTrackHandlers(),g._containerHandlers={},v.forEach((function(e){g._containerHandlers[e]=g._containerEventHandler.bind(Object(a.a)(g),e)})),g}return Object(o.a)(n,[{key:"_bindTrackHandlers",value:function(){var e=this;this.track.addEventListener("mute",(function(){return e._onTrackMute()})),this.track.addEventListener("unmute",(function(){return e._onTrackUnmute()})),this.track.addEventListener("ended",(function(){p.debug('"onended" event('.concat(Date.now(),"): ").concat(e))}))}},{key:"_onTrackMute",value:function(){p.debug('"onmute" event('.concat(Date.now(),"): ").concat(this)),this.rtc.eventEmitter.emit(h.REMOTE_TRACK_MUTE,this)}},{key:"_onTrackUnmute",value:function(){p.debug('"onunmute" event('.concat(Date.now(),"): ").concat(this)),this.rtc.eventEmitter.emit(h.REMOTE_TRACK_UNMUTE,this)}},{key:"setMute",value:function(e){this.muted!==e&&(e&&(this.hasBeenMuted=!0),this.stream&&(this.stream.muted=e),this.muted=e,this.emit(c.TRACK_MUTE_CHANGED,this))}},{key:"isMuted",value:function(){return this.muted}},{key:"getParticipantId",value:function(){return this.ownerEndpointId}},{key:"isLocal",value:function(){return!1}},{key:"getSSRC",value:function(){return this.ssrc}},{key:"getSourceName",value:function(){return this._sourceName}},{key:"_setVideoType",value:function(e){this.videoType!==e&&(this.videoType=e,this.emit(c.TRACK_VIDEOTYPE_CHANGED,e))}},{key:"_playCallback",value:function(){var e=this.isVideoTrack()?"video":"audio",t=window.performance.now();console.log("(TIME) Render ".concat(e,":\t"),t),this.conference.getConnectionTimes()["".concat(e,".render")]=t;var n=window.connectionTimes["obtainPermissions.start"],i=window.connectionTimes["obtainPermissions.end"],o=isNaN(i)||isNaN(n)?0:i-n,a=t-(this.conference.getConnectionTimes()["session.initiate"]-this.conference.getConnectionTimes()["muc.joined"])-o;this.conference.getConnectionTimes()["".concat(e,".ttfm")]=a,console.log("(TIME) TTFM ".concat(e,":\t"),a),u.a.sendAnalytics(Object(l.N)({media_type:e,muted:this.hasBeenMuted,value:a}))}},{key:"_attachTTFMTracker",value:function(e){f&&this.isAudioTrack()||m&&this.isVideoTrack()||(this.isAudioTrack()&&(f=!0),this.isVideoTrack()&&(m=!0),e.addEventListener("canplay",this._playCallback.bind(this)))}},{key:"_onTrackAttach",value:function(e){var t=this;v.forEach((function(n){e.addEventListener(n,t._containerHandlers[n])}))}},{key:"_onTrackDetach",value:function(e){var t=this;v.forEach((function(n){e.removeEventListener(n,t._containerHandlers[n])}))}},{key:"_containerEventHandler",value:function(e){p.debug("".concat(e," handler was called for a container with attached ").concat(this))}},{key:"_getStatus",value:function(){var e=this.track,t=e.enabled,n=e.muted,i=e.readyState;return"readyState: ".concat(i,", muted: ").concat(n,", enabled: ").concat(t)}},{key:"toString",value:function(){return"RemoteTrack[userID: ".concat(this.getParticipantId(),", type: ").concat(this.getType(),", ssrc: ").concat(this.getSSRC(),", p2p: ").concat(this.isP2P,", sourceName: ").concat(this._sourceName,", status: ").concat(this._getStatus(),"]")}}]),n}(d.a)}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return y}));var i=n(6),o=n(8),a=n(22),r=n(12),s=n(68),c=n.n(s),l=n(31),u=n(104),d=n(21),p=n(232),h=n(45),f=n(11),m=Object(a.getLogger)(e),v=[{width:1920,height:1080,layers:3,target:"high",targetRN:4e6},{width:1280,height:720,layers:3,target:"high",targetRN:25e5},{width:960,height:540,layers:3,target:"standard",targetRN:9e5},{width:640,height:360,layers:2,target:"standard",targetRN:5e5},{width:480,height:270,layers:2,target:"low",targetRN:35e4},{width:320,height:180,layers:1,target:"low",targetRN:15e4}],g=800;function b(e,t,n,i){var o=0,a=Math.min(t.height,t.width),r=v.find((function(e){return e.height<=a}));if(r&&e&&i.codec===c.a.VP8){var s=function(){var e=a;if(!(r=v.find((function(t){return t.height===e}))))return"break";o+=d.a.isReactNative()?r.targetRN:i[r.target]};for(a=r.height;a>=180;a/=2){if("break"===s())break}}else r&&(o=d.a.isReactNative()?r.targetRN:i[r.target]);return Math.min(o/1e3,function(e){if(e>6e4)return Number.MAX_SAFE_INTEGER;return g*Math.pow(1.08,e/1e3)}(Math.max(0,n-1e3)))}var y=function(){function e(t,n,o){var a,s=this;Object(i.a)(this,e),this.eventEmitter=n,this._conference=t,this._localStats={connectionQuality:100,jvbRTT:void 0},this._lastConnectionQualityUpdate=-1,this._options=o,this._remoteStats={},this._timeIceConnected=-1,this._timeVideoUnmuted=-1,(null===(a=this._options.config)||void 0===a?void 0:a.startBitrate)>0&&(g=this._options.config.startBitrate),t.on(r.CONNECTION_INTERRUPTED,(function(){s._updateLocalConnectionQuality(0),s.eventEmitter.emit(u.LOCAL_STATS_UPDATED,s._localStats),s._broadcastLocalStats()})),t.room.addListener(f.ICE_CONNECTION_STATE_CHANGED,(function(e,t){e.isP2P||"connected"!==t||(s._timeIceConnected=window.performance.now())})),t.on(r.ENDPOINT_MESSAGE_RECEIVED,(function(e,t){"stats"===t.type&&s._updateRemoteStats(e.getId(),t.values)})),t.on(r.ENDPOINT_STATS_RECEIVED,(function(e,t){s._updateRemoteStats(e.getId(),t)})),t.on(r.ENDPOINT_MESSAGE_RECEIVED,(function(e,t){"facial_expression"===t.type&&s.eventEmitter.emit(r.FACIAL_EXPRESSION_ADDED,e.getId(),t)})),t.statistics.addConnectionStatsListener(this._updateLocalStats.bind(this)),t.on(r.TRACK_MUTE_CHANGED,(function(e){e.isVideoTrack()&&(e.isMuted()?s._timeVideoUnmuted=-1:s._maybeUpdateUnmuteTime())})),t.on(r.TRACK_ADDED,(function(e){e.isVideoTrack()&&!e.isMuted()&&s._maybeUpdateUnmuteTime()})),t.rtc.on(l.LOCAL_TRACK_MAX_ENABLED_RESOLUTION_CHANGED,(function(e){s._localStats.maxEnabledResolution=e.maxEnabledResolution})),t.on(r.SERVER_REGION_CHANGED,(function(e){s._localStats.serverRegion=e})),t.on(r.PROPERTIES_CHANGED,(function(e){s._localStats.bridgeCount=Number((e||{})["bridge-count"])}))}return Object(o.a)(e,[{key:"_maybeUpdateUnmuteTime",value:function(){this._timeVideoUnmuted<0&&(this._timeVideoUnmuted=window.performance.now())}},{key:"_calculateConnectionQuality",value:function(e,t,n){var i,o=p[n],a=100;if(this._localStats.packetLoss&&(i=this._localStats.packetLoss.upload,t&&(i*=.5)),t||!o||e===h.DESKTOP||this._timeIceConnected<0||this._timeVideoUnmuted<0)void 0===i?(m.error("Cannot calculate connection quality, unknown packet loss."),a=100):a=i<=2?100:i<=4?70:i<=6?50:i<=8?30:i<=12?10:0;else{var r=this._conference.getActivePeerConnection();if(r){var s,c,l=r.isSimulcastOn(),u=r.getTargetVideoBitrates();u.codec=r.getConfiguredVideoCodec();var d=window.performance.now()-Math.max(this._timeVideoUnmuted,this._timeIceConnected),f=null!==(s=null===(c=this._options.config)||void 0===c?void 0:c.pcStatsInterval)&&void 0!==s?s:1e4,v=b(l,o,d,u);v=Math.min(v,2500),d>f&&(a=100*this._localStats.bitrate.upload/v)}i&&i>=10&&(a=Math.min(a,30))}if(this._lastConnectionQualityUpdate>0){var g=this._localStats.connectionQuality,y=(window.performance.now()-this._lastConnectionQualityUpdate)/1e3;a=Math.min(a,g+2*y)}return Math.min(100,a)}},{key:"_updateLocalConnectionQuality",value:function(e){this._localStats.connectionQuality=e,this._lastConnectionQualityUpdate=window.performance.now()}},{key:"_broadcastLocalStats",value:function(){var e={bitrate:this._localStats.bitrate,packetLoss:this._localStats.packetLoss,connectionQuality:this._localStats.connectionQuality,jvbRTT:this._localStats.jvbRTT,serverRegion:this._localStats.serverRegion,maxEnabledResolution:this._localStats.maxEnabledResolution,avgAudioLevels:this._localStats.localAvgAudioLevels};try{this._conference.sendEndpointStatsMessage(e)}catch(t){}}},{key:"_updateLocalStats",value:function(e,t){if(!e.isP2P){var n=t.transport&&t.transport.length&&t.transport[0].rtt;this._localStats.jvbRTT=n||void 0}if(e===this._conference.getActivePeerConnection()){var i,o=!this._conference.isConnectionInterrupted(),a=this._conference.getLocalVideoTrack(),r=a?a.videoType:void 0,s=!a||a.isMuted(),c=a?Math.min(a.resolution,a.maxEnabledResolution):null;for(i in s||this._maybeUpdateUnmuteTime(),t)t.hasOwnProperty(i)&&(this._localStats[i]=t[i]);o&&this._updateLocalConnectionQuality(this._calculateConnectionQuality(r,s,c)),this.eventEmitter.emit(u.LOCAL_STATS_UPDATED,this._localStats),this._broadcastLocalStats()}}},{key:"_updateRemoteStats",value:function(e,t){this._remoteStats[e]={bitrate:t.bitrate,packetLoss:t.packetLoss,connectionQuality:t.connectionQuality,jvbRTT:t.jvbRTT,serverRegion:t.serverRegion,maxEnabledResolution:t.maxEnabledResolution,avgAudioLevels:t.avgAudioLevels},this.eventEmitter.emit(u.REMOTE_STATS_UPDATED,e,this._remoteStats[e])}},{key:"getStats",value:function(){return this._localStats}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var i=n(6),o=n(8),a=n(22),r=n(66),s=n(12),c=Object(a.getLogger)(e),l=function(){function e(t){Object(i.a)(this,e),this._conference=t}return Object(o.a)(e,[{key:"_actOnIceFailed",value:function(){var e=this._conference.options.config,t=e.enableForcedReload,n=e.enableIceRestart,i="undefined"!==typeof n&&!n,o=this._conference.room.supportsRestartByTerminate(),a=o&&!n;if(c.info("ICE failed,"+" enableForcedReload: ".concat(t,",")+" enableIceRestart: ".concat(n,",")+" supports restart by terminate: ".concat(o)),i||!n&&!o||t){c.info("ICE failed, but ICE restarts are disabled");var l=t?r.CONFERENCE_RESTARTED:r.ICE_FAILED;this._conference.eventEmitter.emit(s.CONFERENCE_FAILED,l)}else{var u=this._conference.jvbJingleSession,d=u&&u.getIceConnectionState();u?"connected"===d?c.info("ICE connection restored - not sending ICE failed"):(c.info("Sending ICE failed - the connection did not recover, "+"ICE state: ".concat(d,", ")+"use 'session-terminate': ".concat(a)),a?this._conference.jvbJingleSession.terminate((function(){c.info("session-terminate for ice restart - done")}),(function(e){c.error("session-terminate for ice restart - error: ".concat(e.message))}),{reason:"connectivity-error",reasonDescription:"ICE FAILED",requestRestart:!0,sendSessionTerminate:!0}):this._conference.jvbJingleSession.sendIceFailedNotification()):c.warn("Not sending ICE failed - no JVB connection")}}},{key:"start",value:function(){var e=this;this._conference.xmpp.ping(65e3).then((function(){e._canceled||(e._iceFailedTimeout=window.setTimeout((function(){e._iceFailedTimeout=void 0,e._actOnIceFailed()}),2e3))}),(function(e){c.error("PING error/timeout - not sending ICE failed",e)}))}},{key:"cancel",value:function(){this._canceled=!0,window.clearTimeout(this._iceFailedTimeout)}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n(6),o=n(8),a=n(25),r=n(34),s=n(33),c=n(57),l=n.n(c),u=n(12),d=n(63),p=n(21),h=n(77),f=function(e){Object(r.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(i.a)(this,n),(o=t.call(this))._conference=e,o._timeoutTrigger=null,o._hasAudioInput=null,p.a.supportsReceiverStats()||e.statistics.addAudioLevelListener(o._audioLevel.bind(Object(a.a)(o))),e.on(u.TRACK_ADDED,o._trackAdded.bind(Object(a.a)(o))),o}return Object(o.a)(n,[{key:"_clearTriggerTimeout",value:function(){clearTimeout(this._timeoutTrigger),this._timeoutTrigger=null}},{key:"_handleAudioInputStateChange",value:function(e){var t=0!==e;null!==this._hasAudioInput&&this._hasAudioInput===t||(this._hasAudioInput=t,this.emit(h.AUDIO_INPUT_STATE_CHANGE,this._hasAudioInput))}},{key:"_handleNoAudioInputDetection",value:function(e){var t=this;this._eventFired||(0!==e||this._timeoutTrigger?0!==e&&this._timeoutTrigger&&this._clearTriggerTimeout():this._timeoutTrigger=setTimeout((function(){t._eventFired=!0,t.emit(h.NO_AUDIO_INPUT)}),4e3))}},{key:"_audioLevel",value:function(e,t,n,i){if(i&&this._audioTrack){var o=e.localSSRCs.get(this._audioTrack.rtcId);o&&o.ssrcs.includes(t)&&(this._handleAudioInputStateChange(n),this._handleNoAudioInputDetection(n))}}},{key:"_trackAdded",value:function(e){var t=this;e.isLocalAudioTrack()&&(this._audioTrack=e,this._eventFired=!1,this._clearTriggerTimeout(),p.a.supportsReceiverStats()&&(e.on(d.NO_AUDIO_INPUT,(function(e){t._handleNoAudioInputDetection(e)})),e.on(d.TRACK_AUDIO_LEVEL_CHANGED,(function(e){t._handleNoAudioInputDetection(e),t._handleAudioInputStateChange(e)}))))}}]),n}(l.a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(6),o=n(8),a=n(12),r=n(31),s=n.n(r),c=function(){function e(t){Object(i.a)(this,e),this.conference=t,t.addEventListener(a.TRACK_AUDIO_LEVEL_CHANGED,this._audioLevel.bind(this)),this.myUserID=this.conference.myUserId()}return Object(o.a)(e,[{key:"_audioLevel",value:function(e,t){!this.conference.isP2PActive()||t<=.6||e===this.myUserID&&this.conference.getLocalAudioTrack().isMuted()||this.conference.rtc.eventEmitter.emit(s.a.DOMINANT_SPEAKER_CHANGED,e)}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n(6),o=n(8),a=n(25),r=n(34),s=n(33),c=n(57),l=n(103),u=n(77),d=function(e){Object(r.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.call(this))._processing=!1,e._scoreArray=[],e._audioLvlArray=[],e._active=!1,e._calculateNoisyScore=e._calculateNoisyScore.bind(Object(a.a)(e)),e}return Object(o.a)(n,[{key:"_calculateNoisyScore",value:function(){var e=Object(l.b)(this._scoreArray),t=Object(l.b)(this._audioLvlArray);e<.2&&t>.04&&(this.emit(u.VAD_NOISY_DEVICE),this._setActiveState(!1)),this.reset()}},{key:"_recordValues",value:function(e,t){this._scoreArray.push(e),this._audioLvlArray.push(t)}},{key:"_setActiveState",value:function(e){this._active=e,this.emit(u.DETECTOR_STATE_CHANGE,this._active)}},{key:"changeMuteState",value:function(e){this._setActiveState(!e),this.reset()}},{key:"isActive",value:function(){return this._active}},{key:"reset",value:function(){this._processing=!1,this._scoreArray=[],this._audioLvlArray=[],clearTimeout(this._processTimeout)}},{key:"processVADScore",value:function(e){if(this._active)if(this._processing){var t=Object(l.c)(e.pcmData);this._recordValues(e.score,Object(l.b)(t))}else if(e.score<.2){var n=Object(l.c)(e.pcmData),i=Object(l.b)(n);i>.02&&(this._processing=!0,this._recordValues(e.score,i),this._processTimeout=setTimeout(this._calculateNoisyScore,1500))}}}]),n}(c.EventEmitter)},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n(6),o=n(8),a=n(25),r=n(34),s=n(33),c=n(57),l=n(103),u=n(77),d=function(e){Object(r.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.call(this))._processing=!1,e._scoreArray=[],e._active=!1,e._calculateVADScore=e._calculateVADScore.bind(Object(a.a)(e)),e}return Object(o.a)(n,[{key:"_calculateVADScore",value:function(){Object(l.b)(this._scoreArray)>.6&&(this.emit(u.VAD_TALK_WHILE_MUTED),this._setActiveState(!1)),this.reset()}},{key:"_setActiveState",value:function(e){this._active=e,this.emit(u.DETECTOR_STATE_CHANGE,this._active)}},{key:"changeMuteState",value:function(e){this._setActiveState(e),this.reset()}},{key:"isActive",value:function(){return this._active}},{key:"processVADScore",value:function(e){this._active&&(this._processing?this._scoreArray.push(e.score):e.score>.9&&(this._processing=!0,this._scoreArray.push(e.score),this._processTimeout=setTimeout(this._calculateVADScore,700)))}},{key:"reset",value:function(){this._processing=!1,this._scoreArray=[],clearTimeout(this._processTimeout)}}]),n}(c.EventEmitter)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var i=n(6),o=n(8),a=n(22),r=n(12),s=n(235),c=n(35),l=n(28),u=Object(a.getLogger)(e),d="e2e-ping-request",p="e2e-ping-response",h=function(){function e(t,n){Object(i.a)(this,e),this.participant=t,this.e2eping=n,this.id=t.getId(),this.requests={},this.lastRequestId=1,this.clearIntervals=this.clearIntervals.bind(this),this.sendRequest=this.sendRequest.bind(this),this.handleResponse=this.handleResponse.bind(this),this.maybeSendAnalytics=this.maybeSendAnalytics.bind(this),this.sendAnalytics=this.sendAnalytics.bind(this),n.isDataChannelOpen&&this.sendRequest(),this.pingInterval=window.setInterval(this.sendRequest,n.pingIntervalMs),this.analyticsInterval=window.setTimeout(this.maybeSendAnalytics,this.e2eping.analyticsIntervalMs)}return Object(o.a)(e,[{key:"clearIntervals",value:function(){this.pingInterval&&window.clearInterval(this.pingInterval),this.analyticsInterval&&window.clearInterval(this.analyticsInterval)}},{key:"sendRequest",value:function(){var e=this.lastRequestId++,t={type:d,id:e};this.e2eping.sendMessage(t,this.id),this.requests[e]={id:e,timeSent:window.performance.now()}}},{key:"handleResponse",value:function(e){var t=this.requests[e.id];t&&(t.rtt=window.performance.now()-t.timeSent,this.e2eping.eventEmitter.emit(s.E2E_RTT_CHANGED,this.participant,t.rtt)),this.maybeSendAnalytics()}},{key:"maybeSendAnalytics",value:function(){var e,t,n=window.performance.now(),i=1/0;for(t in this.requests)this.requests.hasOwnProperty(t)&&((e=this.requests[t]).timeSent<n-this.e2eping.analyticsIntervalMs?delete this.requests[t]:e.rtt&&(i=Math.min(i,e.rtt)));i<1/0&&this.sendAnalytics(i)}},{key:"sendAnalytics",value:function(e){l.a.sendAnalytics(Object(c.D)(this.id,this.participant.getProperty("region"),e))}}]),e}(),f=function(){function e(t,n,o){Object(i.a)(this,e),this.conference=t,this.eventEmitter=t.eventEmitter,this.sendMessage=o,this.pingIntervalMs=1e4,this.analyticsIntervalMs=6e4,this.participants={},this.isDataChannelOpen=!1,n&&n.e2eping&&("number"===typeof n.e2eping.pingInterval&&(this.pingIntervalMs=n.e2eping.pingInterval),"number"===typeof n.e2eping.analyticsInterval&&(this.analyticsIntervalMs=n.e2eping.analyticsInterval),this.analyticsIntervalMs>0&&this.analyticsIntervalMs<this.pingIntervalMs&&(this.analyticsIntervalMs=this.pingIntervalMs)),u.info("Initializing e2e ping; pingInterval=".concat(this.pingIntervalMs,", analyticsInterval=").concat(this.analyticsIntervalMs,".")),this.participantJoined=this.participantJoined.bind(this),t.on(r.USER_JOINED,this.participantJoined),this.participantLeft=this.participantLeft.bind(this),t.on(r.USER_LEFT,this.participantLeft),this.messageReceived=this.messageReceived.bind(this),t.on(r.ENDPOINT_MESSAGE_RECEIVED,this.messageReceived),this.dataChannelOpened=this.dataChannelOpened.bind(this),t.on(r.DATA_CHANNEL_OPENED,this.dataChannelOpened)}return Object(o.a)(e,[{key:"dataChannelOpened",value:function(){for(var e in this.isDataChannelOpen=!0,this.participants)if(this.participants.hasOwnProperty(e)){var t=this.participants[e];window.setTimeout(t.sendRequest,200)}}},{key:"messageReceived",value:function(e,t){t.type===d?this.handleRequest(e.getId(),t):t.type===p&&this.handleResponse(e.getId(),t)}},{key:"participantJoined",value:function(e,t){this.pingIntervalMs<=0||(this.participants[e]&&(u.info("Participant wrapper already exists for ".concat(e,". Clearing.")),this.participants[e].clearIntervals(),delete this.participants[e]),this.participants[e]=new h(t,this))}},{key:"participantLeft",value:function(e){this.pingIntervalMs<=0||this.participants[e]&&(this.participants[e].clearIntervals(),delete this.participants[e])}},{key:"handleRequest",value:function(e,t){if(t&&t.id){var n={type:p,id:t.id};this.sendMessage(n,e)}else u.info("Received an invalid e2e ping request from ".concat(e,"."))}},{key:"handleResponse",value:function(e,t){var n=this.participants[e];n&&n.handleResponse(t)}},{key:"stop",value:function(){for(var e in u.info("Stopping e2eping"),this.conference.off(r.USER_JOINED,this.participantJoined),this.conference.off(r.USER_LEFT,this.participantLeft),this.conference.off(r.ENDPOINT_MESSAGE_RECEIVED,this.messageReceived),this.conference.off(r.DATA_CHANNEL_OPENED,this.dataChannelOpened),this.participants)this.participants.hasOwnProperty(e)&&this.participants[e].clearIntervals();this.participants={}}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(6),o=n(8),a=n(22),r=n(12),s=Object(a.getLogger)(e),c=function(){function e(t){var n=this;Object(i.a)(this,e),this._conference=t,this._jvb121=!0,this._conference.addEventListener(r.USER_JOINED,(function(){return n.evaluateStatus()})),this._conference.addEventListener(r.USER_LEFT,(function(){return n.evaluateStatus()})),this._conference.addEventListener(r.P2P_STATUS,(function(){return n.evaluateStatus()}))}return Object(o.a)(e,[{key:"evaluateStatus",value:function(){var e=this._jvb121,t=!this._conference.isP2PActive()&&this._conference.getParticipantCount()<=2;e!==t&&(this._jvb121=t,s.debug("JVB121 status ".concat(e," => ").concat(t)),this._conference.eventEmitter.emit(r.JVB121_STATUS,e,t))}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p}));var i=n(14),o=n(6),a=n(8),r=n(22),s=n(109),c=n.n(s),l=n(12),u=Object(r.getLogger)(e),d=function(){function e(){Object(o.a)(this,e),this._defaultConstraints={maxHeight:180},this._lastN=-1,this._maxFrameHeight=2160,this._selectedEndpoints=[],this._receiverVideoConstraints={constraints:{},defaultConstraints:this.defaultConstraints,lastN:this._lastN,onStageEndpoints:[],selectedEndpoints:this._selectedEndpoints}}return Object(a.a)(e,[{key:"constraints",get:function(){return this._receiverVideoConstraints.lastN=this._lastN,this._selectedEndpoints.length?(this._receiverVideoConstraints.constraints={},this._selectedEndpoints.length>1?(this._receiverVideoConstraints.defaultConstraints={maxHeight:this._maxFrameHeight},this._receiverVideoConstraints.onStageEndpoints=[],this._receiverVideoConstraints.selectedEndpoints=[]):(this._receiverVideoConstraints.constraints[this._selectedEndpoints[0]]={maxHeight:this._maxFrameHeight},this._receiverVideoConstraints.defaultConstraints=this._defaultConstraints,this._receiverVideoConstraints.onStageEndpoints=this._selectedEndpoints,this._receiverVideoConstraints.selectedEndpoints=[]),this._receiverVideoConstraints):this._receiverVideoConstraints}},{key:"updateLastN",value:function(e){var t=this._lastN!==e;return t&&(this._lastN=e,u.debug("Updating ReceiverVideoConstraints lastN(".concat(e,")"))),t}},{key:"updateReceiveResolution",value:function(e){var t=this._maxFrameHeight!==e;return t&&(this._maxFrameHeight=e,u.debug("Updating receive maxFrameHeight: ".concat(e))),t}},{key:"updateReceiverVideoConstraints",value:function(e){var t=!c()(this._receiverVideoConstraints,e);return t&&(this._receiverVideoConstraints=e,u.debug("Updating ReceiverVideoConstraints ".concat(JSON.stringify(e)))),t}},{key:"updateSelectedEndpoints",value:function(e){u.debug("Updating selected endpoints: ".concat(JSON.stringify(e))),this._selectedEndpoints=e}}]),e}(),p=function(){function e(t,n){var i,a,r=this;Object(o.a)(this,e),this._conference=t,this._rtc=n;var s=t.options.config;(this._lastN=null!==(i=null===s||void 0===s?void 0:s.startLastN)&&void 0!==i?i:(null===s||void 0===s?void 0:s.channelLastN)||-1,this._maxFrameHeight=2160,null===(a=null===s||void 0===s?void 0:s.useNewBandwidthAllocationStrategy)||void 0===a||a)?(this._receiverVideoConstraints=new d,this._receiverVideoConstraints.updateLastN(this._lastN)&&this._rtc.setNewReceiverVideoConstraints(this._receiverVideoConstraints.constraints)):this._rtc.setLastN(this._lastN);this._selectedEndpoints=[],this._conference.on(l._MEDIA_SESSION_STARTED,(function(e){return r._onMediaSessionStarted(e)}))}return Object(a.a)(e,[{key:"_onMediaSessionStarted",value:function(e){e.isP2P||!this._receiverVideoConstraints?e.setReceiverVideoConstraint(this._maxFrameHeight):(this._receiverVideoConstraints.updateReceiveResolution(this._maxFrameHeight),this._rtc.setNewReceiverVideoConstraints(this._receiverVideoConstraints.constraints))}},{key:"getLastN",value:function(){return this._lastN}},{key:"selectEndpoints",value:function(e){var t=this;if(this._selectedEndpoints=e,this._receiverVideoConstraints){var n=e.filter((function(e){return e!==t._conference.myUserId()})),i=JSON.parse(JSON.stringify(this._receiverVideoConstraints.constraints));n.length&&this._receiverVideoConstraints.updateSelectedEndpoints(n);var o=this._receiverVideoConstraints.constraints;c()(o,i)||this._rtc.setNewReceiverVideoConstraints(o)}else this._rtc.selectEndpoints(e)}},{key:"setLastN",value:function(e){if(this._lastN!==e){if(this._lastN=e,this._receiverVideoConstraints)return void(this._receiverVideoConstraints.updateLastN(e)&&this._rtc.setNewReceiverVideoConstraints(this._receiverVideoConstraints.constraints));this._rtc.setLastN(e)}}},{key:"setPreferredReceiveMaxFrameHeight",value:function(e){this._maxFrameHeight=e;var t,n=Object(i.a)(this._conference._getMediaSessions());try{for(n.s();!(t=n.n()).done;){var o=t.value;if(o.isP2P||!this._receiverVideoConstraints)e&&o.setReceiverVideoConstraint(e);else this._receiverVideoConstraints.updateReceiveResolution(e)&&this._rtc.setNewReceiverVideoConstraints(this._receiverVideoConstraints.constraints)}}catch(a){n.e(a)}finally{n.f()}}},{key:"setReceiverConstraints",value:function(e){if(this._receiverVideoConstraints||(this._receiverVideoConstraints=new d),this._receiverVideoConstraints.updateReceiverVideoConstraints(e)){var t,n;this._lastN=null!==(t=e.lastN)&&void 0!==t?t:this._lastN,this._selectedEndpoints=null!==(n=e.selectedEndpoints)&&void 0!==n?n:this._selectedEndpoints,this._rtc.setNewReceiverVideoConstraints(e);var i=this._conference._getMediaSessions().find((function(e){return e.isP2P}));if(i){var o,a,r=null===(o=Object.values(e.constraints)[0])||void 0===o?void 0:o.maxHeight;if(!r)r=null===(a=e.defaultConstraints)||void 0===a?void 0:a.maxHeight;r&&i.setReceiverVideoConstraint(r)}}}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n(14),o=n(6),a=n(8),r=n(12),s=n(31),c=n.n(s),l=n(230),u=function(){function e(t,n){var i,a,s,l=this;Object(o.a)(this,e),this.conference=t,this.layerSuspensionEnabled=null===(i=null===(a=t.options)||void 0===a||null===(s=a.config)||void 0===s?void 0:s.enableLayerSuspension)||void 0===i||i,this.rtc=n,this.conference.on(r._MEDIA_SESSION_STARTED,(function(e){return l._onMediaSessionStarted(e)})),this.conference.on(r._MEDIA_SESSION_ACTIVE_CHANGED,(function(){return l._propagateSendMaxFrameHeight()})),this.rtc.on(c.a.SENDER_VIDEO_CONSTRAINTS_CHANGED,(function(e){var t;(null===(t=l._senderVideoConstraints)||void 0===t?void 0:t.idealHeight)!==e.idealHeight&&(l._senderVideoConstraints=e,l._propagateSendMaxFrameHeight())}))}return Object(a.a)(e,[{key:"_onMediaSessionStarted",value:function(e){var t=this;e.addListener(l.a.REMOTE_VIDEO_CONSTRAINTS_CHANGED,(function(e){e===t.conference._getActiveMediaSession()&&t._propagateSendMaxFrameHeight()}))}},{key:"_propagateSendMaxFrameHeight",value:function(){var e=this.selectSendMaxFrameHeight(),t=[];if(e>=0){var n,o=Object(i.a)(this.conference._getMediaSessions());try{for(o.s();!(n=o.n()).done;){var a=n.value;t.push(a.setSenderVideoConstraint(e))}}catch(r){o.e(r)}finally{o.f()}}return Promise.all(t)}},{key:"selectSendMaxFrameHeight",value:function(){var e,t=this.conference._getActiveMediaSession(),n=t?t.isP2P?t.getRemoteRecvMaxFrameHeight():this.layerSuspensionEnabled?null===(e=this._senderVideoConstraints)||void 0===e?void 0:e.idealHeight:void 0:void 0;return this.preferredSendMaxFrameHeight>=0&&n>=0?Math.min(this.preferredSendMaxFrameHeight,n):n>=0?n:this.preferredSendMaxFrameHeight}},{key:"setPreferredSendMaxFrameHeight",value:function(e){return this.preferredSendMaxFrameHeight=e,this._propagateSendMaxFrameHeight()}}]),e}()},function(e,t,n){"use strict";(function(e){var i=n(5),o=n(6),a=n(8),r=n(22),s=n(11),c=n.n(s),l=n(295),u=n(180),d=Object(r.getLogger)(e),p=function(){function e(t){Object(o.a)(this,e),this._sessions={},this._chatRoom=t,this.onPresence=this.onPresence.bind(this),this._chatRoom.eventEmitter.addListener(c.a.PRESENCE_RECEIVED,this.onPresence)}return Object(a.a)(e,[{key:"getSession",value:function(e){return this._sessions[e]}},{key:"onPresence",value:function(e){var t=e.fromHiddenDomain,n=e.presence;u.a.isFromFocus(n)?this._handleFocusPresence(n):t&&this._handleJibriPresence(n)}},{key:"startRecording",value:function(e){var t=this,n=new l.a(Object(i.a)(Object(i.a)({},e),{},{connection:this._chatRoom.connection}));return n.start({appData:e.appData,broadcastId:e.broadcastId,focusMucJid:this._chatRoom.focusMucJid,streamId:e.streamId}).then((function(){return t.getSession(n.getID())||(t._addSession(n),t._emitSessionUpdate(n)),n})).catch((function(e){return t._emitSessionUpdate(n),Promise.reject(e)}))}},{key:"stopRecording",value:function(e){var t=this.getSession(e);return t?t.stop({focusMucJid:this._chatRoom.focusMucJid}):Promise.reject(new Error("Could not find session"))}},{key:"_addSession",value:function(e){this._sessions[e.getID()]=e}},{key:"_createSession",value:function(e,t,n){var i=new l.a({connection:this._chatRoom.connection,focusMucJid:this._chatRoom.focusMucJid,mode:n,sessionID:e,status:t});return this._addSession(i),i}},{key:"_emitSessionUpdate",value:function(e,t){this._chatRoom.eventEmitter.emit(c.a.RECORDER_STATE_CHANGED,e,t)}},{key:"_handleFocusPresence",value:function(e){var t=u.a.getFocusRecordingUpdate(e);if(t){var n=t.error,i=t.initiator,o=t.recordingMode,a=t.sessionID,r=t.status,s=this.getSession(a);s||"off"!==r?s&&s.getStatus()===r&&s.getError()===n?d.warn("Ignoring duplicate presence update: ",JSON.stringify(t)):(s||(s=this._createSession(a,r,o)),s.setStatus(r),n&&s.setError(n),this._emitSessionUpdate(s,i)):d.warn("Ignoring recording presence update","Received a new session with status off.")}}},{key:"_handleJibriPresence",value:function(e){var t=u.a.getHiddenDomainUpdate(e),n=t.liveStreamViewURL,i=t.mode,o=t.sessionID;if(o){var a=this.getSession(o);a||(a=this._createSession(o,"",i)),a.setLiveStreamViewURL(n),this._emitSessionUpdate(a)}else d.warn("Ignoring potential jibri presence due to no session id.")}}]),e}();t.a=p}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p}));var i=n(6),o=n(8),a=n(22),r=n(12),s=n(20),c=n(104),l=n(35),u=n(28),d=Object(a.getLogger)(e),p=function(){function e(t){Object(i.a)(this,e),this._conference=t,this._localAudioLevelCache={},this._reportedParticipants=[],this._audioProblemCandidates={},this._numberOfRemoteAudioLevelsReceived={},this._onLocalAudioLevelsReport=this._onLocalAudioLevelsReport.bind(this),this._onRemoteAudioLevelReceived=this._onRemoteAudioLevelReceived.bind(this),this._clearUserData=this._clearUserData.bind(this),this._conference.on(c.REMOTE_STATS_UPDATED,this._onRemoteAudioLevelReceived),this._conference.statistics.addConnectionStatsListener(this._onLocalAudioLevelsReport),this._conference.on(r.USER_LEFT,this._clearUserData)}return Object(o.a)(e,[{key:"_onRemoteAudioLevelReceived",value:function(e,t){var n=t.avgAudioLevels,i=this._numberOfRemoteAudioLevelsReceived[e]+1||0;if(this._numberOfRemoteAudioLevelsReceived[e]=i,!(-1!==this._reportedParticipants.indexOf(e)||e in this._audioProblemCandidates||n<=0||i<3)){var o=this._conference.getParticipantById(e);if(o)if(o.getTracksByMediaType(s.AUDIO).length>0&&o.isAudioMuted())return;var a=this._localAudioLevelCache[e];Array.isArray(a)&&!a.every((function(e){return 0===e}))||(this._audioProblemCandidates[e]={remoteAudioLevels:n,localAudioLevels:[]})}}},{key:"_onLocalAudioLevelsReport",value:function(e,t){var n=this,i=t.avgAudioLevels;e===this._conference.getActivePeerConnection()&&(Object.keys(i).forEach((function(e){if(-1===n._reportedParticipants.indexOf(e)){var t=n._localAudioLevelCache[e];Array.isArray(t)?t.length>=2&&t.shift():n._localAudioLevelCache[e]=[],n._localAudioLevelCache[e].push(i[e])}})),Object.keys(this._audioProblemCandidates).forEach((function(e){var t=n._audioProblemCandidates[e],o=t.localAudioLevels,a=t.remoteAudioLevels;if(o.push(i[e]),2===o.length){if(o.every((function(e){return"undefined"===typeof e||0===e}))){var r=JSON.stringify(o);u.a.sendAnalytics(Object(l.x)(e,r,a)),d.warn("A potential problem is detected with the audio output for participant ".concat(e,", local audio levels: ").concat(r,", remote audio levels: ").concat(a)),n._reportedParticipants.push(e),n._clearUserData(e)}delete n._audioProblemCandidates[e]}})))}},{key:"_clearUserData",value:function(e){delete this._localAudioLevelCache[e]}},{key:"dispose",value:function(){this._conference.off(c.REMOTE_STATS_UPDATED,this._onRemoteAudioLevelReceived),this._conference.off(r.USER_LEFT,this._clearUserData),this._conference.statistics.removeConnectionStatsListener(this._onLocalAudioLevelsReport),this._localAudioLevelCache=void 0,this._audioProblemCandidates=void 0,this._reportedParticipants=void 0,this._numberOfRemoteAudioLevelsReceived=void 0,this._conference=void 0}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return y}));var i=n(14),o=n(6),a=n(8),r=n(22),s=n(109),c=n.n(s),l=n(12),u=n(20),d=n(45),p=n(104),h=n(35),f=n(21),m=n(28),v=Object(r.getLogger)(e),g=function(){function e(t){Object(o.a)(this,e),this.name=t,this.count=0,this.sum=0,this.samples=[]}return Object(a.a)(e,[{key:"addNext",value:function(e){"number"!==typeof e?v.error("".concat(this.name," - invalid value for idx: ").concat(this.count),e):isNaN(e)||(this.sum+=e,this.samples.push(e),this.count+=1)}},{key:"calculate",value:function(){return this.sum/this.count}},{key:"appendReport",value:function(e){e["".concat(this.name,"_avg")]=this.calculate(),e["".concat(this.name,"_samples")]=JSON.stringify(this.samples)}},{key:"reset",value:function(){this.samples=[],this.sum=0,this.count=0}}]),e}(),b=function(){function e(t,n,i){var a=this;Object(o.a)(this,e),this.isP2P=n,this._n=i,this._sampleIdx=0,this._avgRTT=new g("rtt"),this._avgRemoteRTTMap=new Map,this._avgRtpStatsReporter=t,this._avgEnd2EndRTT=void 0,this._onConnectionStats=function(e,t){a.isP2P===e.isP2P&&a._calculateAvgStats(t)};var r=t._conference;r.statistics.addConnectionStatsListener(this._onConnectionStats),this.isP2P||(this._onUserLeft=function(e){return a._avgRemoteRTTMap.delete(e)},r.on(l.USER_LEFT,this._onUserLeft),this._onRemoteStatsUpdated=function(e,t){return a._processRemoteStats(e,t)},r.on(p.REMOTE_STATS_UPDATED,this._onRemoteStatsUpdated))}return Object(a.a)(e,[{key:"_calculateAvgStats",value:function(e){if(e){if(f.a.supportsRTTStatistics()&&e.transport&&e.transport.length&&this._avgRTT.addNext(e.transport[0].rtt),this._sampleIdx+=1,this._sampleIdx>=this._n){if(f.a.supportsRTTStatistics()){var t=this._avgRtpStatsReporter._conference,n={p2p:this.isP2P,conference_size:t.getParticipantCount()};if(e.transport&&e.transport.length&&Object.assign(n,{local_candidate_type:e.transport[0].localCandidateType,remote_candidate_type:e.transport[0].remoteCandidateType,transport_type:e.transport[0].type}),this._avgRTT.appendReport(n),this.isP2P){var i=this._avgRtpStatsReporter.jvbStatsMonitor._avgEnd2EndRTT;isNaN(i)||(n.rtt_diff=this._avgRTT.calculate()-i)}else{var o=this._calculateAvgRemoteRTT(),a=this._avgRTT.calculate();this._avgEnd2EndRTT=a+o,isNaN(a)||isNaN(o)||(n.end2end_rtt_avg=this._avgEnd2EndRTT)}m.a.sendAnalytics(Object(h.L)(n))}this._resetAvgStats()}}else v.error("No stats")}},{key:"_calculateAvgRemoteRTT",value:function(){var e,t=0,n=0,o=Object(i.a)(this._avgRemoteRTTMap.values());try{for(o.s();!(e=o.n()).done;){var a=e.value,r=a.calculate();isNaN(r)||(n+=r,t+=1,a.reset())}}catch(s){o.e(s)}finally{o.f()}return n/t}},{key:"_processRemoteStats",value:function(e,t){var n="number"===typeof t.jvbRTT,i=this._avgRemoteRTTMap.get(e);!i&&n&&(i=new g("".concat(e,"_stat_rtt")),this._avgRemoteRTTMap.set(e,i)),n?i.addNext(t.jvbRTT):i&&this._avgRemoteRTTMap.delete(e)}},{key:"_resetAvgStats",value:function(){this._avgRTT.reset(),this._avgRemoteRTTMap&&this._avgRemoteRTTMap.clear(),this._sampleIdx=0}},{key:"dispose",value:function(){var e=this._avgRtpStatsReporter._conference;e.statistics.removeConnectionStatsListener(this._onConnectionStats),this.isP2P||(e.off(p.REMOTE_STATS_UPDATED,this._onRemoteStatsUpdated),e.off(l.USER_LEFT,this._onUserLeft))}}]),e}(),y=function(){function e(t,n){var i=this;Object(o.a)(this,e),this._n=n,n>0?(v.info("Avg RTP stats will be calculated every ".concat(n," samples")),this._sampleIdx=0,this._conference=t,this._avgAudioBitrateUp=new g("bitrate_audio_upload"),this._avgAudioBitrateDown=new g("bitrate_audio_download"),this._avgVideoBitrateUp=new g("bitrate_video_upload"),this._avgVideoBitrateDown=new g("bitrate_video_download"),this._avgBandwidthUp=new g("bandwidth_upload"),this._avgBandwidthDown=new g("bandwidth_download"),this._avgPacketLossTotal=new g("packet_loss_total"),this._avgPacketLossUp=new g("packet_loss_upload"),this._avgPacketLossDown=new g("packet_loss_download"),this._avgRemoteFPS=new g("framerate_remote"),this._avgRemoteScreenFPS=new g("framerate_screen_remote"),this._avgLocalFPS=new g("framerate_local"),this._avgLocalScreenFPS=new g("framerate_screen_local"),this._avgRemoteCameraPixels=new g("pixels_remote"),this._avgRemoteScreenPixels=new g("pixels_screen_remote"),this._avgLocalCameraPixels=new g("pixels_local"),this._avgLocalScreenPixels=new g("pixels_screen_local"),this._avgCQ=new g("connection_quality"),this._cachedTransportStats=void 0,this._onLocalStatsUpdated=function(e){i._calculateAvgStats(e),i._maybeSendTransportAnalyticsEvent(e)},t.on(p.LOCAL_STATS_UPDATED,this._onLocalStatsUpdated),this._onP2PStatusChanged=function(){v.debug("Resetting average stats calculation"),i._resetAvgStats(),i.jvbStatsMonitor._resetAvgStats(),i.p2pStatsMonitor._resetAvgStats()},t.on(l.P2P_STATUS,this._onP2PStatusChanged),this._onJvb121StatusChanged=function(e,t){!0===t&&(v.info("Resetting JVB avg RTP stats"),i._resetAvgJvbStats())},t.on(l.JVB121_STATUS,this._onJvb121StatusChanged),this.jvbStatsMonitor=new b(this,!1,n),this.p2pStatsMonitor=new b(this,!0,n)):v.info("Avg RTP stats reports are disabled.")}return Object(a.a)(e,[{key:"_calculateAvgStats",value:function(e){if(e){var t=this._conference.isP2PActive(),n=this._conference.getParticipantCount();if(t||!(n<2)){var i=e.bitrate,o=e.bandwidth,a=e.packetLoss,r=e.framerate,s=e.resolution;if(i)if(o)if(a)if(r)if(s){if(this._avgAudioBitrateUp.addNext(i.audio.upload),this._avgAudioBitrateDown.addNext(i.audio.download),this._avgVideoBitrateUp.addNext(i.video.upload),this._avgVideoBitrateDown.addNext(i.video.download),f.a.supportsBandwidthStatistics()&&(this._avgBandwidthUp.addNext(o.upload),this._avgBandwidthDown.addNext(o.download)),this._avgPacketLossUp.addNext(a.upload),this._avgPacketLossDown.addNext(a.download),this._avgPacketLossTotal.addNext(a.total),this._avgCQ.addNext(e.connectionQuality),r&&(this._avgRemoteFPS.addNext(this._calculateAvgVideoFps(r,!1,d.CAMERA)),this._avgRemoteScreenFPS.addNext(this._calculateAvgVideoFps(r,!1,d.DESKTOP)),this._avgLocalFPS.addNext(this._calculateAvgVideoFps(r,!0,d.CAMERA)),this._avgLocalScreenFPS.addNext(this._calculateAvgVideoFps(r,!0,d.DESKTOP))),s&&(this._avgRemoteCameraPixels.addNext(this._calculateAvgVideoPixels(s,!1,d.CAMERA)),this._avgRemoteScreenPixels.addNext(this._calculateAvgVideoPixels(s,!1,d.DESKTOP)),this._avgLocalCameraPixels.addNext(this._calculateAvgVideoPixels(s,!0,d.CAMERA)),this._avgLocalScreenPixels.addNext(this._calculateAvgVideoPixels(s,!0,d.DESKTOP))),this._sampleIdx+=1,this._sampleIdx>=this._n){var c={p2p:t,conference_size:n};e.transport&&e.transport.length&&Object.assign(c,{local_candidate_type:e.transport[0].localCandidateType,remote_candidate_type:e.transport[0].remoteCandidateType,transport_type:e.transport[0].type}),this._avgAudioBitrateUp.appendReport(c),this._avgAudioBitrateDown.appendReport(c),this._avgVideoBitrateUp.appendReport(c),this._avgVideoBitrateDown.appendReport(c),f.a.supportsBandwidthStatistics()&&(this._avgBandwidthUp.appendReport(c),this._avgBandwidthDown.appendReport(c)),this._avgPacketLossUp.appendReport(c),this._avgPacketLossDown.appendReport(c),this._avgPacketLossTotal.appendReport(c),this._avgRemoteFPS.appendReport(c),isNaN(this._avgRemoteScreenFPS.calculate())||this._avgRemoteScreenFPS.appendReport(c),this._avgLocalFPS.appendReport(c),isNaN(this._avgLocalScreenFPS.calculate())||this._avgLocalScreenFPS.appendReport(c),this._avgRemoteCameraPixels.appendReport(c),isNaN(this._avgRemoteScreenPixels.calculate())||this._avgRemoteScreenPixels.appendReport(c),this._avgLocalCameraPixels.appendReport(c),isNaN(this._avgLocalScreenPixels.calculate())||this._avgLocalScreenPixels.appendReport(c),this._avgCQ.appendReport(c),m.a.sendAnalytics(Object(h.L)(c)),this._resetAvgStats()}}else v.error("No resolution");else v.error('No "framerate"');else v.error('No "packetloss"');else v.error('No "bandwidth"');else v.error('No "bitrate"')}}else v.error("No stats")}},{key:"_calculateAvgVideoPixels",value:function(e,t,n){for(var i=0,o=0,a=this._conference.myUserId(),r=0,s=Object.keys(e);r<s.length;r++){var c=s[r];if(t?c===a:c!==a){var l=t?null:this._conference.getParticipantById(c),u=e[c];if((t||l)&&u){var d=this._calculatePeerAvgVideoPixels(u,l,n);isNaN(d)||(i+=d,o+=1)}}}return i/o}},{key:"_calculatePeerAvgVideoPixels",value:function(e,t,n){var o=Object.keys(e).map((function(e){return Number(e)})),a=null,r=this._conference.getActivePeerConnection();t?(a=t.getTracksByMediaType(u.VIDEO))&&(o=o.filter((function(e){return a.find((function(t){return!t.isMuted()&&t.getSSRC()===e&&t.videoType===n}))}))):(a=this._conference.getLocalTracks(u.VIDEO),o=o.filter((function(e){return a.find((function(t){return!t.isMuted()&&r.getLocalSSRC(t)===e&&t.videoType===n}))})));var s,c=0,l=0,d=Object(i.a)(o);try{for(d.s();!(s=d.n()).done;){var p=s.value,h=Number(e[p].height)*Number(e[p].width);!isNaN(h)&&h>0&&(c+=h,l+=1)}}catch(f){d.e(f)}finally{d.f()}return c/l}},{key:"_calculateAvgVideoFps",value:function(e,t,n){for(var i=0,o=0,a=this._conference.myUserId(),r=0,s=Object.keys(e);r<s.length;r++){var c=s[r];if(t?c===a:c!==a){var l=t?null:this._conference.getParticipantById(c),u=e[c];if((t||l)&&u){var d=this._calculatePeerAvgVideoFps(u,l,n);isNaN(d)||(i+=d,o+=1)}}}return i/o}},{key:"_calculatePeerAvgVideoFps",value:function(e,t,n){var o=Object.keys(e).map((function(e){return Number(e)})),a=null,r=this._conference.getActivePeerConnection();t?(a=t.getTracksByMediaType(u.VIDEO))&&(o=o.filter((function(e){return a.find((function(t){return!t.isMuted()&&t.getSSRC()===e&&t.videoType===n}))}))):(a=this._conference.getLocalTracks(u.VIDEO),o=o.filter((function(e){return a.find((function(t){return!t.isMuted()&&r.getLocalSSRC(t)===e&&t.videoType===n}))})));var s,c=0,l=0,d=Object(i.a)(o);try{for(d.s();!(s=d.n()).done;){var p=s.value,h=Number(e[p]);!isNaN(h)&&h>0&&(c+=h,l+=1)}}catch(f){d.e(f)}finally{d.f()}return c/l}},{key:"_maybeSendTransportAnalyticsEvent",value:function(e){if(e&&e.transport&&e.transport.length){var t={p2p:e.transport[0].p2p,local_candidate_type:e.transport[0].localCandidateType,remote_candidate_type:e.transport[0].remoteCandidateType,transport_type:e.transport[0].type};this._cachedTransportStats&&c()(t,this._cachedTransportStats)||(this._cachedTransportStats=t,m.a.sendAnalytics(Object(h.M)(t)))}}},{key:"_resetAvgJvbStats",value:function(){this._resetAvgStats(),this.jvbStatsMonitor._resetAvgStats()}},{key:"_resetAvgStats",value:function(){this._avgAudioBitrateUp.reset(),this._avgAudioBitrateDown.reset(),this._avgVideoBitrateUp.reset(),this._avgVideoBitrateDown.reset(),this._avgBandwidthUp.reset(),this._avgBandwidthDown.reset(),this._avgPacketLossUp.reset(),this._avgPacketLossDown.reset(),this._avgPacketLossTotal.reset(),this._avgRemoteFPS.reset(),this._avgRemoteScreenFPS.reset(),this._avgLocalFPS.reset(),this._avgLocalScreenFPS.reset(),this._avgRemoteCameraPixels.reset(),this._avgRemoteScreenPixels.reset(),this._avgLocalCameraPixels.reset(),this._avgLocalScreenPixels.reset(),this._avgCQ.reset(),this._sampleIdx=0}},{key:"dispose",value:function(){this._conference.off(l.P2P_STATUS,this._onP2PStatusChanged),this._conference.off(p.LOCAL_STATS_UPDATED,this._onLocalStatsUpdated),this._conference.off(l.JVB121_STATUS,this._onJvb121StatusChanged),this.jvbStatsMonitor.dispose(),this.p2pStatsMonitor.dispose()}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n(6),o=n(8),a=n(12),r=n(11),s=n.n(r),c=n(258),l=n.n(c),u=function(){function e(t){Object(i.a)(this,e),this.stats={users:{},dominantSpeakerId:null};var n=t.myUserId();this.stats.users[n]=new l.a(n,null,!0),this.conference=t,t.addEventListener(a.DOMINANT_SPEAKER_CHANGED,this._onDominantSpeaker.bind(this)),t.addEventListener(a.USER_JOINED,this._onUserJoin.bind(this)),t.addEventListener(a.USER_LEFT,this._onUserLeave.bind(this)),t.addEventListener(a.DISPLAY_NAME_CHANGED,this._onDisplayNameChange.bind(this)),t.addEventListener(a.FACIAL_EXPRESSION_ADDED,this._onFacialExpressionAdd.bind(this)),t.xmpp&&t.xmpp.addListener(s.a.SPEAKER_STATS_RECEIVED,this._updateStats.bind(this))}return Object(o.a)(e,[{key:"_onDominantSpeaker",value:function(e){var t=this.stats.users[this.stats.dominantSpeakerId],n=this.stats.users[e];t&&t.setDominantSpeaker(!1),n&&n.setDominantSpeaker(!0),this.stats.dominantSpeakerId=e}},{key:"_onUserJoin",value:function(e,t){t.isHidden()||this.stats.users[e]||(this.stats.users[e]=new l.a(e,t.getDisplayName()))}},{key:"_onUserLeave",value:function(e){var t=this.stats.users[e];t&&t.markAsHasLeft()}},{key:"_onDisplayNameChange",value:function(e,t){var n=this.stats.users[e];n&&n.setDisplayName(t)}},{key:"_onFacialExpressionAdd",value:function(e,t){var n=this.stats.users[e];n&&n.addFacialExpression(t.facialExpression,t.duration)}},{key:"getStats",value:function(){return this.stats.users}},{key:"_updateStats",value:function(e){for(var t in e){var n=void 0,i=this.conference.getParticipantById(t);i&&i.isHidden()||(this.stats.users[t]?(n=this.stats.users[t]).getDisplayName()||n.setDisplayName(e[t].displayName):(n=new l.a(t,e[t].displayName),this.stats.users[t]=n,n.markAsHasLeft())),n.totalDominantSpeakerTime=e[t].totalDominantSpeakerTime,n.setFacialExpressions(e[t].facialExpressions)}}}]),e}()},function(e,t,n){var i=n(320),o=n(521),a="before",r="recording",s="transcribing",c="finished";function l(){this.audioRecorder=new i,this.transcriptionService=new o,this.counter=null,this.startTime=null,this.transcription=null,this.callback=null,this.results=[],this.state=a,this.lineLength=0}function u(e,t){if(console.log("retrieved an answer from the transcription service. The answer has an"+" array of length: ".concat(t.wordArray.length)),t.wordArray.length>0){var n=t.startTime.getUTCMilliseconds()-e.startTime.getUTCMilliseconds();n<0&&(n=0);var i="[";t.wordArray.forEach((function(e){e.begin+=n,e.end+=n,i+="".concat(e.word,",")})),i+="]",console.log(i),t.wordArray.name=t.name}e.results.push(t.wordArray),e.counter--,console.log("current counter: ".concat(e.counter)),e.maybeMerge()}function d(e){for(var t=0;t<e.length;t++)0===e[t].length&&e.splice(t,1);return e.length>0}l.prototype.start=function(){if(this.state!==a)throw new Error("The transcription can only start when it's in the \"".concat(a,'" state. It\'s currently in the "').concat(this.state,'" state'));this.state=r,this.audioRecorder.start(),this.startTime=new Date},l.prototype.stop=function(e){var t=this;if(this.state!==r)throw new Error("The transcription can only stop when it's in the \"".concat(r,'" state. It\'s currently in the "').concat(this.state,'" state'));console.log("stopping recording and sending audio files"),this.audioRecorder.stop();var n=u.bind(null,this);this.audioRecorder.getRecordingResults().forEach((function(e){t.transcriptionService.send(e,n),t.counter++})),this.state=s,this.callback=e},l.prototype.maybeMerge=function(){this.state===s&&0===this.counter&&this.merge()},l.prototype.merge=function(){var e=this;console.log("starting merge process!\n The length of the array: ".concat(this.results.length)),this.transcription="";var t=this.results,n=[];d(t),t.forEach((function(e){return function(e,t){if(0===e.length)e.push(t);else{if(e[e.length-1].begin<=t.begin)return void e.push(t);for(var n=0;n<e.length;n++)if(t.begin<e[n].begin)return void e.splice(n,0,t);e.push(t)}}(n,e)}));for(var i=function(){var n=t[0];t.forEach((function(e){e[0].begin<n[0].begin&&(n=e)}));var i=n.shift();e.updateTranscription(i,n.name);for(var o=function(){var o=!1,a=n[0].begin;if(t.forEach((function(e){e[0].begin<a&&(o=!0)})),o)return"break";i=n.shift(),e.updateTranscription(i,null)};n.length>0;){if("break"===o())break}};d(t);)i();this.state=c,this.callback&&this.callback(this.transcription)},l.prototype.updateTranscription=function(e,t){void 0!==t&&null!==t&&(this.transcription+="\n".concat(t,":"),this.lineLength=t.length+1),this.lineLength+e.word.length>80&&(this.transcription+="\n    ",this.lineLength=4),this.transcription+=" ".concat(e.word),this.lineLength+=e.word.length+1},l.prototype.addTrack=function(e){this.audioRecorder.addTrack(e)},l.prototype.removeTrack=function(e){this.audioRecorder.removeTrack(e)},l.prototype.getTranscription=function(){if(this.state!==c)throw new Error("The transcription can only be retrieved when it's in the \"".concat(c,'" state. It\'s currently in the "').concat(this.state,'" state'));return this.transcription},l.prototype.getState=function(){return this.state},l.prototype.reset=function(){this.state=a,this.counter=null,this.transcription=null,this.startTime=null,this.callback=null,this.results=[],this.lineLength=0},e.exports=l},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var i=n(28),o=n(22).getLogger(e);function a(e){this.versions={},this.conference=e,this.conference.addCommandListener("versions",this.processVersions.bind(this))}a.prototype.processVersions=function(e,t,n){var a=this;if(this.conference.isFocus(n)){var r=[];e.children.forEach((function(e){var t=e.attributes.name,n=e.value;a.versions[t]!==n&&(a.versions[t]=n,o.info("Got ".concat(t," version: ").concat(n)),r.push({id:"component_version",component:t,version:n}))})),r.length>0&&i.a.sendLog(JSON.stringify(r))}else o.warn("Received versions not from the focus user: ".concat(e),n)},a.prototype.getComponentVersion=function(e){return this.versions[e]}}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return d}));var i=n(6),o=n(8),a=n(22),r=n(11),s=n.n(r),c=n(407),l=n(80),u=Object(a.getLogger)(e),d=function(){function e(t){Object(i.a)(this,e),this.chatRoom=t,this.eventEmitter=t.eventEmitter,u.debug("creating VideoSIPGW"),this.sessions={},this.sessionStateChangeListener=this.sessionStateChanged.bind(this),t.addPresenceListener("jibri-sip-call-state",this.handleJibriSIPState.bind(this))}return Object(o.a)(e,[{key:"handleJibriSIPState",value:function(e){var t=e.attributes;if(t){u.debug("Handle video sip gw state : ",t);var n=t.state;if(n!==this.state)switch(n){case l.STATE_ON:case l.STATE_OFF:case l.STATE_PENDING:case l.STATE_RETRYING:case l.STATE_FAILED:var i=t.sipaddress;if(!i)return;var o=this.sessions[i];o?o.setState(n,t.failure_reason):u.warn("Video SIP GW session not found:",i)}}}},{key:"createVideoSIPGWSession",value:function(e,t){if(this.sessions[e])return u.warn("There was already a Video SIP GW session for address",e),new Error(l.ERROR_SESSION_EXISTS);var n=new c.a(e,t,this.chatRoom);return n.addStateListener(this.sessionStateChangeListener),this.sessions[e]=n,n}},{key:"sessionStateChanged",value:function(e){var t=e.address;if(e.newState===l.STATE_OFF||e.newState===l.STATE_FAILED){var n=this.sessions[t];if(!n)return void u.error("Missing Video SIP GW session with address:",t);n.removeStateListener(this.sessionStateChangeListener),delete this.sessions[t]}this.eventEmitter.emit(s.a.VIDEO_SIP_GW_SESSION_STATE_CHANGED,e)}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var i=n(6),o=n(8),a=n(34),r=n(33),s=n(22),c=n(15),l=n(72),u=n(80),d=Object(s.getLogger)(e),p="STATE_CHANGED",h=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e,o,a){var r;return Object(i.a)(this,n),(r=t.call(this)).sipAddress=e,r.displayName=o,r.chatRoom=a,r.state=void 0,r}return Object(o.a)(n,[{key:"stop",value:function(){this.state!==u.STATE_OFF&&this.state!==u.STATE_FAILED?this._sendJibriIQ("stop"):d.warn("Video SIP GW session already stopped or failed!")}},{key:"start",value:function(){this.state!==u.STATE_ON&&this.state!==u.STATE_OFF&&this.state!==u.STATE_PENDING&&this.state!==u.STATE_RETRYING?this._sendJibriIQ("start"):d.warn("Video SIP GW session already started!")}},{key:"setState",value:function(e,t){if(e!==this.state){var n=this.state;this.state=e,this.eventEmitter.emit(p,{address:this.sipAddress,failureReason:t,oldState:n,newState:this.state,displayName:this.displayName})}}},{key:"addStateListener",value:function(e){this.addListener(p,e)}},{key:"removeStateListener",value:function(e){this.removeListener(p,e)}},{key:"_sendJibriIQ",value:function(e){var t=this,n={xmlns:"http://jitsi.org/protocol/jibri",action:e,sipaddress:this.sipAddress};n.displayname=this.displayName;var i=Object(c.$iq)({to:this.chatRoom.focusMucJid,type:"set"}).c("jibri",n).up();d.debug("".concat(e," video SIP GW session"),i.nodeTree),this.chatRoom.connection.sendIQ(i,(function(){}),(function(n){d.error("Failed to ".concat(e," video SIP GW session, error: "),n),t.setState(u.STATE_FAILED)}))}}]),n}(l.a)}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var i=n(14),o=n(22),a=n(63),r=n(46),s=n(28),c=Object(o.getLogger)(e);function l(){return new Promise((function(e){r.a.enumerateDevices((function(t){var n,o=t.filter((function(e){return"audioinput"===e.kind})),l=[],d=Object(i.a)(o);try{for(d.s();!(n=d.n()).done;){var p=n.value,h=r.a.obtainAudioAndVideoPermissions({devices:["audio"],micDeviceId:p.deviceId}).then((function(e){var t=e[0],n=t.getOriginalStream();return s.a.startLocalStats(n,t.setAudioLevel.bind(t)),t.addEventListener(a.LOCAL_TRACK_STOPPED,(function(){s.a.stopLocalStats(n)})),t}));l.push(h)}}catch(f){d.e(f)}finally{d.f()}Promise.allSettled(l).then((function(t){var n,o=t.filter((function(e){return"fulfilled"===e.status})),r=t.filter((function(e){return"rejected"===e.status})),s=o.map((function(e){return e.value})),l=r.map((function(e){return e.value})),d=Object(i.a)(l);try{for(d.s();!(n=d.n()).done;){var p=n.value;c.error("Failed to acquire audio device with error: ",p)}}catch(f){d.e(f)}finally{d.f()}var h,m=Object(i.a)(s);try{var v=function(){var t=h.value;t.on(a.TRACK_AUDIO_LEVEL_CHANGED,(function(n){n>.008&&(u(s),e({deviceId:t.deviceId,deviceLabel:t.track.label}))}))};for(m.s();!(h=m.n()).done;)v()}catch(f){m.e(f)}finally{m.f()}setTimeout((function(){u(s),e({deviceId:"",deviceLabel:""})}),3e3)}))}))}))}function u(e){var t,n=Object(i.a)(e);try{for(n.s();!(t=n.n()).done;){t.value.stopStream()}}catch(o){n.e(o)}finally{n.f()}}}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return v}));var i=n(5),o=n(69),a=n(6),r=n(8),s=n(22),c=n(15),l=n(20),u=n(45),d=n.n(u),p=n(46),h=n(410),f=n(111),m=Object(s.getLogger)(e),v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(a.a)(this,e);var n=t.jitsiConnection,r=Object(o.a)(t,["jitsiConnection"]);this._options=Object(i.a)({pcConfig:n&&n.xmpp.connection.jingle.p2pIceConfig},r),this._peerConnection=null,this._onFatalError=this._onFatalError.bind(this),this._onSendMessage=this._onSendMessage.bind(this),this._onRemoteStream=this._onRemoteStream.bind(this)}return Object(r.a)(e,[{key:"processMessage",value:function(e){var t=e.from;if(t)if(this._peerConnection&&this._peerConnection.getPeerJid()!==t)this._onFatalError(t,f.a.CONNECTION_ERROR,"rejected");else{var n=this._convertStringToXML(e.data.iq),i=n&&n.find("jingle"),o=i&&i.attr("action");o===f.a.INITIATE&&(this._peerConnection=this._createPeerConnection(t,{isInitiator:!1,receiveVideo:!0})),this._peerConnection&&this._peerConnection.processMessage(i),o!==f.a.CONNECTION_ERROR&&o!==f.a.UNAVAILABLE&&o!==f.a.TERMINATE||this._selfCloseConnection()}}},{key:"start",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this._peerConnection=this._createPeerConnection(e,{isInitiator:!0,receiveVideo:!1}),this._peerConnection.start(t)}},{key:"stop",value:function(){this._peerConnection&&this._peerConnection.stop(),this._peerConnection=null}},{key:"_convertStringToXML",value:function(e){try{var t=(new DOMParser).parseFromString(e,"text/xml");return $(t)}catch(n){return m.error("Attempted to convert incorrectly formatted xml"),null}}},{key:"_createPeerConnection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)throw new Error("Cannot create ProxyConnectionPC without a peer.");var n=Object(i.a)({pcConfig:this._options.pcConfig,onError:this._onFatalError,onRemoteStream:this._onRemoteStream,onSendMessage:this._onSendMessage,peerJid:e},t);return new h.a(n)}},{key:"_onFatalError",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";m.error("Received a proxy connection error",e,t,n);var i=Object(c.$iq)({to:e,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:t}).c("details").t(n).up();this._onSendMessage(e,i),this._peerConnection&&this._peerConnection.getPeerJid()===e&&this._selfCloseConnection()}},{key:"_onRemoteStream",value:function(e){if(!this._options.onRemoteStream)return m.error("Remote track received without callback."),void e.dispose();var t,n=e.isVideoTrack();n&&(t=this._options.convertVideoToDesktop?d.a.DESKTOP:d.a.CAMERA);var i=e.getOriginalStream(),o=p.a.createLocalTracks([{deviceId:"proxy:".concat(this._peerConnection.getPeerJid()),mediaType:n?l.VIDEO:l.AUDIO,sourceType:"proxy",stream:i,track:i.getVideoTracks()[0],videoType:t}]);this._options.onRemoteStream(o[0])}},{key:"_onSendMessage",value:function(e,t){if(this._options.onSendMessage)try{var n=(new XMLSerializer).serializeToString(t.nodeTree||t);this._options.onSendMessage(e,{iq:n})}catch(i){m.error("Attempted to send an incorrectly formatted iq.")}}},{key:"_selfCloseConnection",value:function(){this.stop(),this._options.onConnectionClosed&&this._options.onConnectionClosed()}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return g}));var i=n(5),o=n(6),a=n(8),r=n(22),s=n(31),c=n.n(s),l=n(11),u=n.n(l),d=n(46),p=n(194),h=n(236),f=n(78),m=n(111),v=Object(r.getLogger)(e),g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(o.a)(this,e),this._options=Object(i.a)({pcConfig:{},isInitiator:!1,receiveAudio:!1,receiveVideo:!1},t),this._tracks=[],this._peerConnection=null,this._onError=this._onError.bind(this),this._onRemoteStream=this._onRemoteStream.bind(this),this._onSendMessage=this._onSendMessage.bind(this)}return Object(a.a)(e,[{key:"getPeerJid",value:function(){return this._options.peerJid}},{key:"processMessage",value:function(e){switch(e.attr("action")){case m.a.ACCEPT:this._onSessionAccept(e);break;case m.a.INITIATE:this._onSessionInitiate(e);break;case m.a.TERMINATE:this._onSessionTerminate(e);break;case m.a.TRANSPORT_INFO:this._onTransportInfo(e)}}},{key:"start",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._peerConnection||(this._tracks=this._tracks.concat(e),this._peerConnection=this._createPeerConnection(),this._peerConnection.invite(e))}},{key:"stop",value:function(){this._peerConnection&&this._peerConnection.terminate(),this._onSessionTerminate()}},{key:"_createPeerConnection",value:function(){var e=this,t={connected:!0,jingle:{terminate:function(){}},sendIQ:this._onSendMessage,addEventListener:function(){return function(){}}},n=Object(i.a)({iceServers:f.a},this._options.pcConfig),o={addPresenceListener:function(){},connectionTimes:[],eventEmitter:{emit:function(t){switch(t){case u.a.CONNECTION_ICE_FAILED:case u.a.CONNECTION_FAILED:e._onError(m.a.CONNECTION_ERROR,t)}}},getMediaPresenceInfo:function(){return{}},removePresenceListener:function(){},supportsRestartByTerminate:function(){return!1}};this._rtc=new d.a({myUserId:function(){return""}},{}),this._rtc.addListener(c.a.REMOTE_TRACK_ADDED,this._onRemoteStream);var a=new p.a(void 0,void 0,this._options.peerJid,t,{offerToReceiveAudio:this._options.receiveAudio,offerToReceiveVideo:this._options.receiveVideo},n,!0,this._options.isInitiator);return(new h.a).setChatRoom(o),a.initialize(o,this._rtc,{}),a}},{key:"_onError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this._options.onError(this._options.peerJid,e,t)}},{key:"_onRemoteStream",value:function(e){this._tracks.push(e),this._options.onRemoteStream(e)}},{key:"_onSendMessage",value:function(e){this._options.onSendMessage(this._options.peerJid,e)}},{key:"_onSessionAccept",value:function(e){this._peerConnection?this._peerConnection.setAnswer(e):v.error("Received an answer when no peer connection exists.")}},{key:"_onSessionInitiate",value:function(e){var t=this;this._peerConnection?v.error("Received an offer when an offer was already sent."):(this._peerConnection=this._createPeerConnection(),this._peerConnection.acceptOffer(e,(function(){}),(function(){return t._onError(t._options.peerJid,m.a.CONNECTION_ERROR,"session initiate error")})))}},{key:"_onSessionTerminate",value:function(){this._tracks.forEach((function(e){return e.dispose()})),this._tracks=[],this._peerConnection&&this._peerConnection.onTerminated(),this._rtc&&(this._rtc.removeListener(c.a.REMOTE_TRACK_ADDED,this._onRemoteStream),this._rtc.destroy())}},{key:"_onTransportInfo",value:function(e){this._peerConnection.addIceCandidates(e)}}]),e}()}).call(this,"/index.js")},function(e,t,n){"use strict";t.a={error:{BUSY:"busy",ERROR:"error",RESOURCE_CONSTRAINT:"resource-constraint",UNEXPECTED_REQUEST:"unexpected-request",SERVICE_UNAVAILABLE:"service-unavailable"},mode:{FILE:"file",STREAM:"stream"},status:{OFF:"off",ON:"on",PENDING:"pending"}}},function(e,t,n){"use strict";var i=n(38),o=n.n(i),a=n(65),r=n(57),s=n.n(r),c=n(21),l=n(98),u=n(172),d=n.n(u),p=n(143),h="preCallTestResults",f=new s.a,m=!1,v=null;function g(e){if(!c.a.isReactNative())return new Promise((function(t){d.a.loadScript(e.callStatsCustomScriptUrl||p.a,!0,!0,void 0,t)}))}function b(e){return new Promise((function(t,n){var i=e.callStatsID,o=e.callStatsSecret,a=e.statisticsId||e.statisticsDisplayName||l.a.callStatsUserName;v.initialize(i,o,a,(function(e,i){"success"===e?(v.on(h,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];f.emit.apply(f,[h].concat(t))})),m=!0,t()):n({status:e,message:i})}),null,{disablePrecalltest:!0})}))}function y(){return(y=Object(a.a)(o.a.mark((function e(t){var n,i,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!m){e.next=2;break}throw new Error("Precall Test already initialized");case 2:if(n=t.callStatsID,i=t.callStatsSecret,a=t.disableThirdPartyRequests,n&&i&&!a){e.next=5;break}throw new Error("Callstats is disabled");case 5:return e.next=7,g(t);case 7:return v=new window.callstats,e.abrupt("return",b(t));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.a={init:function(e){return y.apply(this,arguments)},execute:function(){return m?new Promise((function(e,t){f.on(h,(function(n,i){"success"===n?e(i):t({status:n,payload:i})})),v.makePrecallTest()})):Promise.reject("uninitialized")}}},function(e,t){e.exports={getTokenAuthUrl:function(e,t,n){return"string"!==typeof e?null:e.replace("{room}",t).replace("{roleUpgrade}",!0===n)}}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var i=n(14),o=n(6),a=n(8),r=n(22),s=n(234),c=Object(r.getLogger)(e),l=function(){function e(){Object(o.a)(this,e),this._started=!1,this._streamsToMix=[],this._streamMSSArray=[]}return Object(a.a)(e,[{key:"addMediaStream",value:function(e){e.getAudioTracks()||c.warn("Added MediaStream doesn't contain audio tracks."),this._streamsToMix.push(e)}},{key:"start",value:function(){if(this._started)return this._mixedMSD.stream;if(this._audioContext=Object(s.a)(),!this._streamsToMix.length)return c.warn("No MediaStream's added to AudioMixer, nothing will happen."),null;this._started=!0,this._mixedMSD=this._audioContext.createMediaStreamDestination();var e,t=Object(i.a)(this._streamsToMix);try{for(t.s();!(e=t.n()).done;){var n=e.value,o=this._audioContext.createMediaStreamSource(n);o.connect(this._mixedMSD),this._streamMSSArray.push(o)}}catch(a){t.e(a)}finally{t.f()}return this._mixedMSD.stream}},{key:"reset",value:function(){this._started=!1,this._streamsToMix=[];var e,t=Object(i.a)(this._streamMSSArray);try{for(t.s();!(e=t.n()).done;){e.value.disconnect()}}catch(n){t.e(n)}finally{t.f()}this._streamMSSArray=[],this._audioContext&&(this._audioContext=void 0)}}]),e}()}).call(this,"/index.js")},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return ne})),n.d(t,"a",(function(){return oe}));var i,o,a=n(14),r=n(58),s=n(23),c=n(6),l=n(8),u=n(25),p=n(34),h=n(33),f=n(10),m=(n(84),n(56)),v=n(105),g=n(3),b=n(97),y=n(119),A=n(13),S=n(175),E=n(9),O=n(57),C=n(61),j=n.n(C),T=n(2),k=n(5),_=n(90),R=n(49),I=n(24),w=n(128),D=n(51),P=n(59),M=n(88),N=n(60),x=n(41),L=n(44),F=n.n(L),B=n(26),U=n(146),V="p_info",J="p_pose",G="p_onStage",H="p_trackSt",z="p_viewpoint",Q="main_screen_carrier",K="my_content",W=512,Y=function(){},q=function(){function e(t){Object(c.a)(this,e),this.conference=void 0,this.disposers=[],this.fragmentedMessages=[],this.fragmentedMessageHead={type:"",length:0},this.conference=t}return Object(l.a)(e,[{key:"sendAllAboutMe",value:function(e){var t;Y("sendAllAboutMe called."),this.sendPoseMessageNow(e),this.sendMouseMessageNow(),A.a.local.sendInformation(),this.sendOnStage(),this.sendTrackStates(),this.sendViewpointNow(),(null===(t=E.c.tracks.localMainConnection)||void 0===t?void 0:t.localId)&&this.sendMainScreenCarrier(!0),this.sendMyContents(),this.sendAfkChanged()}},{key:"sendPoseMessageNow",value:function(e){var t=Object(g.C)(A.a.local.pose);config.bmRelayServer?this.conference.pushOrUpdateMessageViaRelay(B.b.PARTICIPANT_POSE,t,void 0,e):this.conference.sendMessageViaJitsi(B.b.PARTICIPANT_POSE,t)}},{key:"sendMouseMessageNow",value:function(){var e=Object(g.y)(A.a.local.mouse);this.conference.sendMessage(B.b.PARTICIPANT_MOUSE,e)}},{key:"sendParticipantInfo",value:function(){var e;if(A.a.local.informationToSend){config.bmRelayServer?this.conference.sendMessage(V,Object(k.a)({},A.a.local.informationToSend)):this.conference.setLocalParticipantProperty(V,Object(k.a)({},A.a.local.informationToSend));for(var t=A.a.local.information.name;"_"===t.slice(0,1);)t=t.slice(1);null===(e=this.conference._jitsiConference)||void 0===e||e.setDisplayName(t)}}},{key:"sendOnStage",value:function(){config.bmRelayServer?this.conference.sendMessage(G,A.a.local.physics.onStage):this.conference.channelOpened&&this.conference.setLocalParticipantProperty(G,A.a.local.physics.onStage)}},{key:"sendTrackStates",value:function(){config.bmRelayServer?this.conference.sendMessage(H,Object(k.a)({},A.a.local.trackStates)):this.conference.setLocalParticipantProperty(H,Object(k.a)({},A.a.local.trackStates))}},{key:"sendViewpointNow",value:function(){config.bmRelayServer?this.conference.sendMessage(z,Object(k.a)({},A.a.local.viewpoint)):this.conference.setLocalParticipantProperty(z,Object(k.a)({},A.a.local.viewpoint))}},{key:"sendAfkChanged",value:function(){this.conference.sendMessage(B.b.PARTICIPANT_AFK,A.a.local.physics.awayFromKeyboard)}},{key:"sendTrackLimits",value:function(e,t){this.conference.sendMessage(B.b.PARTICIPANT_TRACKLIMITS,t||[A.a.local.remoteVideoLimit,A.a.local.remoteAudioLimit],e||void 0)}},{key:"sendContentUpdateRequest",value:function(e,t){!this.conference.bmRelaySocket&&t.map((function(e){return e.url?e.url.length:0})).reduce((function(e,t){return e+t}))>W?this.sendFragmentedMessage(B.b.CONTENT_UPDATE_REQUEST,t,e):this.conference.sendMessage(B.b.CONTENT_UPDATE_REQUEST,t,e)}},{key:"sendContentRemoveRequest",value:function(e,t){this.conference.sendMessage(B.b.CONTENT_REMOVE_REQUEST,t,e)}},{key:"sendLeftContentRemoveRequest",value:function(e){Object(g.b)(!config.bmRelayServer),this.conference.sendMessage(B.b.LEFT_CONTENT_REMOVE_REQUEST,e)}},{key:"sendMainScreenCarrier",value:function(e){var t,n=null===(t=E.c.tracks.localMainConnection)||void 0===t?void 0:t.getParticipantId();n&&(config.bmRelayServer?this.conference.sendMessage(Q,{carrierId:n,enabled:e}):this.conference.setLocalParticipantProperty(Q,{carrierId:n,enabled:e}))}},{key:"sendMyContents",value:function(){if(config.bmRelayServer)this.sendContentUpdateRequest("",Array.from(E.c.roomContents.values()));else{var e=Array.from(E.c.localParticipant.myContents.values()),t=Object(x.k)(e);Y("send all contents ".concat(JSON.stringify(t.map((function(e){return e.id}))),"."),t),this.conference.setLocalParticipantProperty(K,t)}}},{key:"onRoomProp",value:function(e,t){S.a.onUpdateProp(e,t)}},{key:"onParticipantTrackLimits",value:function(e){A.a.local.remoteVideoLimit=e[0],A.a.local.remoteAudioLimit=e[1]}},{key:"onParticipantLeft",value:function(e){var t;E.c.onParticipantLeft(e),M.b.participantLeft(e),A.a.leave(e),(null===(t=this.conference.bmRelaySocket)||void 0===t?void 0:t.readyState)===WebSocket.OPEN&&this.conference.sendMessage(B.b.PARTICIPANT_LEFT,[e])}},{key:"onChatMessage",value:function(e,t){Object(g.b)(e);var n=A.a.find(e);n&&M.b.addMessage(new M.a(t.msg,n.id,n.information.name,n.information.avatarSrc,n.getColor(),t.ts,t.to?"private":"text"))}},{key:"onCallRemote",value:function(e){Object(g.b)(e);var t=A.a.find(e);t&&(M.b.calledBy(t),A.a.local.information.notifyCall&&Object(U.b)(Object(I.c)("noCalled",{name:null===t||void 0===t?void 0:t.information.name}),{icon:"./favicon.ico"}))}},{key:"onAfkChanged",value:function(e,t){Object(g.b)(e);var n=A.a.find(e);n&&(n.physics.awayFromKeyboard=t)}},{key:"onKicked",value:function(e,t){var n,i=this;Object(g.b)(e),N.a.setType("kicked",null===(n=A.a.remote.get(e))||void 0===n?void 0:n.information.name,t);var o=window.localStorage.getItem("kickTimes"),a=void 0,r=[];this.conference.name&&(o&&(a=(r=JSON.parse(o)).find((function(e){return e.room===i.conference.name}))),a||(a={room:this.conference.name,time:0},r.push(a)),a.time=Date.now(),window.localStorage.setItem("kickTimes",JSON.stringify(r))),setTimeout((function(){window.location.reload()}),1e4)}},{key:"onParticipantOut",value:function(e){e.forEach((function(e){var t=A.a.find(e);t&&(t.physics.located=!1)}))}},{key:"onMouseOut",value:function(e){e.forEach((function(e){var t=A.a.find(e);t&&(t.mouse.position=[R.a,R.a])}))}},{key:"onContentOut",value:function(e){e.forEach((function(e){var t=E.c.find(e);if(t){var n=Object.assign({},t);n.pose={position:[R.a,R.a],orientation:t.pose.orientation},E.c.updateByRemoteRequest([n])}}))}},{key:"onParticipantInfo",value:function(e,t){if(Object(g.b)(e),null===P.a.testBot){var n=A.a.remote.get(e);if(n){var i=n.information.name;Object.assign(n.information,t),i!==n.information.name&&(i===D.d.name?M.b.participantJoined(e):M.b.participantNameChanged(e,i)),n.informationReceived=!0,Y("Info of ".concat(e," received."))}}}},{key:"onParticipantTrackState",value:function(e,t){if(Object(g.b)(e),null===P.a.testBot){var n=A.a.remote.get(e);n&&Object.assign(n.trackStates,t)}}},{key:"onParticipantPose",value:function(e,t){Object(g.b)(e);var n=Object(g.M)(t),i=A.a.remote.get(e),o=A.a.local;if(i&&(i.pose.orientation=n.orientation,i.pose.position=n.position,i.physics.located=!0,o.information.notifyNear||o.information.notifyTouch)){var a=Object(g.B)(Object(g.N)(i.pose.position,o.pose.position)),r=3*D.a,s=D.a;i.lastDistance>s&&a<=s&&o.information.notifyTouch?Object(U.b)(Object(I.c)("noTouched",{name:i.information.name}),{icon:"./favicon.ico"}):i.lastDistance>r&&a<r&&o.information.notifyNear&&Object(U.b)(Object(I.c)("noNear",{name:i.information.name}),{icon:"./favicon.ico"}),i.lastDistance=a}}},{key:"onParticipantMouse",value:function(e,t){Object(g.b)(e);var n=Object(g.L)(t);if(null===P.a.testBot){var i=A.a.remote.get(e);i&&Object.assign(i.mouse,n)}}},{key:"onParticipantOnStage",value:function(e,t){Object(g.b)(e);var n=A.a.remote.get(e);n&&(n.physics.onStage=t)}},{key:"onParticipantViewpoint",value:function(e,t){if(Object(g.b)(e),null===P.a.testBot){var n=A.a.remote.get(e);n&&Object.assign(n.viewpoint,t)}}},{key:"onYarnPhone",value:function(e,t){if(Object(g.b)(e),t.find((function(e){return e===A.a.localId}))){if(!A.a.yarnPhones.has(e)&&(A.a.yarnPhones.add(e),A.a.local.information.notifyYarn)){var n=A.a.find(e);n&&Object(U.b)(Object(I.c)("noYarn",{name:n.information.name}),{icon:"./favicon.ico"})}}else A.a.yarnPhones.delete(e)}},{key:"onMuteVideo",value:function(e){var t={};A.a.local.loadMediaSettingsFromStorage(t),A.a.local.muteVideo=e||t.stream.muteVideo}},{key:"onMuteAudio",value:function(e){var t={};A.a.local.loadMediaSettingsFromStorage(t),A.a.local.muteAudio=e||t.stream.muteAudio}},{key:"onReloadBrower",value:function(){window.location.reload()}},{key:"onMainScreenCarrier",value:function(e,t){Object(g.b)(e),A.a.remote.get(e)&&E.c.tracks.onMainScreenCarrier(t.carrierId,t.enabled)}},{key:"onMyContent",value:function(e,t){Object(g.b)(e);var n=Object(x.s)(t);E.c.checkDuplicatedWallpaper(e,n),E.c.replaceRemoteContents(n,e);A.a.remote.get(e);Y("recv remote contents ".concat(JSON.stringify(n.map((function(e){return e.id})))," from ").concat(e,"."),n)}},{key:"onContentInfoUpdate",value:function(e){Object(g.b)(config.bmRelayServer),e.forEach((function(e){return E.c.roomContentsInfo.set(e.id,e)}))}},{key:"onContentUpdateRequest",value:function(e){var t=Object(x.s)(e);E.c.updateByRemoteRequest(t)}},{key:"onContentRemoveRequest",value:function(e){E.c.removeByRemoteRequest(e)}},{key:"onLeftContentRemoveRequest",value:function(e){console.log("onLeftContentRemoveRequest for ".concat(e,".")),E.c.removeLeftContentByRemoteRequest(e)}},{key:"bind",value:function(){var e,t=this;this.conference.on(B.b.PARTICIPANT_TRACKLIMITS,this.onParticipantTrackLimits),this.conference.on(ne.USER_LEFT,this.onParticipantLeft.bind(this)),this.conference.on(ne.USER_JOINED,(function(e){var n,i=null===(n=t.conference._jitsiConference)||void 0===n?void 0:n.getParticipantById(e).getDisplayName();i===_.b||i===_.c||A.a.join(e)})),this.conference.on(ne.REMOTE_TRACK_ADDED,(function(e){w.a.onRemoteTrackAdded(e),A.a.addRemoteTrack(e)||E.c.tracks.addRemoteTrack(e)})),this.conference.on(ne.REMOTE_TRACK_REMOVED,(function(e){A.a.removeRemoteTrack(e)||E.c.tracks.removeRemoteTrack(e)})),this.conference.on(B.b.CHAT_MESSAGE,this.onChatMessage),this.conference.on(B.b.CALL_REMOTE,this.onCallRemote),this.conference.on(B.b.KICK,(function(e,n){var i;null===(i=t.conference._jitsiConference)||void 0===i||i.room.leave(),t.onKicked(e,n)})),this.conference.on(B.b.PARTICIPANT_AFK,this.onAfkChanged),this.conference.on(V,this.onParticipantInfo),this.conference.on(H,this.onParticipantTrackState),this.conference.on(z,this.onParticipantViewpoint),this.conference.on(B.b.PARTICIPANT_POSE,this.onParticipantPose),this.conference.on(J,this.onParticipantPose),this.conference.on(B.b.PARTICIPANT_MOUSE,this.onParticipantMouse),this.conference.on(G,this.onParticipantOnStage),this.conference.on(z,this.onParticipantViewpoint),this.conference.on(B.b.YARN_PHONE,this.onYarnPhone),this.conference.on(B.b.MUTE_VIDEO,this.onMuteVideo),this.conference.on(B.b.MUTE_AUDIO,this.onMuteAudio),this.conference.on(B.b.RELOAD_BROWSER,this.onReloadBrower),this.conference.on(B.b.UPDATE_POSE,(function(e,t){console.log("Update Pose")})),this.conference.on(Q,this.onMainScreenCarrier),this.conference.on(K,this.onMyContent),this.conference.on(B.b.CONTENT_UPDATE_REQUEST,this.onContentUpdateRequest),this.conference.on(B.b.CONTENT_REMOVE_REQUEST,this.onContentRemoveRequest),this.conference.on(B.b.LEFT_CONTENT_REMOVE_REQUEST,this.onLeftContentRemoveRequest),null===(e=this.conference._jitsiConference)||void 0===e||e.addEventListener(j.a.events.conference.DATA_CHANNEL_OPENED,(function(){t.conference.channelOpened=!0})),this.conference.on(B.b.FRAGMENT_HEAD,(function(e,n){t.fragmentedMessageHead=n,t.fragmentedMessages=[]})),this.conference.on(B.b.FRAGMENT_CONTENT,(function(e,n){if(t.fragmentedMessages[n.c]=n,t.fragmentedMessageHead.length&&t.fragmentedMessages.length===t.fragmentedMessageHead.length&&-1===t.fragmentedMessages.findIndex((function(e){return void 0===e}))){var i="";t.fragmentedMessages.forEach((function(e){return i+=e.s}));var o=JSON.parse(i);t.conference.emit(t.fragmentedMessageHead.type,e,o),t.fragmentedMessageHead={type:"",length:0},t.fragmentedMessages=[]}}))}},{key:"observeStart",value:function(){var e=this;if(this.disposers.push(Object(T.c)((function(){A.a.remote.forEach((function(t){t.called&&(t.called=!1,e.conference.sendMessage(B.b.CALL_REMOTE,{},t.id),M.b.callTo(t))}))}))),this.disposers.push(Object(T.c)(this.sendAfkChanged.bind(this))),this.disposers.push(Object(T.c)(this.sendParticipantInfo.bind(this))),this.disposers.push(Object(T.c)(this.sendTrackStates.bind(this))),config.bmRelayServer)this.disposers.push(Object(T.c)(this.sendPoseMessageNow.bind(this,!1))),this.disposers.push(Object(T.c)(this.sendMouseMessageNow.bind(this))),this.disposers.push(Object(T.c)(this.sendViewpointNow.bind(this)));else{var t=function(){return Math.ceil(Math.max(A.a.remote.size/4*50,50))},n=function(){},i=0,o="";this.disposers.push(Object(T.c)((function(){var a=t();a!==i&&(i=a,n=F.a.throttle((function(t){e.conference.channelOpened&&e.conference.sendMessage(B.b.PARTICIPANT_POSE,t)}),i));var r=Object(g.C)(A.a.local.pose);e.conference.channelOpened&&o!==r&&(n(r),o=r)})));var a=0,r="",s=function(){var n=Date.now(),i=30*t();if(n-a>i){var o=Object(g.C)(A.a.local.pose);r!==o&&(e.conference.setLocalParticipantProperty(J,o),a=n,r=o)}};s(),setInterval(s,2500);var c=0,l=function(e){};this.disposers.push(Object(T.c)((function(){!function(n){var i=t();c!==i&&(c=i,l=F.a.throttle((function(t){e.conference.sendMessage(B.b.PARTICIPANT_MOUSE,Object(g.y)(t))}),c)),e.conference.channelOpened&&l(Object(k.a)({},A.a.local.mouse))}()})));var u=function(e){};this.disposers.push(Object(T.c)((function(){!function(){var n=t();c!==n&&(c=n,u=F.a.throttle((function(t){e.conference.sendMessage(B.b.PARTICIPANT_VIEWPOINT,t)}),c)),e.conference.channelOpened&&u(Object(k.a)({},A.a.local.viewpoint))}()})))}this.disposers.push(Object(T.c)((function(){e.sendOnStage()})));this.disposers.push(Object(T.c)((function(){e.conference.channelOpened&&A.a.yarnPhoneUpdated&&(A.a.yarnPhoneUpdated=!1,e.conference.sendMessage(B.b.YARN_PHONE,Array.from(A.a.yarnPhones)))})))}},{key:"observeEnd",value:function(){this.disposers.forEach((function(e){return e()}))}},{key:"sendFragmentedMessage",value:function(e,t,n){var i=JSON.stringify(t),o={type:e,length:Math.ceil(i.length/W)};this.conference.sendMessage(B.b.FRAGMENT_HEAD,o,n);for(var a=0,r=0;r<i.length;r+=W)this.conference.sendMessage(B.b.FRAGMENT_CONTENT,{c:a,s:i.slice(r,r+W)},n),a+=1}},{key:"onBmMessage",value:function(e){Y("Receive ".concat(e.length," relayed messages."));var t,n=Object(a.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;switch(v.b.recordMessage(i),i.t){case B.b.ROOM_PROP:this.onRoomProp.apply(this,Object(r.a)(JSON.parse(i.v)));break;case B.b.REQUEST_TO:this.sendAllAboutMe(!1);break;case B.b.PARTICIPANT_AFK:this.onAfkChanged(i.p,JSON.parse(i.v));break;case B.b.CALL_REMOTE:this.onCallRemote(i.p);break;case B.b.CHAT_MESSAGE:this.onChatMessage(i.p,JSON.parse(i.v));break;case B.b.CONTENT_REMOVE_REQUEST:this.onContentRemoveRequest(JSON.parse(i.v));break;case B.b.LEFT_CONTENT_REMOVE_REQUEST:this.onLeftContentRemoveRequest(JSON.parse(i.v));break;case B.b.CONTENT_UPDATE_REQUEST:this.onContentUpdateRequest(JSON.parse(i.v));break;case B.b.CONTENT_INFO_UPDATE:this.onContentInfoUpdate(JSON.parse(i.v));break;case B.b.PARTICIPANT_MOUSE:this.onParticipantMouse(i.p,JSON.parse(i.v));break;case B.b.PARTICIPANT_POSE:this.onParticipantPose(i.p,JSON.parse(i.v));break;case B.b.PARTICIPANT_TRACKLIMITS:this.onParticipantTrackLimits(JSON.parse(i.v));break;case B.b.YARN_PHONE:this.onYarnPhone(i.p,JSON.parse(i.v));break;case B.b.RELOAD_BROWSER:this.onReloadBrower();break;case B.b.MUTE_VIDEO:this.onMuteVideo(JSON.parse(i.v));break;case B.b.MUTE_AUDIO:this.onMuteAudio(JSON.parse(i.v));break;case B.b.KICK:this.onKicked(i.p,JSON.parse(i.v));break;case B.b.PARTICIPANT_OUT:this.onParticipantOut(JSON.parse(i.v));break;case B.b.MOUSE_OUT:this.onMouseOut(JSON.parse(i.v));break;case B.b.CONTENT_OUT:this.onContentOut(JSON.parse(i.v));break;case Q:this.onMainScreenCarrier(i.p,JSON.parse(i.v));break;case K:this.onMyContent(i.p,JSON.parse(i.v));break;case V:this.onParticipantInfo(i.p,JSON.parse(i.v));break;case G:this.onParticipantOnStage(i.p,JSON.parse(i.v));break;case J:this.onParticipantPose(i.p,JSON.parse(i.v));break;case H:this.onParticipantTrackState(i.p,JSON.parse(i.v));break;case z:this.onParticipantViewpoint(i.p,JSON.parse(i.v));break;default:console.log("Unhandled message type ".concat(i.t," from ").concat(i.p))}}}catch(o){n.e(o)}finally{n.f()}this.checkInfo()}},{key:"checkInfo",value:function(){var e=Array.from(A.a.remote.values()).filter((function(e){return!e.informationReceived})).map((function(e){return e.id}));e.length&&(Y("checkInfo sent ".concat(e)),this.conference.pushOrUpdateMessageViaRelay(B.b.REQUEST_TO,e))}}]),e}(),X=function(e){},Z=function(e){},$=function(e){},ee=function(e){},te=j.a.events.conference,ne={USER_JOINED:"joined",USER_LEFT:"left",REMOTE_TRACK_ADDED:"remote_track_added",REMOTE_TRACK_REMOVED:"remote_track_removed"},ie=new Set(B.d);ie.add(B.a.CONTENT_UPDATE_REQUEST_BY_ID),ie.add(B.a.REQUEST_PARTICIPANT_STATES);var oe=(i=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this))._jitsiConference=void 0,e.name="",e.localId="",e.sync=new q(Object(u.a)(e)),Object(s.a)(e,"channelOpened",o,Object(u.a)(e)),e.bmRelaySocket=void 0,e.lastRequestTime=Date.now(),e.lastReceivedTime=Date.now(),e.messagesToSendToRelay=[],e.relayRttLast=50,e.relayRttAverage=50,e.stopStep=!1,e.localMicTrack=void 0,e.localCameraTrack=void 0,e.receivedMessages=[],Object(T.g)(Object(u.a)(e)),e}return Object(l.a)(n,[{key:"setRoomProp",value:function(e,t){this.pushOrUpdateMessageViaRelay(B.b.ROOM_PROP,[e,t]),S.a.onUpdateProp(e,t)}},{key:"init",value:function(e,t){var n,i;if(e){var o=window.localStorage.getItem("kickTimes");if(o){var a=JSON.parse(o).find((function(t){return t.room===e}));if(a){if(Date.now()-a.time<9e5)return void window.location.reload()}}}this.name=e,this._jitsiConference=t(),this.registerJistiConferenceEvents(),this.sync.bind(),null===(n=this._jitsiConference)||void 0===n||n.join(""),null===(i=this._jitsiConference)||void 0===i||i.setSenderVideoConstraint(1080),this.step(),d.conference=this,d.jc=this._jitsiConference,d.chatRoom=this._jitsiConference.room,d.showState=function(){console.log("carrierMap: ".concat(JSON.stringify(E.c.tracks.carrierMap))),console.log("contentCarriers: ".concat(JSON.stringify(E.c.tracks.contentCarriers))),console.log("remoteMains: ".concat(JSON.stringify(E.c.tracks.remoteMains.keys())))}}},{key:"uninit",value:function(){var e,t,n=this;(config.bmRelayServer&&A.a.localId&&(this.pushOrUpdateMessageViaRelay(B.b.PARTICIPANT_LEFT,[A.a.localId]),this.sendMessageViaRelay()),A.a.local.tracks.audio)&&(null===(e=this.removeTrack(A.a.local.tracks.audio))||void 0===e||e.then((function(){var e;null===(e=A.a.local.tracks.audio)||void 0===e||e.dispose()})));A.a.local.tracks.avatar&&(null===(t=this.removeTrack(A.a.local.tracks.avatar))||void 0===t||t.then((function(){var e;null===(e=A.a.local.tracks.avatar)||void 0===e||e.dispose()})));return this.sync.observeEnd(),this.stopStep=!0,new Promise((function(e,t){var i;null===(i=n._jitsiConference)||void 0===i||i.leave().then((function(t){var n,i=null!==(n=localStorage.getItem("log"))&&void 0!==n?n:"";i+="leave (".concat(t,"). "),localStorage.setItem("log",i),e(t)})).catch((function(e){t(e)})).finally((function(){n._jitsiConference=void 0}))}))}},{key:"step",value:function(){var e,t=this;if((null===(e=this.bmRelaySocket)||void 0===e?void 0:e.readyState)===WebSocket.OPEN){for(var n=Date.now()+40;Date.now()<n&&this.receivedMessages.length;){var i=this.receivedMessages.shift();i&&this.sync.onBmMessage([i])}var o=Math.min(Math.max((this.relayRttAverage-20)*A.a.remote.size/40,0)+20,3e3),a=o+2e4,r=Date.now();if(r<n&&this.bmRelaySocket&&!this.receivedMessages.length&&r-this.lastRequestTime>o&&(this.lastReceivedTime>=this.lastRequestTime||r-this.lastRequestTime>a)){this.lastRequestTime=r;var s=v.b.recording?[2*-m.b,2*m.b,2*m.b,2*-m.b]:b.b.visibleArea();this.pushOrUpdateMessageViaRelay(B.b.REQUEST_RANGE,[s,A.a.audibleArea()]),this.sendMessageViaRelay()}}this.stopStep?this.stopStep=!1:setTimeout((function(){t.step()}),50)}},{key:"doSetLocalMicTrack",value:function(e){var t;this.localMicTrack=e,this.localMicTrack.videoType="mic",null===(t=this._jitsiConference)||void 0===t||t.addTrack(this.localMicTrack)}},{key:"setLocalMicTrack",value:function(e){var t=this;return new Promise((function(n,i){var o;if(e)if(t.localMicTrack){var a,r=t.localMicTrack;null===(a=t._jitsiConference)||void 0===a||a.removeTrack(t.localMicTrack).then((function(){t.doSetLocalMicTrack(e),n(r)}))}else t.doSetLocalMicTrack(e),n(void 0);else t.localMicTrack?null===(o=t._jitsiConference)||void 0===o||o.removeTrack(t.localMicTrack).then((function(){var e=t.localMicTrack;t.localMicTrack=void 0,n(e)})):n(void 0)}))}},{key:"doSetLocalCameraTrack",value:function(e){var t;this.localCameraTrack=e,this.localCameraTrack.videoType="camera",null===(t=this._jitsiConference)||void 0===t||t.addTrack(this.localCameraTrack)}},{key:"setLocalCameraTrack",value:function(e){var t=this;return new Promise((function(n,i){var o;if(e)if(t.localCameraTrack){var a,r=t.localCameraTrack;null===(a=t._jitsiConference)||void 0===a||a.removeTrack(t.localCameraTrack).then((function(){t.doSetLocalCameraTrack(e),n(r)}))}else t.doSetLocalCameraTrack(e),n(void 0);else t.localCameraTrack?null===(o=t._jitsiConference)||void 0===o||o.removeTrack(t.localCameraTrack).then((function(){var e=t.localCameraTrack;t.localCameraTrack=void 0,n(e)})):n(void 0)}))}},{key:"getLocalMicTrack",value:function(){return this.localMicTrack}},{key:"getLocalCameraTrack",value:function(){return this.localCameraTrack}},{key:"sendCommand",value:function(e,t){var n;ee("SEND sendCommand ".concat(e," ").concat(JSON.stringify(t))),null===(n=this._jitsiConference)||void 0===n||n.sendCommand(e,t)}},{key:"removeCommand",value:function(e){var t;null===(t=this._jitsiConference)||void 0===t||t.removeCommand(e)}},{key:"addCommandListener",value:function(e,t){var n;null===(n=this._jitsiConference)||void 0===n||n.addCommandListener(e,t)}},{key:"setLocalParticipantProperty",value:function(e,t){var n;ee("SEND setLocalParticipantProperty ".concat(e," ").concat(JSON.stringify(t))),null===(n=this._jitsiConference)||void 0===n||n.setLocalParticipantProperty(e,JSON.stringify(t))}},{key:"getLocalParticipantProperty",value:function(e){var t;return null===(t=this._jitsiConference)||void 0===t?void 0:t.getLocalParticipantProperty(e)}},{key:"kickParticipant",value:function(e){var t;null===(t=this._jitsiConference)||void 0===t||t.kickParticipant(e)}},{key:"setSenderVideoConstraint",value:function(e){var t;null===(t=this._jitsiConference)||void 0===t||t.setSenderVideoConstraint(e)}},{key:"setReceiverConstraints",value:function(e){var t;null===(t=this._jitsiConference)||void 0===t||t.setReceiverConstraints(e)}},{key:"setPerceptibles",value:function(e){var t;(null===(t=this._jitsiConference)||void 0===t?void 0:t.setPerceptibles)&&this._jitsiConference.setPerceptibles(e)}},{key:"reduceBitrate",value:function(){if(config.rtc&&this._jitsiConference&&this._jitsiConference.jvbJingleSession){var e=this._jitsiConference.jvbJingleSession;if(!e.bitRateAlreadyReduced&&e.peerconnection.peerconnection)e.bitRateAlreadyReduced=!0,e.peerconnection.peerconnection.getSenders().forEach((function(e){if(e&&e.track){var t=e.getParameters();0===t.encodings.length&&t.encodings.push({}),t.encodings.forEach((function(t){"video"===e.track.kind&&config.rtc.maxBitrateForVideo?t.maxBitrate=1024*config.rtc.maxBitrateForVideo:"audio"===e.track.kind&&(t.maxBitrate=1024*config.rtc.maxBitrateForAudio)})),e.setParameters(t)}}))}}},{key:"sendMessage",value:function(e,t,n){config.bmRelayServer?this.pushOrUpdateMessageViaRelay(e,t,n):this.sendMessageViaJitsi(e,t,n)}},{key:"sendMessageViaJitsi",value:function(e,t,n){var i,o,a,r=this._jitsiConference,s=!!(null===r||void 0===r||null===(i=r.rtc)||void 0===i||null===(o=i._channel)||void 0===o?void 0:o.isOpen()),c=null===r||void 0===r||null===(a=r.chatRoom)||void 0===a?void 0:a.connection.connected;if(ee("SEND sendMessage type:".concat(e," to:").concat(n," val:").concat(JSON.stringify(t))),s||c){var l,u=s?{type:e,value:t}:JSON.stringify({type:e,value:t});null===(l=this._jitsiConference)||void 0===l||l.sendMessage(u,n||"",s)}else A.a.remote.size&&console.log("Conference.sendMessageViaJitsi() failed: Not connected.")}},{key:"connectToRelayServer",value:function(){var e=this;if(!this.bmRelaySocket){var t=function(){e.messagesToSendToRelay=[],e.sync.sendAllAboutMe(!0),e.pushOrUpdateMessageViaRelay(B.b.REQUEST_ALL,{}),e.sendMessageViaRelay()},n=function(t){if("string"===typeof t.data){e.lastReceivedTime=Date.now(),e.relayRttLast=e.lastReceivedTime-e.lastRequestTime;var n,i=JSON.parse(t.data);if(i.length)(n=e.receivedMessages).push.apply(n,Object(r.a)(i));i.length&&(e.relayRttAverage=.3*e.relayRttLast+.7*e.relayRttAverage)}},i=function(){setTimeout((function(){e.bmRelaySocket=new WebSocket(config.bmRelayServer),a()}),5e3)},o=function(){var t;console.error("Error in WebSocket for ".concat(config.bmRelayServer)),null===(t=e.bmRelaySocket)||void 0===t||t.close(3e3,"onError"),i()},a=function(){var a,r,s,c;null===(a=e.bmRelaySocket)||void 0===a||a.addEventListener("error",o),null===(r=e.bmRelaySocket)||void 0===r||r.addEventListener("message",n),null===(s=e.bmRelaySocket)||void 0===s||s.addEventListener("open",t),null===(c=e.bmRelaySocket)||void 0===c||c.addEventListener("close",i)};this.bmRelaySocket=new WebSocket(config.bmRelayServer),a()}}},{key:"pushOrUpdateMessageViaRelay",value:function(e,t,n,i){if(Object(g.b)(config.bmRelayServer),this.bmRelaySocket&&this.bmRelaySocket.readyState===WebSocket.OPEN)if(this.name&&A.a.localId){var o={t:e,v:""};i&&(o.r=this.name,o.p=A.a.localId),n&&(o.d=n);var r=this.messagesToSendToRelay.findIndex((function(e){return e.t===o.t&&e.r===o.r&&e.p===o.p&&e.d===o.d}));if(r>=0)if(ie.has(o.t)){var s,c=JSON.parse(this.messagesToSendToRelay[r].v),l=Object(a.a)(t);try{var u=function(){var e=s.value;c.findIndex((function(t){return t===e}))<0&&c.push(e)};for(l.s();!(s=l.n()).done;)u()}catch(m){l.e(m)}finally{l.f()}this.messagesToSendToRelay[r].v=JSON.stringify(c)}else if(B.c.has(o.t)){var d,p=JSON.parse(this.messagesToSendToRelay[r].v),h=Object(a.a)(t);try{var f=function(){var e=d.value,t=p.findIndex((function(t){return t.id===e.id}));t>=0?p[t]=e:p.push(e)};for(h.s();!(d=h.n()).done;)f()}catch(m){h.e(m)}finally{h.f()}this.messagesToSendToRelay[r].v=JSON.stringify(p)}else o.v=JSON.stringify(t),this.messagesToSendToRelay[r]=o;else o.v=JSON.stringify(t),this.messagesToSendToRelay.push(o);v.b.recording&&(o.p=A.a.localId,v.b.recordMessage(o))}else console.warn("Relay Socket: Not connected. room:".concat(this.name," id:").concat(A.a.localId,"."))}},{key:"sendMessageViaRelay",value:function(){var e,t,n=this;0!==this.messagesToSendToRelay.length&&((null===(e=this.bmRelaySocket)||void 0===e?void 0:e.readyState)===WebSocket.OPEN?(this.bmRelaySocket.send(JSON.stringify(this.messagesToSendToRelay)),this.messagesToSendToRelay=[]):null===(t=this.bmRelaySocket)||void 0===t||t.addEventListener("open",(function(){!function e(){var t,i;(null===(t=n.bmRelaySocket)||void 0===t?void 0:t.readyState)!==WebSocket.OPEN?setTimeout(e,100):(null===(i=n.bmRelaySocket)||void 0===i||i.send(JSON.stringify(n.messagesToSendToRelay)),n.messagesToSendToRelay=[])}()})))}},{key:"registerJistiConferenceEvents",value:function(){var e=this;this._jitsiConference?(this._jitsiConference.on(te.ENDPOINT_MESSAGE_RECEIVED,(function(t,n){$("ENDPOINT_MESSAGE_RECEIVED from ".concat(t.getId()),n),n.values?(e.emit(n.type,t.getId(),n.values),v.b.recordMessage({t:n.type,p:t.getId(),v:JSON.stringify(n.values)})):(e.emit(n.type,t.getId(),n.value),v.b.recordMessage({t:n.type,p:t.getId(),v:JSON.stringify(n.value)}))})),this._jitsiConference.on(te.PARTICIPANT_PROPERTY_CHANGED,(function(t,n,i,o){$("PARTICIPANT_PROPERTY_CHANGED from ".concat(t.getId()," prop:").concat(n," old,new:"),i,o),"codecType"!==n&&(e.emit(n,t.getId(),JSON.parse(o),i),v.b.recordMessage({t:n,p:t.getId(),v:o}))})),this._jitsiConference.on(te.CONFERENCE_JOINED,(function(){Z("Joined to a conference room."),e.onConferenceJoined()})),this._jitsiConference.on(te.USER_JOINED,(function(t,n){Z("New participant[".concat(t,"] joined.")),e.emit(ne.USER_JOINED,t,n)})),this._jitsiConference.on(te.USER_LEFT,(function(t,n){e.emit(ne.USER_LEFT,t,n),Z("A participant left.")})),this._jitsiConference.on(te.TRACK_ADDED,(function(t){X("TRACK_ADDED: ".concat(t," type:").concat(t.getType()," usage:").concat(t.getUsageLabel()," tid:").concat(t.getId()," msid:").concat(t.getOriginalStream().id)),t.isLocal()?e.onLocalTrackAdded(t):(e.emit(ne.REMOTE_TRACK_ADDED,t),setTimeout((function(){e.reduceBitrate()}),3e3))})),this._jitsiConference.on(te.TRACK_REMOVED,(function(t){X("TRACK_REMOVED: ".concat(t," type:").concat(t.getType()," ").concat(t.getUsageLabel()," tid:").concat(t.getId()," msid:").concat(t.getOriginalStream().id)),t.isLocal()?e.onLocalTrackRemoved(t):e.emit(ne.REMOTE_TRACK_REMOVED,t)})),this._jitsiConference.on(te.REMOTE_TRACK_VIDEOTYPE_CHANGING,(function(e,t){A.a.removeRemoteTrack(e)})),this._jitsiConference.on(te.REMOTE_TRACK_VIDEOTYPE_CHANGED,(function(e,t){A.a.addRemoteTrack(e)})),this._jitsiConference.on(te.TRACK_MUTE_CHANGED,(function(e){if(X("TRACK_MUTE_CHANGED on ".concat(e,".")),!e.isLocal()){var t=e,n=A.a.find(t.getParticipantId());n&&t.isVideoTrack()&&(n.muteVideo=t.isMuted())}})),this._jitsiConference.on(j.a.events.conference.TRACK_AUDIO_LEVEL_CHANGED,(function(e,t){var n=y.a.find(e);n&&(n===y.a.local&&n.muteAudio?null===n||void 0===n||n.setAudioLevel(0):null===n||void 0===n||n.setAudioLevel(t))})),this._jitsiConference.on(j.a.events.conference.PRIVATE_MESSAGE_RECEIVED,(function(e,t,n){$("PRIVATE_MESSAGE_RECEIVED",e,t,n)})),this._jitsiConference.on(j.a.events.conference.MESSAGE_RECEIVED,(function(e,t,n){$("MESSAGE_RECEIVED",e,t,n)})),this._jitsiConference.on(j.a.events.connectionQuality.LOCAL_STATS_UPDATED,(function(e){A.a.local.quality=e})),this._jitsiConference.on(j.a.events.connectionQuality.REMOTE_STATS_UPDATED,(function(e,t){var n=A.a.remote.get(e);n&&(n.quality=t)})),this._jitsiConference.on(j.a.events.conference.KICKED,(function(t,n){e.sync.onKicked(t.getId(),n)}))):console.error("Dose not connected to conference yet.")}},{key:"onConferenceJoined",value:function(){for(var e in this.localId=this._jitsiConference.myUserId(),A.a.setLocalId(this.localId),this.sync.observeStart(),A.a.local.devicePreference)void 0===A.a.local.devicePreference[e]&&(A.a.local.devicePreference[e]="");config.bmRelayServer||setTimeout(E.c.loadWallpaper.bind(E.c),2e3),config.bmRelayServer&&this.connectToRelayServer()}},{key:"onLocalTrackAdded",value:function(e){var t=A.a.local;e.isAudioTrack()?(t.muteAudio?e.mute():e.unmute(),t.tracks.audio=e):(t.tracks.avatar=e,t.muteVideo&&this.removeTrack(e))}},{key:"onLocalTrackRemoved",value:function(e){var t=A.a.local;e.isAudioTrack()?t.tracks.audio=void 0:t.tracks.avatar=void 0}},{key:"getLocalTracks",value:function(e){return this._jitsiConference?this._jitsiConference.getLocalTracks(e):[]}},{key:"getLocalVideoTrack",value:function(){return this._jitsiConference?this._jitsiConference.getLocalVideoTrack():null}},{key:"replaceTrack",value:function(e,t){this._jitsiConference&&this._jitsiConference.replaceTrack(e,t)}},{key:"removeTrack",value:function(e){var t;return null===(t=this._jitsiConference)||void 0===t?void 0:t.removeTrack(e)}},{key:"removeTracks",value:function(e){var t=this;e.forEach((function(e){var n;return null===(n=t._jitsiConference)||void 0===n?void 0:n.removeTrack(e)}))}},{key:"addTrack",value:function(e){var t;null===(t=this._jitsiConference)||void 0===t||t.addTrack(e)}},{key:"addTracks",value:function(e){var t,n=Object(a.a)(e);try{for(n.s();!(t=n.n()).done;){var i,o,r=t.value;if(r!==e[e.length-1])null===(i=this._jitsiConference)||void 0===i||i.addTrack(r);else null===(o=this._jitsiConference)||void 0===o||o.addTrack(r).then((function(){}))}}catch(s){n.e(s)}finally{n.f()}}}]),n}(O.EventEmitter),o=Object(f.a)(i.prototype,"channelOpened",[T.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),i)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t),function(e){var i=n(14),o=n(69),a=n(22),r=n.n(a),s=n(66),c=n(12),l=n(350),u=n(131),d=n(82),p=n(259),h=n(162),f=n(74),m=n(53),v=n(63),g=n(229),b=n(46),y=n(21),A=n(178),S=n(173),E=n(408),O=n(77),C=n(233),j=n(73),T=n(409),k=n(411),_=n(98),R=n(226),I=n(412),w=n(28),D=n(413),P=n.n(D),M=n(43),N=n.n(M),x=n(172),L=n.n(x),F=n(80),B=n(414),U=n(20),V=n(104),J=n(235),G=n(35),H=r.a.getLogger(e);function z(e){var t={audio_requested:e.devices.includes("audio"),video_requested:e.devices.includes("video"),screen_sharing_requested:e.devices.includes("desktop")};return t.video_requested&&(t.resolution=e.resolution),t}t.default=function(e){return"object"===typeof window.JitsiMeetJS?Object.assign({},window.JitsiMeetJS,e):e}({version:"{#COMMIT_HASH#}",JitsiConnection:l.a,ProxyConnectionService:T.a,constants:{participantConnectionStatus:S.a,recording:k.a,sipVideoGW:F,transcriptionStatus:g},events:{conference:c,connection:d,detection:O,track:v,mediaDevices:h,connectionQuality:V,e2eping:J},errors:{conference:s,connection:u,track:m},errorTypes:{JitsiTrackError:f.a},logLevels:r.a.levels,mediaDevices:p.a,analytics:w.a.analytics,init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(_.a.init(e.externalStorage),w.a.init(e),j.a.init({sourceNameSignaling:e.sourceNameSignaling}),window.connectionTimes||(window.connectionTimes={}),!0!==e.enableAnalyticsLogging&&(H.warn("Analytics disabled, disposing."),this.analytics.dispose()),e.enableWindowOnErrorHandler&&N.a.addHandler(this.getGlobalOnErrorHandler.bind(this)),this.version){var t={id:"component_version",component:"lib-jitsi-meet",version:this.version};w.a.sendLog(JSON.stringify(t))}return b.a.init(e)},isDesktopSharingEnabled:function(){return b.a.isDesktopSharingEnabled()},isWebRtcSupported:function(){return b.a.isWebRtcSupported()},setLogLevel:function(e){r.a.setLogLevel(e)},setLogLevelById:function(e,t){r.a.setLogLevelById(e,t)},addGlobalLogTransport:function(e){r.a.addGlobalTransport(e)},removeGlobalLogTransport:function(e){r.a.removeGlobalTransport(e)},setGlobalLogOptions:function(e){r.a.setGlobalOptions(e)},createLocalTracks:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,a=!1,r=t.firePermissionPromptIsShownEvent,s=t.fireSlowPromiseEvent,c=Object(o.a)(t,["firePermissionPromptIsShownEvent","fireSlowPromiseEvent"]),l=r||n;return l&&!b.a.arePermissionsGrantedForAvailableDevices()?p.a.emitEvent(h.PERMISSION_PROMPT_IS_SHOWN,y.a.getName()):s&&window.setTimeout((function(){a||p.a.emitEvent(h.SLOW_GET_USER_MEDIA)}),1e3),window.connectionTimes||(window.connectionTimes={}),window.connectionTimes["obtainPermissions.start"]=window.performance.now(),b.a.obtainAudioAndVideoPermissions(c).then((function(t){if(a=!0,window.connectionTimes["obtainPermissions.end"]=window.performance.now(),w.a.sendAnalytics(Object(G.F)("success",z(c))),!b.a.options.disableAudioLevels)for(var n=function(e){var n=t[e],i=n.getOriginalStream();n.getType()===U.AUDIO&&(w.a.startLocalStats(i,n.setAudioLevel.bind(n)),n.addEventListener(v.LOCAL_TRACK_STOPPED,(function(){w.a.stopLocalStats(i)})))},o=0;o<t.length;o++)n(o);var r=b.a.getCurrentlyAvailableMediaDevices();if(r)for(var s=0;s<t.length;s++){t[s]._setRealDeviceIdFromDeviceList(r)}var l,u=Object(i.a)(t);try{for(u.s();!(l=u.n()).done;){var d=l.value;d.type===U.VIDEO&&"desktop"===d.videoType&&e.setVideoTrackContentHints(d.track,"detail")}}catch(p){u.e(p)}finally{u.f()}return t})).catch((function(e){if(a=!0,e.name===m.SCREENSHARING_USER_CANCELED){var n={id:"screensharing_user_canceled",message:e.message};w.a.sendLog(JSON.stringify(n)),w.a.sendAnalytics(Object(G.F)("warning",{reason:"extension install user canceled"}))}else if(e.name===m.NOT_FOUND){var i={id:"usermedia_missing_device",status:e.gum.devices};w.a.sendLog(JSON.stringify(i));var o=z(t);o.reason="device not found",o.devices=e.gum.devices.join("."),w.a.sendAnalytics(Object(G.F)("error",o))}else{w.a.sendGetUserMediaFailed(e);var r=z(t);r.reason=e.name,w.a.sendAnalytics(Object(G.F)("error",r))}return window.connectionTimes["obtainPermissions.end"]=window.performance.now(),Promise.reject(e)}))},createTrackVADEmitter:function(e,t,n){return C.a.create(e,t,n)},createAudioMixer:function(){return new B.a},getActiveAudioDevice:function(){return Object(E.a)()},isDeviceListAvailable:function(){return H.warn("This method is deprecated, use JitsiMeetJS.mediaDevices.isDeviceListAvailable instead"),this.mediaDevices.isDeviceListAvailable()},isDeviceChangeAvailable:function(e){return H.warn("This method is deprecated, use JitsiMeetJS.mediaDevices.isDeviceChangeAvailable instead"),this.mediaDevices.isDeviceChangeAvailable(e)},isMultipleAudioInputSupported:function(){return this.mediaDevices.isMultipleAudioInputSupported()},isCollectingLocalStats:function(){return w.a.audioLevelsEnabled&&R.a.isLocalStatsSupported()},enumerateDevices:function(e){H.warn("This method is deprecated, use JitsiMeetJS.mediaDevices.enumerateDevices instead"),this.mediaDevices.enumerateDevices(e)},getGlobalOnErrorHandler:function(e,t,n,i,o){H.error("UnhandledError: ".concat(e),"Script: ".concat(t),"Line: ".concat(n),"Column: ".concat(i),"StackTrace: ",o),w.a.reportGlobalError(o)},setNetworkInfo:function(e){var t=e.isOnline;A.b.updateNetworkInfo({isOnline:t})},setVideoTrackContentHints:function(e,t){"contentHint"in e?(e.contentHint=t,e.contentHint!==t&&H.debug("Invalid video track contentHint")):H.debug("MediaStreamTrack contentHint attribute not supported")},precallTest:I.a,util:{AuthUtil:P.a,ScriptUtil:L.a,browser:y.a}})}.call(this,"/index.js")},,,,function(e,t){e.exports={LOCAL_JID:"local"}},,,,,,,,,,,,,function(e,t){e.exports=function(e,t,n,i){this.blob=e,this.name=t,this.startTime=n,this.wordArray=i}},function(e,t,n){var i=n(522),o=n(320),a=n(523),r=function(){this.url=function(){var e="config does not contain an url to a Sphinx4 https server";if(void 0===config.sphinxURL)console.log(e);else{var t=config.sphinxURL;if(void 0!==t.includes&&t.includes("https://"))return t;console.log(e)}}()};r.prototype=Object.create(a.prototype),r.constructor=r,r.prototype.sendRequest=function(e,t){console.log("sending an audio file  to ".concat(this.url)),console.log("the audio file being sent: ".concat(e));var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE&&200===n.status)t(n.responseText);else if(n.readyState===XMLHttpRequest.DONE)throw new Error("unable to accept response from sphinx server. status: ".concat(n.status))},n.open("POST",this.url),n.setRequestHeader("Content-Type",o.determineCorrectFileType()),n.send(e),console.log("send ".concat(e))},r.prototype.formatResponse=function(e){var t=JSON.parse(e).objects;t.shift();var n=[];return t.forEach((function(e){return e.filler||n.push(new i(e.word,e.start,e.end))})),n},r.prototype.verify=function(e){if(console.log("response from server:".concat(e.toString())),"string"!==typeof e)return!1;var t;try{t=JSON.parse(e)}catch(i){return console.log(i),!1}if(void 0===t.objects)return!1;var n=t.objects;return!(!n[0]||!n[0]["session-id"])},e.exports=r},function(e,t){var n=function(e,t,n){this.word=e,this.begin=t,this.end=n};n.prototype.getWord=function(){return this.word},n.prototype.getBeginTime=function(){return this.begin},n.prototype.getEndTime=function(){return this.end},e.exports=n},function(e,t){var n=function(){throw new Error("TranscriptionService is abstract and cannot becreated")};n.prototype.send=function(e,t){var n=this;this.sendRequest(e.blob,(function(i){n.verify(i)?e.wordArray=n.formatResponse(i):(console.log("the retrieved response from the server is not valid!"),e.wordArray=[]),t(e)}))},n.prototype.sendRequest=function(e,t){throw new Error("TranscriptionService.sendRequest is abstract")},n.prototype.formatResponse=function(e){throw new Error("TranscriptionService.format is abstract")},n.prototype.verify=function(e){throw new Error("TranscriptionService.verify is abstract")},e.exports=n},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);var i=n(19),o=n(59),a=n(3),r=n(88),s=n(60),c=n(97),l=n(13),u=n(175),p=n(9),h=n(18),f=n(0),m=n.n(f),v=n(199),g=n(14),b=n(6),y=n(5),A=n(738),S=n(714),E=n(742),O=n(711),C=n(716),j=n(24),T=n(1),k=function(){Object(f.useEffect)((function(){c.b.keyInputUsers.add("AfkDialog")}));var e=function(e){c.b.keyInputUsers.delete("AfkDialog");var t=e;t.code&&(t.preventDefault(),t.stopPropagation()),s.a.clear()};return Object(T.jsx)(J,{onClose:e,children:Object(T.jsx)(O.a,{style:{fontSize:Object(a.x)()?"2em":"1em"},children:Object(T.jsx)(S.a,{color:"primary",variant:"contained",style:{textTransform:"none"},autoFocus:!0,onKeyDown:e,onClick:e,children:Object(j.c)("afkMessage")})})})};k.displayName="AfkDialog";var _="./static/media/whoo-screen_chat.52e62a85.png",R="./static/media/people_login.db1eab64.png",I="data:image/png;base64,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",w="data:image/png;base64,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",D=n(715),P=n(744),M=n(418),N=n.n(M),x=[["Able","Absent","Absolute","Abstract","Absurd","Academic","Acceptable","Accessible","Accountable","Accurate","Acid","Active","Actual","Acute","Additional","Adequate","Adjacent","Administrative","Adult","Advance","Advanced","Adverse","Aesthetic","Affordable","Afraid","Aged","Agricultural","Alert","Alien","Alike","Alive","Alone","Alternative","Amateur","Amazed","Amazing","Ambitious","Amusing","Ancient","Angry","Annoyed","Annoying","Annual","Anonymous","Anxious","Apparent","Appealing","Applicable","Appropriate","Arbitrary","Architectural","Artificial","Artistic","Ashamed","Asleep","Assistant","Associated","Astonishing","Attractive","Audio","Authentic","Automatic","Available","Average","Aware","Awful","Awkward","Back","Bad","Balanced","Bare","Based","Basic","Beautiful","Beloved","Beneficial","Bent","Best","Better","Big","Biological","Bitter","Bizarre","Blank","Blind","Blonde","Blue","Bold","Bored","Boring","Bottom","Bound","Brave","Brief","Bright","Brilliant","Broad","Broken","Brown","Busy","Calm","Capable","Capital","Capitalist","Careful","Careless","Casual","Cautious","Central","Certain","Challenging","Characteristic","Charming","Cheap","Cheerful","Chemical","Chief","Chronic","Civic","Civil","Civilian","Classic","Classical","Clean","Clear","Clever","Clinical","Close","Closed","Coastal","Cognitive","Cold","Collective","Colonial","Coloured","Colourful","Comfortable","Comic","Commercial","Common","Communist","Comparable","Comparative","Compelling","Competent","Competitive","Complete","Complex","Complicated","Comprehensive","Compulsory","Concerned","Concrete","Confident","Confused","Confusing","Congressional","Connected","Conscious","Consecutive","Conservative","Considerable","Consistent","Constant","Constitutional","Contemporary","Content","Continuous","Contrary","Controversial","Convenient","Conventional","Convinced","Convincing","Cool","Cooperative","Core","Corporate","Correct","Corresponding","Costly","Countless","Covered","Cream","Creative","Credible","Critical","Crowded","Crucial","Crude","Cruel","Cult","Cultural","Curious","Curly","Current","Curved","Cute","Cynical","Daily","Dairy","Damaging","Dangerous","Dark","Dead","Dear","Decent","Decisive","Dedicated","Deep","Defensive","Definite","Deliberate","Delicate","Delicious","Delighted","Democratic","Dense","Dependent","Depressed","Depressing","Desirable","Desperate","Destructive","Detailed","Determined","Different","Difficult","Digital","Diplomatic","Direct","Dirty","Disabled","Disappointed","Disappointing","Disastrous","Dishonest","Distant","Distinct","Distinctive","Disturbing","Diverse","Divine","Divorced","Domestic","Dominant","Double","Downstairs","Downtown","Dramatic","Dressed","Driving","Dry","Dual","Due","Dull","Dumb","Dynamic","Eager","Early","East","Eastern","Easy","Ecological","Economic","Editorial","Educated","Educational","Effective","Efficient","Elaborate","Elderly","Electoral","Electric","Electrical","Electronic","Elegant","Elementary","Eligible","Embarrassed","Embarrassing","Emotional","Empirical","Empty","Encouraging","Endless","Engaged","Engaging","Enjoyable","Enormous","Entertaining","Enthusiastic","Entire","Environmental","Equal","Equivalent","Essential","Eternal","Ethical","Ethnic","Even","Everyday","Evident","Evil","Evolutionary","Exact","Excellent","Exceptional","Excess","Excessive","Excited","Exciting","Exclusive","Executive","Exotic","Expected","Expensive","Experienced","Experimental","Expert","Explicit","Explosive","Extensive","External","Extra","Extraordinary","Extreme","Fabulous","Failed","Fair","Fake","False","Familiar","Family","Famous","Fancy","Fantastic","Far","Fascinating","Fashionable","Fast","Fat","Fatal","Favourable","Favourite","Federal","Fellow","Feminist","Few","Fierce","Final","Financial","Fine","Firm","Fit","Fixed","Flat","Flawed","Flexible","Flying","Folding","Folk","Following","Fond","Foreign","Formal","Former","Forthcoming","Fortunate","Forward","Fragile","Free","Frequent","Fresh","Friendly","Frightened","Frightening","Front","Frozen","Frustrated","Frustrating","Full","FullTime","Fun","Functional","Fundamental","Funny","Furious","Further","Future","General","Generic","Generous","Genetic","Gentle","Genuine","Giant","Glad","Global","Glorious","Gold","Golden","Good","Gorgeous","Grand","Graphic","Grateful","Grave","Great","Green","Grey","Gross","Guilty","Handy","Happy","Hard","Harmful","Harsh","Healthy","Heavy","Helpful","Hidden","High","HighProfile","Hilarious","Historic","Historical","Hollow","Holy","Home","Homeless","Honest","Hopeful","Horrible","Hot","Huge","Human","Humanitarian","Humble","Humorous","Hungry","Hurt","Ideal","Identical","Ideological","Ill","Illegal","Imaginary","Immediate","Immense","Imminent","Immune","Impatient","Important","Impossible","Impressed","Impressive","Inadequate","Inappropriate","Inclined","Included","Incorrect","Incredible","Independent","Indigenous","Indirect","Individual","Indoor","Industrial","Inevitable","Infamous","Influential","Informal","Inherent","Initial","Injured","Inner","Innocent","Innovative","Inside","Instant","Institutional","Instrumental","Insufficient","Intact","Integral","Integrated","Intellectual","Intelligent","Intended","Intense","Intensive","Interactive","Interested","Interesting","Interim","Interior","Intermediate","Internal","International","Intimate","Intriguing","Invisible","Involved","Ironic","Irrelevant","Isolated","Joint","Judicial","Junior","Just","Keen","Key","Kind","Large","LargeScale","Late","Later","Latest","Latter","Lazy","Leading","Left","Legal","Legendary","Legislative","Legitimate","Lengthy","Lesser","Level","Liable","Liberal","Lifelong","Light","Likely","Limited","Linear","Liquid","Literary","Little","Live","Lively","Living","Local","Located","Logical","Lonely","Long","LongStanding","LongTerm","LongTime","Loose","Lost","Loud","Lovely","Low","Loyal","Lucky","Luxury","Mad","Magic","Magical","Magnetic","Magnificent","Main","Mainstream","Major","Mandatory","Marginal","Marine","Married","Martial","Mass","Massive","Matching","Material","Mathematical","Mature","Maximum","Meaningful","Mechanical","Medical","Medieval","Medium","Memorable","Mental","Mere","Middle","Mild","Minimal","Minimum","Minute","Miserable","Misleading","Missing","Mixed","Mobile","Moderate","Modern","Modest","Monthly","Moral","Motor","Moving","Multiple","Municipal","Musical","Mutual","Mysterious","Narrative","Narrow","National","Nationwide","Native","Natural","Naval","Near","Nearby","Neat","Necessary","Negative","Neighbouring","Nervous","Net","Neutral","New","Next","Nice","Noble","Noisy","NonProfit","Normal","North","Northern","Notable","Notorious","Novel","Nuclear","Numerous","Objective","Obvious","Occasional","Odd","Offensive","Official","Ok","Old","OldFashioned","Ongoing","Online","Only","Open","Operational","Opposed","Opposite","Optical","Optimistic","Orange","Ordinary","Organic","Organizational","Organized","Original","Other","Outdoor","Outer","Outside","Outstanding","Overall","Overseas","Overwhelming","Own","Painful","Pale","Parallel","Parental","Parliamentary","PartTime","Partial","Particular","Passionate","Passive","Past","Patient","Peaceful","Peculiar","Perfect","Permanent","Persistent","Personal","Philosophical","Physical","Pink","Plain","Plastic","Pleasant","Pleased","Plus","Pointed","Poisonous","Polite","Political","Poor","Pop","Popular","Positive","Possible","PostWar","Potential","Powerful","Practical","Precious","Precise","Predictable","Preliminary","Premier","Prepared","Present","Presidential","Prestigious","Pretty","Previous","Primary","Prime","Principal","Prior","Private","Probable","Problematic","Productive","Professional","Profitable","Profound","Progressive","Prominent","Promising","Pronounced","Proper","Prospective","Protective","Proud","Provincial","Psychiatric","Psychological","Public","Pure","Purple","Qualified","Quick","Quiet","Radical","Random","Rapid","Rare","Rational","Raw","Ready","Real","Realistic","Rear","Reasonable","Recent","Red","Regional","Regular","Regulatory","Related","Relative","Relaxed","Relaxing","Relevant","Reliable","Relieved","Religious","Reluctant","Remarkable","Remote","Renowned","Repeated","Representative","Resident","Residential","Respective","Responsible","Retired","Reverse","Revolutionary","Rich","Ridiculous","Right","Risky","Rival","Robust","Romantic","Rough","Round","Routine","Royal","Rubber","Rude","Rural","Sacred","Sad","Safe","Same","Satisfied","Scary","Scattered","Sceptical","Scientific","Secondary","Secret","Secular","Secure","Selective","Senior","Sensible","Sensitive","Separate","Serial","Serious","Severe","Shallow","Shaped","Sharp","Sheer","Shiny","Shocked","Shocking","Short","ShortTerm","Shut","Shy","Significant","Silent","Silly","Silver","Similar","Simple","Sincere","Single","Situated","Ski","Skilled","Slight","Slow","Small","Smart","Smooth","SoCalled","Social","Socialist","Soft","Solar","Sole","Solid","Solo","Sophisticated","Sound","South","Spare","Special","Specialist","Specialized","Specific","Spectacular","Spicy","Spiritual","Spoken","Sporting","Square","Stable","Standard","Standing","Stark","State","Statistical","Steady","Steep","Sticky","Stiff","Still","Straight","Straightforward","Strange","Strategic","Strict","Striking","Strong","Structural","Stunning","Subject","Subsequent","Substantial","Subtle","Suburban","Successful","Successive","Sudden","Sufficient","Suitable","Super","Superb","Superior","Supportive","Supreme","Sure","Surgical","Surprised","Surprising","Surrounding","Suspicious","Sustainable","Sweet","Symbolic","Sympathetic","Systematic","Tactical","Talented","Tall","Technical","Technological","Temporary","Tender","Terminal","Terrible","Terrific","Theatrical","Theoretical","Thick","Thin","Thirsty","Thorough","ThoughtProvoking","Thoughtful","Thrilled","Tidy","Tight","Timely","Tiny","Tired","Top","Total","Tough","Toxic","Toy","Traditional","Transparent","Tremendous","Tribal","Tropical","True","Twin","Typical","Ultimate","Unable","Unacceptable","Uncomfortable","Underground","Underlying","Unemployed","Unexpected","Unfair","Unfortunate","Unique","United","Universal","Unknown","Unlikely","Unnecessary","Unpleasant","Unprecedented","Unusual","Upcoming","Upper","Upset","Upstairs","Urban","Urgent","Used","Useful","Useless","Usual","Vague","Valid","Valuable","Variable","Varied","Various","Vast","Verbal","Vertical","Very","Viable","Vibrant","Virtual","Visible","Visual","Vital","Vocal","Voluntary","Vulnerable","Warm","Waste","Weak","Wealthy","Weekly","Weird","Welcome","Well","West","Western","Wet","White","Whole","Wide","Widespread","Wild","Willing","Wise","Wonderful","Wooden","Working","Worldwide","Worried","Worse","Worst","Worth","Worthwhile","Worthy","Written","Wrong","Yellow"],["About","Above","Abroad","Absently","Absolutely","Accidentally","Accordingly","Accurately","Accusingly","Across","Actually","Additionally","Adequately","Adorably","After","Afterwards","Again","Ago","Ahead","Alike","All","Allegedly","AllTheTime","Almost","Alone","Along","Already","Also","Altogether","Always","Amazingly","Angrily","Annually","Anxiously","Any","Anyway","Anywhere","Apart","Appallingly","Apparently","Appropriately","Approximately","Arguably","Around","Articulately","As","Aside","Astonishingly","Automatically","Away","Back","Backwards","Badly","Barely","Basically","Beautifully","Before","Behind","Below","Besides","Best","Better","Between","Beyond","Blindly","Bravely","Briefly","Brightly","Briskly","Broadly","By","Calmly","Carefully","Casually","Cautiously","Certainly","Cheaply","Clearly","Cleverly","Close","Closely","Commonly","Completely","Consequently","Considerably","Consistently","Constantly","Continually","Correctly","Crazily","Critically","Curiously","Currently","Cynically","Daily","Dangerously","Deeply","Definitely","Deliberately","Delicately","Desperately","Differently","Directly","Discreetly","Double","Down","Downstairs","Downtown","Downwards","Dramatically","Each","Eagerly","Early","Easily","East","Effectively","Efficiently","Either","Else","Elsewhere","Emotionally","Enough","Entirely","Equally","Especially","Essentially","Euphoricly","Even","Evenly","Eventually","Ever","Everywhere","Exactly","Exclusively","Expectantly","Explicitly","Extensively","Extra","Extremely","Fairly","Far","Fast","Ferociously","Fiercely","Finally","Finely","Firmly","First","Firstly","Flatly","Forever","Formerly","Forth","Fortunately","Forward","Frankly","Free","Freely","Frequently","Frighteningly","FullTime","Fully","Fundamentally","Further","Furthermore","Generally","Gently","Genuinely","Gloriously","Gradually","Greatly","Grimly","Guiltily","Half","Halfway","Happily","Hard","Hardly","Hastily","Heavily","Hence","Here","Heroically","High","Highly","Home","Hopefully","Hourly","How","However","Humbly","Hysterically","Immediately","Immensely","Impartially","Impolitely","In","Increasingly","Incredibly","Indeed","Indifferently","Indoors","Inevitably","Initially","Inside","Instantly","Instead","Intensely","Ironically","Jealously","Jovially","Just","Kindly","Largely","Last","Late","Lately","Later","Lazily","Least","Left","Less","Lightly","Likewise","Literally","Little","Live","Long","LongTerm","Lot","Loud","Loudly","Lovingly","Low","Loyally","Magnificently","Mainly","Maybe","Meanwhile","Merely","Merrily","Mightily","Miserably","More","Moreover","Most","Mostly","Much","Mysteriously","Namely","Naturally","Near","Nearby","Nearly","Necessarily","Neither","Nervously","Never","Nevertheless","Newly","Next","Nicely","Nonetheless","Nor","Normally","North","Not","NOT","Notably","Now","Nowadays","Nowhere","Objectively","Obnoxiously","Obsessively","Obviously","Occasionally","Off","Often","Ok","On","Once","Online","Only","Openly","Opposite","Originally","Otherwise","Out","Outdoors","Outside","Over","Overall","Overly","Overnight","Overseas","Painfully","Partially","Particularly","Partly","Past","Patiently","Perfectly","Perhaps","Permanently","Personally","Playfully","Politely","Poorly","Possibly","Potentially","Precisely","Predominantly","Presently","Presumably","Pretty","Previously","Primarily","Probably","Promptly","Properly","Purely","Quickly","Quietly","Quite","Randomly","Rapidly","Rarely","Rather","Readily","Really","Reasonably","Recently","Recklessly","Regardless","Regularly","Relatively","Remarkably","Remorsefully","Reportedly","Respectively","Responsibly","Right","Roughly","Round","Rudely","Ruthlessly","Sadly","Same","Scornfully","Seamlessly","Second","Secondly","Seemingly","Seldom","Selfishly","Seriously","Severely","Shakily","Sharply","Shortly","Sideways","Significantly","Silently","Similarly","Simply","Simultaneously","Since","Sleepily","Slightly","Slowly","Slyly","Smoothly","So","Softly","Solely","Solemnly","Somehow","Sometime","Sometimes","Somewhat","Somewhere","Soon","South","Specifically","Steadily","Sternly","Still","Straight","Strangely","Strictly","Strongly","Stunningly","Subsequently","Substantially","Successfully","Suddenly","Sufficiently","Supposedly","Sure","Surely","Temporarily","Tenderly","Terribly","Thankfully","That","Then","There","Thereafter","Thereby","Therefore","This","Thoroughly","Though","Thoughtfully","Through","Throughout","Thus","Tightly","Today","Together","Tomorrow","Tonight","Too","Totally","Truly","Twice","Typically","Ultimately","Under","Underground","Undoubtedly","Uneasily","Unfortunately","Up","Upstairs","Upwards","Usually","Utterly","Vanishingly","Very","Warmly","Way","Weakly","Wearily","Weekly","Weirdly","Well","West","Whatever","Whatsoever","When","Where","Whereby","Wholly","Why","Wickedly","Widely","Wildly","Wisely","Wonderfully","Worldwide","Worse","Worst","Wrong","Yearly","Yesterday","Yet"],["Abilities","Absences","Abundances","Academics","Academies","Accents","Acceptances","Accesses","Accidents","Accommodations","Accomplishments","Accordances","Accountabilities","Accountants","Accounts","Accumulations","Accuracies","Accusations","Accused","Achievements","Acids","Acquisitions","Acres","Actions","Activations","Activists","Activities","Actors","Actresses","Acts","Adaptations","Addictions","Additions","Addresses","Adjustments","Administrations","Administrators","Admissions","Adolescents","Adoptions","Ads","Adults","Advances","Advantages","Adventures","Advertisements","Advertisings","Advice","Advocates","Affairs","Affections","Aftermaths","Afternoons","Agencies","Agendas","Agents","Ages","Aggressions","Agreements","Agricultures","Aides","Alarms","Albums","Alerts","Aliens","Alignments","Allegations","Alliances","Allies","Allocations","Allowances","Alternatives","Aluminium","Amateurs","Ambassadors","Ambitions","Ambulances","Amendments","Amounts","Analogies","Analyses","Analysts","Ancestors","Anchors","Angels","Angers","Angles","Animals","Animations","Ankles","Anniversaries","Announcements","Answers","Anxieties","Apartments","Apologies","Apparatus","Appeals","Appearances","Appetites","Apples","Applicants","Applications","Appointments","Appreciations","Approaches","Approvals","Apps","Aprils","Architects","Architectures","Archives","Areas","Arenas","Arguments","Armies","Arrangements","Arrays","Arrests","Arrivals","Arrows","Articles","Artists","Arts","Artworks","Ashes","Aspects","Aspirations","Assaults","Assemblies","Assertions","Assessments","Assets","Assignments","Assistances","Assistants","Associations","Assumptions","Assurances","Asylums","Athletes","Atmospheres","Attachments","Attacks","Attempts","Attendances","Attentions","Attitudes","Attorneys","Attractions","Attributes","Auctions","Audiences","Audits","Augusts","Aunts","Authorities","Authors","Autonomies","Autos","Autumns","Availabilities","Averages","Awards","Awarenesses","Babies","Backdrops","Backgrounds","Backings","Backs","Backups","Bacterias","Badges","Bags","Bails","Balances","Ballets","Balloons","Ballots","Balls","Bananas","Bands","Banks","Banners","Bans","Bargains","Barrels","Barriers","Bars","Baseballs","Basements","Bases","Basketballs","Baskets","Basses","Bathrooms","Baths","Bats","Batteries","Battlefields","Battles","Bays","Beaches","Beams","Beans","Bears","Beasts","Beats","Beauties","Bedrooms","Beds","Beefs","Beers","Bees","Beginnings","Behalves","Behaviours","Beings","Beliefs","Bells","Belts","Benches","Benchmarks","Bends","Beneficiaries","Benefits","Bests","Bets","Betters","Biases","Bicycles","Bids","Bikes","Bills","Bins","Biographies","Biologies","Birds","Birthdays","Births","Biscuits","Bishops","Bites","Bits","Blades","Blames","Blankets","Blanks","Blasts","Blends","Blessings","Blocks","Blogs","Bloods","Blows","Blues","Boards","Boats","Bonds","Bones","Bonus","Bookings","Books","Booms","Boosts","Boots","Borders","Bosses","Bottles","Boundaries","Bowls","Bows","Boxes","Brains","Branches","Brands","Breaches","Breads","Breakdowns","Breakfasts","Breaks","Breakthroughs","Breathings","Breaths","Breeds","Brethren","Bricks","Brides","Bridges","Broadbands","Broadcasters","Broadcasts","Browsers","Brushes","Bubbles","Bucks","Buddies","Budgets","Buffers","Bugs","Buildings","Bulks","Bullets","Bunches","Burdens","Bureaucracies","Burials","Burns","Buses","Bushes","Businesses","Businessmen","Butters","Buttons","Cabinets","Cabins","Cables","Cafes","Cakes","Calculations","Calls","Calms","Cameras","Campaigns","Campings","Camps","Campus","Canals","Candidates","Candles","Cans","Canvas","Capabilities","Capacities","Capitalisms","Capitals","Caps","Captains","Captures","Carbons","Cards","Careers","Cares","Cargoes","Carpets","Carriages","Carrots","Cars","Cartoons","Cases","Cashes","Casinos","Castles","Casts","Catalogues","Catches","Categories","Cats","Cattle","Causes","Cautions","Caves","Cds","Ceilings","Celebrations","Celebrities","Cells","Cemeteries","Centres","Cents","Centuries","Ceremonies","Certainties","Certificates","Chains","Chairmen","Chairs","Challenges","Chambers","Champions","Championships","Chances","Changes","Channels","Chaos","Chapters","Characteristics","Characters","Charges","Charities","Charms","Charters","Charts","Chases","Chats","Cheats","Checks","Cheeks","Cheers","Cheeses","Chefs","Chemicals","Chemistries","Chests","Chickens","Chiefs","Childhoods","Chips","Chocolates","Choices","Choirs","Chunks","Churches","Cigarettes","Cinemas","Circles","Circuits","Circulations","Circumstances","Cities","Citizens","Citizenships","Civilians","Civilizations","Claims","Clarities","Clashes","Classes","Classics","Classifications","Classrooms","Clauses","Clerks","Clicks","Clients","Cliffs","Climates","Climbs","Clinics","Clips","Clocks","Closes","Closures","Clothes","Clothings","Cloths","Clouds","Clubs","Clues","Clusters","Coaches","Coalitions","Coals","Coasts","Coats","Cocktails","Codes","Coffees","Coincidences","Coins","Colds","Collaborations","Collapses","Colleagues","Collections","Collectors","Colleges","Collisions","Colonies","Colours","Columnists","Columns","Combats","Combinations","Comedies","Comforts","Comics","Commanders","Commands","Commentaries","Commentators","Comments","Commerces","Commercials","Commissioners","Commissions","Commitments","Committees","Commodities","Communications","Communities","Companies","Companions","Comparisons","Compassions","Compensations","Competences","Competitions","Competitors","Complaints","Completions","Complexes","Complexities","Compliances","Complications","Components","Composers","Compositions","Compounds","Compromises","Computers","Concentrations","Conceptions","Concepts","Concerns","Concerts","Concessions","Conclusions","Concretes","Conditions","Conducts","Conferences","Confessions","Confidences","Configurations","Confirmations","Conflicts","Confrontations","Confusions","Congregations","Connections","Consciences","Consciousnesses","Consensus","Consents","Consequences","Conservations","Conservatives","Considerations","Consistencies","Conspiracies","Constituencies","Constitutions","Constraints","Constructions","Consultants","Consultations","Consumers","Consumptions","Contacts","Containers","Contempts","Contenders","Contentions","Contents","Contests","Contexts","Continents","Contractors","Contracts","Contradictions","Contraries","Contrasts","Contributions","Contributors","Controls","Controversies","Conveniences","Conventions","Conversations","Conversions","Convictions","Cookers","Cookings","Cooks","Coordinations","Coordinators","Copies","Coppers","Cops","Copyrights","Cores","Corners","Corporations","Corrections","Correlations","Correspondences","Correspondents","Corridors","Corruptions","Costs","Costumes","Cottages","Cottons","Councillors","Councils","Counsellings","Counsellors","Counterparts","Counters","Counties","Countries","Countrysides","Counts","Couples","Coups","Courages","Courses","Courtesies","Courts","Cousins","Coverages","Covers","Cows","Cracks","Crafts","Crashes","Creams","Creations","Creativities","Creators","Creatures","Credibilities","Credits","Crews","Cries","Crises","Criteria","Criticisms","Critics","Critiques","Crops","Crosses","Crowds","Crowns","Cruises","Crystals","Cues","Cults","Cultures","Cupboards","Cups","Cures","Curiosities","Currencies","Currents","Curricula","Curtains","Custodies","Customers","Customs","Cuts","Cuttings","Cycles","Dads","Dairies","Damages","Dams","Dancers","Dances","Dancings","Dangers","Darknesses","Darks","Databases","Dates","Daughters","Dawns","Days","Deadlines","Dealers","Deals","Debates","Debris","Debts","Debuts","Decades","Decembers","DecisionMakings","Decisions","Decks","Declarations","Declines","Decorations","Decreases","Dedications","Deeds","Defaults","Defeats","Defects","Defences","Defenders","Deficiencies","Deficits","Definitions","Degrees","Delays","Delegates","Delegations","Delights","Deliveries","Demands","Democracies","Demons","Demonstrations","Denials","Densities","Dentists","Departments","Departures","Dependences","Deployments","Deposits","Depressions","Depths","Deputies","Descents","Descriptions","Deserts","Designers","Designs","Desires","Desks","Desktops","Destinations","Destructions","Details","Detections","Detectives","Detentions","Determinations","Developments","Devices","Devils","Diagnoses","Diagrams","Dialogues","Diamonds","Diaries","Dictators","Dictionaries","Diets","Differences","Difficulties","Dignities","Dilemmas","Dimensions","Dinners","Diplomats","Directions","Directories","Directors","Dirts","Disabilities","Disadvantages","Disagreements","Disappointments","Disciplines","Disclosures","Discounts","Discourses","Discoveries","Discretions","Discs","Discussions","Dishes","Disks","Dislikes","Dismissals","Disorders","Displays","Disposals","Disputes","Disruptions","Distances","Distinctions","Distresses","Distributions","Districts","Diversities","Dives","Divides","Divisions","Divorces","Doctors","Doctrines","Documentaries","Documentations","Documents","Dogs","Dollars","Domains","Dominances","Donations","Donors","Doors","Doses","Dots","Doubts","Downloads","Downtowns","Dozens","Drafts","Dramas","Drawings","Dreams","Dresses","Drinks","Drivers","Drives","Drivings","Drops","Droughts","Drums","Duos","Durations","Dusts","Duties","Dvds","Dynamics","Earnings","Ears","Earthquakes","Earths","Eases","Easts","Echoes","Economics","Economies","Economists","Edges","Editions","Editors","Educations","Educators","Effectivenesses","Effects","Efficiencies","Efforts","Eggs","Egos","Elbows","Elections","Electricities","Electronics","Elements","Elephants","Elites","Emails","Embarrassments","Embassies","Emergences","Emergencies","Emissions","Emotions","Emphases","Empires","Employees","Employers","Employments","Encounters","Encouragements","Endeavours","Endings","Endorsements","Ends","Enemies","Energies","Enforcements","Engagements","Engineerings","Engineers","Engines","Enquiries","Enterprises","Entertainments","Enthusiasms","Enthusiasts","Entities","Entrances","Entrepreneurs","Entries","Envelopes","Environments","Epidemics","Episodes","Equalities","Equals","Equations","Equipment","Equivalents","Eras","Errors","Escapes","Essays","Essences","Establishments","Estates","Estimates","Ethics","Euros","Evaluations","Evenings","Events","Evidence","Evils","Evolutions","Examinations","Examples","Exams","Excellences","Exceptions","Excesses","Exchanges","Excitements","Exclusions","Excuses","Executives","Exercises","Exhibitions","Exhibits","Exiles","Existences","Exits","Expansions","Expectations","Expeditions","Expenditures","Expenses","Experiences","Experiments","Expertises","Experts","Explanations","Exploitations","Explorations","Explosions","Explosives","Exports","Exposures","Expressions","Extensions","Extents","Extracts","Extras","Extremes","Eyes","Fabrics","Faces","Facilities","Factions","Factories","Factors","Facts","Faculties","Failures","Fairnesses","Faiths","Falls","Fames","Families","Fans","Fantasies","Fares","Farmers","Farmings","Farms","Fashions","Fates","Fats","Faults","Favourites","Favours","Fears","Feathers","Feats","Features","Februaries","Feedbacks","Feeds","Feelings","Feels","Fees","Feet","Feminists","Fences","Festivals","Fevers","Fibres","Fictions","Fields","Fightings","Fights","Figures","Files","FilmMakers","Films","Filters","Finals","Finances","Findings","Fines","Fingers","Finishes","Firefighters","Fires","Fireworks","Firms","Firsts","Fish","Fishings","Fitnesses","Fits","Fixes","Fixtures","Flags","Flames","Flashes","Flats","Flavours","Flaws","Fleets","Fleshes","Flexibilities","Flies","Flights","Floods","Floors","Flours","Flowers","Flows","Fluids","Flus","Flyings","Foci","Folds","Folks","Followings","Foods","Fools","Footages","Footballs","Forces","Forecasts","Foreigners","Forests","Forks","Formations","Formats","Forms","Formulae","Fortunes","Forums","Fossils","Foundations","Founders","Fractions","Fragments","Frames","Frameworks","Franchises","Frauds","Freedoms","Frequencies","Fridays","Fridges","Friends","Friendships","Frogs","Fronts","Fruits","Frustrations","Fuels","Functions","Fundings","Fundraisings","Funds","Funerals","Funs","Furnitures","Furs","Futures","Gains","Galleries","Gallons","Gamblings","Games","Gamings","Gaps","Garages","Gardens","Gases","Gates","Gatherings","Gazes","Gears","Genders","Generations","Genes","Genius","Genres","Gentlemen","Geographies","Gestures","Ghosts","Giants","Gifts","Gigs","Glances","Glasses","Glimpses","Globalizations","Globes","Glories","Gloves","Goals","Gods","Goes","Gold","Golfs","Goodbyes","Goodnesses","Goods","Governances","Governments","Governors","Graces","Grades","Graduates","Grains","Grandfathers","Grandmothers","Grandparents","Grants","Graphics","Grasps","Grasses","Graves","Gravities","Greenhouses","Greens","Greys","Grids","Griefs","Grins","Grips","Groceries","Grounds","Groups","Growths","Guarantees","Guards","Guerrillas","Guesses","Guests","Guidances","Guidelines","Guides","Guilts","Guitars","Guts","Guys","Gyms","Habitats","Habits","Hairs","Halls","Halts","Halves","Handfuls","Handles","Handlings","Hands","Happinesses","Harassments","Harbours","Hardwares","Harmonies","Harms","Harvests","Hats","Hazards","Headaches","Headlines","Headquarters","Heads","Healthcares","Healths","Hearings","Hearts","Heatings","Heats","Heavens","Heels","Heights","Helicopters","Hellos","Hells","Helmets","Helps","Herbs","Heritages","Heroes","Hierarchies","Highlights","Highs","Highways","Hills","Hints","Hips","Hires","Historians","Histories","Hits","Hobbies","Hockeys","Holds","Holes","Holidays","Homelands","Homes","Homework","Honesties","Honours","Hooks","Hopes","Horizons","Horns","Horrors","Horses","Hospitals","Hosts","Hotels","Hours","Households","Houses","Housings","Humanities","Humans","Humours","Hungers","Huntings","Hunts","Hurricanes","Hurries","Hurts","Hydrogens","Hypotheses","Ices","Icons","Ideals","Ideas","Identifications","Identities","Ideologies","Ids","Ignorances","Illusions","Illustrations","Imageries","Images","Imaginations","Immigrations","Impacts","Implementations","Implications","Importances","Imports","Impressions","Imprisonments","Improvements","Inabilities","Incentives","Inches","Incidences","Incidents","Inclusions","Incomes","Increases","Independences","Indications","Indicators","Indices","Indictments","Individuals","Industries","Inequalities","Infections","Inflations","Influences","Information","Infos","Infrastructures","Ingredients","Inhabitants","Initiatives","Injections","Injuries","Injustices","Inks","Innovations","Inputs","Inquiries","Insects","Insertions","Insiders","Insides","Insights","Inspections","Inspectors","Inspirations","Installations","Instances","Instincts","Institutes","Institutions","Instructions","Instructors","Instruments","Insults","Insurances","Intakes","Integrations","Integrities","Intellectuals","Intelligences","Intensities","Intentions","Intents","Interactions","Interests","Interfaces","Interferences","Interiors","Interpretations","Intervals","Interventions","Interviews","Introductions","Invasions","Inventions","Investigations","Investigators","Investments","Investors","Invitations","Involvements","Ironies","Irons","Islands","Isolations","Issues","Items","Its","Jackets","Jails","Jams","Januaries","Jazzes","Jeans","Jets","Jewelleries","Jobs","Joints","Jokes","Journalisms","Journalists","Journals","Journeys","Joys","Judgements","Judges","Juices","Julies","Jumps","Junctions","Junes","Juries","Jurisdictions","Justices","Justifications","Keyboards","Keys","Kicks","Kidneys","Kilometres","Kinds","Kingdoms","Kings","Kisses","Kitchens","Kits","Knees","Knives","Knocks","Knowledges","Labels","Laboratories","Labours","Labs","Lacks","Ladders","Lakes","Lamps","Landings","Landlords","Landmarks","Lands","Landscapes","Lanes","Languages","Laps","Laptops","Lasers","Lasts","Latests","Laughs","Laughters","Launches","Lawns","Laws","Lawsuits","Lawyers","Layers","Layouts","Leaders","Leaderships","Leads","Leaflets","Leagues","Leaks","Leaps","Learnings","Leathers","Leaves","Lectures","Lefts","Legacies","Legends","Legislations","Legislatures","Legs","Leisures","Lemons","Lengths","Lens","Lessons","Letters","Levels","Liberals","Liberations","Liberties","Libraries","Licences","Lies","Lifestyles","Lifetimes","Lifts","Lightings","Lights","Likelihoods","Likes","Limbs","Limitations","Limits","LineUps","Lines","Links","Lions","Lips","Liquids","Listeners","Listings","Lists","Literacies","Literatures","Litres","Litters","Livers","Lives","Livings","Loads","Loans","Lobbies","Locals","Locations","Locks","Logics","Logos","Logs","Looks","Loops","Lords","Lorries","Losses","Lotteries","Loves","Lows","Loyalties","Luck","Lunches","Lungs","Luxuries","Lyrics","Machineries","Machines","Magazines","Magics","Magistrates","Magnitudes","Mails","Mainlands","Mainstreams","Maintenances","Majorities","MakeUps","Makes","Makings","Malls","Managements","Managers","Mandates","Manipulations","Manners","Manufacturings","Manuscripts","Maps","Marathons","Marches","Margins","Markers","Marketings","Marketplaces","Markets","Marks","Marriages","Masks","Masses","Masters","Matches","Materials","Mates","Mathematics","Maths","Matters","Maximums","Mayors","Mays","Meals","Meanings","Means","Meantimes","Measurements","Measures","Meats","Mechanics","Mechanisms","Medals","Media","Medications","Medicines","Meditations","Meetings","Melodies","Members","Memberships","Memoirs","Memorials","Memories","Memos","Mentions","Mentors","Menus","Merchants","Mercies","Mergers","Merits","Messages","Messes","Metals","Metaphors","Methodologies","Methods","Metres","Mice","Middles","Midnights","Midsts","Migrations","Miles","Milks","Mills","Minds","Minerals","Miners","Mines","Minimums","Minings","Ministers","Ministries","Minutes","Miracles","Mirrors","Miseries","Missiles","Missions","Mistakes","Mixes","Mixtures","Mobiles","Mobilities","Mobs","Modes","Modifications","Momenta","Moments","Mondays","Moneys","Monitors","Monkeys","Monks","Monopolies","Monsters","Months","Monuments","Moods","Moons","Moralities","Morals","Mornings","Mortgages","Mothers","Motions","Motivations","Motives","Motorcycles","Motorists","Motors","Mountains","Mouths","Movements","Moves","Movies","Muds","Mums","Muscles","Museums","Music","Musicals","Musicians","Mysteries","Myths","Nails","Names","Narratives","Nationals","Nations","Natures","Navigations","Necessities","Necks","Needles","Needs","Negatives","Neglects","Negotiations","Neighbourhoods","Neighbours","Nerves","Nests","Nets","Networks","News","Newsletters","Newspapers","Niches","Nightmares","Nights","Noises","Nominations","Nominees","Nonsenses","Noons","Normals","Norms","Norths","Noses","Notebooks","Notes","Notices","Notions","Novelists","Novels","Novembers","Numbers","Nurseries","Nurses","Nursings","Nutritions","Nuts","Obesities","Objections","Objectives","Objects","Obligations","Observations","Observers","Obsessions","Obstacles","Occasions","Occupations","Occurrences","Oceans","Octobers","Odds","Offences","Offerings","Offers","Officers","Offices","Officials","Offspring","Oils","Onions","Openings","Operas","Operations","Operators","Opinions","Opponents","Opportunities","Opposites","Oppositions","Optimisms","Options","Oranges","Orchestras","Orders","Organizations","Organizers","Organs","Orientations","Originals","Origins","Outbreaks","Outcomes","Outfits","Outings","Outlets","Outlines","Outlooks","Outputs","Outrages","Outsiders","Outsides","Ovens","Owners","Ownerships","Oxygens","Paces","Packages","Packets","Packs","Pads","Pages","Pains","Painters","Paintings","Paints","Pairs","Palaces","Palms","Panels","Panics","Pans","Pants","Papers","Parades","Paragraphs","Parallels","Parameters","Parents","Parishes","Parkings","Parks","Parliaments","Participants","Participations","Parties","Partners","Partnerships","Parts","Passages","Passengers","Passes","Passings","Passions","Passports","Passwords","Pastors","Pasts","Patches","Patents","Paths","Pathways","Patiences","Patients","Patrols","Patrons","Patterns","Pauses","Payments","Pays","Peaces","Peaks","Peasants","Peers","Penalties","Pencils","Pennies","Pens","Pensions","People","Peoples","Peppers","Percentages","Perceptions","Performances","Periods","Permissions","Permits","Personalities","Personnels","Perspectives","Petitions","Petrols","Pets","Phases","Phenomena","Philosophers","Philosophies","Phones","Photographers","Photographies","Photographs","Photos","Phrases","Physicians","Physics","Pianos","Picks","Pictures","Pieces","Pigs","Piles","Pills","Pilots","Pinks","Pins","Pioneers","Pipelines","Pipes","Pirates","Pitches","Pities","Pits","Placements","Places","Planes","Planets","Plannings","Plans","Plants","Plastics","Plates","Platforms","Players","Plays","Pleas","Pleasures","Pledges","Plots","Plugs","Plus","Pockets","Poems","Poetries","Poets","Points","Poisons","Poles","Police","Policemen","Policies","Politicians","Politics","Polls","Pollutions","Ponds","Pools","Pops","Popularities","Populations","Portfolios","Portions","Portraits","Ports","Positions","Positives","Possessions","Possibilities","Posters","Posts","Potatoes","Potentials","Pots","Pounds","Poverties","Powders","Powers","Practices","Practitioners","Praises","Prayers","Precedents","Precisions","Predators","Predecessors","Predictions","Preferences","Pregnancies","Prejudices","Premises","Premiums","Preparations","Prescriptions","Presences","Presentations","Presents","Preservations","Presidencies","Presidents","Presses","Pressures","Prevalences","Preventions","Preys","Prices","Prides","Priests","Princes","Princesses","Principals","Principles","Printers","Printings","Prints","Priorities","Prisons","Privacies","Privatizations","Privileges","Prizes","Probabilities","Probes","Problems","Procedures","Proceedings","Proceeds","Processes","Processings","Processors","Producers","Produces","Productions","Productivities","Products","Professionals","Professions","Professors","Profiles","Profits","Programmes","Programmings","Programs","Progresses","Projections","Projects","Promises","Promotions","Proofs","Propagandas","Properties","Proportions","Proposals","Propositions","Prosecutions","Prosecutors","Prospects","Prosperities","Protections","Proteins","Protesters","Protests","Protocols","Provinces","Provisions","Psychologies","Psychologists","Publications","Publicities","Publics","Publishings","Pubs","Pulls","Pulses","Pumps","Punches","Punishments","Punks","Pupils","Purchases","Purples","Purposes","Pursuits","Pushes","Puzzles","Qualifications","Qualities","Quantities","Quarters","Queens","Queries","Questionnaires","Questions","Quests","Queues","Quotas","Quotations","Quotes","Races","Racings","Radars","Radiations","Radios","Rages","Raids","Rails","Railways","Rains","Rallies","Ranges","Rankings","Ranks","Rates","Ratings","Ratios","Rats","Rays","Reaches","Reactions","Readers","Readings","Realities","Realizations","Realms","Rears","Reasonings","Reasons","Rebellions","Rebels","Receipts","Receivers","Receptions","Recessions","Recipes","Recipients","Recognitions","Recommendations","Reconstructions","Recordings","Records","Recoveries","Recruitments","Recruits","Reductions","Referees","References","Referendums","Reflections","Reforms","Refusals","Regards","Regimes","Regions","Registers","Registrations","Regrets","Regulations","Regulators","Rehabilitations","Reigns","Rejections","Relations","Relationships","Relatives","Releases","Relevances","Reliabilities","Reliefs","Religions","Remainders","Remains","Remarks","Remedies","Reminders","Removals","Rentals","Rents","Repairs","Repeats","Replacements","Replies","Reporters","Reportings","Reports","Representations","Representatives","Reproductions","Republics","Reputations","Requests","Requirements","Rescues","Researchers","Researches","Reservations","Reserves","Residences","Residents","Residues","Resignations","Resistances","Resolutions","Resorts","Resources","Respects","Responses","Responsibilities","Restaurants","Restorations","Restraints","Restrictions","Rests","Results","Retails","Retirements","Retreats","Returns","Revelations","Revenges","Revenues","Reverses","Reviews","Revisions","Revivals","Revolutions","Rewards","Rhetorics","Rhythms","Rices","Rides","Rifles","Rights","Rings","Riots","Rises","Risks","Rituals","Rivals","Rivers","Roads","Robberies","Robots","Rockets","Rocks","Rods","Roles","Rolls","Romances","Roofs","Rooms","Roots","Ropes","Roses","Rotations","Rounds","Routes","Routines","Rows","Rubbers","Rubbishes","Rugbies","Ruins","Rules","Rulings","Rumours","Runners","Runnings","Runs","Rushes","Sacrifices","Safeties","Sailings","Sailors","Sails","Saints","Sakes","Salads","Salaries","Sales","Salts","Samples","Sanctions","Sands","Sandwiches","Satellites","Satisfactions","Saturdays","Sauces","Savings","Says","Scales","Scandals","Scares","Scenarios","Scenes","Schedules","Schemes","Scholars","Scholarships","Schools","Sciences","Scientists","Scopes","Scores","Scratches","Screams","Screenings","Screens","Screws","Scripts","Scrutinies","Sculptures","Seals","Searches","Seas","Seasons","Seats","Seconds","Secretaries","Secrets","Sections","Sectors","Securities","Seeds","Seekers","Segments","Selections","Selves","Seminars","Senators","Sensations","Senses","Sensitivities","Sentences","Sentiments","Separations","Septembers","Sequences","Series","Servants","Services","Sessions","SetUps","Sets","Settings","Settlements","Settlers","Shades","Shadows","Shakes","Shames","Shapes","Shareholders","Shares","Sheep","Sheets","Shells","Shelters","Shelves","Shifts","Shippings","Ships","Shirts","Shocks","Shoes","Shootings","Shoots","Shoppings","Shops","Shores","Shortages","Shots","Shoulders","Shouts","Showers","Shows","Siblings","Sides","Sighs","Sights","Signals","Signatures","Significances","Signs","Silences","Silks","Silver","Similarities","Simulations","Singers","Singings","Singles","Sins","Sirs","Sites","Situations","Sizes","Sketches","Skies","Skiings","Skills","Skins","Skirts","Skis","Skulls","Sleeps","Slices","Slides","Slogans","Slopes","Slots","Smartphones","Smells","Smiles","Smokes","Smokings","Snakes","Snows","Soaps","Soccers","Societies","Socks","Softwares","Soils","Soldiers","Solicitors","Solidarities","Solids","Solos","Solutions","Songs","Sons","Sorts","Souls","Sounds","Soups","Sources","Sovereignties","Spaces","Spams","Spans","Speakers","Specialists","Species","Specifications","Specimens","Spectacles","Spectators","Spectra","Speculations","Speeches","Speeds","Spellings","Spells","Spendings","Spheres","Spices","Spiders","Spies","Spines","Spins","Spirits","Spites","Splits","Spokesmen","Spokespeople","Sponsors","Sponsorships","Spoons","Sports","Spotlights","Spots","Spouses","Spreads","Springs","Squads","Squares","Stabilities","Stadiums","Staffs","Stages","Stairs","Stakes","Stalls","Stamps","Stances","Standards","Stands","Stars","Starts","Statements","States","Stations","Statistics","Statues","Status","Stays","Steams","Steels","Stems","Steps","Stereotypes","Sticks","Stimuli","Stocks","Stomachs","Stones","Stops","Storages","Stores","Stories","Storms","Strains","Strands","Strangers","Strategies","Streams","Streets","Strengths","Stresses","Stretches","Strikes","Strings","Strips","Strokes","Structures","Struggles","Students","Studies","Studios","Stuffs","Styles","Subjects","Submissions","Subscribers","Subscriptions","Subsidies","Substances","Substitutes","Substitutions","Suburbs","Successes","Successions","Successors","Sufferings","Sugars","Suggestions","Suites","Suits","Summaries","Summers","Summits","Sums","Sundays","Suns","Supermarkets","Supervisions","Supervisors","Supplements","Supplies","Supporters","Supports","Surfaces","Surgeons","Surgeries","Surges","Surplus","Surprises","Surveillances","Surveys","Survivals","Survivors","Suspects","Suspensions","Suspicions","Sweaters","Sweets","Swimmings","Swims","Swings","Switches","Swords","Symbols","Sympathies","Symptoms","Syndromes","Syntheses","Systems","TShirts","Tables","Tablets","Tackles","Tactics","Tags","Tails","Talents","Tales","Talks","Tanks","Tapes","Taps","Targets","Tasks","Tastes","Taxes","Taxis","Taxpayers","Teachers","Teachings","Teams","Tears","Teas","Techniques","Technologies","Teenagers","Teens","Teeth","Telephones","Televisions","Temperatures","Temples","Tenants","Tendencies","Tennis","Tensions","Tents","Tenures","Terminals","Terms","Terrains","Territories","Testimonies","Testings","Tests","Textbooks","Texts","Textures","Thanks","Theatres","Thefts","Themes","Theologies","Theories","Therapies","Therapists","Theses","Thieves","Things","Thinkings","Thirds","Thoughts","Threads","Threats","Thresholds","Throats","Thumbs","Thursdays","Tickets","Tides","Ties","Timbers","Times","Timings","Tins","Tips","Tissues","Titles","Tobaccos","Todays","Toes","Toilets","Tolerances","Tolls","Tomatoes","Tomorrows","Tones","Tongues","Tonights","Tonnes","Tons","Tools","Topics","Tops","Tortoises","Totals","Touches","Tourisms","Tourists","Tournaments","Tours","Towels","Towers","Towns","Toys","Traces","Tracks","Trademarks","Trades","Tradings","Traditions","Traffics","Tragedies","Trailers","Trails","Trainers","Trainings","Trains","Traits","Transactions","Transcripts","Transfers","Transformations","Transitions","Transits","Translations","Transmissions","Transparencies","Transportations","Transports","Traps","Traumas","Travellers","Travels","Treasures","Treaties","Treatments","Trees","Trends","Trials","Tribes","Tribunals","Tributes","Tricks","Tries","Triggers","Trios","Trips","Triumphs","Troops","Trophies","Troubles","Trousers","Trucks","Trustees","Trusts","Truths","Tsunamis","Tubes","Tuesdays","Tuitions","Tunes","Tunnels","Turnouts","Turnovers","Turns","Tvs","Twists","Types","Tyres","Umbrellas","Uncertainties","Uncles","Undergraduates","Understandings","Underwears","Unemployments","Uniforms","Unions","Unities","Units","Universes","Universities","Updates","Upgrades","Usages","Users","Uses","Utilities","Vacations","Vacuums","Validities","Valleys","Values","Vans","Variables","Variations","Varieties","Vegetables","Vehicles","Veins","Ventures","Venues","Verdicts","Verses","Versions","Vessels","Veterans","Vices","Victories","Videos","Viewers","Viewpoints","Views","Villagers","Villages","Violations","Violences","Virtues","Viruses","Visas","Visions","Visitors","Visits","Vitamins","Voices","Volumes","Volunteers","Votes","Votings","Vulnerabilities","Wages","Waiters","Waits","Walks","Walls","Wards","Warehouses","Warfares","Warmings","Warnings","Warrants","Warriors","Washes","Washings","Wastes","Watches","Waters","Waves","Ways","Weaknesses","Wealths","Weathers","Webs","Websites","Weddings","Wednesdays","Weeds","Weekends","Weeks","Weights","Welcomes","Welfares","WellBeings","Wells","Wests","Wheat","Wheels","Whispers","Wholes","Widows","Widths","Wildlives","Willingnesses","Wills","Windows","Winds","Wines","Wings","Winners","Wins","Winters","Wires","Wisdoms","Wishes","Withdrawals","Witnesses","Wits","Wonders","Woods","Wools","Words","Workers","Workforces","Workouts","Workplaces","Works","Workshops","Worlds","Worms","Worries","Worses","Worships","Worsts","Worths","Wounds","Wrists","Writers","Writings","Wrongs","Yards","Years","Yellows","Yesterdays","Yields","Zones"]];function L(){var e,t,n,i="";for(var o in x){i+=(n=x[o])[(e=0,t=n.length-1,Math.floor(Math.random()*(t-e+1))+e)]}return i}var F=!1;var B=function(e){var t=e.stores.participants,n=Object(f.useState)(t.local.information.name),r=Object(i.a)(n,2),c=r[0],l=r[1],u=sessionStorage.getItem("room"),d=Object(f.useState)(!1),p=Object(i.a)(d,2),h=p[0],m=p[1],v=e.stores.map,b=String(o.a.room).split("_"),y=Number(null===b||void 0===b?void 0:b.length)-1,E="";Number(null===b||void 0===b?void 0:b.length)>1&&(E=String(o.a.room).split("_")[0]);var C=Object(f.useState)(o.a.room?b[y]:u||""),k=Object(i.a)(C,2),M=k[0],x=k[1],B=Object(f.useState)([String(Object(e).room)]),U=Object(i.a)(B,2),V=U[0],G=U[1],H=V[0],z=Object(f.useState)(H.slice(0,0)),Q=Object(i.a)(z,2),K=Q[0],W=Q[1],Y=Object(f.useState)(0),q=Object(i.a)(Y,2),X=q[0],Z=q[1];Object(f.useEffect)((function(){var e=function(e){"Enter"===e.key&&$()};if(window.addEventListener("keydown",e),""===M){var t=setTimeout((function(){if(W(H.slice(0,X)),X+1>H.length){clearTimeout(t);var e=setTimeout((function(){clearTimeout(e),Z(0),G([L()])}),4e3)}else Z(X+1)}),30);return function(){window.removeEventListener("keydown",e),clearTimeout(t)}}}));var $=function(){m(!0);var e=setTimeout((function(){clearTimeout(e);var n=(new DOMMatrix).scaleSelf(1,1,1);v.setMatrix(n),v.setCommittedMatrix(n);var i=setTimeout((function(){clearTimeout(i),ee()}),3e3);!function(e){e&&(t.local.information.name!==c&&(c,t.local.information.name=c,t.local.sendInformation(),t.local.saveInformationToStorage(!0)),""===M?(o.a.room=V[0],u!==M&&sessionStorage.setItem("room",V[0]),x(V[0])):(o.a.room=M,u!==M&&sessionStorage.setItem("room",M),x(M))),""!==M?""===E?window.history.replaceState({},"null","/?room="+M):window.history.replaceState({},"null","/"+E+"/?room="+M):""===E?window.history.replaceState({},"null","/?room="+V[0]):window.history.replaceState({},"null","/"+E+"/?room="+V[0]);var n=setTimeout((function(){clearTimeout(n),M,F=!0,s.a.clear()}),10)}(!0)}),100)};function ee(){var e=!1,n=0,o=0,a=Array.from(t.remote.keys()).filter((function(e){return e!==t.localId}));if(a.length>0){var r,s=Object(g.a)(a.entries());try{for(s.s();!(r=s.n()).done;){var c,l,u=Object(i.a)(r.value,1)[0],d=Number(null===(c=t.remote.get(a[u]))||void 0===c?void 0:c.pose.position[0]),p=Number(null===(l=t.remote.get(a[u]))||void 0===l?void 0:l.pose.position[1]);if(n=Number(Math.random()*v.screenSize[0])+60,o=Number(Math.random()*v.screenSize[1])+60,n>=d-60&&n<=d+60&&o>=p-60&&o<=p+60)return void ee();d>=-60&&d<=60&&p>=-60&&p<=60&&(e=!0)}}catch(h){s.e(h)}finally{s.f()}}else v.setMouse([v.screenSize[0]/2,v.screenSize[1]/2]),t.local.pose.position=Object.assign({},v.mouseOnMap);e?(v.setMouse([n,o]),t.local.pose.position=Object.assign({},v.mouseOnMap),v.focusOn(t.local)):(v.setMouse([v.screenSize[0]/2,v.screenSize[1]/2]),t.local.pose.position=Object.assign({},v.mouseOnMap))}var te=Object(j.d)(),ne=te.t,ie=te.i18n,oe={fontSize:Object(a.x)()?"2em":"1em",height:Object(a.x)()?"2em":"1.5em",color:"black",backgroundColor:"white",padding:"3px",width:"15em"},ae={fontSize:(Object(a.x)(),"1em"),color:"white",padding:"0.5em 0 0.2em 0",marginLeft:"-7em"},re={fontSize:(Object(a.x)(),"1em"),color:"white",padding:"0.2em 0 0.2em 0",marginLeft:"-10.5em"};return Object(T.jsx)(J,{onClose:function(){s.a.clear()},children:Object(T.jsxs)(O.a,{onClick:function(){return h?s.a.clear():""},style:h?{overflowY:"hidden",backgroundColor:"#5f7ca0",fontSize:Object(a.x)()?"2em":"1em",transition:"0.3s ease-out"}:{overflowY:"hidden",backgroundColor:"#5f7ca0",fontSize:Object(a.x)()?"2em":"1em",transition:"0s ease-out"},children:[Object(T.jsx)("p",{style:{textAlign:"right",color:"white"},children:"Version 1.7.2"}),Object(T.jsx)(S.a,{style:{position:"absolute",top:30,right:20,display:"none"},onClick:function(){var e=(j.b.findIndex((function(e){return e===ie.language}))+1)%j.b.length;ie.changeLanguage(j.b[e])},children:Object(T.jsx)(N.a,{})}),Object(T.jsx)("p",{}),Object(T.jsx)("div",{style:h?{position:"relative",width:"100em",display:"none"}:{position:"relative",width:"100em",display:"block"}}),Object(T.jsx)("div",{style:h?{position:"relative",top:"3em",width:"100%",textAlign:"center",opacity:"0",transform:"scale(0.10)",transition:"0.3s ease-out"}:{position:"relative",top:"4em",width:"100%",textAlign:"center"},children:Object(T.jsx)("img",{style:{width:"30em",userSelect:"none"},draggable:!1,src:_,alt:""})}),Object(T.jsx)("div",{style:h?{position:"relative",top:"-25em",width:"100%",textAlign:"center",display:"none"}:{position:"relative",top:"-25em",width:"100%",textAlign:"center"},children:Object(T.jsx)("img",{style:{width:"10em",userSelect:"none"},src:R,draggable:!1,alt:""})}),Object(T.jsx)("br",{}),Object(T.jsx)(A.a,{mt:1,children:Object(T.jsxs)("div",{style:h?{position:"relative",top:"-26em",width:"100%",textAlign:"center",display:"none"}:{position:"relative",top:"-26em",width:"100%",textAlign:"center"},children:[Object(T.jsxs)(P.a,{style:re,children:[" ",ne("YourName")," "]}),Object(T.jsx)(D.a,{value:c,autoFocus:!0,disableUnderline:!0,inputProps:{style:oe},onChange:function(e){return l(e.target.value)}})]})}),Object(T.jsx)(A.a,{mt:2,children:Object(T.jsxs)("div",{style:h?{position:"relative",top:"-26em",width:"100%",textAlign:"center",display:"none"}:{position:"relative",top:"-26em",width:"100%",textAlign:"center"},children:[Object(T.jsxs)(P.a,{style:ae,children:[" ",ne("Venue")," "]}),Object(T.jsx)(D.a,{value:M,autoFocus:!1,disableUnderline:!0,placeholder:K,inputProps:{style:oe},onChange:function(e){return x(e.target.value)}})]})}),Object(T.jsx)(A.a,{mt:2,children:Object(T.jsx)("div",{style:h?{position:"relative",top:"-25em",width:"100%",textAlign:"center",display:"none"}:{position:"relative",top:"-25em",width:"100%",textAlign:"center"},children:Object(T.jsx)("img",{style:{width:"4em",userSelect:"none"},src:I,draggable:!1,onClick:function(){return $()},alt:""})})}),Object(T.jsx)(A.a,{mt:7,children:Object(T.jsx)("div",{style:h?{position:"relative",top:"8.5em",width:"100%",height:"100%",textAlign:"center",display:"block"}:{position:"relative",top:"-24em",width:"100%",textAlign:"center"},children:Object(T.jsx)("img",{style:{width:"8em",userSelect:"none"},src:w,draggable:!1,alt:""})})})]})})};B.displayName="TheEntrance";var U={room:L()},V=new Map;V.set("entrance",(function(e){return Object(T.jsx)(B,Object(y.a)(Object(y.a)({},e),U))})),V.set("afk",(function(e){return Object(T.jsx)(k,{})}));var J=function(e){return Object(T.jsxs)(E.a,Object(y.a)(Object(y.a)({},e),{},{open:s.a.show(),onClose:e.onClose,maxWidth:"xl",fullWidth:!1,fullScreen:!0,children:[s.a.title?Object(T.jsx)(C.a,{id:"simple-dialog-title",children:s.a.title}):void 0,e.children]}))},G=function(e){function t(){"retry"!==s.a.type&&s.a.clear()}return Object(T.jsx)(h.a,{children:function(){return s.a.type?V.has(s.a.type)?V.get(s.a.type)(e):Object(T.jsxs)(J,{onClose:function(){t()},children:[Object(T.jsx)(O.a,{children:s.a.message}),"retry"!==s.a.type?Object(T.jsxs)(A.a,{mt:2,mb:2,ml:4,children:[Object(T.jsx)(S.a,{variant:"contained",color:"primary",style:{textTransform:"none"},onClick:function(){t()},children:Object(j.c)("emClose")}),"\xa0",Object(T.jsx)(S.a,{variant:"contained",color:"secondary",style:{textTransform:"none"},onClick:function(){s.a.supressedTypes.add(s.a.type),t()},children:Object(j.c)("emNeverShow")})]}):void 0]}):Object(T.jsx)(T.Fragment,{})}})};function H(e){var t=e.split("_");return Object(a.b)(t.length<=2),Object(T.jsxs)(T.Fragment,{children:[t[0],t[1]?Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("strong",{children:t[1].substr(0,1)}),t[1].substr(1)]}):void 0]})}G.displayName="ErrorDialog";var z=n(732),Q=n(475),K=n(729),W=n(721),Y=n(723),q=n(433),X=n.n(q),Z=n(252),$=n.n(Z),ee=n(436),te=n.n(ee),ne=n(435),ie=n.n(ne),oe=n(434),ae=n.n(oe),re=n(251),se=n.n(re),ce=n(432),le=n.n(ce),ue=n(739),de=n(30),pe=n(26),he=n(105),fe=n(182),me=n(719),ve=n(717),ge=n(745),be=n(471),ye=n(718),Ae=Object(be.a)({palette:{primary:{main:"#7ececc"},secondary:{main:"#ef4623"}}}),Se=30,Ee=function(e){return Object(T.jsx)(ve.a,{container:!0,spacing:2,children:Object(T.jsx)(ge.a,{value:e.value,min:0,max:Se,track:!1,valueLabelDisplay:"auto","aria-labelledby":"continuous-slider",style:{width:200},onChange:function(t,n){return e.setValue(n)},valueLabelFormat:function(e){return e===Se?"\u221e":e.toString()}})})},Oe=function(e){var t=e.roomInfo,n=e.participants.local,i=Object(h.b)((function(){return n.remoteVideoLimit})),o=Object(h.b)((function(){return n.remoteAudioLimit})),a=Object(T.jsx)(Ee,{value:i>=0?i:Se,setValue:function(e){n.remoteVideoLimit=e===Se?-1:e}}),r=Object(T.jsx)(Ee,{value:o>=0?o:Se,setValue:function(e){n.remoteAudioLimit=e===Se?-1:e}});return Object(T.jsx)(T.Fragment,{children:Object(T.jsxs)(ye.a,{theme:Ae,children:[Object(T.jsx)(me.a,{control:a,label:Object(j.c)("videoLimit")}),Object(T.jsx)(me.a,{control:r,label:Object(j.c)("audioLimit")}),Object(T.jsx)("br",{}),Object(T.jsx)(S.a,{variant:"contained",color:t.passMatched?"primary":"default",style:{textTransform:"none"},disabled:!t.passMatched,onClick:function(){t.passMatched&&de.b.conference.sync.sendTrackLimits("",[n.remoteVideoLimit,n.remoteAudioLimit])},children:"Sync limits"})]})})};Oe.displayName="RemoteTrackLimitControl";var Ce=Object(be.a)({palette:{primary:{main:"#7ececc"},secondary:{main:"#ef4623"}}});var je=function(e){var t=m.a.useState(""),n=Object(i.a)(t,2),o=n[0],r=n[1],s=m.a.useState(!1),c=Object(i.a)(s,2),l=c[0],u=c[1],d=m.a.useState(!1),f=Object(i.a)(d,2),v=f[0],g=f[1],b=m.a.useState(""),E=Object(i.a)(b,2),O=E[0],C=E[1],j=m.a.useRef(null),k=m.a.useRef(null),_=m.a.useRef(null),R=e.stores,I=R.roomInfo,w=R.participants;return Object(T.jsx)(h.a,{children:function(){var t=Object(a.u)(I.backgroundFill)?"white":"black",n=Object(a.u)(I.backgroundColor)?"white":"black",i=I.passMatched?"primary":"default";return Object(T.jsx)(A.a,{m:2,children:Object(T.jsxs)(ye.a,{theme:Ce,children:[Object(T.jsx)(A.a,{m:2,children:Object(T.jsx)(Oe,Object(y.a)({},e.stores),"remotelimitcontrol")}),Object(T.jsxs)(A.a,{mt:2,mb:2,children:[Object(T.jsx)(ue.a,{autoFocus:!1,label:"Admin password",type:"password",style:{marginTop:-12},value:null===I||void 0===I?void 0:I.password,onChange:function(e){I.password=e.currentTarget.value},onKeyPress:function(e){return function(e,t){if("Enter"===e.key){var n=t.roomProps.get("password");t.passMatched=t.password===(n||"")}}(e,I)}}),"\u2003",Object(T.jsx)(S.a,{variant:"contained",color:"primary",style:{textTransform:"none"},onClick:function(){var e=I.roomProps.get("password");e||(e=""),I.passMatched=(null===I||void 0===I?void 0:I.password)===e},children:" Check "}),"\u2003",I.passMatched?"OK":"Not matched"]}),Object(T.jsxs)(A.a,{mt:2,mb:2,children:[Object(T.jsx)(ue.a,{label:"New password to update",type:"text",style:{marginTop:-12},value:null===I||void 0===I?void 0:I.newPassword,onChange:function(e){I.newPassword=e.currentTarget.value}}),"\u2003",Object(T.jsx)(S.a,{variant:"contained",color:i,disabled:!I.passMatched,style:{textTransform:"none"},onClick:function(){I.passMatched&&de.b.conference.setRoomProp("password",I.newPassword)},children:" Update password "}),"\u2003"]}),Object(T.jsxs)(A.a,{mt:2,children:[Object(T.jsx)(S.a,{variant:"contained",color:i,style:{textTransform:"none"},disabled:!I.passMatched,onClick:function(){I.passMatched&&de.b.conference.sendMessage(pe.b.MUTE_VIDEO,!0)},children:" Mute all videos "})," \xa0",Object(T.jsx)(S.a,{variant:"contained",color:i,style:{textTransform:"none"},disabled:!I.passMatched,onClick:function(){I.passMatched&&de.b.conference.sendMessage(pe.b.MUTE_VIDEO,!1)},children:" Show all videos "}),"\u2003",Object(T.jsx)(S.a,{variant:"contained",color:i,style:{textTransform:"none"},disabled:!I.passMatched,onClick:function(){I.passMatched&&de.b.conference.sendMessage(pe.b.MUTE_AUDIO,!0)},children:" Mute all mics "}),"\xa0",Object(T.jsx)(S.a,{variant:"contained",color:i,style:{textTransform:"none"},disabled:!I.passMatched,onClick:function(){I.passMatched&&de.b.conference.sendMessage(pe.b.MUTE_AUDIO,!1)},children:" Switch on all mics "})]}),Object(T.jsxs)(A.a,{mt:2,children:[Object(T.jsx)(S.a,{variant:"contained",color:i,style:{textTransform:"none"},disabled:!I.passMatched,onClick:function(){I.passMatched&&p.c.removeAllContents()},children:" Remove all Contents "}),"\u2003",Object(T.jsx)(S.a,{variant:"contained",color:i,style:{textTransform:"none"},disabled:!I.passMatched,onClick:function(){if(I.passMatched){var e=new Set(p.c.roomContentsInfo.keys());p.c.all.forEach((function(t){return e.add(t.id)})),p.c.all.filter((function(e){return e.ownerName===o})).forEach((function(e){return p.c.removeByLocal(e.id)}))}},children:" Clear contents by user name "})," \u2009",Object(T.jsx)(ue.a,{label:"name",type:"text",style:{marginTop:-12},value:o,onChange:function(e){r(e.currentTarget.value)}})]}),Object(T.jsxs)(A.a,{mt:2,children:[Object(T.jsx)(S.a,{variant:"contained",color:i,style:{textTransform:"none"},disabled:!I.passMatched,onClick:function(){var e;I.passMatched&&(de.b.conference.sendMessageViaJitsi(pe.b.RELOAD_BROWSER,{}),(null===(e=de.b.conference.bmRelaySocket)||void 0===e?void 0:e.readyState)===WebSocket.OPEN&&de.b.conference.pushOrUpdateMessageViaRelay(pe.b.RELOAD_BROWSER,{}))},children:" Reload "}),"\u2003",Object(T.jsx)(S.a,{variant:"contained",disabled:!I.passMatched,style:I.passMatched?{backgroundColor:Object(a.F)(I.backgroundFill),color:t,textTransform:"none"}:{textTransform:"none"},onClick:function(){I.passMatched&&u(!0)},ref:k,children:"Back color"}),Object(T.jsx)(W.a,{open:l,onClose:function(){u(!1),de.b.conference.setRoomProp("backgroundFill",JSON.stringify(I.backgroundFill))},anchorEl:k.current,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:Object(T.jsx)(fe.a,{color:{r:I.backgroundFill[0],g:I.backgroundFill[1],b:I.backgroundFill[2]},disableAlpha:!0,onChange:function(e,t){t.preventDefault(),I.backgroundFill=[e.rgb.r,e.rgb.g,e.rgb.b]}})}),"\xa0",Object(T.jsx)(S.a,{variant:"contained",disabled:!I.passMatched,style:I.passMatched?{backgroundColor:Object(a.F)(I.backgroundColor),color:n,textTransform:"none"}:{textTransform:"none"},onClick:function(){I.passMatched&&g(!0)},ref:_,children:"Pattern color"}),Object(T.jsx)(W.a,{open:v,onClose:function(){g(!1),de.b.conference.setRoomProp("backgroundColor",JSON.stringify(I.backgroundColor))},anchorEl:_.current,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:Object(T.jsx)(fe.a,{color:{r:I.backgroundColor[0],g:I.backgroundColor[1],b:I.backgroundColor[2]},disableAlpha:!0,onChange:function(e,t){t.preventDefault(),I.backgroundColor=[e.rgb.r,e.rgb.g,e.rgb.b]}})}),"\xa0",Object(T.jsx)(S.a,{variant:"contained",color:i,style:{textTransform:"none"},disabled:!I.passMatched,onClick:function(){I.passMatched&&(I.backgroundFill=I.defaultBackgroundFill,I.backgroundColor=I.defaultBackgroundColor,de.b.conference.setRoomProp("backgroundFill",JSON.stringify(I.backgroundFill)),de.b.conference.setRoomProp("backgroundColor",JSON.stringify(I.backgroundColor)))},children:" Default "}),"\u2003",Object(T.jsx)(S.a,{variant:"contained",color:i,style:{textTransform:"none"},disabled:!I.passMatched,onClick:function(){w.local.recording=!w.local.recording,w.local.recording?(e.close&&e.close(),he.b.start(e.stores)):he.b.stop().then((function(e){C(URL.createObjectURL(e))}))},children:w.local.recording?"Stop Recorder":"Start Recorder"}),"\xa0",O?Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("a",{href:O,download:"BMRecord.bin",children:"Download"}),"\xa0"]}):void 0,Object(T.jsx)("input",{type:"file",accept:"application/octet-stream",ref:j,style:{display:"none"},onChange:function(t){var n,i=null===(n=t.currentTarget)||void 0===n?void 0:n.files;i&&i.length&&(e.close&&e.close(),he.a.load(i[0]).then((function(){he.a.play()})))}}),Object(T.jsx)(S.a,{variant:"contained",color:"primary",style:{textTransform:"none"},onClick:function(){var e;null===(e=j.current)||void 0===e||e.click()},children:"Play"})]})]})})}})},Te=n(724),ke=n(741),_e=n(115),Re=n.n(_e),Ie=n(155),we=n.n(Ie),De=Object(Y.a)({root:{padding:2}}),Pe=function(e){var t=e.stores.participants.local,n=De(),i=Object(T.jsx)(h.a,{children:function(){return Object(T.jsx)(ke.a,{icon:Object(T.jsx)(we.a,{htmlColor:"transparent"}),checkedIcon:Object(T.jsx)(Re.a,{htmlColor:"black"}),className:n.root,checked:t.physics.onStage,name:"broadcast",onChange:function(e){return t.setPhysics({onStage:e.target.checked})}})}}),o=Object(j.d)().t;return Object(T.jsxs)(Te.a,{children:[Object(T.jsx)("div",{style:{width:"130%",height:"1.5px",backgroundColor:"#bcbec0",marginLeft:"-40px"}}),Object(T.jsx)(me.a,{style:{position:"relative",top:"5px",left:"-25px"},control:i,label:o("broadcastMyVoice")})]})};Pe.displayName="BroadcastControl";var Me=n(670),Ne=n(725),xe=n(423),Le=n.n(xe);function Fe(e,t){return{onMouseOver:function(n){var i;(null===(i=n.nativeEvent.sourceCapabilities)||void 0===i?void 0:i.firesTouchEvents)||(t.timeout&&(clearTimeout(t.timeout),t.timeout=void 0),e(!0))},onMouseOut:function(n){t.timeout&&clearTimeout(t.timeout),t.timeout=setTimeout((function(){e(!1),t.timeout=void 0}),500)}}}var Be=function(e){return Object(T.jsx)(Ne.a,{in:e.show,style:e.style,children:Object(T.jsx)(Me.a,{className:e.className,color:e.color,onClick:function(t){e.onClickMore&&e.onClickMore(t)},size:"small",ref:e.buttonRef,children:Object(T.jsx)(Le.a,{color:e.iconColor,htmlColor:e.htmlColor,fontSize:"large"})})})},Ue=n(727),Ve=n(726),Je=Object(Y.a)((function(e){return{container:{display:"inline-block",marginLeft:e.spacing(2),marginRight:e.spacing(2),marginTop:e.spacing(1),marginBottom:e.spacing(1),pointerEvents:"auto"}}})),Ge=function(e){var t=Je(),n=Object(f.useState)(!1),o=Object(i.a)(n,2),a=o[0],r=o[1],s=Object(f.useRef)({timeout:void 0}).current;return Object(T.jsxs)("div",Object(y.a)(Object(y.a)({className:t.container+(e.className?" ".concat(e.className):""),style:e.style,ref:e.divRef},Fe(r,s)),{},{children:[Object(T.jsx)(Ve.a,{style:{height:e.size,width:e.size},onClick:function(t){e.onClick&&e.onClick(t)},onMouseDown:function(t){e.onDown&&e.onDown(t)},onTouchStart:function(t){e.onDown&&e.onDown(t)},onContextMenu:function(t){t.preventDefault(),e.onClickMore&&e.onClickMore(t)},color:e.color,onFocus:function(e){var t;null===(t=e.target)||void 0===t||t.blur()},children:e.children}),e.onClickMore?Object(T.jsx)(Be,{style:{position:"relative",top:-35,left:-15,marginRight:-41,display:"none"},show:a,color:e.color,htmlColor:e.htmlColor,iconColor:e.iconColor,onClickMore:e.onClickMore}):void 0]}))},He=function(e){return e.title?Object(T.jsx)(Ue.a,{placement:"top-start",arrow:!0,title:e.title,children:Object(T.jsx)("span",{style:{paddingTop:20},children:Object(T.jsx)(Ge,Object(y.a)({},e))})}):Object(T.jsx)(Ge,Object(y.a)({},e))},ze=Object(Y.a)({root:{padding:2}}),Qe=function(e){var t=e.stores.participants.local,n=Object(h.b)((function(){return t.soundLocalizationBase})),i=Object(h.b)((function(){return t.useStereoAudio})),o=ze(),a=Object(T.jsx)(h.a,{children:function(){return Object(T.jsx)(ke.a,{icon:Object(T.jsx)(we.a,{htmlColor:"transparent"}),checkedIcon:Object(T.jsx)(Re.a,{htmlColor:"black"}),className:o.root,checked:t.useStereoAudio,onChange:function(){t.soundLocalizationBase="avatar"===n?"user":"avatar",t.useStereoAudio=!i,t.saveMediaSettingsToStorage()},name:"settingLoc"})}}),r=Object(j.d)().t;return Object(T.jsxs)(Te.a,{children:[Object(T.jsx)("div",{style:{width:"130%",height:"1.5px",backgroundColor:"#bcbec0",marginLeft:"-40px"}}),Object(T.jsx)(me.a,{style:{position:"relative",top:"5px",left:"-25px"},control:a,label:r("stereoswitch")})]})};Qe.displayName="StereoSwitchControl";var Ke=Object(Y.a)({root:{padding:2}}),We=function(e){var t=e.stores.participants.local,n=Object(h.b)((function(){return t.muteVideo})),i=Ke(),o=Object(T.jsx)(h.a,{children:function(){return Object(T.jsx)(ke.a,{icon:Object(T.jsx)(we.a,{htmlColor:"transparent"}),checkedIcon:Object(T.jsx)(Re.a,{htmlColor:"black"}),className:i.root,checked:!t.muteVideo,name:"broadcastVideo",onChange:function(){t.muteVideo=!0!==n,t.saveMediaSettingsToStorage()}})}}),a=Object(T.jsx)(h.a,{children:function(){return Object(T.jsx)(ke.a,{icon:Object(T.jsx)(we.a,{htmlColor:"transparent"}),checkedIcon:Object(T.jsx)(Re.a,{htmlColor:"black"}),className:i.root,checked:!1,name:"broadcastSpeakVideo",onChange:function(){}})}}),r=Object(j.d)().t;return Object(T.jsxs)(Te.a,{children:[Object(T.jsx)("div",{style:{width:"150%",height:"1.5px",backgroundColor:"#bcbec0",marginLeft:"-40px"}}),Object(T.jsx)(me.a,{style:{position:"relative",top:"5px",left:"-25px"},control:o,label:r("broadcastMyVideo")}),Object(T.jsx)("div",{style:{width:"130%",height:"1.5px",backgroundColor:"#ffffff",marginLeft:"-40px"}}),Object(T.jsx)(me.a,{style:{position:"relative",top:"5px",left:"-25px"},control:a,label:r("broadcastMySpeakVideo")})]})};We.displayName="BroadcastVideoControl";var Ye,qe,Xe,Ze=n(672),$e=n(728),et=function(e){var t=e.icon,n=e.text,i=e.secondEl,o=e.tip,r=e.dense,s=e.onClick,c=H(n),l=Object(a.x)()?"2.5em":"1em",u=Object(T.jsxs)(Ze.a,{button:!0,dense:r,onClick:s,style:{alignItems:"start"},children:[t?Object(T.jsx)($e.a,{style:{fontSize:l,height:l},children:t}):void 0,Object(T.jsx)(Ze.a,{style:{paddingLeft:0,paddingTop:0,paddingBottom:0},children:Object(T.jsxs)("div",{style:{fontSize:Object(a.x)()?"2.5em":"1.2em",verticalAlign:"middle"},children:[c,Object(T.jsx)("br",{}),i]})})]});return o?Object(T.jsx)(Ue.a,{title:o,placement:"top-end",enterDelay:1e3,children:u}):u},tt=n(41),nt=n(44),it=n.n(nt),ot=n(23),at=n(10),rt=(n(84),n(61)),st=n.n(rt),ct=n(2),lt=(Ye=ct.h.shallow,qe=function e(){Object(b.a)(this,e),Object(ot.a)(this,"videos",Xe,this),Object(ct.g)(this)},Xe=Object(at.a)(qe.prototype,"videos",[Ye],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),qe),ut=function(e){var t=e.setStep,n=e.stores,i=n.contents,o=n.map,r=n.participants,s=Object(h.b)((function(){return e.cameras.videos.map((function(e,t){return function(e,t,n){var i=!1;i=e.deviceId===r.local.devicePreference.videoInputDevice;var o=String.fromCharCode(65+n);return Object(T.jsx)(K.a,{onClick:function(){t(e.deviceId)},children:"".concat(o,"\xa0").concat(i?"\ud83d\ude42\xa0":"\xa0\xa0\u2003").concat(e.label)},e.deviceId)}(e,c,t)}))}));function c(n){t("none"),n&&st.a.createLocalTracks({devices:["video"],cameraDeviceId:n}).then((function(t){if(t.length){var n=Object(tt.h)(t,o,"camera",Object(e).xCord,Object(e).yCord,Object(e).from);i.shareContent(n),Object(a.b)(n.id),i.tracks.addLocalContent(n.id,t)}}))}return Object(f.useEffect)((function(){var t=function(t){if("Key"===t.code.substr(0,3)){var n,i=t.code.charCodeAt(3)-65;c(null===(n=e.cameras.videos[i])||void 0===n?void 0:n.deviceId)}};return window.addEventListener("keypress",t),function(){window.removeEventListener("keypress",t)}}),[]),Object(T.jsx)(T.Fragment,{children:s})};ut.displayName="CameraSelector";var dt=function(e){var t,n=e.onSelectedFile,i=["https://www.googleapis.com/auth/drive.file"],o=!1;function a(){window.gapi.auth.authorize({client_id:"858773398697-vki2lito392c5dlss9s31ap077nn0qbd.apps.googleusercontent.com",scope:i,immediate:!1},s)}function r(){o=!0,c()}function s(e){e&&!e.error&&(t=e.access_token,c())}function c(){if(o&&t){var e=new google.picker.DocsView(google.picker.ViewId.DOCS);(new google.picker.PickerBuilder).enableFeature(google.picker.Feature.NAV_HIDDEN).setAppId("binarual-meet").setOAuthToken(t).addView(e).addView(new google.picker.DocsUploadView).setDeveloperKey("AIzaSyAADCXxUujmh0VqXIzJofwl03MA5O8v8EQ").setCallback(l).build().setVisible(!0)}}function l(e){e.action===google.picker.Action.PICKED&&n(e.docs[0].embedUrl)}return Object(f.useEffect)((function(){gapi&&(gapi.load("auth",{callback:a}),gapi.load("picker",{callback:r}))})),Object(T.jsx)(T.Fragment,{children:"loading..."})};dt.displayName="GoogleDriveImport";var pt=n(38),ht=n.n(pt),ft=n(65),mt=n(255),vt=n(722),gt=n(673),bt=Object(be.a)({palette:{primary:{main:"#7ececc"},secondary:{main:"#ef4623"}}}),yt=Object(gt.a)({mainContainer:{display:"flex",height:"100%",width:"100%"},menuContainer:{position:"relative",top:"12px",width:"100px",height:"100px"},galleryMain:{width:"100%",height:"100%",minWidth:"440px",minHeight:"245px",border:"2px dashed #00000030",left:"5px"},gallery:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:10,overflowY:"scroll",overflowX:"hidden",height:"300px",alignContent:"flex-start"},deavticeButtons:{position:"relative",padding:"10px",fontSize:"1em",fontWeight:"bold",borderBottom:"2px solid #7ececc",color:"#000000",cursor:"pointer"},avticeButtons:{position:"relative",padding:"10px",fontSize:"1em",fontWeight:"bold",borderBottom:"2px solid #7ececc",color:"#ef4623",cursor:"default"}}),At="";function St(){return At}function Et(e){for(var t=e.setStep,n=e.value,o=e.onFinishInput,a=e.inputField,r=yt(),s=Object(f.useState)(0),c=Object(i.a)(s,2),l=c[0],u=c[1],d=Object(f.useState)(-1),p=Object(i.a)(d,2),h=p[0],m=p[1],v=["zones/Floors/Bear Rug - Cyan.png","zones/Floors/Bear Rug - Pink.png","zones/Floors/Rug - Cyan.png","zones/Floors/Rectangle - Yellow.png","zones/Floors/Rug - Pink.png","zones/Floors/Rug - Purple.png"],g=[],b=function(e){g.push(Object(T.jsxs)("div",{onClick:function(){w(e)},children:[Object(T.jsx)("img",{src:encodeURIComponent(v[e]),style:{width:"130px",minHeight:"130px",height:"130px",objectFit:"contain",padding:"2px",border:h===e?"3px solid #ef4623":"3px solid #00000020"},alt:""}),Object(T.jsx)("div",{style:{textAlign:"center",position:"relative",fontWeight:"bold",marginTop:"-5px"},children:v[e].split("/")[2].split(".")[0]})]}))},y=0;y<v.length;y++)b(y);for(var A=["zones/Seats/1 Desk Green.png","zones/Seats/2 Chairs Green.png","zones/Seats/2 Couch with Bear Rug Pink.png","zones/Seats/2 Seats Pink.png","zones/Seats/3 Couch with Bear Rug Cyan.png","zones/Seats/3 Couches Green.png","zones/Seats/4 Conference Table Green.png","zones/Seats/4 Couches Orange.png","zones/Seats/5 Couches Orange.png","zones/Seats/6 Conference Table Green.png","zones/Seats/6 Conference Table Pink.png","zones/Seats/8 Conference Table Green.png"],E=[],O=function(e){E.push(Object(T.jsxs)("div",{onClick:function(){w(e)},children:[Object(T.jsx)("img",{src:encodeURIComponent(A[e]),style:{width:"130px",minHeight:"130px",height:"130px",objectFit:"contain",flex:1,padding:"2px",border:h===e?"3px solid #ef4623":"3px dotted #00000020"},alt:""}),Object(T.jsx)("div",{style:{textAlign:"center",position:"relative",fontWeight:"bold",marginTop:"-5px"},children:A[e].split("/")[2].split(".")[0]})]}))},C=0;C<A.length;C++)O(C);for(var j=["zones/Misc/Plant 1.png","zones/Misc/Plant 2.png","zones/Misc/Plant 3.png"],k=[],_=function(e){k.push(Object(T.jsxs)("div",{onClick:function(){w(e)},children:[Object(T.jsx)("img",{src:encodeURIComponent(j[e]),style:{width:"130px",minHeight:"130px",height:"130px",objectFit:"contain",padding:"2px",border:h===e?"3px solid #ef4623":"3px dotted #00000020"},alt:""}),Object(T.jsx)("div",{style:{textAlign:"center",position:"relative",fontWeight:"bold",marginTop:"-5px"},children:j[e].split("/")[2].split(".")[0]})]}))},R=0;R<j.length;R++)_(R);function I(e){At="",m(-1),u(e)}function w(e){1===l?At=v[e]:2===l?At=A[e]:3===l&&(At=j[e]),m(e)}return Object(T.jsxs)("div",{className:r.mainContainer,children:["zoneimage"===e.type?Object(T.jsxs)("div",{className:r.menuContainer,children:[Object(T.jsx)("div",{className:0===l?r.avticeButtons:r.deavticeButtons,onClick:function(){I(0)},children:"Upoad"}),Object(T.jsx)("div",{className:1===l?r.avticeButtons:r.deavticeButtons,onClick:function(){I(1)},children:"Floor"}),Object(T.jsx)("div",{className:2===l?r.avticeButtons:r.deavticeButtons,onClick:function(){I(2)},children:"Seats"}),Object(T.jsx)("div",{className:3===l?r.avticeButtons:r.deavticeButtons,onClick:function(){I(3)},children:"Misc"})]}):"",Object(T.jsxs)(vt.a,{children:[0===l?Object(T.jsx)(Ze.a,{style:"zoneimage"===e.type?{minWidth:"470px",height:"320px"}:{minWidth:"540px",height:"320px"},children:a}):1===l&&"zoneimage"===e.type?Object(T.jsx)(Ze.a,{style:{minWidth:"470px"},children:Object(T.jsx)("div",{className:r.galleryMain,children:Object(T.jsx)("div",{className:r.gallery,children:g})})}):2===l&&"zoneimage"===e.type?Object(T.jsx)(Ze.a,{style:{minWidth:"470px"},children:Object(T.jsx)("div",{className:r.galleryMain,children:Object(T.jsx)("div",{className:r.gallery,children:E})})}):3===l&&"zoneimage"===e.type?Object(T.jsx)(Ze.a,{style:{minWidth:"470px"},children:Object(T.jsx)("div",{className:r.galleryMain,children:Object(T.jsx)("div",{className:r.gallery,children:k})})}):"",Object(T.jsx)(Ze.a,{children:Object(T.jsx)(ye.a,{theme:bt,children:Object(T.jsx)(S.a,{variant:"contained",color:"primary",onClick:function(){o(n),t("none")},children:"Done"})})})]})]})}Et.displayName="Input";var Ot=Object(gt.a)({preview:{width:"100%",height:"100%"},dZoneStyle:{minHeight:"300px"},dZoneTextStyle:{minHeight:"90px"}}),Ct=function(e){var t=e.setStep,n=Ot(),o=Object(f.useState)([]),a=Object(i.a)(o,2),r=a[0],s=a[1],c=Object(j.d)().t,l=Object(T.jsx)(mt.a,{acceptedFiles:["image/*"],dropzoneText:c("imageDropzoneText"),dropzoneClass:n.dZoneStyle,dropzoneParagraphClass:n.dZoneTextStyle,onChange:s,previewGridProps:{container:{spacing:1,direction:"row"}},previewChipProps:{classes:{root:n.preview}}}),u=e.stores.map;return Object(T.jsx)(Et,{stores:e.stores,setStep:t,onFinishInput:function(t){""===St()?t.forEach(function(){var t=Object(ft.a)(ht.a.mark((function t(n,i){return ht.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:30,-20,Object(tt.e)(n,u,[30*i,-20*i],e.type,e.xCord,e.yCord,e.from,"").then((function(e){return p.c.shareContent(e)}));case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()):Object(tt.f)(St(),u,[0,0],e.type,e.xCord,e.yCord,e.from,"").then((function(e){return p.c.shareContent(e)}))},value:r,inputField:l,type:e.type})},jt=Object(be.a)({palette:{primary:{main:"#7ececc"},secondary:{main:"#ef4623"}}});function Tt(e){var t=e.setStep,n=e.value,i=e.onFinishInput,o=e.inputField;return Object(T.jsxs)(vt.a,{children:[Object(T.jsx)(Ze.a,{children:o}),Object(T.jsx)(Ze.a,{children:Object(T.jsx)(ye.a,{theme:jt,children:Object(T.jsx)(S.a,{variant:"contained",color:"primary",onClick:function(){i(n),t("none")},children:"Done"})})})]})}Tt.displayName="SettingInput";var kt=n(247),_t=n.n(kt),Rt=Object(gt.a)({preview:{width:"100%",height:"100%",top:"-20em"}}),It=function(e){var t=e.setStep,n=Rt(),o=Object(f.useState)([]),a=Object(i.a)(o,2),r=a[0],s=a[1],c=Object(f.useState)(""),l=Object(i.a)(c,2),u=l[0],d=l[1],h=Object(f.useState)(!1),m=Object(i.a)(h,2),v=(m[0],m[1]),g="",b="";p.c.all.filter((function(e){return"roomimg"===e.shareType})).map((function(e){return g=e.url})),p.c.all.filter((function(e){return"roomimg"===e.shareType})).map((function(e){return b=e.contentDesc}));var y=Object(j.d)().t,A=Object(T.jsx)(mt.a,{acceptedFiles:["image/*"],initialFiles:[],clearOnUnmount:!1,dropzoneText:y("imageDropzoneText"),onChange:s,filesLimit:1,previewGridProps:{container:{spacing:1,direction:"row"}},previewChipProps:{classes:{root:n.preview}}}),S=e.stores.map;return Object(T.jsxs)("div",{children:[Object(T.jsx)(ue.a,{label:y("meetingDesc"),multiline:!0,rowsMax:4,defaultValue:b,style:{position:"relative",marginLeft:15,width:"94%",marginTop:"-10px",fontWeight:"bold"},onChange:function(e){d(e.target.value),e.preventDefault()}}),Object(T.jsxs)("div",{style:""!==g?{position:"absolute",height:"90px",top:"20px",right:"20px",overflow:"hidden",display:"block"}:{display:"none"},children:[Object(T.jsx)("img",{style:{height:"60px",position:"relative"},src:g,alt:""}),Object(T.jsx)(_t.a,{style:{position:"relative",left:"0px",width:"35",height:"35"},color:"secondary",onClick:function(){p.c.all.filter((function(e){return"roomimg"===e.shareType})).map((function(e){return p.c.removeByLocal(e.id)})),d(""),v(!0)}})]}),Object(T.jsx)("div",{}),Object(T.jsx)(Tt,{stores:e.stores,setStep:t,onFinishInput:function(t){t.forEach(function(){var t=Object(ft.a)(ht.a.mark((function t(n,i){return ht.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:30,-20,Object(tt.e)(n,S,[30*i,-20*i],e.type,e.xCord,e.yCord,e.from,u).then((function(e){return p.c.shareContent(e)}));case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},value:r,inputField:A})]})},wt=n(731),Dt=n(720),Pt=n(740),Mt=n(746),Nt=n(298),xt=n.n(Nt),Lt=n(197),Ft=n.n(Lt),Bt=n(249),Ut=n.n(Bt),Vt=n(166),Jt=n(167);function Gt(e){return new Promise((function(t,n){Vt.b.desktopSharingFrameRate.max=e.stores.contents.screenFps,st.a.createLocalTracks({devices:["desktop"]}).then((function(e){t(e)})).catch((function(e){console.warn("Share screen error: ".concat(e))}))}))}var Ht=function(e){var t=Object(j.d)().t,n=e.stores,i=n.contents,o=n.participants,r=n.map,s=Object(h.b)((function(){return{main:i.tracks.localMains.size,contents:i.tracks.localContents.size}})),c=Object(h.b)((function(){return o.local.mouse.show})),l=Object(f.useRef)(null);function u(t){"camera"===t&&navigator.mediaDevices.enumerateDevices().then((function(t){e.cameras.videos=t.filter((function(e){return"videoinput"===e.kind}))})).catch((function(){console.warn("Device enumeration error")})),e.setStep(t)}var d=function(){u("none"),function(e){for(var t=e.all,n=0;n<t.length;n++)t[n].ownerName="";var i=JSON.stringify(t),o=new Blob([i],{type:"text/plain"}),a=document.createElement("a"),r=URL.createObjectURL(o);a.href=r;var s=sessionStorage.getItem("room");a.download=String(s)+".json",document.body.appendChild(a),a.click(),setTimeout((function(){document.body.removeChild(a),window.URL.revokeObjectURL(r)}),0)}(i)},p=function(){u("none");var t=Object(tt.g)("",r,Object(e).cordX,Object(e).cordY,Object(e).origin);i.shareContent(t),i.setEditing(t.id)},m=function(){Gt(e).then((function(t){if(t.length){var n=Object(tt.h)(t,r,"screen",Object(e).cordX,Object(e).cordY,Object(e).origin);i.shareContent(n),Object(a.b)(n.id),i.tracks.addLocalContent(n.id,t)}})),u("none")};return Object(f.useEffect)((function(){var t=function(t){r.keyInputUsers.has("shareDialog")&&("KeyI"===t.code?function(){var e;null===(e=l.current)||void 0===e||e.click()}():"KeyD"===t.code?d():"KeyV"===t.code?(u("none"),navigator.clipboard.readText().then((function(t){Object(tt.c)(t,r,Object(e).cordX,Object(e).cordY,Object(e).origin).then((function(e){i.shareContent(e)}))}))):"KeyF"===t.code?(t.preventDefault(),u("iframe")):"KeyT"===t.code?(t.preventDefault(),p()):"KeyG"===t.code?(t.preventDefault(),u("image")):"KeyW"===t.code?(t.preventDefault(),function(){u("none");var t=new Uint32Array(4);t=window.crypto.getRandomValues(t);var n="";t.forEach((function(e){return n+=e.toString(16)})),Object(tt.d)("https://wbo.ophir.dev/boards/BinauralMeet_".concat(Jt.a.conference.name,"_").concat(n),r,Object(e).cordX,Object(e).cordY,Object(e).origin).then((function(e){i.shareContent(e),i.setEditing(e.id)}))}()):"KeyB"===t.code?(s.main?i.tracks.clearLocalMains():Gt(e).then((function(e){e.length&&i.tracks.addLocalMains(e)})),u("none")):"KeyS"===t.code?m():"KeyM"===t.code?(o.local.mouse.show=!c,u("none")):"KeyC"===t.code?u("camera"):"KeyL"===t.code&&(Array.from(i.tracks.localContents.keys()).forEach((function(e){return i.removeByLocal(e)})),u("none")))};return window.addEventListener("keypress",t),function(){window.removeEventListener("keypress",t)}}),[]),Object(T.jsxs)(vt.a,{children:[Object(T.jsx)(et,{tip:t("shareImageTip"),text:t("shareImage"),icon:Object(T.jsx)(xt.a,{}),onClick:function(){return u("image")}},"shareImage"),Object(T.jsx)(et,{text:t("shareText"),icon:Object(T.jsx)(Ut.a,{}),onClick:p},"shareText"),Object(T.jsx)(et,{tip:t("shareScreenContentTip"),icon:Object(T.jsx)(Ft.a,{}),text:t("shareScreenContent"),onClick:m,secondEl:Object(T.jsx)(Dt.a,{component:"fieldset",children:Object(T.jsx)(h.a,{children:function(){return Object(T.jsxs)(Mt.a,{row:!0,"aria-label":"screen-fps",name:"FPS",value:e.stores.contents.screenFps,onChange:function(t){e.stores.contents.setScreenFps(Number(t.target.value))},onClick:function(e){e.stopPropagation(),setTimeout(m,100)},children:[Object(T.jsx)(me.a,{value:1,control:Object(T.jsx)(Pt.a,{}),label:"1"}),Object(T.jsx)(me.a,{value:5,control:Object(T.jsx)(Pt.a,{}),label:"5"}),Object(T.jsx)(me.a,{value:15,control:Object(T.jsx)(Pt.a,{}),label:"15"}),Object(T.jsx)(me.a,{value:30,control:Object(T.jsx)(Pt.a,{}),label:"30"}),Object(T.jsx)(me.a,{value:60,control:Object(T.jsx)(Pt.a,{}),label:Object(T.jsxs)("span",{children:["60\xa0\xa0\xa0\xa0",t("fps")]})})]})}})})},"shareScreenContent"),Object(T.jsx)(wt.a,{}),Object(T.jsx)(wt.a,{}),Object(T.jsx)(et,{tip:t("shareImageTip"),text:t("shareZoneImage"),icon:Object(T.jsx)(xt.a,{}),onClick:function(){return u("zoneimage")}},"shareZoneImage"),Object(T.jsx)(wt.a,{})]})};Ht.displayName="ShareMenu";var zt=n(69),Qt=function(e){var t=e.textLabel,n=e.defaultValue,o=e.type,a=Object(zt.a)(e,["textLabel","defaultValue","type"]),r=e.setStep,s=e.onFinishInput,c=Object(f.useState)(void 0===n?"":n),l=Object(i.a)(c,2),u=l[0],d=l[1],p=Object(T.jsx)(ue.a,{label:t,multiline:e.multiline,value:u,onChange:function(e){return d(e.target.value)},fullWidth:!0,inputProps:{autoFocus:!0},onKeyPress:function(t){e.multiline||"Enter"!==t.key||(s(u),r("none"))}});return Object(T.jsx)(Et,Object(y.a)(Object(y.a)({value:u,inputField:p},a),{},{type:o}))};Qt.displayName="TextInput";var Kt=!1;function Wt(){return Kt}var Yt=function(e){var t,n=e.open,o=e.onClose,r=e.cordX,s=e.cordY,c=e.origin,l=e._type,u=e.stores.map,d=Object(f.useRef)(new lt);t="roomImage"===l?"roomImage":"menu";var h=Object(f.useState)(t),m=Object(i.a)(h,2),v=m[0],g=m[1];p.c.pasteEnabled="none"===v||"menu"===v;var b=Object(j.d)().t,A={menu:b("Create and Share"),text:b("Share Text"),iframe:b("Share iframe"),image:b("Share image"),zoneimage:b("Share zone image"),roomImage:b("Meeting Space"),none:"None",camera:b("Select video camera to share")}[v],S=function(t,n){switch(t){case"menu":return Object(T.jsx)(Ht,Object(y.a)(Object(y.a)({},e),{},{setStep:n,cameras:d.current}));case"text":return Object(T.jsx)(Qt,{stores:e.stores,setStep:n,onFinishInput:function(e){p.c.shareContent(Object(tt.g)(e,u,r,s,c))},textLabel:"Text",multiline:!0,type:t});case"iframe":return Object(T.jsx)(Qt,{stores:e.stores,setStep:n,onFinishInput:function(e){Object(tt.d)(e,u,r,s,c).then((function(e){p.c.shareContent(e)}))},textLabel:"URL",multiline:!1,type:t});case"image":case"zoneimage":return Object(T.jsx)(Ct,{setStep:n,stores:e.stores,type:t,xCord:r,yCord:s,from:c});case"roomImage":return Object(T.jsx)(It,{setStep:n,stores:e.stores,type:t,xCord:r,yCord:s,from:c});case"camera":return Object(T.jsx)(ut,{setStep:n,stores:e.stores,cameras:d.current,xCord:r,yCord:s,from:c});case"Gdrive":return Object(T.jsx)(dt,{stores:e.stores,setStep:n,onSelectedFile:function(e){Object(tt.d)(e,u,r,s,c).then((function(e){p.c.shareContent(e)}))}});default:throw new Error("Unknown step: ".concat(t))}}(v,(function(e){"none"===e?o():g(e)}));return Kt=n,Object(T.jsxs)(E.a,{open:n,onClose:o,onExited:function(){return g(t)},maxWidth:"sm",fullWidth:!0,onPointerMove:function(e){u.setMouse([e.clientX,e.clientY])},children:[Object(T.jsx)(C.a,{id:"simple-dialog-title",style:{fontSize:Object(a.x)()?"2.5em":"1em"},children:A}),Object(T.jsx)(O.a,{children:S})]})};Yt.displayName="ShareDialog";var qt=function(e){var t=e.stores,n=t.contents,o=t.participants,a=Object(f.useRef)(null),r=Object(f.useState)(!1),s=Object(i.a)(r,2),c=s[0],l=s[1];function u(){console.log("open download"),function(e){console.log("download");for(var t=e.all,n=0;n<t.length;n++)t[n].ownerName="";var i=JSON.stringify(t),o=new Blob([i],{type:"text/plain"}),a=document.createElement("a"),r=URL.createObjectURL(o);a.href=r;var s=sessionStorage.getItem("room");a.download=String(s)+".json",document.body.appendChild(a),a.click(),setTimeout((function(){document.body.removeChild(a),window.URL.revokeObjectURL(r)}),0)}(n)}var d=Object(j.d)().t;return Object(T.jsxs)(Te.a,{children:[Object(T.jsx)(et,{onClick:function(){l(!0)},text:d("meetingSpace")},"meetingSpace"),Object(T.jsx)("div",{style:{width:"140%",height:"1.5px",backgroundColor:"#bcbec0",marginLeft:"-40px"}}),Object(T.jsx)(et,{onClick:function(){return u()},text:d("shareDownload")},"shareDownload"),Object(T.jsx)(et,{onClick:function(){return function(){var e,t;console.log("open Import ",null===(e=a.current)||void 0===e?void 0:e.clientHeight),null===(t=a.current)||void 0===t||t.click()}()},text:d("shareImport")},"shareImport"),Object(T.jsx)("input",{type:"file",accept:"application/json",ref:a,style:{display:"none"},onChange:function(e){!function(e,t,n){var i,o=null===(i=e.currentTarget)||void 0===i?void 0:i.files;o&&o.length&&o[0].text().then((function(e){var i=JSON.parse(e);Object(nt.isArray)(i)&&i.forEach((function(e){e.ownerName=n;var i=Object(tt.j)(e);if("screen"!==i.type&&"camera"!==i.type){var o=Object(tt.b)();Object.assign(o,i),t.addLocalContent(o)}}))}))}(e,n,o.local.information.name)}}),Object(T.jsx)("div",{style:{width:"140%",height:"1.5px",backgroundColor:"#bcbec0",marginLeft:"-40px"}}),Object(T.jsx)(Yt,Object(y.a)(Object(y.a)({},e),{},{open:c,onClose:function(){return l(!1)},cordX:0,cordY:0,origin:"",_type:"roomImage"}))]})};qt.displayName="SettingsControl";var Xt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAACtElEQVR4nO3d8U3bQBhA8a9V/ycblE7QdANGyAhhg4zACN2g6QTNBoUJSjeADZIJrrJ0kVDpGftsH7zq/aSoFeCPqx+uExvBu5RSiOm93biMB2Y8MOOBGQ/MeGDGAzMemPHAjAdmPDDjgRkPzHhgxgMzHpjxwIwHZjww44EZD8x4YMYDMx6Y8cCMB2Y8MOOBGQ/MeGDGAzMemPHAjAdmPDDjgRkPzHhgxgMzHpjxwIwHZjww44EZD+zDG1j6Vf7zPiKOM85dRcQ6//12xrlLzx6u+5GNjR+rlNJNSukhPfeQ37eqXFPf7PuU0m7C7MuU0r5n9rb1vmwdbpNSOv7jH/+3Y/7YMbO3A2d3O389cvZuwNxzxLGzEfG2A3fAU0O/msfOPo7YyfsFZ096tPpJt9354Vfltl/y+bCkO2f+rJh7yut66PmYTUT8qJj9mGfPeQ5/ptWzza8LbruvHH0RETc9719NmP0xInaV2w7W4sibctSdlY6+2iPjqU+Fo28bEd8mzD3lL4DFtDjyNgvOuCq8fYzSjKnrvphpfUUt4l3OMGM98u1jlNY3x7qNt/R/PwWfX+FzjtIiXt+zuaEWfdZW8PsVPucolHillwp9LyGGKq1vjnUveumsRbzDgjPm2DmlGVPXffof4nVHx92E7e96jrBDfkFc63vPEXbIAWpNeW07iFdYvMLyom7nX1dsdz3gvHZbMfuUo790Xjvko3Ps7E2TJ1kNL0yHdxXmfbSOF97P491V6HO+CkG62/0m7qT7yw/B/AYkMOOBGQ/MeGDGAzMemPHAjAdmPDDjgRkPzHhgxgMzHpjxwIwHZjww44EZD8x4YMYDMx6Y8cCMB2Y8MOOBGQ/MeGDGAzMemPHAjAdmPDDjgRkPzHhgxgMzHpjxwIwHZjww44EZD8x4YMajiog/21dcxOr72+UAAAAASUVORK5CYII=",Zt=Object(be.a)({palette:{primary:{main:"#7ececc"},secondary:{main:"#ef4623"}}}),$t={"&":{margin:"5px",borderRadius:"50%",width:"57px",height:"57px",textAlign:"center"}},en=Object(Y.a)({menu:{position:"absolute",width:"100%",left:"-100%",opacity:0,transition:"0.5s ease-out"},menuActive:{position:"absolute",width:"100%",opacity:1,left:0,transition:"0.5s ease-out"},more:Object(y.a)({display:"inline-block",height:50,position:"relative",cursor:"pointer",backgroundColor:"#bcbec0",right:0,left:0,bottom:0},$t),moreActive:Object(y.a)({display:"inline-block",height:50,position:"relative",cursor:"pointer",backgroundColor:"#ef4623",right:0,left:0,bottom:0},$t),container:{position:"absolute",width:"100%",bottom:5,padding:0,left:60,outline:"none",pointerEvents:"none"},wrapper:{width:"100%"},wrapperInner:{width:"100%",display:"flex",alignItems:"flex-end"}}),tn=function e(){Object(b.a)(this,e),this.timeoutOut=void 0,this.touched=!1,this.downTime=0,this.upTime=0},nn=!1;var on=function(e){var t=e.stores,n=t.map,o=t.participants,a=m.a.useState(!1),r=Object(i.a)(a,2),s=r[0],c=r[1],l=m.a.useState(!1),u=Object(i.a)(l,2),d=u[0],p=u[1],v=m.a.useState(!1),b=Object(i.a)(v,2),A=b[0],S=b[1],E=m.a.useState(!1),O=Object(i.a)(E,2),C=O[0],k=O[1];var _,R=Object(f.useRef)(new tn).current,I=Object(f.useRef)(null),w=Object(f.useRef)(null),D=e.stores.participants,P=Object(h.b)((function(){return Array.from(D.remote.keys()).filter((function(e){var t=D.find(e);if(void 0!==t.tracks.avatarStream)return t}))})),M=Array.from(o.remote.keys()).filter((function(e){return e!==o.localId})),N=Object(g.a)(M.entries());try{for(N.s();!(_=N.n()).done;){var x,L=Object(i.a)(_.value,1)[0];null===(x=o.remote.get(M[L]))||void 0===x||x.tracks.avatarStream}}catch(ke){N.e(ke)}finally{N.f()}var F=Object(h.b)((function(){var e;return{muteA:o.local.muteAudio,muteS:o.local.muteSpeaker,muteV:o.local.muteVideo,onStage:o.local.physics.onStage,lStream:o.local.tracks.avatarStream,remoteStream:null===(e=o.remote.get(P[P.length-1]))||void 0===e?void 0:e.tracks.avatarStream}})),B=m.a.useState([]),U=Object(i.a)(B,2),V=U[0],J=U[1],Y=m.a.useState(null),q=Object(i.a)(Y,2),Z=q[0],ee=q[1],ne=m.a.useState(null),oe=Object(i.a)(ne,2),re=oe[0],ce=oe[1],ue=m.a.useState(null),he=Object(i.a)(ue,2),fe=he[0],me=he[1],ve=m.a.useState(null),ge=Object(i.a)(ve,2),be=ge[0],Ae=ge[1],Se=Object(j.d)().t,Ee=en();var Oe=Object(h.b)((function(){return n.screenSize[1]-(n.mouse[1]-n.offset[1])<90}));function Ce(e){var t;e?(c(!0),R.timeoutOut&&(clearTimeout(R.timeoutOut),R.timeoutOut=void 0),null===(t=I.current)||void 0===t||t.focus()):R.timeoutOut||(R.timeoutOut=setTimeout((function(){c(!1),R.timeoutOut=void 0}),500))}return Object(f.useEffect)((function(){void 0!==F.remoteStream||F.lStream}),[Oe,R.touched]),Object(f.useEffect)((function(){var e=function(e){var t;0===n.keyInputUsers.size&&(e.ctrlKey||e.metaKey||e.altKey||("KeyM"===e.code&&(o.local.muteAudio=!o.local.muteAudio,Ce(!0)),"KeyC"===e.code&&(Ce(!0),(t=!0)?n.keyInputUsers.add("shareDialog"):n.keyInputUsers.delete("shareDialog"),S(t),e.preventDefault(),e.stopPropagation()),"KeyL"===e.code||e.code))};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[]),m.a.useMemo((function(){function t(e,t){var n=!1;return"audioinput"===e.kind?n=e.deviceId===o.local.devicePreference.audioInputDevice:"audiooutput"===e.kind?n=e.deviceId===o.local.devicePreference.audioOutputDevice:"videoinput"===e.kind&&(n=e.deviceId===o.local.devicePreference.videoInputDevice),Object(T.jsxs)("div",{style:{position:"relative",display:"flex",alignItems:"center",marginLeft:"15px"},children:[" ",n?Object(T.jsx)(Re.a,{style:{opacity:"1",position:"absolute",marginLeft:"-10px"}}):Object(T.jsx)(Re.a,{style:{opacity:"0",position:"absolute",marginLeft:"-10px"}}),Object(T.jsxs)(K.a,{onClick:function(){t(e.deviceId)},children:[" ",e.label]},e.deviceId)]})}var i=[Object(T.jsx)(K.a,{children:Object(T.jsx)(Pe,Object(y.a)({},e))},"broadcast")],a=[Object(T.jsx)(K.a,{children:Object(T.jsx)(Qe,Object(y.a)({},e))},"soundLoc")],r=[Object(T.jsx)(K.a,{children:Object(T.jsx)(We,Object(y.a)({},e))},"broadcastVideo")],l=[Object(T.jsxs)(K.a,{style:{display:"flex",flexDirection:"column",textAlign:"center",marginLeft:"-35px"},children:[Object(T.jsx)(qt,Object(y.a)({},e)),Object(T.jsx)(Te.a,{children:Object(T.jsx)(et,{text:Se("settingPreference"),onClick:A},"settingPreference")})]},"settingLoc")];function u(e){e&&(o.local.devicePreference.audioInputDevice=e,o.local.saveMediaSettingsToStorage()),ee(null)}function h(e){e&&(o.local.devicePreference.audioOutputDevice=e,o.local.saveMediaSettingsToStorage()),ce(null)}function f(e){e&&(o.local.devicePreference.videoInputDevice=e,o.local.saveMediaSettingsToStorage()),me(null)}function m(e){Ae(null)}V.forEach((function(e){if("audioinput"===e.kind){var n=i.pop();i.push(t(e,u)),i.push(n)}if("audiooutput"===e.kind){var o=a.pop();a.push(t(e,h)),a.push(o)}if("videoinput"===e.kind){var s=r.pop();r.push(t(e,f)),r.push(s)}var c=l.pop();l.push(c)}));var v=e.height,g=e.height?.7*e.height:36;function b(e){navigator.mediaDevices.enumerateDevices().then(J).catch((function(){console.log("Device enumeration error")}))}function A(){n.keyInputUsers.add("adminForm"),m(),p(!0)}function S(){n.keyInputUsers.delete("adminForm"),p(!1)}return Object(T.jsxs)("div",{ref:I,className:Ee.container,children:[Object(T.jsx)("div",{style:{position:"relative",left:"-50px",top:"0px"},children:Object(T.jsx)(Ge,{size:v,onClick:function(){c(!s)},children:Object(T.jsx)("div",{className:s?Ee.moreActive:Ee.more,children:Object(T.jsx)("img",{src:Xt,style:{width:55,height:55,position:"relative",top:"2px",left:"-0.5px"},alt:""})})})}),Object(T.jsx)(z.a,{in:!0,classes:Ee,children:Object(T.jsxs)("div",{className:s?Ee.menuActive:Ee.menu,children:[Object(T.jsxs)(ye.a,{theme:Zt,children:[Object(T.jsx)(Ge,{size:v,color:F.muteS?"primary":"secondary","aria-label":"speaker",onClick:function(e){R.upTime=(new Date).getSeconds(),R.upTime-R.downTime>1||(o.local.muteSpeaker=!F.muteS,o.local.muteSpeaker&&(o.local.muteAudio=!0),o.local.saveMediaSettingsToStorage())},onDown:function(e){R.downTime=(new Date).getSeconds();var t=e.currentTarget,n=setTimeout((function(){clearTimeout(n),R.upTime-R.downTime>=0||(b(),ce(t))}),500)},onClickMore:function(e){b(),ce(e.currentTarget)},children:F.muteS?Object(T.jsx)(se.a,{style:{width:g,height:g,color:"white"}}):Object(T.jsx)(le.a,{style:{width:g,height:g,color:"white"}})}),Object(T.jsx)(Q.a,{anchorEl:re,keepMounted:!1,style:{marginTop:-70},open:Boolean(re),onChange:function(){h("")},onClose:function(){h("")},children:a}),Object(T.jsx)(He,{size:v,color:F.muteA?"primary":"secondary","aria-label":"mic",title:H(Se("ttMicMute")),onClick:function(){R.upTime=(new Date).getSeconds(),R.upTime-R.downTime>1||(o.local.muteAudio=!F.muteA,o.local.muteAudio||(o.local.muteSpeaker=!1),o.local.saveMediaSettingsToStorage())},onDown:function(e){R.downTime=(new Date).getSeconds();var t=e.currentTarget,n=setTimeout((function(){clearTimeout(n),R.upTime-R.downTime>=0||(b(),ee(t))}),500)},onClickMore:function(e){b(),ee(e.currentTarget)},children:F.muteA?Object(T.jsx)($.a,{style:{width:g,height:g,color:"white"}}):Object(T.jsx)(X.a,{style:{width:g,height:g,color:"white"}})}),Object(T.jsx)(Q.a,{anchorEl:Z,keepMounted:!0,style:{marginTop:-70},open:Boolean(Z),onChange:function(){u("")},onClose:function(){u("")},children:i}),Object(T.jsx)(He,{size:v,color:F.muteV?"primary":"secondary","aria-label":"camera",onClick:function(){R.upTime=(new Date).getSeconds(),R.upTime-R.downTime>1||(de.b.conference.sendMessage(pe.b.MUTE_VIDEO,!0),o.local.muteVideo=!F.muteV,o.local.saveMediaSettingsToStorage(),nn=!0)},onDown:function(e){R.downTime=(new Date).getSeconds();var t=e.currentTarget,n=setTimeout((function(){clearTimeout(n),R.upTime-R.downTime>=0||(b(),me(t))}),500)},onClickMore:function(e){b(),me(e.currentTarget)},children:F.muteV?Object(T.jsx)(ae.a,{style:{width:g,height:g,color:"white"}}):Object(T.jsx)(ie.a,{style:{width:g,height:g,color:"white"}})}),Object(T.jsx)(Q.a,{anchorEl:fe,keepMounted:!0,style:{marginTop:-70},open:Boolean(fe),onChange:function(){f("")},onClose:function(){f("")},children:r}),Object(T.jsx)(G,Object(y.a)({},e)),Object(T.jsx)(Ge,{size:v,color:"primary","aria-label":"settings",onClick:function(e){R.upTime=(new Date).getSeconds(),R.upTime-R.downTime>1||A()},onDown:function(e){R.downTime=(new Date).getSeconds();var t=e.currentTarget,n=setTimeout((function(){clearTimeout(n),R.upTime-R.downTime>=0||(Ae(t),k(!0))}),500)},children:Object(T.jsx)(te.a,{style:{width:g,height:g,color:"white"}})}),Object(T.jsx)(Q.a,{anchorEl:be,keepMounted:!1,style:C?{marginTop:-70,display:"block"}:{marginTop:-70,display:"none"},open:Boolean(be),onClick:function(){setTimeout((function(){k(!1)}),100)},onClose:function(){m()},children:l})]}),Object(T.jsx)(W.a,{open:d,onClose:S,anchorEl:w.current,anchorOrigin:{vertical:330,horizontal:350},anchorReference:"anchorEl",children:Object(T.jsx)(je,{close:S,stores:e.stores})})]})})]})}),[F.muteA,F.muteS,F.muteV,F.onStage,s,d,A,Z,re,fe,be,C,V])};on.displayName="Footer";var an="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAAER0lEQVR4nO2c0ZHbNhCGv8vk/ZgKrFTgSwVHVxClA6aDlOAS7ArCEnQVWOpA6cCuwGIFzAOoOVoWbYCkbvef229Gc/cgCDv4BGAJAbjr+55Ak1+sAwjmE/KECXnChDxhQp4wIU+YkCdMyBMm5AkT8oQJecKEPGFCnjAhT5iQJ0zIEybkCRPyhAl5woQ8YUKeMCFPmJAnTMgTJuQJE/KECXnChDxhQp4wIU+YX60DWIEKqIGH4e8GeHPlfV+Az8AeOA5/TzeP7obcCZ/Pa4At8OeCz3gCdkC7Qjwvjpq8CvhneN2v+Lkd8GF4yfRGJXlbUuNeGxLXoiN9Mdob1rEaCvIqUmMuGR5LOZC+LK57oXd5D6TEYs0hMpeOlAAdDerOwvOjwhY7cQz17kmJkUu89rwG+Nc6iBF/43Ae9CjPcqicwuUQ6k1eRXqQ9iTuTEdaAHCTxHib83b4FAcprp11EGM8yWuAR+sgfsIjjhIYL8Om5+HyEjfDp5eet/Zy1y25J8Vrjpeed0JHHqTeV1kH4eEnoYZ8cV9IScOJlLqvMUceSI8mFWlhIGft9J4Ud7tC/fPp+976tevzOPZ9X12UbTLLTtFcfF411JPDrn+5Nrr6sh42K+Br5nt/43qSsGdeDzyQeu8tYnoRrBOWOvN9B6YbqZ1Z91S501BfDvXMulfBWt6Dcf1LMY3fWl6d+b5Hphtqbto+VW5D/jBcz6x7FazllaTbLalhx2Vb4O3Mut8O5ccxbChbAjN9XLBOWOZU/kRajclN63/G+fHj/KhQ+rx5t0IMs1CU5w0zedbDZrCAkCdMyBPGWt5/xvUvxTR+a3nmv4ktxDR+a3l74/qXsres3Fqeq91YMzCN3/o5r2QF3yOv+leFE2nFpISPwDvWSxY60q8IpXE88crnPCjfTrcjzTVbUsMvoeP5UOb7GXGYYj1sninZw/I7aW0TUqN/WlDvO75NOnIbw8UeFg89D9K5u1ya0f974A/Ke2DH9+LeF5Qvifd2WO/DGO0dOWXuHen7vt9eKd9mlm377/fC1AV1n66Uf5V7WMY05J8Mmjr4Mb5c4IHnzbyfmb5EoPRgi5sTQ57kQdlmojWOINeUnY+Y2rRkgpc570xJBnlP6qkfKE8eqqHcJ/LFdUN8bvDW82De+byO1ANbfrzqsSENz6Xb6+N8XgEN80/Gni/LOfI8v21IjT9324SbeW6MV3mQhqgW2zMMrq/28CwP4jaIH+ItYbnkSBryStcdl3IY6nUrDvzLgzRvbYG/SPPZLelI81uNwA/F3ofNS853jzWse41V3D32wjTErX+y8sbUPC+LVVxfpTmf/NkT920G1igkLMEEIU+YkCdMyBMm5AkT8oQJecKEPGFCnjAhT5iQJ0zIEybkCRPyhAl5woQ8YUKeMCFPmJAnTMgTJuQJE/KECXnChDxhQp4wIU+YkCdMyBMm5AkT8oT5H16yz3SnsLABAAAAAElFTkSuQmCC",rn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAAFYElEQVR4nO2c7XWjRhRA7+bkv7UVWB2sUoGVCuytIGwFdipYtoIoFYTtQFuBUQVRKgiqIHIFkx8PHRAGBAg086R3z+EYYRjmcDVvPtEH5xyGTn7ynQFjOCZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMSZPMT/7zkAP5kAE7IGV15wEgiZ5K+Ax398Dib+shIGmsDkr7Ue+MhESmuSlpf0HjmXeJJrkrSufn7zkIiBCkbcAlrSXpi2wK302eb4zkLMCXoH/aK/PyqXvkRsPnaHIy0r7f9EsMKl8vunSF4q8an3WJLAaOpcT5UcFIcn7UjnWJDAp7W8nyo8KPgT2TnqESCvzhffhcomEzJfJcxQwocmD7gK7Ms+3LTIyczWEEjbLJNSH0CGNkwj4l6IlmyAir4IQ5UG9wGhAOtUB7N+QEhjTr5sRIyM8KSG1cJ1zPrZFvp06L3IFyYlzl865rXMuy88tX1tH5px76pCHuObapafndrT5uGlSeYAr1y5y7kREW5rzmgfclfTE/dOaa9YjPo/Bm4+wWQ5X98Az8DfFNM+ycn7G6cbKOSMtD/n9Vz3SeSSAutOHvAR4qzl+h9RJr/RvWW6Bj0g9WZd2F56RL0q1+9HUl4wG3mc8PBb7KA8/TcwHpjt3Uvedw9YV9dqi4ZxsYP5G27zH7Xx7clIXZvmD2TvnZvn/Zq4QnbrjRsaydDwuXbPI0ziXtWv/MnRp8Ey2hdhJr7IFPlWOfUbqyNfK8Q1FnfkC/DFSHnZI/VzlBx67DqHLW/JeEEi9lvFeKsA3pF8G0i97GD9bR3zE08hNqJ30U9xRLw7gKzK5C9KoGNqA6Uo0cfqNhC4vG3jdGmn2Z0z/cL0NjmuQ9+eA6+4pQucaqZum4p6ipF+U0OWBPPwhoe+ZovESDUyjK15KX8gNlggZ9bg7I403ZCRkT3vj59ARn9Fcl3a9z+Xw2U9p2WZunH6ac8fjkKvS8b1z7sUVfcNy33FIJz9yl31GwcpbDnh4bRw60zMnAwF71z4YPXP9BV58sFpDnTcGCcfhc0ERKuP8uEP6hYfz+na+H0+fMjKX/rb02M4dn6yS1twjrjlvW/p/0vMeVvJyxm7BPdSkWVe6PlG0UrOR8zAqIctLkaGuMYk57pMNaVk2MWVfspaQ5YE87H9GTO+O6d7riydKt5FQ5c2QkucYt3SQpxcz7nsO3/GwADjUN2PXTDsb8JV2eVnP9OLBOTmDUEve1NM4IMNnTWT533mHdL7hqWETqrxQmJ/4/w6PP24QqryN7wx0JMLjEvpQ5UVMP4naxO70KYBMVaUT5uMkocrL8NQI4Lj+aqp7vxPAG0qhygOpS3yHz2rH+wey+Cm6fFbeE/J8HhRLGc6Z0+tLeQVa0IRc8kAaA9GF76nmbdvQ5cH0a1CqqHkBU4M8kNLXtRV4M2iRd8nwaSVvAlKGLQPsi9V5ExEz7hSRakLvKtSxQF6GnApv7x70RVvJAwlrY8+wH9igRBzoLHkHUsafOvoVz+OVfdBY8g5EjDd4/Ya8Ep2OlN5F0CwvY5zB4R0yHJaMkNZF0Rw2D6wZvuB1gyz/U1PPlbkGeUMHr39H+U/8aw6bBw5L2LvWfxvgF5SLg+uQB9J9mCOTpE3skEbJEkWjKG1cQ9isMkfqsfLSvi3vf01XPdco72a4lrB5k5g8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xZg8xfwPFgG9kH+DJH4AAAAASUVORK5CYII=",sn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAADY0lEQVR4nO3c7VEaURiG4dtM/ksH2oGkAkkFsYOQDkgHSQVqBdEOtAJJBcEOpIJIBeTHyw4fsyxLkN33WZ9rxnECBs54s2fPrgsn8/kc0/Sh7QHY/3M8YY4nzPGEOZ4wxxPmeMIcT5jjCXM8YY4nzPGEOZ4wxxPmeMIcT5jjCXM8YY4nzPGEOZ4wxxPmeMIcT5jjCXM8YY4nzPGEdSneALgDxovvg9ZG0pCTjrxLaAj8Krn9GxGyk7oQrwf83XLfbHF/J3Vh2ryquO+UDk+fH9sewJ7OWcZ6AF4Wt71LSvGGrO/Xrol92rulEq8H3JTcfkNsgXWcEy8AgFdiIfN64LhapbJgGQBPW+6bAmcV//czEW5zNTpbPO7ksKG1R2XB0q+4ryocbN9qT6m/1aakEu+Q5f6ACFXmjOoXRmoq8Q6xK47scWC2BUsPGLE8NhtTPuUZ+eI9AJcr/74kjuuk903Hkilen/VwhQvEl/THkmmfN2h7AGoyxZNdOLQlUzzbk+MJczxhjifM8YQ5njCVeIccRpQd+HeCSryLFp6zOM86AeaLrzGJjkdV4jVtRFwfc836C+eSRCfKM53bzKBHXB7xpeJnqq5Wa5TjrRuze4pOc5Lc0+bSHfX2rXfHHUZ9jheGwNcaP/cM/DjqSPbgaXO/cIOjjmRP3vLqhZsRkdPs78Dx6hqS8PpOx9vtlqTX0DhetSmJFiibHK/akGT7uVWOt90tcdCeluOVm5F4uiw4XrkRiafLQqZ4WZbiv0l0CqxKpnhZXumjtgdQV6Z4GdySZwbYKds7Y9sczIx4B22WGWCnbFvec4vPLbFIWZUt3ril55VZpKzKNm32gT8tPO8nhPZ1hWxb3oTYCpr0E8FwkG/Lg+qP7XhrjyS6oGhf2bY8iP3efQPP88zyQ3UkZYwHsfI75srzntjCpVaXm7LGeyV+uY9v/Lgz4DvJ/9RTV9Z4EL/cK+LD4aZv8Hj3xGo2zRXPh8q4YNlmSMSsupp505S4hOGGuHy9U5TireoTp7KKTzc6Jy5VL5b8k8XXS8PjapRqPCP3Ps92cDxhjifM8YQ5njDHE+Z4whxPmOMJczxhjifM8YQ5njDHE+Z4whxPmOMJczxhjifM8YQ5njDHE+Z4whxPmOMJczxhjifM8YT9AzPOgalOo8+wAAAAAElFTkSuQmCC",cn={"&":{margin:"5px",borderRadius:"50%",width:"45px",height:"45px",textAlign:"center"}},ln=Object(Y.a)({emoticon:Object(y.a)({height:50,position:"relative",cursor:"pointer",backgroundColor:"#9e886c",right:0},cn),emoticonActive:Object(y.a)({display:"block",height:50,position:"relative",cursor:"pointer",backgroundColor:"#ef4623",right:0},cn),container:{position:"absolute",width:"30%",bottom:15,right:0,padding:0,outline:"none",pointerEvents:"none"},wrapper:{width:"100%"},wrapperInner:{width:"100%",display:"flex",flexDirection:"column",alignItems:"flex-end"}}),un=function e(){Object(b.a)(this,e),this.timeoutOut=void 0,this.touched=!1},dn=function(e){var t=e.stores,n=t.map,o=t.participants,a=m.a.useState(!1),r=Object(i.a)(a,2),s=r[0],c=r[1],l=m.a.useState(!1),u=Object(i.a)(l,2),d=u[0],p=u[1],v=m.a.useState(!1),g=Object(i.a)(v,2),b=g[0],y=g[1],A=Object(f.useRef)(new un).current,S=Object(f.useRef)(null),E=ln();function O(){return n.screenSize[1]-(n.mouse[1]-n.offset[1])<90}var C=Object(h.b)(O);return Object(f.useEffect)((function(){O()&&(A.touched=!0),function(e){if(e){var t;A.timeoutOut&&(clearTimeout(A.timeoutOut),A.timeoutOut=void 0),null===(t=S.current)||void 0===t||t.focus()}else A.timeoutOut||(A.timeoutOut=setTimeout((function(){A.timeoutOut=void 0}),500))}(C||!A.touched)}),[C,A.touched]),Object(f.useEffect)((function(){var e=function(e){};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[]),m.a.useMemo((function(){var e=55;return Object(T.jsx)("div",{ref:S,className:E.container,children:Object(T.jsxs)(z.a,{in:!0,classes:E,children:[Object(T.jsx)(Ge,{size:45,onClick:function(){!function(){o.local.emoticon="",y(!1),p(!1);var e=setTimeout((function(){clearTimeout(e),s?(o.local.emoticon="",c(!1)):(o.local.emoticon="smile",c(!0))}),100)}()},children:s?Object(T.jsx)("div",{className:E.emoticonActive,children:Object(T.jsx)("img",{src:an,style:{width:e,height:e,position:"relative",top:"-5px",left:"-5px"},alt:""})}):Object(T.jsx)("div",{className:E.emoticon,children:Object(T.jsx)("img",{src:an,style:{width:55,height:55,position:"relative",top:"-5px",left:"-5px"},alt:""})})}),Object(T.jsx)(Ge,{size:45,onClick:function(){!function(){o.local.emoticon="",y(!1),c(!1);var e=setTimeout((function(){clearTimeout(e),d?(o.local.emoticon="",p(!1)):(o.local.emoticon="clap",p(!0))}),100)}()},children:d?Object(T.jsx)("div",{className:E.emoticonActive,children:Object(T.jsx)("img",{src:rn,style:{width:e,height:e,position:"relative",top:"-5px",left:"-5px"},alt:""})}):Object(T.jsx)("div",{className:E.emoticon,children:Object(T.jsx)("img",{src:rn,style:{width:55,height:55,position:"relative",top:"-5px",left:"-5px"},alt:""})})}),Object(T.jsx)(Ge,{size:45,onClick:function(){!function(){o.local.emoticon="",p(!1),c(!1);var e=setTimeout((function(){clearTimeout(e),b?(o.local.emoticon="",y(!1)):(o.local.emoticon="hand",y(!0))}),100)}()},children:b?Object(T.jsx)("div",{className:E.emoticonActive,children:Object(T.jsx)("img",{src:sn,style:{width:e,height:e,position:"relative",top:"-5px",left:"-5px"},alt:""})}):Object(T.jsx)("div",{className:E.emoticon,children:Object(T.jsx)("img",{src:sn,style:{width:55,height:55,position:"relative",top:"-5px",left:"-5px"},alt:""})})})]})})}),[s,d,b])};dn.displayName="Emoticons";var pn=n(136),hn={"&":{margin:"5px",borderRadius:"50%",width:"250px",height:"243px",textAlign:"center",overflow:"hidden",top:"1px",PointerEvent:"none"}},fn=Object(Y.a)({tapBroadcast:{display:"block",width:"265px",position:"relative",left:"-10px",textAlign:"center",color:"#FFFFFF",fontWeight:"bold",fontSize:"20px",textShadow:"1px 1px #000, -1px 1px #cdcdcd, -1px -1px #cdcdcd, 1px -1px #cdcdcd"},tapBroadcastText:{display:"block",width:"265px",position:"relative",top:"-20px",left:"-10px",textAlign:"center",color:"#FFFFFF",fontWeight:"bold",fontSize:"20px",textShadow:"1px 1px #000, -1px 1px #cdcdcd, -1px -1px #cdcdcd, 1px -1px #cdcdcd"},hidetapBroadcast:{display:"none"},fab:{display:"none",opacity:0,transition:"opacity 0.3s ease-out"},fabActive:{display:"block",opacity:1,transition:"opacity 0.3s ease-out"},vidicon:Object(y.a)({display:"none",height:50,position:"relative",backgroundColor:"black",transform:"rotateY(180deg)",right:0},hn),vidiconActive:Object(y.a)({display:"block",height:50,position:"relative",alignItems:"center",backgroundColor:"black",transform:"rotateY(180deg)",right:0},hn),container:{position:"absolute",width:"30%",top:"0%",right:0,padding:0,outline:"none",pointerEvents:"none"},wrapper:{width:"100%"},wrapperInner:{width:"100%",display:"flex",flexDirection:"column",alignItems:"flex-end"}}),mn=function(e){var t,n,o=e.stores.participants,r=o.local.getColorRGB(),s=nn,c=Array.from(o.remote.keys()).filter((function(e){return e!==o.localId})),l=0,u=Object(g.a)(c.entries());try{for(u.s();!(n=u.n()).done;){var d,p=Object(i.a)(n.value,1)[0];void 0!==(null===(d=o.remote.get(c[p]))||void 0===d?void 0:d.tracks.avatarStream)&&(l=p)}}catch(Z){u.e(Z)}finally{u.f()}var v=e.stores.participants,b=Object(h.b)((function(){return Array.from(v.remote.keys()).filter((function(e){var t=v.find(e);if(void 0!==t.tracks.avatarStream)return t}))})),y=m.a.useState(b),A=Object(i.a)(y,2),S=A[0],E=A[1];if(b.length!==S.length){var O=b.filter(j(S)),C=S.filter(j(b));E(0===b.length?[]:O.concat(C))}function j(e){return function(t){return 0===e.filter((function(e){return e===t})).length}}var k=Object(h.b)((function(){return Boolean(o.local.showVideo)})),_=Object(h.b)((function(){var e;return Boolean(null===(e=o.remote.get(S[S.length-1]))||void 0===e?void 0:e.showVideo)})),R=null===(t=o.remote.get(S[S.length-1]))||void 0===t?void 0:t.getColorRGB(),I=Object(h.b)((function(){return o.local.tracks.avatarStream})),w=Object(h.b)((function(){var e;return null===(e=o.remote.get(S[S.length-1]))||void 0===e?void 0:e.tracks.avatarStream})),D=!k||o instanceof pn.a?!_||o instanceof pn.a?void 0:w:I,P=D&&o instanceof pn.a?o.videoBlob:void 0,M=m.a.useState(!1!==k||!1!==_),N=Object(i.a)(M,2),x=N[0],L=N[1],F=m.a.useState(!0),B=Object(i.a)(F,2),U=B[0],V=B[1],J=Object(f.useRef)(null),G=Object(f.useState)(1),H=Object(i.a)(G,2),Q=H[0],K=H[1],W=Object(f.useRef)(null),Y=Object(h.b)((function(){return{muteA:o.local.muteAudio,muteS:o.local.muteSpeaker,muteV:o.local.muteVideo,onStage:o.local.physics.onStage}}));if(void 0===D){var q="";q="GOING LIVE...",!1===s?q="STREAM OFF":k?U&&V(!1):_?q="RECONNECTING...":(q="STREAM OFF",!1===U&&(setTimeout((function(){var e=Q;e<=8&&K(e+=1)}),500),Q>=6&&(K(1),V(!0))))}else q="";var X=fn();return Object(f.useEffect)((function(){return null!==(null===J||void 0===J?void 0:J.current)&&(!function(e,t,n,i,o){if(t)e.srcObject=t;else if(n){var a=URL.createObjectURL(n);e.src=a}e.autoplay=!0,e.onloadedmetadata=function(){var t={width:300,height:300};void 0!==t.width&&void 0!==t.height?e.className=t.width>=t.height?i:o:(console.error("video stream width || height is undefined"),e.className=i)}}(J.current,D,P,"300","300"),L(!1!==k||!1!==_)),function(){!1===k&&K(1)}})),Object(f.useEffect)((function(){return function(){}}),[]),Object(T.jsx)(h.a,{children:function(){var e,t;return Object(T.jsx)("div",{ref:W,className:X.container,children:Object(T.jsxs)(z.a,{in:!0,classes:X,children:[Object(T.jsx)(Ge,{size:250,className:!1!==k||!1!==_||!1===U?X.fabActive:X.fab,onClick:function(){de.b.conference.sendMessage(pe.b.MUTE_VIDEO,!0),o.local.muteVideo=!Y.muteV,o.local.saveMediaSettingsToStorage()},children:Object(T.jsx)("div",{className:x?X.vidiconActive:X.vidicon,children:Object(T.jsx)("video",{ref:J,style:{width:"300px",height:"300px",position:"absolute",marginTop:"-30px",marginLeft:"-150px"}})})}),Object(T.jsx)("div",{style:!1===U&&void 0===D?{width:"240px",height:"243px",borderRadius:"50%",top:"12.5px",right:"20.7px",position:"absolute",backgroundColor:"black",opacity:1,transition:"opacity 0.3s ease-out"}:{width:"240px",height:"243px",borderRadius:"50%",top:"12.5px",right:"20.7px",position:"absolute",backgroundColor:"black",opacity:0,transition:"opacity 0.3s ease-out"},children:Object(T.jsx)("p",{style:"GOING LIVE..."===q||void 0!==D?{display:"none"}:{display:"block",position:"absolute",color:"red",top:"235px",width:"250px",textAlign:"center",fontSize:"20px",fontWeight:"bold"},children:"RECONNECTING..."})}),Object(T.jsxs)("div",{style:{height:"50px",width:"150px",textAlign:"center",position:"relative",left:"-66px",verticalAlign:"middle",display:"flex",flexDirection:"row",whiteSpace:"nowrap",marginTop:"-50px",color:"white",overflow:"hidden"},children:[Object(T.jsx)("img",{style:{position:"relative",display:"STREAM OFF"!==q?"block":"none",width:"25px",height:"25px",marginTop:"0px",marginLeft:"35px",backgroundColor:k?Object(a.F)(r):void 0!==R?Object(a.F)(R):void 0,borderRadius:"50%"},src:k?o.local.information.avatarSrc:null===(e=o.remote.get(c[l]))||void 0===e?void 0:e.information.avatarSrc,alt:""}),Object(T.jsx)("p",{style:{position:"relative",marginTop:"4px",marginLeft:"4px",overflow:"hidden",display:"STREAM OFF"!==q?"block":"none"},children:k?o.local.information.name:null===(t=o.remote.get(c[l]))||void 0===t?void 0:t.information.name})]}),Object(T.jsx)("div",{className:k||0===b.length||!1===s?X.hidetapBroadcast:X.tapBroadcast,children:"TAP TO GO LIVE"}),Object(T.jsx)("p",{className:"STREAM OFF"===q?X.hidetapBroadcast:X.tapBroadcastText,children:q})]})})}})};mn.displayName="ZoneAvatar";var vn=n(156),gn=Object(Y.a)({back:{position:"absolute",width:"100%",height:"100%",top:0,left:0,backgroundColor:"#DFDBE5"},fill:{position:"absolute",width:"100%",height:"100%",top:0,left:0}}),bn=Object(Y.a)({resizerVertical:{background:"#0f5c81",zIndex:1,boxSizing:"border-box",backgroundClip:"padding-box",width:11,margin:"0 -10px 0 0",borderLeft:"0px solid white",borderRight:"transparent 10px solid",cursor:"col-resize"},resizerHorizontal:{background:"#85AEE060",zIndex:1,boxSizing:"border-box",backgroundClip:"padding-box",height:10.5,width:"80%",marginLeft:"10%",margin:"-5px 0 -5px 0",borderTop:"5px transparent solid",borderBottom:"5px transparent solid",cursor:"row-resize",textAlign:"center"}}),yn=Object(Y.a)({container:{width:"100%"},title:function(e){return{fontSize:e.fontSize,justifyContent:"start",justifyItems:"start",alignItems:"center",userSelect:"none",userDrag:"none",whiteSpace:"nowrap",width:"100%"}},outer:{display:"flex",whiteSpace:"nowrap",padding:0,margin:0,width:"100%"},line:function(e){return{display:"flex",justifyContent:"start",justifyItems:"start",alignItems:"center",userSelect:"none",userDrag:"none",whiteSpace:"nowrap",fontSize:e.fontSize,height:"props.height",width:"100%",padding:0}}}),An=n(747);function Sn(e){return{width:e.size,height:e.size,color:e.colors[1],backgroundColor:e.colors[0],pointerEvents:"none",userDrag:"none",fontSize:.3*e.size,display:"inline-block"}}var En=.92;function On(e,t){var n={width:t.size*En,height:t.size*En,borderStyle:"solid",borderWidth:.04*t.size,borderColor:t.colors[0]};return Object.assign(e,n)}var Cn=Object(Y.a)({imageAvatar:function(e){var t=Sn(e);return Object.assign(t,{textAlign:"right",verticalAlign:"top"}),e.border&&On(t,e),t},textAvatar:function(e){var t=Sn(e);return e.border&&On(t,e),t}}),jn=function(e){var t=Cn(e);return Object(T.jsx)(h.a,{children:function(){var n="";e.avatarSrc||(e.name.split(" ").forEach((function(e){return n+=e?e.substring(0,1):""})),n=n.substring(0,2));var i=e.border?e.size*En:e.size;return e.avatarSrc?Object(T.jsx)(An.a,{src:e.avatarSrc,className:t.imageAvatar}):Object(T.jsx)(An.a,{className:t.textAvatar,children:Object(T.jsx)("div",{style:{height:i,width:i,textAlign:"center",verticalAlign:"middle",display:"table-cell",whiteSpace:"nowrap"},children:"initial"})})}})};jn.displayName="RawImageAvatar";var Tn=function(e){return m.a.useMemo((function(){return Object(T.jsx)(jn,Object(y.a)({},e))}),[e.avatarSrc,e.border,e.colors,e.name,e.size,e.style])};function kn(e){var t=new Date(e),n=new Date,i=n.getFullYear()!==t.getFullYear()?t.getFullYear():void 0,o=i||n.getMonth()!==t.getMonth()?t.getMonth()+1:void 0,a=i||o||n.getDate()!==t.getDate()?t.getDate():void 0,r="".concat(t.getHours(),":").concat(t.getMinutes(),":").concat(t.getSeconds());return"".concat(i?"".concat(i,"."):"").concat(o?"".concat(o,"."):"").concat(a?"".concat(a," "):"").concat(r)}function _n(e,t){var n="",i="",o="";return t[1]?(o=n=t[1],i="_blank"):t[2]?(n=t[2],o=t[6]?t[6]:t[2],i=t[3]?"_self":"_blank"):(o=t[7],n=t[11],i=t[9]||t[10]?"_self":"_blank"),Object(a.w)(new URL(n))&&(i="_self"),Object(T.jsx)("a",{href:n,target:i,rel:"noreferrer",children:o},e)}function Rn(e){for(var t,n=[],i="https?:\\/\\/[-_.!~*'()a-zA-Z0-9;/?:@&=+$,%#]+",o=new RegExp("(".concat(i,")|")+"\\[(".concat(i,")(( *>)|( +move))?\\s*(\\S+)\\]")+"|\\[(\\S+)((\\s*>)|(\\s+move)|\\s)\\s*(".concat(i,")\\]")),a=0;null!==(t=o.exec(e.slice(a)));){var r=e.slice(a,a+t.index);r&&n.push(Object(T.jsx)("span",{children:r},a)),n.push(_n(a+r.length,t)),a+=r.length+t[0].length}return n.push(Object(T.jsx)("span",{children:e.slice(a)},a)),n}Tn.displayName="ImageAvatar";var In={text:"black",called:"red",callTo:"black",log:"black",private:"purple"},wn={text:"white",called:"red",callTo:"white",log:"white",private:"purple"},Dn=function(e){var t=("log"===e.message.type||e.message.type,1),n=e.lineHeight*t,i=e.fontSize*t,o=e.stores,r=o.roomInfo,s=o.participants,c=o.map,l="joined."===e.message.text.split(" ")[1]?"green":"Left."===e.message.text.split(" ")[1]?"red":"black";return Object(T.jsx)(h.a,{children:function(){var t=kn(e.message.timestamp),o=Object(a.u)(r.backgroundFill)?wn:In,u=Object(a.u)(r.backgroundFill)?"rgba(0, 0, 0, 1)":"rgba(255, 255, 255, 1)",d=e.message.pid===s.localId;return Object(T.jsx)(Ue.a,{title:"private"===e.message.type?Object(T.jsxs)(T.Fragment,{children:[Object(j.c)(e.message.pid===s.localId?"cmPrivateTo":"cmPrivateFrom",{name:e.message.name}),Object(T.jsx)("br",{}),t]}):Object(T.jsxs)(T.Fragment,{children:[e.message.name,Object(T.jsx)("br",{}),t]}),placement:"right",children:d?Object(T.jsxs)("div",{style:{display:"flex",overflowY:"auto",overflowX:"hidden",wordWrap:"break-word",marginTop:2,marginLeft:10,fontSize:i,padding:"5px",alignItems:"flex-end",justifyContent:"flex-start"},children:[Object(T.jsx)("span",{style:{marginRight:"0.3em"},onClick:function(){var t=s.find(e.message.pid);t&&c.focusOn(t)},children:Object(T.jsx)(Tn,{name:e.message.name,colors:e.message.colors,avatarSrc:e.message.avatarUrl,size:1.7*n,border:!0})}),Object(T.jsxs)("span",{style:{color:l,backgroundColor:u,border:"1px solid #ffffff",padding:"10px",marginTop:"-5px",marginLeft:"15px",borderRadius:"15px",minWidth:"10%",maxWidth:"62%",userSelect:"none"},children:[Rn(e.message.text),Object(T.jsx)("div",{style:{color:o[e.message.type],backgroundColor:u,border:"1px solid #ffff00",padding:"5px",marginTop:"-17px",marginLeft:"-17px",borderRadius:"1px",borderTop:"0px solid #ffffff",borderRight:"0px solid #ffffff",borderBottom:"1px solid #ffffff",borderLeft:"1px solid #ffffff",width:"5px",height:"5px",content:"",transform:"rotate(45deg)"}})]})]}):Object(T.jsxs)("div",{style:{display:"flex",overflowY:"auto",overflowX:"hidden",wordWrap:"break-word",marginTop:2,marginLeft:10,marginRight:0,fontSize:i,padding:"5px",alignItems:"flex-end",justifyContent:"flex-end"},children:[Object(T.jsxs)("span",{style:{color:l,backgroundColor:"#B3E1EA",border:"1px solid #B3E1EA",padding:"10px",marginTop:"-5px",marginLeft:"15px",marginRight:"15px",borderRadius:"12px",minWidth:"10%",maxWidth:"62%",userSelect:"none"},children:[Rn(e.message.text),Object(T.jsx)("div",{style:{color:o[e.message.type],backgroundColor:"#B3E1EA",border:"1px solid #B3E1EA",padding:"5px",marginTop:"-17px",marginLeft:"101%",borderRadius:"1px",borderTop:"0px solid #B3E1EA",borderRight:"0px solid #B3E1EA",borderBottom:"1px solid #B3E1EA",borderLeft:"1px solid #B3E1EA",width:"5px",height:"5px",content:"",transform:"rotate(45deg)"}})]}),Object(T.jsx)("span",{style:{marginRight:"0.3em"},onClick:function(){var t=s.find(e.message.pid);t&&c.focusOn(t)},children:Object(T.jsx)(Tn,{name:e.message.name,colors:e.message.colors,avatarSrc:e.message.avatarUrl,size:1.7*n,border:!0})})]})})}})};function Pn(e,t,n){var i={msg:e,ts:Date.now(),to:t};Jt.a.conference.sendMessage(pe.b.CHAT_MESSAGE,i,t);var o=n.stores.participants.local;if(t){var a=n.stores.participants.remote.get(t);a&&r.b.addMessage(new r.a(e,o.id,a.information.name,o.information.avatarSrc,o.getColor(),Date.now(),"private"))}else r.b.addMessage(new r.a(e,o.id,o.information.name,o.information.avatarSrc,o.getColor(),Date.now(),"text"))}var Mn=function(e){var t=e.stores,n=t.chat,o=t.roomInfo,r=t.participants,s=t.map,c=yn({height:e.lineHeight,fontSize:e.fontSize}),l=m.a.useState(""),u=Object(i.a)(l,2),d=u[0],p=u[1];return Object(T.jsxs)("div",{className:c.container,style:{height:"100%",display:"flex",flexDirection:"column-reverse",overflowY:"auto",overflowX:"hidden",whiteSpace:"pre-line",resize:"horizontal",minWidth:"290px"},children:[Object(T.jsxs)("form",{noValidate:!0,autoComplete:"off",children:[Object(T.jsx)(Ue.a,{title:Object(j.c)("cmSend"),placement:"right",children:Object(T.jsx)("div",{style:{position:"relative",top:15,textAlign:"right"},children:Object(T.jsx)(Me.a,{size:"small",onClick:function(){var t,i,o=n.sendTo?null===r||void 0===r||null===(t=r.find(n.sendTo))||void 0===t||null===(i=t.information)||void 0===i?void 0:i.name:void 0;Pn(d,o?n.sendTo:"",e),p("")},children:Object(T.jsx)("img",{style:{width:"2.9em",bottom:"1px",position:"relative",left:"1px"},src:I,draggable:!1,alt:""})})})}),Object(T.jsx)(h.a,{children:function(){var t,i,c=n.sendTo?null===r||void 0===r||null===(t=r.find(n.sendTo))||void 0===t||null===(i=t.information)||void 0===i?void 0:i.name:void 0,l=Object(a.u)(o.backgroundFill)?"white":"black";return Object(T.jsx)(ue.a,{variant:"outlined",label:"",multiline:!0,value:d,rowsMax:2,style:{width:"77%",minWidth:"30%",userSelect:"none",marginTop:"-38px",marginLeft:"15px",right:"3px",resize:"horizontal"},InputProps:{style:{color:l,backgroundColor:"white",borderRadius:"8px",height:"50px"}},InputLabelProps:{style:{color:"black"}},onFocus:function(){s.keyInputUsers.add("chat")},onBlur:function(){s.keyInputUsers.delete("chat")},onKeyDown:function(e){"Escape"!==e.key&&"Esc"!==e.key||(n.sendTo="")},onKeyPress:function(t){!t.ctrlKey||0!==t.keyCode&&76!==t.keyCode||(Pn(d,c?n.sendTo:"",e),p(""))},onChange:function(e){p(e.target.value)}})}})]}),Object(T.jsx)("div",{children:Object(T.jsx)(h.a,{children:function(){return Object(T.jsx)(T.Fragment,{children:n.messages.map((function(t,n){return Object(T.jsx)(Dn,Object(y.a)({message:t},e),n)}))})}})})]})};Mn.displayName="Chat";var Nn=n(58),xn=n(730),Ln="data:image/png;base64,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",Fn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAABkUlEQVR4nO3cwU3DMBiAURcxWJmErsAGHYVRYIOOwAhsEA5cOZBgyfrKe1Jv7u9In+RD0+S0bdug6WH1BXCceGHihYkXJl6YeGHihYkXJl6YeGHihYkXJl6YeGHihYkXJl6YeGHihYkXJl6YeGHihYkXJl6YeGHihYkXJl6YeGH3Eu86xth2fM4rLnK2e4n3L4kXJl6YeGHihYkXJl6YeGHihYkXJl6YeGHihYkXJl6YeGHihT0u3v86ac555/rLge/85GOM8TphziGnxW+6rb9m930s/EuFYzNMvDDxwsQLEy9MvDDxwsQLEy9MvLDVv20+TZpzGWM871j/Msa4Tdj3c8KMw1bHe5s057xz/W3i3ss4NsPECxMvTLww8cLECxMvTLww8cLECxMvTLww8cLECxMvTLyw1TdjZ/kY3w99/NbSO+CzrH5KiD9wbIaJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJF/YFuDIiwrkDZeQAAAAASUVORK5CYII=",Bn=n(254),Un=n.n(Bn),Vn=n(461),Jn=n.n(Vn),Gn=n(301),Hn=n.n(Gn),zn=new function e(){Object(b.a)(this,e),this.useTransparent=!0},Qn=n(49),Kn=n(437),Wn=n(440),Yn=n.n(Wn),qn=n(441),Xn=n.n(qn),Zn=n(442),$n=n.n(Zn),ei=n(75),ti=n(299),ni=n.n(ti),ii=n(447),oi=n.n(ii),ai=n(446),ri=n.n(ai),si=n(448),ci=n.n(si),li=Object(Y.a)({iframe:{width:"100%",height:"100%",pointerEvents:"none"},iframeEdit:{width:"100%",height:"100%"},iframeVScrool:function(e){return{width:e.content.size[0]+13+10,height:100*e.content.size[0],pointerEvents:"none"}},divScroll:function(e){return{width:e.content.size[0]+100,height:"100%",position:"relative",left:-15,overflow:"scroll"}},divClip:{width:"100%",height:"100%",overflow:"hidden"},divError:{width:"100%",height:"100%",overflow:"hidden",backgroundColor:"white"}});function ui(e){var t=Object(tt.p)(e.params);t!==e.props.content.url&&e.props.updateAndSend&&(e.props.content.url=t,e.props.updateAndSend(e.props.content))}var di,pi,hi,fi,mi=function(e){Object(a.b)("gdrive"===e.content.type);var t=Object(f.useRef)(null),n=e.stores.contents,i=Object(tt.o)(e.content.url),o=i.get("id"),r=i.get("mimeType"),s=Object(f.useRef)({props:e,params:i,scrolling:!1,onscroll:function(){}}).current;s.props=e,s.params=i,!r&&o&&Object(tt.n)(o).then((function(t){(t.name&&e.content.name!==t.name||t.mimeType)&&(s.params.set("mimeType",t.mimeType),console.log("mime: ".concat(t.mimeType),t),t.name&&(e.content.name=t.name),ui(s))})).catch((function(e){console.log("GDrive failed ".concat(e.body)),404===e.status&&(console.log("404 may be video"),s.params.set("mimeType","video"),ui(s))}));var c=li(e),l=Object(h.b)((function(){return e.stores.contents.editing===e.content.id})),u=Object(tt.m)(l,s.params);Object(f.useEffect)((function(){var e=Number(s.params.get("top"));l||s.scrolling||!t.current||isNaN(e)||e===t.current.scrollTop||(t.current.onscroll=function(){},t.current.scrollTop=e,setTimeout((function(){t.current&&(t.current.onscroll=s.onscroll)}),100))})),Object(f.useEffect)((function(){function i(){var e=Number(s.params.get("top"));t.current&&t.current.scrollTop!==e&&(s.params.set("top",t.current.scrollTop.toString()),ui(s))}if(t.current){var o=config.bmRelayServer||n.localParticipant.myContents.has(e.content.id),a=100,r=o?it.a.throttle((function(){return setTimeout(i,a)}),a):it.a.debounce(i,a),c=it.a.debounce((function(){s.scrolling=!1}),a);s.onscroll=function(){s.scrolling=!0,r(),c()},t.current.onscroll=s.onscroll}}),[config.bmRelayServer?n.roomContents:n.localParticipant.myContents,e.content.id]);var d=Object(tt.q)(r);return Object(T.jsx)("div",{className:r?c.divClip:c.divError,children:r?Object(T.jsx)("div",{className:l||!d?c.divClip:c.divScroll,ref:t,onWheel:function(e){return e.ctrlKey||e.stopPropagation()},children:Object(T.jsx)("iframe",{src:u,title:e.content.url,className:l?c.iframeEdit:d?c.iframeVScrool:c.iframe})}):l?Object(T.jsx)("div",{className:c.divClip,onWheel:function(e){return e.ctrlKey||e.stopPropagation()},children:Object(T.jsx)("iframe",{src:u,title:e.content.url,className:c.iframeEdit})}):Object(T.jsx)("div",{style:{margin:"1em",whiteSpace:"pre-wrap"},children:Object(j.c)("gdFailed")})})},vi=n(8),gi=n(443),bi=n.n(gi),yi=n(444),Ai=n.n(yi),Si=n(225),Ei=n(208);Ei.GlobalWorkerOptions.workerSrc="https://cdn.jsdelivr.net/npm/pdfjs-dist@2.7.570/build/pdf.worker.js";var Oi=(di=function(){function e(){Object(b.a)(this,e),this.newProps=void 0,this.props=void 0,this.mainUrl=void 0,this.document=void 0,this.pages=[],this.renderTask=void 0,this.canvas=null,this.textDiv=null,this.annotationDiv=null,this.prevSize=[0,0],this.pageNum=0,Object(ot.a)(this,"numPages",pi,this),Object(ot.a)(this,"showTop",hi,this),Object(ot.a)(this,"pageText",fi,this),Object(ct.g)(this)}return Object(vi.a)(e,[{key:"render",value:function(){var e=this,t=this.pages[this.pageNum];if(this.canvas&&t){var n=t.getViewport({scale:1}),i=this.props.content;if(i.originalSize[0]!==n.width||i.originalSize[1]!==n.height)return i.originalSize=[n.width,n.height],i.size=[i.size[0],i.size[0]*i.originalSize[1]/i.originalSize[0]],this.props.updateOnly(this.props.content),!1;var o=3*this.props.content.size[0]/n.width,a=t.getViewport({scale:o});this.canvas.width=a.width,this.canvas.height=a.height;var r=this.canvas.getContext("2d");return r&&(this.renderTask&&this.renderTask.cancel(),this.renderTask=t.render({canvasContext:r,viewport:a}),this.renderTask.promise.then((function(){t.getTextContent().then((function(t){if(e.textDiv){var n=e.textDiv.childNodes;Array.from(n.values()).forEach((function(e){return e.remove()}));var i=[];Object(Ei.renderTextLayer)({textContent:t,container:e.textDiv,viewport:a,textDivs:i}),i.forEach((function(e){e.style.position="absolute",e.style.color="transparent",e.style.whiteSpace="pre",e.style.transformOrigin="0% 0%",e.style.whiteSpace="nowrap",e.style.verticalAlign="top"}))}})),e.renderTask=void 0})).catch((function(e){}))),!0}return!1}},{key:"updateProps",value:function(){var e=this;if(this.newProps!==this.props){this.props=this.newProps;var t=new URL(this.props.content.url);this.mainUrl=t.hash?t.href.substring(0,t.href.length-t.hash.length):t.href;var n,i=this.pageNum;if("#page="===t.hash.substr(0,6))(i=null!==(n=Number(t.hash.substr(6))-1)&&void 0!==n?n:0)<0&&(i=0),this.numPages&&i>=this.numPages&&(i=this.numPages-1);this.document&&i===this.pageNum?this.prevSize[0]===this.props.content.size[0]&&this.prevSize[1]===this.props.content.size[1]||this.render()&&(this.prevSize=Array.from(this.props.content.size)):(this.getPage(i).then((function(){e.render()})),this.pageNum=i,this.pageText=String(i+1))}}},{key:"getDocument",value:function(){var e=this;return new Promise((function(t,n){e.document?t(e.document):Object(Ei.getDocument)({url:Object(Si.a)(e.mainUrl),cMapUrl:"https://cdn.jsdelivr.net/npm/pdfjs-dist@2.7.570/cmaps/",cMapPacked:!0}).promise.then((function(n){e.document=n,e.numPages=n.numPages,t(e.document)})).catch((function(i){Object(Ei.getDocument)({url:e.mainUrl,cMapUrl:"https://cdn.jsdelivr.net/npm/pdfjs-dist@2.7.570/cmaps/",cMapPacked:!0}).promise.then((function(n){e.document=n,e.numPages=n.numPages,t(e.document)})).catch((function(t){console.error("PDF: failed to load ".concat(e.mainUrl)),n(t)}))}))}))}},{key:"getPage",value:function(e){var t=this;return new Promise((function(n,i){t.pages[e]?n(t.pages[e]):t.getDocument().then((function(o){o.getPage(e+1).then((function(i){t.pages[e]=i,n(t.pages[e])})).catch((function(e){i(e)}))})).catch((function(e){i(e)}))}))}},{key:"updateUrl",value:function(e){void 0!==e&&Number.isFinite(e)||(e=this.pageNum),e<0&&(e=0),e>=this.numPages&&(e=this.numPages-1);var t="".concat(this.mainUrl,"#page=").concat(e+1);if(t!==this.props.content.url){var n=Object.assign({},this.props.content);n.url=t,this.props.updateAndSend(n)}}}]),e}(),pi=Object(at.a)(di.prototype,"numPages",[ct.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),hi=Object(at.a)(di.prototype,"showTop",[ct.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),fi=Object(at.a)(di.prototype,"pageText",[ct.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),di),Ci={onMouseDown:function(e){e.stopPropagation()},onMouseUp:function(e){e.stopPropagation()},onPointerDown:function(e){e.stopPropagation()},onPointerUp:function(e){e.stopPropagation()}},ji=function(e){Object(a.b)("pdf"===e.content.type);var t=Object(f.useRef)(new Oi).current;t.newProps=e;var n=Object(f.useRef)(null),i=Object(f.useRef)(null),o=Object(f.useRef)(null),r=Object(h.b)((function(){return e.stores.contents.editing===e.content.id}));return Object(f.useEffect)((function(){t.canvas=n.current,t.textDiv=i.current,t.annotationDiv=o.current}),[n.current]),Object(f.useEffect)((function(){t.updateProps()})),Object(T.jsxs)("div",{style:{overflow:"hidden",pointerEvents:"auto",userSelect:r?"text":"none"},onDoubleClick:function(t){r||(t.stopPropagation(),t.preventDefault(),e.stores.contents.setEditing(e.content.id))},children:[Object(T.jsx)("canvas",{style:{width:"".concat(300,"%"),height:"".concat(300,"%"),transformOrigin:"top left",transform:"scale(".concat(1/3,")")},ref:n}),Object(T.jsx)("div",{ref:i,style:{position:"absolute",left:0,top:0,width:"".concat(300,"%"),height:"".concat(300,"%"),transformOrigin:"top left",transform:"scale(".concat(1/3,")"),lineHeight:1,overflow:"hidden"}}),Object(T.jsx)("div",{ref:o}),Object(T.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:40},onPointerEnter:function(){t.showTop=!0},onPointerLeave:function(){t.showTop=!1},children:Object(T.jsx)(h.a,{children:function(){return Object(T.jsx)(z.a,{in:t.showTop,style:{position:"absolute",top:0,left:0,width:"100%"},children:Object(T.jsxs)(ve.a,{container:!0,alignItems:"center",children:[Object(T.jsx)(ve.a,{item:!0,children:Object(T.jsx)(Me.a,Object(y.a)(Object(y.a)({size:"small",color:t.pageNum>0?"primary":"default"},Ci),{},{onClick:function(e){e.stopPropagation(),t.updateUrl(t.pageNum-1)},onDoubleClick:function(e){e.stopPropagation()},children:Object(T.jsx)(bi.a,{})}))}),Object(T.jsx)(ve.a,{item:!0,xs:1,children:Object(T.jsx)(ue.a,Object(y.a)(Object(y.a)({value:t.pageText},Ci),{},{inputProps:{min:0,style:{textAlign:"center"}},onChange:function(e){t.pageText=e.target.value},onBlur:function(e){var n=Number(t.pageText);n>0&&t.updateUrl(n-1)},onKeyPress:function(e){if("Enter"===e.key){var n=Number(t.pageText);n>0&&t.updateUrl(n-1)}}}))}),Object(T.jsxs)(ve.a,{item:!0,style:{fontSize:15},children:["/ ",t.numPages]}),Object(T.jsx)(ve.a,{item:!0,children:Object(T.jsx)(Me.a,Object(y.a)(Object(y.a)({size:"small",color:t.pageNum<t.numPages-1?"primary":"default"},Ci),{},{onClick:function(e){e.stopPropagation(),t.updateUrl(t.pageNum+1)},onDoubleClick:function(e){e.stopPropagation()},children:Object(T.jsx)(Ai.a,{})}))})]})})}})})]})},Ti=Object(Y.a)({video:{width:"100%",height:"100%"}}),ki=function(e){Object(a.b)("playbackScreen"===e.content.type||"playbackCamera"===e.content.type);var t=Ti(),n=Object(f.useRef)(null);return Object(f.useEffect)((function(){n.current&&(n.current.src=e.content.url,n.current.autoplay=!0)}),[n.current]),Object(T.jsx)("video",{className:t.video,ref:n})},_i=Object(Y.a)({video:{width:"100%",height:"100%"}}),Ri=function(e){Object(a.b)("screen"===e.content.type||"camera"===e.content.type);var t=_i(),n=Object(f.useRef)(null),o=m.a.useState(!1),r=Object(i.a)(o,2),s=r[0],c=r[1],l=Object(f.useRef)({});l.current={locals:Object(h.b)((function(){return Array.from(p.c.tracks.localContents.get(e.content.id)||[])})),remotes:Object(h.b)((function(){return Array.from(p.c.tracks.remoteContents.get(e.content.id)||[])})),content:e.content},l.current.locals.length>2&&console.error("content ".concat(e.content.id," has ").concat(l.current.locals.length," local tracks"),l.current.locals),l.current.remotes.length>2&&console.error("content ".concat(e.content.id," has ").concat(l.current.remotes.length," remote tracks"),l.current.remotes);var u=[];function d(){if(l.current.locals.length&&n.current){var t=n.current.srcObject instanceof MediaStream&&n.current.srcObject.getTracks();if(t&&t.length){var i=t.find((function(e){return"video"===e.kind})),o=null===i||void 0===i?void 0:i.getSettings(),r=[(null===o||void 0===o?void 0:o.width)||0,(null===o||void 0===o?void 0:o.height)||0];if(r[0]&&l.current.content.originalSize.toString()!==r.toString()){if(l.current.content.originalSize[0]){var s=l.current.content.originalSize[0]/r[0],c=l.current.content.originalSize[1]/r[1];if(s===c&&u.find((function(e){return e===s})))return}var d=l.current.content.size[0]/(l.current.content.originalSize[0]?l.current.content.originalSize[0]:r[0]);l.current.content.originalSize=r,l.current.content.size=Object(a.A)(d,r),e.updateAndSend(l.current.content)}}}}return Object(f.useEffect)((function(){!function(){if(Object(a.b)(0===l.current.locals.length||0===l.current.remotes.length),n.current){var e=new MediaStream;l.current.locals.forEach((function(t){"audio"!==t.getType()&&e.addTrack(t.getTrack())})),l.current.remotes.forEach((function(t){if("audio"!==t.getType()){e.addTrack(t.getTrack());var n=it.a.debounce((function(){c(!0)}),3e3);t.getTrack().onmute=n,t.getTrack().onunmute=function(){n.cancel(),c(!1)}}}));var t=n.current.srcObject instanceof MediaStream&&n.current.srcObject.getTracks(),i=e.getTracks();i.length&&(it.a.isEqual(t,i)||(n.current.srcObject=e,n.current.autoplay=!0))}}()}),[l.current.locals,l.current.remotes]),Object(f.useEffect)((function(){var e=setInterval(d,333);return function(){return clearInterval(e)}})),Object(T.jsx)("video",{className:t.video,style:s?{filter:"brightness(80%) sepia(25%)"}:{},ref:n})},Ii=function e(){Object(b.a)(this,e),this.messages=[],this.isStatic=!1,this.abortScroll=!1,this.editing=!1};function wi(e,t,n){var i={messages:e,scroll:[t.scrollLeft,t.scrollTop]},o=JSON.stringify(i);n.content.url!==o&&n.updateAndSend&&(n.content.url=o,n.updateAndSend(n.content))}function Di(e,t){t.text.message=e;var n=t.member.messages.filter((function(e){return e.message.length}));t.div&&wi(n,t.div,t)}var Pi=function(e){var t=m.a.useState(e.text.message),n=Object(i.a)(t,2),o=n[0],a=n[1],r=Object(f.useRef)(void 0);Object(f.useEffect)((function(){r.current=it.a.throttle(Di,1e3,{leading:!1})}),[]);var s=r.current;return Object(T.jsx)(h.a,{children:function(){return Object(T.jsxs)("div",{style:Object(y.a)(Object(y.a)({},e.css),{},{position:"relative",margin:0,border:0,padding:0,backgroundColor:"none"}),children:[Object(T.jsx)("div",{style:Object(y.a)(Object(y.a)({},e.css),{},{color:"red",position:"relative",width:"100%",overflow:"hidden",visibility:"hidden"}),children:o+"\u200b"}),Object(T.jsx)("textarea",{value:o,autoFocus:e.autoFocus,style:Object(y.a)(Object(y.a)({},e.css),{},{font:"inherit",verticalAlign:"baseline",resize:"none",position:"absolute",top:0,left:0,width:"100%",height:"100%",border:"none",letterSpacing:"inherit",overflow:"hidden"}),onChange:function(t){a(t.currentTarget.value),s&&s(t.currentTarget.value,e)},onBlur:function(){s&&s.cancel(),Di(o,e)},onFocus:function(){},onKeyDown:function(t){"Escape"!==t.key&&"Esc"!==t.key||(t.stopPropagation(),t.preventDefault(),s&&s.cancel(),Di(o,e),e.stores.contents.setEditing(""))}})]})}})},Mi=function(e){var t,n,i=kn(e.text.time),o=(null===(t=e.text.color)||void 0===t?void 0:t.length)?e.text.color:Object(a.p)(e.text.name),r=(null===(n=e.text.textColor)||void 0===n?void 0:n.length)?e.text.textColor:Object(a.m)(o),s={color:Object(a.G)(r,1),backgroundColor:zn.useTransparent?Object(a.G)(o,.5):Object(a.G)(o,1),padding:"0.1em",fontSize:16,lineHeight:1.2,width:"100%",overflow:"clip",boxSizing:"border-box",whiteSpace:"pre-wrap",wordWrap:"break-word",overflowWrap:"break-word"},c=Object(zt.a)(s,["backgroundColor"]);return c.backgroundColor=Object(a.G)(o,1),Object(T.jsx)(Ue.a,{title:Object(T.jsxs)(m.a.Fragment,{children:[e.text.name," ",Object(T.jsx)("br",{})," ",i]}),placement:"left",arrow:!0,suppressContentEditableWarning:!0,children:Object(T.jsx)("div",{children:e.textEditing?Object(T.jsx)(Pi,Object(y.a)(Object(y.a)({},e),{},{css:c})):Object(T.jsx)("div",{style:s,onPointerDown:function(){e.member.isStatic=!0},onPointerMove:function(){e.member.isStatic=!1},onPointerUp:function(t){if(e.member.isStatic){var n=t.target;if(n instanceof Node){t.preventDefault();var i=window.getSelection();if(i)if(i.rangeCount&&i.getRangeAt(0).toString())i.removeAllRanges();else{var o=document.createRange();o.selectNode(n),i.removeAllRanges(),i.addRange(o)}}}},children:e.textToShow})})})},Ni={height:"100%",width:"100%",whiteSpace:"pre-line",pointerEvents:"auto",overflowY:"auto",overflowX:"visible",wordWrap:"break-word"},xi=Object(Y.a)({text:Ni,textEdit:Object(y.a)(Object(y.a)({},Ni),{},{cursor:"default",userSelect:"text"})}),Li=function(e){Object(a.b)("text"===e.content.type);var t=e.stores,n=t.contents,i=t.participants,o=m.a.useRef(new Ii).current,r=xi(),s=Object(f.useRef)(null),c=e.content.url,l=JSON.parse(c),u=Object(h.b)((function(){return n.editing===e.content.id}));u&&n.setBeforeChangeEditing((function(t,i){t===e.content.id&&""===i&&(s.current&&(o.messages=o.messages.filter((function(e){return e.message.length})),wi(o.messages,s.current,e)),n.setBeforeChangeEditing())})),Object(f.useEffect)((function(){var e;!u&&s.current&&(s.current.scrollLeft===l.scroll[0]&&s.current.scrollTop===l.scroll[1]||(o.abortScroll=!0,null===(e=s.current)||void 0===e||e.scroll(l.scroll[0],l.scroll[1])))}),[l.scroll[0],l.scroll[1],u]);var d=new Set;l.messages.forEach((function(e){var t=o.messages.findIndex((function(t){return t.pid===e.pid&&t.time===e.time}));-1===t?(d.add(o.messages.length),o.messages.push(e)):e.pid!==i.localId&&(d.add(t),o.messages[t]=e)})),o.messages=o.messages.filter((function(e,t){return e.pid===i.localId||d.has(t)})),o.messages.sort(Qn.e);var p=void 0;if(u){var v=o.messages.pop();v&&o.messages.push(v),(null===v||void 0===v?void 0:v.pid)!==i.localId&&o.messages.push({message:"",pid:i.localId,name:i.local.information.name,color:i.local.information.color,textColor:i.local.information.textColor,time:Date.now()}),o.editing||(o.messages.reverse(),p=o.messages.find((function(e){return e.pid===i.localId})),o.messages.reverse())}var g=o.messages.map((function(t,n){var a=u&&(t.pid===i.localId||!i.remote.has(t.pid)),r=[];return a||(r=Rn(t.message)),Object(f.createElement)(Mi,Object(y.a)(Object(y.a)({},e),{},{key:n,text:t,div:s.current,textToShow:r,member:o,textEditing:a,autoFocus:t===p}))})),b=it.a.debounce((function(t){s.current&&(o.abortScroll?o.abortScroll=!1:wi(o.messages,s.current,e))}),200);return o.editing=u,Object(T.jsx)("div",{ref:s,className:u?r.textEdit:r.text,onWheel:function(e){return e.ctrlKey||e.stopPropagation()},onScroll:function(e){u||b(e)},children:g})},Fi=n(51),Bi=n(34),Ui=n(33),Vi=n(92);function Ji(e,t){var n=e;n.setSinkId&&n.setSinkId(t).then((function(){})).catch((function(){console.warn("audio.setSinkId:",t," failed")}))}var Gi,Hi,zi,Qi,Ki,Wi,Yi,qi,Xi,Zi=1e5,$i=function(){function e(t,n,i,o){Object(b.a)(this,e),this.sourceNode=void 0,this.audioElement=void 0,this.gainNode=void 0,this.pannerNode=void 0,this.destination=void 0,this.context=void 0,this.playMode=void 0,this.audibility=!1,this.audioDeviceId="",this.distance=1,this.interval=void 0,this._defaultPannerRefDistance=Fi.a,this.context=t,this.destination=n,this.gainNode=this.createGainNode(t),this.pannerNode=this.createPannerNode(t),this.gainNode.connect(this.pannerNode),this.pannerNode.connect(this.destination),this.playMode=i,this.updateAudibility(o)}return Object(vi.a)(e,[{key:"setPlayMode",value:function(e){var t=this;switch(this.playMode=e,e){case"Pause":var n;null===(n=this.sourceNode)||void 0===n||n.disconnect(),this.interval&&(clearInterval(this.interval),this.interval=void 0),this.audioElement&&this.audioElement.pause();break;case"Context":var i;null===(i=this.sourceNode)||void 0===i||i.connect(this.gainNode),this.interval&&(clearInterval(this.interval),this.interval=void 0),this.audioElement&&this.audioElement.pause();break;case"Element":var o;null===(o=this.sourceNode)||void 0===o||o.disconnect(),this.audioElement||(this.audioElement=this.createAudioElement()),this.audioElement.muted=!1,this.interval||(this.interval=setInterval((function(){var e;s.a.type||(null===t||void 0===t||null===(e=t.audioElement)||void 0===e||e.play().then((function(){t.interval&&(clearInterval(t.interval),t.interval=void 0)})).catch((function(e){})))}),500));break;default:console.error("Unknown output: ".concat(e))}this.updateAudibility(this.audibility),this.updateVolume()}},{key:"setAudioOutput",value:function(e){this.audioDeviceId!==e&&(this.audioDeviceId=e,this.audioElement&&Ji(this.audioElement,this.audioDeviceId))}},{key:"updateStream",value:function(e){this.updateSourceStream(e),this.setPlayMode(this.playMode)}},{key:"updatePose",value:function(e){var t,n,i=Object(Vi.k)(e.position),o=(i*i/(this.pannerNode.refDistance*this.pannerNode.refDistance)+this.pannerNode.refDistance-1)/(i||1);(this.distance=o*i,this.pannerNode.positionX&&this.pannerNode.orientationX)?(this.pannerNode.positionX.setValueAtTime(o*e.position[0],this.context.currentTime),this.pannerNode.positionY.setValueAtTime(o*e.position[1],this.context.currentTime),this.pannerNode.positionZ.setValueAtTime(o*e.position[2],this.context.currentTime),this.pannerNode.orientationX.setValueAtTime(e.orientation[0],this.context.currentTime),this.pannerNode.orientationY.setValueAtTime(e.orientation[1],this.context.currentTime),this.pannerNode.orientationZ.setValueAtTime(e.orientation[2],this.context.currentTime)):((t=this.pannerNode).setPosition.apply(t,Object(Nn.a)(Object(Vi.j)(o,e.position))),(n=this.pannerNode).setOrientation.apply(n,Object(Nn.a)(e.orientation)));this.updateVolume()}},{key:"updateVolume",value:function(){var e=0;"Element"===this.playMode&&(e=Math.pow(Math.max(this.distance,this.pannerNode.refDistance)/this.pannerNode.refDistance,-this.pannerNode.rolloffFactor)),this.audioElement&&(this.audioElement.volume=e)}},{key:"defaultPannerRefDistance",get:function(){return this._defaultPannerRefDistance},set:function(e){this._defaultPannerRefDistance=e,this.pannerNode.refDistance!==Zi&&(this.pannerNode.refDistance=this._defaultPannerRefDistance)}},{key:"updateBroadcast",value:function(e){this.pannerNode.refDistance=e?Zi:this.defaultPannerRefDistance}},{key:"updatePannerConfig",value:function(e){var t=this;["coneInnerAngle","coneOuterAngle","coneOuterGain","distanceModel","maxDistance","distanceModel","panningModel","refDistance","rolloffFactor"].forEach((function(n){"refDistance"===n?t.defaultPannerRefDistance=e.refDistance:t.pannerNode[n]=e[n]}))}},{key:"updateAudibility",value:function(e){e?this.gainNode.connect(this.pannerNode):this.gainNode.disconnect(),this.audioElement&&(this.audioElement.muted=!e),this.audibility=e}},{key:"disconnect",value:function(){this.sourceNode&&this.sourceNode.disconnect(),this.gainNode.disconnect(),this.pannerNode.disconnect(),this.audioElement&&(this.audioElement.volume=0,this.audioElement.pause(),this.audioElement.remove())}},{key:"isBroadcast",get:function(){return this.pannerNode.refDistance===Zi}},{key:"createGainNode",value:function(e){var t=e.createGain();return t.gain.value=1,t}},{key:"createPannerNode",value:function(e){return e.createPanner()}},{key:"updateSourceStream",value:function(e){this.sourceNode&&this.sourceNode.disconnect(),void 0!==e?(this.sourceNode=this.context.createMediaStreamSource(e),void 0===this.audioElement&&(this.audioElement=this.createAudioElement()),this.audioElement.srcObject=e):this.sourceNode=void 0}},{key:"createAudioElement",value:function(){var e=new Audio;return Ji(e,this.audioDeviceId),e}}]),e}(),eo=function(e){Object(Bi.a)(n,e);var t=Object(Ui.a)(n);function n(){var e;Object(b.a)(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).audioElementForBlob=void 0,e}return Object(vi.a)(n,[{key:"playBlob",value:function(e){this.playSourceBlob(e),this.setPlayMode(this.playMode)}},{key:"playSourceBlob",value:function(e){if(this.sourceNode&&this.sourceNode.disconnect(),void 0!==e){var t=URL.createObjectURL(e);this.audioElementForBlob&&this.audioElementForBlob.remove(),this.audioElementForBlob=this.createAudioElement(),this.audioElementForBlob.src=t,this.sourceNode=this.context.createMediaElementSource(this.audioElementForBlob),this.sourceNode.connect(this.gainNode),this.audioElementForBlob.muted=!1,function e(t){var n;null===(n=t.audioElementForBlob)||void 0===n||n.play().catch((function(){setTimeout((function(){return e(t)}),500)}))}(this),void 0===this.audioElement&&(this.audioElement=this.createAudioElement(),this.audioElement.muted=!1),this.audioElement.src=URL.createObjectURL(e),function e(t){var n;null===(n=t.audioElement)||void 0===n||n.play().catch((function(){setTimeout((function(){return e(t)}),500)}))}(this)}else this.sourceNode=void 0}},{key:"setPlayMode",value:function(e){this.playMode=e,this.updateVolume()}}]),n}($i),to=12*Fi.a,no=new(Gi=function(){function e(){Object(b.a)(this,e),Object(ot.a)(this,"coneInnerAngle",Hi,this),Object(ot.a)(this,"coneOuterAngle",zi,this),Object(ot.a)(this,"coneOuterGain",Qi,this),Object(ot.a)(this,"maxDistance",Ki,this),Object(ot.a)(this,"panningModel",Wi,this),Object(ot.a)(this,"distanceModel",Yi,this),Object(ot.a)(this,"refDistance",qi,this),Object(ot.a)(this,"rolloffFactor",Xi,this),this.refDistanceNormal=this.refDistance,Object(ct.g)(this)}return Object(vi.a)(e,[{key:"hearableRange",get:function(){return 100*this.refDistance/to}},{key:"setHearableRange",value:function(e){this.refDistanceNormal=e/100*to;var t=l.a.local.physics.onStage;this.setBroadcast(t)}},{key:"setBroadcast",value:function(e){this.refDistance=e?99999:this.refDistanceNormal}},{key:"updateParameters",value:function(e){Object.assign(this,e)}}]),e}(),Hi=Object(at.a)(Gi.prototype,"coneInnerAngle",[ct.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),zi=Object(at.a)(Gi.prototype,"coneOuterAngle",[ct.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 180}}),Qi=Object(at.a)(Gi.prototype,"coneOuterGain",[ct.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Ki=Object(at.a)(Gi.prototype,"maxDistance",[ct.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e4}}),Wi=Object(at.a)(Gi.prototype,"panningModel",[ct.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"HRTF"}}),Yi=Object(at.a)(Gi.prototype,"distanceModel",[ct.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"exponential"}}),qi=Object(at.a)(Gi.prototype,"refDistance",[ct.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.5*Fi.a}}),Xi=Object(at.a)(Gi.prototype,"rolloffFactor",[ct.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 38}}),Object(at.a)(Gi.prototype,"hearableRange",[ct.d],Object.getOwnPropertyDescriptor(Gi.prototype,"hearableRange"),Gi.prototype),Object(at.a)(Gi.prototype,"setHearableRange",[ct.b],Object.getOwnPropertyDescriptor(Gi.prototype,"setHearableRange"),Gi.prototype),Object(at.a)(Gi.prototype,"setBroadcast",[ct.b],Object.getOwnPropertyDescriptor(Gi.prototype,"setBroadcast"),Gi.prototype),Object(at.a)(Gi.prototype,"updateParameters",[ct.b],Object.getOwnPropertyDescriptor(Gi.prototype,"updateParameters"),Gi.prototype),Gi),io=no;Object(ct.c)((function(){var e=l.a.local.physics.onStage;no.setBroadcast(e)}));var oo=n(445),ao=n.n(oo),ro=.1;function so(){return.001*Date.now()}var co=Object(Y.a)({iframe:{width:"100%",height:"100%"}}),lo=function e(){Object(b.a)(this,e),this.player=void 0,this.goal="",this.skipOnPlaying=0,this.pauseIntervalTimer=0,this.lastCurrentTimePaused=0,this.playTimeout=0,this.pauseTimeout=0,this.params=new Map,this.editing=!1,this.prevRelPos=[0,0],this.volumeUI=.5,this.volumeDist=0,this.prevVolumeDist=0,this.volumeIntervalTimer=0,this.props=void 0};function uo(e){return function(e){return new Map(e.map((function(e){return e.split("=")})))}(e.split("&"))}function po(e){e.playTimeout&&(clearTimeout(e.playTimeout),e.playTimeout=0),e.pauseTimeout&&(clearTimeout(e.pauseTimeout),e.pauseTimeout=0)}function ho(e,t,n){Object(a.b)(n.player),n.goal="playing",po(n);var i=(so()-e)*n.player.getPlaybackRate();if("playing"!==n.player.getState()||0!==n.player.getPlaylist().length&&n.player.getPlaylistIndex()!==t||!(Math.abs(n.player.getCurrentTime()-i)<ro)){var o=-1e3;!function a(){if(n.player){var r=n.player.getCurrentTime();if("paused"===n.player.getState()&&Math.abs(o-r)<ro)return n.player.play(),void Object(p.b)("ytSeekAndPlay: ".concat(n.player.getState(),"  ")+"cur:".concat(n.player.getCurrentTime(),"  toSeek:").concat(i),n.params);var s=so();i=(s-e)*n.player.getPlaybackRate();o=i+1*n.player.getPlaybackRate();var c=n.player.getDuration();"unstarted"!==n.player.getState()&&c||(n.skipOnPlaying=1,n.player.play(),c=n.player.getDuration()),t>=0&&t!==n.player.getPlaylistIndex()&&(n.skipOnPlaying=1,n.player.playVideoAt(t),c=n.player.getDuration()),c&&(n.player.pause(),o>c&&(e=s+1-(o%=c)/n.player.getPlaybackRate()),n.player.seek(o)),n.playTimeout=setTimeout(a,1e3)}}()}}function fo(e,t){Object(a.b)(t.player),t.goal="paused",po(t);!function n(){if(t.player){var i=t.params.get("index"),o=Number(i||-1);if("paused"!==t.player.getState()||o>=0&&o!==t.player.getPlaylistIndex())return"unstarted"===t.player.getState()&&t.player.play(),o>=0&&o!==t.player.getPlaylistIndex()&&t.player.playVideoAt(o),t.player.pause(),void(t.pauseTimeout=setTimeout(n,333));t.player.getCurrentTime()!==e&&(t.player.seek(e),Object(p.b)("ytSeekAndPause seek to ".concat(e),t.params)),t.lastCurrentTimePaused=t.player.getCurrentTime()}}()}function mo(e,t,n){var i,o,a;(a=n.params).delete("playing"),a.delete("paused"),a.delete("ended"),n.params.set(e,String(t)),n.params.set("rate",String(null===(i=n.player)||void 0===i?void 0:i.getPlaybackRate()));var r=null===(o=n.player)||void 0===o?void 0:o.getPlaylistIndex();n.params.set("index",String(r||-1)),n.props.content.url=function(e){var t,n="",i="",o=Object(g.a)(e);try{for(o.s();!(t=o.n()).done;){var a=t.value;n+="".concat(i).concat(a[0],"=").concat(a[1]),i="&"}}catch(r){o.e(r)}finally{o.f()}return n}(n.params),n.props.updateAndSend(n.props.content),Object(p.b)("YT SEND state ".concat(e," t=").concat(t),n.params)}function vo(e){if(e.player){var t=e.player.getState();if(e.editing||""!==e.goal||"paused"!==t)e.pauseIntervalTimer&&(clearInterval(e.pauseIntervalTimer),e.pauseIntervalTimer=0);else{var n=e.player.getCurrentTime();if(Object(p.b)("YT ytPauseInterval cur:".concat(n,", last:").concat(e.lastCurrentTimePaused," param").concat(e.params.get("paused"))),Math.abs(n-e.lastCurrentTimePaused)>ro)e.lastCurrentTimePaused=n,n!==Number(e.params.get("paused"))&&mo("paused",n,e)}}}function go(e,t){t.player&&(t.volumeDist=function(e){var t=(e*e/(no.refDistance*no.refDistance)+no.refDistance-1)/(e||1)*e;return Math.pow(Math.max(t,no.refDistance)/no.refDistance,-no.rolloffFactor)}(e),t.player.setVolume(t.volumeUI*t.volumeDist*100))}function bo(e){if(e.props.stores.participants){!function(e){if(e.player){if(1===e.volumeDist&&1===e.prevVolumeDist){var t=e.player.getVolume()/100;t!==e.volumeUI&&(e.volumeUI=t)}else e.player.setVolume(e.volumeUI*e.volumeDist*100);e.prevVolumeDist=e.volumeDist}}(e);var t=Object(a.N)(e.props.content.pose.position,e.props.stores.participants.local.pose.position),n=Object(a.N)(t,e.prevRelPos);if(Object(a.B)(n)>.1*Fi.a){e.prevRelPos=[t[0],t[1]];for(var i=0;i<2;i++)t[i]<0&&(t[i]+=e.props.content.size[i],t[i]>0&&(t[i]=0));go(Object(a.B)(t),e)}}}var yo=function(e){Object(a.b)("youtube"===e.content.type);var t=co(),n=Object(f.useRef)(new lo).current;n.props=e;var i=Object(h.b)((function(){return e.stores.contents.editing===e.content.id})),o=n.params;if(n.params=uo(e.content.url),!i&&(n.editing||!Object(a.K)(n.params,o))&&n.player){n.params.get("rate")!==o.get("rate")&&n.player.setPlaybackRate(Number(n.params.get("rate")));var r=n.params.get("playing"),s=void 0!==r&&r!==o.get("playing"),c=n.params.get("paused"),l=void 0!==c&&c!==o.get("paused");s?(Object(p.b)("YT render move to play=".concat(r," state")),ho(Number(n.params.get("playing")),Number(n.params.get("index")),n)):l&&(Object(p.b)("YT render move to pause=".concat(c," state")),fo(Number(n.params.get("paused")),n))}return n.editing=i,Object(f.useEffect)((function(){Object(a.b)(e.content.id);var t=!1;if(!n.player){var i="#YT".concat(e.content.id),o=new ao.a(i);n.params.has("playing")||n.params.has("paused")||n.params.has("ended")||(t=!0,n.params.set("playing",String(-1)),o.play()),n.player=o,Object(p.b)("YTPlayer for ".concat(i," created")),n.params.has("rate")&&o.setPlaybackRate(Number(n.params.get("rate"))),n.editing||(n.params.has("paused")?fo(Number(n.params.get("paused")),n):!t&&n.params.has("playing")&&ho(Number(n.params.get("playing")),Number(n.params.get("index")),n)),o.on("error",(function(e){return Object(p.b)("YT on error ",e)})),o.on("buffering",(function(){return Object(p.b)("YT on buffering")})),o.on("cued",(function(){return Object(p.b)("YT on cued")})),o.on("unstarted",(function(){Object(p.b)("YT on unstarted"),o.unMute()})),o.on("ended",(function(){(Object(p.b)("YT on ended"),n.player)&&ho(so(),0,n)})),o.on("paused",(function(){Object(p.b)("YT on paused at ".concat(o.getCurrentTime()," goal:").concat(n.goal),n.params),"paused"===n.goal?n.goal="":""===n.goal?n.params.has("paused")||setTimeout((function(){n.params.has("paused")||n.params.has("playing")||"paused"!==o.getState()||mo("paused",o.getCurrentTime(),n)}),1e3):Object(p.b)("paused for goal ".concat(n.goal)),""!==n.goal||n.pauseIntervalTimer||(n.pauseIntervalTimer=setInterval(vo,333,n))})),o.on("playing",(function(){Object(p.b)("YT on playing goal=".concat(n.goal," skip=").concat(n.skipOnPlaying),n.params);var e=!1;if(o.getPlaylist().length>0&&o.getPlaylistIndex()!==Number(n.params.get("index"))&&(n.params.set("index",String(o.getPlaylistIndex())),e=!0),"playing"===n.goal)n.skipOnPlaying?n.skipOnPlaying=0:n.goal="";else if(""===n.goal){var t=so()-o.getCurrentTime()/o.getPlaybackRate(),i=Number(n.params.get("playing"));-1===i&&(i=t);var a=t-i;(!n.params.has("playing")||e||Math.abs(a)>ro)&&mo("playing",t,n)}})),o.on("playbackRateChange",(function(){Object(p.b)("YT on playbackRateChange");var e=so()-o.getCurrentTime()/o.getPlaybackRate(),t=o.getState();mo("paused"===t?"paused":"playing"===t?"playing":"ended",e,n)}))}var r=n.player;return r&&(n.params.has("list")?(r.loadList({listType:"playlist",list:n.params.get("list")}),Object(p.b)("YT loadList: ".concat(n.params.get("list")))):n.params.has("v")&&(r.load(n.params.get("v")),Object(p.b)("YT load: ".concat(n.params.get("v"))))),n.volumeIntervalTimer||(n.volumeIntervalTimer=setInterval(bo,200,n)),function(){n.player&&n.player.destroy(),n.player=void 0,n.volumeIntervalTimer&&clearInterval(n.volumeIntervalTimer)}}),[]),Object(T.jsx)("div",{id:"YT".concat(e.content.id),className:t.iframe})};function Ao(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;n<0&&(n=t);var i={img:Object(T.jsx)(ri.a,{style:{fontSize:t,width:"40px",height:"40px"}}),text:Object(T.jsx)(Ut.a,{style:{fontSize:t,width:"40px",height:"40px"}}),iframe:Object(T.jsx)(oi.a,{style:{fontSize:t,width:n}}),youtube:Object(T.jsx)(ci.a,{style:{fontSize:t,width:n}}),screen:Object(T.jsx)(Ft.a,{style:{fontSize:t,width:"40px",height:"40px"}}),gdrive:Object(T.jsx)("span",{style:{width:n,height:t},children:Object(T.jsx)(ei.Icon,{icon:$n.a,height:t})}),whiteboard:Object(T.jsx)("span",{style:{width:n,height:t},children:Object(T.jsx)(ei.Icon,{icon:Yn.a,height:t})}),camera:Object(T.jsx)(ni.a,{style:{fontSize:t,width:n}}),pdf:Object(T.jsx)("span",{style:{width:n,height:t},children:Object(T.jsx)(ei.Icon,{icon:Xn.a,height:t})}),playbackScreen:Object(T.jsx)(Ft.a,{style:{fontSize:t,width:n}}),playbackCamera:Object(T.jsx)(ni.a,{style:{fontSize:t,width:n}}),"":void 0};return i[e]}function So(e,t){var n=t?t.type:"";return"whiteboard"===n?e?Object(j.c)("ctEndEditWhiteboard"):Object(j.c)("ctEditWhiteboard"):"gdrive"===n?e?Object(j.c)("ctEndEditGDrive"):Object(j.c)("ctEditGDrive"):"youtube"===n?e?Object(j.c)("ctEndEditYoutube"):Object(j.c)("ctEditYoutube"):"iframe"===n?e?Object(j.c)("ctEndEditIframe"):Object(j.c)("ctEditIframe"):"text"===n?e?Object(j.c)("ctEndEditText"):Object(j.c)("ctEditText"):""}var Eo=Object(Y.a)({img:{width:"100%",height:"100%",verticalAlign:"bottom",userDrag:"none",pointerEvents:"none"},iframe:{width:"100%",height:"100%",pointerEvents:"none",border:"none"},iframeEdit:{width:"100%",height:"100%",border:"none"},div:{width:"100%",height:"100%"}}),Oo=function(e){var t=Eo(),n=Object(h.b)((function(){return e.stores.contents.editing===e.content.id}));return"img"===e.content.type?Object(T.jsx)("img",{className:t.img,src:e.content.url,alt:e.content.name}):"iframe"===e.content.type||"whiteboard"===e.content.type?Object(T.jsx)("div",{className:t.div,children:Object(T.jsx)("iframe",{className:n?t.iframeEdit:t.iframe,style:"whiteboard"===e.content.type?{backgroundColor:e.content.noFrame?"rgba(0,0,0,0)":"white"}:{},src:e.content.url,title:e.content.name},e.content.name)}):"youtube"===e.content.type?Object(T.jsx)(yo,Object(y.a)({},e)):"gdrive"===e.content.type?Object(T.jsx)(mi,Object(y.a)({},e)):"pdf"===e.content.type?Object(T.jsx)(ji,Object(y.a)({},e)):"text"===e.content.type?Object(T.jsx)(Li,Object(y.a)({},e)):"screen"===e.content.type||"camera"===e.content.type?Object(T.jsx)(Ri,Object(y.a)({},e)):"playbackScreen"===e.content.type||"playbackCamera"===e.content.type?Object(T.jsx)(ki,Object(y.a)({},e)):Object(T.jsxs)("div",{children:["Unknown type:",e.content.type," for ",e.content.url]})},Co=function(e){return m.a.useMemo((function(){return Object(T.jsx)(Oo,Object(y.a)({},e))}),[e.content.url,e.content.id,e.content.type,e.stores.contents.editing===e.content.id,e.content.pose,e.content.size,e.content.originalSize])};Co.displayName="Content";var jo=n(300),To=n(449),ko=n(450),_o=n(451),Ro=n(452),Io=n(453),wo=n.n(Io),Do=n(261),Po=n.n(Do),Mo=n(454),No=n.n(Mo),xo=n(455),Lo=n.n(xo),Fo=n(456),Bo=n.n(Fo),Uo=n(737),Vo=n(735),Jo=n(736),Go=n(734),Ho=n(733),zo=n(460),Qo=n.n(zo),Ko=n(459),Wo=n.n(Ko),Yo=n(458),qo=n.n(Yo),Xo=n(457),Zo=n.n(Xo),$o=Object(be.a)({palette:{primary:{main:"#7ececc"},secondary:{main:"#ef4623"}}});function ea(e,t,n,i,o,a){var r={margin:0,padding:2,border:"none"};return Object(T.jsxs)(Ho.a,{children:[Object(T.jsx)(Go.a,{align:"right",style:r,children:e}),Object(T.jsx)(Go.a,{align:"right",style:r,children:t}),Object(T.jsx)(Go.a,{align:"center",style:r,children:n}),Object(T.jsx)(Go.a,{style:r,children:i}),Object(T.jsx)(Go.a,{style:r,children:o})]},a)}var ta=function(){function e(t){Object(b.a)(this,e),this.zorder=void 0,this.pinned=void 0,this.showTitle=void 0,this.editing=void 0,this.name=void 0,this.pose=void 0,this.save(t)}return Object(vi.a)(e,[{key:"save",value:function(e){e.content&&(this.zorder=e.content.zorder,this.pinned=e.content.pinned,this.name=e.content.name,this.pose=e.content.pose,this.editing=e.stores.contents.editing,this.showTitle=e.content.showTitle)}},{key:"restore",value:function(e){e.content&&(e.content.zorder=this.zorder,e.content.pinned=this.pinned,e.content.name=this.name,e.content.pose=this.pose,e.content.showTitle=this.showTitle,e.stores.contents.setEditing(this.editing))}}]),e}(),na=function(e){var t=m.a.useRef(new ta(e)).current;function n(n,i){"enter"!==i&&"backdropClick"!==i||(t.save(e),e.content&&e.updateAndSend(e.content)),e.close()}var i=function(e){"Enter"===e.key&&n(0,"enter")},o=e.stores,a=o.contents,r=o.map,s=function(e){e.onClose,e.autoHideTitle,e.updateAndSend,e.updateOnly,e.close;return Object(zt.a)(e,["onClose","autoHideTitle","updateAndSend","updateOnly","close"])}(e);return Object(T.jsx)(W.a,Object(y.a)(Object(y.a)({onClose:n},s),{},{onMouseDown:function(e){e.stopPropagation()},children:Object(T.jsx)(h.a,{children:function(){var o,s,c,l,u,d;return Object(T.jsxs)(O.a,{children:[Object(T.jsx)("table",{children:Object(T.jsx)("tbody",{children:Object(T.jsxs)("tr",{children:[Object(T.jsx)("td",{children:Ao(e.content?e.content.type:"",p.a)}),Object(T.jsx)("td",{children:Object(T.jsx)(ue.a,{label:Object(j.c)("ctName"),multiline:!1,value:e.content?e.content.name:"",inputProps:{autoFocus:!0},style:{marginLeft:20,width:"100%"},onChange:function(t){e.content&&(e.content.name=t.target.value,e.updateOnly(e.content))},onKeyPress:i,fullWidth:!0})})]})})}),Object(T.jsxs)(ye.a,{theme:$o,children:[Object(T.jsxs)(A.a,{mt:2,mb:2,children:[Object(T.jsxs)(S.a,{variant:"contained",style:{textTransform:"none"},onClick:function(){e.content&&(Object(tt.u)(e.content),e.updateOnly(e.content))},children:[Object(T.jsx)(Zo.a,{}),"\xa0 ",Object(j.c)("ctMoveTop")]})," \xa0",Object(T.jsxs)(S.a,{variant:"contained",style:{textTransform:"none"},onClick:function(){e.content&&(Object(tt.t)(e.content),e.updateOnly(e.content))},children:[Object(T.jsx)(qo.a,{}),"\xa0 ",Object(j.c)("ctMoveBottom")]})," \xa0"]}),Object(T.jsxs)(A.a,{mt:2,mb:2,children:[Object(T.jsxs)(S.a,{variant:"contained",style:{textTransform:"none"},onClick:function(){e.content&&Object(tt.a)(e.content)},children:[Object(T.jsx)(ei.Icon,{icon:Ro.a,height:p.a}),"\xa0 ",Object(j.c)("ctCopyToClipboard")]})," \xa0",Object(T.jsx)(S.a,{variant:"contained",style:{textTransform:"none"},onClick:function(){e.content&&r.focusOn(e.content)},children:Object(j.c)("ctFocus")})]}),Object(T.jsx)(Vo.a,{size:"small",children:Object(T.jsx)(Jo.a,{children:[ea(Object(j.c)("ctUnTitle"),Object(T.jsx)(ei.Icon,{icon:Po.a,height:p.a}),Object(T.jsx)(Uo.a,{color:"secondary",checked:null===(o=e.content)||void 0===o?void 0:o.showTitle,onChange:function(t,n){e.content&&(e.content.showTitle=n,e.updateOnly(e.content))}}),Object(T.jsx)(ei.Icon,{icon:Po.a,height:p.a}),Object(j.c)("ctTitle"),"title"),Object(T.jsx)(f.Fragment,{children:Object(Qn.h)(e.content)?ea(So(!0,e.content),Object(T.jsx)(Re.a,{}),Object(T.jsx)(Uo.a,{color:"secondary",checked:(null===(s=e.content)||void 0===s?void 0:s.id)===a.editing,onChange:function(t,n){e.content&&a.setEditing(n?e.content.id:"")}}),Object(T.jsx)(Wo.a,{}),So(!1,e.content)):void 0},"edit"),Object(T.jsx)(f.Fragment,{children:Object(Qn.d)(e.content)?ea(Object(j.c)("ctUnWallpaper"),Object(T.jsx)(ei.Icon,{icon:jo.a,height:p.a}),Object(T.jsx)(Uo.a,{color:"secondary",checked:Object(Qn.j)(e.content),onChange:function(t,n){e.content&&(Object(tt.r)(e.content,n),e.updateOnly(e.content))}}),Object(T.jsx)(ei.Icon,{icon:To.a,height:p.a}),Object(j.c)("ctWallpaper")):void 0},"wall"),Object(T.jsx)(f.Fragment,{children:ea(Object(j.c)("ctFrameVisible"),Object(T.jsx)(ei.Icon,{icon:Po.a,height:p.a}),Object(T.jsx)(Uo.a,{color:"secondary",checked:!!(null===(c=e.content)||void 0===c?void 0:c.noFrame),onChange:function(t,n){e.content&&(e.content.noFrame=!!n||void 0,e.updateOnly(e.content))}}),Object(T.jsx)(ei.Icon,{icon:No.a,height:p.a}),Object(j.c)("ctFrameInvisible"))},"noFrame"),Object(T.jsx)(f.Fragment,{children:"img"===(null===(l=e.content)||void 0===l?void 0:l.type)?ea(Object(j.c)("ctNotAudioZone"),Object(T.jsx)(ei.Icon,{icon:jo.a,height:p.a}),Object(T.jsx)(Uo.a,{color:"secondary",checked:void 0!==(null===(u=e.content)||void 0===u?void 0:u.zone),onChange:function(t,n){e.content&&(e.content.zone=n?e.content.zone?e.content.zone:"open":void 0,e.updateOnly(e.content))}}),Object(T.jsx)(ei.Icon,{icon:ko.a,height:p.a}),Object(T.jsxs)(T.Fragment,{children:[e.content.zone?Object(T.jsx)(Me.a,{size:"small",onClick:function(){e.content&&(e.content.zone="close"===e.content.zone?"open":"close",e.updateOnly(e.content))},children:Object(T.jsx)(ei.Icon,{icon:"close"===e.content.zone?_o.a:Lo.a,height:p.a})}):void 0,"close"===e.content.zone?Object(j.c)("ctClosedAudioZone"):Object(j.c)("ctOpenAudioZone")]})):void 0},"zone"),Object(T.jsx)(f.Fragment,{children:ea(Object(j.c)("ctTransparent"),Object(T.jsx)(ei.Icon,{icon:wo.a,height:p.a}),Object(T.jsx)(ge.a,{color:"secondary",value:void 0===(null===(d=e.content)||void 0===d?void 0:d.opacity)?1e3:1e3*e.content.opacity,min:0,max:1e3,style:{width:"6em",marginLeft:"0.4em",marginRight:"0.4em"},onChange:function(t,n){e.content&&(e.content.opacity=1e3===n?void 0:n/1e3,e.updateOnly(e.content))}}),Object(T.jsx)(ei.Icon,{icon:Bo.a,height:p.a}),Object(j.c)("ctOpaque"))},"opacity")]})}),Object(T.jsxs)(A.a,{mt:2,mb:2,children:[Object(T.jsx)(S.a,{variant:"contained",color:"primary",style:{textTransform:"none"},onClick:function(){n(0,"enter")},children:Object(j.c)("btSave")}),Object(T.jsx)(S.a,{variant:"contained",color:"secondary",style:{textTransform:"none",marginLeft:15},onClick:function(){e.content&&(t.restore(e),e.updateOnly(e.content))},children:Object(j.c)("btCancel")}),Object(T.jsxs)(S.a,{variant:"contained",color:"secondary",style:{textTransform:"none",marginLeft:60},onClick:function(t){e.onClose(t)},children:[Object(T.jsx)(Qo.a,{})," \xa0 ",Object(j.c)("ctDelete")]})," \xa0\xa0"]})]})]})}})}))},ia=n(209),oa=function e(){Object(b.a)(this,e),this.buttons=0,this.dragCanceled=!1,this._borderTimer=0,this._down=!1,this._item="",this._timer=0,this.downTime=0,this.upTime=0,this.downPos=0,this.downXPos=0,this.movePos=0,this.moveXPos=0,this.onContent=!1,this.onContext=!1,this.moveX=0,this.moveY=0,this.clickStatus="",this.userAngle=0,this.clickEnter=!1,this.pingX=0,this.pingY=0,this.isMoved=!1,this.hidePinIcon=0,this.OnTimerClick=!1,this.intervalStep=0,this._zIndex=0,this._clickX=0,this._clickY=0,this._checkForRotation=!1,this._onContentForEdit=!1},aa=!1;var ra=!1;var sa=!1;function ca(){return sa}var la=!1;var ua=function(e){var t=Object(f.useState)(e.content.pose),n=Object(i.a)(t,2),o=n[0],r=n[1],s=Object(f.useState)(e.content.size),c=Object(i.a)(s,2),l=c[0],u=c[1],d=Object(f.useState)(l),v=Object(i.a)(d,2),g=v[0],b=v[1],A=Object(f.useState)(o.position),C=Object(i.a)(A,2),k=C[0],_=C[1],R=Object(f.useState)(!1),I=Object(i.a)(R,2),w=I[0],D=I[1],P=Object(f.useState)(!1),M=Object(i.a)(P,2),N=M[0],x=M[1],L=Object(f.useState)(o.orientation),F=Object(i.a)(L,2),B=F[0],U=F[1],V=Object(f.useState)(!1),J=Object(i.a)(V,2),G=J[0],H=J[1],z=Object(f.useRef)(null),Q=e.stores,K=Q.contents,W=Q.map,Y=Q.participants,q=Object(h.b)((function(){return K.editing===e.content.id}));var X=Object(f.useRef)(new oa).current,Z=Object(h.b)((function(){return e.content.showTitle})),$=Object(f.useState)(!1),ee=Object(i.a)($,2),te=ee[0],ne=ee[1],ie=Object(f.useState)(!1),oe=Object(i.a)(ie,2),ae=oe[0],re=oe[1],se=Object(f.useState)(!1),ce=Object(i.a)(se,2),le=ce[0],ue=ce[1],de=Object(f.useState)(!1),pe=Object(i.a)(de,2),he=pe[0],fe=pe[1];sa=te;var me=Object(h.b)((function(){return e.content.stopWatchToggle})),ve=Object(h.b)((function(){return e.content.stopWatchReset})),ge=Object(h.b)((function(){return e.content.scaleRotateToggle})),be=Object(f.useState)(0),ye=Object(i.a)(be,2),Ae=ye[0],Se=ye[1],Ee="img"===e.content.shareType?" Image?":"zoneimg"===e.content.shareType?" Chat Zone?":" Text?",Oe=Object(f.useState)(!1),Ce=Object(i.a)(Oe,2),je=(Ce[0],Ce[1]);function Te(){var e,t;z.current&&(z.current.resizable.orientation=o.orientation+W.rotation);var n=w?p.a:0;null===(e=z.current)||void 0===e||e.updatePosition({x:o.position[0],y:o.position[1]-n}),null===(t=z.current)||void 0===t||t.updateSize({width:l[0],height:l[1]+n})}function ke(e){e.stopPropagation(),e.preventDefault()}function _e(){X._down||(X._down=!1,X._item="DIV",window.clearTimeout(X._timer),Me(1))}function Re(){JSON.stringify(o)===JSON.stringify(e.content.pose)&&JSON.stringify(l)===JSON.stringify(e.content.size)||(e.content.size=Object(Nn.a)(l),e.content.pose=Object(y.a)({},o),e.updateAndSend(e.content),fe(!1))}function Ie(){if("single"===X.clickStatus){if(X.clickEnter)return;if(X.isMoved)return;if(le)return;if(he)return;!1,X.clickStatus="",Y.local.pingIcon=!1,Y.local.pingX=0,Y.local.pingY=0,je(!1);var t=setTimeout((function(){clearTimeout(t),function e(t){var n=Y.local,i=Object(a.N)([X.moveX,X.moveY],n.pose.position);if(Object(a.B)(i)>Fi.a/10){var o=Object(a.A)(Object(a.B)(i)/5/Object(a.B)(i),i);n.pose.orientation=180*Math.atan2(o[0],-o[1])/Math.PI,t?n.pose.position=Object(a.a)(n.pose.position,o):(re(!0),window.clearTimeout(X._borderTimer),function(){var e=setTimeout((function(){clearTimeout(e),re(!1)}),1e3)}()),n.savePhysicsToStorage(!1);setTimeout((function(){e(!0)}),0)}}(!1)}),0)}else"double"===X.clickStatus?(window.clearTimeout(X.hidePinIcon),!0,je(!0),Y.local.pingX=X.pingX,Y.local.pingY=X.pingY,Y.local.pingIcon=!0,X.hidePinIcon=window.setTimeout((function(){window.clearTimeout(X.hidePinIcon),X.clickStatus="",Y.local.pingIcon=!1,Y.local.pingX=0,Y.local.pingY=0,!1,je(!1)}),3e3)):"toggleTimer"===X.clickStatus?(X.clickStatus="",e.content.stopWatchToggle?(e.content.stopWatchToggle=!1,e.content.stopWatchReset=!1):(e.content.stopWatchToggle=!0,e.content.stopWatchReset=!1),e.updateAndSend(e.content)):"resetTimer"===X.clickStatus&&(X.clickStatus="",e.content.stopWatchToggle=!0,e.content.stopWatchReset=!0,e.updateAndSend(e.content))}void 0===e.content.zone&&("zoneimg"===e.content.shareType?e.content.zone="close":e.content.zone=void 0),Object(f.useEffect)((function(){if(X.dragCanceled=!0,e.content.showStopWatch&&!1===me&&!1===ve?X.intervalStep=window.setInterval((function(){Se((function(e){return e+10}))}),10):ve?(Se(0),window.clearInterval(X.intervalStep)):window.clearInterval(X.intervalStep),"img"!==e.content.shareType){window.clearTimeout(X._timer);var t=setTimeout((function(){clearTimeout(t),!0!==w&&(aa=!1,D(!1))}),2)}return it.a.isEqual(l,e.content.size)||u(it.a.cloneDeep(e.content.size)),it.a.isEqual(o,e.content.pose)||r(it.a.cloneDeep(e.content.pose)),function(){window.clearInterval(X.intervalStep)}}),[e.content,e.content.showStopWatch,e.content.stopWatchToggle]),Object(f.useLayoutEffect)((function(){Te()}),[o,l,w,W.rotation]);var we=e.content.pinned,De=("0"+Math.floor(Ae/6e4%60)).slice(-2)+":"+("0"+Math.floor(Ae/1e3%60)).slice(-2)+":"+("0"+Ae/10%100).slice(-2),Pe={onWheel:function(e){X._down&&w&&(X._down=!1,X._item="DIV",window.clearTimeout(X._timer),Me(0))},onDoubleClick:function(t){var n;Object(Qn.h)(e.content)&&(ke(t),n=!q,K.setEditing(n?e.content.id:""))},onDrag:function(t){var n=t.down,i=t.delta,s=t.event,c=(t.xy,t.buttons);ra=e.content.pinned,la=!0,we||w||(null===s||void 0===s||s.stopPropagation(),n&&function(e,t,n){if(!X.dragCanceled)if(2===t){var i;U((B+e[0]+e[1])%360),i=(null===n||void 0===n?void 0:n.shiftKey)||(null===n||void 0===n?void 0:n.ctrlKey)?B:B-B%15;var s=Object(a.a)(o.position,Object(a.z)(.5,l));o.position=Object(a.a)(o.position,Object(a.N)(Object(a.J)(o.orientation-i,s),s)),o.orientation=i,r(Object.assign({},o))}else{var c=W.rotateFromWindow(e),u=Object(a.J)(-o.orientation,c);o.position=Object(a.a)(o.position,u),r(Object.assign({},o))}}(i,c,s))},onDragStart:function(e){var t=e.event,n=e.currentTarget,i=(e.delta,e.buttons);w||(H(!0),X.buttons=i,X.dragCanceled=!1,n instanceof Element&&t instanceof PointerEvent&&n.setPointerCapture(null===t||void 0===t?void 0:t.pointerId))},onDragEnd:function(t){var n=t.event,i=t.currentTarget;t.delta,t.buttons,t.xy;if(la=!1,ra=!1,X._down=!1,X._item="DIV",window.clearTimeout(X._timer),"DIV"===String(Object(null===n||void 0===n?void 0:n.target).nodeName)?Me(0):Me(1),!w)if(function(){var t=!1;if(e.stores.contents.all.length>0)for(var n=0;n<e.stores.contents.all.length;n++)e.stores.contents.all[n].scaleRotateToggle&&e.stores.contents.all[n].id!==e.content.id&&(t=!0);return t}()&&X._checkForRotation)!function(){if(e.stores.contents.all.length>0)for(var t=0;t<e.stores.contents.all.length;t++)e.stores.contents.all[t].scaleRotateToggle&&e.stores.contents.all[t].id!==e.content.id&&(e.stores.contents.all[t].scaleRotateToggle=!e.stores.contents.all[t].scaleRotateToggle),!1===e.stores.contents.all[t].pinned&&e.stores.contents.all[t].id!==e.content.id&&(e.stores.contents.all[t].pinned=!0),e.stores.contents.updateByLocal(e.stores.contents.all[t])}();else{if(H(!1),X.dragCanceled||Re(),X.dragCanceled=!1,i instanceof Element&&n instanceof PointerEvent&&i.releasePointerCapture(null===n||void 0===n?void 0:n.pointerId),W.keyInputUsers.size||2!==X.buttons||(x(!0),W.keyInputUsers.add("contentForm")),X.buttons=0,e.content.scaleRotateToggle&&X._checkForRotation)return X._checkForRotation=!1,function(){var e=90;U((B+0+2)%360);var t=o.orientation+e,n=.5,i=Object(a.a)(o.position,Object(a.z)(n,l));o.position=Object(a.a)(o.position,Object(a.N)(Object(a.J)(o.orientation-t,i),i)),o.orientation=t,r(Object.assign({},o))}(),void Re();var s=e.content.size[1]-(W.mouseOnMap[1]-e.content.pose.position[1]),c=e.content.size[0]-(e.content.size[0]-(W.mouseOnMap[0]-e.content.pose.position[0]));1===(null===n||void 0===n?void 0:n.detail)?X.clickStatus=s>5&&s<35&&c>7&&c<110?"toggleTimer":"single":2===(null===n||void 0===n?void 0:n.detail)&&(s>5&&s<35&&c>7&&c<110?X.clickStatus="resetTimer":(X.clickStatus="double",X.pingX=Y.local.mouse.position[0]-Y.local.pose.position[0],X.pingY=Y.local.mouse.position[1]-Y.local.pose.position[1])),X.clickEnter=!0;var u=setTimeout((function(){clearTimeout(u),X.clickEnter&&(X.clickEnter=!1,Ie())}),250)}},onMove:function(e){var t=e.xy;if(!w){X.isMoved=!0;var n=Object(a.N)([t[0],t[1]],o.position);X.downPos=Number(n[1]),X.downXPos=Number(n[0]),W.setMouse(t)}},onPointerUp:function(e){q&&e.stopPropagation()},onPointerDown:function(e){q&&e.stopPropagation()},onMouseUp:function(e){if(q)e.stopPropagation();else{if(e.button>0)return;if(X.onContent=!1,X.isMoved=!1,X.upTime=(new Date).getSeconds(),X.upTime-X.downTime<2&&"DIV"===String(Object(e.target).tagName)&&!1===w&&(!1===X._down||w))return}},onMouseMove:function(t){ra=e.content.pinned,w||(X.movePos=Number(W.mouseOnMap[1]),X.moveXPos=Number(W.mouseOnMap[0]),X.moveXPos>=X.downXPos-20&&X.moveXPos<=X.downXPos+20&&X.movePos>=X.downPos-20&&X.movePos<=X.downPos+20?(X._down=!0,X._checkForRotation=!0):(X._down=!1,X._checkForRotation=!1))},onMouseOver:function(e){la=!0,X._onContentForEdit=!0,X._item=String(Object(e.target).tagName),window.clearTimeout(X._timer)},onMouseOut:function(e){w||(la=!1,X._onContentForEdit=!1,X.onContent=!1,ra=!1)},onMouseDown:function(t){if(q)t.stopPropagation();else{if(t.button>0)return;X._checkForRotation=!0,X.onContent=!0,X._down=!0,X.downTime=(new Date).getSeconds(),X.moveX=W.mouseOnMap[0],X.moveY=W.mouseOnMap[1],window.clearTimeout(X._timer),X._clickX=t.clientX,X._clickY=t.clientY,X._zIndex=Number(e.content.zIndex);var n=setTimeout((function(){if(clearTimeout(n),X._down&&!1===w&&!1===he){var e=Object(a.N)(W.mouseOnMap,o.position);X.downPos=Number(e[1]),X.downXPos=Number(e[0]),aa=!0,D(!0)}}),500)}},onTouchStart:function(e){q&&e.stopPropagation()},onTouchEnd:function(e){q&&e.stopPropagation()}};function Me(e){var t=setTimeout((function(){clearTimeout(t),aa=!1,D(!1)}),1e3*e)}var xe=Object.assign({},Pe);xe.onDrag=function(t){var n;we||W.keyInputUsers.has(e.content.id)||null===(n=Pe.onDrag)||void 0===n||n.call(undefined,t)};var Le=fa({props:e,pose:o,size:l,showTitle:w,showBorder:ae,pinned:e.content.pinned,dragging:G,editing:q,downPos:X.downPos,downXPos:X.downXPos,_down:X._down,_title:Z,pingX:X.pingX,pingY:X.pingY}),Fe=m.a.useRef(null),Be=m.a.useRef(null),Ve=Object(vn.a)(xe),Je=Object(vn.a)(Pe),Ge=Object(T.jsxs)("div",Object(y.a)(Object(y.a)({className:Le.rndContainer},Ve()),{},{children:[Object(T.jsxs)("div",{className:Le.content,ref:Fe,onFocus:function(){Object(Qn.f)(e.content)&&q&&W.keyInputUsers.add(e.content.id)},onBlur:function(){Object(Qn.f)(e.content)&&q&&W.keyInputUsers.delete(e.content.id)},children:[Object(T.jsx)(Co,Object(y.a)({},e)),Object(T.jsx)("div",{className:Le.nameContainer,children:e.content.name}),Object(T.jsx)("div",{className:Le.stopWatchTitle,children:De}),Object(T.jsx)("div",{className:ge&&!1===w?Le.dashedInEdit:ae&&"close"===e.content.zone?Le.dashed:void 0}),Object(T.jsx)("div",{style:{position:"absolute",width:l[0],height:l[1],top:0,left:0},children:ge&&!1===w?Object(T.jsxs)("div",{children:[Object(T.jsx)("div",{style:{width:"40px",height:"40px",position:"absolute",left:"-10px",top:"-10px",backgroundColor:"#9e886c",borderRadius:"50%"},children:Object(T.jsx)(ei.Icon,{icon:ia.a,style:{width:p.a/1.5,height:p.a/1.5,color:"white",position:"absolute",left:"9px",top:"9px"}})}),Object(T.jsx)("div",{style:{width:"40px",height:"40px",position:"absolute",left:l[0]-30,top:"-10px",backgroundColor:"#9e886c",borderRadius:"50%"},children:Object(T.jsx)(ei.Icon,{icon:ia.a,style:{width:p.a/1.5,height:p.a/1.5,color:"white",position:"absolute",left:"8.5px",top:"8px"}})}),Object(T.jsx)("div",{style:{width:"40px",height:"40px",position:"absolute",left:l[0]-30+"px",top:l[1]-30+"px",backgroundColor:"#9e886c",borderRadius:"50%"},children:Object(T.jsx)(ei.Icon,{icon:ia.a,style:{width:p.a/1.5,height:p.a/1.5,color:"white",position:"absolute",left:"8px",top:"9px"}})}),Object(T.jsx)("div",{style:{width:"40px",height:"40px",position:"absolute",left:"-10px",top:l[1]-30+"px",backgroundColor:"#9e886c",borderRadius:"50%"},children:Object(T.jsx)(ei.Icon,{icon:ia.a,style:{width:p.a/1.5,height:p.a/1.5,color:"white",position:"absolute",left:"9px",top:"9px"}})}),Object(T.jsx)("div",{style:{width:"40px",height:"40px",position:"absolute",left:l[0]/2-20,top:l[1]/2-20,backgroundColor:"#9e886c",borderRadius:"50%"},children:Object(T.jsx)(Jn.a,{style:{width:p.a,height:p.a,color:"white",position:"absolute",left:"2px",top:"3px"}})})]}):""})]}),Object(T.jsxs)("div",Object(y.a)(Object(y.a)({className:Le.titlePosition},Je()),{},{children:[Object(T.jsx)("div",{className:Le.titleContainer,onMouseLeave:function(){},onContextMenu:function(){x(!0),W.keyInputUsers.add("contentForm")},children:Object(T.jsx)(na,Object(y.a)(Object(y.a)({open:N},e),{},{close:function(){x(!1),e.content.pinned&&(aa=!1,D(!1)),W.keyInputUsers.delete("contentForm"),e.updateAndSend(e.content)},anchorEl:Fe.current,anchorOrigin:{vertical:"top",horizontal:"right"}}))}),Object(T.jsxs)(E.a,{open:le,onClose:function(){return ue(!1)},onExited:function(){return ue(!1)},keepMounted:!0,style:le?{zIndex:9999}:{zIndex:-9999},BackdropProps:{invisible:!0},children:[Object(T.jsx)(O.a,{style:{userSelect:"none",fontSize:"25px",fontWeight:"bold"},children:Object(j.c)("deleteMsg")+Ee}),Object(T.jsxs)(xn.a,{children:[Object(T.jsx)(S.a,{variant:"contained",style:{textTransform:"none",marginTop:"0.4em",backgroundColor:"orange",height:"40px",fontSize:"20px",fontWeight:"bold"},onClick:function(e){ue(!1)},children:Object(j.c)("deleteNo")}),Object(T.jsx)(S.a,{variant:"contained",style:{textTransform:"none",marginTop:"0.4em",backgroundColor:"#7ececc",height:"40px",fontSize:"20px",fontWeight:"bold"},onClick:function(t){var n;ue(!1),null===(n=e.onClose)||void 0===n||n.call(null,t)},children:Object(j.c)("deleteYes")})]})]})]}))]}));return Object(T.jsxs)("div",{className:Le.container,style:{zIndex:e.content.zIndex},onContextMenu:function(e){e.stopPropagation(),e.preventDefault()},children:["roomimg"!==e.content.shareType?Object(T.jsx)(Kn.a,{className:Le.rndCls,enableResizing:w?va:ge?ma:va,disableDragging:we,ref:z,onResizeStart:function(e){w||(X.dragCanceled=!1,e.stopPropagation(),e.preventDefault(),b(l),_(o.position))},onResize:function(t,n,i,s,c){if(!w)if(t.stopPropagation(),t.preventDefault(),X.dragCanceled)Te();else{var l=(Object(a.j)(W.matrix)+Object(a.k)(W.matrix))/2,d=[s.width/l,s.height/l],p=!1,h=[0,0];"bottomLeft"===n?(h[0]=-d[0],p=p||0!==d[0]):"topRight"===n&&(h[1]=-d[1],p=p||0!==d[1]),"topLeft"===n&&(h[1]=-d[1],p=p||0!==d[1]),p&&(o.position=Object(a.a)(k,h),r(Object.assign({},o)));var f=Object(a.a)(g,d);if(f[0]>80&&f[1]>80){if(e.content.originalSize[0]){var m=e.content.originalSize[0]/e.content.originalSize[1];f[0]>m*f[1]&&(f[0]=m*f[1]),f[0]<m*f[1]&&(f[1]=f[0]/m)}u(f)}else Re()}},onResizeStop:function(){w||(X.dragCanceled||Re(),X.dragCanceled=!1)},resizeHandleStyles:{topLeft:ga,topRight:ga,bottomLeft:ga,bottomRight:ga},dragHandleClassName:Le.cursorStyles,children:Ge}):"",Object(T.jsx)(Yt,Object(y.a)(Object(y.a)({},e),{},{open:te,onClose:function(){return ne(!1)},cordX:o.position[0]+X.downXPos,cordY:o.position[1]+X.downPos,origin:"contextmenu",_type:"menu"})),Object(T.jsx)(E.a,{open:w,onClose:function(){return D(!1)},onExited:function(){return D(!1)},keepMounted:!0,PaperProps:{style:{backgroundColor:"transparent",position:"absolute",boxShadow:"none",overflow:"hidden",left:Number(X._clickX)-207,top:Number(X._clickY)-170,zIndex:w?999:-999}},BackdropProps:{invisible:!0},children:Object(T.jsx)(O.a,{style:w?{transform:"scale(1.1)",transition:"0s ease-out"}:{transform:"scale(0)",transition:"0s ease-out"},children:Object(T.jsx)(Ne.a,{in:w,style:{transition:w?"500ms":"0ms"},children:Object(T.jsxs)("div",{className:Le.titleContainer_dialog,onMouseLeave:function(){},onContextMenu:function(){},children:[Object(T.jsx)(Ue.a,{placement:"top",title:X._down?Object(j.c)("ctMoveTop"):"",children:Object(T.jsx)("div",{className:Le.moveTopButton_dialog,onMouseUp:function(t){ke(t),Object(tt.u)(e.content),e.updateAndSend(e.content),_e()},onTouchStart:ke,onMouseLeave:_e,children:Object(T.jsx)("img",{src:"data:image/png;base64,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",height:p.a,width:p.a,alt:""})})}),Object(T.jsx)(Ue.a,{placement:"top",title:X._down?Object(j.c)("ctMoveBottom"):"",children:Object(T.jsx)("div",{className:Le.moveBottomButton_dialog,onMouseUp:function(t){ke(t),Object(tt.t)(e.content),e.updateAndSend(e.content),_e()},onTouchStart:ke,onMouseLeave:_e,children:Object(T.jsx)("img",{src:"data:image/png;base64,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",height:p.a,width:p.a,alt:""})})}),Object(T.jsx)(Ue.a,{placement:"top",title:X._down?"close"===e.content.zone?Object(j.c)("ctUnProximity"):Object(j.c)("ctProximity"):"",children:Object(T.jsx)("div",{className:Le.prox_dialog,onMouseUp:function(t){ke(t),X._down=!1,"open"===e.content.zone?e.content.zone="close":"img"===e.content.shareType?void 0===e.content.zone?e.content.zone="close":e.content.zone=void 0:e.content.zone="open",e.updateAndSend(e.content),_e()},onTouchStart:ke,onMouseLeave:_e,children:Object(T.jsx)("img",{src:(e.content.zone,Ln),height:p.a,width:p.a,alt:""})})}),Object(T.jsx)("div",{className:Le.titleButton_dialog,onMouseUp:function(e){ke(e),W.keyInputUsers.add("contentForm"),x(!0),_e()},onTouchStart:ke,onMouseLeave:_e,ref:Be,children:Object(T.jsx)("img",{src:Xt,height:p.a,width:p.a,alt:""})}),Object(T.jsx)("div",{className:Le.close_dialog,onMouseUp:function(e){ke(e),_e(),ue(!0)},onTouchStart:ke,onMouseLeave:_e,children:Object(T.jsx)("img",{src:"data:image/png;base64,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",height:p.a,width:p.a,alt:""})}),Object(T.jsx)(Ue.a,{placement:"bottom",title:X._down?Object(j.c)("ctUploadZone"):"",children:Object(T.jsx)("div",{className:Le.uploadZone_dialog,onMouseUp:function(e){_e(),ne(!0)},onTouchStart:ke,onMouseLeave:_e,children:Object(T.jsx)("img",{src:Fn,height:p.a,width:p.a,alt:""})})}),Object(T.jsx)(Ue.a,{placement:"top",title:X._down?e.content.showStopWatch?Object(j.c)("ctStopWatchOff"):Object(j.c)("ctStopWatchOn"):"",children:Object(T.jsx)("div",{className:Le.stopWatch_dialog,onMouseUp:function(t){ke(t),X._down=!1,e.content.showStopWatch?(e.content.showStopWatch=!1,e.content.stopWatchToggle=!0,e.content.stopWatchReset=!0):(e.content.showStopWatch=!0,e.content.stopWatchToggle=!1,e.content.stopWatchReset=!1),e.updateAndSend(e.content),_e()},onTouchStart:ke,onMouseLeave:_e,children:(e.content.showStopWatch,Object(T.jsx)(Un.a,{style:{width:p.a,height:p.a,color:"white"}}))})}),Object(T.jsx)(Ue.a,{placement:"top",title:X._down?e.content.scaleRotateToggle?Object(j.c)("ctUnScaleRotate"):Object(j.c)("ctScaleRotate"):"",children:Object(T.jsx)("div",{className:Le.scaleRotate_dialog,onMouseUp:function(t){ke(t),e.content.scaleRotateToggle=!e.content.scaleRotateToggle,e.content.pinned=!e.content.pinned,e.updateAndSend(e.content),_e()},onTouchStart:ke,onMouseLeave:_e,children:(e.content.scaleRotateToggle,Object(T.jsx)(Hn.a,{style:{width:p.a,height:p.a,color:"white"}}))})}),Object(T.jsx)("div",{className:w?Le.dashedCircle_dialog:void 0})]})})})})]})},da={"&":{margin:"5px",borderRadius:"50%",width:"35px",height:"35px",padding:"3px"},"&:hover":{backgroundColor:"black",margin:"5px",padding:"3px",borderRadius:"50%"},"&:active":{margin:"5px",padding:"3px",borderRadius:"50%"}},pa={"&":{margin:"5px",borderRadius:"50%",width:"35px",height:"35px",padding:"3px"},"&:hover":{backgroundColor:"#B34700",margin:"5px",padding:"3px",borderRadius:"50%"},"&:active":{margin:"5px",padding:"3px",borderRadius:"50%"}},ha={"&":{margin:"5px",borderRadius:"50%",width:"35px",height:"35px",padding:"3px"},"&:hover":{backgroundColor:"#9e886c",margin:"5px",padding:"3px",borderRadius:"50%"},"&:active":{margin:"5px",padding:"3px",borderRadius:"50%"}},fa=Object(Y.a)({container:function(e){var t=new DOMMatrix;return t.rotateSelf(0,0,e.pose.orientation),{display:e.props.hideAll?"none":"block",width:0,height:0,transform:t.toString(),position:"absolute"}},rndCls:function(e){return{borderRadius:e.showTitle?"0.5em 0.5em 0 0":"0 0 0 0",backgroundColor:e.props.content.noFrame?"rgba(0,0,0,0)":zn.useTransparent?"rgba(200,200,200,0.5)":"rgba(200,200,200,1)",boxShadow:e.props.content.noFrame?void 0:zn.useTransparent?"0.2em 0.2em 0.2em 0.2em rgba(0,0,0,0.4)":"0.2em 0.2em 0.2em 0.2em rgba(100,100,100,1)"}},rndContainer:function(e){return{width:"100%",height:"100%"}},dashed:function(e){return{position:e.props.content.showTitle?"absolute":"relative",width:e.size[0]+8,height:e.size[1]+8,borderWidth:2,borderStyle:"dashed",borderColor:"red",borderRadius:0,top:e.props.content.showTitle?"-5px":-e.size[1]-6+"px",left:"-6px"}},dashedInEdit:function(e){return{position:e.props.content.showTitle?"absolute":"relative",width:e.size[0]+8,height:e.size[1]+8,borderWidth:2,borderStyle:"dashed",borderColor:"#9e886c",borderRadius:0,top:e.props.content.showTitle?"-5px":-e.size[1]-6+"px",left:"-6px"}},titlePosition:function(e){return e.showTitle?{}:{width:0,heihgt:0,position:"absolute",top:0}},dashedCircle:function(e){return{position:"relative",width:200,height:200,borderWidth:2,borderStyle:"solid",borderColor:"#9e886c",borderRadius:"50%",opacity:.4,top:20,left:31,background:"radial-gradient(#ffffff, #ffffff, #ffffff, #9e886c, #9e886c)",zIndex:-9999}},dashedCircle_dialog:function(e){return{position:"relative",width:220,height:220,borderWidth:2,borderStyle:"solid",borderColor:"#9e886c",borderRadius:"50%",opacity:.4,top:15,left:35,background:"radial-gradient(#ffffff, #ffffff, #ffffff, #9e886c, #9e886c)",zIndex:-9999}},titleContainer_dialog:function(e){var t={display:"flex",width:"300px",height:"250px",backgroundColor:"transparent",position:"relative",cursor:"default"};return e.showTitle?(t.display="flex",t.position="relative",t.bottom="auto"):(t.display="flex",t.position="relative",t.bottom="auto",t.top="auto",t.left="auto"),t},titleContainer:function(e){var t={display:"flex",position:"relative",width:(e.pinned,350),height:(e.pinned,250),overflow:"hidden",userSelect:"none",userDrag:"none",top:"auto",left:"auto",bottom:"auto",transform:"scale(0)",backgroundColor:"transparent",transition:"0.3s ease-out",cursor:"default"};if(e.showTitle){t.display="flex",t.position="relative",t.bottom="auto";var n=Number(e.props.stores.map.matrix.a),i=1.2/n,o=165+2.7*n,a=0;a=n>=1&&n<5?380-6*n:5===n?382-5*n:n<.34?500-1*n:n>.34&&n<.4?465-1*n:400-1*n,t.top=e.downPos-o/2,t.left="img"===e.props.content.shareType?e.downXPos-180:e.downXPos-a/2,t.transform="scale("+i+")"}else t.display="flex",t.position="relative",t.bottom="auto",t.top="auto",t.left="auto",t.transform="scale(0)";return t},content:function(e){return{position:"absolute",top:(e.showTitle?p.a:0)-(e.editing?3:0),left:e.editing?-3:0,width:e.size[0],height:e.size[1],userDrag:"none",pointerEvents:e.dragging?"none":"auto",borderWidth:3,borderColor:"yellow",borderStyle:e.editing?"solid":"none",cursor:e.editing?"default":void 0,opacity:e.props.content.opacity}},note:function(e){return e.showTitle?Object(y.a)({visibility:"hidden",whiteSpace:"pre",position:"relative",top:143,left:170},da):{visibility:"hidden"}},pin:function(e){return e.showTitle?Object(y.a)({display:e.props.onShare?"none":"block",height:p.a,position:"absolute",textAlign:"center",top:128,left:86,whiteSpace:"pre",cursor:"default",background:e.pinned?"#ef4623":"#9e886c"},e.pinned?e._down?da:pa:e._down?da:ha):{display:"none"}},pin_dialog:function(e){return e.showTitle?Object(y.a)({display:e.props.onShare?"none":"block",height:p.a,position:"absolute",textAlign:"center",top:150,left:47,whiteSpace:"pre",cursor:"default",background:e.pinned?"#ef4623":"#9e886c"},e.pinned?e._down?da:pa:e._down?da:ha):{display:"none"}},prox:function(e){return e.showTitle?Object(y.a)({display:e.props.onShare?"none":"block",height:p.a,position:"relative",top:78,left:82,whiteSpace:"pre",cursor:"default",background:"close"===e.props.content.zone?"#ef4623":"#9e886c"},"close"===e.props.content.zone?e._down?da:pa:e._down?da:ha):{display:"none"}},prox_dialog:function(e){return e.showTitle?Object(y.a)({display:e.props.onShare?"none":"block",height:p.a,position:"absolute",top:128,left:38,whiteSpace:"pre",cursor:"default",background:"close"===e.props.content.zone?"#ef4623":"#9e886c"},"close"===e.props.content.zone?e._down?da:pa:e._down?da:ha):{display:"none"}},titleButton:function(e){return e.showTitle?Object(y.a)({display:"block",height:p.a,textAlign:"center",whiteSpace:"pre",position:"absolute",cursor:"default",top:127,left:230,background:"#9e886c"},da):{display:"none"}},titleButton_dialog:function(e){return e.showTitle?Object(y.a)({display:"block",height:p.a,textAlign:"center",whiteSpace:"pre",position:"absolute",cursor:"default",top:128,left:205,background:"#9e886c"},da):{display:"none"}},uploadZone:function(e){return e.showTitle?Object(y.a)({display:"block",height:p.a,position:"absolute",textAlign:"center",top:175,left:160,whiteSpace:"pre",cursor:"default",background:"#9e886c"},da):{display:"none"}},uploadZone_dialog:function(e){return e.showTitle?Object(y.a)({display:"block",height:p.a,position:"absolute",textAlign:"center",top:190,left:125,whiteSpace:"pre",cursor:"default",background:"#9e886c"},da):{display:"none"}},stopWatch:function(e){return e.showTitle?Object(y.a)({display:e.props.onShare?"none":"block",height:p.a,position:"absolute",textAlign:"center",top:36,left:110,whiteSpace:"pre",cursor:"default",background:e.props.content.showStopWatch?"#ef4623":"#9e886c"},e.props.content.showStopWatch?e._down?da:pa:e._down?da:ha):{display:"none"}},stopWatch_dialog:function(e){return e.showTitle?Object(y.a)({display:e.props.onShare?"none":"block",height:p.a,position:"absolute",textAlign:"center",top:76,left:37,whiteSpace:"pre",cursor:"default",background:e.props.content.showStopWatch?"#ef4623":"#9e886c"},e.props.content.showStopWatch?e._down?da:pa:e._down?da:ha):{display:"none"}},scaleRotate_dialog:function(e){return e.showTitle?Object(y.a)({display:e.props.onShare?"none":"block",height:p.a,position:"absolute",textAlign:"center",top:33,left:68,whiteSpace:"pre",cursor:"default",background:e.props.content.scaleRotateToggle?"#ef4623":"#9e886c"},e.props.content.showStopWatch?e._down?da:pa:e._down?da:ha):{display:"none"}},uploadImage:function(e){return e.showTitle?Object(y.a)({display:"block",height:p.a,position:"absolute",textAlign:"center",top:190,left:186,whiteSpace:"pre",cursor:"default",background:"#9e886c"},da):{display:"none"}},moveTopButton:function(e){return e.showTitle?Object(y.a)({display:"block",height:p.a,position:"absolute",textAlign:"center",top:18,left:158,whiteSpace:"pre",cursor:"default",background:"#9e886c"},da):{display:"none"}},moveTopButton_dialog:function(e){return e.showTitle?Object(y.a)({display:"block",height:p.a,position:"absolute",textAlign:"center",top:14,left:120,whiteSpace:"pre",cursor:"default",background:"#9e886c"},da):{display:"none"}},moveBottomButton:function(e){return e.showTitle?Object(y.a)({display:"block",height:p.a,position:"absolute",textAlign:"center",top:35,left:206,whiteSpace:"pre",cursor:"default",background:"#9e886c"},da):{display:"none"}},moveBottomButton_dialog:function(e){return e.showTitle?Object(y.a)({display:"block",height:p.a,position:"absolute",textAlign:"center",top:32,left:174,whiteSpace:"pre",cursor:"default",background:"#9e886c"},da):{display:"none"}},copyClipButton:function(e){return e.showTitle?Object(y.a)({display:"block",height:p.a,position:"absolute",top:"0px",left:"185px",whiteSpace:"pre",cursor:"default",background:"#9e886c"},da):{display:"none"}},edit:function(e){return e.showTitle?Object(y.a)({display:e.props.onShare||!Object(Qn.h)(e.props.content)?"none":"block",height:p.a,whiteSpace:"pre",cursor:"default",background:"#9e886c",position:"absolute",top:147,left:217},da):{display:"none"}},type:function(e){return Object(y.a)({display:e.showTitle?"block":"none",height:p.a,position:"absolute",top:105,left:50,background:"#9e886c"},da)},close:function(e){return Object(y.a)({visibility:e.showTitle?"visible":"hidden",position:"absolute",textAlign:"left",top:78,left:234,right:0,margin:0,padding:0,height:p.a,borderRadius:"0 0.5em 0 0",cursor:"default",background:"#9e886c"},da)},close_dialog:function(e){return Object(y.a)({visibility:e.showTitle?"visible":"hidden",position:"absolute",textAlign:"left",top:76,left:205,right:0,margin:0,padding:0,height:p.a,borderRadius:"0 0.5em 0 0",cursor:"default",background:"#9e886c"},da)},nameContainer:function(e){return{display:e._title&&""!==e.props.content.name?"block":"none",fontWeight:"bold",fontSize:"1.2em",width:12*e.props.content.name.length+"px",height:"20",marginLeft:(e.size[0]-12*e.props.content.name.length)/2+"px",marginBottom:5,marginTop:-(e.size[1]+38),padding:5,backgroundColor:"#7ececc",textAlign:"center",borderRadius:2,overflow:"hidden",alignContent:"center",position:"relative",bottom:5}},stopWatchTitle:function(e){return{display:e.props.content.showStopWatch?"block":"none",fontWeight:"bold",fontSize:"1.2em",width:"90px",height:"20px",marginLeft:"5px",marginBottom:"5px",padding:5,backgroundColor:"#EEDC82",textAlign:"center",borderRadius:2,overflow:"hidden",alignContent:"center",position:"absolute",bottom:0}},PingLocation:function(e){return{display:"block",height:p.a,position:"absolute",textAlign:"center",top:e.pingY-25,left:e.pingX-17,whiteSpace:"pre"}},PingLocationHide:function(e){return{display:"none",height:p.a,position:"absolute",textAlign:"center",top:e.pingY-25,left:e.pingX-17,whiteSpace:"pre"}},cursorStyles:{cursor:"auto"}}),ma={bottom:!1,bottomLeft:!0,bottomRight:!0,left:!1,right:!1,top:!1,topLeft:!0,topRight:!0},va={bottom:!1,bottomLeft:!1,bottomRight:!1,left:!1,right:!1,top:!1,topLeft:!1,topRight:!1},ga={width:"40px",height:"40px",color:"white",borderRadius:"50%",cursor:"auto"};ua.displayName="RndContent";var ba=function(e){return{onClose:function(t){Object(p.b)("RndContent onClose for ",e.content.id),t.stopPropagation(),e.stores.map.keyInputUsers.delete(e.content.id),e.stores.map.keyInputUsers.delete("contentForm"),e.stores.contents.removeByLocal(e.content.id)},updateAndSend:function(t){e.stores.contents.updateByLocal(Object.assign({},t))},updateOnly:function(t){e.stores.contents.updateLocalOnly(Object.assign({},t))}}},ya=function(e){return Object(T.jsx)(ua,Object(y.a)(Object(y.a)({},e),{},{autoHideTitle:!0},ba(e)))};ya.displayName="SharedContent";var Aa=n(248),Sa=n.n(Aa);function Ea(e){if(!Object(Qn.i)(e))return e}var Oa=function(e){var t=yn({height:e.lineHeight,fontSize:e.fontSize}),n=m.a.useState(!1),o=Object(i.a)(n,2),r=o[0],s=o[1],c=m.a.useRef(null),l=(e.lineHeight,e.content,Object(zt.a)(e,["lineHeight","content"])),u=Ea(e.stores.contents.find(e.content.id)),d=e.stores.map,f="img"===e.content.shareType?"Image":"zoneimg"===e.content.shareType?"Chat Zone":"text"===e.content.shareType?"Text":"Screen";return Object(T.jsx)(h.a,{children:function(){var n,i,o=Ao(e.content.type,e.fontSize),h=Object(a.o)(e.content.ownerName);return(null===(n=e.content.color)||void 0===n?void 0:n.length)&&(h[0]=Object(a.F)(e.content.color)),(null===(i=e.content.textColor)||void 0===i?void 0:i.length)&&(h[1]=Object(a.F)(e.content.textColor)),Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(Ue.a,{title:Object(T.jsxs)(T.Fragment,{children:[e.content.name,Object(T.jsx)("br",{}),e.content.ownerName]}),placement:"right",children:Object(T.jsxs)(S.a,{ref:c,className:t.line,style:{color:"#FFFFFF",margin:"1px 0 1px 10px",textTransform:"none",position:"relative",left:"5px",marginTop:"0px",top:"7px"},onClick:function(){var t=p.c.find(e.content.id);if(t)d.focusOn(t);else{p.c.requestContent([e.content.id]);var n=Object(ct.c)((function(){var t=p.c.find(e.content.id);t&&(d.focusOn(t),n())}))}},onContextMenu:function(){if(Ea(p.c.find(e.content.id)))s(!0),d.keyInputUsers.add("contentForm");else{p.c.requestContent([e.content.id]);var t=Object(ct.c)((function(){Ea(p.c.find(e.content.id))&&(s(!0),d.keyInputUsers.add("contentForm"),t())}))}},children:[o,Object(T.jsxs)("div",{style:{position:"relative",left:"5px",display:"flex"},children:[f,Object(T.jsx)("div",{style:{position:"relative",left:"5px",color:"#F7A76B"},children:""!==e.content.name?" ("+e.content.name+")":""})]})]})}),Object(T.jsx)(na,Object(y.a)(Object(y.a)(Object(y.a)({},l),{},{content:u},ba(e)),{},{open:r,close:function(){s(!1),d.keyInputUsers.delete("contentForm")},anchorEl:c.current,anchorOrigin:{vertical:"top",horizontal:"right"}}))]})}})},Ca=function(e){var t=e.stores.contents,n=Object(h.b)((function(){var e=Array.from(t.roomContentsInfo.size?t.roomContentsInfo.values():t.all);return e.sort((function(e,t){var n=e.name.localeCompare(t.name);return 0===n&&(n=e.ownerName.localeCompare(t.ownerName)),0===n&&(n=e.type.localeCompare(t.type)),0===n&&(n=e.id.localeCompare(t.id)),n})),e})),i=Object(h.b)((function(){return t.editing})),o=yn({height:e.lineHeight,fontSize:e.fontSize}),a=e.stores.participants,r=n.map((function(n){return Object(T.jsx)(Oa,Object(y.a)(Object(y.a)({content:n},e),{},{participant:a.find(t.owner.get(n.id))}),n.id)})),s=Object(j.d)().t;return Object(T.jsxs)("div",{className:o.container,children:[Object(T.jsxs)("div",{className:o.title,style:{color:"#FFFFFF90",marginLeft:"8px",padding:"10px",borderRadius:"5px",marginTop:"5px",userSelect:"text",fontWeight:"bold"},children:[s("Contents")," (",e.stores.contents.all.length.toString(),")",i?Object(T.jsxs)(S.a,{variant:"contained",size:"small",color:"primary",style:{marginLeft:4,padding:3,height:"1.4em",fontSize:"0.8"},onClick:function(){t.setEditing("")},children:[Object(T.jsx)(Sa.a,{style:{fontSize:"1em"}}),"\xa0",s("shareEditEnd")]}):void 0]}),r]})};Ca.displayName="ContentList";var ja=n(192),Ta=n(129),ka=n(462),_a=n.n(ka),Ra=n(463),Ia=n.n(Ra),wa=n(464),Da=n.n(wa),Pa=n(465),Ma=n.n(Pa),Na=n(466),xa=n.n(Na),La=function(e){var t,n,i=e.stats,o=Array.from(e.contents?e.contents.tracks.contentCarriers.values():[]).filter((function(e){return e&&e.jitsiConference})).map((function(e){return e.jitsiConference.connectionQuality.getStats()}));i&&o.unshift(i);var a,r,s=o.filter((function(e){return e.bitrate})).map((function(e){return e.bitrate})),c={audio:{up:s.map((function(e){return e.audio.upload})).reduce((function(e,t){return e+t}),0),down:s.map((function(e){return e.audio.download})).reduce((function(e,t){return e+t}),0)},video:{up:s.map((function(e){return e.video.upload})).reduce((function(e,t){return e+t}),0),down:s.map((function(e){return e.video.download})).reduce((function(e,t){return e+t}),0)}},l={up:(null===i||void 0===i||null===(t=i.packetLoss)||void 0===t?void 0:t.upload)||0,down:(null===i||void 0===i||null===(n=i.packetLoss)||void 0===n?void 0:n.download)||0},u=Object(j.d)().t,d="";e.isLocal&&(d=(null===(a=de.b.conference.bmRelaySocket)||void 0===a?void 0:a.readyState)===WebSocket.OPEN?config.bmRelayServer:(null===(r=de.b.conference._jitsiConference)||void 0===r?void 0:r.room)?"bridge":"prosody");return Object(T.jsxs)(W.a,{open:e.open,anchorEl:e.anchorEl,children:[Object(T.jsx)(C.a,{children:u("connectionStatus")}),Object(T.jsxs)(O.a,{children:[Object(T.jsxs)("div",{style:{overflowY:"auto"},children:[Object(T.jsxs)("div",{children:[" Quality:",Math.round(10*((null===i||void 0===i?void 0:i.connectionQuality)||0))/10," \xa0 Loss: \u21d1",l.up,"\xa0 \u21d3",l.down,"\xa0\xa0RTT:",null===i||void 0===i?void 0:i.jvbRTT]}),e.isLocal?i.transport&&0!==i.transport.length?i.transport.map((function(e,t){return Object(T.jsxs)("div",{children:["WebRTC: ",Object(T.jsxs)("span",{children:[e.ip,"/",e.type,Object(T.jsx)("br",{})]})]},t)})):Object(T.jsx)("div",{children:"No WebRTC"}):void 0,e.isLocal?Object(T.jsxs)("div",{children:[" Message: ",d]}):void 0,Object(T.jsxs)("div",{children:[" Bitrate (kbps): audio: \u21d1",c.audio.up,"\xa0 \u21d3",c.audio.down,"\xa0\xa0 video: \u21d1",c.video.up,"\xa0 \u21d3",c.video.down]})]}),Object(T.jsx)("br",{}),Object(T.jsx)(S.a,{variant:"contained",color:"primary",style:{textTransform:"none",marginTop:"0.4em"},onClick:function(t){t.stopPropagation(),e.onClose&&e.onClose()},children:u("emClose")})]}),Object(T.jsx)("br",{})]})},Fa=function(e){var t=void 0,n=e.quality;return n&&(t=Object(T.jsx)(_a.a,{className:e.className,style:{color:"red"}}),n>30&&(t=Object(T.jsx)(Ia.a,{className:e.className,style:{color:"orange"}})),n>50&&(t=Object(T.jsx)(Da.a,{className:e.className,style:{color:"gold"}})),n>70&&(t=Object(T.jsx)(Ma.a,{className:e.className,style:{color:"yellow"}})),n>90&&(t=Object(T.jsx)(xa.a,{className:e.className,style:{color:"green"}}))),Object(T.jsx)(T.Fragment,{children:t})},Ba=function(e){var t,n=m.a.useState(!1),o=Object(i.a)(n,2),a=o[0],r=o[1],s=m.a.useRef(null);return Object(T.jsxs)(Me.a,{ref:s,onClick:function(){r(!0)},children:[Object(T.jsx)(Fa,{quality:null===(t=e.stats)||void 0===t?void 0:t.connectionQuality}),e.stats?Object(T.jsx)(La,{open:a,stats:e.stats,isLocal:e.isLocal,anchorEl:s.current,onClose:function(){r(!1)}}):void 0]})},Ua=Object(be.a)({palette:{primary:{main:"#7ececc"},secondary:{main:"#ef4623"}}}),Va={fontSize:Object(Ta.i)()?"2em":"1em",height:Object(Ta.i)()?"2em":"1.5em"},Ja={height:Object(Ta.i)()?"4em":"3em"},Ga={fontSize:(Object(Ta.i)(),"1em")},Ha={fontSize:Object(Ta.i)()?"2.5rem":"1rem"},za=function(e){var t=e.stores,n=t.participants,o=t.map,r=n.local,s=Object(f.useState)(),c=Object(i.a)(s,2),l=c[0],u=c[1],d=Object(f.useState)(!1),p=Object(i.a)(d,2),v=p[0],g=p[1],b=Object(f.useState)(!1),E=Object(i.a)(b,2),k=E[0],_=E[1],R=Object(j.d)().t;function I(t,n){"enter"!==n&&"backdropClick"!==n||(r.sendInformation(),r.saveInformationToStorage(!0)),e.close()}var w=function(e){"Enter"===e.key?I(0,"enter"):"Esc"!==e.key&&"Escape"!==e.key||r.loadInformationFromStorage()};function D(e){e.preventDefault(),u(null),r.information.avatarSrc=""}function P(e){e.preventDefault(),l&&Object(ja.b)(l).then((function(e){r.information.avatarSrc=e}))}var M=m.a.useRef(null),N=m.a.useRef(null),x=(e.close,Object(zt.a)(e,["close"]));return Object(T.jsxs)(W.a,Object(y.a)(Object(y.a)({},x),{},{onClose:I,children:[Object(T.jsxs)(C.a,{children:[Object(T.jsx)("span",{style:{fontSize:Object(Ta.i)()?"2.5em":"1em"},children:R("lsTitle")}),Object(T.jsx)("span",{style:{float:"right"},children:Object(T.jsx)(Ba,{open:e.open,stats:r.quality,isLocal:!0})})]}),Object(T.jsxs)(O.a,{children:[Object(T.jsx)(h.a,{children:function(){var e=r.getColorRGB(),t=r.getTextColorRGB(),n=Object(a.u)(e)?"white":"black",i=Object(a.u)(t)?"lightgray":"gray";return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(ue.a,{label:R("YourName"),multiline:!1,value:r.information.name,style:Ja,inputProps:{style:Va,autoFocus:!0},InputLabelProps:{style:Ga},onChange:function(e){r.information.name=e.target.value},onKeyPress:w,fullWidth:!0}),Object(T.jsxs)(A.a,{mt:3,children:[Object(T.jsx)("div",{style:{fontSize:12},children:R("lsColor")}),Object(T.jsxs)(A.a,{ml:2,children:[Object(T.jsx)(S.a,{variant:"contained",style:{backgroundColor:Object(a.F)(e),color:n,textTransform:"none"},onClick:function(){g(!0)},ref:M,children:R("lsColorAvatar")}),Object(T.jsx)(W.a,{open:v,onClose:function(){g(!1)},anchorEl:M.current,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:Object(T.jsx)(fe.a,{color:{r:e[0],g:e[1],b:e[2]},disableAlpha:!0,onChange:function(e,t){t.preventDefault(),r.information.color=[e.rgb.r,e.rgb.g,e.rgb.b]}})}),Object(T.jsx)(S.a,{variant:"contained",style:{color:Object(a.F)(t),backgroundColor:i,marginLeft:15,textTransform:"none"},onClick:function(){_(!0)},ref:N,children:R("lsColorText")}),Object(T.jsx)(W.a,{open:k,anchorOrigin:{vertical:"bottom",horizontal:"right"},onClose:function(){_(!1)},anchorEl:N.current,children:Object(T.jsx)(fe.a,{color:{r:t[0],g:t[1],b:t[2]},onChange:function(e,t){t.preventDefault(),r.information.textColor=[e.rgb.r,e.rgb.g,e.rgb.b]}})}),Object(T.jsx)(S.a,{variant:"contained",style:{marginLeft:15,textTransform:"none"},onClick:function(){r.information.color=[],r.information.textColor=[]},children:R("lsAutoColor")})]})]}),Object(T.jsxs)(A.a,{mt:3,children:[Object(T.jsx)("div",{style:{fontSize:12},children:R("lsImage")}),Object(T.jsxs)(A.a,{mt:-1,ml:2,children:[Object(T.jsxs)("form",{onSubmit:P,style:{lineHeight:"2em",fontSize:Object(Ta.i)()?"2.5em":"1em"},children:[Object(T.jsx)("div",{style:{fontSize:12,marginTop:8},children:R("lsImageFile")}),r.information.avatarSrc?Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("img",{src:r.information.avatarSrc,style:{height:"1.5em",verticalAlign:"middle"},alt:"avatar"}),Object(T.jsx)("input",{style:Ha,type:"submit",onClick:D,value:"\u2715"})," \xa0"]}):void 0,Object(T.jsx)("input",{style:Ha,type:"file",onChange:function(e){var t;u(null===(t=e.target.files)||void 0===t?void 0:t.item(0))}}),Object(T.jsx)("input",{style:Ha,type:"submit",value:"Upload"})]},"information"),Object(T.jsx)(ue.a,{label:R("lsEmail"),multiline:!1,value:r.info.email,style:Object(y.a)(Object(y.a)({},Ja),{},{marginTop:8}),inputProps:{style:Va,autoFocus:!1},InputLabelProps:{style:Ga},onChange:function(e){return r.info.email=e.target.value},onKeyPress:w,fullWidth:!0})]})]}),Object(T.jsx)(ye.a,{theme:Ua,children:Object(T.jsxs)(A.a,{mt:3,children:[Object(T.jsx)("div",{style:{fontSize:12},children:R("lsNotification")}),Object(T.jsxs)(A.a,{mt:-1,ml:2,children:[Object(T.jsx)(me.a,{control:Object(T.jsx)(ke.a,{color:"secondary",checked:r.information.notifyCall,onChange:function(e){r.information.notifyCall=e.target.checked}}),label:R("lsNotifyCall")}),Object(T.jsx)(me.a,{control:Object(T.jsx)(ke.a,{color:"secondary",checked:r.information.notifyTouch,onChange:function(e){r.information.notifyTouch=e.target.checked}}),label:R("lsNotifyTouch")}),Object(T.jsx)(me.a,{control:Object(T.jsx)(ke.a,{color:"secondary",checked:r.information.notifyNear,onChange:function(e){r.information.notifyNear=e.target.checked}}),label:R("lsNotifyNear")}),Object(T.jsx)(me.a,{control:Object(T.jsx)(ke.a,{color:"secondary",checked:r.information.notifyYarn,onChange:function(e){r.information.notifyYarn=e.target.checked}}),label:R("lsNotifyYarn")})]})]})})]})}}),Object(T.jsx)(ye.a,{theme:Ua,children:Object(T.jsxs)(A.a,{mt:4,mb:3,children:[Object(T.jsx)(S.a,{variant:"contained",color:"primary",style:{textTransform:"none"},onClick:function(){I(0,"enter")},children:R("btSave")}),Object(T.jsx)(S.a,{variant:"contained",color:"secondary",style:{marginLeft:15,textTransform:"none"},onClick:function(){r.loadInformationFromStorage()},children:R("btCancel")}),Object(T.jsx)(S.a,{variant:"contained",style:{marginLeft:15,textTransform:"none"},onClick:function(){o.focusOn(r)},children:R("ctFocus")})]})})]})]}))},Qa=function(e){var t,n,o,a=e.stores.roomInfo,s=m.a.useState(""),c=Object(i.a)(s,2),u=c[0],d=c[1],h=m.a.useState(""),f=Object(i.a)(h,2),v=f[0],g=f[1];function b(t,n){e.close()}var E=Object.assign({},e);return delete E.close,Object(T.jsxs)(W.a,Object(y.a)(Object(y.a)({},E),{},{onClose:b,children:[Object(T.jsxs)(C.a,{children:[null===(t=e.participant)||void 0===t?void 0:t.information.name,Object(T.jsx)("span",{style:{float:"right"},children:Object(T.jsx)(Ba,{open:e.open,stats:null===(n=e.participant)||void 0===n?void 0:n.quality})})]}),Object(T.jsxs)(O.a,{children:[Object(T.jsx)(A.a,{mb:2,children:Object(T.jsx)(S.a,{variant:"contained",style:{textTransform:"none"},onClick:function(){var t;b(),null===(t=e.participant)||void 0===t||t.call()},children:Object(j.c)("rsCall")})}),Object(T.jsx)(A.a,{mb:2,children:Object(T.jsx)(S.a,{variant:"contained",style:{textTransform:"none"},onClick:function(){e.participant&&(l.a.yarnPhones.has(e.participant.id)?l.a.yarnPhones.delete(e.participant.id):l.a.yarnPhones.add(e.participant.id),b())},children:e.participant&&l.a.yarnPhones.has(e.participant.id)?Object(j.c)("rsCutYarnPhone"):Object(j.c)("rsConnectYarnPhone")})}),Object(T.jsx)(A.a,{mb:2,children:Object(T.jsx)(S.a,{variant:"contained",style:{textTransform:"none"},onClick:function(){e.participant&&(r.b.sendTo=e.participant.id,b())},children:Object(j.c)("rsChatTo",{name:null===(o=e.participant)||void 0===o?void 0:o.information.name})})}),Object(T.jsx)(A.a,{mb:2,children:Object(T.jsx)(S.a,{variant:"contained",style:{textTransform:"none"},onClick:function(){e.participant&&e.stores.map.focusOn(e.participant)},children:Object(j.c)("ctFocus")})}),a.passMatched&&Object(T.jsxs)(T.Fragment,{children:[Object(T.jsxs)(A.a,{mb:2,children:["To kick this user type 'kick' and enter. \u2009",Object(T.jsx)(ue.a,{label:"kick",type:"text",style:{marginTop:-22},value:u,onChange:function(e){d(e.currentTarget.value)},onKeyPress:function(t){if("Enter"===t.key&&"kick"===u){if(!e.participant)return;de.b.conference.kickParticipant(e.participant.id),setTimeout((function(){de.b.conference.sendMessage(pe.b.KICK,"Kicked by administrator.",e.participant.id)}),5e3),e.close()}}})]}),Object(T.jsxs)(A.a,{mb:2,children:["Clear this user's contents.\u2009",Object(T.jsx)(ue.a,{label:"clear",type:"text",style:{marginTop:-22},value:v,onChange:function(e){g(e.currentTarget.value)},onKeyPress:function(t){if("Enter"===t.key&&"clear"===v){if(!e.participant)return;var n=p.c.participants.get(e.participant.id);null===n||void 0===n||n.myContents.forEach((function(e){return p.c.removeByLocal(e.id)})),e.close()}}})]})]})]})]}))},Ka=n(668),Wa=n(671),Ya=Object(be.a)({palette:{primary:{main:"#7ececc"},secondary:{main:"#ef4623"}}}),qa=function e(){Object(b.a)(this,e),this.address="",this.port=0,this.protocol=""},Xa=function e(){Object(b.a)(this,e),this.remotes=[]},Za=new function e(){Object(b.a)(this,e),this.sessions=[],this.open=!1,this.update=!1,this.interval=void 0,this.messageServer=""},$a=function(e){var t,n,o,a=Object(f.useState)(!1),r=Object(i.a)(a,2),s=r[0],c=r[1];Za.open=!0===e.open,Za.update=s,e.open?Za.interval||(Za.interval=setInterval((function(){var e,t,n=null===(e=de.b.conference._jitsiConference)||void 0===e?void 0:e.room;if(Za.open&&n){var i,o,a,r=null===(i=n.xmpp)||void 0===i||null===(o=i.connection)||void 0===o||null===(a=o.jingle)||void 0===a?void 0:a.sessions,s=Object.keys(r).length;for(Za.sessions.splice(s);Za.sessions.length<s;)Za.sessions.push(new Xa);for(var l in r){var u,d,p=null===(u=r[l])||void 0===u||null===(d=u.peerconnection)||void 0===d?void 0:d.peerconnection;p&&p.getStats().then((function(e){var t=[];e.forEach((function(e,n){"candidate-pair"===e.type&&(e.bytesReceived>0||e.bytesSent>0)&&t.push(e)}));var n=t.map((function(e){return e.remoteCandidateId})),i=Za.sessions[Za.sessions.length-1];i.remotes=[],n.forEach((function(t){var n=new qa,o=e.get(t);n.address=o.address,n.port=o.port,n.protocol=o.protocol,i.remotes.push(n)}))}))}c(!Za.update)}if((null===(t=de.b.conference.bmRelaySocket)||void 0===t?void 0:t.readyState)===WebSocket.OPEN)Za.messageServer=config.bmRelayServer;else{var h,f=null===(h=de.b.conference._jitsiConference)||void 0===h?void 0:h.room;Za.open&&f?Za.messageServer="bridge":Za.messageServer="prosody"}}),100)):Za.interval&&(clearInterval(Za.interval),Za.interval=void 0);var l=e.close,u=Object(zt.a)(e,["close"]),d=null===(t=de.b.conference._jitsiConference)||void 0===t?void 0:t.connectionQuality.getStats(),h=Array.from(p.c.tracks.contentCarriers.values()).filter((function(e){return e&&e.jitsiConference})).map((function(e){return e.jitsiConference.connectionQuality.getStats()}));d&&h.unshift(d);var m=h.filter((function(e){return e.bitrate})).map((function(e){return e.bitrate})),v={audio:{up:m.map((function(e){return e.audio.upload})).reduce((function(e,t){return e+t}),0),down:m.map((function(e){return e.audio.download})).reduce((function(e,t){return e+t}),0)},video:{up:m.map((function(e){return e.video.upload})).reduce((function(e,t){return e+t}),0),down:m.map((function(e){return e.video.download})).reduce((function(e,t){return e+t}),0)}},g={up:(null===d||void 0===d||null===(n=d.packetLoss)||void 0===n?void 0:n.upload)||0,down:(null===d||void 0===d||null===(o=d.packetLoss)||void 0===o?void 0:o.download)||0},b=new Set;for(var A in null===d||void 0===d?void 0:d.codec){var E=null===d||void 0===d?void 0:d.codec[A];for(var O in E)b.add(E[O].audio),b.add(E[O].video)}var C=Array.from(b);return Object(T.jsx)(Wa.a,Object(y.a)(Object(y.a)({},u),{},{children:Object(T.jsxs)(Ka.a,{style:{background:"rgba(255,255,255,0.6)",padding:"0.4em"},children:[Object(T.jsxs)("div",{style:{overflowY:"auto"},children:[Object(T.jsx)("strong",{children:"Servers"}),Object(T.jsx)("br",{}),0===Za.sessions.length?Object(T.jsx)("div",{children:"No WebRTC"}):Za.sessions.map((function(e,t){return Object(T.jsxs)("div",{children:["WebRTC: ",e.remotes.map((function(e,t){return Object(T.jsxs)("span",{children:[e.address," ",e.port,"/",e.protocol,Object(T.jsx)("br",{})]},t.toString())}))]},t)})),Object(T.jsxs)("div",{children:[" Message: ",Za.messageServer]}),Object(T.jsxs)("div",{children:[" Bitrate (kbps): audio: \u21d1",v.audio.up,"\xa0 \u21d3",v.audio.down,"\xa0\xa0 video: \u21d1",v.video.up,"\xa0 \u21d3",v.video.down]}),Object(T.jsxs)("div",{children:[" Quality:",Math.round(10*((null===d||void 0===d?void 0:d.connectionQuality)||0))/10," \xa0 Loss: \u21d1",g.up,"\xa0 \u21d3",g.down,"\xa0\xa0RTT:",null===d||void 0===d?void 0:d.jvbRTT,C.length?Object(T.jsxs)(T.Fragment,{children:["\xa0\xa0Codecs:","".concat(C)]}):void 0]})]}),Object(T.jsx)(ye.a,{theme:Ya,children:Object(T.jsx)(S.a,{variant:"contained",color:"primary",style:{textTransform:"none",marginTop:"0.4em"},onClick:l,children:" Close "})})]})}))},er=function(e){var t=e.stores.map,n=Object(h.b)((function(){return e.participant.information.name})),o=Object(h.b)((function(){return e.participant.information.avatarSrc})),a=Object(h.b)((function(){return Object(Fi.f)(e.participant.information)})),r=Object(h.b)((function(){return e.lineHeight})),s=yn({height:e.lineHeight,fontSize:e.fontSize}),c=m.a.useState(!1),l=Object(i.a)(c,2),u=l[0],d=l[1],p=m.a.useRef(null),f=(e.lineHeight,Object(zt.a)(e,["lineHeight"])),v=Object(h.b)((function(){var t;return null===(t=e.participant.quality)||void 0===t?void 0:t.connectionQuality})),b=Object(h.b)((function(){var t,n=Array.from(e.stores.participants.remote.keys()).filter((function(t){return t!==e.stores.participants.localId})),o=Object(g.a)(n.entries());try{for(o.s();!(t=o.n()).done;){var a,r,s,c,l,u,d=Object(i.a)(t.value,1)[0];if(void 0===(null===(a=e.stores.participants.remote.get(n[d]))||void 0===a?void 0:a.closedZone))return"";if((null===(r=e.stores.participants.remote.get(n[d]))||void 0===r?void 0:r.id)===e.participant.id&&""!==(null===(s=e.stores.participants.remote.get(n[d]))||void 0===s||null===(c=s.closedZone)||void 0===c?void 0:c.name))return" ("+(null===(l=e.stores.participants.remote.get(n[d]))||void 0===l||null===(u=l.closedZone)||void 0===u?void 0:u.name)+")"}}catch(p){o.e(p)}finally{o.f()}})),A=Object(h.b)((function(){var t,n,i;return void 0!==(null===(t=e.stores.participants.local.zone)||void 0===t?void 0:t.name)&&""!==(null===(n=e.stores.participants.local.zone)||void 0===n?void 0:n.name)?" ("+(null===(i=e.stores.participants.local.zone)||void 0===i?void 0:i.name)+")":""}));function E(){if(e.participant.physics.located)t.focusOn(e.participant);else{config.bmRelayServer&&de.b.conference.pushOrUpdateMessageViaRelay(pe.b.REQUEST_PARTICIPANT_STATES,[e.participant.id]);var n=Object(ct.c)((function(){e.participant.physics.located&&(t.focusOn(e.participant),n())}))}}function O(){if(e.participant.physics.located)d(!0),t.keyInputUsers.add("participantList");else{config.bmRelayServer&&de.b.conference.pushOrUpdateMessageViaRelay(pe.b.REQUEST_PARTICIPANT_STATES,[e.participant.id]);var n=Object(ct.c)((function(){e.participant.physics.located&&(d(!0),t.keyInputUsers.add("participantList"),n())}))}}return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(Ue.a,{title:"".concat(e.participant.information.name," (").concat(e.participant.id,")"),placement:"right",children:Object(T.jsxs)("div",{className:s.outer,style:{margin:"1px 0 1px 10px"},children:[Object(T.jsx)(Me.a,{style:{margin:0,padding:0,marginTop:"5px",marginLeft:"5px"},onClick:E,onContextMenu:O,children:Object(T.jsx)(Tn,{border:!0,colors:a,size:2*r,name:n,avatarSrc:o})}),Object(T.jsxs)(S.a,{className:s.line,ref:p,style:{color:"#FFFFFF",textTransform:"none",marginLeft:"10px",marginTop:"5px",fontWeight:"bold"},onClick:E,onContextMenu:O,children:[n,Object(T.jsx)("div",{style:{color:"#EDA741",letterSpacing:"0px",position:"relative",marginLeft:"5px"},children:e.stores.participants.localId===e.participant.id?A:b})]}),Object(T.jsx)("div",{style:{position:"absolute",width:"10px",height:"10px",right:"25px",marginTop:"2px"},children:void 0!==v&&v>80?Object(T.jsx)("img",{width:"40px",height:"40px",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAABoklEQVR4nO3asc3TUBSA0RvEIP8a6TwKO2QAYIDswCaYKi0jZAQ2MBUSrSOC88E5jRs/+Uqf/Ipnn7ZtG5reHT0AjxMvTLww8cLECxMvTLww8cLECxMvTLww8cLECxMvTLww8cLECxMvTLww8cLECxMvTLww8cLECxMvTLww8cLECxMvTLyw90cPcLTrbXmbmbcdS35czuv350yzz38fb2Y+zMzHHfd/m5nlKZPsZNsMEy9MvDDxwsQLEy9MvDDxwsQLEy9MvLB/4mzzeluWmfm6Z83lvJ6eM83f480LEy9MvDDxwsQLEy9MvDDxwsQLEy9MvDDxwl7qYPp6Wz7tXPLlcl7vTxgl4aXizb4/l2dm1pm5//kxGmybYeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4Ya/2Jf3zzvvvv133rv1lffCZhztt23b0DDzIthkmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKF/QQEgh1Eo89xKgAAAABJRU5ErkJggg==",draggable:!1,style:{userSelect:"none"},alt:""}):void 0!==v&&v<80&&v>50?Object(T.jsx)("img",{width:"40px",height:"40px",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAABp0lEQVR4nO3csXETURRA0bfYEVUQ0QajCtyCW6ETWnAFVgP0QEYBRASedWAC0m8Q2mvOSZTojd7MHf3g70jbvu9D07trL8DriRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXph4YeKFiRcmXtjttRe4pm3bbmbm/crMvu8/LrTOsv863ryE+7g48/USi7yGYzNMvDDxwsQLEy9MvDDxwsQLEy9MvDDxwt7E3ebTw2n13+9ON3eP50vs8i/55oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhhh7mYfno43c/Mh4WR81u4XP4Th4k3M/cz82lx5vz31+hwbIaJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oUd6Un6l1l7Mv77ez8vfta3X68/Z+b74uxhbPu++rtEjsKxGSZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oWJFyZemHhh4oU9A1m1HKAM8GK/AAAAAElFTkSuQmCC",draggable:!1,style:{userSelect:"none"},alt:""}):Object(T.jsx)("img",{width:"40px",height:"40px",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAABqElEQVR4nO3ZMUrFQBRG4X9EtLIRGwtL3aa+nbgUN+AGtAlY2Nk8EF4h18YN3PBicvR8TZoZcuGQKSajqiKmk7UH0HzGAzMemPHAjAdmPDDjgRkPzHhgxgMzHpjxwIwHZjww44EZD8x4YMYDMx6Y8cCMB2Y8MOOBGQ/MeGDGAzMemPHAjAdmPDDjgZ2uPcDaxhhnSc4bW76q6nOpeTr+fbwkV0muG+v3SV4WmqXFYxPMeGDGAzMemPHAjAdmPDDjgRkPzHhgxgP7E3ebY4yLJHedPVX1vNA4v8YvD8x4YMYDMx6Y8cCMB2Y8MOOBGQ/MeGDGAzMe2KYupj9ubh+aWx4v316nBUZB2FS8JPfN9U9JpuOPweCxCWY8MOOBGQ/MeGDGAzMemPHAjAdmPDDjgRkPzHhgxgMzHpjxwIwHtrU/6bvm+unneUjyPvOd++b6w8z3HN2oqrVn0Ewem2DGAzMemPHAjAdmPDDjgRkPzHhgxgMzHpjxwIwHZjww44EZD8x4YMYDMx6Y8cCMB2Y8MOOBGQ/MeGDGAzMemPHAjAdmPDDjgRkP7BvKkh4pxeVM2gAAAABJRU5ErkJggg==",draggable:!1,style:{userSelect:"none"},alt:""})})]})}),e.participant.id===e.stores.participants.localId?Object(T.jsx)(za,{stores:e.stores,open:u,close:function(){d(!1),t.keyInputUsers.delete("participantList")},anchorEl:p.current,anchorOrigin:{vertical:"top",horizontal:"right"}}):Object(T.jsx)(Qa,Object(y.a)(Object(y.a)({},f),{},{open:u,close:function(){d(!1),t.keyInputUsers.delete("participantList")},participant:e.stores.participants.remote.get(e.participant.id),anchorEl:p.current,anchorOrigin:{vertical:"top",horizontal:"right"}}))]})},tr=function(e){var t=m.a.useState(!1),n=Object(i.a)(t,2),o=n[0],a=n[1],r=e.stores.participants,s=yn({height:e.lineHeight,fontSize:e.fontSize}),c=e.localId,l=e.remoteIds,u=e.lineHeight,d=e.fontSize,p=Object(zt.a)(e,["localId","remoteIds","lineHeight","fontSize"]),h=Object(y.a)({lineHeight:u,fontSize:d},p);l.sort((function(e,t){var n=r.remote.get(e),i=r.remote.get(t),o=n.information.name.localeCompare(i.information.name,void 0,{sensitivity:"accent"});return 0===o&&(o=(n.information.avatarSrc||"").localeCompare(i.information.avatarSrc||"",void 0,{sensitivity:"accent"})),o}));var f=l.map((function(e){return Object(T.jsx)(er,Object(y.a)({participant:r.remote.get(e)},h),e)})),v=Object(T.jsx)(er,Object(y.a)({participant:r.local},h),c),g=m.a.useRef(null);return Object(T.jsxs)("div",{className:s.container,children:[Object(T.jsxs)("div",{className:s.title,style:{color:"#FFFFFF90",marginLeft:"8px",padding:"10px",borderRadius:"5px",marginTop:"5px",userSelect:"text",fontWeight:"bold"},ref:g,onClick:function(){a(!0)},children:[de.b.conference.name," (",(r.remote.size+1).toString(),")"]}),Object(T.jsx)($a,Object(y.a)(Object(y.a)({open:o,close:function(){a(!1)}},p),{},{anchorEl:g.current})),v,f]})};tr.displayName="ParticipantList";var nr=m.a.memo((function(e){var t=Object(h.b)((function(){return e.stores.participants.localId})),n=Object(h.b)((function(){return Array.from(e.stores.participants.remote.keys())}));return Object(T.jsx)(tr,Object(y.a)(Object(y.a)({},e),{},{localId:t,remoteIds:n}))})),ir={lineHeight:20,fontSize:16};var or=Object.assign({},ir),ar=function(e){var t=bn(),n=Object(f.useState)(1),o=Object(i.a)(n,2),a=o[0],r=o[1],s=Object(vn.a)({onPinch:function(e){var t=Object(i.a)(e.da,2),n=t[0],o=t[1],s=(e.origin,e.event,e.memo);if(void 0===s)return[n,o];var c=Object(i.a)(s,1)[0];return function(e){Object.assign(or,ir),or.fontSize*=e,or.lineHeight*=e,r(e)}(function(e,t){var n=e*t;return n>4?4:n<.5?.5:n}(a,n>10?n/c:n<-10?c/n:1+(n-c)/10)),[n,o]}},{eventOptions:{passive:!1}}),c=Object(h.b)((function(){return ns})),l=Object(h.b)((function(){return is}));return console.log(c," status ",l),Object(T.jsx)("div",Object(y.a)(Object(y.a)({},s()),{},{children:"chat"===l?Object(T.jsxs)(v.a,{split:"horizontal",defaultSize:"50%",resizerClassName:t.resizerHorizontal,paneStyle:{overflowY:"auto",overflowX:"hidden",width:"100%",minWidth:"280px"},children:[Object(T.jsx)(nr,Object(y.a)(Object(y.a)({},e),or)),Object(T.jsx)(Mn,Object(y.a)(Object(y.a)({},e),or))]}):Object(T.jsx)(v.a,{split:"horizontal",defaultSize:"100%",resizerClassName:t.resizerHorizontal,paneStyle:{overflowY:"auto",overflowX:"hidden",width:"100%",minWidth:"280px"},children:Object(T.jsx)(Ca,Object(y.a)(Object(y.a)({},e),or))})}))};ar.displayName="LeftBar";var rr=Object(Y.a)({videoContainer:{height:"100%",width:"100%",backgroundColor:"none"},video:{marginLeft:"auto",marginRight:"auto",display:"block",width:"100%"}}),sr=function(e,t){e.srcObject=t,e.autoplay=!0},cr=function(e){var t=rr(),n=Object(h.b)((function(){return e.stores.contents.tracks.mainStream})),o=Object(f.useRef)(null);Object(f.useEffect)((function(){o&&o.current&&sr(o.current,n||null)}),[n]);var a=Object(f.useState)(),r=Object(i.a)(a,2),s=r[0],c=r[1],l=Object(f.useRef)({});l.current.debugVideos=s;var u=Object(f.useRef)([]);if(e.showAllTracks){for(;u.current.length<(s?s.length:0);)u.current.push(m.a.createRef());u.current.forEach((function(e,t){e.current&&s&&t<s.length&&sr(e.current,s[t].stream)}))}Object(f.useEffect)((function(){if(e.showAllTracks){var t;(null===(t=l.current)||void 0===t?void 0:t.interval)&&(clearInterval(l.current.interval),l.current.interval=void 0),l.current.interval=setInterval((function(){var e=d.tpc;if(e&&e.peerconnection){var t=[],n=new Set(e.peerconnection.getLocalStreams()),i=new Set(e.peerconnection.getRemoteStreams());e.localTracks.forEach((function(i,o){var a=i.getOriginalStream(),r=n.delete(a);t.push({stream:a,label:"Local ssrc:".concat(e.getLocalSSRC(i),"\ntype:").concat(i.getType(),"\n")+"videoType:".concat(i.videoType,"\nmsid:").concat(null===a||void 0===a?void 0:a.id)+(r?"OK":" NOT in pc"),color:"blue"})}));var o,a=Object(g.a)(n.values());try{for(a.s();!(o=a.n()).done;){var r=o.value;t.push({stream:r,label:"Local X msid:".concat(null===r||void 0===r?void 0:r.id),color:"red"})}}catch(m){a.e(m)}finally{a.f()}e.remoteTrackMaps.forEach((function(e){e.forEach((function(e,n){var o=e.getOriginalStream(),a=i.delete(o);t.push({stream:o,label:"Remote ssrc:".concat(e.getSSRC(),"\ntype:").concat(e.getType(),"\n")+"videoType:".concat(e.videoType,"\nmsid:").concat(null===o||void 0===o?void 0:o.id)+(a?"OK":" NOT in pc"),color:"red"})}))}));var s,p=Object(g.a)(i.values());try{for(p.s();!(s=p.n()).done;){var h=s.value;t.push({stream:h,label:"Remote X msid:".concat(null===h||void 0===h?void 0:h.id),color:"blue"})}}catch(m){p.e(m)}finally{p.f()}var f=u.current.map((function(e){return!!e}));it.a.isEqual(l.current.elementFlags,f)&&it.a.isEqual(l.current.debugVideos,t)||(c(t),l.current.elementFlags=it.a.cloneDeep(f))}}),1e3)}else{var n;(null===(n=l.current)||void 0===n?void 0:n.interval)&&(clearInterval(l.current.interval),l.current.interval=void 0)}}),[e.showAllTracks]);var p=e.showAllTracks&&s?s.map((function(e,t){return Object(T.jsxs)("div",{style:{display:"inline-block",position:"relative",verticalAlign:"top"},children:[Object(T.jsx)("video",{style:{width:300},ref:u.current[t]}),Object(T.jsx)("div",{style:{position:"absolute",left:0,top:0,color:e.color,whiteSpace:"pre-wrap"},children:e.label})]},t)})):void 0;return Object(T.jsxs)("div",{className:t.videoContainer,children:[Object(T.jsx)("video",{ref:o,className:t.video,style:{visibility:n?"visible":"hidden"}}),Object(T.jsx)("div",{style:{position:"absolute",left:0,top:0},children:p})]})};cr.displayName="MainScreen";var lr=n(467),ur=n.n(lr);function dr(e,t){var n=e*t;return n>c.a.maxScale?c.a.maxScale/e:n<c.a.minScale?c.a.minScale/e:t}var pr=Object(Y.a)({root:{position:"absolute",width:"100%",height:"100%",top:0,left:0,userDrag:"none",userSelect:"none",overflow:"hidden"},center:{position:"absolute",margin:"auto",left:0,right:0,top:0,bottom:0,width:0,height:0},transform:function(e){return{position:"absolute",width:0,height:0,transform:e.matrix.toString()}},hideMenuContainer:function(e){return{display:"flex",position:"relative",width:350,height:250,overflow:"hidden",userSelect:"none",userDrag:"none",bottom:"auto",transform:"scale(0)",backgroundColor:"transparent",transition:"0s ease-out",cursor:"default"}},showMenuContainer:function(e){return{display:"flex",position:"relative",width:350,height:250,overflow:"hidden",userSelect:"none",userDrag:"none",top:e.mem.zoomY-125,left:e.mem.zoomX-170,bottom:"auto",transform:"scale(1.2)",backgroundColor:"transparent",transition:"0.3s ease-out",transitionDelay:"0.1s",cursor:"default"}},dashedCircle:function(e){return{position:"relative",width:200,height:200,borderWidth:2,borderStyle:"solid",borderColor:"#9e886c",borderRadius:"50%",opacity:.4,top:25,left:65,background:"radial-gradient(#ffffff, #ffffff, #ffffff, #9e886c, #9e886c)",zIndex:-9999}},uploadZone:function(e){return Object(y.a)({display:"block",height:p.a,position:"absolute",textAlign:"center",top:180,left:145,whiteSpace:"pre",cursor:"default",background:"#9e886c"},hr)},PingLocation:function(e){return{display:"block",height:p.a,position:"absolute",textAlign:"center",top:e.mem.pingY-25,left:e.mem.pingX-17,whiteSpace:"pre"}},PingLocationHide:function(e){return{display:"none",height:p.a,position:"absolute",textAlign:"center",top:e.mem.pingY-25,left:e.mem.pingX-17,whiteSpace:"pre"}}}),hr={"&":{margin:"5px",borderRadius:"50%",width:"35px",height:"35px",padding:"3px"},"&:hover":{backgroundColor:"black",margin:"5px",padding:"3px",borderRadius:"50%"},"&:active":{margin:"5px",padding:"3px",borderRadius:"50%"}},fr=function e(){Object(b.a)(this,e),this.prebThirdPersonView=!1,this.mouseDown=!1,this.dragging=!1,this.upTime=0,this.downTime=0,this.downXpos=0,this.downYpos=0,this.upXpos=0,this.upYpos=0,this.contentX=0,this.contentY=0,this.zoomX=0,this.zoomY=0,this.moveX=0,this.moveY=0,this.clickStatus="",this.userAngle=0,this.clickEnter=!1,this.pingX=0,this.pingY=0,this.hidePinIcon=0};var mr=function(e){var t=e.stores,n=t.map,o=t.participants,r=Object(h.b)((function(){return n.matrix})),s=Object(f.useRef)(null),c=Object(f.useRef)(null);function l(){return n.offset}var u=Object(h.b)((function(){return o.local.thirdPersonView})),d=Object(f.useRef)(new fr).current,m=Object(a.O)(r,o.local.pose.position);if(u!==d.prebThirdPersonView)if(d.prebThirdPersonView=u,u){var v=Object(a.D)(Object(a.i)(r));if(v){var b=O(-v,m);n.setCommittedMatrix(b)}}else{var A=o.local.pose.orientation,S=Object(a.D)(Object(a.i)(r));if(A+S){var E=O(-(A+S),m);n.setCommittedMatrix(E)}}function O(e,t){var i=(new DOMMatrix).rotateSelf(0,0,e),o=Object(a.P)(t,i,r);return n.setMatrix(o),o}function C(){if(!ca())if("single"===d.clickStatus){if(d.clickEnter)return;if(function(){var t=!1;if(e.stores.contents.all.length>0)for(var n=0;n<e.stores.contents.all.length;n++)e.stores.contents.all[n].scaleRotateToggle&&(t=!0);return t}())return void function(){if(e.stores.contents.all.length>0)for(var t=0;t<e.stores.contents.all.length;t++)e.stores.contents.all[t].scaleRotateToggle&&(e.stores.contents.all[t].scaleRotateToggle=!e.stores.contents.all[t].scaleRotateToggle),!1===e.stores.contents.all[t].pinned&&(e.stores.contents.all[t].pinned=!0),e.stores.contents.updateByLocal(e.stores.contents.all[t])}();!1,o.local.pingIcon=!1,o.local.pingX=0,o.local.pingY=0,U(!1);var t=setTimeout((function(){clearTimeout(t),function t(n){var i=Object(Vi.r)([d.moveX,d.moveY],e.stores.participants.local.pose.position);if(Object(Vi.k)(i)>Fi.a/10){var o=Object(Vi.i)(Object(Vi.k)(i)/5/Object(Vi.k)(i),i);e.stores.participants.local.pose.orientation=180*Math.atan2(o[0],-o[1])/Math.PI,n&&(e.stores.participants.local.pose.position=Object(Vi.a)(e.stores.participants.local.pose.position,o)),e.stores.participants.local.savePhysicsToStorage(!1);setTimeout((function(){t(!0)}),0)}}(!1)}),0)}else window.clearTimeout(d.hidePinIcon),o.local.pingX=d.pingX,o.local.pingY=d.pingY,o.local.pingIcon=!0,!0,U(!0),d.hidePinIcon=window.setTimeout((function(){window.clearTimeout(d.hidePinIcon),d.clickStatus="",o.local.pingIcon=!1,o.local.pingX=0,o.local.pingY=0,!1,U(!1)}),3e3)}var k=Object(vn.a)({onDragStart:function(e){var t=e.buttons,a=e.xy;document.body.focus(),d.dragging=!0,d.mouseDown=!0,d.downTime=(new Date).getSeconds(),d.moveX=n.mouseOnMap[0],d.moveY=n.mouseOnMap[1];var r=ra,s=la,c=Wt();if(!ca()&&!c&&!x&&!s&&1===t){d.downTime=(new Date).getSeconds(),d.downXpos=a[0],d.downYpos=a[1];var l,u=Array.from(o.remote.keys()).filter((function(e){return e!==o.localId})),p=Object(g.a)(u.entries());try{for(p.s();!(l=p.n()).done;){var h,f,m=Object(i.a)(l.value,1)[0],v=Number(null===(h=o.remote.get(u[m]))||void 0===h?void 0:h.pose.position[0]),b=Number(null===(f=o.remote.get(u[m]))||void 0===f?void 0:f.pose.position[1]),y=Number(n.mouseOnMap[0]),A=Number(n.mouseOnMap[1]);if(y>=v-30&&y<=v+30&&A>=b-30&&A<=b+30)return}}catch(E){p.e(E)}finally{p.f()}var S=setTimeout((function(){clearTimeout(S),r||d.mouseDown&&!1===x&&(d.zoomX=a[0],d.zoomY=a[1],d.contentX=n.mouseOnMap[0],d.contentY=n.mouseOnMap[1],!0,P(!0))}),500)}},onDrag:function(e){var t=e.down,i=e.delta,s=e.xy,p=e.buttons;(i[0]||i[1])&&(d.mouseDown=!1);var h=aa,f=Wt();if(!ca()&&!f&&!h&&!D&&d.dragging&&t&&c.current)if(u||2!==p){var m=Object(a.I)(r.inverse(),i),v=r.translate.apply(r,Object(Nn.a)(m));n.setMatrix(v),i[0]||i[1]}else{var g=Object(a.O)(r,o.local.pose.position),b=Object(Vi.a)(s,l()),y=Object(Vi.r)(b,g),A=Object(Vi.r)(y,i),S=Object(a.e)(y,A)/(Object(a.Q)(y)*Object(a.Q)(A)),E=Object(a.e)(Object(a.H)(y),i)>0?-1:1,C=Math.acos(S)*E;if(isNaN(C))return;var j=O(Object(a.D)(C),g);o.local.pose.orientation=-Object(a.D)(Object(a.i)(j))}},onDragEnd:function(e){var t=e.event,a=e.xy;d.upXpos=a[0],d.upYpos=a[1],d.upTime=(new Date).getSeconds();var s=d.upTime-d.downTime,c=Wt();if(!ca()&&!c){if(d.upXpos>=d.downXpos-20&&d.upXpos<=d.downXpos+20&&d.upYpos>=d.downYpos-20&&d.upYpos<=d.downYpos+20&&"DIV"===String(Object(null===t||void 0===t?void 0:t.target).tagName)&&s<1){var l,u=Array.from(o.remote.keys()).filter((function(e){return e!==o.localId})),p=Object(g.a)(u.entries());try{for(p.s();!(l=p.n()).done;){var h,f,m=Object(i.a)(l.value,1)[0],v=Number(null===(h=o.remote.get(u[m]))||void 0===h?void 0:h.pose.position[0]),b=Number(null===(f=o.remote.get(u[m]))||void 0===f?void 0:f.pose.position[1]),y=Number(n.mouseOnMap[0]),A=Number(n.mouseOnMap[1]);if(y>=v-30&&y<=v+30&&A>=b-30&&A<=b+30)return}}catch(E){p.e(E)}finally{p.f()}1===(null===t||void 0===t?void 0:t.detail)?d.clickStatus="single":2===(null===t||void 0===t?void 0:t.detail)&&(d.clickStatus="double",d.pingX=o.local.mouse.position[0]-o.local.pose.position[0],d.pingY=o.local.mouse.position[1]-o.local.pose.position[1]),d.clickEnter=!0;var S=setTimeout((function(){clearTimeout(S),d.clickEnter&&(d.clickEnter=!1,C())}),250)}r.toString()!==n.committedMatrix.toString()&&n.setCommittedMatrix(r),d.dragging=!1,d.mouseDown=!1,!1,P(!1)}},onPinch:function(e){var t=Object(i.a)(e.da,2),s=t[0],c=t[1],d=e.origin,p=(e.event,e.memo);if(void 0===p)return[s,c];var h=Wt();if(!ca()&&!h){var f=Object(i.a)(p,2),m=f[0],v=f[1],g=Object(Vi.a)(d,l()),b=s>10?s/m:s<-10?m/s:1+(s-m)/10;b=dr(Object(a.j)(r),b);var y=u?(new DOMMatrix).scaleSelf(b,b,1):(new DOMMatrix).scaleSelf(b,b,1).rotateSelf(0,0,c-v),A=Object(a.P)(g,y,r);return n.setMatrix(A),u||(o.local.pose.orientation=-Object(a.D)(Object(a.i)(A))),[s,c]}},onPinchEnd:function(){return n.setCommittedMatrix(r)},onMove:function(e){var t=e.xy;d.zoomX=t[0],d.zoomY=t[1],n.setMouse(t),D||(o.local.mouse.position=Object.assign({},n.mouseOnMap))},onTouchStart:function(e){n.setMouse([e.touches[0].clientX,e.touches[0].clientY]),o.local.mouse.position=Object.assign({},n.mouseOnMap)}},{eventOptions:{passive:!1}});Object(f.useEffect)((function(){_()}),[]),Object(f.useEffect)((function(){function e(e){e.ctrlKey&&(window.visualViewport&&window.visualViewport.scale>1?e.deltaY<0&&e.preventDefault():e.preventDefault())}return window.document.body.addEventListener("wheel",e,{passive:!1}),function(){window.document.body.removeEventListener("wheel",e)}}),[]);var _=Object(f.useRef)((function(){if(c.current){for(var e=c.current,t=0;e;)t+=e.offsetLeft,e=e.offsetParent;n.setScreenSize([c.current.clientWidth,c.current.clientHeight]),n.setLeft(t)}})).current,R={matrix:r,props:e,mem:d},I=Object(f.useState)(!1),w=Object(i.a)(I,2),D=w[0],P=w[1],M=Object(f.useState)(!1),N=Object(i.a)(M,2),x=N[0],L=N[1],F=Object(f.useState)(!1),B=Object(i.a)(F,2),U=(B[0],B[1]),V=pr(R);return Object(T.jsxs)("div",Object(y.a)(Object(y.a)({className:V.root,ref:c},k()),{},{children:[Object(T.jsx)(ur.a,{onResize:_}),Object(T.jsx)("div",{className:V.center,onWheel:function(e){if(!e.ctrlKey){var t;if(ca())return;var i=Math.pow(1.2,e.deltaY/100);if(1===(i=dr(Object(a.j)(n.matrix),i)))return;var o=(t=n.matrix).scale.apply(t,[i,i,1].concat(Object(Nn.a)(Object(a.O)(n.matrix.inverse(),n.mouse))));n.setMatrix(o),n.setCommittedMatrix(o)}},children:Object(T.jsx)("div",{id:"map-transform",className:V.transform,ref:s,children:e.children})}),Object(T.jsxs)("div",{className:D?V.showMenuContainer:V.hideMenuContainer,children:[Object(T.jsx)(Ue.a,{placement:"bottom",title:D?Object(j.c)("ctUploadZone"):"",children:Object(T.jsx)("div",{className:V.uploadZone,onMouseUp:function(e){L(!0),P(!1)},onTouchStart:function(e){e.stopPropagation(),e.preventDefault()},children:Object(T.jsx)("img",{src:Fn,height:p.a,width:p.a,alt:""})})}),Object(T.jsx)("div",{className:V.dashedCircle})]}),Object(T.jsx)(Yt,Object(y.a)(Object(y.a)({},e),{},{open:x,onClose:function(){return L(!1)},cordX:d.contentX,cordY:d.contentY,origin:"contextmenu",_type:"menu"}))]}))};mr.displayName="MapBase";var vr=n(56);function gr(e,t,n,i,o){var r=Object(f.useRef)(null),s=Object(f.useRef)({state:{}}).current,c=function(){s.state.dragging||s.timerAgain?n&&(s.timerAgain=n(s.state)):(clearInterval(s.timerId),s.timerId=0)};function l(e){e.preventDefault(),e.stopPropagation()}Object(f.useEffect)((function(){var e=r.current;return null===e||void 0===e||e.addEventListener("touchmove",l,{passive:!1}),function(){null===e||void 0===e||e.removeEventListener("touchmove",l)}}),[r.current]);var u={target:r,onMouseDown:function(e){e.stopPropagation()},onTouchStart:function(e){e.stopPropagation()},onPointerDown:function(e){e.stopPropagation(),s.state={dragging:!1,buttons:e.buttons,xy:[e.clientX,e.clientY],start:[e.clientX,e.clientY],startTime:Date.now(),event:e},1&e.buttons&&r.current&&(!t||function(e,t,n){for(var i=e;i&&i!==t;){if(i.attributes){var o=i.attributes.getNamedItem("class");if(o&&o.value.includes(n))return i}i=i.parentNode}return null}(e.target,r.current,t))&&(e.target.setPointerCapture(e.pointerId),s.timerId||(s.timerId=setInterval(c,i)),s.state.dragging=!0)},onPointerOut:function(e){e.stopPropagation(),Object.assign(s.state,{dragging:!1,buttons:e.buttons,xy:[e.clientX,e.clientY],event:e})},onPointerUp:function(e){u.onPointerOut(e)},onTouchEnd:function(e){e.stopPropagation();var t=Object(a.B)(Object(a.N)(s.state.xy,s.state.start)),n=Date.now()-s.state.startTime;t<5&&n>.5&&o&&o(e)},onPointerMove:function(t){var n;t.stopPropagation(),Object.assign(s.state,{dragging:!!(null===(n=s.state)||void 0===n?void 0:n.dragging),buttons:t.buttons,xy:[t.clientX,t.clientY],event:t}),s.state.dragging&&(1&t.buttons?e(s.state):s.state.dragging=!1)}};return u}var br=Object(Y.a)({root:function(e){return{display:"flex",justifyContent:"center",alignItems:"center",width:e.size,height:e.size,clipPath:"circle(".concat(.5*(e.size||0),"px  at center)"),overflow:"hidden"}},videoLargerWidth:function(e){return{height:"100%",transform:"scale(".concat(e.mirror?-1:1,", 1)")}},videoLargerHeight:function(e){return{width:"100%",transform:"scale(".concat(e.mirror?-1:1,", 1)")}}});var yr=function(e){var t=br(e),n=Object(f.useRef)(null);return Object(f.useEffect)((function(){null!==(null===n||void 0===n?void 0:n.current)&&function(e,t,n,i,o){if(t)e.srcObject=t;else if(n&&n.size){var a=URL.createObjectURL(n);e.src=a}e.autoplay=!0,e.onloadedmetadata=function(){var t=e.width,n=e.height;void 0!==t&&void 0!==n?e.className=t>=n?i:o:(console.error("video stream width || height is undefined"),e.className=i)}}(n.current,e.stream,e.blob,t.videoLargerWidth,t.videoLargerHeight)}),[n,t.videoLargerWidth,t.videoLargerHeight,e.stream,e.blob]),Object(T.jsx)("div",{className:t.root,style:e.style,children:Object(T.jsx)("video",{ref:n,style:e.style})})};yr.defaultProps={size:100},yr.displayName="StreamAvatar";var Ar=function(e){var t=e.name,n=e.avatarSrc,i=e.colors,o=(e.stream,e.blob,Object(zt.a)(e,["name","avatarSrc","colors","stream","blob"]));return Object(T.jsx)(Tn,Object(y.a)({name:t,colors:i,avatarSrc:n},o))};Ar.displayName="ComposedAvatar";var Sr=function(e){var t=e.participant;return Object(T.jsx)(h.a,{children:function(){var n=t.getColor(),i=t.information,o={colors:n,avatarSrc:i.avatarSrc,name:i.name};return Object(T.jsx)(Ar,Object(y.a)(Object(y.a)({},o),{},{stream:!t.showVideo||t instanceof pn.a?void 0:t.tracks.avatarStream,blob:t.showVideo&&t instanceof pn.a?t.videoBlob:void 0,colors:n,size:e.size,style:{pointerEvents:"none"},mirror:e.isLocal}))}})},Er=function(e){return m.a.useMemo((function(){return Object(T.jsx)(Sr,Object(y.a)({},e))}),[e.size,e.participant.information.avatarSrc,e.participant.information.color,e.participant.information.name,e.participant.information.textColor])};Er.displayName="MemorizedAvatar";var Or=n(468),Cr=n.n(Or),jr=n(469),Tr=n.n(jr),kr=n(470),_r=n.n(kr),Rr=n.p+"static/media/earshot_icon_avatar_glow.1b7acac1.png",Ir=12,wr=.5,Dr=Object(Y.a)({root:function(e){return{position:"absolute",left:e.position[0],top:e.position[1]}},pointerRotate:function(e){return{transform:"rotate(".concat(e.orientation,"deg)")}},pointer:function(e){return{position:"absolute",width:"".concat(Ir*e.size),left:"-".concat(Ir*e.size*wr,"px"),top:"-".concat(Ir*e.size*wr,"px"),pointerEvents:"none"}},avatar:function(e){return{position:"absolute",left:"-".concat(e.size*wr,"px"),top:"-".concat(e.size*wr,"px")}},avatarGlow:function(e){return{position:"absolute",width:3*e.size,height:3*e.size,left:-1*e.size,top:-1*e.size,opacity:1,pointerEvents:"none",transform:"scale(0.5)",transition:"0.5s ease-out"}},avatarGlowEffect:function(e){return{position:"absolute",width:3*e.size,height:3*e.size,left:-1*e.size,top:-1*e.size,opacity:1,pointerEvents:"none",transform:"scale(1)",transition:"0.5s ease-out"}},icon:function(e){return{position:"absolute",width:.4*e.size,height:.4*e.size,left:.6*e.size,top:.6*e.size,pointerEvents:"none"}},signalIcon:function(e){return{position:"absolute",width:.25*e.size,height:.25*e.size,left:.8*e.size,top:.8*e.size,display:"none",pointerEvents:"none"}},iconProximity:function(e){return{position:"absolute",width:.6*e.size,height:.6*e.size,left:.7*e.size,top:.4*e.size,pointerEvents:"none"}},iconEmoticon:function(e){return{position:"absolute",width:.6*e.size,height:.6*e.size,left:-.2*e.size,top:-.2*e.size,pointerEvents:"none",transform:"scale(1)",transition:"0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55)"}},iconEmoticonNone:function(e){return{position:"absolute",width:.6*e.size,height:.6*e.size,left:.1*e.size,top:0*e.size,pointerEvents:"none",transform:"scale(0)",transition:"0s ease-out"}},conIcon:function(e){return{position:"absolute",width:.85*e.size,height:.85*e.size,left:.5*e.size,top:-.3*e.size,pointerEvents:"none"}},more:function(e){return{position:"absolute",width:.4*e.size,height:.4*e.size,left:.9*e.size,top:.3*-e.size}},pingLocIcon:function(e){return{position:"absolute",transform:"rotate(".concat(e.orientation,"deg)"),width:"200px",height:"200px"}}}),Pr=function(e,t){var n,o=e.stores.map,r=e.participant,s=r.getColorRGB(),c=Object(h.b)((function(){return{position:r.pose.position,orientation:r.pose.orientation,mousePosition:r.mouse.position,awayFromKeyboard:r.physics.awayFromKeyboard}})),l=Object(h.b)((function(){return r.information.name})),u=Object(h.b)((function(){return r.trackStates.micMuted?0:Math.pow(r.audioLevel,.5)})),d=Object(h.b)((function(){return r.trackStates.micMuted})),v=Object(h.b)((function(){return r.trackStates.speakerMuted})),b=Object(h.b)((function(){return r.trackStates.headphone})),A=Object(h.b)((function(){return r.physics.onStage})),S=Object(h.b)((function(){var t;return null===(t=e.stores.participants.local.zone)||void 0===t?void 0:t.zone})),E=Object(h.b)((function(){return r.trackStates.emoticon})),O=Object(h.b)((function(){var e;return null===(e=r.quality)||void 0===e?void 0:e.connectionQuality})),C=Object(h.b)((function(){var t,n=Array.from(e.stores.participants.remote.keys()).filter((function(t){return t!==e.stores.participants.localId})),o=Object(g.a)(n.entries());try{for(o.s();!(t=o.n()).done;){var a,s,c,l,u,d,p=Object(i.a)(t.value,1)[0];if(void 0===(null===(a=e.stores.participants.remote.get(n[p]))||void 0===a?void 0:a.closedZone))return;if((null===(s=e.stores.participants.remote.get(n[p]))||void 0===s?void 0:s.id)===r.id&&""!==(null===(c=e.stores.participants.remote.get(n[p]))||void 0===c||null===(l=c.closedZone)||void 0===l?void 0:l.id))return null===(u=e.stores.participants.remote.get(n[p]))||void 0===u||null===(d=u.closedZone)||void 0===d?void 0:d.id}}catch(h){o.e(h)}finally{o.f()}})),j=Object(h.b)((function(){var t,n,i;return void 0!==(null===(t=e.stores.participants.local.zone)||void 0===t?void 0:t.id)&&""!==(null===(n=e.stores.participants.local.zone)||void 0===n?void 0:n.id)?null===(i=e.stores.participants.local.zone)||void 0===i?void 0:i.id:void 0})),k=Object(h.b)((function(){var t,n=Array.from(e.stores.participants.remote.keys()).filter((function(t){return t!==e.stores.participants.localId})),o=0,s=e.stores.participants.local.pose,c=Object(g.a)(n.entries());try{for(c.s();!(t=c.n()).done;){var l,u,d,p=Object(i.a)(t.value,1)[0];if((null===(l=e.stores.participants.remote.get(n[p]))||void 0===l?void 0:l.id)===r.id&&void 0===(null===(u=e.stores.participants.remote.get(n[p]))||void 0===u||null===(d=u.closedZone)||void 0===d?void 0:d.id)){if(void 0!==Object(e.stores.participants.remote.get(n[p])).pose.position){var h=Object(a.r)(s,Object(e.stores.participants.remote.get(n[p])).pose);o=Object(a.B)(h.position)}return o}}}catch(f){c.e(f)}finally{c.f()}})),_=Object(h.b)((function(){return r.trackStates.pingIcon})),R=Object(h.b)((function(){return r.trackStates.pingX})),I=Object(h.b)((function(){return r.trackStates.pingY})),w=Object(f.useState)(!1),D=Object(i.a)(w,2),P=D[0],M=D[1],N=Object(f.useState)([0,0]),x=Object(i.a)(N,2),L=x[0],F=x[1],B=Object(f.useState)(!1),U=Object(i.a)(B,2),V=U[0],J=U[1];!_||L[0]===R&&L[1]===I||M(!1);var G=R+14,H=I-55;if(_&&!1===P?(!function(){var t=c.mousePosition[0],n=e.stores.participants.local.pose.position[0],i="sound/beep.mp3",o=new AudioContext;window.fetch(i).then((function(e){return e.arrayBuffer()})).then((function(e){return o.decodeAudioData(e)})).then((function(e){var i=o.createBufferSource();i.buffer=e;var a=o.createStereoPanner();a.pan.value=t>n+10?1:t<n-10?-1:0,i.connect(a),a.connect(o.destination),i.start()}))}(),F([R,I]),M(!0)):!1===_&&P&&M(!1),C===j)var z=setTimeout((function(){clearTimeout(z),J(!1===V)}),500);var Q=Dr(Object(y.a)(Object(y.a)({},c),{},{size:e.size})),K=r?r.getColor():["white","black"],W=Object(i.a)(K,2),Y=W[0],q=W[1],X=e.size/2+2,Z=e.isLocal,ee=e.size*Ir*wr,te=Ir*e.size*wr,ne=[.1,.2,.3,.4,.5,.6],ie=ne.map((function(t){return u>t&&"close"!==S?Object(T.jsxs)(m.a.Fragment,{children:[Object(T.jsx)("circle",{r:e.size*wr+t*ee,cy:te,cx:te,stroke:Y,fill:"none",opacity:.4*(1-t),strokeDasharray:"4 4 4 24"}),Object(T.jsx)("circle",{r:e.size*wr+t*ee,cy:te,cx:te,stroke:"black",fill:"none",opacity:.4*(1-t),strokeDasharray:"4 32",strokeDashoffset:"-4"})]},t):void 0})),oe=ne.map((function(e){return u>e?Object(T.jsx)(m.a.Fragment,{children:Object(T.jsx)("img",{src:"data:image/png;base64,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",className:Q.iconProximity,alt:""})},e):void 0}));return Object(T.jsxs)("div",{className:Q.root+" dragHandle",onContextMenu:e.onContextMenu,children:[Object(T.jsx)("svg",{className:Q.pointer,width:e.size*Ir,height:e.size*Ir,xmlns:"http://www.w3.org/2000/svg"}),Object(T.jsx)("div",{className:Q.pointerRotate,children:Object(T.jsxs)("svg",{className:Q.pointer,width:e.size*Ir,height:e.size*Ir,xmlns:"http://www.w3.org/2000/svg",children:[Object(T.jsx)("circle",{r:X,cy:te,cx:te,stroke:"none",fill:Y}),ie,"arrow"===config.avatar?Object(T.jsxs)("g",{transform:"translate(".concat(te," ").concat(te,") rotate(-135) "),children:[Object(T.jsx)("rect",{style:{pointerEvents:"fill"},height:X,width:X,fill:Y}),Z?Object(T.jsx)("path",{d:"M 0 ".concat(X," h ").concat(X," v ").concat(-X)+"a ".concat(X," ").concat(X," 0 1 0 ").concat(-X," ").concat(X),fill:"none",stroke:q}):void 0]}):Object(T.jsx)("g",{style:{pointerEvents:"fill"}})]})}),Object(T.jsxs)("div",{className:Q.avatar,style:{transform:"rotate(".concat(-o.rotation,"deg)")},children:[Object(T.jsx)(Ue.a,{title:l,children:Object(T.jsxs)("div",{children:["close"===S&&r.id!==e.stores.participants.localId&&C===j||void 0!==k&&k<360&&r.id!==e.stores.participants.localId&&void 0===j?Object(T.jsx)("img",{src:Rr,className:V?Q.avatarGlow:Q.avatarGlowEffect,draggable:!1,alt:""}):"",Object(T.jsx)(Er,Object(y.a)({},e)),oe,Object(T.jsx)("img",{src:"smile"===E?"data:image/png;base64,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":"hand"===E?"data:image/png;base64,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":"clap"===E?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGkAAABpCAYAAAA5gg06AAAACXBIWXMAAC4jAAAuIwF4pT92AAAPTElEQVR4nO1da5AVxRU+g4DgEh5ieLgJuwipGDEshJc8NUoghghLSdAlJCyYgInELI/8SDCwEN9BXK2kCKYS3Cp0CwJhIakoBiJL5KFG2UVAKXZlF0WQgO5FlvBYmNQZz71O93TP9Myd1/XyVW3hbWfu9J2v+/Tp75zu1nRdh6ihadotVIV6XdfrI69QzNAiqupomlasaVq9pmnYSl6mv0OaplWbSMt6GO8q7J6kaVpHANgKAAUOl07Xdf3ZkKoVa0RBEhJ0s+LlE3Vdrwy4SrFHqCRpmlYIAOtd3NKg63p+gFXKCIQ9JhWbP/Tu/RX414QH4QQsNf7+WPRL/vo8HLtCrWEMETZJ/cwflgy4G/puaJP6PLGiM8wYX8TfUxhS3WKLsEnKM3/odvZKywWj2/bmiyaQs5G1SJskTdPycazRNK2U/rUbQ2rMH461OWe5YPir7UX3ZXVv8kwSkYOe2iFyBhbRvzjX2appWj/BbcxEdVfz+5YLcuo1uP/O6XxxVs+bPJFEBFTbuNJYvlsw6DPu9D9qXhHefFPLL/FFl3uSG5A5wx7UQeG2lRxRDEm1tQdhx6Qmy00Ck9eB3PeshJeeVMoThK40emX4rx1Ruq438uPSrhZHLTegyfve2PF88WWSVEBe1jTzpb+afC9saZ4Jj28cALtqZxmfBTD3KEbqWfPmFuGTx1zdhy+6TJIiLM7ArNd6GS0/iblrejsRZTF5dWMuWC4eethiTTtInJHPPdJ2wc0EJWFHFHlqjMnb3Nlq8rptbykyeVmpPrglqZEvEPUCcCZqv7lg25F9wu8YfrVljMtKV9wVSbquo9vdYC5bqu2EpnyxSGtDFKP9bNq2RWzyTl7DFxVko/rgxdwxA/9fNm2E+V/9txeiGIhMXq+XWokuzbpxyTVJuq6X8mOKH0TJTJ5bkBJSSqqH+a/EQbKKLbw6DrfwZi9dotDk8RPb9UUnRZdWiwrRDGqaVkYy1SJSPcx/T5okq4wa2zwH/cgdtigP6JEtPTBS6PUhlk2uhYfX/EH4/3AyPH3Q7ZADreD4xSbRdVW6rltesIuQvBnlODH3K/GFiMd30pEcrGpd17f68t3pRGaDIMoBwnC6pmlYNsHD9yUAoIxMuGtQ4yihP5FMZnw/PcPiGatCiSSqTD55d/z/C4uocnoZhTRf6kfPTIhkKuyRX7/QGU5f0QyHWiRg5esvGBNnCdB0l7jJp6DfXcnHyCTAMbzQa6+1JYkUglKuIg1Uucpkdw6BqMU0FpU5vRQk6LnrZgg9QxzjHnt9rR1ZVUSWcNxLQvZ7HYDvrZ+XHiUkyYWNTyQJo1iRa6K+P+oFw2kwoYG+q5G+r5IclZUqP+j5u34NY1bL3x06NisG1zk1jqdovBK+UMwNFL0b/K1fuDIHPjnXZDhSAmzQdd21BikjyU3alRl43xAAaMtXXkbUiqLDsKDiaXPRYvMY4TbDqCH/t9IGYQZOnle02QN/3lghuyRBRJWZC8m6MA0GIwBzTxYYUlYS+P040ReQ9U23DkVLvoAq4YUgkMk2RkXHAiwFK1F1Tf+Vfhn1aEuCJL6UwtbXQ7sLV8DpVheNcAf2DCzP2ehMENBE+XEYAIWTroffH9/G92Ygi/AkvY8S04tl9ENsgBgBEH3/0vyRsLv327x5LabGrAxLT+K7Mtr4Z/pMM7J6sHXs7HwCtn90UNadbTF21G0wrfuwlDl66a4ETFn9G/6WlAeHE1Ca36RQVjQPplZ0tzzm2PBm2NkjYWQcuQWawPVDj8HvXt9oN15tIMflkLlw46TFMGxtjvSJOA7+uOIRvriTm7FJRBJTIKtE8qW8df4YPL1OabhIAVvfqf81iVpvgrzIRhCYXcx9WLjOEmfyDfibnul2wO73WDxJzBe0AzaAvPpf8FfM4c2oHRiSyGvZ7aYSQBXZPuSUkVjiljC7yvMkyXqR39gz4SwsP/uakrVQeT8CL9ZVZi4vC1n8eGxdTsBxBk0YtnIcuNHDEmT8OGG7YPw5b/6AZlaUE+E30LQv3zTKyKiVpASkIAvVmDH6nCWxJs+NNCUyd43mLo2madHpYYznogokeHG7HW7Gr+QM/VmanzGh+iTwxc0eNB4m7uym5MmlA7QSq4a+x3ugKTxUdD/Mqujh+ATBVKNc13WlIKaIpGdFLwd7xmgt33aQFAFb/vi1i1zdowp0RJa0GS0LafgKmcuOdXhu2+2Oj0rHgRCR1JHMnnBGiK148jdug5sudVciDO37rRsecLzOK+wUhiCAjY532XHRgTmnXYR0HAjZZFZJ9sAX9J2CEUYyI+bKiUzPqqKjUFLxhKUce+Z1ra82/luieKeegY3i9MVzUHXgDajZu0d4TWXXezyZZC/gXXYMwWAoxgkCB6JG13XHIKZUu6MeVUqTLyWNCscvTMXqdebTHrbnqo8tBOXm5sJf+8y2tHzR+IVEznvjBob8oyOaYX6Lf1rcd5zIiiaVQQLr/HxuvfHiVZQOiVXp76gVOqngRFZSefaqRKSw9Y6H4Ma/WVdTALVQDBwiUU4v/b5vvwKrX2RFa/TGvExm00Uy0KnixHhxIBwjsziw4dpVCrb1RDvKh89VMXXcJClBQD9yvj7UMF+ohdnhsYPDoUuXrswVODCruMR+A+ut6mXenmuxboVOyTVus4VwCX8Z2dFOuPiY5JKEyv0zWjrnkKAZREfAaXxpV6fBypH3WcpR1IwzRh/+Il+7Dk7ZuZ6TI009DINZ2BImksTfoHC7LVQ9tSHrrrLkTaCpRGclrsDGJ5jop2fuVIGiqK7rqBaj9oZjXbCzTAJ6VQU39mXK0FnBQTquGG1NWrrZLpMp6OWYzNiF3l4QWJF7t+VbH/v4ZWnmUtTA+aVAbiqRVStokhjXEucVKlqgW/Te1BpK72LHJ/SgUM6JKzAHg4N0XAqMJAqWMfISTvyWdfbkGDpi9uqeMO6WMcxlqLfF1exNOHwtX5QnWygXCEmiEHMSqH1hsC8IPNp8K7Rty0TuYea+8liaPTerRnwniXx+ix6Fk1OcbBo61/vuRFpVdH+lJTxc+FPmauy9TwzYn87XBoaJHS1zQeF2CL5vW0Opvj83lzll8PgNkRrhFOYGUg5qBp6Bd1udMj7nQGvoe7J9YOKtqugaBEn15tw4VfHRT5zupUOfY6XQ1PRZgNBOhDVrcCLwuRl+QkV09dXcka/PJC9OORL+QgZDjRg3jymTOS0Yeij88E+2eXjoKWLCzE/GbvN9fBNEbQv4OZPfY5KFkbDCBzxuXdMefjRhClOKTot5pQY6MBiQtMkQYuC0csQLMA6FPZUD4+VFtnNkGHhgb3/Iy2PbDYqw2HuQLEE6mQF8afiHYRUeSJTfjsiAbpaJLWPufB2TqJsyeWl7hz8aWW9CvHrnGRi3bqHStT/87mRY8vYgw1ya75+5awUcOXKEuVYlGqsKQWidWeLja0+iVQOMwLq5hzxDNQygCDtn0j2OT7p34g9g2d8HMwQB3b+9TQnk5LCeYWXLOt9qnwySyhCEuWNSaFHsjCLGY8aCtV8TTRxTGNR/IDy4Xh6/QuKWjf8ZUybbF8kLMFXaDkGQZFmQhVk2UQPz6EYMHiasxczrv+VYu2HvsXNMdDb8ciCS8zIZfCeJTN5icxl6VXGI8TzR8Q5huZO5AVIzeNQVWPfr84I9TR/wdzHCdFDenSUTNg5mD5UDwT6vnuGH44ATacHyG2bICEK7k4qrcQhti/Z57XIiOu8TFwhwSPDLQoNQHCwE4ZwD03FxG5qoexMCk1zMQTeVKULt2POO17gFhlEECxws4rTfTcjygLBWQrgBkrJs0lQYX6ue/tzU5pLv9VilWzYYSYjeoW89iSR2Zpl+HAlKAhVxDys/fAP2IsFYJNxKwE9zxyzlQHOCqx7iDMyO9UqUQG9zBczB4NAg20/CT5IYvWnUDQMDX5aSLrB+SJQKjrRlw/C5Hbt4fjrKQIJVjtINPz7XAqsKVBvSO5dO+PI8nADjXhIcquxOuMl6ksIGKuiC0Ijttjl+ksRMwHBQDCJ9Ky7olWNJF3aExOUud9rXwc8M1q18TrhgopaxqDt1jKk67iTmBmjmMHOJQ8IuKTIJv80dM1PGVhPGQuQw0Hjmk7SeIjFzJSrLMf0mqYTvTXOrV8U23TcdYCaRKjDZRGDmbJ0FM/wO+jXyCX7Yehb3fdPPx8QCXS84i6vYOCU7kSXcbEYfRKiiktYspcAngGQiPjjxIVPrt1rJfw+Sg0kuM3u8KMtCKnSzbU1Q8m8xv4Id5wZDh4e3+NhvdGrPBv1wk0Mo+nTjQ9yICs+COt7iDLx7/iMjalu7WpqBND3tXbr8ALYSSj5PaR9G3tsNNcbOWJmIazuxLjf+ngWKqWAENHHFXk77DGwyS63lKXNZXCK0XnBVq7QCfFW0a6Sn41gDPcKUlPFqPqv11TGPhLY5hl+4BuZ7+aYNpGyntatxoAMEmb1is9kDitAuh1FBPjoMrDO4s2IrjceV6exgbEYohwHjjve0oXoKcY41iSDoST3DOkw/FIFVdHRC3BcfmyHSIMMiCEJWwS2r2OK8+NiM49dEKxSHRhLtnzPHXIaBL9z++TLsEWo8iVawVZnLcEaegSJslcI1viGKoF9xpomwQe0/oYrQSaIBl4mhxHnxsQS+uNaqiCR8ThI9I8KilB9XEdYpVztoRJnjYDF7KMLGMeS+bf9/+KLsIIlm40xMxYg9tdsRVZWEQKdGEFHNmp4kFGHjthVa5fl3+KKaMCeyEJOUrlJ+CWcclskAJTGKUoHDrkfkJInMHmLh2c2RuuWSfbwbVPMS/EQskiNJjWBWB0a1FRo2jCV37hMRBFEd6x2KCq4K0QlfKnsC+QWbg6mAwt6h9yKIIUn55DmlciNwdcaW5pmBJ/+jF4fKh2R3lMgIgrjlgpPXxORFh6FG4JF1ku1rEnS8W2QEQdx6UhKic2OD2I7N4VSatI4d9RNxJclyqInfB4c4HGdarpoCHAZiSRJITsU0ny/oFQ6nYiaInEjNG4/YkgSSXSiBDpaauvPLrpwJp40HybwVOx3uEQViTRLYHLqlehqZAjngdPhv1Ig9SWBDVBL85hlJ2JycnEQD9R5fTvsPChlBEnx25mypy/PGZUhQ0qLtMsi4IGNIgs8mu2W8e+4S5WTaInetVZFRJCVBx9mV2JlADqlTNzOJnCQykqQkTKek2W2ZXO01UT4uyGiSsgIA8H+Ke0KURpuhBQAAAABJRU5ErkJggg==":void 0,className:""===E?Q.iconEmoticonNone:Q.iconEmoticon,alt:""}),Object(T.jsx)(Fa,{className:Q.signalIcon,quality:null===(n=r.quality)||void 0===n?void 0:n.connectionQuality}),void 0!==O&&O<70?Object(T.jsx)("img",{src:"data:image/png;base64,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",className:Q.conIcon,alt:""}):void 0,b?Object(T.jsx)(Tr.a,{className:Q.icon,htmlColor:"rgba(0, 0, 0, 0.3)"}):void 0,v?Object(T.jsx)(se.a,{className:Q.icon,color:"secondary"}):d?Object(T.jsx)($.a,{className:Q.icon,color:"secondary"}):void 0,!d&&A?Object(T.jsx)(ei.Icon,{className:Q.icon,icon:Cr.a,color:"gold"}):void 0,e.isPlayback?Object(T.jsx)(_r.a,{className:Q.icon,htmlColor:"#0C0"}):void 0]})}),Object(T.jsxs)("div",{children:[Object(T.jsx)("img",{src:!1!==_?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGkAAACXCAYAAAAWGnVTAAAACXBIWXMAAC4jAAAuIwF4pT92AAAQr0lEQVR4nO2df2wT5xnHv3f2mUgRxhFsYVkGgQ4oMywJ0I103TDrikQ7CkXR2o6VGmnqOoE0WlVs8EeX9g8iVVNHpSK1+2eGinaaaBVatZXSbThbRelWmiCgG6WjCWOs0YpwYEghTu72x2snd+89r3227947B38ki/i9870v/vp53+f99byKYRioEWzCfhegRBIAWrgXcv/OJ+4/CSCT+3sg93cawGDuVRUoAbakFjBREgDaALS6/PwRMOHSplcgCZpIbQCSADaBtgwvGQETqif3yhS8WyJBEKkFwE74I4yIETChUgiAhfkpUgJAF4A1JX9yKA3jxjUYl/8OADBu/A/65bOWW5TITKhzFrM3kSjUObfCmDUPSmxhqbmdBLAPTDBf8EOkJJg4jqzGGO6HcfF96Jc+gH75I+jXL1ZcgNDcDqizl0Btug2Y920odTEnHxsCK3eq4gKUiEyREmD/wYLiGKMZGJ+8CePSCYwP9sLIXvW8YGpDHOElG6Hcss6JpQ2BVc89nhcshwyRWsDEKVitGR+/AX3wKLLnDntdnoKE5nYgtOReqMu2FLu1D0ysAa/L5LVIXQB+KbpojGZgnPkdxk8ddKUacxNFi0JbvhVK+yPFqsOnwP6f3pXFI5HawKyH7NsYoxkY/b9B9tRBKdVZJTgU6yRYW+uJVXkhUhLMG5pFXdRPvIDsiecDLw5PXiy1Y5folhGw6i/let4ui5QC8DB5ZSiNsaN7AletlYpa34zI2r3A/ITolgNgP1TXcEukGFinz1a9GaMZ6MefRfZMyo18AoO2qBPqd54UVYEnwbxZV0Yt3BBJLNBwP7Jvb6966xGh1jdDW78fSmM7ddm1dqpSkdrABLK1P/qJFzB2fG8lz64aIqv3QF35KHVpBMyiKhKqEpGEAk30Pu57f0c22qJOhNY9S12qWKhyRYrlMrWMHhijGYy/+RNMfPZeueWpatSGOLTNr1DtVEVClSMS2QYZoxlkX3sQ+pUz5ZRj2lBAqLKdCbWMcvSgJpAQ/coZZF97EMaoTYtWsB+3o9FcM6WKtA/cGFxNIDtFhNpX6vNKEWkTgJ/xiRPvPFETiKCAUA+DjUw4xqlILSCGOybST2L8Qm8p+d1U6FfOQP/z09SlX4N5x45wKlIKnKutnz407UYRvCB77jD0956hLvXAYfvkRKSd4Nuh4X5kj3U7eX4NAGMfPg8Mpfnk+XA4xVHMBY+BrU+zWNHYy+tr7VCJKFoUka3vUq75WhRZ7FLMkmxTDvp7z9QEKgMjexUT7zxBXSrq7RUSKQFu2sEY7memW6Msxi/0wvj4DT65FUW8vULVXRpcW5R99f6bdsjHLQTV3giYB02ORogsKQFOIP30ocAKpGhRtoDE9FLrm/0uFomRvQr9uG0gdhYKWJPIktLgRBpL3R6YeaHwvHVQm1ZBnXNroRlSALl1e//9SOoSMSfM2JLml48JrYkSqQ1AvzlBP30IY3273S1liaj1zQiv2g7lq/c4XcxIop8+hImzr/teKwimNsiVR5RIKXAOg59WpGhRaLfvdrIOrjQCsOZCYE22XyDfJsXACaSfPuTbf0Rb1InI1nfdFwgA5icQSR5DZMUO95/tEP2vNk95FohFLLxIm/gbJs6+7lqhnKJoUUTWdCO07tlCVdsQ2MqcbWAdwgYAium1Nnftudy9JGrHLtR9/yAULeri/8AZ2XOHYWTO88lJPoGv7noAbMy/MTLnceNQwoPiiVG0KCIbXxIt7gCAI2AdwHSJj24D86DIJWfGcD/Gjjwk3bGIrNhBreVbANNORLMlxWASCAD0gZRHRaMpIlAfmHVsQnl7hgbAfqULcs+y5t3YzvKWbFHjZ8l1/0nzG7NI9qpu8A/ulqgIkUS3SKCnwPpuaReyGcw96zH+Ql4omejXL1KjEEnzG7NICfMFY7hfqsOgxZNQFm+gLm2DNwvi94FZ5og5UWlsR2T1Hg+yE6MPHuWT5mNq03YBkS6+71WZbKj1zQglyMmxbfB201Ya3P8bANSVjyI0t8PDbK2MD5ITp5M1W16kFnDLs/RLH3hWKJ7IWnIR5WOQs6tuAOzHYCF8xy8kZM0wslep+aZE/o+8SLap3In/HPesUGZCczuooZ28ByeLVC7PSZTGdmiLOqUVYOLTP/FJk04cKZIx3C/NFdVW/ZRPym8hkU0SXPuktj4kLfOJS3+jktuAKZESlksjchwGtb6ZsqIU/IlWkgFnvUpjO9SGuJTMBROpCWBKJEu3Pr/13mtCLd+jkmVWc0XzDi/ZSN3nDfZ2yWJJlhWp+ucfe18gAKEF3+WTjsDfmD8Z8G1T8zelZa5//g8+qQUQTPoZY9c8Lk4Oe1WXlpNxQSxDAEpju7RRCOOyzTjWAEykhO3ma//yvECCuj7tecbFSfMJ6mxJ7dK1f1PJMdKSZIw0KDPIX6fnMREcMMgnqDO/LCVjgXG0lbOrwhVCTSv5JOF0gg9YBmCVmXOlZCoyDt9EIhj0uwBBgFjg3xIkkWoAUIZtNX5NpKBhNNo3W/gmknHtMz6p9Lh33tHiR6ZqQ5xaLpD2TSSRuym7HAIsMwITl05IyTQ0ZymV7J9IAnczIbkYFAk+wbghZ7BZsXu8fQCr7mzuhIwluvr1i9RKmYTnGRfHsozAGM1I20WifOFrfNIAwESyuRPKzK9IKBJgXLStIrWts/ABaxku/EVKpooWpdZ3pAGf+0n6p+TcflJ+SSZJgJ+htq8/8ATB0NOkJQFcb58YDfCE8Qu9VOfNjwm/PF3mN8ZoRrT+wHWI73wEuQ5+XqRBy+WIvLVnRv9v+KRW+GNNm8DvDf7kTWkz1Mpsm2c32QypfAIAtqVEEtlTBylr2ge5fZUYiEUv4x/sl1eCL9qqu3T+j7xIlm+J6vV6hZG9SlnTLJSwhd4FekDtDZa07lDRolSo63T+D5VPAAClLiZ1ue3Yh8/DGO7nk1shR6gU+Goucx7ZUwc9znaK0JdWU8mFqztA3kRXnuwf91DV3hqUGTTJATGwH4FtAX/2re1SF+5PHtcwxRBMtZu5uvPFw8tTIMRLK9iPKOFidoncM22rTCZ6H5ceAkFt+gafZPURhBfsH/Sc7LnDmOh9nLo0H8BRsF9+SwVZtIBVb0dBHMfgV8RLwgdIm98IRZLpPJgpIBTAfvmfgomVhLNqMJa7tyf3WXJ/kl8CCUa+LVqYN5ElwH5hk/gZnkZtiEO7e7+TAz5OgvXz+Ha1DcxyCp5g5ndIUsEGZ8X8xnymX5q/M9R0m28i6VfOYOz390JbuUMUKThPa+5V8ipG/fQhZI91+xo2QDTybYYfu7PcQCxelIqRvYqx43sx9vJ6aqNV+QylkX31foz17fY9roPSbNtiYx/w5vbM7gQLmDfJ6P55rhesXNT6ZoSXb3V6zpEFI3Mexj97A3XCjFrfjEjyGJ98H/gFmpxItkAb42/8OJDRIdX6ZoSaVkOZORfK7KVQZsy0XM8fJ2dc+wwTl44HRhgzgvaoAdwIEH/O7ABYf2nSPVWbVgEBFEm/fhF6lQeIJ9oj87m4k1DzSWnLg25Z51qhalgh2qM0dR8lkrU+jC2UtkfnZkJtiBccVLXcS6TZbgwvWFtxoWpYCTXdRiWTQR0okex7dBbeVXmpalhQl97HJx2h7gPEaxxse3SCGuSvGlHrm4WLTsj7Bek2sxNsnaxRBoLvkqzqALFItipPbUuWXagaVoiqLj/+SN9f4Fk1L88DBFVdquBnClyzmZ/UndjTlPDyrVSysKoDCotk9/JqHduKIb7Dojvui61gTVkyiC1EeF5NqHIJzyMHhgtaEVBcpB7woVxqHduyCdmbixE4CHLlZC24RWl12RZf4pVWO2p9MxXPL+Xosw7usYdyWbzZybNrmAgvITeMOArR40SkATA/fupDtT5TyShLbWHZ+uBwx73TrS/W6FWxhVIjK1Y72qJOymFIOf28U5FsDkR4+Y+c5nHTE1pyL5/kyGHI41SkDPgRiMUbaoOuDlAb4lSgq5LCxZWy06+LTxD0nmuYCH+drHFSpTyjFJEGwcfciT9Qc8cLoGhR6pyNAygxRE85JzZPFaIuVnPHC6DRNU2q1OeUKlIPuN0XNXecRtGiUNof4ZP7UEZMv3J2n3dZChNbKDU0c7UQXryZWoifKudZxc6ZFZGBafuiH6fDBB3iAKshlLltp9w4DrbObc2aphB0XrvKfV65lmQ7yblmTVO4aUVA+ZZkD3ResyYAlQ8BUZRrSUDNmkhKOZrUKZXEFqpZE4fAivahAoGAyiwJqFmTBS+sCKg8ShdtTfFkhY+tPiIrdnhiRUDllgRQ1jSawdjBO3zf6igLwaHzQ2Cb8ioWyY14dxlw4c+Uupho3Gpaoi3fSo0udMEFgQB3LCnPILgAFkE61N4r1PpmaA+8RVlRi2t5uPUgEMEEw6u2u/j4YBJetV1kRa7hpkg94Oab1GVbpvVaCLUhTs0X9cHlAyPdjsHaxSfIPGVSNpFv/ZxK7nI7H7dFSoPNPE6iNLZPS5dcW9QpOtUz7XZebjoOeaa9S65oUUR+8DrVcW2DB6fXeBFyOgN+YrAuBu323R5k5Q/a8q2ijuugF/l5YUl5BsBFyMq+er9v0bDcQm2II/LDt/lk1zquZJ5ePDSH3SW/s7vqVxcJnIWd8EggwFuR0uCdiNjCqh6J0OJJylnog4M9RpXgZXUHEE4E4G+ww3IRjM955iyY8fqsigyIaPnanXs9ztZ9IoluamTBM2fBjIwDRXrA771tbEdkxQ4JWbtDeN46agPYSXjQcaXwurrL0wLm7VVdtSeo5gCgHZLOxZV1NM8giF+ddufewHt7gmruOUg8uFjm+Un7QFR72srgVnuCam4Ikqq5PLKquzyktxfETq5gnggA1kLyGe2yTyIjvb3wPS8GrtqLrN1LCfQUJAsE+HNcXA/4Tm5dDJFEtw9FoYms2EF1WqV5czx+nem3E9wWGmXxhkBMaagNcagdu6hLSclFmcQvkTIgTsIMJZ72NRKYokWh3U2ePvYYJHpzPH6ejjkAVsdb0O7e71v7FEl0U1MQfShxI7Lb+H1AfRf4fbixhb60T1o8SbnbIwjA2bd+iwSwL8ESI0JZvEHqsJHaEEcoQR6wtQkeTkE4JQgike2T2rFLykojRYtC2/wKdckXd5siCCIB7MuwtU/he170PKBHZONLVH+oDz652xRBEQlgX4p12KguBm29d45EZE03FQ91CAFoh8wESSSA9UWs/afGdk8WsWiLOqmFjUBA2iEzQRMp3z5Zo1Uu2+JqR1dtiFNH4gDANvjYHxIRNJEA9iXZFrGEEk+7Ev9VbYiLHIUDcHl5sFsEUSSAfVk2RyJ0168qGpFQtCibw6IdhWTZD/YY2VMVpdID7kDFSlbDzug8InIUPFsz5wZBtaQ8SXChRZW6GHObS/T4BJ5cfkQhsAIBwReJdCSUxvaSho4ia7oLeXKBcxR4gi4SwGZyE6CGjtYUF6qAq70NARlRKEY1iAQIPL5irrng9EmAOSUpl8rmOUF3HHiSAH7LJ1LnlhcQ6AAC7MlRVJtIALMA2yHz5iOyIyt2iGZXq04goDpFAgRCGZnzACA6zfkkWNsWaE+OolpFAgRCCahagYDqcRwokuBWHQk4gCoWCKhukQAm1H3gRs5zjIC52UlUsUBAdVd3PIncC2D9n7RP5XCd6STStOX/HDtis2XStq0AAAAASUVORK5CYII=":void 0,style:!1!==_?{display:"block",width:p.a,position:"relative",textAlign:"center",top:H,left:G,whiteSpace:"pre"}:{display:"none"},alt:""}),Object(T.jsx)("img",{style:!1!==_?{backgroundColor:Object(a.F)(s),borderRadius:"50%",position:"relative",display:"block",width:p.a-4,textAlign:"center",top:H-48,left:G+1.5,whiteSpace:"pre"}:{display:"none"},src:!1!==_?r.information.avatarSrc:void 0,alt:""})]})]})]})};Pr.displayName="RawParticipant";var Mr=function(e){return m.a.useMemo((function(){return Object(T.jsx)(Pr,Object(y.a)({},e))}),[e.size,e.participant.id,e.participant.information.avatarSrc,e.participant.information.color,e.participant.information.name,e.participant.information.textColor])};Mr.displayName="MemorizedParticipant";var Nr=["avatar/whoo-avatars_whoo-01.png","avatar/whoo-avatars_whoo-02.png","avatar/whoo-avatars_whoo-03.png","avatar/whoo-avatars_whoo-04.png","avatar/whoo-avatars_whoo-05.png","avatar/whoo-avatars_whoo-06.png","avatar/whoo-avatars_whoo-07.png"],xr=Object(Y.a)({more:function(e){return{position:"absolute",width:.5*e.size,height:.5*e.size,left:e.position[0]+.4*e.size,top:e.position[1]-.8*e.size,opacity:"0"}},hideMenuContainer:function(e){return{display:"flex",position:"relative",width:350,height:250,overflow:"hidden",userSelect:"none",userDrag:"none",bottom:"auto",transform:"scale(0)",backgroundColor:"transparent",transition:"0s ease-out",cursor:"default"}},showMenuContainer:function(e){return{display:"flex",position:"relative",width:350,height:250,overflow:"hidden",userSelect:"none",userDrag:"none",top:e.mem.zoomY-125,left:e.mem.zoomX-170,bottom:"auto",transform:"scale(1.2)",backgroundColor:"transparent",transition:"0.3s ease-out",transitionDelay:"0.1s",cursor:"default"}},dashedCircle:function(e){return{position:"relative",width:200,height:200,borderWidth:2,borderStyle:"solid",borderColor:"#9e886c",borderRadius:"50%",opacity:.4,top:25,left:65,background:"radial-gradient(#ffffff, #ffffff, #ffffff, #9e886c, #9e886c)",zIndex:-9999}},moreInfo:function(e){return Object(y.a)({display:"block",height:p.a,position:"absolute",textAlign:"center",top:180,left:145,whiteSpace:"pre",cursor:"default",background:"#9e886c"},Lr)}}),Lr={"&":{margin:"5px",borderRadius:"50%",width:"35px",height:"35px",padding:"3px"},"&:hover":{backgroundColor:"black",margin:"5px",padding:"3px",borderRadius:"50%"},"&:active":{margin:"5px",padding:"3px",borderRadius:"50%"}},Fr=function e(){Object(b.a)(this,e),this.prebThirdPersonView=!1,this.mouseDown=!1,this.dragging=!1,this.upTime=0,this.downTime=0,this.downXpos=0,this.downYpos=0,this.upXpos=0,this.upYpos=0,this.contentX=0,this.contentY=0,this.zoomX=0,this.zoomY=0,this.moveX=0,this.moveY=0,this.clickStatus="",this.userAngle=0,this.clickEnter=!1,this.pingX=0,this.pingY=0,this.hidePinIcon=0},Br=function(e){var t=e.stores.map,n=e.stores.participants,o=n.local,r=Object(f.useRef)(new Fr).current;if(""===o.information.avatarSrc){var s=Math.ceil(Math.random()*(Nr.length-1));o.information.avatarSrc=Nr[s],o.sendInformation(),o.saveInformationToStorage(!0)}Object(a.b)(e.participant.id===o.id);var c=Object(f.useRef)({}).current,l=function(e){!function(e){var i=Object(a.N)(e.xy,t.toWindow(o.pose.position)),r=Math.sqrt(i[0]*i[0]+i[1]*i[1]);if(r>50&&(i=Object(a.A)(50/r,i)),n.local.thirdPersonView){var s=t.rotateFromWindow(i);o.pose.position=Object(a.a)(o.pose.position,s),c.smoothedDelta||(c.smoothedDelta=[i[0],i[1]]),c.smoothedDelta=Object(a.a)(Object(a.A)(1-.8,s),Object(a.A)(.8,c.smoothedDelta));var l=180*Math.atan2(c.smoothedDelta[0],-c.smoothedDelta[1])/Math.PI-o.pose.orientation;l<-180&&(l+=360),l>180&&(l-=360),o.pose.orientation+=.2*l}else o.pose.position=Object(a.a)(t.rotateFromWindow(i),o.pose.position);o.savePhysicsToStorage(!1)}(e)},u=gr(l,"dragHandle",(function(e){return e.dragging&&l(e),function(){var e=t.toWindow(o.pose.position),r=[e[0],e[1]],s=.2,l=t.left+t.screenSize[0]*s,u=t.left+.8*t.screenSize[0],d=.8*t.screenSize[1],p=n.local.thirdPersonView?t.screenSize[1]*s:d;r[0]<l&&(r[0]=l),r[0]>u&&(r[0]=u),r[1]<p&&(r[1]=p),r[1]>d&&(r[1]=d);var h=Object(a.N)(e,r),f=Math.sqrt(h[0]*h[0]+h[1]*h[1]);f>600?h=Object(a.A)(600/f,h):f<100&&(h=Object(a.A)(100/f,h));var m=Object(a.A)(.1,t.rotateFromWindow(h));if(Math.abs(m[0])+Math.abs(m[1])>.2){var v=t.matrix.translate(-m[0],-m[1]),g=t.rotateFromWindow([v.e,v.f]),b=.5,y=!1;g[0]<-vr.b*b&&(g[0]=-vr.b*b,y=!0),g[0]>vr.b*b&&(g[0]=vr.b*b,y=!0),g[1]<-vr.b*b&&(g[1]=-vr.b*b,y=!0),g[1]>vr.b*b&&(g[1]=vr.b*b,y=!0);var A=t.rotateToWindow(g),S=Object(i.a)(A,2);return v.e=S[0],v.f=S[1],t.setMatrix(v),t.setCommittedMatrix(v),c.scrollAgain=!y,!y}return c.scrollAgain=!1,!1}()}),33,(function(){k(!0)}));Object(f.useEffect)((function(){var e;null===(e=u.target.current)||void 0===e||e.focus({preventScroll:!0})}));var d=Object(h.b)((function(){return{position:o.pose.position,size:e.size,mem:r}})),p=o?o.getColor():["white","black"],v=Object(i.a)(p,1)[0],g=xr(d),b=m.a.useState(!1),A=Object(i.a)(b,2),S=A[0],E=A[1],O=m.a.useState(!1),C=Object(i.a)(O,2),j=C[0],k=C[1],_=Fe(E,c);function R(){k(!0),t.keyInputUsers.add("LocalParticipantConfig")}var I=Object(f.useRef)(null);return Object(T.jsxs)("div",Object(y.a)(Object(y.a)(Object(y.a)({ref:u.target},u),_),{},{children:[Object(T.jsx)(Mr,Object(y.a)(Object(y.a)({},e),{},{isLocal:!0,onContextMenu:function(e){e.preventDefault(),R()}})),Object(T.jsx)(Be,Object(y.a)(Object(y.a)({show:S,className:g.more,htmlColor:v},_),{},{buttonRef:I,onClickMore:R})),Object(T.jsx)(za,{stores:e.stores,open:j,close:function(){k(!1),t.keyInputUsers.delete("LocalParticipantConfig")},anchorEl:I.current,anchorOrigin:{vertical:"top",horizontal:"left"},anchorReference:"anchorEl"})]}))},Ur=function(e){return m.a.useMemo((function(){return Object(T.jsx)(Br,Object(y.a)({},e))}),[e.size,e.participant.id,e.participant.information.avatarSrc,e.participant.information.color,e.participant.information.name,e.participant.information.textColor])};Ur.displayName="MemorizedLocalParticipant";var Vr=function(e){var t=e.stores.participants,n=t.find(e.participantId),o=Object(h.b)((function(){return n.mouse.position})),a=Object(h.b)((function(){return n.information.name})),r=n.getColor(),s=Object(i.a)(r,1)[0];if(!o)return Object(T.jsx)("div",{});var c=e.participantId===t.localId,l=Object(T.jsx)("div",{style:{width:18,height:30,left:o[0],top:o[1],position:"absolute",pointerEvents:c?"none":"auto"},children:Object(T.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 60 100",children:Object(T.jsx)("polygon",{points:"32,100 53,92 36,57 60,56 0,0 0,81 16,65 32,100",stroke:"black",fill:s,strokeWidth:"6"})})});return c?l:Object(T.jsx)(Ue.a,{title:a,children:l})},Jr=function(e){return Object(T.jsx)(Mr,Object(y.a)(Object(y.a)({},e),{},{isLocal:!1,isPlayback:!0}))},Gr=Object(Y.a)({more:function(e){return{position:"absolute",width:.5*e.size,height:.5*e.size,left:e.position[0]+.4*e.size,top:e.position[1]-.8*e.size,opacity:"0"}}}),Hr=!1;var zr=function(e){var t,n=m.a.useRef({}).current,o=m.a.useState(!1),r=Object(i.a)(o,2),s=r[0],c=Fe(r[1],n),u=m.a.useState(!1),d=Object(i.a)(u,2),p=d[0],v=d[1],g=e.participant.getColor(),b=Object(i.a)(g,1)[0],A=null===(t=de.b.conference._jitsiConference)||void 0===t?void 0:t.isModerator(),S=e.stores.map,E=e.participant;Object(a.b)(e.participant.id===E.id);var O=Object(h.b)((function(){return{position:e.participant.pose.position,size:e.size}})),C=Gr(O);function j(){e.stores.map.keyInputUsers.add("remoteForm"),v(!0)}var k=m.a.useRef(null),_=function(e){!function(e){if(!1!==A){var t=Object(a.N)(e.xy,S.toWindow(E.pose.position)),i=Math.sqrt(t[0]*t[0]+t[1]*t[1]);i>50&&(t=Object(a.A)(50/i,t));var o=S.rotateFromWindow(t);E.pose.position=Object(a.a)(E.pose.position,o),n.smoothedDelta||(n.smoothedDelta=[t[0],t[1]]),n.smoothedDelta=Object(a.a)(Object(a.A)(1-.8,o),Object(a.A)(.8,n.smoothedDelta));var r=180*Math.atan2(n.smoothedDelta[0],-n.smoothedDelta[1])/Math.PI-E.pose.orientation;r<-180&&(r+=360),r>180&&(r-=360),E.pose.orientation+=.2*r,de.b.conference.sendMessage(pe.b.UPDATE_POSE,E.id)}}(e)},R=gr(_,"dragHandle",(function(e){var t;return"pointermove"===(null===(t=e.event)||void 0===t?void 0:t.type)?_(e):Hr=!1,function(){var e=S.toWindow(E.pose.position),t=[e[0],e[1]],o=.2,r=S.left+S.screenSize[0]*o,s=S.left+.8*S.screenSize[0],c=.8*S.screenSize[1],u=l.a.local.thirdPersonView?S.screenSize[1]*o:c;t[0]<r&&(t[0]=r),t[0]>s&&(t[0]=s),t[1]<u&&(t[1]=u),t[1]>c&&(t[1]=c);var d=Object(a.N)(e,t),p=Math.sqrt(d[0]*d[0]+d[1]*d[1]);p>600?d=Object(a.A)(600/p,d):p<100&&(d=Object(a.A)(100/p,d));var h=Object(a.A)(.1,S.rotateFromWindow(d));if(Math.abs(h[0])+Math.abs(h[1])>.2){var f=S.matrix.translate(-h[0],-h[1]),m=S.rotateFromWindow([f.e,f.f]),v=.5,g=!1;m[0]<-vr.b*v&&(m[0]=-vr.b*v,g=!0),m[0]>vr.b*v&&(m[0]=vr.b*v,g=!0),m[1]<-vr.b*v&&(m[1]=-vr.b*v,g=!0),m[1]>vr.b*v&&(m[1]=vr.b*v,g=!0);var b=S.rotateToWindow(m),y=Object(i.a)(b,2);return f.e=y[0],f.f=y[1],S.setMatrix(f),S.setCommittedMatrix(f),n.scrollAgain=!g,!g}return n.scrollAgain=!1,!1}()}),33,(function(){}));return Object(f.useEffect)((function(){var e;null===(e=R.target.current)||void 0===e||e.focus({preventScroll:!0})})),Object(T.jsxs)("div",Object(y.a)(Object(y.a)({},c),{},{onClick:function(t){return n=e.participant.id,void(p||(l.a.yarnPhones.has(n)?l.a.yarnPhones.delete(n):l.a.yarnPhones.add(n),l.a.yarnPhoneUpdated=!0));var n},onContextMenu:function(e){e.preventDefault(),j()},children:[Object(T.jsx)(Mr,Object(y.a)(Object(y.a)({},e),{},{isLocal:!1})),Object(T.jsx)(Be,Object(y.a)(Object(y.a)({show:s,className:C.more,htmlColor:b},c),{},{buttonRef:k,onClickMore:function(e){e.stopPropagation(),j()}})),Object(T.jsx)(Qa,{open:p,close:function(){e.stores.map.keyInputUsers.delete("remoteForm"),v(!1)},stores:e.stores,participant:e.participant,anchorEl:k.current,anchorOrigin:{vertical:"top",horizontal:"left"},anchorReference:"anchorEl"})]}))},Qr=function(e){var t=Math.min(e.start[0],e.end[0]),n=Math.min(e.start[1],e.end[1]),o=Math.abs(e.start[0]-e.end[0]),a=Math.abs(e.start[1]-e.end[1]),r=Object(f.useState)(!1),s=Object(i.a)(r,2),c=s[0],l=s[1];if(e.stores.participants.yarnPhones.size>0)var u=setTimeout((function(){clearTimeout(u),l(!1===c)}),500);return Object(T.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",style:{position:"absolute",left:t,top:n,width:o,height:a,pointerEvents:"stroke"},viewBox:"0, 0, ".concat(o,", ").concat(a),onClick:function(){e.stores.participants.yarnPhones.delete(e.remote),e.stores.participants.yarnPhoneUpdated=!0},children:[Object(T.jsx)("defs",{children:Object(T.jsxs)("linearGradient",{id:"lineShadow",x1:e.start[0]-t,y1:e.start[1]-n,x2:e.end[0]-t,y2:e.end[1]-n,gradientUnits:"userSpaceOnUse",children:[Object(T.jsx)("stop",{"stop-color":c?"#FFA07A":"#FFFFFF",offset:"0"}),Object(T.jsx)("stop",{"stop-color":c?"#FFFFFF":"#FFA07A",offset:"1"})]})}),Object(T.jsx)("line",{x1:e.start[0]-t,y1:e.start[1]-n,x2:e.end[0]-t,y2:e.end[1]-n,stroke:"url(#lineShadow)","stroke-dasharray":"5,5","stroke-width":"3"})]})},Kr=function(e){var t=e.stores.participants,n=Object(h.b)((function(){return Array.from(t.remote.keys()).filter((function(e){return t.find(e).physics.located}))})),i=Object(h.b)((function(){return t.localId})),a=n.map((function(n){return Object(T.jsx)(zr,{stores:e.stores,participant:t.remote.get(n),size:Fi.a},n)})),r=Object(T.jsx)(Ur,{participant:t.local,size:Fi.a,stores:e.stores},"local"),s=Object(h.b)((function(){return Array.from(t.yarnPhones).map((function(n){var i=t.local.pose.position,o=t.remote.get(n);if(Hr)Hr=!1;else if(o){var a=o.pose.position;return Object(T.jsx)(Qr,{start:i,end:a,remote:n,stores:e.stores},n)}}))})),c=Object(h.b)((function(){return Array.from(t.playback.keys())})).map((function(n){return Object(T.jsx)(Jr,{stores:e.stores,participant:t.playback.get(n),size:Fi.a},n)})),l=Object(h.b)((function(){return Array.from(t.remote.keys()).filter((function(e){return t.find(e).mouse.show}))})).map((function(t){return Object(T.jsx)(Vr,{participantId:t,stores:e.stores},"M_".concat(t))})),u=Object(h.b)((function(){return t.local.mouse.show}))?Object(T.jsx)(Vr,{participantId:i,stores:e.stores},"M_local"):void 0;return null!==o.a.testBot?Object(T.jsx)("div",{}):Object(T.jsxs)("div",{style:{position:"absolute",zIndex:32767},children:[s,c,a,r,l,u]})};Kr.displayName="ParticipantsLayer";var Wr=function(e){var t=e.stores.map;function n(e){Object(tt.i)(e,t).then((function(e){var t,n=Object(g.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;p.c.shareContent(i)}}catch(o){n.e(o)}finally{n.f()}}))}Object(f.useEffect)((function(){window.document.body.addEventListener("paste",(function(e){var i;i=e,p.c.pasteEnabled&&0===t.keyInputUsers.size&&i.clipboardData&&(i.preventDefault(),n(i.clipboardData))}),{passive:!1}),window.document.body.addEventListener("drop",(function(e){var t;(t=e).preventDefault(),t.stopPropagation(),t.dataTransfer&&n(t.dataTransfer)}),{passive:!1}),window.document.body.addEventListener("dragover",(function(e){var t;e.preventDefault(),e.stopPropagation(),(null===(t=e.dataTransfer)||void 0===t?void 0:t.dropEffect)&&(e.dataTransfer.dropEffect="copy")}),{passive:!1})}),[]);var i=Object(h.b)((function(){return p.c.pasted}));return Object(T.jsx)(ua,Object(y.a)(Object(y.a)({},e),{},{hideAll:""===i.type||"roomimg"===i.shareType,content:i,onShare:function(e){i.zorder=Math.floor(Date.now()/Qn.c),i.pinned=!0,p.c.addLocalContent(it.a.cloneDeep(i)),p.c.setPasted(Object(tt.b)())},onClose:function(e){p.c.setPasted(Object(tt.b)()),e.stopPropagation()},updateAndSend:function(e){p.c.setPasted(e)},updateOnly:function(e){p.c.setPasted(e)}}))},Yr=Object(Y.a)({slContainer:{userDrag:"none",userSelect:"none"}}),qr=m.a.memo((function(e){var t=e.stores.contents,n=Yr(),i=(e.transparent,Object(zt.a)(e,["transparent"]));return Object(T.jsxs)("div",{className:n.slContainer,children:[Object(T.jsx)(h.a,{children:function(){var n=Array.from(t.all),o=e.transparent?n.filter((function(e){return!Object(Qn.j)(e)})):n;return Object(T.jsx)(T.Fragment,{children:o.map((function(e){return Object(T.jsx)(ya,Object(y.a)({content:e},i),e.id)}))})}}),Object(T.jsx)(Wr,Object(y.a)({},i))]})}),(function(e,t){return it.a.isEqual(e.stores.contents.all,t.stores.contents.all)&&e.transparent===t.transparent}));qr.displayName="ShareLayer";var Xr=Object(Y.a)({img:function(e){if(e.transparent)return{display:"none"};var t=Object(a.F)(e.fill);return{position:"absolute",top:.5*-vr.b,left:.5*-vr.b,backgroundColor:t,height:vr.b,width:vr.b}},logo:function(e){return e.transparent?{display:"none"}:{position:"absolute",top:0,right:0,bottom:0,left:0,margin:"auto",height:"10em",userDrag:"none",userSelect:"none",pointerEvents:"none"}}}),Zr=function(e){var t=e.stores.roomInfo,n=Object(y.a)({color:[0,0,0],fill:[0,0,0]},e);Object(h.b)((function(){n.color=t.backgroundColor,n.fill=t.backgroundFill}));var i=Xr(n);return Object(T.jsx)(h.a,{children:function(){return Object(T.jsx)("div",{className:i.img})}})};Zr.displayName="Background";var $r=function(e){return Object(T.jsxs)(mr,Object(y.a)(Object(y.a)({},e),{},{children:[Object(T.jsx)(Zr,Object(y.a)({},e)),Object(T.jsx)(qr,Object(y.a)({},e)),Object(T.jsx)(Kr,Object(y.a)({},e))]}))};$r.displayName="Map";var es="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAAEhElEQVR4nO2c0XHaQBBAH5n8h1RguQLTQUgFdgfBHZAOcAVxKjDuAFcQXEGgA9yBqED5WGmEsZCEjNhdZ9+MxkaWuRs97Wp1dzDIsozAJ5+0OxB0J+Q5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ5JuQ55rN2B3okAUb5VjAGVkCav97k2/JsvTohgw/2ydibne3Lkf+7BubAAhFqno8gbwhM8+1YYYd4BmYYj0jv8qbIST6VtH1MS/Qqb4ikt29nau83cqGYwqO8ERIJfUXbIdZIwZM2HHc2vD0q3KAjDuAqb3uo0HYlniJvBPzV7gSGItBL5CXYKRqukPutOl7kLdBJlYf4hlShqlhNm8V9JUWqvF+KfanjEsUHeouRN0aGsMaIxJliX5qYaTZuLfImwEP++1ekunw4eLQN1KLPUuTNKUU9UqZM69xoNWxF3hT4sfN6gaTMK53uHMV/LW/M24JkyeupnGO4Q1LuALgFtjXHroHv+bGX+etjOdcQ3VuyLNPchlmWpdlr0vxv0+x45hVtTGqOTyr6s+nQrsr50468qmmcVf6zyzDUvOU+kBmDzd6+FCMP4G3QlFfMw52SpOW+uv1mxi6b0JTXZba7iSlvT/7swLEXyKPJLiNeF06m0VzD0lSlbTq8ZzHyf0/5qFFXUDwgwhZ5fyYd2lRD8yG9ruEBdmYRmnjhcAruFe2C5RAJUrjUlflWWGo1bFVekVI9VH5qfbSaNtdI2hwDf87Sm26opUywG3lXlGtVnnW7UstMs3GrkQfwhKRPq4WLatSBbuS9NPz9mnJu76733hzPRLsDmvLa3OjnlBOyltLnTwysqdGUN29xzMXOcTd0G/U/NY/IIIA6mvJWtIuma0RgiqRRTYG/MZAuC7SrzVnL435QChwhJ/Hc/MTYzL6FNSwLJLra8IRc+SmSRu+R1No3WwzONmhHHoiMtqnwmnJl2QKJwjv6H0YzOdJjQV4RRW0FXCCjLnPKSjRB0lrT40dXkp7e911YSJsFCXKFH7vo6BERuMlfF8Nq4/z3U6XVrxj4fMIuluSBRNI93SZEi48lLymXUuy+7/6CpiES8W3buqXd483ZsCYP5KSueH/EFGtUNnv7N7yWMEIumKZVYM9INJvBojyQk9vHcoQ1UiDtRyb5/hn1F83g5D16BxYKlr7ZIvfF70iUVYkDuWASJD1WVb+WhucAu5G3pN1i1heq17qsKL9f5ZCsJhLKwidFojIKlhbUdWqLnEg335fSFxa/AaluVdkjMkRlKgK0sChvUrHvGZHWNQV+SCzKK8YQt0hqvCekVWLxnlc8UC+V+2Eei/KClvwPz3kflpDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmJDnmH/0ilgyg53pQQAAAABJRU5ErkJggg==",ts="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvCAYAAADixZ5gAAAACXBIWXMAAC4jAAAuIwF4pT92AAADeUlEQVR4nO2c0W3bMBRFj4v+1xtUmaDeIOoEzQZ1N8gGyQjpBHU36AZ1J6izAbOBM0H6QRtxVMVNY1J6F7oHEGIIwiPhEz3yUaJnDw8PGE3ejN0B83osTxjLE8byhLE8YSxPGMsTxvKEsTxhLE8YyxPG8oSxPGEsTxjLE8byhLE8YSxPGMsTxvKEsTxhLE8YyxPG8oSxPGEsTxjLE8byhHk7dgeOMAcWhWK1u7+b3ZEKxR2ViPIWwDXwqWIbX4HLivEHYRZsi9cS+DZQW9937ckSSd4C+D1wm9ICI01Yrkdo8zOwGqHdIkSRN+fvMe4e+AKcAbMTjjPg9kjbsgKjyOubVV6Sv9R0YuwE/PjHNZICo8jrYzNwe3ICpyzvvueclMDI8mrTIi5wyvI2iAucsjwQFzh1eSAscCrytj3n5gefJQVORV7fzPWm55oWIYFR1jZb4Gfn3KxwG1vgXefcHY+LAAlodsf7Z2KEWgudkrxr4KpAnI/AukCck5lK2oQs71eBOMsCMYowJXkAF+QHsafQFOhHESI+Sa/JlrzgfUMW2fJ01tml4fnxb3SmJm9PIgvszjifuzakwKmlzdeQxu7Ac6jdeQse011J9m+VrQrHrYqSvIY8Re/WaiU4P/i8qhC/Ckpps6GOuEPayvGLoiQvDdDG0E/vT0IpbSby6kZL+TskkVPyqnDcqijJg/wFr0fuQxiU0qbpYHnCqKVN13kHKMlrqF/nzXnZklkIlNJmQ/0679gidTiU5KUB2uh71yUsSmkzkeu8C8rtmN2zJadkmZQJWvLAdd4TlNKm6WB5wqilzQX5NYamcNw1ZfYCDoqSvIa6dd4VgV7rewlKabOhfp3XVI5fFCV5qXL8e1znVSOR09ol5VdC0i6u5VVkjdCYVBultGk6WJ4wkeW1Y3dgR3d8DTMuRpHX94W0Q3eihwXwoXMuzBtmUSYsG/JU/bCOuyLXXWmE/kC+45Y958PIi7K5EsptfqzJHYEK+Ujy5uT/6pA7cnaEWj6LMuZBHvdajv9C31jsf4FwPXI/nhDpzjtkuTvOj19WnVsen7CnUXvSQ1R55gVESpvmP7E8YSxPGMsTxvKEsTxhLE8YyxPG8oSxPGEsTxjLE8byhLE8YSxPGMsTxvKEsTxhLE8YyxPG8oSxPGEsTxjLE8byhLE8YSxPGMsT5g9FnpQ4jUiu6wAAAABJRU5ErkJggg==",ns=!1;var is="";var os=function(){var e=gn(),t={map:c.b,participants:l.a,contents:p.c,chat:r.b,roomInfo:u.a},n=Object(f.useRef)(null),d=Object(f.useState)(!1),m=Object(i.a)(d,2),g=m[0],b=m[1],y=Object(f.useState)(!0),A=Object(i.a)(y,2),S=A[0],E=A[1],O=Object(f.useState)("chat"),C=Object(i.a)(O,2),j=C[0],k=C[1],_="",R="",I=Object(h.b)((function(){return t.contents.all}));I.filter((function(e){return"roomimg"===e.shareType})).map((function(e){return _=e.url})),I.filter((function(e){return"roomimg"===e.shareType})).map((function(e){return R=e.contentDesc}));var D=t.participants.local.getColorRGB(),P=!1,M=Object(h.b)((function(){return t.participants.localId})),N=sessionStorage.getItem("room");return ns=g,is=j,Object(f.useEffect)((function(){(F||M)&&setTimeout((function(){E(!1)}),5e3)})),window.addEventListener("keydown",(function(e){"F3"===e.key&&!1===P&&(e.preventDefault(),P=!0,!0===g?b(!1):!1===g&&b(!0))}),{}),window.addEventListener("touchmove",(function(e){e.preventDefault()}),{passive:!1,capture:!1}),window.addEventListener("contextmenu",(function(e){e.preventDefault()}),{passive:!1,capture:!1}),window.onerror=function(e,t,n,i,a){return"Ping timeout"!==(null===a||void 0===a?void 0:a.message)&&"Strophe: Websocket error [object Event]"!==(null===a||void 0===a?void 0:a.message)||null!==e||null!==t||null!==n||null!==i?console.warn("Global handler: ".concat(e),t,n,i,a):(s.a.setType("connection"),null!==o.a.testBot&&window.location.reload()),!0},Object(T.jsx)(h.a,{children:function(){return Object(T.jsxs)("div",{ref:n,className:e.back,style:{backgroundColor:"#0f5c81"},children:[Object(T.jsxs)(v.a,{pane2Style:!0===g?{display:"block",backgroundColor:"chat"===j?"#0f5c81":"#8b5e3c",boxShadow:"3px 10px 10px 3px black"}:{display:"none",backgroundColor:"#FFF"},className:e.fill,split:"vertical",minSize:0,defaultSize:!0===g?"77%":"100%",children:[Object(T.jsxs)(f.Fragment,{children:[Object(T.jsx)(cr,{showAllTracks:false,stores:t}),Object(T.jsx)(h.a,{children:function(){return Object(T.jsx)($r,{transparent:void 0!==p.c.tracks.mainStream||false,stores:t})}}),Object(T.jsxs)("div",{style:{position:"absolute",right:"0%",top:"0px",borderRadius:"5px",display:"flex"},onClick:function(){P=!0,!0===g?"chat"===is&&b(!1):!1===g&&b(!0),k("chat")},children:[Object(T.jsx)("img",{src:"data:image/png;base64,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",style:{width:50,height:"auto",position:"relative",top:"0px",left:"0px",userSelect:"none",zIndex:S?0:9},draggable:!1,alt:""}),Object(T.jsx)("img",{src:es,style:{width:50,height:50,color:"white",position:"absolute",top:"2px",left:"5px",userSelect:"none",zIndex:S?0:99},draggable:!1,alt:""})]}),Object(T.jsxs)("div",{style:{position:"absolute",right:"0%",top:"0px",borderRadius:"5px",display:"flex"},onClick:function(){P=!0,!0===g?"content"===j&&b(!1):!1===g&&b(!0),k("content")},children:[Object(T.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAH4AAACoCAYAAAAmRFq6AAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAArqSURBVHjaYvz//z8DNUFhYSEjkAJhZihmgdJMop9v6LH++drGMAroAcARywihoZH8H8a+ABBALDSwkBEa2axAzA7FbCD+P0YWOUaG/1ajcTLwACCAaBHxTFBzOYCYB4q5QQngDxO76GiQDw4AEEBUjXhoMc8EzeFcQCwAxCJAzA9KAH+ZWKVGg3xQAEaAAKJljucEYj4gFoVi/v+MLBKjYT44AEAA0TLi2aHFPCi3CwOx0H9GJqHRIB8cACCAmGhoLitS5POBczwDI89okA8OABBAtIh4WD0Pi3w2aALgBMqwjwb54AAAAcREQ7MZ0RMCMMczjQb54AAAATQaESMUAATQaMSPUAAQQKMRP0IBQACNRvwIBQABNBrxIxQABNBoxI9QABBAoxE/QgFAAI1G/AgFAAE0GvEjFAAE0GjEj1AAEECjET9CAUAAjUb8CAUAATQa8SMUAATQaMSPUAAQQKMRP0IBQACNRvwIBQABNBrxIxQABNBoxI9QABBAoxE/QgFAAI1G/AgFAAE0GvEjFAAE0GjEj1AAEECjET9CAUAAjUb8CAUAATQa8SMUAATQaMSPUAAQQKMRP0IBQACNRvwIBQABNBrxIxQABNBoxI9QABBAoxE/QgFAAI1G/AgFAAE0GvEjFAAE0GjEj1AAEECjET9CAUAAjUb8CAUAATQa8SMUAATQaMSPUAAQQKMRP0IBQACNRvwIBQABNBrxIxQABNBoxI9QABBAoxE/QgFAAI1G/AgFAAE0GvEjFAAE0GjEj1AAEECjET9CAUAAjUb8CAUAATQa8SMUAATQaMSPUAAQQKMRP0IBQACNRvwIBQABNBrxIxQABNBoxI9QABBAoxE/QgFAAI1G/AgFAAE0GvEjFAAE0GjEj1AAEECjET9CAUAAjUb8CAUAATQa8SMUAATQaMSPUAAQQKMRP0IBQACNRvwIBQABNBrxIxQABNBoxI9QABBAoxE/QgFAAI1G/AgFAAE0GvEjFAAE0GjEj1AAEECjET9CAUAAjUb8CAUAATQa8SMUAATQaMSPUAAQQKMRP0IBQACNRvwIBQABNBrxIxQABNBoxI9QABBAoxE/QgFAAI1G/AgFAAE0GvEjFAAE0GjEj1AAEECjET9CAUAAjUb8CAUAATQa8SMUAATQaMSPUAAQQKMRP0IBQACNRvwIBQABNBrxIxQABNBoxI9QABBAoxE/QgFAAI1G/AgFAAE0GvEjFAAE0GjEj1AAEECjET9CAUAAjUb8CAUAATQa8SMUAATQaMSPUAAQQKMRP0IBQACNRvwIBQABNBrxIxQABNBoxI9QABBAoxE/QgFAANEy4v+j0Qz/GZl/jwb54AAAAcREwwhHj/z/P1l4P40G+eAAAAFEqxz/DxrZ/5Dwf0iuZ/ozGuwDDwACiFY5HlukgyP+DxPHl9FgH3gAEEBUjfj+/n7kCP8Limco/gvF/36y8HwYDfaBBwABRKuiHjnSf0MxOOf/ZuH6PBrsAw8AAogWEQ/L8aBI/wXEP6ERD87539hEXo3W8wMPAAKIVnX8X2hkwyL+J5T9B1Lc870ZDfqBBQABRKscDyvifwDxdyj9C1bkf2UXeT4a9AMLAAKIljkeltu/QfF3WK7/wSrw7i8T64/R4B84ABBAtGzcwXL8VyD+Ao14WH3/7wu7xP3R4B84ABBAVI94pC7dH7SI/wLN+eDI/8Ih/my0Tz9wACCAaDly9xupqAcN1X5EyvngXP+RS+b2aBQMDAAIIFpO0vyFRvxXpIiHRT6oJPgNrOvffmMTfjIaDfQHAAFEk4iHFveweh6Uw0GDNh+g+CM0MYASxd+PXLL3Rot8+gOAAKL1tCysgQeK+PdA/A5KwyL/1z9Glp/vuRWujQ7q0BcABBDNIh4p1/+C1vOgyH4LxG+gCeAjVPzXLxaeT2941M6PRgf9AEAA0XoFDnquB0X4ayh+B637YZH/8SOn7PXRKKEPAAggmkY8UtfuF7Roh+X6V9DIf4Mc+cAu3tPXvBqnRot92gOAAGKhgx3/oX36n9Bcz4KEmZESH3jOHpTzgcX+OcGvD7RY/v3gGY0i2gCAAKL5YkukXA9r4cNy/QsgfgalX0Fb/OCuHjDy37/m0zgz2tWjHQAIILqsssXS0PsALepBkzVPofQLaIIAN/qArf1v77kVr7/lUTk/Oq5PfQAQQIz///+nm2WFhYWMQIoViNmBmBuIBYBYGIjFoFgUiIWAmB8qzwHEbKBqgefHS2meny+UmP/95hiNNorBIYAAomvEQyOfCVq/gyKUCxrJQtAEAIp4EbTI54QmFFCCYeH6+UaC8/cHMY7fHyRH44/8iAcIILpHPFLOh0U+KGJ50RIAiBaEivFAEwg7VD0rtFHIDEwEkux/Pguz/v3Oy/r3m+BofBIf8QABNCARjxT5zGhFPywBCEKrARDmg0Y+rOiH5X5WtN4BMzARCLD//gRKCPwsf3/wjvYKcEc8QAANWMQjRT4TWu7ngkY0HxTzQjEs58OKflgCYENLBPDEwPT/DwcwMfCz//4szPL3Ox8wIfCOthEgEQ8QQAMa8UiRD0sArEiRygXF3EiYEynyOZBKADY0zIKUGOBVAwgDSwMe1j9fBdj+fuNn+/NFcIRWEYcAAmjAIx5L7mdCyslsSJHLicRGFmNHE2dDSjxsSNUCeoJghtGgKgKYGPjZ/3wRHiFVxCGAABo0EY+lBGBGagOwohXr6DmcHQlz4KDZCJQMKO0Fzt/vRYZxFXEIIIAGXcSjJQAGBsSwLhNa5KAX58iJgh1LgkAvHdjREgQrWqMRpYoAtRc4fn0QgVURoMTA+P8fy1CNeIAAGrQRjyMRIFcHTMgRg5ZrWdEwekLAVSqglwzoVQQzWi9CEFRFANsNfJDE8JN3qEQ8QAANiYgnkBiYkKoGXIkBvWRArybwJQRsiQFbdxJEMwGrCFHWP9/4QF1K1r9fBQdpFXEIIICGbMQTUSowYkkI2KoIViwJgY2ExIBsBjNa4xHWpRQAtheEgKWC0CCpIg4BBNCwiXgSqwgmtGKblUDJgK9U4MDRcGTF1XAElgbc7L8/ioKqiAEadTwEEEDDOuIprCJw9SjYsXQ1cZUK6CUD3l4EsIrgp9Oo4yGAABpxEU/EIBK+KoIFaZQRvZrA1aVEbziijziyYhlfwBh1ZAO2F6hYRRwCCKDRiCevisDWi2AhcnyBE0/DkQ1HQmCBVRGgUUcqTEwdAgig0YinvIpgwtOLYMNSKhDTkyDUi6B0YuoQQACNRjx1qghGtESAr/HIimegCVepwI5lbAHrxBS0vSAMTAzA9sI3LmBi4Gf6/5cfPeIBAmg04mlfRTASGGhiQYtUXKUCviFo9FIBZC9ojSNocetrYCL4xvXrDTv7ny9iTP9+GzEy/P8LEECjEU//KoKUUUdsbQVsCQF9YgpkDmiNI2hJO2j/AmhN4yMGyLpGEP8LQACNRvzgqSKYsHQnsQ0/s2HpTqInBjaoVaAl7aB9C6+hkQ7axwBezAoQQKMRPzxHHdmh+kG5HrakHbZtDbSE/SdAAI1G/PCsIlihamEHVHxnQDuYAiCARiN++I46MkPVIp9ABjt57C9AAI1G/PAddYSJo582+he0wQUggEYjfni3FxiQIh8c0dBdTQwAATQa8SMUAATQaMSPUAAQQKMRP0IBQACNRvwIBQABNBrxIxQABNBoxI9QABBAoxE/QgFAAI1G/AgFAAEGAAqOyuXcIu1aAAAAAElFTkSuQmCC",style:{width:50,height:"auto",position:"relative",top:"49px",left:"0px",userSelect:"none",zIndex:S?0:8},draggable:!1,alt:""}),Object(T.jsx)("img",{src:ts,style:{width:50,height:50,color:"white",position:"absolute",top:"52px",left:"5px",userSelect:"none",zIndex:S?0:98},draggable:!1,alt:""})]}),Object(T.jsx)(on,{stores:t,height:Object(a.x)()&&Object(a.v)()?100:void 0}),Object(T.jsx)(mn,{stores:t,height:Object(a.x)()&&Object(a.v)()?100:void 0}),Object(T.jsx)(dn,{stores:t,height:Object(a.x)()&&Object(a.v)()?100:void 0})]}),Object(T.jsx)("div",{style:{display:!0===g?"block":"none",minWidth:"280px",width:"100%",maxWidth:"280px"},children:Object(T.jsx)(ar,{stores:t})})]}),Object(T.jsxs)("div",{style:{width:"100%",height:"100%",alignItems:"center",justifyContent:"center",verticalAlign:"center",position:"absolute",backgroundColor:"#5f7ca0",textAlign:"center",display:S?"block":"none"},children:[Object(T.jsx)("p",{style:{textAlign:"right",color:"white",position:"relative",right:"24.5px",top:"20px"},children:"Version 1.7.2"}),Object(T.jsxs)("div",{style:{position:"relative",top:""===_?"20%":"0%"},children:[Object(T.jsx)("p",{style:{textAlign:"center",color:"white",fontSize:"1.2em"},children:"Welcome To"}),Object(T.jsx)("p",{style:N?{textAlign:"center",color:"white",marginTop:"-0.8em",fontSize:"1.2em",fontWeight:"bold",opacity:1,transition:"opacity 300ms",width:"50%",marginLeft:"25%"}:{textAlign:"center",color:"white",marginTop:"-0.8em",fontSize:"1.2em",fontWeight:"bold",opacity:0},children:N}),Object(T.jsx)("img",{src:_,style:_?{height:"250px",transform:"scale(1)",opacity:1,transition:"opacity 300ms, transform: 300ms",userSelect:"none"}:{height:"0px",transform:"scale(0)",opacity:0,transition:"0.3s ease-out",userSelect:"none"},draggable:!1,alt:""}),Object(T.jsx)("p",{style:{textAlign:"center",color:"#cdcdcd",fontSize:"1em",overflow:"hidden",position:"relative",marginTop:"0.5em",width:"80%",marginLeft:"10%"},children:R}),Object(T.jsx)("img",{style:{width:"4em",backgroundColor:Object(a.F)(D),borderRadius:"50%",position:"relative",marginTop:""!==_?"20px":"-15px",userSelect:"none"},src:t.participants.local.information.avatarSrc,draggable:!1,alt:""}),Object(T.jsx)("p",{style:{textAlign:"center",color:"black",marginTop:"0.5em",fontSize:"1.2em"},children:t.participants.local.information.name}),Object(T.jsx)("p",{style:{textAlign:"center",color:"black",marginTop:"1.5em",fontSize:"1.2em"},children:"Give your web browser permissions"}),Object(T.jsx)("p",{style:{textAlign:"center",color:"black",marginTop:"-0.9em",fontSize:"1.2em"},children:"to access the mic and camera if necessary."}),Object(T.jsx)("img",{style:{width:"8em",position:"relative",userSelect:"none"},src:w,draggable:!1,alt:""})]})]})]})}})};os.displayName="App";var as=io,rs=function(){};function ss(e,t,n){var i=it.a.cloneDeep(t?t.pose:n?n.pose:{position:[0,0],orientation:0});return n&&e.position.forEach((function(t,o){if(e.position[o]>i.position[o]){var a=e.position[o]-i.position[o];i.position[o]+=Math.min(n.size[o],a>0?a:0)}})),Object(a.r)(e,i)}var cs=function(){function e(t,n,i,o){Object(b.a)(this,e),this.disposers=[],this.disposers.push(Object(ct.c)((function(){var e=null===n||void 0===n?void 0:n.getParticipantId(),r=e&&p.c.tracks.carrierMap.get(e),s=r?p.c.find(r):void 0,c=t.get(),u=it.a.clone(c.pose);"user"===c.soundLocalizationBase&&(u.orientation=0);var d=!1,h=!1;if(i&&(l.a.yarnPhones.has(i.id)?h=!0:i.closedZone&&(i.closedZone===c.zone?h=!0:d=!0),!d&&!h&&c.zone)){var f=Object(a.q)(c.zone.pose,c.zone.size);d=!(h=Object(a.t)(i.pose.position,.5*Fi.a,f))&&"close"===c.zone.zone}if(!i||i.physics.located&&!d){var m=ss(u,i,s);if(i&&h){rs("In zone: pid:".concat(i.id)),i.inLocalsZone=h;var v=Object(a.B)(m.position);v>1e-10&&(m.position=Object(a.A)(1/v,m.position))}var g=Object(a.d)(m);o.updatePose(g)}else o.updatePose(Object(a.d)({orientation:0,position:[vr.b,vr.b]})),rs("mute ".concat(i.id," loc:").concat(i.physics.located," other:").concat(d," rInL:").concat(h))}))),this.disposers.push(Object(ct.c)((function(){var e=i?i.tracks.audio:n;o.updateStream(null===e||void 0===e?void 0:e.getOriginalStream())}))),this.disposers.push(Object(ct.c)((function(){return o.updatePannerConfig(as)}))),this.disposers.push(Object(ct.c)((function(){return o.updateBroadcast(!!(null===i||void 0===i?void 0:i.physics.onStage))})))}return Object(vi.a)(e,[{key:"dispose",value:function(){var e,t=Object(g.a)(this.disposers);try{for(t.s();!(e=t.n()).done;){(0,e.value)()}}catch(n){t.e(n)}finally{t.f()}}}]),e}(),ls=function(){function e(t,n,i){Object(b.a)(this,e),this.disposers=[],this.disposers.push(Object(ct.c)((function(){var e=t.get(),o=it.a.clone(e.pose);"user"===e.soundLocalizationBase&&(o.orientation=0);var r=ss(o,n,void 0),s=Object(a.d)(r);i.updatePose(s)}))),this.disposers.push(Object(ct.c)((function(){i.playBlob(n.audioBlob)}))),this.disposers.push(Object(ct.c)((function(){return i.updatePannerConfig(as)})))}return Object(vi.a)(e,[{key:"dispose",value:function(){var e,t=Object(g.a)(this.disposers);try{for(t.s();!(e=t.n()).done;){(0,e.value)()}}catch(n){t.e(n)}finally{t.f()}}}]),e}(),us=n(128),ds=function(){function e(){Object(b.a)(this,e),this.audioContext=new window.AudioContext,this.audioDestination=this.audioContext.createMediaStreamDestination(),this.audioElement=new Audio,this.playMode="Pause",this.nodes={},this.audioElement.srcObject=this.audioDestination.stream}return Object(vi.a)(e,[{key:"addSpeaker",value:function(e){return Object(a.b)(void 0===this.nodes[e]),this.nodes[e]=new $i(this.audioContext,this.audioDestination,this.playMode,!this.audioOutputMuted),this.nodes[e]}},{key:"addPlayback",value:function(e){Object(a.b)(void 0===this.nodes[e]);var t=new eo(this.audioContext,this.audioDestination,this.playMode,!this.audioOutputMuted);return this.nodes[e]=t,t}},{key:"removeSpeaker",value:function(e){this.nodes[e].disconnect(),delete this.nodes[e]}},{key:"switchPlayMode",value:function(e,t){var n=this;if(Object(a.b)("Pause"!==e),"Pause"===this.playMode&&Object(ct.c)((function(){var e=new Set(us.a.tracksToAccept[1].map((function(e){return e.endpointId})));for(var t in n.nodes)e.has(t)||n.nodes[t]instanceof eo?n.nodes[t].setPlayMode(n.playMode):n.nodes[t].setPlayMode("Pause")})),e!==this.playMode||t!==this.audioOutputMuted){switch(this.playMode=e,e){case"Context":var i=setInterval((function(){s.a.type||("suspended"!==n.audioContext.state&&clearInterval(i),n.audioContext.resume(),n.audioElement.play())}),1e3);for(var o in this.nodes)this.nodes[o].setPlayMode(e);break;case"Element":for(var r in this.audioContext.suspend(),this.audioElement.pause(),this.nodes)this.nodes[r].setPlayMode(e);break;default:console.error("Unsupported play mode: ".concat(e))}this.audioOutputMuted=t}}},{key:"setAudioOutput",value:function(e){for(var t in Ji(this.audioElement,e),this.nodes)this.nodes[t].setAudioOutput(e)}},{key:"audioOutputMuted",get:function(){return!(this.audioDestination.stream.getTracks().length>0&&this.audioDestination.stream.getTracks()[0].enabled)},set:function(e){for(var t in this.nodes)this.nodes[t].updateAudibility(!e);this.audioDestination.stream.getTracks().forEach((function(t){t.enabled=!e}))}}]),e}(),ps=new(function(){function e(){var t=this;Object(b.a)(this,e),this.manager=new ds,this.connectedGroups={},this.remotesMemo=new Map,this.playbacksMemo=new Map,this.contentsMemo=new Map,this.onRemotesChange=function(){var e=new Map(l.a.remote),n=Object(a.f)(e,t.remotesMemo);Object(a.f)(t.remotesMemo,e).forEach(t.removeRemote),n.forEach(t.addRemote),t.remotesMemo=e},this.onPlaybacksChange=function(){var e=new Map(l.a.playback),n=Object(a.f)(e,t.playbacksMemo);Object(a.f)(t.playbacksMemo,e).forEach(t.removePlayback),n.forEach(t.addPlayback),t.playbacksMemo=e},this.onScreenContentsChange=function(){var e=new Map(p.c.tracks.remoteContents),n=Object(a.f)(e,t.contentsMemo);Object(a.f)(t.contentsMemo,e).forEach(t.removeContent),n.forEach(t.addContent),t.contentsMemo=e},this.removePlayback=function(e){var n=e.id;t.connectedGroups[n].dispose(),delete t.connectedGroups[n],t.manager.removeSpeaker(n)},this.addPlayback=function(e){var n=e.id,i=t.manager.addPlayback(n);t.connectedGroups[n]=new ls(l.a.local_,e,i)},this.removeRemote=function(e){var n=e.id;t.connectedGroups[n].dispose(),delete t.connectedGroups[n],t.manager.removeSpeaker(n)},this.addRemote=function(e){var n=t.manager.addSpeaker(e.id);t.connectedGroups[e.id]=new cs(l.a.local_,void 0,e,n)},this.removeContent=function(e){var n=Array.from(e.values()).find((function(e){return"audio"===e.getType()}));if(n){var i=n.getParticipantId();i?(t.connectedGroups[i].dispose(),delete t.connectedGroups[i],t.manager.removeSpeaker(i)):console.error("removeContent: track does not have content id.",n)}},this.addContent=function(e){var n=Array.from(e.values()).find((function(e){return"audio"===e.getType()}));if(n){var i=n.getParticipantId();if(i){var o=t.manager.addSpeaker(i);t.connectedGroups[i]=new cs(l.a.local_,n,void 0,o)}else console.error("addContent: track does not have content id.",n)}},null===o.a.testBot&&(Object(ct.c)(this.onRemotesChange),Object(ct.c)(this.onPlaybacksChange),Object(ct.c)(this.onScreenContentsChange),Object(ct.c)((function(){var e=l.a.local.muteSpeaker||l.a.local.physics.awayFromKeyboard;t.manager.switchPlayMode(l.a.local.useStereoAudio?"Context":"Element",e)})))}return Object(vi.a)(e,[{key:"setAudioOutput",value:function(e){this.manager.setAudioOutput(e)}}]),e}()),hs=n(146);Object(ct.c)((function(){var e=l.a.local.devicePreference.audioInputDevice,t=l.a.local.muteAudio||l.a.local.physics.awayFromKeyboard;if(l.a.localId&&!t&&null===o.a.testBot){var n=de.b.conference.getLocalMicTrack();if(n&&n.getDeviceId()===e)return;new Promise((function(e,t){var n=l.a.local.devicePreference.audioInputDevice;st.a.createLocalTracks({devices:["audio"],constraints:config.rtc.audioConstraints,micDeviceId:n}).then((function(t){de.b.conference.setLocalMicTrack(t[0]),e(t[0])})).catch(t)})).finally(hs.a)}else{de.b.conference.setLocalMicTrack(void 0).then((function(e){null===e||void 0===e||e.dispose(),l.a.local.audioLevel=0}))}})),Object(ct.c)((function(){var e=l.a.local.devicePreference.audioOutputDevice;e&&ps.setAudioOutput(e)}));Object(ct.c)((function(){var e=l.a.local.devicePreference.videoInputDevice,t=l.a.local.muteVideo||l.a.local.physics.awayFromKeyboard;if(l.a.localId&&!t&&null===o.a.testBot){var n=de.b.conference.getLocalCameraTrack();if(n&&n.getDeviceId()===e)return;new Promise((function(e,t){var n=l.a.local.devicePreference.videoInputDevice;st.a.createLocalTracks({devices:["video"],constraints:config.rtc.videoConstraints,cameraDeviceId:n}).then((function(t){de.b.conference.setLocalCameraTrack(t[0]),e(t[0])})).catch(t)})).finally(hs.a)}else{de.b.conference.setLocalCameraTrack(void 0).then((function(e){return null===e||void 0===e?void 0:e.dispose()}))}}));n(174);var fs=n(62),ms=n.n(fs);function vs(){}function gs(){ms.a.render(Object(T.jsx)(os,{}),document.getElementById("root"))}Object(ct.e)({enforceActions:"never"}),Object(j.a)().then((function(){var e=Object(a.E)(vs)();e.then(Object(a.E)(gs)),e.then(Object(a.E)(ys))}));var bs="";function ys(){window.addEventListener("beforeunload",(function(e){if(bs="".concat(bs,"beforeunload called. ").concat(Date()," "),localStorage.setItem("log",bs),!s.a.type&&(p.c.tracks.localMains.size||p.c.tracks.localContents.size))return bs+="Ask user. ",e.preventDefault(),e.stopImmediatePropagation(),e.returnValue="",localStorage.setItem("log",bs),e.returnValue;de.b.leaveConference(),de.b.disconnect().then((function(e){bs+="Diconnected (".concat(e,"). "),localStorage.setItem("log",bs)})).catch((function(e){bs+="Failed to diconnected (".concat(e,"). "),localStorage.setItem("log",bs)}))})),s.a.connectionStart(),de.b.init().then((function(){Object(ct.j)((function(){return""===s.a.type}),(function(){var e=o.a.room||"_";de.b.joinConference(e)}))}))}}],[[666,1,2]]]);
//# sourceMappingURL=main.f445c94a.chunk.js.map